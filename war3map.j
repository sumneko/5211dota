globals
integer array I
integer array O
integer array A
integer array B
integer array C
integer array D
integer array E
integer array F
integer array G
integer array H
integer array Z
integer array V
integer array W
integer array X
integer array Y
integer array J
integer array K
real array L
timer M=null
real N=0
integer array T
boolean array R
integer array P
integer array Q
integer array I0
boolean O0=false
boolean array A0
boolean B0=false
string array C0
boolean array D0
timer array E0
timer array F0
integer array G0
integer H0=0
integer Z0=0
integer array V0
integer array W0
boolean X0=false
boolean Y0=false
boolean J0=false
boolean K0=false
boolean L0=false
multiboard M0=null
unit N0=null
boolean array S0
integer T0=0
boolean R0=false
boolean P0=false
boolean Q0=false
location U0=null
location II=null
location BI=null
location CI=null
location DI=null
boolean EI=false
boolean FI=false
boolean GI=false
boolean HI=false
boolean ZI=false
boolean VI=false
boolean WI=false
boolean XI=false
boolean YI=false
boolean JI=false
boolean KI=false
boolean LI=false
integer NI=0
integer SI=0
location TI=null
location RI=null
location PI=null
location QI=null
location UI=null
location I1=null
location O1=null
location A1=null
location B1=null
location C1=null
location D1=null
location E1=null
location F1=null
location G1=null
integer array H1
integer array Z1
integer array V1
integer array W1
integer X1=0
integer array Y1
integer array J1
unit array K1
integer L1=0
integer M1=0
player array N1
player array S1
integer array T1
integer array R1
integer array P1
integer array Q1
unit array U1
integer array IO
force OO=null
force AO=null
player array BO
player array CO
player DO=null
player EO=null
boolean FO=false
leaderboard array GO
integer HO=0
integer ZO=0
integer array VO
player WO=null
unit XO=null
integer YO=0
real JO=0
item array KO
item array LO
item array NO
item array TO
item array PO
item array QO
boolean UO=false
integer I2=0
location array O2
unit A2=null
group B2=null
boolean C2=false
boolean D2=false
boolean E2=false
boolean F2=false
boolean G2=false
boolean H2=false
boolean Z2=false
boolean V2=false
string W2=""
timer X2=null
boolean Y2=false
boolean J2=false
item K2=null
player L2=null
string array M2
boolean N2=false
boolean array S2
integer array T2
integer R2=0
force P2=null
boolean Q2=false
real U2=0
boolean I3=false
boolean O3=false
boolean A3=false
boolean B3=false
boolean array C3
string D3=""
boolean array E3
boolean array F3
boolean G3=false
boolean H3=false
weathereffect Z3=null
weathereffect V3=null
boolean W3=false
location X3=null
real Y3=0
string J3=""
string array K3
rect L3=null
rect M3=null
rect N3=null
rect S3=null
rect T3=null
rect R3=null
rect P3=null
rect Q3=null
rect U3=null
rect I4=null
rect O4=null
rect A4=null
rect B4=null
rect C4=null
rect D4=null
rect E4=null
rect F4=null
rect G4=null
rect H4=null
rect Z4=null
rect V4=null
rect W4=null
rect X4=null
rect Y4=null
rect J4=null
rect K4=null
rect L4=null
rect M4=null
rect N4=null
rect S4=null
rect T4=null
rect R4=null
rect P4=null
rect Q4=null
rect U4=null
rect I5=null
rect O5=null
rect A5=null
rect B5=null
rect C5=null
rect D5=null
rect E5=null
rect F5=null
rect G5=null
rect H5=null
rect Z5=null
rect V5=null
rect W5=null
rect X5=null
rect Y5=null
rect J5=null
rect K5=null
rect L5=null
rect M5=null
rect N5=null
rect S5=null
rect T5=null
rect R5=null
rect P5=null
rect Q5=null
rect U5=null
rect I6=null
rect O6=null
rect A6=null
rect B6=null
rect C6=null
rect D6=null
rect E6=null
rect F6=null
rect G6=null
rect H6=null
rect Z6=null
rect V6=null
rect W6=null
rect X6=null
rect Y6=null
rect J6=null
rect K6=null
rect L6=null
rect M6=null
rect N6=null
rect S6=null
rect T6=null
rect R6=null
rect P6=null
rect Q6=null
rect U6=null
rect I7=null
rect O7=null
rect A7=null
rect B7=null
rect C7=null
rect D7=null
rect E7=null
rect F7=null
rect G7=null
rect H7=null
rect Z7=null
rect V7=null
rect W7=null
rect X7=null
rect Y7=null
rect J7=null
rect K7=null
rect L7=null
rect M7=null
rect N7=null
rect S7=null
rect T7=null
rect R7=null
rect P7=null
rect Q7=null
rect U7=null
rect I8=null
rect O8=null
rect A8=null
rect B8=null
rect C8=null
rect D8=null
rect E8=null
rect F8=null
rect G8=null
rect H8=null
rect Z8=null
rect V8=null
rect W8=null
rect X8=null
rect Y8=null
rect J8=null
rect K8=null
rect L8=null
rect M8=null
rect N8=null
rect S8=null
rect T8=null
rect R8=null
rect P8=null
rect Q8=null
rect U8=null
rect I9=null
rect O9=null
rect A9=null
rect B9=null
rect C9=null
rect D9=null
rect E9=null
rect F9=null
rect G9=null
rect H9=null
rect Z9=null
rect V9=null
rect W9=null
rect X9=null
rect Y9=null
rect J9=null
rect K9=null
rect L9=null
rect M9=null
rect N9=null
rect S9=null
rect T9=null
rect R9=null
rect P9=null
rect Q9=null
rect U9=null
rect IA=null
rect OA=null
rect BA=null
rect CA=null
rect DA=null
rect EA=null
rect FA=null
rect GA=null
rect HA=null
rect ZA=null
rect VA=null
rect WA=null
rect XA=null
rect YA=null
rect JA=null
rect KA=null
rect LA=null
rect MA=null
rect NA=null
rect SA=null
rect TA=null
rect RA=null
rect PA=null
rect QA=null
rect UA=null
rect IB=null
rect OB=null
rect AB=null
rect BB=null
rect CB=null
rect DB=null
rect EB=null
rect FB=null
rect GB=null
rect HB=null
rect ZB=null
rect VB=null
rect WB=null
rect XB=null
rect YB=null
rect JB=null
rect KB=null
rect LB=null
rect MB=null
rect SB=null
rect TB=null
rect RB=null
rect PB=null
rect QB=null
rect IC=null
rect OC=null
rect AC=null
sound BC=null
sound CC=null
sound DC=null
sound EC=null
sound FC=null
sound GC=null
sound HC=null
sound ZC=null
sound VC=null
sound WC=null
sound XC=null
sound YC=null
sound JC=null
string KC="Sound\\Music\\mp3Music\\Human1.mp3"
string LC="Sound\\Music\\mp3Music\\Human2.mp3"
string MC="Sound\\Music\\mp3Music\\Human3.mp3"
sound NC=null
sound TC=null
sound RC=null
sound PC=null
sound QC=null
sound UC=null
sound OD=null
string AD="Sound\\Music\\mp3Music\\NightElf1.mp3"
string BD="Sound\\Music\\mp3Music\\NightElf2.mp3"
string DD="Sound\\Music\\mp3Music\\NightElf3.mp3"
sound ED=null
string FD="Sound\\Music\\mp3Music\\Orc1.mp3"
string GD="Sound\\Music\\mp3Music\\Orc2.mp3"
string HD="Sound\\Music\\mp3Music\\Orc3.mp3"
string ZD="Sound\\Music\\mp3Music\\BloodElfTheme.mp3"
string VD="Sound\\Music\\mp3Music\\DarkAgents.mp3"
string WD="Sound\\Music\\mp3Music\\TragicConfrontation.mp3"
string XD="Sound\\Music\\mp3Music\\SadMystery.mp3"
string YD="Sound\\Music\\mp3Music\\IllidansTheme.mp3"
sound JD=null
sound KD=null
sound LD=null
sound MD=null
sound ND=null
sound TD=null
sound PD=null
sound QD=null
sound UD=null
sound IE=null
sound OE=null
sound AE=null
string BE="Sound\\Music\\mp3Music\\Undead1.mp3"
string CE="Sound\\Music\\mp3Music\\Undead2.mp3"
string DE="Sound\\Music\\mp3Music\\Undead3.mp3"
sound EE=null
sound FE=null
sound GE=null
sound HE=null
sound ZE=null
sound VE=null
sound WE=null
sound XE=null
sound YE=null
sound JE=null
sound KE=null
sound LE=null
sound ME=null
sound NE=null
sound SE=null
sound TE=null
sound RE=null
sound PE=null
sound QE=null
sound UE=null
sound IF=null
sound OF=null
sound AF=null
sound BF=null
sound CF=null
sound DF=null
sound EF=null
sound FF=null
string GF="Sound\\Music\\mp3Music\\Tension.mp3"
string HF="Sound\\Music\\mp3Music\\ArthasTheme.mp3"
string ZF="Sound\\Music\\mp3Music\\NightElfDefeat.mp3"
string VF="Sound\\Music\\mp3Music\\NightElfVictory.mp3"
sound WF=null
sound XF=null
sound YF=null
sound JF=null
sound KF=null
sound LF=null
sound MF=null
sound NF=null
sound SF=null
sound TF=null
sound RF=null
sound PF=null
sound QF=null
sound UF=null
sound IG=null
sound OG=null
sound AG=null
sound BG=null
trigger CG=null
trigger DG=null
trigger EG=null
trigger FG=null
trigger GG=null
trigger HG=null
trigger ZG=null
trigger VG=null
trigger WG=null
trigger XG=null
trigger YG=null
trigger JG=null
trigger KG=null
trigger LG=null
trigger MG=null
trigger NG=null
trigger SG=null
trigger TG=null
trigger RG=null
trigger PG=null
trigger QG=null
trigger UG=null
trigger IH=null
trigger OH=null
trigger BH=null
trigger CH=null
trigger DH=null
trigger EH=null
trigger FH=null
trigger GH=null
trigger HH=null
trigger ZH=null
trigger VH=null
trigger WH=null
trigger XH=null
trigger YH=null
trigger JH=null
trigger KH=null
trigger LH=null
trigger MH=null
trigger NH=null
trigger TH=null
trigger RH=null
trigger PH=null
trigger QH=null
unit UH=null
unit IZ=null
unit OZ=null
unit AZ=null
unit BZ=null
unit CZ=null
unit DZ=null
unit EZ=null
unit FZ=null
unit GZ=null
unit HZ=null
unit ZZ=null
unit VZ=null
unit WZ=null
unit XZ=null
unit YZ=null
unit JZ=null
unit KZ=null
unit LZ=null
unit MZ=null
unit NZ=null
unit SZ=null
unit TZ=null
unit RZ=null
unit PZ=null
unit QZ=null
unit UZ=null
unit IV=null
unit OV=null
unit AV=null
unit BV=null
unit CV=null
unit DV=null
unit EV=null
unit FV=null
unit GV=null
unit HV=null
unit ZV=null
unit VV=null
unit WV=null
unit XV=null
unit YV=null
unit JV=null
unit KV=null
unit LV=null
unit MV=null
unit NV=null
unit SV=null
unit TV=null
unit PV=null
unit QV=null
unit UV=null
unit IW=null
unit OW=null
unit AW=null
unit BW=null
unit CW=null
unit DW=null
unit EW=null
unit FW=null
unit GW=null
unit HW=null
unit ZW=null
unit VW=null
unit WW=null
unit XW=null
unit YW=null
unit JW=null
unit KW=null
unit LW=null
unit MW=null
unit SW=null
unit TW=null
unit RW=null
unit PW=null
unit QW=null
unit UW=null
unit IX=null
unit OX=null
unit AX=null
unit BX=null
unit CX=null
unit DX=null
unit EX=null
unit GX=null
unit HX=null
unit ZX=null
unit VX=null
unit WX=null
unit XX=null
unit YX=null
unit JX=null
unit KX=null
unit LX=null
unit MX=null
unit NX=null
unit SX=null
unit TX=null
unit RX=null
unit PX=null
unit QX=null
unit UX=null
unit IY=null
unit OY=null
unit AY=null
unit BY=null
unit CY=null
unit DY=null
unit EY=null
unit FY=null
unit GY=null
unit HY=null
unit ZY=null
unit VY=null
unit WY=null
unit XY=null
unit YY=null
unit JY=null
unit KY=null
hashtable LY
string MY=""
unit array NY
unit array SY
unit array TY
integer RY=0
destructable array PY
destructable array QY
destructable array UY
integer IJ=0
group array OJ
boolean array AJ
integer BJ
integer CJ
boolean DJ=false
trigger array EJ
real array FJ
integer GJ=0
boolean array HJ
real array ZJ
integer array VJ
integer array WJ
integer XJ=0
string array YJ
integer array JJ
integer KJ=0
string LJ
real MJ
integer NJ=0
sound SJ
unit TJ
real RJ
real PJ
real QJ
integer UJ
integer IK
integer OK
real AK
real BK
real CK
real DK
real EK
real FK
unit GK
unit HK
unit ZK
item VK
trigger WK
group XK
group YK
player JK
boolean KK
string LK
image MK=null
unit NK=null
integer SK
boolean TK=true
trigger RK
trigger PK
region QK
integer UK=1
boolean IL=false
timer OL
boolean AL=false
integer BL=90
boolean CL=false
boolean DL=false
string EL="No Mode"
boolean FL=false
boolean GL=true
boolean HL=false
boolean ZL=false
boolean VL=false
boolean WL=false
integer YL
boolean JL=false
integer array KL
boolean array LL
integer ML=0
integer array SL
integer array TL
integer array RL
integer array PL
integer array QL
integer array UL
integer array IM
integer array AM
integer array BM
integer array FM
boolean array GM
boolean array HM
boolean array VM
boolean array WM
unit XM=null
unit YM=null
boolean JM=false
player KM=null
player SM=null
boolean array TM
integer RM
player QM
trigger UM=null
boolean IN=false
integer ON
integer AN
boolean BN=false
boolean CN=false
trigger DN
boolean EN=false
integer FN='A10N'
integer GN='A0S0'
integer HN='A10O'
integer ZN='A10P'
boolean VN=false
integer array WN
region XN
region YN
region JN
region KN
region LN
region MN
constant real NN=150
integer array SN
integer TN=0
integer array RN
integer array PN
integer array QN
integer array UN
integer IS=0
gamecache OS
integer array BS
integer array CS
integer array DS
integer array ES
integer array FS
trigger HS
integer array ZS
integer array VS
integer array WS
boolean array XS
integer array YS
real array JS
weathereffect KS
weathereffect LS
rect MS
boolean SS=false
constant playercolor TS=ConvertPlayerColor(0)
constant playercolor PS=ConvertPlayerColor(12)
real QS=-7360
real US=-6688
real IT=-6592
real OT=-6464
real AT=-7392
real BT=-6240
real CT=-7392
real DT=-6432
real ET=-6592
real FT=-6720
real GT=-6816
real HT=-5984
real ZT=-6944
real VT=-5920
real WT=-7072
real XT=-5920
real YT=-7200
real JT=-5920
real KT=-7328
real LT=-5984
real MT=-7328
real ST=-5984
real RT=-5632
real PT=-5952
real QT=-6112
real UT=1504
real IR=-1504
real OR=-1824
real BR=4960
real CR=-6752
real DR=-6112
real GR=-1312
real HR=-3488
real ZR=-3296
real WR=-544
real XR=-6688
real YR=-6496
real JR=-4832
real KR=-4576
real LR=-4832
real SR=-4512
real RR=-6752
real PR=-5920
real QR=-5984
real UR=-5664
real IP=-6240
real OP=-6400
real BP=-4224
real DP=-4288
real EP=-4992
real FP=-3776
real GP=-6720
real ZP=-5952
real VP=-4160
real WP=-4800
real YP=-4608
real JP=-3776
real KP=-6272
real LP=-7136
real MP=-4640
real TP=-6496
real RP=-5536
real PP=-5088
real QP=-5280
real UP=-5920
real IQ=-4640
real OQ=-4832
real AQ=-4384
real BQ=-4128
real CQ=-5024
real DQ=-5216
real EQ=-6816
real FQ=-4192
real GQ=-7456
real HQ=-4192
real ZQ=-6176
real VQ=-5664
real WQ=-3872
real XQ=-5664
real YQ=-3872
real JQ=-5440
real KQ=-4800
real LQ=-3840
real MQ=-5184
real NQ=-5440
real SQ=-4800
real TQ=-3840
real RQ=-5184
unit PQ
unit QQ
unit UQ
unit I00
unit II0
unit I10
unit IO0
unit I20
unit I30
unit I40
unit I50
unit I60
unit I70
unit I80
unit I90
unit IA0
unit IB0
unit IC0
unit ID0
unit IE0
unit IF0
unit IG0
unit IH0
unit IZ0
unit IV0
unit IW0
unit IX0
unit IY0
unit IJ0
unit IK0
unit IL0
unit IM0
unit IN0
unit IS0
unit IT0
unit IR0
unit IP0
unit IQ0
unit IU0
unit O00
unit OI0
unit O10
unit OO0
unit O20
constant playercolor O30=ConvertPlayerColor(6)
constant playercolor O40=ConvertPlayerColor(12)
real O50=6272
real O60=5504
real O70=6464
real O80=5120
real O90=5952
real OA0=5568
real OB0=6080
real OC0=5568
real OD0=6464
real OE0=4736
real OF0=5696
real OG0=5120
real OH0=5568
real OZ0=5248
real OV0=5568
real OW0=5376
real OX0=5696
real OY0=5504
real OJ0=5568
real OK0=5696
real OL0=5568
real OM0=5696
real ON0=4992
real OS0=4544
real OT0=-4704
real OR0=5920
real OP0=1056
real OQ0=-160
real OU0=6048
real A00=-2080
real AI0=32
real A10=5856
real AO0=2400
real A20=1696
real A30=6112
real A40=-96
real A50=3168
real A60=5920
real A70=3616
real A80=3296
real A90=6048
real AA0=2784
real AB0=4640
real AC0=4576
real AD0=5088
real AE0=4192
real AF0=3776
real AG0=5888
real AH0=4096
real AZ0=3392
real AV0=6208
real AW0=3264
real AX0=3520
real AY0=5376
real AJ0=3776
real AK0=3840
real AL0=5696
real AM0=3264
real AN0=3168
real AS0=4000
real AT0=4192
real AR0=5536
real AP0=4128
real AQ0=4512
real AU0=4640
real B00=3680
real BI0=4832
real B10=3104
real BO0=5408
real B20=2592
real B30=5408
real B40=3296
real B50=6112
real B60=4000
real B70=3040
real B80=5088
real B90=6304
real BA0=3744
real BB0=6304
real BC0=3744
real BD0=3520
real BE0=4608
real BF0=4096
real BG0=2624
real BH0=4096
real BZ0=2624
real BV0=4096
real BW0=2624
unit BX0
unit BY0
unit BJ0
unit BK0
unit BL0
unit BM0
unit BN0
unit BS0
unit BT0
unit BR0
unit BP0
unit BQ0
unit BU0
unit C00
unit CI0
unit C10
unit CO0
unit C20
unit C30
unit C40
unit C50
unit C60
unit C70
unit C80
unit C90
unit CA0
unit CB0
unit CC0
unit CD0
unit CE0
unit CF0
unit CG0
unit CH0
unit CZ0
unit CV0
unit CW0
unit CX0
unit CY0
unit CJ0
unit CK0
unit CL0
unit CM0
unit CN0
unit CS0
unit CT0
unit CR0
unit CP0
unit CQ0
unit CU0
unit D00
unit DI0
unit D10
unit DO0
unit D20
unit array D30
real array D40
real array D50
player D60
player D70
string array D80
integer array D90
integer array DA0
integer array DB0
integer array DC0
integer array DD0
integer DE0
integer DF0
integer DG0
integer DH0
integer array DZ0
integer DV0
integer array DW0
integer DX0
integer array DY0
integer DJ0
integer array DK0
integer DL0
integer array DM0
integer DN0
string array DS0
integer array DT0
string array DR0
string array DP0
string array DQ0
string array DU0
string array E00
unit EI0
unit E10
unit EO0
unit E20
unit E30
unit E40
unit E50
unit E60
unit E70
unit E80
unit E90
unit EA0
integer array EB0
integer EC0=0
integer array ED0
integer EE0=-1
boolean array EF0
integer EG0=0
integer EH0
player EZ0
trigger EV0
trigger EW0
trigger EX0
hashtable EY0
timer array EJ0
integer array EK0
integer array EL0
real array EM0
integer array EN0
integer array ES0
integer ET0=1
constant real ER0=15
player array EP0
unit array EQ0
real array EU0
boolean array F00
integer FI0=0
unit array F10
real array FO0
boolean array F20
unit F30
unit F40
integer F50
integer F60
unit F70
integer F80
integer F90
integer array FA0
integer array FB0
integer FC0
integer FD0
integer FE0=0
integer array FF0
integer array FG0
integer FH0
real FZ0
real FV0
unit FW0=null
boolean FX0=true
integer FY0=1
integer FJ0=600
integer FK0=300
trigger FL0
integer FM0=0
leaderboard array FN0
boolean array FS0
integer array FT0
integer array FR0
integer array FP0
integer array FQ0
integer array FU0
string array G00
integer array GI0
integer array G10
integer GO0=0
integer G20
integer G30
integer G40
integer G50
integer G60
integer G70
integer G80
integer G90
integer GA0
integer GB0
integer GC0
integer GD0
integer GE0
integer GF0
integer GG0
integer GH0
integer GZ0
integer GV0
integer GW0
integer GX0
integer GY0
integer GJ0
integer GK0
integer GL0
integer GM0
integer GN0
integer GS0
integer GT0
integer GR0
integer GP0
integer GQ0
integer GU0
integer H00
integer HI0
integer H10
integer HO0
integer H20
integer H30
integer H40
integer H50
integer H60
integer H70
integer H80
integer H90
integer HA0
integer HB0
integer HC0
integer HD0
integer HE0
integer HF0
integer HG0
integer HH0
integer HZ0
integer HV0
integer HW0
integer HX0
integer HY0
integer HJ0
integer HK0
integer HL0
integer HM0
integer HN0
integer HS0
integer HT0
integer HR0
integer HP0
integer HQ0
integer HU0
integer Z00
integer ZI0
integer Z10
integer ZO0
integer Z20
integer Z30
integer Z40
integer Z50
integer Z60
integer Z70
integer Z80
integer Z90
integer ZA0
integer ZB0
integer ZC0
integer ZD0
integer ZE0
integer ZF0
integer ZG0
integer ZH0
integer ZZ0
integer ZV0
integer ZW0
integer ZX0
integer ZY0
integer ZJ0
integer ZK0
integer ZL0
integer ZM0
integer ZN0
integer ZS0
integer ZT0
integer ZR0
integer ZP0
integer ZQ0
integer ZU0
integer V00
integer VI0
integer V10
integer VO0
integer V20
integer V30
integer V40
integer V50
integer V60
integer V70
integer V80
integer V90
integer VA0
integer VB0
integer VC0
integer VD0
integer VE0
integer VF0
integer VG0
integer VH0
integer VZ0
integer VV0
integer VW0
integer VX0
integer VY0
integer VJ0
integer VK0
integer VL0
integer VM0
integer VN0
integer VS0
integer VT0
integer VR0
integer VP0
integer VQ0
integer VU0
integer W00
integer WI0
integer W10
integer WO0
integer W20
integer W30
integer W40
integer W50
integer W60
integer W70
integer W80
integer W90
integer WA0
integer WB0
integer WC0
integer WD0
integer WE0
integer WF0
integer WG0
integer WH0
integer WZ0
integer WV0
integer WW0
integer WX0
integer WY0
integer WJ0
integer WK0
integer WL0
integer WM0
integer WN0
integer WS0
integer WT0
integer WR0
integer WP0
integer WQ0
integer WU0
integer X00
integer XI0
integer X10
integer XO0
integer X20
integer X30
integer X40
integer X50
integer X60
integer X70
integer X80
integer X90
integer XA0
integer XB0
integer XC0
integer XD0
integer XE0
integer XF0
integer XG0
integer XH0
integer XZ0
integer XV0
integer XW0
integer XX0
integer XY0
integer XJ0
integer XK0
integer XL0
integer XM0
integer XN0
integer XS0
integer XT0
integer XR0
integer XP0
integer XQ0
integer XU0
integer Y00
integer YI0
integer Y10
integer YO0
integer Y20
integer Y30
integer Y40
integer Y50
integer Y60
integer Y70
integer Y80
integer Y90
integer YA0
integer YB0
integer YC0
integer YD0
integer YE0
integer YF0
integer YG0
integer YH0
integer YZ0
integer YV0
integer YW0
integer YX0
integer YY0
integer YJ0
integer YK0
integer YL0
integer YM0
integer YN0
integer YS0
integer YT0
integer YR0
integer YP0
integer YQ0
integer YU0
integer J00
integer JI0
integer J10
integer JO0
trigger J20
integer J30=-1
boolean J40=true
integer array J50
integer array J60
integer array J70
integer array J80
integer array J90
integer array JA0
integer array JB0
integer JC0=0
integer JD0
integer JE0
integer JF0
integer JG0
integer JH0
integer JZ0
integer JV0
integer JW0
integer JX0
integer JY0
integer JJ0
integer JK0
integer JL0
integer JM0
integer JN0
integer JS0
integer JT0
integer JR0
integer JP0
integer JQ0
integer JU0
integer K00
integer KI0
integer K10
integer KO0
integer K20
integer K30
integer K40
integer K50
integer K60
integer K70
integer K80
integer K90
integer KA0
integer KB0
integer KC0
integer KD0
integer KE0
integer KF0
integer KG0
integer KH0
integer KZ0
integer KV0
integer KW0
integer KX0
integer KY0
integer KJ0
integer KK0
integer KL0
integer KM0
integer KN0
integer KS0
integer KT0
integer KR0
integer KP0
integer KQ0
integer KU0
integer L00
integer LI0
integer L10
integer LO0
integer L20
integer L30
integer L40
integer L50
integer L60
integer L70
integer L80
integer array L90
integer array LA0
integer array LB0
integer array LC0
integer array LD0
integer array LE0
integer array LF0
player LG0
unit LH0
unit LZ0
integer LV0
boolean LW0=false
unit LX0
trigger LY0
integer LJ0=0
integer LK0=0
integer LL0=0
integer LM0=0
integer LN0=0
integer LS0=0
integer LT0=0
integer LR0=0
integer LP0=0
integer LQ0=0
integer LU0=0
integer array M00
integer array MI0
boolean M10=false
trigger MO0
trigger M20
real array M30
item array M40
integer M50=0
trigger M60
unit array M70
unit M80=null
integer array M90
integer array MA0
constant real MB0=16
constant real MC0=5
constant real MD0=15
constant real ME0=4
constant real MF0=40
integer array MG0
unit MH0
boolean MZ0=false
constant real MV0=17
real array MW0
real array MX0
player array MY0
real array MJ0
real array MK0
real array ML0
integer MM0=-1
constant real MN0=25
constant real MS0=575
region MT0
integer MR0
integer MP0='A11F'
integer MQ0='A11E'
integer MU0='A0S3'
integer N00='A11D'
integer NI0='A11G'
integer N10='A11H'
integer NO0='A2LI'
integer N20='A11B'
integer N30='A11A'
integer N40='A0S2'
integer N50='A119'
integer N60='A11C'
integer N70='A118'
integer N80='A2LH'
integer N90='A0FY'
unit NA0
unit NB0
integer NC0
group ND0
unit NE0
unit NF0
player NG0
boolean NH0=false
boolean NZ0=false
constant real NV0=5
boolean NW0=false
real NX0
boolean NY0=false
boolean array NJ0
constant real NK0=8
constant real NL0=6
player NM0
constant real NN0=25
constant real NS0=4
constant real NT0=4
boolean NR0=false
boolean NP0=false
boolean NQ0=false
boolean NU0=false
boolean S00=false
boolean SI0=false
boolean S10=false
boolean SO0=false
boolean S20=false
integer array S30
integer array S40
integer array S50
integer S60=0
integer S70
integer S80
integer S90=0
integer SA0=0
string SB0="|c00ff0303"
string SC0="|c00ff0303"
string SD0="|c000042ff"
string SE0="|c00646464"
string SF0="|c00ffffff"
multiboard SG0
integer array SH0
integer array SZ0
player array SV0
integer SW0=0
string SX0="|c00FF6600"
multiboard SY0
trigger SJ0
real SK0=0
real SL0=0
real SM0=0
real SN0=0
real SS0=0
real ST0=0
real SR0=0
real SP0=0
real SQ0=0
real SU0=0
real T00=0
real TI0=0
real T10=0
real TO0=0
real T20=0
real T30=0
real T40=0
real T50=0
real T60=0
real T70=0
real T80=0
real T90=0
real TA0=0
real TB0=0
real TC0=0
real TD0=0
real TE0=0
real TF0=0
real TG0=0
real TH0=0
constant real TZ0=90
boolean TV0=false
boolean TW0=false
boolean TX0=false
boolean TY0=false
boolean TJ0=false
boolean TK0=false
boolean TL0=false
boolean TM0=false
boolean TN0=false
unit TS0=null
unit TT0=null
group TR0
boolean TP0=true
boolean TQ0=false
integer TU0=0
string array R00
boolean RI0=false
integer R10
player RO0
integer R20
integer R30='A0HU'
integer R40='A0HX'
trigger R50
region R60
boolean R70=false
boolean R80=false
boolean R90=false
boolean RA0=false
boolean RB0=false
unit array RC0
group RD0
unit RE0
integer RF0
integer RG0=0
integer array RH0
integer array RZ0
boolean array RV0
boolean array RW0
boolean array RX0
boolean RY0=true
boolean array RJ0
real RK0=-200
boolean array RL0
leaderboard array RM0
boolean array RN0
boolean RS0=true
weathereffect RT0
boolean array RR0
boolean array RP0
boolean array RQ0
boolean RU0=true
boolean array P00
string array PI0
integer P10=0
string PO0="Sound\\Music\\mp3Music\\PH1.mp3"
boolean array P20
integer P30
integer P40
integer P50
string array P60
boolean array P70
integer P80=0
boolean P90=true
integer array PA0
boolean array PB0
constant real PC0=-6950
constant real PD0=6750
boolean PE0=false
trigger PF0
boolean PG0=false
integer array PH0
boolean PZ0
boolean PV0=false
boolean PW0=false
integer array PX0
integer PY0
player PJ0
integer PK0
integer PL0
player PM0
player PN0
integer PS0
integer PT0
integer array PR0
integer array PP0
integer PQ0=0
integer PU0=0
integer array Q00
integer array QI0
integer Q10=0
integer QO0=0
multiboard Q20
image Q30
image Q40
image Q50
image Q60
unit array Q70
integer array Q80
boolean array Q90
unit array QA0
real array QB0
real array QC0
real array QD0
real array QE0
real array QF0
real array QG0
real array QH0
real array QZ0
real QV0=-7030
real QW0=6966
real QX0=-7000
real QY0=6875
constant real QJ0=400
constant real QK0=75
constant real QL0=125
player QM0=null
player QN0=null
integer QS0
boolean QT0=false
boolean QR0=false
boolean array QP0
real QQ0
real QU0
real U00
real UI0
unit array U10
integer UO0=0
trigger U20
unit array U30
unit array U40
boolean U50=false
trigger U60
integer array U70
unit array U80
unit array U90
integer UA0=0
unit array UB0
integer UC0
integer UD0
integer array UE0
integer UF0
boolean array UG0
integer array UH0
integer array UZ0
integer UV0=0
integer UW0=0
real array UX0
real array UY0
real array UJ0
real array UK0
integer array UL0
boolean UM0=true
image UN0
image US0
image UT0
image UR0
image UP0
image UQ0
image UU0
image I0I
image III
image I1I
image IOI
image I2I
image I3I
image I4I
image I5I
image I6I
constant real I7I=450
constant real I8I=75
constant real I9I=140
boolean IAI=false
boolean IBI=false
integer array ICI
integer array IDI
integer array IEI
integer array IFI
integer array IGI
integer array IHI
integer array IZI
integer IVI
integer IWI
integer IXI
string IYI="|c008A2BE2Option 1: |r"
string IJI="|c008A2BE2Option 2: |r"
string IKI="|c008A2BE2Option 3: |r"
integer ILI
integer array IMI
boolean INI=false
boolean ISI=false
leaderboard ITI
integer IRI
integer array IPI
boolean IQI=false
boolean IUI=false
leaderboard O0I
boolean OII=false
boolean O1I=false
boolean OOI=false
boolean O2I=false
boolean O3I=true
boolean O4I=false
boolean O5I=false
boolean O6I=false
boolean O7I=false
boolean O8I=false
boolean O9I=false
real OAI=1.0
boolean OBI=false
boolean OCI=false
boolean ODI=false
camerasetup OEI=null
boolean OFI=false
unit OGI
unit OHI
unit OZI
unit OVI
unit OWI
unit OXI
real OYI
real OJI
real OKI
real OLI
real OMI
real ONI
boolean OSI=false
real array OTI
unit array ORI
unit array OPI
integer array OQI
integer array OUI
trigger A0I=CreateTrigger()
boolean array AII
player A1I
boolean AOI=false
boolean A2I=false
boolean A3I=false
item A4I=null
item A5I=null
boolean A6I=false
boolean A7I=false
unit A8I
unit A9I
unit AAI
unit ABI
unit ACI
constant real ADI=-2576
constant real AEI=1818
constant real AFI=2337
constant real AGI=-2004
constant real AHI=2500
constant real AZI=-2177
constant real AVI=2706
constant real AWI=-2356
constant real AXI=2935
constant real AYI=-2526
group AJI
unit AKI
integer ALI
unit AMI
unit ANI
real ASI
real ATI
integer array ARI
real API
unit AQI
boolean AUI
boolean B0I
integer BII=0
group B1I
integer BOI
unit B2I
real B3I
unit B4I
unit B5I
integer B6I
real B7I
unit B8I
integer B9I
boolean BAI
unit BBI
integer BCI
unit BDI
integer BEI
unit BFI
real BGI
unit BHI
real BZI
integer BVI
integer BWI
unit BXI
real BYI
unit array BJI
unit array BKI
real BLI
unit BMI
real BNI
integer BSI
unit BTI
integer BRI
integer BPI
real BQI
real BUI
unit C0I
unit array CII
real C1I
real COI
integer C2I
integer C3I
unit C4I
real C5I
real C6I
real C7I
unit C8I
integer array C9I
unit array CAI
unit CBI
integer CCI
group CDI
unit CEI
real CFI
integer CGI
unit CHI
integer CZI
unit CVI
real CWI
real CXI
real CYI
integer CJI=0
real CKI
real CLI
integer CMI
real CNI
unit CSI
integer array CTI
integer array CRI
unit CPI
unit CQI
group CUI
group D0I
group DII
unit D1I
group DOI
integer D2I=0
unit D3I
integer array D4I
integer array D5I
integer array D6I
integer array D7I
integer array D8I
unit D9I
unit DAI
real DBI
real DCI
unit DDI
unit DEI
unit DFI
real DGI
real DHI
real DZI
unit DVI
real DWI
real DXI
real DYI
unit DJI
unit DKI
real DLI
integer array DMI
unit DNI
integer array DSI
unit DTI
unit DRI
real DPI
integer DQI
integer array DUI
real E0I=0
integer array EII
integer E1I
unit EOI
integer E2I
unit E3I
integer E4I
integer E5I
integer E6I
unit E7I
unit E8I
real E9I
real EAI
real EBI
real ECI
group EDI
unit EEI
real EFI
integer EGI
integer EHI
integer EZI
unit array EVI
boolean EWI=false
boolean EXI=false
trigger EYI
integer EJI
player EKI
integer ELI
unit EMI
real ENI
unit ESI
real ETI
real ERI
unit EPI
real EQI
unit EUI
unit F0I
real FII
real F1I
integer FOI
unit F2I
unit F3I
unit F4I
group F5I
integer F6I
group F7I
unit F8I
real F9I
integer FAI
destructable FBI=null
unit FCI=null
real FDI=0
constant real FEI=26
constant real FFI=600
constant real FGI=550
real FHI
real FZI
group FVI
unit FWI
real FXI
integer FYI
integer FJI
unit FKI
integer FLI
unit FMI
integer FNI
boolean FSI=false
trigger FTI
integer FRI
unit FPI
integer FQI
integer array FUI
integer array G0I
integer array GII
integer array G1I
unit GOI
unit G2I
integer G3I
real G4I
real G5I
unit G6I
unit G7I
boolean G8I=false
integer G9I
integer array GAI
group GBI
group GCI
unit GDI
integer GEI
unit array GFI
unit array GGI
real GHI
real GZI
unit GVI
integer GWI
string GXI="Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl"
boolean GYI=true
integer array GJI
integer GKI='h06J'
real GLI
real GMI
unit GNI
unit GSI
unit GTI
real GRI
real GPI
real GQI
integer GUI
real H0I
real HII
unit H1I
unit HOI
integer H2I
group H3I
unit H4I
unit H5I
integer H6I
integer H7I
player H8I
integer H9I
unit array HAI
integer HBI
integer HCI
constant real HDI=55
group HEI
integer HFI
unit HGI
unit HHI
unit HZI
constant real HVI=7
integer array HWI
constant real HXI=1
constant real HYI=4
real HJI
unit HKI
integer array HLI
group HMI
unit HNI
integer HSI
boolean HTI
integer array HRI
trigger HPI
trigger HQI
integer HUI=0
boolean Z0I=false
unit ZII
unit Z1I
group ZOI
real Z2I
unit Z3I
real Z4I
integer Z5I
integer Z6I
real Z7I
real Z8I
unit Z9I
unit ZAI
unit ZBI
group ZCI
real ZDI
unit ZEI
group ZFI
constant real ZGI=6
unit ZHI
integer ZZI
unit ZVI
integer ZWI
integer ZXI='A05V'
boolean ZYI=false
unit ZJI
unit ZKI
constant real ZLI=7
constant real ZMI=300
unit ZNI
real ZSI
unit ZTI
real ZRI
unit ZPI
real ZQI
unit ZUI
integer array V0I
integer array VII
group V1I
integer VOI
unit V2I
real V3I
integer array V4I
integer array V5I
real V6I
unit V7I
unit V8I
real V9I
integer VAI
unit array VBI
unit VCI
unit VDI
real VEI
unit VFI
unit VGI
integer VHI
real VZI
group VVI=null
constant real VWI=3
unit VXI
unit VYI
unit VJI
real VKI
group VLI
integer VMI
unit VNI
constant real VSI=6
unit VTI
integer VRI
unit VPI
real VQI
integer VUI
unit W0I
unit WII
real W1I
real WOI
constant real W2I=4
boolean W3I=true
unit array W4I
boolean W5I=false
unit W6I
integer W7I
real array W8I
real array W9I
real array WAI
unit array WBI
integer array WCI
integer array WDI
constant real WEI=17
integer WFI
unit WGI
integer WHI
unit WZI
unit WVI
constant real WWI=1100
group WXI
unit WYI
real WJI
group WKI
integer WLI
unit WMI
unit WNI
integer WSI
unit WTI
integer WRI
real WPI
group WQI
unit WUI
unit X0I
real XII
real X1I
real XOI
constant real X2I=1300
constant real X3I=20
constant real X4I=20
constant real X5I=20
integer X6I
unit X7I
group X8I
real X9I
real XAI
unit XBI
unit XCI
group XDI
integer array XEI
constant real XFI=20
unit XGI
unit XHI
real XZI
real XVI
real XWI
real XXI
constant real XYI=325
unit XJI
unit XKI
integer XLI
real XMI
unit XNI
boolean XSI=false
boolean XTI=false
unit XRI
unit XPI
real XQI
unit XUI
integer Y0I
integer YII
unit Y1I
group YOI
real Y2I
integer Y3I
region Y4I
region Y5I
unit Y6I
unit Y7I
integer Y8I
group Y9I
group YAI
group YBI
unit YCI
unit YDI
unit YEI
unit YFI
integer YGI
real YHI
real YZI
real YVI
integer YWI
unit YXI
unit YYI
unit YJI
unit YKI
group YLI
real YMI
integer array YNI
integer YSI=0
integer array YTI
integer array YRI
integer YPI=0
integer YQI
unit YUI
integer J0I
integer JII
unit J1I
real JOI
real J2I
real J3I
unit J4I
integer array J5I
boolean J6I=true
unit J7I
integer J8I
unit J9I
group JAI
real JBI
group JCI
real array JDI
integer array JEI
integer array JFI
integer JGI
integer JHI
integer JZI
unit JVI
integer JWI
integer JXI
sound JYI=null
boolean JJI=false
constant real JKI=300
integer JLI
integer JMI
integer array JNI
constant real JSI=200
constant real JTI=200
group JRI
unit JPI
integer JQI
constant real JUI=200
constant real K0I=200
group KII
unit K1I
integer KOI
constant real K2I=20
integer K3I
unit K4I
integer K5I
unit K6I
unit K7I
real K8I=1.35
real K9I=500
group KAI
trigger KBI
unit KCI
unit KDI=null
constant real KEI=6
constant real KFI=6
unit KGI
integer KHI
unit KZI
integer KVI
unit KWI
unit KXI
integer KYI
trigger KJI=null
constant real KKI=50
integer KLI
integer KMI
unit KNI
real KSI
real KTI
constant real KRI=600
group KPI
unit KQI
integer KUI
real L0I
real LII
integer L1I
constant real LOI=30
constant real L2I=800
unit L3I
unit L4I
group L5I
integer L6I
integer array L7I
boolean L8I
real L9I
integer LAI
unit LBI
constant real LCI=1200
group LDI
unit LEI
unit LFI
integer LGI
real LHI
integer LZI
integer LVI
unit LWI
unit LXI
real LYI
unit LJI
unit LKI
unit LLI
boolean LMI
integer LNI
constant real LSI=55
group LTI
unit LRI
unit LPI
timer LQI=null
real M0I=0.
real MII=0.
force MOI=null
boolexpr M2I=null

//全局系统变量
	real yd_MapMaxX = 0
	real yd_MapMinX = 0
	real yd_MapMaxY = 0
	real yd_MapMinY = 0

	boolean mu_is_lua_enable = false

	integer mu_disable_item_trigger_count = 0
	boolean mu_damage_dot = false
	boolean array mu_has_gag
	string mu_temp_string = ""
	boolean mu_has_init_dummy_player = false
	boolexpr mu_sync_dummy_messenger = null
	string mu_lua_string = null
	trigger mu_trigger_disable_move = null
	boolean mu_mode_up = false
endglobals

function MUCall takes string script, string void returns nothing
	if mu_is_lua_enable then
		call CopySaveGame(script, void)
	endif
endfunction

function MUPrint takes string str returns nothing
	set mu_lua_string = str
	call MUCall("print(globals.mu_lua_string)", null)
endfunction

//地图边界判断
function YDWECoordinateX takes real x returns real
    return RMinBJ(RMaxBJ(x, yd_MapMinX), yd_MapMaxX)
endfunction

function YDWECoordinateY takes real y returns real
    return RMinBJ(RMaxBJ(y, yd_MapMinY), yd_MapMaxY)
endfunction

//修正地图边界崩溃(表现为猴子BUG)
function MUSetUnitX takes unit u, real x returns nothing
	call SetUnitX(u, YDWECoordinateX(x))
endfunction

function MUSetUnitY takes unit u, real y returns nothing
	call SetUnitY(u, YDWECoordinateY(y))
endfunction

//修正物品计数错误(表现为林肯BUG)
function MUDisableItemTrigger takes nothing returns nothing
	set mu_disable_item_trigger_count = mu_disable_item_trigger_count + 1
	//call BJDebugMsg("物品事件禁用计数:" + I2S(mu_disable_item_trigger_count))
	if mu_disable_item_trigger_count == 1 then
		call DisableTrigger(LY0)
	endif
endfunction

function MUEnableItemTrigger takes nothing returns nothing
	set mu_disable_item_trigger_count = mu_disable_item_trigger_count - 1
	//call BJDebugMsg("物品事件禁用计数:" + I2S(mu_disable_item_trigger_count))
	if mu_disable_item_trigger_count == 0 then
		call EnableTrigger(LY0)
	endif
endfunction

//修正变身结束时死亡会导致无法控制的BUG(表现为狼人BUG)
function MUTransformRelieve takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local unit hero = LoadUnitHandle(LY, GetHandleId(t), 0)
	local integer id = LoadInteger(LY, GetHandleId(t), 0)
	call UnitAddAbility(hero, id)
	call UnitRemoveAbility(hero, id)
	call FlushChildHashtable(LY, GetHandleId(t))
	call DestroyTimer(t)
	set t = null
	set hero = null
endfunction

function MUTransformDebug takes unit hero, integer id, real time returns nothing
	local timer t = CreateTimer()
	call SaveUnitHandle(LY, GetHandleId(t), 0, hero)
	call SaveInteger(LY, GetHandleId(t), 0, id)
	call TimerStart(t, time - 0.01, false, function MUTransformRelieve)
	set t = null
endfunction

//禁言系统
//方法由 魔兽地图编辑器吧 的 al14156 提供,原帖地址:http://tieba.baidu.com/p/4304449474
function MUPlayerGag takes nothing returns nothing
	local string chat = GetEventPlayerChatString()
	local integer id
	local player target_player
	local integer player_id
	local integer i
	local string name
	if StringCase(SubString(chat, 0, 4), false) != "-jy " then
		return
	endif
	set id = S2I(SubString(chat, 4, StringLength(chat)))
	if id <= 0 or id > 10 then
		call DisplayTimedTextToPlayer(GetTriggerPlayer(), 0, 0, 10, "|cffffcc00请指定一个楼层为[1-10]的有效玩家|r")
		return
	endif
	if id <= 5 then
		set target_player = BO[id]
	else
		set target_player = CO[id - 5]
	endif
	if target_player == null then
		call DisplayTimedTextToPlayer(GetTriggerPlayer(), 0, 0, 10, "|cffffcc00请指定一个楼层为[1-10]的有效玩家|r")
		return
	endif
	set name = GetPlayerName(target_player)
	if GetTriggerPlayer() == GetLocalPlayer() then
		set player_id = GetPlayerId(target_player)
		set mu_has_gag[player_id] = not mu_has_gag[player_id]
		if mu_has_gag[player_id] then
			call DisplayTimedTextToPlayer(GetTriggerPlayer(), 0, 0, 10, "|cffffcc00你将不会再看到 " + name + " 的发言。再次输入该指令取消。（你依然可以在聊天记录里看到他的发言。）|r")
			set name = mu_temp_string + name
		else
			set name = SubString(GetPlayerName(target_player), 200, StringLength(GetPlayerName(target_player)))
			call DisplayTimedTextToPlayer(GetTriggerPlayer(), 0, 0, 10, "|cffffcc00你现在可以看到 " + name + " 的发言了。|r")
		endif
	endif
	call SetPlayerName(target_player, name)
	set target_player = null
endfunction

//共享信使
function MUInitDummyPlayer takes integer id1, integer id2 returns nothing
	local integer i
	if mu_has_init_dummy_player then
		return
	endif
	set mu_has_init_dummy_player = true
	// 颜色
	set C0[id1] = C0[0]
	set C0[id2] = C0[6]
	call SetPlayerColor(Player(id1), GetPlayerColor(BO[0]))
	call SetPlayerColor(Player(id2), GetPlayerColor(CO[0]))
	// 名字
	call SetPlayerName(Player(id1), GetPlayerName(BO[0]))
	call SetPlayerName(Player(id2), GetPlayerName(CO[0]))
	set D80[id1] = GetPlayerName(Player(id1))
	set D80[id2] = GetPlayerName(Player(id2))
	// 队伍
	call SetPlayerTeam(Player(id1), 0)
	call SetPlayerTeam(Player(id2), 1)
	// 结盟
	set i = 0
	loop
		call SetPlayerAlliance(Player(id1), BO[i], ConvertAllianceType(0), true)
		call SetPlayerAlliance(Player(id1), BO[i], ConvertAllianceType(1), true)
		call SetPlayerAlliance(Player(id1), BO[i], ConvertAllianceType(2), true)
		call SetPlayerAlliance(Player(id1), BO[i], ConvertAllianceType(3), true)
		call SetPlayerAlliance(Player(id1), BO[i], ConvertAllianceType(4), true)
		call SetPlayerAlliance(BO[i], Player(id1), ConvertAllianceType(0), true)
		call SetPlayerAlliance(BO[i], Player(id1), ConvertAllianceType(1), true)
		call SetPlayerAlliance(BO[i], Player(id1), ConvertAllianceType(2), true)
		call SetPlayerAlliance(BO[i], Player(id1), ConvertAllianceType(3), true)
		call SetPlayerAlliance(BO[i], Player(id1), ConvertAllianceType(4), true)
		call SetPlayerAlliance(Player(id1), CO[i], ConvertAllianceType(0), false)
		call SetPlayerAlliance(Player(id1), CO[i], ConvertAllianceType(1), false)
		call SetPlayerAlliance(Player(id1), CO[i], ConvertAllianceType(2), false)
		call SetPlayerAlliance(Player(id1), CO[i], ConvertAllianceType(3), false)
		call SetPlayerAlliance(Player(id1), CO[i], ConvertAllianceType(4), false)
		call SetPlayerAlliance(CO[i], Player(id1), ConvertAllianceType(0), false)
		call SetPlayerAlliance(CO[i], Player(id1), ConvertAllianceType(1), false)
		call SetPlayerAlliance(CO[i], Player(id1), ConvertAllianceType(2), false)
		call SetPlayerAlliance(CO[i], Player(id1), ConvertAllianceType(3), false)
		call SetPlayerAlliance(CO[i], Player(id1), ConvertAllianceType(4), false)
		set i = i + 1
		exitwhen i > 5
	endloop
	set i = 0
	loop
		call SetPlayerAlliance(Player(id2), CO[i], ConvertAllianceType(0), true)
		call SetPlayerAlliance(Player(id2), CO[i], ConvertAllianceType(1), true)
		call SetPlayerAlliance(Player(id2), CO[i], ConvertAllianceType(2), true)
		call SetPlayerAlliance(Player(id2), CO[i], ConvertAllianceType(3), true)
		call SetPlayerAlliance(Player(id2), CO[i], ConvertAllianceType(4), true)
		call SetPlayerAlliance(CO[i], Player(id2), ConvertAllianceType(0), true)
		call SetPlayerAlliance(CO[i], Player(id2), ConvertAllianceType(1), true)
		call SetPlayerAlliance(CO[i], Player(id2), ConvertAllianceType(2), true)
		call SetPlayerAlliance(CO[i], Player(id2), ConvertAllianceType(3), true)
		call SetPlayerAlliance(CO[i], Player(id2), ConvertAllianceType(4), true)
		call SetPlayerAlliance(Player(id2), BO[i], ConvertAllianceType(0), false)
		call SetPlayerAlliance(Player(id2), BO[i], ConvertAllianceType(1), false)
		call SetPlayerAlliance(Player(id2), BO[i], ConvertAllianceType(2), false)
		call SetPlayerAlliance(Player(id2), BO[i], ConvertAllianceType(3), false)
		call SetPlayerAlliance(Player(id2), BO[i], ConvertAllianceType(4), false)
		call SetPlayerAlliance(BO[i], Player(id2), ConvertAllianceType(0), false)
		call SetPlayerAlliance(BO[i], Player(id2), ConvertAllianceType(1), false)
		call SetPlayerAlliance(BO[i], Player(id2), ConvertAllianceType(2), false)
		call SetPlayerAlliance(BO[i], Player(id2), ConvertAllianceType(3), false)
		call SetPlayerAlliance(BO[i], Player(id2), ConvertAllianceType(4), false)
		set i = i + 1
		exitwhen i > 5
	endloop
	set i = 0
	loop
		call SetPlayerAlliance(Player(id1), Player(15), ConvertAllianceType(i), true)
		call SetPlayerAlliance(Player(15), Player(id1), ConvertAllianceType(i), true)
		call SetPlayerAlliance(Player(id2), Player(15), ConvertAllianceType(i), true)
		call SetPlayerAlliance(Player(15), Player(id2), ConvertAllianceType(i), true)
		set i = i + 1
		exitwhen i > 5
	endloop
endfunction

function MUCreateDummyMessenger takes unit messenger, player owner, player origin_owner returns nothing
	local unit dummy = CreateUnit(owner, 'e00E', GetUnitX(messenger), GetUnitY(messenger), 0)
	local trigger trg = CreateTrigger()
	if owner != origin_owner then
		call UnitSetUsesAltIcon(dummy, true)
	endif
	call SetUnitFlyHeight(dummy, 10000, 0)
	call UnitAddAbility(dummy, 'Avul')
	call UnitAddAbility(dummy, 'AInv')
	call SaveUnitHandle(LY, GetHandleId(trg), 1, dummy)
	call SaveUnitHandle(LY, GetHandleId(trg), 2, messenger)
	call SavePlayerHandle(LY, GetHandleId(trg), 3, owner)
	call SavePlayerHandle(LY, GetHandleId(trg), 4, origin_owner)
	call TriggerRegisterTimerEvent(trg, 0.1, true)
	call TriggerRegisterUnitEvent(trg, messenger, EVENT_UNIT_PICKUP_ITEM)
	call TriggerRegisterUnitEvent(trg, messenger, EVENT_UNIT_DROP_ITEM)
	call TriggerRegisterUnitEvent(trg, messenger, EVENT_UNIT_CHANGE_OWNER)
	call TriggerAddCondition(trg, mu_sync_dummy_messenger)
	set dummy = null
	set trg = null
endfunction

function MUSyncDummyMessenger takes nothing returns nothing
	local trigger trg = GetTriggeringTrigger()
	local unit dummy = LoadUnitHandle(LY, GetHandleId(trg), 1)
	local unit messenger = LoadUnitHandle(LY, GetHandleId(trg), 2)
	local boolean need_sync_items = LoadBoolean(LY, GetHandleId(trg), 5)
	local integer i
	local item it
	if GetTriggerEventId() == EVENT_GAME_TIMER_EXPIRED then
		call UnitPauseTimedLife(dummy, true)
		if IsUnitType(messenger, UNIT_TYPE_DEAD) then
			call ShowUnit(dummy, false)
		else
			call ShowUnit(dummy, true)
			call SetUnitX(dummy, GetUnitX(messenger))
			call SetUnitY(dummy, GetUnitY(messenger))
		endif
		if IsUnitType(dummy, UNIT_TYPE_DEAD) then
			call MUCreateDummyMessenger(messenger, LoadPlayerHandle(LY, GetHandleId(trg), 3), LoadPlayerHandle(LY, GetHandleId(trg), 4))
			call DestroyTrigger(trg)
			call FlushChildHashtable(LY, GetHandleId(trg))
			call MUPrint("信使马甲死亡")
		endif
	elseif GetTriggerEventId() == EVENT_UNIT_CHANGE_OWNER then
		// 删除马甲身上的物品
		call MUDisableItemTrigger()
		set i = 0
		loop
			set it = UnitItemInSlot(dummy, i)
			if it != null then
				call RemoveItem(it)
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
		set it = null
		call MUEnableItemTrigger()
		// 删除马甲并清空
		call RemoveUnit(dummy)
		call DestroyTrigger(trg)
		call FlushChildHashtable(LY, GetHandleId(trg))
	else
		call SaveBoolean(LY, GetHandleId(trg), 5, true)
	endif
	if need_sync_items and GetTriggerEventId() == EVENT_GAME_TIMER_EXPIRED then
		call SaveBoolean(LY, GetHandleId(trg), 5, false)
		call MUCall("performance_statistics_start()", null)
		// 同步马甲身上的物品
		call MUDisableItemTrigger()
		// 先删掉马甲身上的物品
		set i = 0
		loop
			set it = UnitItemInSlot(dummy, i)
			if it != null then
				call RemoveItem(it)
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
		// 然后同步物品
		set i = 0
		loop
			set it = UnitItemInSlot(messenger, i)
			if it == null or (GetTriggerEventId() == EVENT_UNIT_DROP_ITEM and it == GetManipulatedItem()) then
				// 创建占位物品
				set it = CreateItem('I02M', 0, 0)
			else
				set it = CreateItem(GetItemTypeId(it), 0, 0)
			endif
			if not UnitAddItem(dummy, it) then
				call RemoveItem(it)
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
		// 最后删掉占位物品
		set i = 0
		loop
			set it = UnitItemInSlot(dummy, i)
			if GetItemTypeId(it) == 'I02M' then
				call RemoveItem(it)
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
		set it = null
		call MUEnableItemTrigger()
		call MUCall("performance_statistics_stop()", null)
	endif
	set trg = null
	set dummy = null
	set messenger = null
endfunction

function MUGetMessengerOwner takes unit messenger returns player
	return LoadPlayerHandle(LY, GetHandleId(messenger), StringHash("信使所有者"))
endfunction

function MUIsMessenger takes unit messenger returns boolean
	return MUGetMessengerOwner(messenger) != null
endfunction

function MUIsMessengerShared takes unit messenger returns boolean
	return GetOwningPlayer(messenger) != MUGetMessengerOwner(messenger)
endfunction

function MUIsPlayerMessengerShared takes player target returns boolean
	return LoadBoolean(LY, GetHandleId(target), StringHash("信使共享"))
endfunction

function MUSetMessengerNotShare takes unit messenger returns nothing
	local player owner = MUGetMessengerOwner(messenger)
	local integer i
	call MUPrint("关闭信使共享:" + I2S(GetHandleId(messenger)))
	if owner == null then
		call MUPrint("信使所有者错误")
		return
	endif
	call SetUnitOwner(messenger, owner, false)
	if GetPlayerTeam(owner) == 0 then
		set i = 1
		loop
			if BO[i] != owner then
				call DisplayTimedTextToPlayer(BO[i], 0, 0, 10, "|cffffff11你不再能控制" + C0[GetPlayerId(owner)] + GetPlayerName(owner) + "|cffffff11的信使了|r")
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
	else
		set i = 1
		loop
			if CO[i] != owner then
				call DisplayTimedTextToPlayer(CO[i], 0, 0, 10, "|cffffff11你不再能控制" + C0[GetPlayerId(owner)] + GetPlayerName(owner) + "|cffffff11的信使了|r")
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
	endif
	set owner = null
endfunction

function MUSetMessengerShare takes unit messenger returns nothing
	local player owner = MUGetMessengerOwner(messenger)
	local integer team = GetPlayerTeam(owner)
	local player target_player = null
	local string name
	local integer i
	call MUPrint("开启信使共享:" + I2S(GetHandleId(messenger)))
	if team == 0 then
		if BO[0] == Player(0) then
			set target_player = Player(13)
			call MUInitDummyPlayer(13, 14)
		elseif BO[0] == Player(13) then
			set target_player = Player(0)
			call MUInitDummyPlayer(0, 6)
		endif
	elseif team == 1 then
		if CO[0] == Player(6) then
			set target_player = Player(14)
			call MUInitDummyPlayer(13, 14)
		elseif CO[0] == Player(14) then
			set target_player = Player(6)
			call MUInitDummyPlayer(0, 6)
		endif
	endif
	if target_player == null then
		call MUPrint("信使共享没有找到目标玩家")
		return
	endif
	call SavePlayerHandle(LY, GetHandleId(owner), StringHash("信使共享玩家"), target_player)
	call UnitSetUsesAltIcon(messenger, true)
	call SetUnitOwner(messenger, target_player, false)
	call SetPlayerAbilityAvailable(target_player, 'A1VV', false)
	call SetPlayerAbilityAvailable(target_player, 'A2XM', false)
	call SetPlayerAbilityAvailable(target_player, 'A29N', false)
	set name = GetPlayerName(target_player)
	call SetPlayerName(target_player, C0[GetPlayerId(target_player)] + "动物信使|r")
	if team == 0 then
		set i = 1
		loop
			call SetPlayerAlliance(target_player, BO[i], ALLIANCE_SHARED_CONTROL, true)
			call UnitShareVision(messenger, BO[i], true)
			call MUCreateDummyMessenger(messenger, BO[i], owner)
			if BO[i] != owner then
				call DisplayTimedTextToPlayer(BO[i], 0, 0, 10, "|cffffff11你可以控制" + C0[GetPlayerId(owner)] + GetPlayerName(owner) + "|cffffff11的信使了|r")
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
	elseif team == 1 then
		set i = 1
		loop
			call SetPlayerAlliance(target_player, CO[i], ALLIANCE_SHARED_CONTROL, true)
			call UnitShareVision(messenger, CO[i], true)
			call MUCreateDummyMessenger(messenger, CO[i], owner)
			if CO[i] != owner then
				call DisplayTimedTextToPlayer(CO[i], 0, 0, 10, "|cffffff11你可以控制" + C0[GetPlayerId(owner)] + GetPlayerName(owner) + "|cffffff11的信使了|r")
			endif
			set i = i + 1
			exitwhen i > 5
		endloop
	endif
	call SetPlayerName(target_player, name)
	set target_player = null
	set owner = null
endfunction

function MUChangeMessengerShare takes player target returns nothing
	local boolean flag = not MUIsPlayerMessengerShared(target)
	local group temp_group = CreateGroup()
	local unit enum_unit
	if flag then
		call DisplayTimedTextToPlayer(target, 0, 0, 10, "|cffffff11已开启信使共享|r")
		call GroupEnumUnitsOfPlayer(temp_group, target, null)
	else
		call DisplayTimedTextToPlayer(target, 0, 0, 10, "|cffffff11已关闭信使共享|r")
		call GroupEnumUnitsOfPlayer(temp_group, LoadPlayerHandle(LY, GetHandleId(target), StringHash("信使共享玩家")), null)
	endif
	call SaveBoolean(LY, GetHandleId(target), StringHash("信使共享"), flag)

	loop
		set enum_unit = FirstOfGroup(temp_group)
		exitwhen enum_unit == null
		call GroupRemoveUnit(temp_group, enum_unit)
		if MUIsMessenger(enum_unit) then
			if flag then
				if not MUIsMessengerShared(enum_unit) then
					call MUSetMessengerShare(enum_unit)
				endif
			else
				if MUIsMessengerShared(enum_unit) then
					call MUSetMessengerNotShare(enum_unit)
				endif
			endif
		endif
	endloop
	call DestroyGroup(temp_group)
	set temp_group = null
endfunction

function MUInitMessenger takes unit messenger returns nothing
	call SavePlayerHandle(LY, GetHandleId(messenger), StringHash("信使所有者"), GetOwningPlayer(messenger))
	if MUIsPlayerMessengerShared(GetOwningPlayer(messenger)) then
		call MUSetMessengerShare(messenger)
	endif
endfunction

function MUSpellFinish takes nothing returns nothing
	local integer skill_id = GetSpellAbilityId()
	if skill_id == 'A093' then
		// 狼人4技能
		call MUTransformDebug(GetTriggerUnit(), 'AU00', 18)
	elseif skill_id == 'A2NE' then
		// 冰龙1技能
		call MUTransformDebug(GetTriggerUnit(), 'AU01', 6)
	endif
endfunction

function MUSpellEffect takes nothing returns nothing
	local integer skill_id = GetSpellAbilityId()
	if skill_id == 'AU02' then
		// 共享信使
		call MUChangeMessengerShare(GetTriggerPlayer())
	endif
endfunction

//生命上限
function MUAddMaxLife takes unit target, integer life returns nothing
	local integer array id
	local integer i = 15
	local integer current = 32768
	local integer level
	if life == 0 then
		return
	elseif life > 0 then
		set level = 3
	else
		set level = 2
		set life = - life
	endif
	set id[0]  = 'YDl0'
	set id[1]  = 'YDl1'
	set id[2]  = 'YDl2'
	set id[3]  = 'YDl3'
	set id[4]  = 'YDl4'
	set id[5]  = 'YDl5'
	set id[6]  = 'YDl6'
	set id[7]  = 'YDl7'
	set id[8]  = 'YDl8'
	set id[9]  = 'YDl9'
	set id[10] = 'YDla'
	set id[11] = 'YDlb'
	set id[12] = 'YDlc'
	set id[13] = 'YDld'
	set id[14] = 'YDle'
	set id[15] = 'YDlf'
	loop
		exitwhen life == 0 or i == 0
		if life >= current then
			call UnitAddAbility(target, id[i])
			call SetUnitAbilityLevel(target, id[i], level)
			call UnitRemoveAbility(target, id[i])
			set life = life - current
		endif
		set i = i - 1
		set current = current / 2
	endloop
endfunction

//禁止移动马甲英雄
function MUTimerStop takes nothing returns nothing
	local timer t = GetExpiredTimer()
	local integer handle_id = GetHandleId(t)
	local unit u = LoadUnitHandle(LY, handle_id, 1)
	call IssueImmediateOrder(u, "stop")
	call DestroyTimer(t)
	call FlushChildHashtable(LY, handle_id)
	set t = null
	set u = null
endfunction

function MUStopUnit takes nothing returns nothing
	local unit dummy = GetTriggerUnit()
	local timer t = CreateTimer()
	call SaveUnitHandle(LY, GetHandleId(t), 1, dummy)
	call TimerStart(t, 0, false, function MUTimerStop)
	set t = null
	set dummy = null
endfunction

function MUDisableMove takes unit dummy returns nothing
	call TriggerRegisterUnitEvent(mu_trigger_disable_move, dummy, EVENT_UNIT_ISSUED_TARGET_ORDER)
	call TriggerRegisterUnitEvent(mu_trigger_disable_move, dummy, EVENT_UNIT_ISSUED_POINT_ORDER)
endfunction

function MUShareVision takes unit dummy returns nothing
    local integer i = 0
    loop
        exitwhen i > 11
        call UnitShareVision(dummy, Player(i), true)
        set i = i + 1
    endloop
endfunction

//===========================================================================
//===========================================================================
//地图初始化
//===========================================================================
//===========================================================================
function InitializeYD takes nothing returns nothing
	local rect world_bounds = null
	local trigger trg = null
	local integer i = 0

	call Cheat("exec-lua:poi\\dota\\init")
	call MUPrint("Hello Loli!")

	//=================设置变量=====================
	set world_bounds = GetWorldBounds()
	set yd_MapMinX = GetRectMinX(world_bounds)
	set yd_MapMinY = GetRectMinY(world_bounds)
	set yd_MapMaxX = GetRectMaxX(world_bounds)
	set yd_MapMaxY = GetRectMaxY(world_bounds)
	call RemoveRect(world_bounds)
	set world_bounds = null

	//================技能事件=======================
	set trg = CreateTrigger()
	set i = 0
	loop
		call TriggerRegisterPlayerUnitEvent(trg, Player(i), EVENT_PLAYER_UNIT_SPELL_FINISH , null)
		set i = i + 1
		exitwhen i > 15
	endloop
	call TriggerAddCondition(trg, Condition(function MUSpellFinish))
	set trg = null

	set trg = CreateTrigger()
	set i = 0
	loop
		call TriggerRegisterPlayerUnitEvent(trg, Player(i), EVENT_PLAYER_UNIT_SPELL_EFFECT , null)
		set i = i + 1
		exitwhen i > 15
	endloop
	call TriggerAddCondition(trg, Condition(function MUSpellEffect))
	set trg = null

	//================禁言系统=======================
	set trg = CreateTrigger()
	set i = 0
	loop
		call TriggerRegisterPlayerChatEvent(trg, Player(i), "-JY ", false)
		set i = i + 1
		exitwhen i > 15
	endloop
	call TriggerAddCondition(trg, Condition(function MUPlayerGag))
	set trg = null

	set i = 1
	loop
		set mu_temp_string = mu_temp_string + "|r"
		set i = i + 1
		exitwhen i > 100
	endloop

	//===============信使系统=========================
	set mu_sync_dummy_messenger = Condition(function MUSyncDummyMessenger)

	//===============禁止移动马甲英雄===================
	set trg = CreateTrigger()
	set mu_trigger_disable_move = trg
	call TriggerAddCondition(trg, Condition(function MUStopUnit))
	set trg = null
endfunction

function M4I takes real M5I returns nothing
local real M6I
local real st=TimerGetElapsed(LQI)
if st<=0 then
set LQI=CreateTimer()
call TimerStart(LQI,1000000,false,null)
endif
if(M5I>0)then
loop
set M6I=M5I-TimerGetElapsed(LQI)+st
exitwhen M6I<=0
if(M6I>bj_POLLED_WAIT_SKIP_THRESHOLD)then
call TriggerSleepAction(0.1*M6I)
else
call TriggerSleepAction(bj_POLLED_WAIT_INTERVAL)
endif
endloop
endif
endfunction
function M7I takes location M8I,real M9I,real MAI returns location
return Location(GetLocationX(M8I)+M9I*Cos(MAI*bj_DEGTORAD),GetLocationY(M8I)+M9I*Sin(MAI*bj_DEGTORAD))
endfunction
function MBI takes nothing returns boolean
local real dx=GetDestructableX(GetFilterDestructable())-M0I
local real dy=GetDestructableY(GetFilterDestructable())-MII
return(dx*dx+dy*dy<=bj_enumDestructableRadius)
endfunction
function MCI takes player MDI returns force
set MOI=CreateForce()
call ForceEnumEnemies(MOI,MDI,M2I)
return MOI
endfunction
function MEI takes itemtype MFI,integer MGI returns nothing
local group g
set bj_stockPickedItemType=MFI
set bj_stockPickedItemLevel=MGI
set g=CreateGroup()
call GroupEnumUnitsOfType(g,"marketplace",M2I)
call ForGroup(g,function UpdateEachStockBuildingEnum)
call DestroyGroup(g)
set g=null
endfunction
function MHI takes nothing returns nothing
local integer pickedItemId
local itemtype MZI
local integer MVI=0
local integer MWI=0
local integer MGI
set MGI=1
loop
if(bj_stockAllowedPermanent[MGI])then
set MWI=MWI+1
if(GetRandomInt(1,MWI)==1)then
set MZI=ITEM_TYPE_PERMANENT
set MVI=MGI
endif
endif
if(bj_stockAllowedCharged[MGI])then
set MWI=MWI+1
if(GetRandomInt(1,MWI)==1)then
set MZI=ITEM_TYPE_CHARGED
set MVI=MGI
endif
endif
if(bj_stockAllowedArtifact[MGI])then
set MWI=MWI+1
if(GetRandomInt(1,MWI)==1)then
set MZI=ITEM_TYPE_ARTIFACT
set MVI=MGI
endif
endif
set MGI=MGI+1
exitwhen MGI>10
endloop
if(MWI==0)then
set MZI=null
return
endif
call MEI(MZI,MVI)
set MZI=null
endfunction
function MXI takes nothing returns nothing
call MHI()
call TimerStart(bj_stockUpdateTimer,bj_STOCK_RESTOCK_INTERVAL,true,function MHI)
endfunction
function MJI takes nothing returns boolean
return true
endfunction
function MQI takes nothing returns nothing
call DisplayTimedTextToPlayer(GetEnumPlayer(),0,U2,MJ,LJ)
endfunction
function MUI takes force N0I,real M5I,string NII returns nothing
set LJ=NII
set MJ=M5I
call ForForce(N0I,function MQI)
endfunction
function N1I takes nothing returns boolean
return true
endfunction
function InitializeHashtable takes nothing returns nothing
set LY=InitHashtable()
endfunction
function HLC_GetCommandString takes nothing returns string
return MY
endfunction
function NOI takes nothing returns nothing
local integer i
local integer j
local integer h
local integer v
local string N2I="abcdefghijklmnopqrstuvwxyz0123456789 -=,."
local integer array N3I
local boolean array N4I
set N4I[0]=true
set N4I[50]=true
set N4I[60]=true
set N4I[70]=true
set N4I[80]=true
set N4I[90]=true
set N4I[100]=true
set i=0
set j=0
loop
if N4I[j]then
set j=j+1
endif
exitwhen j>=256
set N3I[j]=i
set i=i+1
set j=j+1
endloop
set i=0
loop
exitwhen i>=12
set h=R2I(100*GetPlayerHandicap(Player(i)))
if not N4I[h]then
set h=N3I[h]
set v=h/6
set h=h-v*6
call SetPlayerHandicap(Player(i),1)
set MY=MY+SubString(N2I,v,v+1)
endif
set i=i+1
endloop
endfunction
function N5I takes multiboard N6I,integer c,integer r,string N7I returns nothing
local multiboarditem N8I=null
set N8I=MultiboardGetItem(N6I,r-1,c-1)
call MultiboardSetItemValue(N8I,N7I)
call MultiboardReleaseItem(N8I)
set N8I=null
endfunction
function N9I takes multiboard N6I,integer c,integer r,string NAI returns nothing
local multiboarditem N8I=null
set N8I=MultiboardGetItem(N6I,r-1,c-1)
call MultiboardSetItemIcon(N8I,NAI)
call MultiboardReleaseItem(N8I)
set N8I=null
endfunction
function NBI takes multiboard N6I,integer c,integer r,boolean NCI,boolean NDI returns nothing
local multiboarditem N8I=null
set N8I=MultiboardGetItem(N6I,r-1,c-1)
call MultiboardSetItemStyle(N8I,NCI,NDI)
call MultiboardReleaseItem(N8I)
set N8I=null
endfunction
function NEI takes multiboard N6I,integer c,integer r,real NFI,real NGI,real NHI,real NZI returns nothing
local multiboarditem N8I=null
set N8I=MultiboardGetItem(N6I,r-1,c-1)
call MultiboardSetItemValueColor(N8I,PercentTo255(NFI),PercentTo255(NGI),PercentTo255(NHI),PercentTo255(100.0-NZI))
call MultiboardReleaseItem(N8I)
set N8I=null
endfunction
function NVI takes multiboard N6I,integer c,integer r,real NWI returns nothing
local multiboarditem N8I=null
set N8I=MultiboardGetItem(N6I,r-1,c-1)
call MultiboardSetItemWidth(N8I,NWI/100)
call MultiboardReleaseItem(N8I)
set N8I=null
endfunction
function TI_RequestBugReport takes nothing returns nothing
local integer i=0
if Q2==false and RA0==false then
loop
call DisplayTimedTextToPlayer(Player(i),0,0,120,"|c00ff0303An internal index has failed|r")
call DisplayTimedTextToPlayer(Player(i),0,0,120,"|c00ff0303This might not be a serious glitch, but it is important for me to get it|r")
call DisplayTimedTextToPlayer(Player(i),0,0,120,"|c00ff0303Please send me the replay for this game to IceFrog@gmail.com|r")
set i=i+1
exitwhen i==12
endloop
endif
endfunction
function NXI takes integer i returns nothing
if i>16000 then
set TY[i-16000]=null
elseif i>8000 then
set SY[i-8000]=null
else
set NY[i]=null
endif
endfunction
function NYI takes integer i returns unit
if i>16000 then
return TY[i-16000]
elseif i>8000 then
return SY[i-8000]
else
return NY[i]
endif
endfunction
function NJI takes integer i returns destructable
if i>16000 then
return UY[i-16000]
elseif i>8000 then
return QY[i-8000]
else
return PY[i]
endif
return PY[i]
endfunction
function NKI takes unit u returns integer
set RY=RY+1
if RY>16000 then
set TY[RY-16000]=u
elseif RY>8000 then
set SY[RY-8000]=u
else
set NY[RY]=u
endif
return RY
endfunction
function NLI takes integer i returns nothing
if i>16000 then
set UY[i-16000]=null
elseif i>8000 then
set QY[i-8000]=null
else
set PY[i]=null
endif
endfunction
function NMI takes destructable d returns integer
set IJ=IJ+1
if IJ>24000 then
set UY[IJ-16000]=d
elseif IJ>8000 then
set QY[IJ-8000]=d
else
set PY[IJ]=d
endif
return IJ
endfunction
function GetTime takes nothing returns real
return TimerGetElapsed(M)
endfunction
// 单位是否可以抵挡技能(判断林肯等)
function CanResistSkill takes unit u returns boolean
return GetUnitAbilityLevel(u,'B0BI')>0 or GetUnitAbilityLevel(u,'BNss')>0 or GetUnitAbilityLevel(u,'B0EV')>0
endfunction
function NSI takes group g returns nothing
local integer i=GetHandleId(g)-BJ
if i<0 or i>120 then
set DJ=true
else
call GroupClear(g)
set AJ[i]=false
set CJ=i
endif
endfunction
function NTI takes nothing returns group
local integer i=CJ
loop
exitwhen i==CJ-1
if AJ[i]==false then
set CJ=i+1
if CJ==120 then
set CJ=0
endif
set AJ[i]=true
return OJ[i]
endif
set i=i+1
if i==120 then
set i=0
endif
endloop
call MUI(P2,5.00,"|c00ff0303CRITICAL ERROR: FOUND NO AVAILABLE GROUPS|r")
call MUI(P2,5.00,"|c00ff0303Send this replay to IceFrog@gmail.com|r")
return CreateGroup()
endfunction
function NRI takes nothing returns boolean
local integer NPI=0
local integer i=0
loop
exitwhen i==120
if AJ[i]==true then
set NPI=NPI+1
endif
set i=i+1
endloop
if NPI>100 or DJ then
call MUI(P2,5.00,"|c00ff0303Please send me this replay ("+I2S(NPI)+")")
endif
return false
endfunction
function NQI takes nothing returns nothing
local integer i=0
set CJ=0
set OJ[i]=CreateGroup()
set AJ[i]=false
set i=i+1
set BJ=GetHandleId(OJ[0])
loop
exitwhen i==120
set OJ[i]=CreateGroup()
set AJ[i]=false
set i=i+1
endloop
endfunction
function NUI takes nothing returns nothing
local integer i=0
if Q2==false and RA0==false then
loop
call DisplayTimedTextToPlayer(Player(i),0,0,120,"|c00ff0303An internal checksum has failed|r")
call DisplayTimedTextToPlayer(Player(i),0,0,120,"|c00ff0303This might not be a serious glitch, but it is important for me to get it|r")
call DisplayTimedTextToPlayer(Player(i),0,0,120,"|c00ff0303Please send me the replay for this game to IceFrog@gmail.com|r")
set i=i+1
exitwhen i==12
endloop
endif
endfunction
function CleanTrigger_GetTime takes nothing returns real
return TimerGetElapsed(M)
endfunction
function FlushTrigger takes trigger t returns nothing
call DisableTrigger(t)
set GJ=GJ+1
set EJ[GJ]=t
set FJ[GJ]=(TimerGetElapsed(M))+60
if GJ>8000 then
call NUI()
endif
endfunction
function SII takes integer i returns nothing
if i!=GJ then
set EJ[i]=EJ[GJ]
set FJ[i]=FJ[GJ]
endif
set EJ[GJ]=null
set FJ[GJ]=0
set GJ=GJ-1
endfunction
function S1I takes nothing returns boolean
local real SOI=(TimerGetElapsed(M))
local integer i
set i=1
loop
	exitwhen i>GJ
	if FJ[i]<SOI then
		if EJ[i]==null or IsTriggerEnabled(EJ[i])==true then
			call NUI()
		else
			call DestroyTrigger(EJ[i])
		endif
		call SII(i)
	else
		set i=i+1
	endif
endloop
return false
endfunction
function S4I takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(((LoadTriggerHandle(LY,(handle_id),(35)))))),(((LoadInteger(LY,(handle_id),(33))))),(2))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function S6I takes trigger t,integer S7I,real M5I returns nothing
local trigger t2=CreateTrigger()
call TriggerAddCondition(t2,Condition(function S4I))
call TriggerRegisterTimerEvent(t2,M5I,false)
call SaveInteger(LY,(GetHandleId((t))),((S7I)),(1))
call SaveTriggerHandle(LY,(GetHandleId(t2)),(35),(t))
call SaveInteger(LY,(GetHandleId(t2)),(33),(S7I))
set t2=null
endfunction
function S8I takes unit u returns string
if u==null then
return "没有英雄"
endif
return GetObjectName(DD0[GetUnitPointValue(u)])
endfunction
function S9I takes integer i returns string
if i==0 then
return "没有英雄"
endif
return GetObjectName(DD0[i])
endfunction
function SAI takes unit u returns string
if u==null then
return"UI\\Widgets\\Console\\Undead\\undead-inventory-slotfiller.blp"
endif
return DS0[GetUnitPointValue(u)]
endfunction
function SBI takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(((LoadUnitHandle(LY,(handle_id),(14)))))),(((LoadInteger(LY,(handle_id),(33))))),(2))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function SCI takes unit SDI,integer S7I,real M5I returns nothing
local trigger t=CreateTrigger()
call TriggerAddCondition(t,Condition(function SBI))
call TriggerRegisterTimerEvent(t,M5I,false)
call SaveInteger(LY,(GetHandleId((SDI))),((S7I)),(1))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SDI))
call SaveInteger(LY,(GetHandleId(t)),(33),(S7I))
set t=null
endfunction
function SEI takes unit SFI returns integer
local integer x
local integer id=GetUnitTypeId(SFI)
set x=1
loop
exitwhen x>DV0
if id==DZ0[x]then
return 2
endif
set x=x+1
endloop
set x=1
loop
exitwhen x>DX0
if id==DW0[x]then
return 3
endif
set x=x+1
endloop
set x=1
loop
exitwhen x>DJ0
if id==DY0[x]then
return 1
endif
set x=x+1
endloop
if id=='Eevm' or id=='E02V' or id=='E02W' or id=='E02U' or id=='N02B' or id=='N017' or id=='H08D' or id=='H08C' or id=='H084' or id=='H08B' or id=='N013' or id=='N014' or id=='N015' or id=='E02O' or id=='N0MM' then
return 2
endif
if id=='N01H' or id=='N01T' or id=='N01J' or id=='H00E' or id=='H00G' or id=='H00F' or id=='H07I' or id=='E015' or id=='H0CQ' or id=='H0E3' or id=='H0E4' or id=='H0E5' or id=='U01X' or id=='N0MW' then
return 3
endif
if id=='H06X' or id=='H06Y' or id=='H06W' or id=='H0BC' or id=='O017' or id=='N0MB' or id=='N0MC' or id=='N0MO' or id=='N0MA' then
return 1
endif
return 0
endfunction
function SGI takes integer id returns integer
local integer x
set x=1
loop
exitwhen x>DV0
if id==DZ0[x]then
return 2
endif
set x=x+1
endloop
set x=1
loop
exitwhen x>DX0
if id==DW0[x]then
return 3
endif
set x=x+1
endloop
set x=1
loop
exitwhen x>DJ0
if id==DY0[x]then
return 1
endif
set x=x+1
endloop
if id=='Eevm' or id=='E02V' or id=='E02W' or id=='E02U' or id=='N02B' or id=='N017' or id=='H08D' or id=='H08C' or id=='H084' or id=='H08B' or id=='N013' or id=='N014' or id=='N015' or id=='E02O' or id=='N0MM' then
return 2
endif
if id=='N01H' or id=='N01T' or id=='N01J' or id=='H00E' or id=='H00G' or id=='H00F' or id=='H07I' or id=='E015' or id=='H0CQ' or id=='H0E3' or id=='H0E4' or id=='H0E5' or id=='U01X' then
return 3
endif
if id=='H06X' or id=='H06Y' or id=='H06W' or id=='H0BC' or id=='O017' or id=='N0MB' or id=='N0MC' or id=='N0MO' or id=='N0MA' then
return 1
endif
return 0
endfunction
function SHI takes unit SFI returns integer
local integer SZI=SEI(SFI)
if SZI==1 then
return GetHeroInt(SFI,true)
endif
if SZI==2 then
return GetHeroAgi(SFI,true)
endif
if SZI==3 then
return GetHeroStr(SFI,true)
endif
return 0
endfunction
function SVI takes unit SWI returns boolean
return GetUnitState(SWI,UNIT_STATE_LIFE)<1 or HJ[GetPlayerId(GetOwningPlayer(SWI))]==true
endfunction
function SYI takes integer SJI,real SKI,integer SLI returns nothing
set XJ=XJ+1
set ZJ[XJ]=SKI
set VJ[XJ]=SJI
set WJ[XJ]=SLI
endfunction
function SMI takes unit u returns real
local integer SJI=GetUnitTypeId(u)
local integer i=1
loop
exitwhen i>XJ
if VJ[i]==SJI or WJ[i]==SJI then
return ZJ[i]
endif
set i=i+1
endloop
return 1.0
endfunction
function SNI takes integer SSI,string STI returns nothing
set KJ=KJ+1
set YJ[KJ]=STI
set JJ[KJ]=SSI
endfunction
function SRI takes unit u returns string
local integer SSI=GetUnitTypeId(u)
local integer i=1
loop
exitwhen i>KJ
if JJ[i]==SSI then
return YJ[i]
endif
set i=i+1
endloop
return"stand"
endfunction
function SPI takes unit u returns nothing
if GetUnitTypeId(u)=='N01I' then
call SetUnitAnimationByIndex(u,6)
else
call SetUnitAnimation(u,SRI(u))
endif
endfunction
function SQI takes integer level returns integer
if level==1 then
return 25
elseif level==2 then
return 41
elseif level==3 then
return 62
elseif level==4 then
return 88
elseif level==5 then
return 119
elseif level==6 then
return 155
elseif level<=25 then
return R2I(2.5*level*level+8.5*level+14)
endif
return R2I(2.5*25*25+8.5*25+14)
endfunction
function T0I takes player p returns integer
local integer i
set i=1
if p==BO[i]or p==CO[i]then
return i
endif
set i=2
if p==BO[i]or p==CO[i]then
return i
endif
set i=3
if p==BO[i]or p==CO[i]then
return i
endif
set i=4
if p==BO[i]or p==CO[i]then
return i
endif
set i=5
if p==BO[i]or p==CO[i]then
return i
endif
return 0
endfunction
function IsPlayerTeam1 takes player T1I returns boolean
return GetPlayerTeam(T1I) == 0
if(T1I==BO[0])then
return true
endif
if(T1I==BO[1])then
return true
endif
if(T1I==BO[2])then
return true
endif
if(T1I==BO[3])then
return true
endif
if(T1I==BO[4])then
return true
endif
if(T1I==BO[5])then
return true
endif
return false
endfunction
function IsPlayerTeam2 takes player T1I returns boolean
return GetPlayerTeam(T1I) == 1
if(T1I==CO[0])then
return true
endif
if(T1I==CO[1])then
return true
endif
if(T1I==CO[2])then
return true
endif
if(T1I==CO[3])then
return true
endif
if(T1I==CO[4])then
return true
endif
if(T1I==CO[5])then
return true
endif
return false
endfunction
function T2I takes player p returns boolean
return p==BO[1]or p==BO[2]or p==BO[3]or p==BO[4]or p==BO[5]or p==CO[1]or p==CO[2]or p==CO[3]or p==CO[4]or p==CO[5]
endfunction
function T3I takes player T4I returns boolean
if(GetPlayerSlotState(T4I)==PLAYER_SLOT_STATE_PLAYING)then
if(GetPlayerController(T4I)==MAP_CONTROL_USER)then
return true
endif
endif
return false
endfunction
function T5I takes player T4I returns boolean
if(GetPlayerSlotState(T4I)==PLAYER_SLOT_STATE_PLAYING or GetPlayerSlotState(T4I)==PLAYER_SLOT_STATE_LEFT)then
if(GetPlayerController(T4I)==MAP_CONTROL_USER)then
return true
endif
endif
return false
endfunction
function T6I takes player T4I returns boolean
if GetPlayerSlotState(T4I)==PLAYER_SLOT_STATE_LEFT then
if(GetPlayerController(T4I)==MAP_CONTROL_USER)then
return true
endif
endif
return false
endfunction
function T7I takes nothing returns nothing
if(T3I(GetEnumPlayer())==true)then
set bj_forceCountPlayers=bj_forceCountPlayers+1
endif
endfunction
function T8I takes force f returns integer
set bj_forceCountPlayers=0
call ForForce(f,function T7I)
return bj_forceCountPlayers
endfunction
function CountHumanPlayers takes nothing returns nothing
if GetPlayerSlotState(GetEnumPlayer())==PLAYER_SLOT_STATE_LEFT or GetPlayerSlotState(GetEnumPlayer())==PLAYER_SLOT_STATE_PLAYING then
set bj_forceCountPlayers=bj_forceCountPlayers+1
endif
endfunction
function T9I takes nothing returns nothing
if GetPlayerSlotState(GetEnumPlayer())==PLAYER_SLOT_STATE_PLAYING then
if GetEnumPlayer()!=Player(13)and GetEnumPlayer()!=Player(14)then
set bj_forceCountPlayers=bj_forceCountPlayers+1
endif
endif
endfunction
function TAI takes force f returns integer
set bj_forceCountPlayers=0
call ForForce(f,function T9I)
return bj_forceCountPlayers
endfunction
function TBI takes integer SDI,player T4I returns nothing
if TK then
call SetPlayerTechMaxAllowed(T4I,SDI,0)
set R[GetUnitPointValueByType(SDI)]=true
endif
endfunction
function TCI takes integer SDI returns nothing
call TBI(SDI,BO[1])
call TBI(SDI,BO[2])
call TBI(SDI,BO[3])
call TBI(SDI,BO[4])
call TBI(SDI,BO[5])
call TBI(SDI,CO[1])
call TBI(SDI,CO[2])
call TBI(SDI,CO[3])
call TBI(SDI,CO[4])
call TBI(SDI,CO[5])
endfunction
function TDI takes integer SDI returns nothing
if TK then
call SetPlayerTechMaxAllowed(BO[1],SDI,0)
call SetPlayerTechMaxAllowed(BO[2],SDI,0)
call SetPlayerTechMaxAllowed(BO[3],SDI,0)
call SetPlayerTechMaxAllowed(BO[4],SDI,0)
call SetPlayerTechMaxAllowed(BO[5],SDI,0)
call SetPlayerTechMaxAllowed(CO[1],SDI,0)
call SetPlayerTechMaxAllowed(CO[2],SDI,0)
call SetPlayerTechMaxAllowed(CO[3],SDI,0)
call SetPlayerTechMaxAllowed(CO[4],SDI,0)
call SetPlayerTechMaxAllowed(CO[5],SDI,0)
endif
endfunction
function TEI takes integer SDI returns nothing
local player p
if TK then
set p=BO[1]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=BO[2]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=BO[3]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=BO[4]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=BO[5]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=CO[1]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=CO[2]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=CO[3]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=CO[4]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
set p=CO[5]
if K1[GetPlayerId(p)]==null then
call SetPlayerTechMaxAllowed(p,SDI,1)
endif
endif
endfunction
function TFI takes player T4I returns nothing
local integer TGI=DE0
local integer THI=DF0
if TK then
loop
exitwhen TGI>THI
call SetPlayerTechMaxAllowed(T4I,DC0[TGI],0)
set TGI=TGI+1
endloop
set TGI=DG0
set THI=DH0
loop
exitwhen TGI>THI
call SetPlayerTechMaxAllowed(T4I,DC0[TGI],0)
set TGI=TGI+1
endloop
endif
endfunction
function TZI takes nothing returns nothing
call TFI(BO[1])
call TFI(BO[2])
call TFI(BO[3])
call TFI(BO[4])
call TFI(BO[5])
call TFI(CO[1])
call TFI(CO[2])
call TFI(CO[3])
call TFI(CO[4])
call TFI(CO[5])
endfunction
function TVI takes nothing returns nothing
local integer i
if TK then
set i=DG0
loop
exitwhen i>DH0
call SetPlayerTechMaxAllowed(BO[1],DC0[i],0)
call SetPlayerTechMaxAllowed(BO[2],DC0[i],0)
call SetPlayerTechMaxAllowed(BO[3],DC0[i],0)
call SetPlayerTechMaxAllowed(BO[4],DC0[i],0)
call SetPlayerTechMaxAllowed(BO[5],DC0[i],0)
set i=i+1
endloop
set i=DE0
loop
exitwhen i>DF0
call SetPlayerTechMaxAllowed(CO[1],DC0[i],0)
call SetPlayerTechMaxAllowed(CO[2],DC0[i],0)
call SetPlayerTechMaxAllowed(CO[3],DC0[i],0)
call SetPlayerTechMaxAllowed(CO[4],DC0[i],0)
call SetPlayerTechMaxAllowed(CO[5],DC0[i],0)
set i=i+1
endloop
endif
endfunction
function IsEnemyCreepCond takes nothing returns boolean
return IsUnitAlly(GetFilterUnit(),GetOwningPlayer(XO))and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>0 and(GetOwningPlayer(GetFilterUnit())==BO[0])or(GetOwningPlayer(GetFilterUnit())==CO[0])
endfunction
function TWI takes nothing returns nothing
local integer TGI
local integer THI
local integer TXI=0
set HO=DE0
set TGI=DE0
set THI=DF0
loop
exitwhen TGI>THI
set TXI=TXI+1
set VO[TXI]=TGI
set TGI=TGI+1
endloop
set TGI=DG0
set THI=DH0
loop
exitwhen TGI>THI
set TXI=TXI+1
set VO[TXI]=TGI
set TGI=TGI+1
endloop
set ZO=TXI
endfunction
function TYI takes nothing returns integer
local integer TJI=GetRandomInt(HO,ZO)
local integer TKI=VO[TJI]
set TKI=VO[TJI]
if(HO==ZO)then
set VO[TJI]=0
return TKI
endif
if(TJI==ZO)then
set ZO=ZO-1
return TKI
endif
set VO[TJI]=VO[ZO]
set ZO=ZO-1
return TKI
endfunction
function TLI takes unit SWI returns boolean
return GetUnitAbilityLevel(SWI,'B01T')>0 or GetUnitAbilityLevel(SWI,'BNsi')>0 or GetUnitAbilityLevel(SWI,'B01X')>0 or GetUnitAbilityLevel(SWI,'BNdo')>0 or GetUnitAbilityLevel(SWI,'B02M')>0 or GetUnitAbilityLevel(SWI,'Bhea')>0 or GetUnitAbilityLevel(SWI,'B07V')>0 or GetUnitAbilityLevel(SWI,'B0BY')>0 or GetUnitAbilityLevel(SWI,'B08O')>0 or GetUnitAbilityLevel(SWI,'B07U')>0 or GetUnitAbilityLevel(SWI,'B0DL')>0 or GetUnitAbilityLevel(SWI,'B08V')>0 or GetUnitAbilityLevel(SWI,'B031')>0 or GetUnitAbilityLevel(SWI,'B0FT')>0 or GetUnitAbilityLevel(SWI,'B0FG')>0
endfunction
function TMI takes string TNI returns integer
if TNI=="a"then
return 10
elseif TNI=="b"then
return 11
elseif TNI=="c"then
return 12
elseif TNI=="d"then
return 13
elseif TNI=="e"then
return 14
elseif TNI=="f"then
return 15
else
return S2I(TNI)
endif
endfunction
function TSI takes string TTI returns integer
return TMI(SubString(TTI,0,1))*16+TMI(SubString(TTI,1,2))
endfunction
function TRI takes integer TPI returns boolean
local integer i=1
loop
exitwhen i>R2
if TPI==T2[i]then
return false
endif
set i=i+1
endloop
return true
endfunction
function TQI takes integer TPI returns boolean
local integer i=1
loop
exitwhen i>R2
if TPI==T2[i]then
return false
endif
set i=i+1
endloop
set i=1
loop
exitwhen i>EE0
if TPI==ED0[i]then
return false
endif
set i=i+1
endloop
return true
endfunction
function TUI takes unit R0I returns integer
local integer RII=GetUnitTypeId(R0I)
if RII=='e00R' or RII=='u00M' then
return 1
elseif RII=='e011' or RII=='u00D' then
return 2
elseif RII=='e00S' or RII=='u00N' then
return 3
elseif RII=='e019' or RII=='u00T' then
return 4
endif
return 0
endfunction
function R1I takes player MDI,integer ROI returns nothing
local texttag t
if ROI>0 then
set EL0[GetPlayerId(MDI)]=EL0[GetPlayerId(MDI)]+ROI
set EK0[GetPlayerId(MDI)]=EK0[GetPlayerId(MDI)]+ROI
set t=CreateTextTag()
call SetPlayerState(MDI,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(MDI,PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetTextTagText(t,"+"+I2S(ROI),0.025)
call SetTextTagPosUnit(t,K1[GetPlayerId(MDI)],0)
call SetTextTagColor(t,255,220,0,255)
call SetTextTagVelocity(t,0,0.03)
if GetLocalPlayer()==MDI then
call SetTextTagVisibility(t,true)
else
call SetTextTagVisibility(t,false)
endif
call SetTextTagFadepoint(t,2)
call SetTextTagLifespan(t,3)
call SetTextTagPermanent(t,false)
endif
endfunction
function R3I takes unit SWI,integer level returns nothing
local integer R4I
local player p=GetOwningPlayer(SWI)
local integer R5I=0
local integer NumOfPlayers
if level==1 then
set R4I=160
elseif level==2 then
set R4I=200
elseif level==3 then
set R4I=240
elseif level==4 then
set R4I=280
endif
if IsUnitAlly(GetDyingUnit(),p)then
if level==1 then
set R4I=80
elseif level==2 then
set R4I=100
elseif level==3 then
set R4I=120
elseif level==4 then
set R4I=140
endif
endif
if GetOwningPlayer(GetDyingUnit())==CO[0]then
call R1I(BO[1],R4I)
call R1I(BO[2],R4I)
call R1I(BO[3],R4I)
call R1I(BO[4],R4I)
call R1I(BO[5],R4I)
else
call R1I(CO[1],R4I)
call R1I(CO[2],R4I)
call R1I(CO[3],R4I)
call R1I(CO[4],R4I)
call R1I(CO[5],R4I)
endif
endfunction
function R6I takes unit SWI,integer level returns nothing
local integer R4I
local player p=GetOwningPlayer(SWI)
local integer R5I=0
local integer NumOfPlayers
if level==1 then
set R4I=100
elseif level==2 then
set R4I=175
endif
if GetOwningPlayer(GetDyingUnit())==CO[0]then
call R1I(BO[1],R4I)
call R1I(BO[2],R4I)
call R1I(BO[3],R4I)
call R1I(BO[4],R4I)
call R1I(BO[5],R4I)
else
call R1I(CO[1],R4I)
call R1I(CO[2],R4I)
call R1I(CO[3],R4I)
call R1I(CO[4],R4I)
call R1I(CO[5],R4I)
endif
endfunction
function R7I takes integer SJI returns boolean
local integer i=1
loop
exitwhen i>DJ0
if DY0[i]==SJI then
return true
endif
set i=i+1
endloop
return false
endfunction
function R8I takes integer SJI returns boolean
local integer i=1
loop
exitwhen i>DV0
if DZ0[i]==SJI then
return true
endif
set i=i+1
endloop
return false
endfunction
function R9I takes integer SJI returns boolean
local integer i=1
loop
exitwhen i>DX0
if DW0[i]==SJI then
return true
endif
set i=i+1
endloop
return false
endfunction
function RAI takes player T4I returns nothing
local integer RBI
local integer RCI
local location RDI
local integer TJI
local boolean GotHero=false
set S0[GetPlayerId(T4I)]=true
if IsPlayerTeam1(T4I)==true then
set RBI=DE0
set RCI=DF0
set RDI=GetRectCenter(O4)
else
set RBI=DG0
set RCI=DH0
set RDI=GetRectCenter(S3)
endif
if K0 then
if(GetRandomInt(1,2)==1)then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
endif
loop
set TJI=GetRandomInt(RBI,RCI)
exitwhen R[TJI]==false and R7I(DC0[TJI])and DC0[TJI]!='H00K'
endloop
if F2==false then
call TDI(DC0[TJI])
set R[TJI]=true
endif
call CreateUnitAtLoc(T4I,DC0[TJI],RDI,0)
call RemoveLocation(RDI)
endfunction
function REI takes player T4I returns nothing
local integer RBI
local integer RCI
local location RDI
local integer TJI
local boolean GotHero=false
set S0[GetPlayerId(T4I)]=true
if IsPlayerTeam1(T4I)==true then
set RBI=DE0
set RCI=DF0
set RDI=GetRectCenter(O4)
else
set RBI=DG0
set RCI=DH0
set RDI=GetRectCenter(S3)
endif
if K0 then
if(GetRandomInt(1,2)==1)then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
endif
loop
set TJI=GetRandomInt(RBI,RCI)
exitwhen R[TJI]==false and R9I(DC0[TJI])
endloop
if F2==false then
call TDI(DC0[TJI])
set R[TJI]=true
endif
call CreateUnitAtLoc(T4I,DC0[TJI],RDI,0)
call RemoveLocation(RDI)
endfunction
function RFI takes player T4I returns nothing
local integer RBI
local integer RCI
local location RDI
local integer TJI
local boolean GotHero=false
set S0[GetPlayerId(T4I)]=true
if IsPlayerTeam1(T4I)==true then
set RBI=DE0
set RCI=DF0
set RDI=GetRectCenter(O4)
else
set RBI=DG0
set RCI=DH0
set RDI=GetRectCenter(S3)
endif
if K0 then
if(GetRandomInt(1,2)==1)then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
endif
loop
set TJI=GetRandomInt(RBI,RCI)
exitwhen R[TJI]==false and R8I(DC0[TJI])
endloop
if F2==false then
call TDI(DC0[TJI])
set R[TJI]=true
endif
call CreateUnitAtLoc(T4I,DC0[TJI],RDI,0)
call RemoveLocation(RDI)
endfunction
function RGI takes player T4I returns nothing
local integer RBI
local integer RCI
local location RDI
local integer TJI
local boolean GotHero=false
set S0[GetPlayerId(T4I)]=true
if IsPlayerTeam1(T4I)==true then
set RBI=DE0
set RCI=DF0
set RDI=GetRectCenter(O4)
else
set RBI=DG0
set RCI=DH0
set RDI=GetRectCenter(S3)
endif
if K0 then
if(GetRandomInt(1,2)==1)then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
endif
loop
set TJI=GetRandomInt(RBI,RCI)
exitwhen R[TJI]==false
endloop
if F2==false then
call TDI(DC0[TJI])
set R[TJI]=true
endif
call CreateUnitAtLoc(T4I,DC0[TJI],RDI,0)
call RemoveLocation(RDI)
endfunction
function RHI takes boolean RZI,boolean RVI returns integer
local integer RBI
local integer RCI
if RZI and RVI then
if(GetRandomInt(1,2)==1)then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
elseif RZI then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
return GetRandomInt(RBI,RCI)
endfunction
function RWI takes unit SWI returns boolean
return GetUnitTypeId(SWI)=='n00I' or GetUnitTypeId(SWI)=='n022' or GetUnitTypeId(SWI)=='n021' or GetUnitTypeId(SWI)=='n0KY' or GetUnitTypeId(SWI)=='n0KZ' or GetUnitTypeId(SWI)=='n0LE' or GetUnitTypeId(SWI)=='n023' or GetUnitTypeId(SWI)=='n024' or GetUnitTypeId(SWI)=='n025' or GetUnitTypeId(SWI)=='n0L0' or GetUnitTypeId(SWI)=='n0L1' or GetUnitTypeId(SWI)=='n0M4' or GetUnitTypeId(SWI)=='n00M' or GetUnitTypeId(SWI)=='n0HV' or GetUnitTypeId(SWI)=='n0LS'
endfunction
function RXI takes unit SWI returns boolean
return GetUnitTypeId(SWI)=='e01H' or GetUnitTypeId(SWI)=='e01Z' or GetUnitTypeId(SWI)=='e02R' or GetUnitTypeId(SWI)=='e02T' or GetUnitTypeId(SWI)=='e02S' or GetUnitTypeId(SWI)=='e030'
endfunction
function RYI takes unit SWI returns boolean
return RWI(SWI)or RXI(SWI)
endfunction
function RJI takes destructable d returns boolean
return GetDestructableTypeId(d)=='NTtc' or GetDestructableTypeId(d)=='NTtw' or GetDestructableTypeId(d)=='ATtr' or GetDestructableTypeId(d)=='B002' or GetDestructableTypeId(d)=='B003' or GetDestructableTypeId(d)=='B005'
endfunction
function RKI takes unit u returns boolean
return GetUnitAbilityLevel(u,'A0S6')>0 or GetUnitAbilityLevel(u,'A179')>0 or GetUnitAbilityLevel(u,'ACmi')>0 or GetUnitAbilityLevel(u,'A0SU')>0 or GetUnitAbilityLevel(u,'B014')>0 or GetUnitAbilityLevel(u,'A0H3')>0 or((LoadInteger(LY,(GetHandleId(((u)))),((4252))))==1)
endfunction
function RLI takes unit RMI returns boolean
return GetUnitAbilityLevel(RMI,'A04R')>0 and T2I(GetOwningPlayer(RMI))
endfunction
function RNI takes unit u returns boolean
return GetUnitTypeId(u)=='H00F' or GetUnitTypeId(u)=='H00E' or GetUnitTypeId(u)=='H00G' or GetUnitTypeId(u)=='O017'
endfunction
function RSI takes real d returns boolean
return 2<d and d<3000
endfunction
function RTI takes nothing returns nothing
local integer TGI=1
set WO=BO[1]
loop
exitwhen T3I(WO)or TGI>5
set TGI=TGI+1
set WO=BO[TGI]
endloop
if T3I(WO)==false then
set WO=CO[1]
set TGI=1
loop
exitwhen T3I(WO)or TGI>5
set TGI=TGI+1
set WO=CO[TGI]
endloop
endif
endfunction
function RRI takes unit SFI returns boolean
return IsUnitType(SFI,UNIT_TYPE_HERO)==true and IsUnitIllusion(SFI)==false and GetUnitTypeId(SFI)!='H00M' and GetUnitTypeId(SFI)!='N0MM' and GetUnitTypeId(SFI)!='H00Y' and GetUnitTypeId(SFI)!='H07G' and GetUnitTypeId(SFI)!='H0B8'
endfunction
function RPI takes integer i returns integer
local integer x=0
loop
exitwhen x>DH0
if DT0[x]==i then
return DC0[x]
endif
set x=x+1
endloop
return-1
endfunction
function RQI takes integer SJI returns integer
local integer i=1
loop
exitwhen i>DH0
if SJI==DC0[i]then
return i
endif
set i=i+1
endloop
return 0
endfunction
function RUI takes unit SFI returns integer
local integer level=GetHeroLevel(SFI)
if level==1 then
return 100
elseif level==2 then
return 120
elseif level==3 then
return 160
elseif level==4 then
return 220
else
return-200+100*level
endif
return 0
endfunction
function P0I takes player p returns boolean
return C2 and(D60==p or D70==p)
endfunction
function PII takes unit u returns boolean
return GetUnitAbilityLevel(u,'Bcyc')>0 or GetUnitAbilityLevel(u,'Bcy2')>0
endfunction
function P1I takes unit u returns boolean
return((LoadInteger(LY,(GetHandleId((u))),((4400))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4401))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4402))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4403))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4404))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4405))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4406))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4407))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4408))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4409))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4410))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4411))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4412))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4413))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4414))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4415))))==1)
endfunction
function POI takes integer id returns boolean
return id=='u014' or id=='u015' or id=='u016' or id=='u01D' or id=='u01E' or id=='u01F'
endfunction
function P2I takes unit u returns boolean
return GetUnitAbilityLevel(u,'BOhx')>0 or GetUnitAbilityLevel(u,'B00H')>0
endfunction
function P3I takes integer RII returns boolean
if RII=='npn3' or RII=='npn6' or RII=='n010' or RII=='n0GZ' then
return true
endif
if RII=='npn2' or RII=='npn5' or RII=='n012' or RII=='n0H1' then
return true
endif
if RII=='npn1' or RII=='npn4' or RII=='n011' or RII=='n0H0' then
return true
endif
return false
endfunction
function P4I takes unit u returns real
if IsPlayerTeam1(GetOwningPlayer(u))then
return GetRectCenterX(O4)
else
return GetRectCenterX(S3)
endif
endfunction
function P5I takes unit u returns real
if IsPlayerTeam1(GetOwningPlayer(u))then
return GetRectCenterY(O4)
else
return GetRectCenterY(S3)
endif
endfunction
function Damage takes unit hero,unit target,integer P9I,real PAI returns nothing
if P9I==0 then
return
endif
if P9I==1 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_FIRE,WEAPON_TYPE_WHOKNOWS)
elseif P9I==2 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
elseif P9I==3 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
elseif P9I==4 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_PIERCE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
elseif P9I==5 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
elseif P9I==6 then
call SetUnitState(target,UNIT_STATE_LIFE,RMaxBJ(GetUnitState(target,UNIT_STATE_LIFE)-PAI,1))
if GetUnitState(target,UNIT_STATE_LIFE)<2 then
call UnitRemoveBuffs(target,true,true)
call UnitRemoveAbility(target,'Aetl')
call UnitDamageTarget(CreateUnit(GetOwningPlayer(hero),'e00E',0,0,0),target,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
endif
elseif P9I==7 then
if GetUnitAbilityLevel(target,'Aetl')>0 or GetUnitAbilityLevel(target,'B01N')>0 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
else
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_UNIVERSAL,WEAPON_TYPE_WHOKNOWS)
endif
elseif P9I==8 then
call UnitDamageTarget(hero,target,PAI,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_UNIVERSAL,WEAPON_TYPE_WHOKNOWS)
endif
endfunction
function PBI takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer P9I=(LoadInteger(LY,(handle_id),(36)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
call Damage(hero,target,P9I,PAI)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function PDI takes unit hero,unit target,integer P9I,real PAI,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveInteger(LY,(handle_id),(36),(P9I))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function PBI))
set t=null
endfunction
function PEI takes player MDI,string PFI returns nothing
local sound PGI=CreateSound(PFI,false,false,false,10,10,"DefaultEAXON")
if(GetLocalPlayer()==MDI)then
call StartSound(PGI)
endif
call KillSoundWhenDone(PGI)
endfunction
function PHI takes player MDI,string PFI returns nothing
call PEI(BO[1],PFI)
call PEI(BO[2],PFI)
call PEI(BO[3],PFI)
call PEI(BO[4],PFI)
call PEI(BO[5],PFI)
call PEI(CO[1],PFI)
call PEI(CO[2],PFI)
call PEI(CO[3],PFI)
call PEI(CO[4],PFI)
call PEI(CO[5],PFI)
endfunction
function PZI takes player PVI,string N7I returns nothing
local sound PWI=CreateSoundFromLabel("InterfaceError",false,false,false,10,10)
if(GetLocalPlayer()==PVI)then
if(N7I!="")and(N7I!=null)then
call ClearTextMessages()
call DisplayTimedTextToPlayer(PVI,0.50,-1.00,2.00,"|cffffcc00"+N7I+"|r")
endif
call StartSound(PWI)
endif
call KillSoundWhenDone(PWI)
endfunction
function PXI takes player PVI,string N7I returns nothing
local sound PWI=CreateSoundFromLabel("InterfaceError",false,false,false,10,10)
if(GetLocalPlayer()==PVI)then
if(N7I!="")and(N7I!=null)then
call DisplayTimedTextToPlayer(PVI,0,0,2.00,"|cffffcc00"+N7I+"|r")
endif
call StartSound(PWI)
endif
call KillSoundWhenDone(PWI)
endfunction
function PYI takes player PVI,string N7I returns nothing
local sound PWI=CreateSoundFromLabel("InterfaceError",false,false,false,10,10)
if(GetLocalPlayer()==PVI)then
if(N7I!="")and(N7I!=null)then
call DisplayTimedTextToPlayer(PVI,0,0,5.00,"|cffffcc00"+N7I+"|r")
endif
call StartSound(PWI)
endif
call KillSoundWhenDone(PWI)
endfunction
function PJI takes unit PKI returns nothing
call PauseUnit(PKI,true)
call IssueImmediateOrder(PKI,"stop")
call PauseUnit(PKI,false)
endfunction
function PLI takes nothing returns boolean
if(GetTimeOfDay()>6.00 and GetTimeOfDay()<18.00)then
return true
else
return false
endif
endfunction
function PMI takes string PNI,boolean PSI returns nothing
if PSI then
call ExecuteFunc(PNI)
endif
endfunction
function PTI takes real x returns real
local real PRI=GetRectMinX(bj_mapInitialPlayableArea)+50
if(x<PRI)then
return PRI
endif
set PRI=GetRectMaxX(bj_mapInitialPlayableArea)-50
if(x>PRI)then
return PRI
endif
return x
endfunction
function PPI takes real x returns real
local real PRI=GetRectMinX(bj_mapInitialPlayableArea)+75
if(x<PRI)then
return PRI
endif
set PRI=GetRectMaxX(bj_mapInitialPlayableArea)-75
if(x>PRI)then
return PRI
endif
return x
endfunction
function PQI takes real x returns real
local real PRI=GetRectMinX(bj_mapInitialPlayableArea)
if(x<PRI)then
return PRI
endif
set PRI=GetRectMaxX(bj_mapInitialPlayableArea)
if(x>PRI)then
return PRI
endif
return x
endfunction
function PUI takes real y returns real
local real PRI=GetRectMinY(bj_mapInitialPlayableArea)+50
if(y<PRI)then
return PRI
endif
set PRI=GetRectMaxY(bj_mapInitialPlayableArea)-50
if(y>PRI)then
return PRI
endif
return y
endfunction
function Q0I takes real y returns real
local real PRI=GetRectMinY(bj_mapInitialPlayableArea)+75
if(y<PRI)then
return PRI
endif
set PRI=GetRectMaxY(bj_mapInitialPlayableArea)-75
if(y>PRI)then
return PRI
endif
return y
endfunction
function QII takes real y returns real
local real PRI=GetRectMinY(bj_mapInitialPlayableArea)
if(y<PRI)then
return PRI
endif
set PRI=GetRectMaxY(bj_mapInitialPlayableArea)
if(y>PRI)then
return PRI
endif
return y
endfunction
function Q1I takes integer QOI returns nothing
local unit u=CreateUnit(Player(15),'H00Y',0,0,270)
call UnitAddAbility(u,QOI)
call UnitRemoveAbility(u,QOI)
call RemoveUnit(u)
set u=null
endfunction
function Q2I takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer QOI=(LoadInteger(LY,(handle_id),(37)))
call Q1I(QOI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function Q3I takes integer QOI,real Q4I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(37),(QOI))
call TriggerRegisterTimerEvent(t,Q4I,false)
call TriggerAddCondition(t,Condition(function Q2I))
set t=null
endfunction
function Tree_Killer takes nothing returns nothing
call KillDestructable(GetEnumDestructable())
endfunction
function Q5I takes unit SFI returns nothing
call SaveBoolean(LY,(GetHandleId(SFI)),(38),(false))
call FlushChildHashtable(LY,(GetHandleId(SFI)))
call RemoveUnit(SFI)
endfunction
function Q6I takes unit SWI,integer Q7I,integer Q8I returns nothing
if GetUnitAbilityLevel(SWI,Q7I)==0 then
call UnitAddAbility(SWI,Q7I)
endif
call SetUnitAbilityLevel(SWI,Q7I,Q8I)
endfunction
function Q9I takes integer a,integer b returns integer
if(a<b)then
return a
else
return b
endif
endfunction
function QAI takes integer a,integer b returns integer
if(a<b)then
return b
else
return a
endif
endfunction
function QBI takes integer M8I,integer a,integer b returns integer
return QAI(Q9I(M8I,b),a)
endfunction
function QCI takes real a,real b returns real
if(a<b)then
return a
else
return b
endif
endfunction
function QDI takes real a,real b returns real
if(a<b)then
return b
else
return a
endif
endfunction
function QEI takes nothing returns nothing
local integer handle_id=GetHandleId(GetExpiredTimer())
local unit SWI=(LoadUnitHandle(LY,(handle_id),(26)))
call SetUnitState(SWI,UNIT_STATE_LIFE,GetUnitState(SWI,UNIT_STATE_LIFE)+(LoadReal(LY,(handle_id),(20))))
endfunction
function QFI takes unit SWI,real PAI returns nothing
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveUnitHandle(LY,(handle_id),(26),(SWI))
call TimerStart(t,0,false,function QEI)
endfunction
function QGI takes unit SWI,real PAI returns nothing
local real QHI=GetUnitState(SWI,UNIT_STATE_MAX_LIFE)
local real QZI=GetUnitState(SWI,UNIT_STATE_LIFE)
if(GetUnitState(SWI,UNIT_STATE_LIFE)>1)then
if PAI>(QHI-QZI)then
if PAI>=QZI then
call SetUnitState(SWI,UNIT_STATE_LIFE,QHI)
call QFI(SWI,PAI-(QHI-QZI))
else
call QFI(SWI,PAI)
endif
else
call SetUnitState(SWI,UNIT_STATE_LIFE,GetUnitState(SWI,UNIT_STATE_LIFE)+PAI)
endif
endif
endfunction
function QVI takes unit hero,unit target,real QWI returns boolean
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
if((QXI-QJI)*(QXI-QJI)+(QYI-QKI)*(QYI-QKI))<QWI*QWI then
return true
else
return false
endif
return false
endfunction
function QLI takes unit hero,unit target returns real
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
if hero==null or target==null then
return I2R(9999999999)
else
return SquareRoot((QXI-QJI)*(QXI-QJI)+(QYI-QKI)*(QYI-QKI))
endif
return 1.0
endfunction
function QMI takes unit hero,location target returns real
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetLocationX(target)
local real QKI=GetLocationY(target)
if hero==null then
return I2R(9999999999)
else
return SquareRoot((QXI-QJI)*(QXI-QJI)+(QYI-QKI)*(QYI-QKI))
endif
return 1.0
endfunction
function QNI takes real x1,real y1,real x2,real y2 returns real
return SquareRoot(((x1-x2)*(x1-x2))+((y1-y2)*(y1-y2)))
endfunction
function QSI takes unit SWI returns nothing
call SetUnitState(SWI,UNIT_STATE_MANA,GetUnitState(SWI,UNIT_STATE_MAX_MANA))
endfunction
function QTI takes nothing returns nothing
call DisplayTimedTextToPlayer(GetEnumPlayer(),0,U2,MJ,LJ)
endfunction
function QRI takes force N0I,real M5I,string NII returns nothing
set LJ=NII
set MJ=M5I
call ForForce(N0I,function QTI)
endfunction
function QPI takes nothing returns nothing
if GM[GetPlayerId(GetEnumPlayer())]then
call DisplayTimedTextToPlayer(GetEnumPlayer(),0,U2,MJ,LJ)
endif
endfunction
function QQI takes force N0I,real M5I,string NII returns nothing
set LJ=NII
set MJ=M5I
call ForForce(N0I,function QPI)
endfunction
function QUI takes unit SWI,real U0I returns nothing
call SetUnitState(SWI,UNIT_STATE_LIFE,GetUnitState(SWI,UNIT_STATE_LIFE)+U0I)
endfunction
function UII takes nothing returns nothing
call PauseAllUnitsBJ(true)
endfunction
function RepeatedPauseAll takes nothing returns nothing
local timer t=CreateTimer()
call TimerStart(t,1,true,function UII)
endfunction
function U1I takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger((t))
set t=null
return false
endfunction
function UOI takes string U2I,unit SWI,string U3I,real M5I returns nothing
local effect fx=AddSpecialEffectTarget(U2I,SWI,U3I)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(32),(fx))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function U1I))
set fx=null
set t=null
endfunction
function U4I takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger((t))
set t=null
return false
endfunction
function U5I takes string U2I,unit SWI,string U3I,real M5I returns nothing
local effect fx=AddSpecialEffectTarget(U2I,SWI,U3I)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(32),(fx))
call TriggerRegisterUnitEvent(t,SWI,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function U4I))
set fx=null
set t=null
endfunction
function U6I takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger((t))
set t=null
return false
endfunction
function U7I takes string U2I,real x,real y,real M5I returns nothing
local effect fx=AddSpecialEffect(U2I,x,y)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(32),(fx))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function U6I))
set fx=null
set t=null
endfunction
function PulseEffectTarget_Child takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local string U2I=(LoadStr(LY,(handle_id),(39)))
local string U3I=(LoadStr(LY,(handle_id),(40)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
call U5I(U2I,target,U3I,2)
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>NPI then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function U8I takes unit SWI,integer U9I returns item
local integer MLI=0
local item UAI
loop
exitwhen MLI==6
set UAI=UnitItemInSlot(SWI,MLI)
if UAI!=null and GetItemTypeId(UAI)==U9I then
return UAI
endif
set MLI=MLI+1
endloop
return null
endfunction
function UBI takes timer t returns nothing
call PauseTimer(t)
call FlushChildHashtable(LY,(GetHandleId(t)))
call DestroyTimer(t)
endfunction
function UCI takes real x1,real y1,real x2,real y2 returns real
return SquareRoot((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2))
endfunction
function UDI takes unit a,unit b returns real
return bj_RADTODEG*Atan2(GetUnitY(b)-GetUnitY(a),GetUnitX(b)-GetUnitX(a))
endfunction
function UEI takes real x1,real y1,real x2,real y2 returns real
return bj_RADTODEG*Atan2(y2-y1,x2-x1)
endfunction
function UFI takes nothing returns nothing
call DestroyLightning((LoadLightningHandle(LY,(GetHandleId(GetExpiredTimer())),(41))))
endfunction
function UGI takes string UHI,real x1,real y1,real x2,real y2,real r,real g,real b,real a,real M5I returns nothing
local timer t=CreateTimer()
local lightning UZI=AddLightning(UHI,true,x1,y1,x2,y2)
call SetLightningColor(UZI,r,g,b,a)
call SaveLightningHandle(LY,(GetHandleId(t)),(41),(UZI))
call TimerStart(t,M5I,false,function UFI)
endfunction
function UVI takes string UWI,unit UXI,integer r,integer g,integer b returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,0.03)
call SetTextTagPosUnit(tt,UXI,0)
call SetTextTagColor(tt,r,g,b,255)
call SetTextTagPermanent(tt,true)
set tt=null
endfunction
function UYI takes string UWI,real M5I,unit UXI,real UJI,integer r,integer g,integer b,integer a returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,UJI)
call SetTextTagPosUnit(tt,UXI,64)
call SetTextTagColor(tt,r,g,b,a)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,2)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,M5I)
if IsUnitVisible(UXI,GetLocalPlayer())or P0I(GetLocalPlayer())then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
set tt=null
endfunction
function UKI takes player p,string UWI,real M5I,unit UXI,real UJI,integer r,integer g,integer b,integer a returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,UJI)
call SetTextTagPosUnit(tt,UXI,64)
call SetTextTagColor(tt,r,g,b,a)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,2)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,M5I)
if IsPlayerAlly(GetLocalPlayer(),p)==true or P0I(GetLocalPlayer())then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
set tt=null
endfunction
function ULI takes nothing returns boolean
return true
endfunction
function UMI takes trigger t,playerunitevent UNI returns nothing
local integer MLI=0
loop
call TriggerRegisterPlayerUnitEvent(t,Player(MLI),UNI,Condition(function ULI))
set MLI=MLI+1
exitwhen MLI==16
endloop
endfunction
function USI takes trigger t,playerunitevent UNI returns nothing
local integer i=1
loop
exitwhen i>5
call TriggerRegisterPlayerUnitEvent(t,BO[i],UNI,Condition(function ULI))
call TriggerRegisterPlayerUnitEvent(t,CO[i],UNI,Condition(function ULI))
set i=i+1
endloop
endfunction
function UTI takes real x1,real y1,real x2,real y2 returns real
return SquareRoot(((x1-x2)*(x1-x2))+((y1-y2)*(y1-y2)))
endfunction
function URI takes nothing returns nothing
if RJI(GetEnumDestructable())and IsDestructableAliveBJ(GetEnumDestructable())then
set NJ=NJ+1
call KillDestructable(GetEnumDestructable())
endif
endfunction
function UPI takes real x,real y,real d returns integer
local rect r=Rect(x-d,y-d,x+d,y+d)
set NJ=0
call EnumDestructablesInRect(r,Condition(function N1I),function URI)
call RemoveRect(r)
set r=null
return NJ
endfunction
function UQI takes real x,real y returns boolean
if IsTerrainPathable(x,y,PATHING_TYPE_WALKABILITY)then
return false
endif
return true
endfunction
function UUI takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A0R9')
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=null
endfunction
function II1 takes player MDI,sound I11,real x,real y returns nothing
call SetSoundPosition(I11,x,y,0)
call SetSoundVolume(I11,127)
set bj_lastPlayedSound=I11
if(I11!=null)then
if(GetLocalPlayer()==MDI)then
call StartSound(I11)
endif
endif
endfunction
function IO1 takes sound I11,real x,real y returns nothing
call SetSoundPosition(I11,x,y,0)
call SetSoundVolume(I11,127)
set bj_lastPlayedSound=I11
if(I11!=null)then
call StartSound(I11)
endif
endfunction
function I21 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set I31=null
return false
endfunction
function I41 takes player p,real M5I,real x,real y,real r returns nothing
local trigger t=CreateTrigger()
local fogmodifier I31=CreateFogModifierRadius(p,FOG_OF_WAR_VISIBLE,x,y,r,true,true)
call FogModifierStart(I31)
call SaveFogModifierHandle(LY,(GetHandleId(t)),(42),(I31))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function I21))
set I31=null
set t=null
endfunction
function GroupCount_Helper takes nothing returns nothing
set bj_groupCountUnits=bj_groupCountUnits+1
endfunction
function I51 takes nothing returns nothing
if(RJI(GetEnumDestructable())or GetDestructableTypeId(GetEnumDestructable())=='B005')and GetDestructableLife(GetEnumDestructable())>0 then
set KK=true
endif
endfunction
function I61 takes real x,real y,real d returns boolean
local rect r=Rect(x-d,y-d,x+d,y+d)
set KK=false
call EnumDestructablesInRect(r,Condition(function N1I),function I51)
call RemoveRect(r)
set r=null
return KK
endfunction
function I71 takes nothing returns nothing
call PauseUnit(GetEnumUnit(),true)
endfunction
function I81 takes nothing returns boolean
local group g=NTI()
call GroupEnumUnitsInRange(g,0,0,16000,Condition(function ULI))
call ForGroup(g,function I71)
call NSI(g)
set g=null
return false
endfunction
function I91 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function I81))
call TriggerEvaluate(t)
set t=null
endfunction
function AddSkill takes unit SFI,integer IB1 returns nothing
call UnitAddAbility(SFI,IB1)
call UnitMakeAbilityPermanent(SFI,true,IB1)
endfunction
// 单位不存在或死亡
function IsUnitDead takes unit u returns boolean
return GetUnitTypeId(u)<1 or IsUnitType(u,UNIT_TYPE_DEAD)==true
endfunction
function ID1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer IE1=(LoadInteger(LY,(handle_id),(43)))
local unit hero=NYI(IE1)
local real IF1=(LoadReal(LY,(handle_id),(44)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real IH1=IF1*0.03
local real IZ1=UEI(x,y,QJI,QKI)
local real IV1=x+IH1*Cos(IZ1*bj_DEGTORAD)
local real IW1=y+IH1*Sin(IZ1*bj_DEGTORAD)
local boolean IX1=(LoadBoolean(LY,(handle_id),(698)))
local boolean IY1=(LoadBoolean(LY,(handle_id),(818)))
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SetUnitFacing(IG1,IZ1)
if IsUnitDead(target)and IX1==false or(((LoadInteger(LY,(GetHandleId((target))),((4422))))==1)==true and IY1==true)then
call KillUnit(IG1)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif UTI(QJI,QKI,IV1,IW1)<=IH1 then
call KillUnit(IG1)
set GK=hero
set HK=target
call ExecuteFunc((LoadStr(LY,(handle_id),(46))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
set IG1=null
return false
endfunction
function IJ1 takes unit hero,unit target,integer IK1,string IL1,real IF1,boolean IM1 returns trigger
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real IN1=GetUnitFacing(hero)
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function ID1))
call SaveReal(LY,(handle_id),(44),((IF1)*1.0))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveStr(LY,(handle_id),(46),(IL1))
call SaveInteger(LY,(handle_id),(43),(NKI(hero)))
call SaveUnitHandle(LY,(handle_id),(45),(CreateUnit(GetOwningPlayer(hero),IK1,QXI,QYI,IN1)))
call SaveBoolean(LY,(handle_id),(698),(false))
call SaveBoolean(LY,(handle_id),(818),(IM1))
set WK=t
set t=null
return WK
endfunction
function MoveProjectileToXY_Move takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real IF1=(LoadReal(LY,(handle_id),(44)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real IH1=IF1*0.03
local real IZ1=UEI(x,y,QJI,QKI)
local real IV1=x+IH1*Cos(IZ1*bj_DEGTORAD)
local real IW1=y+IH1*Sin(IZ1*bj_DEGTORAD)
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
if UTI(QJI,QKI,IV1,IW1)<=IH1 then
call KillUnit(IG1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set IG1=null
return false
endfunction
function DamageProjectile_Move takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real IF1=(LoadReal(LY,(handle_id),(44)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real IH1=IF1*0.03
local real IZ1=UEI(x,y,QJI,QKI)
local real IV1=x+IH1*Cos(IZ1*bj_DEGTORAD)
local real IW1=y+IH1*Sin(IZ1*bj_DEGTORAD)
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SetUnitFacing(IG1,IZ1)
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call KillUnit(IG1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif UTI(QJI,QKI,IV1,IW1)<=IH1 then
call Damage((LoadUnitHandle(LY,(handle_id),(2))),target,(LoadInteger(LY,(handle_id),(36))),(LoadReal(LY,(handle_id),(20))))
call KillUnit(IG1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
return false
endfunction
function DelayedLocust_Helper takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call UnitAddAbility((LoadUnitHandle(LY,(handle_id),(26))),'Aloc')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function IS1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real IT1=(LoadReal(LY,(handle_id),(49)))
local real SKI=IT1-(IT1-SMI(SFI))*NPI/40
if NPI>40 or IsUnitDead(SFI)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitScale(SFI,SKI,SKI,SKI)
endif
set t=null
set SFI=null
return false
endfunction
function IR1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real IP1=(LoadReal(LY,(handle_id),(50)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function IS1))
set handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(49),((IP1)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
set SFI=null
return false
endfunction
function IQ1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real IU1=((LoadReal(LY,(handle_id),(51)))-SMI(SFI))*NPI/40
local real SKI=SMI(SFI)+IU1
if NPI>40 or IsUnitDead(SFI)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitScale(SFI,SKI,SKI,SKI)
endif
set t=null
set SFI=null
return false
endfunction
function O01 takes unit SFI,real M5I,real SKI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real OI1=SKI*SMI(SFI)
local real IP1=OI1
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(50),((IP1)*1.0))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function IR1))
if M5I>3 then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function IQ1))
set handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(51),((OI1)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
else
call SetUnitScale(SFI,IP1,IP1,IP1)
endif
set t=null
endfunction
function O11 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer OO1=(LoadInteger(LY,(handle_id),(52)))
if SFI!=null then
call UnitRemoveAbility(SFI,OO1)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function O21 takes unit u,integer OO1,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(u,OO1)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function O11))
call SaveUnitHandle(LY,(handle_id),(14),(u))
call SaveInteger(LY,(handle_id),(52),(OO1))
set t=null
endfunction
function O31 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(53)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
call UnitShareVision(u,p,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set u=null
set p=null
return false
endfunction
function ShareUnitVisionTimed_Add takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=GetTriggerUnit()
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
call UnitShareVision(u,p,true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function O31))
call SavePlayerHandle(LY,(handle_id),(54),(p))
call SaveUnitHandle(LY,(handle_id),(53),(u))
set t=null
set u=null
set p=null
return false
endfunction
function O41 takes nothing returns nothing
set bj_groupCountUnits=bj_groupCountUnits+1
endfunction
function O51 takes group g returns integer
set bj_groupCountUnits=0
call ForGroup(g,function O41)
return bj_groupCountUnits
endfunction
function O61 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function O71 takes fogmodifier I31,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call FogModifierStart(I31)
call SaveFogModifierHandle(LY,(handle_id),(42),(I31))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function O61))
set t=null
endfunction
function O81 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer O91=(LoadInteger(LY,(handle_id),(55)))
local destructable d=NJI(O91)
if d!=null then
call RemoveDestructable(d)
endif
call NLI(O91)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set d=null
set t=null
return false
endfunction
function OA1 takes destructable d,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function O81))
call SaveInteger(LY,(handle_id),(55),(NMI(d)))
set t=null
endfunction
function OB1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer OO1=(LoadInteger(LY,(handle_id),(52)))
if SFI!=null and GetUnitAbilityLevel(SFI,OO1)>0 then
call UnitRemoveAbility(SFI,OO1)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function OC1 takes unit u,integer OO1,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function OB1))
call SaveUnitHandle(LY,(handle_id),(14),(u))
call SaveInteger(LY,(handle_id),(52),(OO1))
set t=null
endfunction
function OD1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitAnimation((LoadUnitHandle(LY,(handle_id),(53))),"stand")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function OE1 takes unit u,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(53),(u))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function OD1))
set t=null
endfunction
function OF1 takes real M5I,boolean OG1,real x,real y,real OH1,real OZ1,real OV1,real OW1,real OX1 returns nothing
local real OY1
local real OJ1
local real OK1
if(OZ1<=0 or OX1<=0 or OW1<=0)then
return
endif
set OJ1=2.0*M5I/OW1
set OY1=2.0*OZ1/OX1
set OK1=OH1/OZ1
call TerrainDeformRipple(x,y,OZ1,OV1,R2I(M5I*1000),1,OY1,OJ1,OK1,OG1)
endfunction
function OL1 takes player MDI,unit SWI,integer ROI returns nothing
local texttag t=CreateTextTag()
call SetPlayerState(MDI,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(MDI,PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetTextTagText(t,"+"+I2S(ROI),0.025)
call SetTextTagPosUnit(t,SWI,0)
call SetTextTagColor(t,255,220,0,255)
call SetTextTagVelocity(t,0,0.03)
if GetLocalPlayer()==MDI then
call SetTextTagVisibility(t,true)
else
call SetTextTagVisibility(t,false)
endif
call SetTextTagFadepoint(t,2)
call SetTextTagLifespan(t,3)
call SetTextTagPermanent(t,false)
endfunction
function OM1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call FlushChildHashtable(LY,(GetHandleId((LoadUnitHandle(LY,(handle_id),(26))))))
call ShowUnit((LoadUnitHandle(LY,(handle_id),(26))),false)
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(26))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endfunction
function ON1 takes unit u,real d returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,d,false)
call TriggerAddCondition(t,Condition(function OM1))
call SaveUnitHandle(LY,(handle_id),(26),(u))
set t=null
endfunction
function KillUnitTimed_Expire takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call FlushChildHashtable(LY,(GetHandleId((LoadUnitHandle(LY,(handle_id),(26))))))
call ShowUnit((LoadUnitHandle(LY,(handle_id),(26))),false)
call KillUnit((LoadUnitHandle(LY,(handle_id),(26))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endfunction
function HideUnitTimed_Expire takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call FlushChildHashtable(LY,(GetHandleId((LoadUnitHandle(LY,(handle_id),(26))))))
call ShowUnit((LoadUnitHandle(LY,(handle_id),(26))),false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endfunction
function OS1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(26))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endfunction
function OT1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call KillUnit((LoadUnitHandle(LY,(handle_id),(26))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endfunction
function OR1 takes unit u,real d returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,d,false)
call TriggerAddCondition(t,Condition(function OT1))
call SaveUnitHandle(LY,(handle_id),(26),(u))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,d+0.01,false)
call TriggerAddCondition(t,Condition(function OS1))
call SaveUnitHandle(LY,(handle_id),(26),(u))
set t=null
endfunction
function OP1 takes sound I11 returns nothing
if I11!=null and HM[GetPlayerId(GetLocalPlayer())]==false then
call StartSound(I11)
endif
endfunction
function OQ1 takes sound I11,player PVI returns nothing
if GetLocalPlayer()==PVI and HM[GetPlayerId(PVI)]==false then
call StartSound(I11)
endif
endfunction
function OU1 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false
endfunction
function A01 takes nothing returns nothing
call OQ1(SJ,GetOwningPlayer(GetEnumUnit()))
endfunction
function AI1 takes unit hero,sound I11,real x,real y,real r returns nothing
local group g=NTI()
set GK=hero
set SJ=I11
call GroupEnumUnitsInRange(g,x,y,r,Condition(function OU1))
call GroupRemoveUnit(g,hero)
call ForGroup(g,function A01)
call NSI(g)
set g=null
endfunction
function A11 takes unit SWI,item AO1 returns integer
local integer i=0
loop
exitwhen i>5
if UnitItemInSlot(SWI,i)==AO1 then
return i
endif
set i=i+1
endloop
return-1
endfunction
function DelayedSetUnitPosition_Helper takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SWI=(LoadUnitHandle(LY,(handle_id),(56)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
call SetUnitPosition(SWI,x,y)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SWI=null
return false
endfunction
function A21 takes real n1,real n2 returns integer
if n1/n2-R2I(n1/n2)>=0.5 then
return R2I(n1/n2)+1
endif
return R2I(n1/n2)
endfunction
function A31 takes player p returns nothing
if GetLocalPlayer()==p then
call ClearTextMessages()
endif
endfunction
function A41 takes unit u,real d returns nothing
call SetUnitState(u,UNIT_STATE_LIFE,QDI(GetUnitState(u,UNIT_STATE_LIFE)-d,1))
endfunction
function A51 takes integer A61 returns nothing
local unit u=CreateUnit(Player(15),A61,0,0,0)
call RemoveUnit(u)
set u=null
endfunction
function A71 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(53)))
local real M5I=(LoadReal(LY,(handle_id),(57)))
local integer A81=(LoadInteger(LY,(handle_id),(58)))
if GetTriggerEvalCount(t)/10>R2I(M5I)then
call SetUnitVertexColor(u,255,100,255,255)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif IsUnitDead(u)==false then
call SetUnitVertexColor(u,255,100,255,A81)
endif
set t=null
set u=null
return false
endfunction
function A91 takes unit u,real M5I,integer A81 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function A71))
call SaveUnitHandle(LY,(handle_id),(53),(u))
call SaveReal(LY,(handle_id),(57),((M5I)*1.0))
call SaveInteger(LY,(handle_id),(58),(A81))
set t=null
endfunction
function AA1 takes player AB1,integer AC1,unit AD1 returns nothing
local texttag t=CreateTextTag()
local string s
call SetPlayerState(AB1,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(AB1,PLAYER_STATE_RESOURCE_GOLD)+AC1)
call SetTextTagText(t,"+"+I2S(AC1),0.025)
call SetTextTagPosUnit(t,AD1,0)
call SetTextTagColor(t,255,220,0,255)
call SetTextTagVelocity(t,0,0.03)
if GetLocalPlayer()==AB1 then
call SetTextTagVisibility(t,true)
set s="UI\\Feedback\\GoldCredit\\GoldCredit.mdl"
else
call SetTextTagVisibility(t,false)
set s=""
endif
if GetUnitState(AD1,UNIT_STATE_LIFE)>0.5 then
call DestroyEffect(AddSpecialEffectTarget(s,AD1,"overhead"))
endif
call SetTextTagFadepoint(t,2)
call SetTextTagLifespan(t,3)
call SetTextTagPermanent(t,false)
endfunction
function AE1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
if UnitRemoveAbility(target,AF1)==true or GetUnitAbilityLevel(target,AF1)==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function AG1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if UnitRemoveAbility(target,AF1)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function AE1))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(59),(AF1))
endif
set t=null
set target=null
return false
endfunction
function AH1 takes unit target,integer AF1,integer level,real M5I returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(target,AF1)
call SetUnitAbilityLevel(target,AF1,level)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function AG1))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(59),(AF1))
set t=null
endfunction
function AZ1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
local integer AV1=(LoadInteger(LY,(handle_id),(59)))
call UnitRemoveAbility(target,AV1)
if UnitRemoveAbility(target,AF1)==true or GetUnitAbilityLevel(target,AF1)==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function AW1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
local integer AV1=(LoadInteger(LY,(handle_id),(60)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,AV1)
if UnitRemoveAbility(target,AF1)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function AZ1))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(59),(AF1))
call SaveInteger(LY,(handle_id),(60),(AV1))
endif
set t=null
set target=null
return false
endfunction
function AX1 takes unit target,integer AF1,integer level,real M5I,integer AV1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(target,AF1)
call SetUnitAbilityLevel(target,AF1,level)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function AW1))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(59),(AF1))
call SaveInteger(LY,(handle_id),(60),(AV1))
set t=null
endfunction
function AY1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer AJ1=(LoadInteger(LY,(handle_id),(61)))
local integer AK1=(LoadInteger(LY,(handle_id),(62)))
local unit u1=NYI(AJ1)
local unit u2=NYI(AK1)
local real M5I=(LoadReal(LY,(handle_id),(57)))
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(41)))
if I2R(GetTriggerEvalCount(t))*0.025>M5I then
call DestroyLightning(UZI)
call NXI(AJ1)
call NXI(AK1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call MoveLightning(UZI,true,GetUnitX(u1),GetUnitY(u1),GetUnitX(u2),GetUnitY(u2))
endif
set t=null
set u1=null
set u2=null
set UZI=null
return false
endfunction
function AL1 takes string UHI,unit u1,unit u2,real r,real g,real b,real a,real M5I returns nothing
local real x1=GetUnitX(u1)
local real y1=GetUnitY(u1)
local real x2=GetUnitX(u2)
local real y2=GetUnitY(u2)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local lightning UZI=AddLightning(UHI,true,x1,y1,x2,y2)
call SetLightningColor(UZI,r,g,b,a)
call SaveLightningHandle(LY,(handle_id),(41),(UZI))
call SaveInteger(LY,(handle_id),(61),(NKI(u1)))
call SaveInteger(LY,(handle_id),(62),(NKI(u2)))
call SaveReal(LY,(handle_id),(57),((M5I)*1.0))
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function AY1))
set t=null
set UZI=null
endfunction
function AM1 takes string AN1 returns nothing
local sound AS1=CreateSound(AN1,false,false,false,10,10,"")
call SetSoundVolume(AS1,0)
call StartSound(AS1)
call KillSoundWhenDone(AS1)
set AS1=null
endfunction
function AT1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local ubersplat AR1=(LoadUbersplatHandle(LY,(handle_id),(131)))
call DestroyUbersplat(AR1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set AR1=null
return false
endfunction
function AP1 takes ubersplat AR1,real d returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUbersplatHandle(LY,(handle_id),(131),(AR1))
call TriggerRegisterTimerEvent(t,d,false)
call TriggerAddCondition(t,Condition(function AT1))
set t=null
endfunction
function AQ1 takes nothing returns nothing
local real d=QNI(GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),PJ,QJ)
if d<RJ then
set RJ=d
set TJ=GetEnumUnit()
endif
endfunction
function AU1 takes group g,real x,real y returns unit
set RJ=999999
set TJ=null
set PJ=x
set QJ=y
call ForGroup(g,function AQ1)
return TJ
endfunction
function B01 takes integer IB1 returns nothing
local integer i=0
loop
exitwhen i>5
call SetPlayerAbilityAvailable(BO[i],IB1,false)
call SetPlayerAbilityAvailable(CO[i],IB1,false)
set i=i+1
endloop
endfunction
function BI1 takes integer id returns nothing
local integer i=0
loop
exitwhen i>12
call SetPlayerAbilityAvailable(Player(i),id,false)
set i=i+1
endloop
endfunction
function DodgeSystem takes nothing returns nothing
call SCI(GetTriggerUnit(),4422,0.2)
endfunction
function B11 takes nothing returns boolean
if GetSpellAbilityId()=='A063' or GetSpellAbilityId()=='A03O' or GetSpellAbilityId()=='A0B8' or GetSpellAbilityId()=='A1WE' or GetSpellAbilityId()=='Aibk' or GetSpellAbilityId()=='A2FV' or GetSpellAbilityId()=='A0ME' then
call SCI(GetTriggerUnit(),4422,0.2)
endif
return false
endfunction
function B31 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitPathing(hero,true)
set t=null
set hero=null
return false
endfunction
function B41 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,5,false)
call TriggerAddCondition(t,Condition(function B31))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SetUnitPathing(hero,false)
set t=null
endfunction
function B51 takes nothing returns nothing
set YN=CreateRegion()
call RegionAddRect(YN,G5)
set KN=CreateRegion()
call RegionAddRect(KN,H5)
set XN=CreateRegion()
call RegionAddRect(XN,O6)
call RegionAddRect(XN,A6)
call RegionAddRect(XN,B6)
set JN=CreateRegion()
call RegionAddRect(JN,C6)
call RegionAddRect(JN,D6)
call RegionAddRect(JN,E6)
set LN=CreateRegion()
call RegionAddRect(LN,F6)
call RegionAddRect(LN,G6)
call RegionAddRect(LN,H6)
call RegionAddRect(LN,Z6)
call RegionAddRect(LN,V6)
call RegionAddRect(LN,W6)
call RegionAddRect(LN,X6)
call RegionAddRect(LN,Y6)
call RegionAddRect(LN,J6)
call RegionAddRect(LN,K6)
call RegionAddRect(LN,L6)
call RegionAddRect(LN,M6)
call RegionAddRect(LN,N6)
call RegionAddRect(LN,S6)
call RegionAddRect(LN,T6)
call RegionAddRect(LN,R6)
call RegionAddRect(LN,P6)
call RegionAddRect(LN,Q6)
call RegionAddRect(LN,U6)
call RegionAddRect(LN,I7)
call RegionAddRect(LN,O7)
call RegionAddRect(LN,A7)
call RegionAddRect(LN,B7)
call RegionAddRect(LN,C7)
call RegionAddRect(LN,D7)
call RegionAddRect(LN,E7)
call RegionAddRect(LN,F7)
call RegionAddRect(LN,G7)
call RegionAddRect(LN,H7)
call RegionAddRect(LN,Z7)
call RegionAddRect(LN,V7)
call RegionAddRect(LN,W7)
call RegionAddRect(LN,X7)
call RegionAddRect(LN,Y7)
call RegionAddRect(LN,J7)
call RegionAddRect(LN,K7)
call RegionAddRect(LN,L7)
call RegionAddRect(LN,M7)
call RegionAddRect(LN,N7)
call RegionAddRect(LN,S7)
call RegionAddRect(LN,T7)
call RegionAddRect(LN,R7)
call RegionAddRect(LN,P7)
call RegionAddRect(LN,Q7)
call RegionAddRect(LN,U7)
call RegionAddRect(LN,I8)
call RegionAddRect(LN,O8)
call RegionAddRect(LN,A8)
call RegionAddRect(LN,B8)
call RegionAddRect(LN,C8)
call RegionAddRect(LN,D8)
call RegionAddRect(LN,E8)
call RegionAddRect(LN,F8)
call RegionAddRect(LN,G8)
call RegionAddRect(LN,H8)
call RegionAddRect(LN,Z8)
call RegionAddRect(LN,V8)
call RegionAddRect(LN,W8)
call RegionAddRect(LN,X8)
call RegionAddRect(LN,Y8)
call RegionAddRect(LN,J8)
call RegionAddRect(LN,K8)
call RegionAddRect(LN,L8)
call RegionAddRect(LN,M8)
call RegionAddRect(LN,N8)
call RegionAddRect(LN,S8)
call RegionAddRect(LN,T8)
call RegionAddRect(LN,R8)
call RegionAddRect(LN,P8)
call RegionAddRect(LN,Q8)
call RegionAddRect(LN,U8)
call RegionAddRect(LN,I9)
call RegionAddRect(LN,O9)
call RegionAddRect(LN,A9)
call RegionAddRect(LN,B9)
call RegionAddRect(LN,C9)
call RegionAddRect(LN,D9)
call RegionAddRect(LN,E9)
call RegionAddRect(LN,F9)
call RegionAddRect(LN,G9)
call RegionAddRect(LN,H9)
call RegionAddRect(LN,Z9)
call RegionAddRect(LN,V9)
call RegionAddRect(LN,W9)
call RegionAddRect(LN,X9)
call RegionAddRect(LN,Y9)
call RegionAddRect(LN,J9)
call RegionAddRect(LN,K9)
call RegionAddRect(LN,L9)
call RegionAddRect(LN,M9)
call RegionAddRect(LN,N9)
call RegionAddRect(LN,S9)
call RegionAddRect(LN,T9)
call RegionAddRect(LN,R9)
call RegionAddRect(LN,P9)
set MN=CreateRegion()
call RegionAddRect(MN,QB)
call RegionAddRect(MN,IC)
call RegionAddRect(MN,OC)
call RegionAddRect(MN,AC)
endfunction
function InitTrig_Regions takes nothing returns nothing
call B51()
endfunction
function B61 takes unit B71 returns boolean
return GetUnitTypeId(B71)=='n004' or GetUnitTypeId(B71)=='n018' or GetUnitTypeId(B71)=='n01C' or GetUnitTypeId(B71)=='n01G'
endfunction
function B81 takes integer id returns boolean
return id=='N00M' or id=='H07G' or id=='H00Y' or id=='H0B8'
endfunction
function B91 takes player p returns nothing
local unit SFI=K1[GetPlayerId(p)]
local integer i=0
local item BA1
loop
exitwhen i>5
set BA1=UnitItemInSlot(SFI,i)
call SetItemDroppable(BA1,false)
set i=i+1
endloop
set SFI=null
set BA1=null
endfunction
function BB1 takes player p returns nothing
local unit SFI=K1[GetPlayerId(p)]
local integer i=0
local item BA1
loop
exitwhen i>5
set BA1=UnitItemInSlot(SFI,i)
call SetItemDroppable(BA1,true)
set i=i+1
endloop
set SFI=null
set BA1=null
endfunction
function BC1 takes unit u returns boolean
return GetUnitAbilityLevel(u,'Aetl')>0 or GetUnitAbilityLevel(u,'Bcyc')>0 or GetUnitAbilityLevel(u,'Bcy2')>0 or GetUnitAbilityLevel(u,'B01N')>0
endfunction
function BD1 takes unit u returns boolean
return(GetUnitAbilityLevel((u),('BEer'))>0)or(GetUnitAbilityLevel((u),('B017'))>0)or(GetUnitAbilityLevel((u),('B0ER'))>0)
endfunction
function BE1 takes unit u returns boolean
return(GetUnitAbilityLevel((u),('B0C1'))>0)or(GetUnitAbilityLevel((u),('BEer'))>0)or(GetUnitAbilityLevel((u),('Beng'))>0)or(GetUnitAbilityLevel((u),('Bena'))>0)or(GetUnitAbilityLevel((u),('B017'))>0)or(GetUnitAbilityLevel((u),('B078'))>0)or(GetUnitAbilityLevel((u),('B08F'))>0)or(GetUnitAbilityLevel((u),('B08E'))>0)or(GetUnitAbilityLevel((u),('B0ER'))>0)or(GetUnitAbilityLevel((u),('B0FN'))>0)
endfunction
function BF1 takes unit u returns nothing
call UnitRemoveAbility(u,'B0C1')
call UnitRemoveAbility(u,'BEer')
call UnitRemoveAbility(u,'Beng')
call UnitRemoveAbility(u,'Bena')
call UnitRemoveAbility(u,'B017')
call UnitRemoveAbility(u,'B078')
call UnitRemoveAbility(u,'B08F')
call UnitRemoveAbility(u,'B08E')
call UnitRemoveAbility(u,'B0ER')
call UnitRemoveAbility(u,'B0FN')
endfunction
function BG1 takes unit u returns boolean
return(GetUnitAbilityLevel((u),('B00H'))>0)or(GetUnitAbilityLevel((u),('BOhx'))>0)or(GetUnitAbilityLevel((u),('BPSE'))>0)or(GetUnitAbilityLevel((u),('B099'))>0)or(GetUnitAbilityLevel((u),('BSTN'))>0)or(GetUnitAbilityLevel((u),('B0CF'))>0)or(GetUnitAbilityLevel((u),('B0BM'))>0)or(GetUnitAbilityLevel((u),('B06M'))>0)or(GetUnitAbilityLevel((u),('B07N'))>0)or(GetUnitAbilityLevel((u),('B08S'))>0)or(GetUnitAbilityLevel((u),('B00Q'))>0)or(GetUnitAbilityLevel((u),('B04V'))>0)or(GetUnitAbilityLevel((u),('B072'))>0)or(GetUnitAbilityLevel((u),('BUan'))>0)or(GetUnitAbilityLevel((u),('B095'))>0)or(GetUnitAbilityLevel((u),('B03I'))>0)or(GetUnitAbilityLevel((u),('B0AD'))>0)or(GetUnitAbilityLevel((u),('B0AE'))>0)or(GetUnitAbilityLevel((u),('B0BE'))>0)or(GetUnitAbilityLevel((u),('B0BF'))>0)or(GetUnitAbilityLevel((u),('B008'))>0)or(GetUnitAbilityLevel((u),('B04B'))>0)or(GetUnitAbilityLevel((u),('B02F'))>0)or(GetUnitAbilityLevel((u),('BUsp'))>0)or(GetUnitAbilityLevel((u),('BUst'))>0)or(GetUnitAbilityLevel((u),('B0DD'))>0)or((LoadInteger(LY,(GetHandleId((u))),((4293))))==1)==true or((LoadInteger(LY,(GetHandleId((u))),((4303))))==1)or(GetUnitAbilityLevel((u),('B0C2'))>0)or(GetUnitAbilityLevel((u),('B06S'))>0)or(GetUnitAbilityLevel((u),('B02S'))>0)or(GetUnitAbilityLevel((u),('B07E'))>0)
endfunction
function BH1 takes unit u returns boolean
return BG1(u)or BE1(u)or IsUnitPaused(u)or PII(u)
endfunction
function BZ1 takes integer id returns boolean
return id=='A0DY' or id=='A1WB' or id=='A026' or id=='A09V' or id=='AHfa' or id=='A0LZ' or id=='A0QN' or id=='A0OI' or id=='A2UM'
endfunction
function BV1 takes unit u returns boolean
return BD1(u)or(GetUnitAbilityLevel((u),('B01N'))>0)or GetUnitAbilityLevel(u,'Aetl')>0 or GetUnitAbilityLevel(u,'Abun')>0 or(GetUnitAbilityLevel((u),('B033'))>0)or(GetUnitAbilityLevel((u),('B0GD'))>0)
endfunction
function BW1 takes integer BX1,integer BY1,boolean extraColor returns nothing
local integer x=0
loop
exitwhen x>15
call SetPlayerState(Player(x),PLAYER_STATE_RESOURCE_LUMBER,BX1)
call SetPlayerState(Player(x),PLAYER_STATE_RESOURCE_FOOD_USED,BY1)
set x=x+1
endloop
endfunction
function BJ1 takes unit u returns boolean
local integer id=GetUnitTypeId(u)
return id=='n027' or id=='u014' or id=='u015' or id=='u016' or id=='u01D' or id=='u01E' or id=='u01F' or id=='u017' or id=='u019' or id=='u018' or id=='u01A' or id=='u01B' or id=='u01C'
endfunction
function BK1 takes unit u,boolean b returns nothing
call SetUnitInvulnerable(u,b)
call SaveBoolean(LY,(GetHandleId(u)),(509),(b))
endfunction
function BL1 takes unit u returns boolean
return(LoadBoolean(LY,(GetHandleId(u)),(509)))or GetUnitAbilityLevel(u,'Avul')>0
endfunction
function BM1 takes unit u returns boolean
return((LoadInteger(LY,(GetHandleId((u))),((4420))))==1)or((LoadInteger(LY,(GetHandleId((u))),((4421))))==1)
endfunction
function BN1 takes real x,real y returns location
local real IV1
local real IW1
local integer i=0
loop
exitwhen i>40
set IV1=x+i*20
set IW1=y+i*20
if IsPointInRegion(LN,IV1,IW1)==false then
return Location(IV1,IW1)
endif
set IV1=x+i*20
set IW1=y-i*20
if IsPointInRegion(LN,IV1,IW1)==false then
return Location(IV1,IW1)
endif
set IV1=x-i*20
set IW1=y+i*20
if IsPointInRegion(LN,IV1,IW1)==false then
return Location(IV1,IW1)
endif
set IV1=x-i*20
set IW1=y-i*20
if IsPointInRegion(LN,IV1,IW1)==false then
return Location(IV1,IW1)
endif
set i=i+1
endloop
return Location(x,y)
endfunction
function BS1 takes unit u returns nothing
call UnitRemoveAbility(u,'Abun')
call SaveInteger(LY,(GetHandleId(u)),(790),(0))
endfunction
function BT1 takes unit u returns nothing
local integer handle_id=GetHandleId(u)
local integer BR1=(LoadInteger(LY,(handle_id),(790)))
call AddSkill(u,'Abun')
set BR1=BR1+1
call SaveInteger(LY,(handle_id),(790),(BR1))
endfunction
function BP1 takes unit u returns nothing
local integer handle_id=GetHandleId(u)
local integer BR1=(LoadInteger(LY,(handle_id),(790)))
set BR1=IMaxBJ(BR1-1,0)
call SaveInteger(LY,(handle_id),(790),(BR1))
if BR1==0 then
call BS1(u)
endif
endfunction
function BQ1 takes unit u returns boolean
if u==BU0 then
return true
endif
if u==C00 then
return true
endif
if u==CI0 then
return true
endif
if u==C10 then
return true
endif
if u==CO0 then
return true
endif
if u==C20 then
return true
endif
if u==C30 then
return true
endif
if u==C40 then
return true
endif
if u==C50 then
return true
endif
if u==C60 then
return true
endif
if u==C70 then
return true
endif
if u==C80 then
return true
endif
if u==C90 then
return true
endif
if u==CA0 then
return true
endif
if u==CB0 then
return true
endif
if u==CC0 then
return true
endif
if u==CD0 then
return true
endif
if u==I70 then
return true
endif
if u==I80 then
return true
endif
if u==I90 then
return true
endif
if u==IA0 then
return true
endif
if u==IB0 then
return true
endif
if u==IC0 then
return true
endif
if u==ID0 then
return true
endif
if u==IE0 then
return true
endif
if u==IF0 then
return true
endif
if u==IG0 then
return true
endif
if u==IH0 then
return true
endif
if u==IZ0 then
return true
endif
if u==IV0 then
return true
endif
if u==IW0 then
return true
endif
if u==IX0 then
return true
endif
if u==IY0 then
return true
endif
if u==IJ0 then
return true
endif
return false
endfunction
function BU1 takes unit u returns boolean
return GetUnitAbilityLevel(u,'B068')>0 or GetUnitAbilityLevel(u,'B07T')>0 or GetUnitAbilityLevel(u,'B076')>0 or GetUnitAbilityLevel(u,'BOwk')>0 or GetUnitAbilityLevel(u,'B04R')>0 or GetUnitAbilityLevel(u,'B0A5')>0 or GetUnitAbilityLevel(u,'B01Q')>0 or GetUnitAbilityLevel(u,'B006')>0 or GetUnitAbilityLevel(u,'Binv')>0 or GetUnitAbilityLevel(u,'Apiv')>0 or GetUnitAbilityLevel(u,'A021')>0 or GetUnitAbilityLevel(u,'A0K4')>0 or GetUnitAbilityLevel(u,'A0XB')>0 or GetUnitAbilityLevel(u,'A0Z2')>0 or GetUnitAbilityLevel(u,'A1GA')>0 or GetUnitAbilityLevel(u,'A1HW')>0 or GetUnitAbilityLevel(u,'A1HX')>0 or GetUnitAbilityLevel(u,'A00J')>0 or GetUnitAbilityLevel(u,'B08K')>0 or GetUnitAbilityLevel(u,'B08X')>0 or GetUnitAbilityLevel(u,'B039')>0 or GetUnitAbilityLevel(u,'B00K')>0 or GetUnitAbilityLevel(u,'BHfs')>0 or GetUnitAbilityLevel(u,'A140')>0 or GetUnitAbilityLevel(u,'B021')>0 or GetUnitAbilityLevel(u,'A0ZD')>0 or GetUnitAbilityLevel(u,'A0KT')>0 or GetUnitAbilityLevel(u,'B0G8')>0 or GetUnitAbilityLevel(u,'A2T0')>0 or GetUnitAbilityLevel(u,'A2SZ')>0
endfunction
function C01 takes unit u,player p returns boolean
return BU1(u)==false or IsUnitVisible(GetFilterUnit(),p)==true
endfunction
function CI1 takes unit SWI returns boolean
local integer C11=GetUnitTypeId(SWI)
return C11=='n004' or C11=='n01G' or C11=='n01C' or C11=='n018' or C11=='e00K' or C11=='e00I' or C11=='e00L' or C11=='e01J'
endfunction
function CO1 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false
endfunction
function GenericCondition_BasicsWithSiege takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 or(GetUnitTypeId(GetFilterUnit())=='umtw' or GetUnitTypeId(GetFilterUnit())=='u00R' or GetUnitTypeId(GetFilterUnit())=='ebal' or GetUnitTypeId(GetFilterUnit())=='e026'))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false
endfunction
function C21 takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and GetUnitAbilityLevel(GetFilterUnit(),'A1RB')==0
endfunction
function GenericCondition_BasicsAndVisible takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
endfunction
function GenericCondition_BasicsAndStructure takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false
endfunction
function GenericCondition_Structure takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false
endfunction
function GenericCondition_EnemyUnitsExNoImmuneNoInvisAndStructure takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function C31 takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_EnemyUnitsExNoImmuneNoInvisAndStructureWithAncient takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)
endfunction
function GenericCondition_EnemyUnitsExNoInvisAndStructureWithAncient takes nothing returns boolean
return IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)
endfunction
function C41 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitTypeId(GetFilterUnit())=='ebal' or GetUnitTypeId(GetFilterUnit())=='umtw')
endfunction
function C51 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_EnemyUnitsVisible takes nothing returns boolean
return(IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
endfunction
function GenericCondition_EnemyUnitsAndVisibleOrWW takes nothing returns boolean
return(IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))or BU1(GetFilterUnit()))
endfunction
function C61 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function C71 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and((GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 or(GetUnitTypeId(GetFilterUnit())=='umtw' or GetUnitTypeId(GetFilterUnit())=='u00R' or GetUnitTypeId(GetFilterUnit())=='ebal' or GetUnitTypeId(GetFilterUnit())=='e026'))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function C81 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))
endfunction
function C91 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(BU1(GetFilterUnit())==false or IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))==true)
endfunction
function CA1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_EnemyUnitsExHeroesVision takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))
endfunction
function CB1 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true
endfunction
function CC1 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or IsUnitIllusion(GetFilterUnit()))
endfunction
function GenericCondition_EnemyUnitsExHeroesNoDotaInvis takes nothing returns boolean
return((IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true)and BU1(GetFilterUnit())==false
endfunction
function GenericCondition_EnemyUnitsExHeroesNoDotaInvis2 takes nothing returns boolean
return((IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true)and(BU1(GetFilterUnit())==false or IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))==true)
endfunction
function GenericCondition_EnemyUnitsExNoHeroes takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false
endfunction
function CD1 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),'A1RB')==0
endfunction
function CE1 takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CF1 takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_EnemyUnitsExNoImmuneNoInvisWithAncient takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function GenericCondition_EnemyUnitsExNoImmuneWithAncient takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function CG1 takes nothing returns boolean
return IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function CH1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function GenericCondition_EnemyUnitsNoNeutrals takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and GetOwningPlayer(GetFilterUnit())!=DO
endfunction
function CZ1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CV1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)
endfunction
function CW1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CX1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CY1 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false
endfunction
function CJ1 takes nothing returns boolean
return RKI(GetFilterUnit())==false and(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))
endfunction
function GenericCondition_EnemyUnitsAndStructureWithAncientsEx takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false)
endfunction
function CK1 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CL1 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function CM1 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and T2I(GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function CN1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and T2I(GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function CS1 takes nothing returns boolean
return IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function CT1 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CR1 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_MyUnitsEx takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GK)and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_MyUnits takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GetTriggerUnit())and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CP1 takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or GetOwningPlayer(GetFilterUnit())==BO[0]or GetOwningPlayer(GetFilterUnit())==CO[0])and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CQ1 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetFilterUnit())==false and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function CU1 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function D01 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==true and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function DI1 takes nothing returns boolean
return RKI(GetFilterUnit())==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==true and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))
endfunction
function D11 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))==true and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
endfunction
function DO1 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==true and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_EnemyHeroesExNoDotAInvis takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==true and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)or BU1(GetEnumUnit())
endfunction
function D21 takes nothing returns boolean
return RKI(GetFilterUnit())==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==true and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))
endfunction
function GenericCondition_AllUnits takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function D31 takes nothing returns boolean
return((GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),'A1RB')==0
endfunction
function GenericCondition_AllNonNeutrals takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and GetOwningPlayer(GetFilterUnit())!=DO
endfunction
function D41 takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)
endfunction
function D51 takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))and GetUnitTypeId(GetFilterUnit())!='H0ES'
endfunction
function D61 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and GetTriggerUnit()!=GetFilterUnit()and IsUnitIllusion(GetFilterUnit())==false
endfunction
function GenericCondition_AllHeroesAndIllusions takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or IsUnitIllusion(GetFilterUnit())==true)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_Hero takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true
endfunction
function GenericCondition_EnemyUnitsExVisible takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))
endfunction
function D71 takes nothing returns boolean
return((IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK)))and GetUnitTypeId(GetFilterUnit())!='n0F5'
endfunction
function GenericCondition_EnemyUnitsExNoWW takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))or(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))==false and BU1(GetFilterUnit()))==false)
endfunction
function GenericCondition_EnemyUnitsExVisibleAttackable takes nothing returns boolean
return((IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK)))and BC1(GetFilterUnit())==false
endfunction
function GenericCondition_EnemyUnitsExVisibleAttackableNoZombie takes nothing returns boolean
return(((IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK)))and BC1(GetFilterUnit())==false)and GetUnitTypeId(GetFilterUnit())!='n0F5'
endfunction
function GenericCondition_RegularUnits takes nothing returns boolean
return(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))
endfunction
function GenericCondition_RegularUnitsExVisible takes nothing returns boolean
return((GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))
endfunction
function D81 takes nothing returns boolean
return RKI(GetFilterUnit())==false and((GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))
endfunction
function D91 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==true and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false and GetUnitTypeId(GetFilterUnit())!='n0F5'
endfunction
function GenericCondition_FloatingHeroes takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='H00E' or GetUnitTypeId(GetFilterUnit())=='H00G' or GetUnitTypeId(GetFilterUnit())=='H00F' or GetUnitTypeId(GetFilterUnit())=='E00P' or GetUnitTypeId(GetFilterUnit())=='N00B' or GetUnitTypeId(GetFilterUnit())=='UC60' or GetUnitTypeId(GetFilterUnit())=='EC77' or GetUnitTypeId(GetFilterUnit())=='U00P' or GetUnitTypeId(GetFilterUnit())=='E02N' or GetUnitTypeId(GetFilterUnit())=='E02O' or GetUnitTypeId(GetFilterUnit())=='O016' or GetUnitTypeId(GetFilterUnit())=='O017' or GetUnitTypeId(GetFilterUnit())=='E02F' or GetUnitTypeId(GetFilterUnit())=='H0DO' or GetUnitTypeId(GetFilterUnit())=='N0M7' or GetUnitTypeId(GetFilterUnit())=='N0MB' or GetUnitTypeId(GetFilterUnit())=='N0MC' or GetUnitTypeId(GetFilterUnit())=='N0MO' or GetUnitTypeId(GetFilterUnit())=='N0MA' or GetUnitTypeId(GetFilterUnit())=='N0MW'
endfunction
function DA1 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GK))==true and TUI(GetFilterUnit())>0
endfunction
function DB1 takes real DC1 returns integer
if DC1>=4.00 then
return 24
elseif DC1>=3.75 then
return 23
elseif DC1>=3.5 then
return 22
elseif DC1>=3.25 then
return 21
elseif DC1>=3 then
return 20
elseif DC1>=2.8 then
return 19
elseif DC1>=2.75 then
return 18
elseif DC1>=2.6 then
return 17
elseif DC1>=2.5 then
return 16
elseif DC1>=2.4 then
return 15
elseif DC1>=2.25 then
return 14
elseif DC1>=2.2 then
return 13
elseif DC1>=2 then
return 12
elseif DC1>=1.8 then
return 11
elseif DC1>=1.75 then
return 10
elseif DC1>=1.65 then
return 9
elseif DC1>=1.5 then
return 8
elseif DC1>=1.4 then
return 7
elseif DC1>=1.25 then
return 6
elseif DC1>=1.2 then
return 5
elseif DC1>=1 then
return 4
elseif DC1>=0.75 then
return 3
elseif DC1>=0.5 then
return 2
elseif DC1>=0.25 then
return 1
endif
return 1
endfunction
function DD1 takes unit hero,unit target,real DC1 returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=DB1(DC1)
call UnitAddAbility(dummy,'A0X6')
call SetUnitAbilityLevel(dummy,'A0X6',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=null
endfunction
function DE1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer DF1=(LoadInteger(LY,(handle_id),(73)))
local unit SFI=NYI(DF1)
local integer NPI=GetTriggerEvalCount(t)
local real y=(NPI-13)*(NPI-13)
if NPI<26 then
if RNI(SFI)==false then
call SetUnitFlyHeight(SFI,375-y,0)
endif
else
call PauseUnit(SFI,false)
if RNI(SFI)==false then
call SetUnitFlyHeight(SFI,GetUnitDefaultFlyHeight(SFI),0)
endif
call Damage((LoadUnitHandle(LY,(handle_id),(2))),SFI,1,(LoadReal(LY,(handle_id),(20))))
call DD1((LoadUnitHandle(LY,(handle_id),(2))),SFI,(LoadReal(LY,(handle_id),(57))))
call NXI(DF1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
return false
endfunction
function DG1 takes unit SFI,unit hero,real M5I,real DH1,real DZ1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call PauseUnit(SFI,true)
if RNI(SFI)==false then
call UnitAddAbility(SFI,'Amrf')
call UnitRemoveAbility(SFI,'Amrf')
endif
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\Impale\\ImpaleHitTarget.mdl",GetUnitX(SFI),GetUnitY(SFI)))
call SaveInteger(LY,(handle_id),(73),(NKI(SFI)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(20),((DH1)*1.0))
call SaveReal(LY,(handle_id),(57),((M5I)*1.0))
call TriggerRegisterTimerEvent(t,0.02/0.52*DZ1,true)
call TriggerAddCondition(t,Condition(function DE1))
endfunction
function DV1 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false and RKI(GetEnumUnit())==false and((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4253))))==1)==false then
call GroupAddUnit(XK,GetEnumUnit())
call DG1(GetEnumUnit(),GK,BK,AK,CK)
endif
endfunction
function DW1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real DH1=(LoadReal(LY,(handle_id),(20)))
local real M5I=(LoadReal(LY,(handle_id),(57)))
local real x1=(LoadReal(LY,(handle_id),(64)))
local real y1=(LoadReal(LY,(handle_id),(65)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y2=(LoadReal(LY,(handle_id),(67)))
local real w=(LoadReal(LY,(handle_id),(68)))
local real DX1=(LoadReal(LY,(handle_id),(44)))
local real a=Atan2(y2-y1,x2-x1)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local group DY1=NTI()
local real DJ1=DX1*0.0625
local real DK1=(LoadReal(LY,(handle_id),(71)))
local real DL1=(LoadReal(LY,(handle_id),(72)))
local real DM1=(LoadReal(LY,(handle_id),(70)))
local real DN1=(LoadReal(LY,(handle_id),(63)))
if DJ1>QNI(x1,y1,x2,y2)then
set x1=x2
set y1=y2
else
set x1=x1+DJ1*Cos(a)
set y1=y1+DJ1*Sin(a)
endif
set GK=hero
set AK=DH1
set BK=M5I
set CK=DN1
set XK=g
call GroupEnumUnitsInRange(DY1,x1,y1,w,Condition(function CA1))
call ForGroup(DY1,function DV1)
call NSI(DY1)
if QNI(x1,y1,DK1,DL1)>=DM1 then
call SaveReal(LY,(handle_id),(71),((x1)*1.0))
call SaveReal(LY,(handle_id),(72),((y1)*1.0))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\Impale\\ImpaleMissTarget.mdl",x1,y1))
endif
call SaveReal(LY,(handle_id),(64),((x1)*1.0))
call SaveReal(LY,(handle_id),(65),((y1)*1.0))
if x1==x2 and y1==y2 then
if(LoadBoolean(LY,(handle_id),(69)))==true then
call NSI(g)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set g=null
set DY1=null
set hero=null
set t=null
return false
endfunction
function DS1 takes unit hero,unit DT1,real DH1,real M5I,real DN1,real x1,real y1,real x2,real y2,real w,group DR1,boolean DP1,real DX1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QWI=QNI(x1,y1,x2,y2)
local integer DQ1=A21(QWI,NN)
local real DM1=QWI/DQ1
local group g
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(20),((DH1)*1.0))
call SaveReal(LY,(handle_id),(57),((M5I)*1.0))
call SaveReal(LY,(handle_id),(63),((DN1)*1.0))
call SaveReal(LY,(handle_id),(64),((x1)*1.0))
call SaveReal(LY,(handle_id),(65),((y1)*1.0))
call SaveReal(LY,(handle_id),(66),((x2)*1.0))
call SaveReal(LY,(handle_id),(67),((y2)*1.0))
call SaveReal(LY,(handle_id),(68),((w)*1.0))
call SaveReal(LY,(handle_id),(44),((DX1)*1.0))
if DR1==null then
set g=NTI()
if DT1!=null and IsUnitIllusion(DT1)==false then
call GroupAddUnit(g,DT1)
endif
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveBoolean(LY,(handle_id),(69),(DP1))
set g=null
else
call SaveGroupHandle(LY,(handle_id),(22),(DR1))
call SaveBoolean(LY,(handle_id),(69),(DP1))
endif
call SaveReal(LY,(handle_id),(70),((DM1)*1.0))
call SaveReal(LY,(handle_id),(71),((x1)*1.0))
call SaveReal(LY,(handle_id),(72),((y1)*1.0))
call TriggerRegisterTimerEvent(t,0.0625,true)
call TriggerAddCondition(t,Condition(function DW1))
set t=null
endfunction
function DU1 takes unit hero,integer level,integer E01 returns nothing
local integer i
if FUI[1]==0 then
return
endif
set i=1
loop
exitwhen i>10
call UnitRemoveAbility(hero,FUI[i])
set i=i+1
endloop
set i=1
loop
exitwhen i>10
call UnitRemoveAbility(hero,G0I[i])
set i=i+1
endloop
set i=1
loop
exitwhen i>10
call UnitRemoveAbility(hero,GII[i])
set i=i+1
endloop
set i=1
loop
exitwhen i>10
call UnitRemoveAbility(hero,G1I[i])
set i=i+1
endloop
call UnitRemoveAbility(hero,'B0BS')
if level==1 then
call UnitAddAbility(hero,FUI[E01])
elseif level==2 then
call UnitAddAbility(hero,G0I[E01])
elseif level==3 then
call UnitAddAbility(hero,GII[E01])
elseif level==4 then
call UnitAddAbility(hero,G1I[E01])
endif
endfunction
function EI1 takes integer E11 returns nothing
set TN=TN+1
set SN[TN]=E11
endfunction
function EO1 takes unit u returns nothing
local integer i=1
loop
exitwhen i>TN
call UnitRemoveAbility(u,SN[i])
set i=i+1
endloop
endfunction
function E31 takes integer IB1 returns boolean
return IB1=='AIpg' or IB1=='A02V' or IB1=='ACpu' or IB1=='A18D' or IB1=='A1OU' or IB1=='AIcy' or IB1=='A1SA' or IB1=='A2T2'
endfunction
function E41 takes unit target returns nothing
call UnitRemoveAbility(target,'Aetl')
call UnitRemoveAbility(target,'BHtc')
call UnitRemoveAbility(target,'A1W3')
call UnitRemoveAbility(target,'B0DO')
call UnitRemoveAbility(target,'B02U')
call DU1(target,0,0)
endfunction
function E51 takes nothing returns boolean
if E31(GetSpellAbilityId())then
call E41(GetSpellTargetUnit())
endif
return false
endfunction
function E71 takes integer E81 returns integer
if G10[E81]==0 then
return E81
else
return G10[E81]
endif
endfunction
function E91 takes integer id returns boolean
return id==HY0 or id==HW0 or id==HV0 or id==HX0 or id==HZ0 or id==HJ0
endfunction
function EA1 takes unit SWI,integer U9I returns boolean
local integer MLI
local item UAI
set MLI=0
loop
exitwhen MLI>5
set UAI=UnitItemInSlot(SWI,MLI)
if UAI!=null and GetItemTypeId(UAI)==U9I then
set UAI=null
return true
endif
set MLI=MLI+1
endloop
set UAI=null
return false
endfunction
function GetItemId takes item AO1 returns integer
local integer U9I
local integer i=1
if AO1==null then
return-2
endif
set U9I=GetItemTypeId(AO1)
loop
exitwhen i>GO0
if FT0[i]==U9I or FR0[i]==U9I or FQ0[i]==U9I then
return i
endif
set i=i+1
endloop
return-1
endfunction
function EC1 takes item AO1 returns integer
local integer U9I
local integer i=1
if AO1==null then
return-2
endif
set U9I=GetItemTypeId(AO1)
loop
exitwhen i>GO0
if FT0[i]==U9I or FR0[i]==U9I then
return i
endif
set i=i+1
endloop
return-1
endfunction
function ED1 takes unit SWI returns integer
local integer EE1
if SWI==null then
return-2
endif
set EE1=GetUnitTypeId(SWI)
if EE1=='Hblm' or EE1=='H06X' or EE1=='H06Y' or EE1=='H06W' or EE1=='H0BC' then
return JF0
elseif EE1=='H004' then
return JZ0
elseif EE1=='UC18' then
return JV0
elseif EE1=='Hmkg' then
return JJ0
elseif EE1=='Ucrl' or EE1=='U01X' then
return KJ0
elseif EE1=='H00H' then
return JM0
elseif EE1=='UC01' then
return JN0
elseif EE1=='Orkn' then
return JS0
elseif EE1=='Hmbr' then
return JQ0
elseif EE1=='Hjai' then
return JT0
elseif EE1=='Ulic' then
return JH0
elseif EE1=='Ekee' then
return JG0
elseif EE1=='Emns' then
return JE0
elseif EE1=='EC57' then
return JR0
elseif EE1=='U00E' then
return JY0
elseif EE1=='E005' then
return JX0
elseif EE1=='E01A' then
return JP0
elseif EE1=='UC42' then
return JW0
elseif EE1=='Npbm' then
return K80
elseif EE1=='H00T' then
return K00
elseif EE1=='Hvwd' then
return KI0
elseif EE1=='Nbbc' then
return K10
elseif EE1=='H00A' then
return K20
elseif EE1=='Udre' then
return K30
elseif EE1=='E00P' then
return K40
elseif EE1=='U00K' then
return K50
elseif EE1=='H00Q' then
return K60
elseif EE1=='H00U' then
return K70
elseif EE1=='U00F' then
return K90
elseif EE1=='N0EG' then
return KA0
elseif EE1=='EC45' then
return KB0
elseif EE1=='O00J' then
return KC0
elseif EE1=='Oshd' then
return KD0
elseif EE1=='Udea' then
return KE0
elseif EE1=='N01W' then
return KF0
elseif EE1=='H00K' then
return KG0
elseif EE1=='Opgh' then
return KH0
elseif EE1=='Otch' then
return KZ0
elseif EE1=='H00R' then
return JL0
elseif EE1=='H07I' then
return JL0
elseif EE1=='N00B' then
return KV0
elseif EE1=='E01C' then
return KW0
elseif EE1=='E002' then
return KX0
elseif EE1=='EC77' then
return KY0
elseif EE1=='U00P' then
return KK0
elseif EE1=='Emoo' then
return KL0
elseif EE1=='H00N' then
return KM0
elseif EE1=='E02N' or EE1=='E02O' then
return KN0
elseif EE1=='H00I' then
return KS0
elseif EE1=='H00D' then
return KT0
elseif EE1=='UC60' then
return KR0
elseif EE1=='N01A' then
return KP0
elseif EE1=='N0HP' then
return KQ0
elseif EE1=='Harf' then
return KU0
elseif EE1=='H0DO' then
return L00
elseif EE1=='Uktl' then
return LI0
elseif EE1=='E02J' then
return LO0
elseif EE1=='E02X' then
return L10
elseif EE1=='Ntin' then
return L20
elseif EE1=='E02H' then
return L30
elseif EE1=='E032' then
return JK0
elseif EE1=='E02F' then
return L40
elseif EE1=='H001' or EE1=='H0CQ' then
return L50
elseif EE1=='O015' then
return L60
elseif EE1=='Hamg' then
return L70
elseif EE1=='N0MU' or EE1=='N0MW' then
return L80
endif
return JD0
endfunction
function EF1 takes unit SWI returns integer
local integer EE1
if SWI==null then
return-2
endif
set EE1=GetUnitTypeId(SWI)
if EE1=='Hblm' or EE1=='H06X' or EE1=='H06Y' or EE1=='H06W' or EE1=='H0BC' then
return 'A0TL'
elseif EE1=='H004' then
return 'A0TP'
elseif EE1=='UC18' then
return 'A0TR'
elseif EE1=='Hmkg' then
return 'A2KT'
elseif EE1=='Ucrl' or EE1=='U01X' then
return 0
elseif EE1=='H00H' then
return 'A0TV'
elseif EE1=='UC01' then
return 'A0TX'
elseif EE1=='Orkn' then
return 'A0TZ'
elseif EE1=='Hmbr' then
return 'A0U1'
elseif EE1=='Hjai' then
return 'A0U3'
elseif EE1=='Ulic' then
return 'A0U5'
elseif EE1=='Ekee' then
return 'A0U7'
elseif EE1=='Emns' then
return 'A0U9'
elseif EE1=='EC57' then
return 'A0UB'
elseif EE1=='U00E' then
return 'A0UD'
elseif EE1=='E005' then
return 'A0UF'
elseif EE1=='E01A' then
return 'A0UH'
elseif EE1=='UC42' then
return 'A0UJ'
elseif EE1=='Npbm' then
return 'A1BE'
elseif EE1=='H00T' then
return 'A1B9'
elseif EE1=='Hvwd' then
return 'A1BA'
elseif EE1=='Nbbc' then
return 'A1BB'
elseif EE1=='H00A' then
return 'A1CU'
elseif EE1=='Udre' then
return 'A1BG'
elseif EE1=='E00P' then
return 'A1BJ'
elseif EE1=='U00K' then
return 'A1BC'
elseif EE1=='H00Q' then
return 'A1BI'
elseif EE1=='H00U' then
return 'A1BD'
elseif EE1=='U00F' then
return 'A1CY'
elseif EE1=='N0EG' then
return 'A1D2'
elseif EE1=='EC45' then
return 'A1D1'
elseif EE1=='O00J' then
return 'A1CZ'
elseif EE1=='Oshd' then
return 'A1D0'
elseif EE1=='Udea' then
return 'A1D3'
elseif EE1=='N01W' then
return 'A1D4'
elseif EE1=='H00K' then
return 'A1G1'
elseif EE1=='Opgh' then
return 'A1MT'
elseif EE1=='Otch' then
return 'A1N0'
elseif EE1=='N00B' then
return 'A1QS'
elseif EE1=='E01C' then
return 'A1UT'
elseif EE1=='E002' then
return 'A1UU'
elseif EE1=='EC77' then
return 'A1V1'
elseif EE1=='U00P' then
return 'A1VY'
elseif EE1=='Emoo' then
return 'A1WD'
elseif EE1=='H00N' then
return 'A21S'
elseif EE1=='E02N' or EE1=='E02O' then
return 'A237'
elseif EE1=='H00I' then
return 'A27E'
elseif EE1=='H00D' then
return 'A28A'
elseif EE1=='UC60' then
return 'A2IH'
elseif EE1=='N01A' then
return 'A2QB'
elseif EE1=='N0HP' then
return 'A2QF'
elseif EE1=='Harf' then
return 'A2S7'
elseif EE1=='H0DO' then
return 'A2TW'
elseif EE1=='Uktl' then
return 'A2TZ'
elseif EE1=='E02J' then
return 'A2VC'
elseif EE1=='E02X' then
return 'A2VD'
elseif EE1=='Ntin' then
return 'A2WD'
elseif EE1=='E02H' then
return 'A2XG'
elseif EE1=='E032' then
return 'A2YQ'
elseif EE1=='E02F' then
return 'A2YT'
elseif EE1=='H001' or EE1=='H0CQ' then
return 'A2Z3'
elseif EE1=='O015' then
return 'A2ZG'
elseif EE1=='Hamg' then
return 'A314'
elseif EE1=='N0MU' or EE1=='N0MW' then
return 'A31N'
endif
return 0
endfunction
function EG1 takes item BA1 returns boolean
local integer i=1
loop
exitwhen i>M50
if BA1==M40[i]then
return true
endif
set i=i+1
endloop
return false
endfunction
function EH1 takes item AO1 returns boolean
local integer E81=GetItemId(AO1)
if E81==JD0 or E81==JE0 or E81==JF0 or E81==JG0 or E81==JH0 or E81==JZ0 or E81==JV0 or E81==JW0 or E81==JX0 or E81==JY0 or E81==JJ0 or E81==JM0 or E81==JN0 or E81==JS0 or E81==JT0 or E81==JR0 or E81==JP0 or E81==JQ0 or E81==K00 or E81==KI0 or E81==K10 or E81==K20 or E81==K30 or E81==K40 or E81==K50 or E81==K60 or E81==K70 or E81==K90 or E81==KA0 or E81==KB0 or E81==KC0 or E81==KD0 or E81==KE0 or E81==KF0 or E81==KG0 or E81==K80 or E81==KH0 or E81==KZ0 then
return true
elseif E81==KV0 or E81==KW0 or E81==KX0 or E81==KY0 or E81==KJ0 or E81==KK0 or E81==KL0 or E81==KM0 or E81==KN0 or E81==KS0 or E81==KT0 or E81==KR0 or E81==KQ0 or E81==KP0 or E81==KU0 or E81==LI0 or E81==L00 or E81==LO0 or E81==L10 or E81==L20 or E81==JK0 or E81==L40 or E81==L50 or E81==L60 or E81==L70 or E81==L80 then
return true
endif
return false
endfunction
function EZ1 takes integer E81 returns boolean
return E81==WJ0 or E81==ZE0 or E81==Z50 or E81==Z70 or E81==Z80 or E81==ZA0 or E81==ZB0 or E81==ZC0 or E81==Z60 or E81==ZH0 or E81==ZZ0 or E81==ZG0
endfunction
function EV1 takes integer E81 returns boolean
return E81==X60 or E81==HP0 or E81==V40 or E81==V50 or E81==WM0 or E81==VL0 or E81==HK0 or E81==X10 or E81==HU0
endfunction
function EW1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer U9I=(LoadInteger(LY,(handle_id),(74)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local boolean EX1=(LoadBoolean(LY,(handle_id),(75)))
local integer EY1=(LoadInteger(LY,(handle_id),(76)))
local item EJ1=CreateItem(U9I,x,y)
call SetItemPlayer(EJ1,p,true)
call SetItemUserData(EJ1,0)
if EX1 then
call SetItemCharges(EJ1,EY1)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set p=null
return false
endfunction
function EK1 takes integer U9I,real x,real y,player p,boolean EX1,integer EY1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(74),(U9I))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SavePlayerHandle(LY,(handle_id),(54),(p))
call SaveBoolean(LY,(handle_id),(75),(EX1))
call SaveInteger(LY,(handle_id),(76),(EY1))
call TriggerAddCondition(t,Condition(function EW1))
call TriggerRegisterTimerEvent(t,0,false)
set t=null
endfunction
function DisableItemTriggers takes nothing returns nothing
call MUDisableItemTrigger()
endfunction
function EnableItemTriggers takes nothing returns nothing
call MUEnableItemTrigger()
endfunction
function EL1 takes item AO1 returns nothing
call MUDisableItemTrigger()
call RemoveItem(AO1)
call MUEnableItemTrigger()
endfunction
function EM1 takes unit SWI,integer U9I,item EN1 returns item
local integer MLI
local item UAI
set MLI=0
loop
exitwhen MLI>5
set UAI=UnitItemInSlot(SWI,MLI)
if UAI!=null and UAI!=EN1 and GetItemTypeId(UAI)==U9I then
set UAI=null
return UnitItemInSlot(SWI,MLI)
endif
set MLI=MLI+1
endloop
set UAI=null
return null
endfunction
function ES1 takes unit SWI,integer U9I returns item
local integer MLI
local item UAI
set MLI=0
loop
exitwhen MLI>5
set UAI=UnitItemInSlot(SWI,MLI)
if(UAI!=null)and(GetItemTypeId(UAI)==U9I)then
set UAI=null
return UnitItemInSlot(SWI,MLI)
endif
set MLI=MLI+1
endloop
set UAI=null
return null
endfunction
function ET1 takes player p,unit SWI,integer E81,item EN1 returns item
local integer MLI
local item UAI
set MLI=0
loop
exitwhen MLI>5
set UAI=UnitItemInSlot(SWI,MLI)
if UAI!=null and UAI!=EN1 and GetItemId(UAI)==E81 and(GetItemPlayer(UAI)==p or E81==ZA0 or E81==ZB0)then
set UAI=null
return UnitItemInSlot(SWI,MLI)
endif
set MLI=MLI+1
endloop
set UAI=null
return null
endfunction
function ER1 takes player p,unit SWI,integer E81 returns item
local integer MLI
local item UAI
set MLI=0
loop
exitwhen MLI>5
set UAI=UnitItemInSlot(SWI,MLI)
if(UAI!=null)and(GetItemId(UAI)==E81)and(GetItemPlayer(UAI)==p or E81==ZA0 or E81==ZB0)then
set UAI=null
return UnitItemInSlot(SWI,MLI)
endif
set MLI=MLI+1
endloop
set UAI=null
return null
endfunction
function EP1 takes unit SWI,integer E81 returns item
local integer MLI
local item UAI
set MLI=0
loop
exitwhen MLI>5
set UAI=UnitItemInSlot(SWI,MLI)
if(UAI!=null)and(GetItemId(UAI)==E81)then
set UAI=null
return UnitItemInSlot(SWI,MLI)
endif
set MLI=MLI+1
endloop
set UAI=null
return null
endfunction
function EQ1 takes unit SWI returns integer
local integer i=0
local integer n=0
local integer EU1=UnitInventorySize(SWI)-1
loop
exitwhen i>EU1
if UnitItemInSlot(SWI,i)==null then
set n=n+1
endif
set i=i+1
endloop
return n
endfunction
function F01 takes item AO1 returns integer
local integer U9I
local integer i=1
if AO1==null then
return-2
endif
set U9I=GetItemTypeId(AO1)
loop
exitwhen i>GO0
if FT0[i]==U9I or FR0[i]==U9I then
return i
endif
set i=i+1
endloop
return-1
endfunction
function FI1 takes item AO1 returns integer
local integer U9I
local integer i=1
if AO1==null then
return-2
endif
set U9I=GetItemTypeId(AO1)
loop
exitwhen i>GO0
if FQ0[i]==U9I then
return i
endif
set i=i+1
endloop
return-1
endfunction
function F11 takes item AO1 returns integer
local integer U9I
local integer i=1
if AO1==null then
return-2
endif
set U9I=GetItemTypeId(AO1)
loop
exitwhen i>GO0
if FQ0[i]==U9I then
return FR0[i]
endif
set i=i+1
endloop
return-1
endfunction
function FO1 takes unit SWI returns integer
local integer EE1
local integer i=0
if SWI==null then
return-2
endif
set EE1=GetUnitTypeId(SWI)
loop
exitwhen i>GO0
if FP0[i]==EE1 then
return i
endif
set i=i+1
endloop
return-1
endfunction
function F21 takes item F31 returns string
if F31==null then
return"UI\\Widgets\\Console\\Undead\\undead-inventory-slotfiller.blp"
endif
return G00[GetItemId(F31)]
endfunction
function F41 takes item AO1 returns boolean
return GetItemId(AO1)==W30 or GetItemId(AO1)==W40 or GetItemId(AO1)==GZ0 or GetItemId(AO1)==GV0
endfunction
function F51 takes integer E81 returns integer
if Z80==E81 then
return 4
endif
if ZA0==E81 or ZB0==E81 or ZF0==E81 or Z60==E81 or ZH0==E81 or ZG0==E81 then
return 2
endif
return 1
endfunction
function F61 takes item AO1 returns boolean
return GetItemType(AO1)==ITEM_TYPE_POWERUP or GetItemType(AO1)==ITEM_TYPE_PURCHASABLE or GetItemType(AO1)==ITEM_TYPE_MISCELLANEOUS
endfunction
// 让单位获得林肯buff(单位, 物品ID)
function F71 takes unit SWI,integer U9I returns boolean
	local item BA1
	local boolean F81=false
	local boolean F91=true
	// 创建物品
	set BA1=CreateItem(U9I,GetUnitX(SWI),GetUnitY(SWI))
	// 如果没有物品栏就加个物品栏
	if GetUnitAbilityLevel(SWI,'AInv')==0 then
		set F81=true
		call AddSkill(SWI,'AInv')
	endif
	if UnitAddItem(SWI,BA1)==false then
		// 物品添加失败
		call RemoveItem(BA1)
		set F91=false
	elseif GetWidgetLife(BA1)>0 then
		// 物品没死就把物品删除(?)
		call RemoveItem(BA1)
		set F91=false
	endif
	// 加了物品栏再删掉
	if F81 then
		call UnitRemoveAbility(SWI,'AInv')
	endif
	set BA1=null
	return F91
endfunction
function FA1 takes unit SFI returns real
local real FB1
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set FB1=GetRectCenterX(O4)
else
set FB1=GetRectCenterX(S3)
endif
return FB1
endfunction
function FC1 takes unit SFI returns real
local real FB1
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set FB1=GetRectCenterY(O4)
else
set FB1=GetRectCenterY(S3)
endif
return FB1
endfunction
function FD1 takes unit SFI,integer FE1,integer FF1 returns item
local real x=FA1(SFI)
local real y=FC1(SFI)
local item BA1=CreateItem(FE1,x,y)
local integer i=0
local boolean array FG1
local item FH1
call MUDisableItemTrigger()
if FE1>0 then
loop
exitwhen i>(UnitInventorySize(SFI)-1)
if UnitItemInSlot(SFI,i)==null and i!=FF1 then
set FH1=CreateItem('I02M',x,y)
call UnitAddItem(SFI,FH1)
set FG1[i]=true
else
set FG1[i]=false
endif
if i==FF1 then
call MUEnableItemTrigger()
call UnitAddItem(SFI,BA1)
call MUDisableItemTrigger()
endif
set i=i+1
endloop
set i=0
loop
exitwhen i>5
if FG1[i]==true then
call RemoveItem(UnitItemInSlot(SFI,i))
endif
set i=i+1
endloop
endif
call MUEnableItemTrigger()
set VK=BA1
set BA1=null
set FH1=null
return VK
endfunction
function FZ1 takes integer SSI,integer r,integer g,integer b returns nothing
set IS=IS+1
set RN[IS]=r
set PN[IS]=g
set QN[IS]=b
set UN[IS]=SSI
endfunction
function FV1 takes unit u returns nothing
local integer id=GetUnitTypeId(u)
local integer i=1
local integer a=255
local boolean FW1=false
if id=='Ewar' then
set a=R2I(2.55*(100-18+20*GetUnitAbilityLevel(u,'A03P')))
endif
loop
exitwhen i>IS or FW1
if UN[i]==id then
set FW1=true
call SetUnitVertexColor(u,RN[i],PN[i],QN[i],a)
endif
set i=i+1
endloop
if FW1==false then
call SetUnitVertexColor(u,255,255,255,255)
endif
endfunction
function FY1 takes unit u returns nothing
local integer id=GetUnitTypeId(u)
local integer i=1
local boolean FW1=false
loop
exitwhen i>IS or FW1
if UN[i]==id then
set FW1=true
call SetUnitVertexColor(u,RN[i],PN[i],QN[i],0)
endif
set i=i+1
endloop
if FW1==false then
call SetUnitVertexColor(u,255,255,255,0)
endif
endfunction
function FJ1 takes player p,string FK1,integer U0I returns nothing
local string id=I2S(GetPlayerId(p))
call StoreInteger(OS,id,FK1,U0I)
if T3I(WO)==false then
call RTI()
endif
if GetLocalPlayer()==WO then
call SyncStoredInteger(OS,id,FK1)
endif
endfunction
function FL1 takes string FM1,integer U0I returns nothing
call StoreInteger(OS,"Data",FM1,U0I)
if T3I(WO)==false then
call RTI()
endif
if GetLocalPlayer()==WO then
call SyncStoredInteger(OS,"Data",FM1)
endif
endfunction
function FN1 takes nothing returns nothing
call FlushGameCache(InitGameCache("dr.x"))
set OS=InitGameCache("dr.x")
endfunction
function InitTrig_Traffic_Functions takes nothing returns nothing
call FN1()
endfunction
function FS1 takes string s,string FT1,string FR1 returns string
local string FP1=""
local integer i=0
local integer FQ1=StringLength(s)
local string FU1
local integer G01=StringLength(FT1)
local boolean FW1=false
loop
exitwhen i+1>FQ1
set FU1=SubString(s,i,i+G01)
if FU1!=FT1 or FW1 then
set FP1=FP1+SubString(s,i,i+1)
set i=i+1
else
set FP1=FP1+FR1
set i=i+G01
set FW1=true
endif
endloop
return FP1
endfunction
function GI1 takes player G11,player GO1 returns string
local string s="$dead被队友$killer杀死了！"
set s=FS1(s,"$dead",C0[GetPlayerId(G11)]+(D80[GetPlayerId((G11))])+"|r")
set s=FS1(s,"$killer",C0[GetPlayerId(GO1)]+(D80[GetPlayerId((GO1))])+"|r")
return s
endfunction
function G21 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,BS[0])
call UnitRemoveAbility(u,BS[1])
call UnitRemoveAbility(u,BS[2])
call UnitRemoveAbility(u,BS[3])
call UnitRemoveAbility(u,BS[4])
call UnitRemoveAbility(u,BS[5])
call UnitRemoveAbility(u,BS[6])
call UnitRemoveAbility(u,BS[7])
call UnitRemoveAbility(u,BS[8])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=8
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call UnitAddAbility(u,BS[i])
else
call UnitRemoveAbility(u,BS[i])
endif
set i=i+1
endloop
endfunction
function G41 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,CS[0])
call UnitRemoveAbility(u,CS[1])
call UnitRemoveAbility(u,CS[2])
call UnitRemoveAbility(u,CS[3])
call UnitRemoveAbility(u,CS[4])
call UnitRemoveAbility(u,CS[5])
call UnitRemoveAbility(u,CS[6])
call UnitRemoveAbility(u,CS[7])
call UnitRemoveAbility(u,CS[8])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=8
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call UnitAddAbility(u,CS[i])
else
call UnitRemoveAbility(u,CS[i])
endif
set i=i+1
endloop
endfunction
function G61 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,DS[0])
call UnitRemoveAbility(u,DS[1])
call UnitRemoveAbility(u,DS[2])
call UnitRemoveAbility(u,DS[3])
call UnitRemoveAbility(u,DS[4])
call UnitRemoveAbility(u,DS[5])
call UnitRemoveAbility(u,DS[6])
call UnitRemoveAbility(u,DS[7])
call UnitRemoveAbility(u,DS[8])
call UnitRemoveAbility(u,DS[9])
call UnitRemoveAbility(u,DS[10])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=10
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call UnitAddAbility(u,DS[i])
else
call UnitRemoveAbility(u,DS[i])
endif
set i=i+1
endloop
endfunction
function G81 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,ES[0])
call UnitRemoveAbility(u,ES[1])
call UnitRemoveAbility(u,ES[2])
call UnitRemoveAbility(u,ES[3])
call UnitRemoveAbility(u,ES[4])
call UnitRemoveAbility(u,ES[5])
call UnitRemoveAbility(u,ES[6])
call UnitRemoveAbility(u,ES[7])
call UnitRemoveAbility(u,ES[8])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=8
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call UnitAddAbility(u,ES[i])
else
call UnitRemoveAbility(u,ES[i])
endif
set i=i+1
endloop
endfunction
function GA1 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,FS[0])
call UnitRemoveAbility(u,FS[1])
call UnitRemoveAbility(u,FS[2])
call UnitRemoveAbility(u,FS[3])
call UnitRemoveAbility(u,FS[4])
call UnitRemoveAbility(u,FS[5])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=i
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call UnitAddAbility(u,FS[i])
else
call UnitRemoveAbility(u,FS[i])
endif
set i=i+1
endloop
endfunction
function GC1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer i=(LoadInteger(LY,(handle_id),(77)))
local string c="|c006699CC"
if "语言：简体中文"=="Language: English"and(DR0[(i)]!="")then
if GetTriggerEvalCount(t)==1 then
elseif GetTriggerEvalCount(t)==2 then
call DisplayTimedTextToPlayer(p,0,0,15,"Tip 1: "+c+DR0[i]+"|r")
call OQ1(LE,p)
elseif GetTriggerEvalCount(t)==3 then
call DisplayTimedTextToPlayer(p,0,0,15,"Tip 2: "+c+DP0[i]+"|r")
call OQ1(LE,p)
elseif GetTriggerEvalCount(t)==4 then
call DisplayTimedTextToPlayer(p,0,0,15,"Tip 3: "+c+DQ0[i]+"|r")
call OQ1(LE,p)
elseif GetTriggerEvalCount(t)==5 then
call DisplayTimedTextToPlayer(p,0,0,15,"Tip 4: "+c+DU0[i]+"|r")
call OQ1(LE,p)
elseif GetTriggerEvalCount(t)==6 then
call DisplayTimedTextToPlayer(p,0,0,15,"Tip 5: "+c+E00[i]+"|r")
call OQ1(LE,p)
endif
endif
if GetTriggerEvalCount(t)==5 then
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
endif
return false
endfunction
function GD1 takes player p,integer i returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,10,false)
call TriggerRegisterTimerEvent(t,15,false)
call TriggerRegisterTimerEvent(t,300,true)
call TriggerAddCondition(t,Condition(function GC1))
call SavePlayerHandle(LY,(handle_id),(54),(p))
call SaveInteger(LY,(handle_id),(77),(i))
set t=null
endfunction
function GE1 takes unit hero returns integer
local integer RII=GetUnitTypeId(hero)
local integer GF1='o01P'
if RII=='Udre' then
set GF1='o01N'
elseif RII=='Emoo' or RII=='H00I' or RII=='H071' or RII=='E005' then
set GF1='o01O'
endif
return GF1
endfunction
function GG1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
endif
set t=null
set hero=null
set dummy=null
return false
endfunction
function GH1 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),GE1(hero),GetUnitX(hero),GetUnitY(hero),0)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function GG1))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
set t=null
endfunction
function GZ1 takes integer EE1 returns boolean
local integer i=0
loop
exitwhen i>59
if EE1==ZS[i]then
return true
endif
set i=i+1
endloop
return false
endfunction
function GV1 takes integer level returns integer
local real GW1=TimerGetElapsed(M)-N
local real BX1=(R2I(GW1)/60)-(1/2)
local real GX1=100+level*level*1.5+BX1*15
local integer MLI
set MLI=R2I(GX1/50)
set MLI=IMinBJ(MLI,59)
set MLI=IMaxBJ(MLI,0)
return MLI
endfunction
function GY1 takes player p returns nothing
local integer id=GetPlayerId(p)
local unit GJ1=D30[id]
local unit SFI=K1[id]
local integer level=GetHeroLevel(SFI)
local integer i=0
loop
exitwhen i>59
call RemoveUnitFromStock(GJ1,ZS[i])
set i=i+1
endloop
if X0==true then
return
endif
if TN0==false then
return
endif
call AddUnitToStock(GJ1,ZS[GV1(level)],1,1)
set VS[id]=ZS[GV1(level)]
set SFI=null
set GJ1=null
endfunction
function GK1 takes player p returns nothing
local integer id=GetPlayerId(p)
local unit GJ1=D30[id]
local unit SFI=K1[id]
local integer level=GetHeroLevel(SFI)
local integer i=0
if X0==true then
return
endif
if TN0==false then
return
endif
if VS[id]=='h0D4' then
return
endif
if VS[id]!=0 then
call RemoveUnitFromStock(GJ1,VS[id])
endif
call AddUnitToStock(GJ1,ZS[GV1(level)],1,1)
set VS[id]=ZS[GV1(level)]
set SFI=null
set GJ1=null
endfunction
function GL1 takes nothing returns boolean
if X0==true then
return false
endif
call GK1(BO[1])
call GK1(BO[2])
call GK1(BO[3])
call GK1(BO[4])
call GK1(BO[5])
call GK1(CO[1])
call GK1(CO[2])
call GK1(CO[3])
call GK1(CO[4])
call GK1(CO[5])
return false
endfunction
function GM1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer id=(LoadInteger(LY,(handle_id),(34)))
local unit GJ1=D30[id]
local unit SFI=K1[id]
local integer level=GetHeroLevel(SFI)
local integer i=0
call RemoveUnitFromStock(GJ1,'h0D4')
call AddUnitToStock(GJ1,ZS[GV1(level)],1,1)
set VS[id]=ZS[GV1(level)]
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function GN1 takes player p returns nothing
local integer id=GetPlayerId(p)
local unit GJ1=D30[id]
local unit SFI=K1[id]
local integer level=GetHeroLevel(SFI)
local integer i=0
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call GH1(SFI)
loop
exitwhen i>59
call RemoveUnitFromStock(GJ1,ZS[i])
set i=i+1
endloop
call TriggerAddCondition(t,Condition(function GM1))
call TriggerRegisterTimerEvent(t,360,false)
call SaveInteger(LY,(handle_id),(34),(id))
set VS[id]='h0D4'
call RemoveUnitFromStock(GJ1,'h0D4')
call AddUnitToStock(GJ1,'h0D4',0,1)
set SFI=null
set GJ1=null
set t=null
endfunction
function GT1 takes unit SFI returns nothing
local real GR1=1
local integer GP1=UnitInventorySize(SFI)
local integer x=0
local item i
local integer level=GetUnitAbilityLevel(SFI,'A03P')
if level>0 then
if level==1 then
set GR1=GR1*0.8
elseif level==2 then
set GR1=GR1*0.7
elseif level==3 then
set GR1=GR1*0.6
elseif level==4 then
set GR1=GR1*0.5
endif
endif
set level=GetUnitAbilityLevel(SFI,'A0MX')
if level>0 then
set GR1=GR1*(1-(0.05+0.05*level))
endif
loop
exitwhen x>GP1
set i=UnitItemInSlot(SFI,x)
if F01(i)==WF0 then
set GR1=GR1*0.65
elseif F01(i)==HN0 or F01(i)==XC0 then
set GR1=GR1*0.75
endif
set x=x+1
endloop
set level=R2I((1-GR1)/0.05)
if level>0 then
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2V2',false)
call AddSkill(SFI,'A2V2')
call UnitMakeAbilityPermanent(SFI,true,'A2V3')
call SetUnitAbilityLevel(SFI,'A2V3',level)
else
call UnitRemoveAbility(SFI,'A2V2')
endif
set i=null
endfunction
function GQ1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call GT1(SFI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function GU1 takes unit SFI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerAddCondition(t,Condition(function GQ1))
call TriggerRegisterTimerEvent(t,0,false)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
endfunction
function H01 takes nothing returns boolean
if GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and(F01(GetManipulatedItem())==WF0 or F01(GetManipulatedItem())==HN0 or F01(GetManipulatedItem())==XC0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
call GT1(GetTriggerUnit())
else
call GU1(GetTriggerUnit())
endif
endif
return false
endfunction
function H11 takes unit hero,real HO1 returns real
loop
if HO1>25 then
set HO1=HO1-25
else
set HO1=HO1-5
endif
call SetUnitMoveSpeed(hero,HO1)
exitwhen GetUnitMoveSpeed(hero)<522
endloop
return HO1
endfunction
function H21 takes unit hero returns real
local real HO1
local integer E01=(LoadInteger(LY,(GetHandleId(hero)),(814)))
local integer level
local real b1
local real r1
local real b2
local real r2
local real H31
local real H41
if GetUnitMoveSpeed(hero)==522 and E01>0 then
set HO1=GetUnitDefaultMoveSpeed(hero)
set level=GetUnitAbilityLevel(hero,'A0I8')
set b1=H11(hero,HO1)
set r1=GetUnitMoveSpeed(hero)
set b2=H11(hero,b1)
set r2=GetUnitMoveSpeed(hero)
set H31=(r1-r2)/(b1-b2)-1
set H41=r1/(1+H31)-b1
set H31=QCI(H31,0.05*E01+1)
call SetUnitMoveSpeed(hero,HO1)
return(HO1+H41)*(1+H31)
else
return GetUnitMoveSpeed(hero)
endif
endfunction
function H51 takes unit hero returns real
local real ms=GetUnitMoveSpeed(hero)
if(LoadInteger(LY,(GetHandleId(hero)),(814)))>0 then
set ms=H21(hero)
endif
if((LoadInteger(LY,(GetHandleId((hero))),((4423))))==1)==true then
set ms=1000.
endif
if((LoadInteger(LY,(GetHandleId((hero))),((4424))))==1)==true then
set ms=650
endif
return ms
endfunction
function H61 takes unit hero,real H71,real H81,real H91 returns nothing
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real a=Atan2(y-H81,x-H71)
local real d=QNI(x,y,H71,H81)
local real ms=GetUnitMoveSpeed(hero)
if P1I(hero)==false and H91>ms and d>10*0.005 then
set x=PTI(x+(H91-ms)*0.005*Cos(a))
set y=PUI(y+(H91-ms)*0.005*Sin(a))
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
endif
endfunction
function HA1 takes nothing returns nothing
set LY=InitHashtable()
set M=CreateTimer()
set MS=Rect(-7040,-7680,7040,7168)
call SetFloatGameState(GAME_STATE_TIME_OF_DAY,6.00)
call SuspendTimeOfDay(false)
call SetTimeOfDayScale(0.5)
call SetSkyModel("Environment\\Sky\\FoggedSky\\FoggedSky.mdl")
call SetCreepCampFilterState(true)
set D3="Normal Mode"
call TimerStart(M,99999.00,false,null)
set V3=AddWeatherEffect(bj_mapInitialPlayableArea,'RAhr')
set Z3=AddWeatherEffect(bj_mapInitialPlayableArea,'SNbs')
set KS=AddWeatherEffect(bj_mapInitialPlayableArea,'LRma')
set LS=AddWeatherEffect(bj_mapInitialPlayableArea,'WOlw')
set BO[0]=Player(0)
set BO[1]=Player(1)
set BO[2]=Player(2)
set BO[3]=Player(3)
set BO[4]=Player(4)
set BO[5]=Player(5)
set CO[0]=Player(6)
set CO[1]=Player(7)
set CO[2]=Player(8)
set CO[3]=Player(9)
set CO[4]=Player(10)
set CO[5]=Player(11)
set DO=Player(12)
set EO=Player(15)
call SetUnitPathing(CZ,false)
call SetUnitPathing(DZ,false)
call SetUnitPathing(ZZ,false)
call SetUnitPathing(BZ,false)
call SetUnitPathing(OZ,false)
call BK1(OZ,true)
call BK1(BZ,true)
call BK1(ZZ,true)
call BK1(DZ,true)
call BK1(CZ,true)
set U0=GetUnitLoc(OZ)
set II=GetUnitLoc(CZ)
set BI=GetUnitLoc(ZZ)
set CI=GetUnitLoc(BZ)
set DI=GetUnitLoc(DZ)
set I2='A06G'
set O2[1]=II
set O2[2]=CI
set O2[3]=BI
set O2[4]=DI
set O2[5]=U0
set TI=GetRectCenter(M3)
set RI=GetRectCenter(N3)
set PI=GetRectCenter(L3)
set QI=GetRectCenter(U3)
set I1=GetRectCenter(I4)
set UI=GetRectCenter(Q3)
set O1=GetRectCenter(C4)
set B1=GetRectCenter(B4)
set A1=GetRectCenter(A4)
set C1=GetRectCenter(P3)
set E1=GetRectCenter(R3)
set D1=GetRectCenter(T3)
set F1=GetRectCenter(G4)
set G1=GetRectCenter(D4)
set J2=true
endfunction
function InitTrig_Map takes nothing returns nothing
call HA1()
endfunction
function HB1 takes nothing returns nothing
set QS=GetUnitX(IV)
set US=GetUnitY(IV)
set IT=GetUnitX(CV)
set OT=GetUnitY(CV)
set AT=GetUnitX(AV)
set BT=GetUnitY(AV)
set CT=GetUnitX(OV)
set DT=GetUnitY(OV)
set ET=GetUnitX(HW)
set FT=GetUnitY(HW)
set GT=GetUnitX(HZ)
set HT=GetUnitY(HZ)
set ZT=GetUnitX(FZ)
set VT=GetUnitY(FZ)
set WT=GetUnitX(AZ)
set XT=GetUnitY(AZ)
set YT=GetUnitX(VZ)
set JT=GetUnitY(VZ)
set KT=GetUnitX(DV)
set LT=GetUnitY(DV)
set KT=GetUnitX(DV)
set LT=GetUnitY(DV)
set MT=GetUnitX(ZY)
set ST=GetUnitY(ZY)
set RT=GetUnitX(UH)
set PT=GetUnitY(UH)
set QT=GetUnitX(HV)
set UT=GetUnitY(HV)
set IR=GetUnitX(GV)
set OR=GetUnitY(GV)
set BR=GetUnitX(EV)
set CR=GetUnitY(EV)
set DR=GetUnitX(ZV)
set GR=GetUnitY(ZV)
set HR=GetUnitX(WZ)
set ZR=GetUnitY(WZ)
set WR=GetUnitX(FV)
set XR=GetUnitY(FV)
set YR=GetUnitX(WV)
set JR=GetUnitY(WV)
set KR=GetUnitX(VV)
set LR=GetUnitY(VV)
set SR=GetUnitX(NV)
set RR=GetUnitY(NV)
set PR=GetUnitX(YV)
set QR=GetUnitY(YV)
set UR=GetUnitX(XV)
set IP=GetUnitY(XV)
set OP=GetUnitX(JV)
set BP=GetUnitY(JV)
set DP=GetUnitX(MV)
set EP=GetUnitY(MV)
set FP=GetUnitX(LV)
set GP=GetUnitY(LV)
set ZP=GetUnitX(KV)
set VP=GetUnitY(KV)
set WP=GetUnitX(TV)
set YP=GetUnitY(TV)
set JP=GetUnitX(SV)
set KP=GetUnitY(SV)
set LP=GetUnitX(UV)
set MP=GetUnitY(UV)
set TP=GetUnitX(QV)
set RP=GetUnitY(QV)
set PP=GetUnitX(IW)
set QP=GetUnitY(IW)
set UP=GetUnitX(OW)
set IQ=GetUnitY(OW)
set OQ=GetUnitX(AW)
set AQ=GetUnitY(AW)
set BQ=GetUnitX(PV)
set CQ=GetUnitY(PV)
set DQ=GetUnitX(CW)
set EQ=GetUnitY(CW)
set FQ=GetUnitX(DW)
set GQ=GetUnitY(DW)
set HQ=GetUnitX(BW)
set ZQ=GetUnitY(BW)
set VQ=GetUnitX(EW)
set WQ=GetUnitY(EW)
set XQ=GetUnitX(FW)
set YQ=GetUnitY(FW)
set JQ=GetUnitX(BV)
set KQ=GetUnitY(BV)
set LQ=GetUnitX(GW)
set MQ=GetUnitY(GW)
set NQ=GetUnitX(VW)
set SQ=GetUnitY(VW)
set TQ=GetUnitX(ZW)
set RQ=GetUnitY(ZW)
call RemoveUnit(WV)
call RemoveUnit(KV)
call RemoveUnit(JV)
call RemoveUnit(VV)
call RemoveUnit(TV)
call RemoveUnit(MV)
call RemoveUnit(NV)
call RemoveUnit(SV)
call RemoveUnit(LV)
call RemoveUnit(BV)
call RemoveUnit(GW)
call RemoveUnit(UH)
call RemoveUnit(YV)
call RemoveUnit(XV)
call RemoveUnit(UV)
call RemoveUnit(QV)
call RemoveUnit(IW)
call RemoveUnit(OW)
call RemoveUnit(AW)
call RemoveUnit(PV)
call RemoveUnit(CW)
call RemoveUnit(DW)
call RemoveUnit(BW)
call RemoveUnit(EW)
call RemoveUnit(FW)
call RemoveUnit(DV)
call RemoveUnit(ZY)
call RemoveUnit(VZ)
call RemoveUnit(AZ)
call RemoveUnit(FZ)
call RemoveUnit(HZ)
call RemoveUnit(AV)
call RemoveUnit(OV)
call RemoveUnit(IV)
call RemoveUnit(CV)
call RemoveUnit(HW)
call RemoveUnit(HV)
call RemoveUnit(GV)
call RemoveUnit(EV)
call RemoveUnit(ZV)
call RemoveUnit(WZ)
call RemoveUnit(FV)
call RemoveUnit(VW)
call RemoveUnit(ZW)
set PQ=CreateUnit(BO[0],'nfoh',QS,US,270)
set QQ=CreateUnit(EO,'hC95',IT,OT,270)
set UQ=CreateUnit(EO,'n01K',AT,BT,270)
set I00=CreateUnit(EO,'nC38',CT,DT,270)
set II0=CreateUnit(EO,'e025',ET,FT,270)
set I10=CreateUnit(EO,'n00V',GT,HT,270)
set IO0=CreateUnit(EO,'n00W',ZT,VT,270)
set I20=CreateUnit(EO,'n002',WT,XT,270)
set I30=CreateUnit(EO,'n00X',YT,JT,270)
set I40=CreateUnit(EO,'n009',KT,LT,270)
set I50=CreateUnit(EO,'n0HE',MT,ST,270)
set I60=CreateUnit(BO[0],'etol',RT,PT,270)
set I70=CreateUnit(BO[0],'e00R',QT,UT,90)
set I80=CreateUnit(BO[0],'e00R',IR,OR,45)
set I90=CreateUnit(BO[0],'e00R',BR,CR,0)
set IA0=CreateUnit(BO[0],'e011',DR,GR,90)
set IB0=CreateUnit(BO[0],'e011',HR,ZR,45)
set IC0=CreateUnit(BO[0],'e011',WR,XR,0)
set ID0=CreateUnit(BO[0],'e00S',YR,JR,90)
set IE0=CreateUnit(BO[0],'e00S',KR,LR,45)
set IF0=CreateUnit(BO[0],'e00S',SR,RR,0)
set IG0=CreateUnit(BO[0],'e019',PR,QR,45)
set IH0=CreateUnit(BO[0],'e019',UR,IP,45)
set IZ0=CreateUnit(BO[0],'eaom',OP,BP,90)
set IV0=CreateUnit(BO[0],'eaom',DP,EP,45)
set IW0=CreateUnit(BO[0],'eaom',FP,GP,0)
set IX0=CreateUnit(BO[0],'eaoe',ZP,VP,90)
set IY0=CreateUnit(BO[0],'eaoe',WP,YP,45)
set IJ0=CreateUnit(BO[0],'eaoe',JP,KP,0)
set IK0=CreateUnit(BO[0],'emow',LP,MP,270)
set IL0=CreateUnit(BO[0],'emow',TP,RP,270)
set IM0=CreateUnit(BO[0],'emow',PP,QP,270)
set IN0=CreateUnit(BO[0],'emow',UP,IQ,270)
set IS0=CreateUnit(BO[0],'emow',OQ,AQ,270)
set IT0=CreateUnit(BO[0],'emow',BQ,CQ,270)
set IR0=CreateUnit(BO[0],'emow',DQ,EQ,270)
set IP0=CreateUnit(BO[0],'emow',FQ,GQ,270)
set IQ0=CreateUnit(BO[0],'emow',HQ,ZQ,270)
set IU0=CreateUnit(BO[0],'emow',VQ,WQ,270)
set O00=CreateUnit(BO[0],'emow',XQ,YQ,270)
set OI0=CreateUnit(BO[0],'eaow',JQ,KQ,270)
set O10=CreateUnit(BO[0],'eaow',LQ,MQ,270)
set OO0=CreateUnit(BO[0],'edob',NQ,SQ,270)
set O20=CreateUnit(BO[0],'edob',TQ,RQ,270)
call SetPlayerAbilityAvailable(EO,'Aro1',false)
call SetUnitColor(QQ,TS)
call SetUnitColor(II0,TS)
call SetUnitColor(I00,PS)
call SetUnitColor(UQ,PS)
call SetUnitColor(I10,PS)
call SetUnitColor(IO0,PS)
call SetUnitColor(I20,PS)
call SetUnitColor(I30,PS)
call SetUnitColor(I40,PS)
call BK1(I70,true)
call BK1(I80,true)
call BK1(I90,true)
call BK1(IA0,true)
call BK1(IB0,true)
call BK1(IC0,true)
call BK1(ID0,true)
call BK1(IE0,true)
call BK1(IF0,true)
call BK1(IG0,true)
call BK1(IH0,true)
call BK1(I60,true)
call BK1(IZ0,true)
call BK1(IV0,true)
call BK1(IW0,true)
call BK1(IX0,true)
call BK1(IY0,true)
call BK1(IJ0,true)
call BK1(OI0,true)
call BK1(O10,true)
call BK1(OO0,true)
call BK1(O20,true)
call BK1(IK0,true)
call BK1(IL0,true)
call BK1(IM0,true)
call BK1(IN0,true)
call BK1(IS0,true)
call BK1(IT0,true)
call BK1(IR0,true)
call BK1(IP0,true)
call BK1(IQ0,true)
call BK1(IU0,true)
call BK1(O00,true)
call AddUnitToStock(II0,'h02C',0,0)
endfunction
function InitTrig_Sent_Buildings takes nothing returns nothing
call HB1()
endfunction
function HC1 takes nothing returns nothing
set O50=GetUnitX(GX)
set O60=GetUnitY(GX)
set O70=GetUnitX(UW)
set O80=GetUnitY(UW)
set O90=GetUnitX(IX)
set OA0=GetUnitY(IX)
set OB0=GetUnitX(OX)
set OC0=GetUnitY(OX)
set OD0=GetUnitX(PW)
set OE0=GetUnitY(PW)
set OF0=GetUnitX(TW)
set OG0=GetUnitY(TW)
set OH0=GetUnitX(SW)
set OZ0=GetUnitY(SW)
set OV0=GetUnitX(MW)
set OW0=GetUnitY(MW)
set OX0=GetUnitX(RW)
set OY0=GetUnitY(RW)
set OJ0=GetUnitX(QW)
set OK0=GetUnitY(QW)
set OL0=GetUnitX(JZ)
set OM0=GetUnitY(JZ)
set ON0=GetUnitX(KX)
set OS0=GetUnitY(KX)
set OT0=GetUnitX(GZ)
set OR0=GetUnitY(GZ)
set OP0=GetUnitX(MX)
set OQ0=GetUnitY(MX)
set OU0=GetUnitX(YZ)
set A00=GetUnitY(YZ)
set AI0=GetUnitX(SZ)
set A10=GetUnitY(SZ)
set AO0=GetUnitX(NX)
set A20=GetUnitY(NX)
set A30=GetUnitX(XZ)
set A40=GetUnitY(XZ)
set A50=GetUnitX(LW)
set A60=GetUnitY(LW)
set A70=GetUnitX(SX)
set A80=GetUnitY(SX)
set A90=GetUnitX(FY)
set AA0=GetUnitY(FY)
set AB0=GetUnitX(TX)
set AC0=GetUnitY(TX)
set AD0=GetUnitX(XX)
set AE0=GetUnitY(XX)
set AF0=GetUnitX(KW)
set AG0=GetUnitY(KW)
set AH0=GetUnitX(WX)
set AZ0=GetUnitY(WX)
set AV0=GetUnitX(EY)
set AW0=GetUnitY(EY)
set AX0=GetUnitX(JW)
set AY0=GetUnitY(JW)
set AJ0=GetUnitX(LX)
set AK0=GetUnitY(LX)
set AL0=GetUnitX(DY)
set AM0=GetUnitY(DY)
set AN0=GetUnitX(IY)
set AS0=GetUnitY(IY)
set AT0=GetUnitX(PX)
set AR0=GetUnitY(PX)
set AP0=GetUnitX(BY)
set AQ0=GetUnitY(BY)
set AU0=GetUnitX(YW)
set B00=GetUnitY(YW)
set BI0=GetUnitX(AY)
set B10=GetUnitY(AY)
set BO0=GetUnitX(RX)
set B20=GetUnitY(RX)
set B30=GetUnitX(QX)
set B40=GetUnitY(QX)
set B50=GetUnitX(OY)
set B60=GetUnitY(OY)
set B70=GetUnitX(GY)
set B80=GetUnitY(GY)
set B90=GetUnitX(WW)
set BA0=GetUnitY(WW)
set BB0=GetUnitX(YX)
set BC0=GetUnitY(YX)
set BD0=GetUnitX(XW)
set BE0=GetUnitY(XW)
set BF0=GetUnitX(CY)
set BG0=GetUnitY(CY)
set BH0=GetUnitX(UX)
set BZ0=GetUnitY(UX)
set BV0=GetUnitX(JX)
set BW0=GetUnitY(JX)
call RemoveUnit(IY)
call RemoveUnit(PX)
call RemoveUnit(BY)
call RemoveUnit(YW)
call RemoveUnit(AY)
call RemoveUnit(RX)
call RemoveUnit(QX)
call RemoveUnit(OY)
call RemoveUnit(GY)
call RemoveUnit(WW)
call RemoveUnit(YX)
call RemoveUnit(GZ)
call RemoveUnit(SZ)
call RemoveUnit(LW)
call RemoveUnit(MX)
call RemoveUnit(NX)
call RemoveUnit(SX)
call RemoveUnit(YZ)
call RemoveUnit(XZ)
call RemoveUnit(FY)
call RemoveUnit(TX)
call RemoveUnit(XX)
call RemoveUnit(KW)
call RemoveUnit(WX)
call RemoveUnit(EY)
call RemoveUnit(JW)
call RemoveUnit(LX)
call RemoveUnit(DY)
call RemoveUnit(XW)
call RemoveUnit(CY)
call RemoveUnit(UX)
call RemoveUnit(JX)
call RemoveUnit(KX)
call RemoveUnit(TW)
call RemoveUnit(SW)
call RemoveUnit(MW)
call RemoveUnit(RW)
call RemoveUnit(QW)
call RemoveUnit(JZ)
call RemoveUnit(OX)
call RemoveUnit(IX)
call RemoveUnit(GX)
call RemoveUnit(UW)
call RemoveUnit(PW)
set BX0=CreateUnit(CO[0],'ndfl',O50,O60,270)
set BY0=CreateUnit(EO,'nC35',O70,O80,270)
set BJ0=CreateUnit(EO,'n01K',O90,OA0,270)
set BK0=CreateUnit(EO,'nC38',OB0,OC0,270)
set BL0=CreateUnit(EO,'u00Q',OD0,OE0,270)
set BM0=CreateUnit(EO,'n00V',OF0,OG0,0)
set BN0=CreateUnit(EO,'n00W',OH0,OZ0,0)
set BS0=CreateUnit(EO,'n002',OV0,OW0,0)
set BT0=CreateUnit(EO,'n00X',OX0,OY0,0)
set BR0=CreateUnit(EO,'n009',OJ0,OK0,0)
set BP0=CreateUnit(EO,'n0HE',OL0,OM0,0)
set BQ0=CreateUnit(CO[0],'unpl',ON0,OS0,220)
set BU0=CreateUnit(CO[0],'u00M',OT0,OR0,270)
set C00=CreateUnit(CO[0],'u00M',OP0,OQ0,270)
set CI0=CreateUnit(CO[0],'u00M',OU0,A00,270)
set C10=CreateUnit(CO[0],'u00D',AI0,A10,270)
set CO0=CreateUnit(CO[0],'u00D',AO0,A20,270)
set C20=CreateUnit(CO[0],'u00D',A30,A40,270)
set C30=CreateUnit(CO[0],'u00N',A50,A60,270)
set C40=CreateUnit(CO[0],'u00N',A70,A80,270)
set C50=CreateUnit(CO[0],'u00N',A90,AA0,270)
set C60=CreateUnit(CO[0],'u00T',AB0,AC0,270)
set C70=CreateUnit(CO[0],'u00T',AD0,AE0,270)
set C80=CreateUnit(CO[0],'usep',AF0,AG0,270)
set C90=CreateUnit(CO[0],'usep',AH0,AZ0,270)
set CA0=CreateUnit(CO[0],'usep',AV0,AW0,270)
set CB0=CreateUnit(CO[0],'utod',AX0,AY0,270)
set CC0=CreateUnit(CO[0],'utod',AJ0,AK0,270)
set CD0=CreateUnit(CO[0],'utod',AL0,AM0,270)
set CE0=CreateUnit(CO[0],'uzig',AN0,AS0,270)
set CF0=CreateUnit(CO[0],'uzig',AT0,AR0,270)
set CG0=CreateUnit(CO[0],'uzig',AP0,AQ0,270)
set CH0=CreateUnit(CO[0],'uzig',AU0,B00,270)
set CZ0=CreateUnit(CO[0],'uzig',BI0,B10,270)
set CV0=CreateUnit(CO[0],'uzig',BO0,B20,270)
set CW0=CreateUnit(CO[0],'uzig',B30,B40,270)
set CX0=CreateUnit(CO[0],'uzig',B50,B60,270)
set CY0=CreateUnit(CO[0],'uzig',B70,B80,270)
set CJ0=CreateUnit(CO[0],'uzig',B90,BA0,270)
set CK0=CreateUnit(CO[0],'uzig',BB0,BC0,270)
set CL0=CreateUnit(CO[0],'usap',BD0,BE0,270)
set CM0=CreateUnit(CO[0],'usap',BF0,BG0,270)
set CN0=CreateUnit(CO[0],'ubon',BH0,BZ0,270)
set CS0=CreateUnit(CO[0],'ubon',BV0,BW0,270)
call SetUnitColor(BY0,O30)
call SetUnitColor(BK0,O40)
call SetUnitColor(BJ0,O40)
call SetUnitColor(BM0,O40)
call SetUnitColor(BN0,O40)
call SetUnitColor(BS0,O40)
call SetUnitColor(BT0,O40)
call SetUnitColor(BR0,O40)
call BK1(BU0,true)
call BK1(C00,true)
call BK1(CI0,true)
call BK1(C10,true)
call BK1(CO0,true)
call BK1(C20,true)
call BK1(C30,true)
call BK1(C40,true)
call BK1(C50,true)
call BK1(C60,true)
call BK1(C70,true)
call BK1(BQ0,true)
call BK1(C80,true)
call BK1(C90,true)
call BK1(CA0,true)
call BK1(CB0,true)
call BK1(CC0,true)
call BK1(CD0,true)
call BK1(CL0,true)
call BK1(CM0,true)
call BK1(CN0,true)
call BK1(CS0,true)
call BK1(CE0,true)
call BK1(CF0,true)
call BK1(CG0,true)
call BK1(CH0,true)
call BK1(CZ0,true)
call BK1(CV0,true)
call BK1(CW0,true)
call BK1(CX0,true)
call BK1(CY0,true)
call BK1(CJ0,true)
call BK1(CK0,true)
call AddUnitToStock(BL0,'h02C',0,0)
endfunction
function InitTrig_Scourge_Buildings takes nothing returns nothing
call HC1()
endfunction
function HD1 takes nothing returns nothing
local real HE1=GetUnitX(TZ)
local real HF1=GetUnitY(TZ)
local real HG1=GetUnitX(UZ)
local real HH1=GetUnitY(UZ)
local real HZ1=GetUnitX(QZ)
local real HV1=GetUnitY(QZ)
local real HW1=GetUnitX(RZ)
local real HX1=GetUnitY(RZ)
local real HY1=GetUnitX(PZ)
local real HJ1=GetUnitY(PZ)
local real HK1=GetUnitX(BX)
local real HL1=GetUnitY(BX)
local real HM1=GetUnitX(AX)
local real HN1=GetUnitY(AX)
local real HS1=GetUnitX(EX)
local real HT1=GetUnitY(EX)
local real HR1=GetUnitX(CX)
local real HP1=GetUnitY(CX)
local real HQ1=GetUnitX(DX)
local real HU1=GetUnitY(DX)
local integer Z01=25
call RemoveUnit(TZ)
call RemoveUnit(UZ)
call RemoveUnit(QZ)
call RemoveUnit(RZ)
call RemoveUnit(PZ)
call RemoveUnit(BX)
call RemoveUnit(AX)
call RemoveUnit(EX)
call RemoveUnit(CX)
call RemoveUnit(DX)
set CT0=CreateUnit(Player(1),'ncop',HE1,HF1,270)
call UnitAddAbility(CT0,'A141')
call ClearSelectionForPlayer(Player(1))
call SelectUnitAddForPlayer(CT0,Player(1))
if GetLocalPlayer()==Player(1)then
call SetUnitVertexColor(CT0,255,255,255,255)
else
call SetUnitVertexColor(CT0,255,255,255,Z01)
endif
set CR0=CreateUnit(Player(2),'ncop',HG1,HH1,270)
call UnitAddAbility(CR0,'A141')
call ClearSelectionForPlayer(Player(2))
call SelectUnitAddForPlayer(CR0,Player(2))
if GetLocalPlayer()==Player(2)then
call SetUnitVertexColor(CR0,255,255,255,255)
else
call SetUnitVertexColor(CR0,255,255,255,Z01)
endif
set CP0=CreateUnit(Player(3),'ncop',HZ1,HV1,270)
call UnitAddAbility(CP0,'A141')
call ClearSelectionForPlayer(Player(3))
call SelectUnitAddForPlayer(CP0,Player(3))
if GetLocalPlayer()==Player(3)then
call SetUnitVertexColor(CP0,255,255,255,255)
else
call SetUnitVertexColor(CP0,255,255,255,Z01)
endif
set CQ0=CreateUnit(Player(4),'ncop',HW1,HX1,270)
call UnitAddAbility(CQ0,'A141')
call ClearSelectionForPlayer(Player(4))
call SelectUnitAddForPlayer(CQ0,Player(4))
if GetLocalPlayer()==Player(4)then
call SetUnitVertexColor(CQ0,255,255,255,255)
else
call SetUnitVertexColor(CQ0,255,255,255,Z01)
endif
set CU0=CreateUnit(Player(5),'ncop',HY1,HJ1,270)
call UnitAddAbility(CU0,'A141')
call ClearSelectionForPlayer(Player(5))
call SelectUnitAddForPlayer(CU0,Player(5))
if GetLocalPlayer()==Player(5)then
call SetUnitVertexColor(CU0,255,255,255,255)
else
call SetUnitVertexColor(CU0,255,255,255,Z01)
endif
set D00=CreateUnit(Player(7),'ncop',HK1,HL1,270)
call UnitAddAbility(D00,'A1WI')
call ClearSelectionForPlayer(Player(7))
call SelectUnitAddForPlayer(D00,Player(7))
if GetLocalPlayer()==Player(7)then
call SetUnitVertexColor(D00,255,255,255,255)
else
call SetUnitVertexColor(D00,255,255,255,Z01)
endif
set DI0=CreateUnit(Player(8),'ncop',HM1,HN1,270)
call UnitAddAbility(DI0,'A1WI')
call ClearSelectionForPlayer(Player(8))
call SelectUnitAddForPlayer(DI0,Player(8))
if GetLocalPlayer()==Player(8)then
call SetUnitVertexColor(DI0,255,255,255,255)
else
call SetUnitVertexColor(DI0,255,255,255,Z01)
endif
set D10=CreateUnit(Player(9),'ncop',HS1,HT1,270)
call UnitAddAbility(D10,'A1WI')
call ClearSelectionForPlayer(Player(9))
call SelectUnitAddForPlayer(D10,Player(9))
if GetLocalPlayer()==Player(9)then
call SetUnitVertexColor(D10,255,255,255,255)
else
call SetUnitVertexColor(D10,255,255,255,Z01)
endif
set DO0=CreateUnit(Player(10),'ncop',HR1,HP1,270)
call UnitAddAbility(DO0,'A1WI')
call ClearSelectionForPlayer(Player(10))
call SelectUnitAddForPlayer(DO0,Player(10))
if GetLocalPlayer()==Player(10)then
call SetUnitVertexColor(DO0,255,255,255,255)
else
call SetUnitVertexColor(DO0,255,255,255,Z01)
endif
set D20=CreateUnit(Player(11),'ncop',HQ1,HU1,270)
call UnitAddAbility(D20,'A1WI')
call ClearSelectionForPlayer(Player(11))
call SelectUnitAddForPlayer(D20,Player(11))
if GetLocalPlayer()==Player(11)then
call SetUnitVertexColor(D20,255,255,255,255)
else
call SetUnitVertexColor(D20,255,255,255,Z01)
endif
set D30[1]=CT0
set D30[2]=CR0
set D30[3]=CP0
set D30[4]=CQ0
set D30[5]=CU0
set D30[7]=D00
set D30[8]=DI0
set D30[9]=D10
set D30[10]=DO0
set D30[11]=D20
set D40[1]=GetUnitX(CT0)
set D40[2]=GetUnitX(CR0)
set D40[3]=GetUnitX(CP0)
set D40[4]=GetUnitX(CQ0)
set D40[5]=GetUnitX(CU0)
set D40[7]=GetUnitX(D00)
set D40[8]=GetUnitX(DI0)
set D40[9]=GetUnitX(D10)
set D40[10]=GetUnitX(DO0)
set D40[11]=GetUnitX(D20)
set D50[1]=GetUnitY(CT0)
set D50[2]=GetUnitY(CR0)
set D50[3]=GetUnitY(CP0)
set D50[4]=GetUnitY(CQ0)
set D50[5]=GetUnitY(CU0)
set D50[7]=GetUnitY(D00)
set D50[8]=GetUnitY(DI0)
set D50[9]=GetUnitY(D10)
set D50[10]=GetUnitY(DO0)
set D50[11]=GetUnitY(D20)
endfunction
function InitTrig_Circle_of_Power takes nothing returns nothing
call HD1()
endfunction
function ZI1 takes nothing returns nothing
set D90[GetPlayerId(BO[1])]=0
set DA0[GetPlayerId(BO[1])]=66
set DB0[GetPlayerId(BO[1])]=255
set D90[GetPlayerId(BO[2])]=48
set DA0[GetPlayerId(BO[2])]=230
set DB0[GetPlayerId(BO[2])]=185
set D90[GetPlayerId(BO[3])]=50
set DA0[GetPlayerId(BO[3])]=0
set DB0[GetPlayerId(BO[3])]=129
set D90[GetPlayerId(BO[4])]=255
set DA0[GetPlayerId(BO[4])]=252
set DB0[GetPlayerId(BO[4])]=1
set D90[GetPlayerId(BO[5])]=255
set DA0[GetPlayerId(BO[5])]=50
set DB0[GetPlayerId(BO[5])]=0
set D90[GetPlayerId(CO[1])]=220
set DA0[GetPlayerId(CO[1])]=50
set DB0[GetPlayerId(CO[1])]=50
set D90[GetPlayerId(CO[2])]=50
set DA0[GetPlayerId(CO[2])]=50
set DB0[GetPlayerId(CO[2])]=50
set D90[GetPlayerId(CO[3])]=75
set DA0[GetPlayerId(CO[3])]=150
set DB0[GetPlayerId(CO[3])]=190
set D90[GetPlayerId(CO[4])]=16
set DA0[GetPlayerId(CO[4])]=60
set DB0[GetPlayerId(CO[4])]=18
set D90[GetPlayerId(CO[5])]=68
set DA0[GetPlayerId(CO[5])]=42
set DB0[GetPlayerId(CO[5])]=4
endfunction
function Z11 takes nothing returns nothing
local integer TGI
local integer THI
local integer i
set C0[GetPlayerId(BO[0])]="|c00ff0303"
set C0[GetPlayerId(BO[1])]="|c000042ff"
set C0[GetPlayerId(BO[2])]="|c001ce6b9"
set C0[GetPlayerId(BO[3])]="|c00540081"
set C0[GetPlayerId(BO[4])]="|c00fffc01"
set C0[GetPlayerId(BO[5])]="|c00ff8000"
set C0[GetPlayerId(CO[0])]="|c0020c000"
set C0[GetPlayerId(CO[1])]="|c00e55bb0"
set C0[GetPlayerId(CO[2])]="|c00959697"
set C0[GetPlayerId(CO[3])]="|c007ebff1"
set C0[GetPlayerId(CO[4])]="|c00106246"
set C0[GetPlayerId(CO[5])]="|c004e2a04"
call SetPlayerColor(BO[0],PLAYER_COLOR_RED)
call SetPlayerColor(BO[1],PLAYER_COLOR_BLUE)
call SetPlayerColor(BO[2],PLAYER_COLOR_CYAN)
call SetPlayerColor(BO[3],PLAYER_COLOR_PURPLE)
call SetPlayerColor(BO[4],PLAYER_COLOR_YELLOW)
call SetPlayerColor(BO[5],PLAYER_COLOR_ORANGE)
call SetPlayerColor(CO[0],PLAYER_COLOR_GREEN)
call SetPlayerColor(CO[1],PLAYER_COLOR_PINK)
call SetPlayerColor(CO[2],PLAYER_COLOR_LIGHT_GRAY)
call SetPlayerColor(CO[3],PLAYER_COLOR_LIGHT_BLUE)
call SetPlayerColor(CO[4],PLAYER_COLOR_AQUA)
call SetPlayerColor(CO[5],PLAYER_COLOR_BROWN)
set TGI=1
set THI=5
loop
if GetPlayerSlotState(BO[TGI])==PLAYER_SLOT_STATE_EMPTY then
call SetPlayerName(BO[TGI],"玩家"+" "+I2S(TGI))
endif
if GetPlayerSlotState(CO[TGI])==PLAYER_SLOT_STATE_EMPTY then
call SetPlayerName(CO[TGI],"玩家"+" "+I2S(5+TGI))
endif
set TGI=TGI+1
exitwhen TGI>THI
endloop
endfunction
function ZO1 takes nothing returns nothing
local integer i
local integer Z01=125
call SetUnitOwner(CT0,BO[1],false)
call SetUnitOwner(CR0,BO[2],false)
call SetUnitOwner(CP0,BO[3],false)
call SetUnitOwner(CQ0,BO[4],false)
call SetUnitOwner(CU0,BO[5],false)
call SetUnitOwner(D00,CO[1],false)
call SetUnitOwner(DI0,CO[2],false)
call SetUnitOwner(D10,CO[3],false)
call SetUnitOwner(DO0,CO[4],false)
call SetUnitOwner(D20,CO[5],false)
set D30[GetPlayerId(BO[1])]=CT0
set D30[GetPlayerId(BO[2])]=CR0
set D30[GetPlayerId(BO[3])]=CP0
set D30[GetPlayerId(BO[4])]=CQ0
set D30[GetPlayerId(BO[5])]=CU0
set D30[GetPlayerId(CO[1])]=D00
set D30[GetPlayerId(CO[2])]=DI0
set D30[GetPlayerId(CO[3])]=D10
set D30[GetPlayerId(CO[4])]=DO0
set D30[GetPlayerId(CO[5])]=D20
set i=1
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=2
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=3
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=4
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=5
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=7
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=8
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=9
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=10
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set i=11
if GetLocalPlayer()==Player(i)then
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,255)
else
call SetUnitVertexColor(D30[GetPlayerId(Player(i))],255,255,255,Z01)
endif
set D40[GetPlayerId(BO[1])]=GetUnitX(D30[GetPlayerId(BO[1])])
set D40[GetPlayerId(BO[2])]=GetUnitX(D30[GetPlayerId(BO[2])])
set D40[GetPlayerId(BO[3])]=GetUnitX(D30[GetPlayerId(BO[3])])
set D40[GetPlayerId(BO[4])]=GetUnitX(D30[GetPlayerId(BO[4])])
set D40[GetPlayerId(BO[5])]=GetUnitX(D30[GetPlayerId(BO[5])])
set D40[GetPlayerId(CO[1])]=GetUnitX(D30[GetPlayerId(CO[1])])
set D40[GetPlayerId(CO[2])]=GetUnitX(D30[GetPlayerId(CO[2])])
set D40[GetPlayerId(CO[3])]=GetUnitX(D30[GetPlayerId(CO[3])])
set D40[GetPlayerId(CO[4])]=GetUnitX(D30[GetPlayerId(CO[4])])
set D40[GetPlayerId(CO[5])]=GetUnitX(D30[GetPlayerId(CO[5])])
set D50[GetPlayerId(BO[1])]=GetUnitY(D30[GetPlayerId(BO[1])])
set D50[GetPlayerId(BO[2])]=GetUnitY(D30[GetPlayerId(BO[2])])
set D50[GetPlayerId(BO[3])]=GetUnitY(D30[GetPlayerId(BO[3])])
set D50[GetPlayerId(BO[4])]=GetUnitY(D30[GetPlayerId(BO[4])])
set D50[GetPlayerId(BO[5])]=GetUnitY(D30[GetPlayerId(BO[5])])
set D50[GetPlayerId(CO[1])]=GetUnitY(D30[GetPlayerId(CO[1])])
set D50[GetPlayerId(CO[2])]=GetUnitY(D30[GetPlayerId(CO[2])])
set D50[GetPlayerId(CO[3])]=GetUnitY(D30[GetPlayerId(CO[3])])
set D50[GetPlayerId(CO[4])]=GetUnitY(D30[GetPlayerId(CO[4])])
set D50[GetPlayerId(CO[5])]=GetUnitY(D30[GetPlayerId(CO[5])])
endfunction
function Z21 takes unit PKI returns boolean
local integer ID=GetUnitTypeId(PKI)
if ID=='n00V' or ID=='n00W' or ID=='n002' or ID=='n00X' or ID=='nC38' or ID=='n01K' or ID=='n009' then
return true
endif
return false
endfunction
function Z31 takes nothing returns nothing
if(GetOwningPlayer(GetEnumUnit())==Player(0))then
call SetUnitOwner(GetEnumUnit(),BO[0],false)
if Z21(GetEnumUnit())==false then
call SetUnitColor(GetEnumUnit(),ConvertPlayerColor(0))
endif
else
call SetUnitOwner(GetEnumUnit(),CO[0],false)
if Z21(GetEnumUnit())==false then
call SetUnitColor(GetEnumUnit(),ConvertPlayerColor(6))
endif
endif
endfunction
function Z41 takes nothing returns nothing
local group Z51=NTI()
call GroupEnumUnitsOfPlayer(Z51,Player(0),Condition(function N1I))
call ForGroup(Z51,function Z31)
call GroupClear(Z51)
call GroupEnumUnitsOfPlayer(Z51,Player(6),Condition(function N1I))
call ForGroup(Z51,function Z31)
call NSI(Z51)
endfunction
function Z61 takes player p returns nothing
local integer i=0
local string Z71=GetPlayerName(p)
local integer FQ1=StringLength(Z71)
local integer Z81=FQ1
loop
exitwhen i==FQ1
if SubString(Z71,i,i+1)=="("and SubString(Z71,i-1,i)==" "then
set Z81=i-1
call SetPlayerName(p,SubString(Z71,0,Z81))
set i=FQ1
else
set i=i+1
endif
endloop
endfunction
function Z91 takes nothing returns nothing
local integer ZA1
local integer ZB1
local integer TGI
local integer THI
local integer x=0
local integer y=0
local integer i
local trigger t
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
if GetPlayerState(BO[0],PLAYER_STATE_OBSERVER)!=0 or GetPlayerState(CO[0],PLAYER_STATE_OBSERVER)!=0 then
set C2=true
set BO[0]=Player(13)
set CO[0]=Player(14)
set D60=Player(0)
set D70=Player(6)
call SetAllyColorFilterState(0)
loop
exitwhen x>5
call SetPlayerAlliance(Player(0),BO[x],ConvertAllianceType(0),true)
call SetPlayerAlliance(Player(0),BO[x],ConvertAllianceType(4),true)
call SetPlayerAlliance(Player(0),CO[x],ConvertAllianceType(0),false)
call SetPlayerAlliance(Player(0),CO[x],ConvertAllianceType(4),false)
set x=x+1
endloop
endif
call ForceAddPlayer(OO,BO[0])
call ForceAddPlayer(OO,BO[1])
call ForceAddPlayer(OO,BO[2])
call ForceAddPlayer(OO,BO[3])
call ForceAddPlayer(OO,BO[4])
call ForceAddPlayer(OO,BO[5])
call ForceAddPlayer(AO,CO[0])
call ForceAddPlayer(AO,CO[1])
call ForceAddPlayer(AO,CO[2])
call ForceAddPlayer(AO,CO[3])
call ForceAddPlayer(AO,CO[4])
call ForceAddPlayer(AO,CO[5])
call ForceAddPlayer(P2,BO[1])
call ForceAddPlayer(P2,BO[2])
call ForceAddPlayer(P2,BO[3])
call ForceAddPlayer(P2,BO[4])
call ForceAddPlayer(P2,BO[5])
call ForceAddPlayer(P2,CO[1])
call ForceAddPlayer(P2,CO[2])
call ForceAddPlayer(P2,CO[3])
call ForceAddPlayer(P2,CO[4])
call ForceAddPlayer(P2,CO[5])
if C2 then
call ForceAddPlayer(P2,Player(0))
call ForceAddPlayer(P2,Player(6))
endif
set x=0
set y=0
loop
exitwhen x>5
loop
exitwhen y>5
if(x!=y)then
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(0),true)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(1),true)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(2),true)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(3),true)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(4),true)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(5),true)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(6),false)
call SetPlayerAlliance(BO[x],BO[y],ConvertAllianceType(7),false)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(0),true)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(1),true)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(2),true)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(3),true)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(4),true)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(5),true)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(6),false)
call SetPlayerAlliance(CO[x],CO[y],ConvertAllianceType(7),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(0),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(1),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(2),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(3),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(4),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(5),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(6),false)
call SetPlayerAlliance(BO[x],CO[y],ConvertAllianceType(7),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(0),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(1),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(2),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(3),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(4),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(5),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(6),false)
call SetPlayerAlliance(CO[x],BO[y],ConvertAllianceType(7),false)
endif
set y=y+1
endloop
set y=0
set x=x+1
endloop
call SetPlayerTeam(BO[0],0)
call SetPlayerTeam(BO[1],0)
call SetPlayerTeam(BO[2],0)
call SetPlayerTeam(BO[3],0)
call SetPlayerTeam(BO[4],0)
call SetPlayerTeam(BO[5],0)
call SetPlayerTeam(CO[0],1)
call SetPlayerTeam(CO[1],1)
call SetPlayerTeam(CO[2],1)
call SetPlayerTeam(CO[3],1)
call SetPlayerTeam(CO[4],1)
call SetPlayerTeam(CO[5],1)
call SetPlayerName(BO[0],"近卫军团")
call SetPlayerName(CO[0],"天灾军团")
call SetPlayerName(DO,"中立生物")
call ZO1()
if(BO[0]!=Player(0)or CO[0]!=Player(6))then
call Z41()
endif
call Z11()
set ZB1=TAI(OO)
set ZA1=TAI(AO)
set TGI=1
set THI=5
loop
exitwhen TGI>THI
if(T3I(BO[TGI]))then
call SetPlayerState(BO[TGI],PLAYER_STATE_RESOURCE_GOLD,(4375/ZB1))
call SetPlayerState(BO[TGI],PLAYER_STATE_RESOURCE_LUMBER,0)
endif
if(T3I(CO[TGI]))then
call SetPlayerState(CO[TGI],PLAYER_STATE_RESOURCE_GOLD,(4375/ZA1))
call SetPlayerState(CO[TGI],PLAYER_STATE_RESOURCE_LUMBER,0)
endif
set TGI=TGI+1
endloop
call SetPlayerHandicapXP(BO[1],1)
call SetPlayerHandicapXP(BO[2],1)
call SetPlayerHandicapXP(BO[3],1)
call SetPlayerHandicapXP(BO[4],1)
call SetPlayerHandicapXP(BO[5],1)
call SetPlayerHandicapXP(CO[1],1)
call SetPlayerHandicapXP(CO[2],1)
call SetPlayerHandicapXP(CO[3],1)
call SetPlayerHandicapXP(CO[4],1)
call SetPlayerHandicapXP(CO[5],1)
call SetPlayerState(BO[0],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(BO[1],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(BO[2],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(BO[3],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(BO[4],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(BO[5],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(CO[0],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(CO[1],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(CO[2],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(CO[3],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(CO[4],PLAYER_STATE_GIVES_BOUNTY,1)
call SetPlayerState(CO[5],PLAYER_STATE_GIVES_BOUNTY,1)
call RTI()
call ZI1()
call Z61(BO[1])
call Z61(BO[2])
call Z61(BO[3])
call Z61(BO[4])
call Z61(BO[5])
call Z61(CO[1])
call Z61(CO[2])
call Z61(CO[3])
call Z61(CO[4])
call Z61(CO[5])
set x=1
loop
exitwhen x>5
if T3I(BO[x])then
call CreateUnitAtLoc(BO[x],'n00C',ZC1,bj_UNIT_FACING)
endif
if T3I(CO[x])then
call CreateUnitAtLoc(CO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
set x=x+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set i=0
loop
set D80[i]=GetPlayerName(Player(i))
set i=i+1
exitwhen i==16
endloop
set ZC1=null
set ZD1=null
endfunction
function InitTrig_Player takes nothing returns nothing
call Z91()
endfunction
function ZE1 takes nothing returns nothing
local integer i=1
set DE0=1
set DC0[1]='Hvwd'
set DT0[1]='h03Z'
set DD0[1]='n09U'
set DS0[1]="ReplaceableTextures\\CommandButtons\\BTNAvengingWatcher.blp"
call SNI(DC0[1],"stand 4")
call SYI(DC0[1],1.35,DT0[1])
set DR0[i]="Cheap items such as Bracers, Bottle and Magic Stick help give Vengeful Spirit what she needs to use Magic Missile and Swap safely and frequently."
set DP0[i]="By getting Magic Missile first, Vengeful Spirit should take advantage of this powerful stun by moving around the map instead of simply farming in a lane."
set DQ0[i]="It sometimes a good idea to save the Command Aura for later in the game when it will give your team more damage."
set DU0[i]="Wave of Terror is used to provide sight, giving you vision over an area or providing an opportunity to use Swap."
set E00[i]="Swap will allow you to isolate a key hero on their team, sometimes your sacrifice is needed to win the battle and maybe even the game."
set i=i+1
set DC0[2]='Hmbr'
set DT0[2]='h040'
set DD0[2]='n09A'
set DS0[2]="ReplaceableTextures\\CommandButtons\\BTNAvatar.blp"
call SNI(DC0[2],"attack slam alternate")
call SYI(DC0[2],1.3,DT0[2])
set DR0[i]="When using Arc lightning, try to kill creeps and harass your opponent at the same time"
set DP0[i]="When ganking, you can use Lightning Bolt to ensure you will not lose sight of the target quickly."
set DQ0[i]="Lightning Bolt has a mini-stun that can be used against channeling spells and teleporting heroes."
set DU0[i]="Static Field is extremely powerful throughout the game: Use your spells as frequently as possible during fights."
set E00[i]="Both Lightning Bolt and Wrath of the Thundergod reveal invisible units. Wrath will not damage invisible units."
set i=i+1
set DC0[3]='Emoo'
set DT0[3]='h041'
set DD0[3]='n099'
set DS0[3]="ReplaceableTextures\\CommandButtons\\BTNDryad.blp"
call SNI(DC0[3],"stand 4")
call SYI(DC0[3],1,DT0[3])
set DR0[i]="Enchant can be used on neutral creeps, meaning Enchantress can fight and use neutral creeps to engage enemy heroes effectively."
set DP0[i]="Nature's Attendants heals in an area AOE, so make sure you're far from creeps if you only want to heal yourself."
set DQ0[i]="Untouchable is great against physical attacks, but it does not help you survive huge burst damage nukes."
set DU0[i]="Impetus deals negligible damage at short range; switch to normal attacks if your target gets close to save mana."
set E00[i]="Impetus deals pure damage, making it a great tool against heroes with a lot of resistance because it is not reduced."
set i=i+1
set DC0[4]='O00P'
set DT0[4]='h042'
set DD0[4]='n098'
set DS0[4]="ReplaceableTextures\\CommandButtons\\BTNSeaElemental.blp"
call SNI(DC0[4],"stand 2")
call SYI(DC0[4],1,DT0[4])
set DR0[i]="Waveform is extremely powerful: Used for damage, chasing, escaping, it even allows you to dodge some spells by casting it at the right time."
set DP0[i]="Morph allows you to manipulate your Agility and Strength. Using the Strength Morph ('F') can act as a heal to help you survive between spells."
set DQ0[i]="Use Morph Replicate to take the location of your Replicated unit, making it great for a quick escape or simply as a free teleport."
set DU0[i]="Replicate is usually cast on the strongest ally or enemy to a fight. Certain hero passives or items will retain their effects, so Replicate those heroes."
set E00[i]="Eye of Skadi and Linken's Sphere are two examples of Statistic-increasing items which give Morphling a lot of versatility and the ability to cast spells often."
set i=i+1
set DC0[5]='Hjai'
set DT0[5]='h043'
set DD0[5]='n09W'
set DS0[5]="ReplaceableTextures\\CommandButtons\\BTNJaina.blp"
call SNI(DC0[5],"stand victory")
call SYI(DC0[5],1,DT0[5])
set DR0[i]="CM is a fragile support hero: Items like Bracers and Phase Boots will help her survive and deal with her low movement speed and armor."
set DP0[i]="A few points of Brilliance Aura early on provides your team with massive amounts of extra mana."
set DQ0[i]="Enemies hit by Frostbite can still cast spells, so don't take them lightly. "
set DU0[i]="Frostbite on non-hero units will last 10 seconds. This can be useful for killing neutral creeps that are level 5 or lower as well."
set E00[i]="There are two items that can help you with the perfect Freezing Field: Placement with Kelen's Dagger and the spell immunity of Black King Bar."
set i=i+1
set DC0[6]='H001'
set DT0[6]='h044'
set DD0[6]='n096'
set DS0[6]="ReplaceableTextures\\CommandButtons\\BTNFelGuardBlue.tga"
call SNI(DC0[6],"spell")
call SYI(DC0[6],1,DT0[6])
set DR0[i]="Storm Bolt is a skill Sven should usually get early because of its damage and stun. "
set DP0[i]="Take advantage of Storm Bolt's area of effect by hitting additional enemy creeps and heroes whenever possible. "
set DQ0[i]="Try to be near your allies when you cast Warcry."
set DU0[i]="Only items that increase Strength will give you additional damage from effect of God's Strength."
set E00[i]="Casting God's Strength before engaging in fights or casting Storm Bolt will allow you to get additional attacks on your opponent."
set i=i+1
set DC0[7]='HC49'
set DT0[7]='h045'
set DD0[7]='n09P'
set DS0[7]="ReplaceableTextures\\CommandButtons\\BTNSeaWitch.blp"
call SNI(DC0[7],"spell")
call SYI(DC0[7],1,DT0[7])
set DR0[i]="Opponents can attack and cast spells while Ensnared. However, it will work on magic immune units and reveal invisible heroes until the duration expires."
set DP0[i]="Mirror Image can be used defensively to avoid certain spells and dispel debuffs or channeling spells."
set DQ0[i]="Items that provide attribute bonuses improve your Image's power."
set DU0[i]="Enemies caught by Song of the Siren are invulnerable while asleep. Save your attacks and spells for after the spell expires."
set E00[i]="Use Song of the Siren to isolate a magic immune or Cycloned hero (since they will not be affected), or to demolish buildings while enemies are asleep."
set i=i+1
set DC0[8]='Otch'
set DT0[8]='h046'
set DD0[8]='n09D'
set DS0[8]="ReplaceableTextures\\CommandButtons\\BTNTauren.blp"
call SNI(DC0[8],"attack slam")
call SYI(DC0[8],1.1,DT0[8])
set DR0[i]="Although he's a strength hero, Earthshaker (ES) actually plays more like a caster. Damage items are not very useful, but mana items can be nice."
set DP0[i]="A good cast of Fissure can isolate an opponent and cut off their escape. Practice often to achieve devastating results."
set DQ0[i]="Kelen's Dagger is an incredible item on ES, it allows you to quickly position yourself for the perfect Fissure or Echoslam."
set DU0[i]="The timing of your spells is important, by spacing them out properly you can keep a group of heroes disabled for several seconds."
set E00[i]="Due to Raigor's ability to split up an enemy team and keep them stunned, he is great for initiating fights."
set i=i+1
set DC0[9]='HC92'
set DT0[9]='h047'
set DD0[9]='n09X'
set DS0[9]="ReplaceableTextures\\CommandButtons\\BTNSatyrTrickster.blp"
call SNI(DC0[9],"stand 4")
call SYI(DC0[9],1,DT0[9])
set DR0[i]="Getting at least one level of Blink Strike and Smoke Screen help you survive to level 6 when you can learn Permanent Invisibility."
set DP0[i]="Attacking or using your spells makes you visible: Consider the fade time of Permanent Invisibility before placing yourself at risk."
set DQ0[i]="Try to position Smoke Screen slightly behind enemies so that they spend more time in the cloud if they retreat."
set DU0[i]="Wraith Bands and later a Yasha or a Diffusal Blade will provide Rikimaru with cheap damage and chasing power for dispatching fragile heroes quickly."
set E00[i]="Be careful of items that render you visible, such as Dust of Appearance, Sentry Wards or a Gem of True Sight."
set i=i+1
set DC0[10]='N01O'
set DT0[10]='h048'
set DD0[10]='n09Y'
set DS0[10]="ReplaceableTextures\\CommandButtons\\BTNDruidOfTheClaw.blp"
call SNI(DC0[10],"spell slam")
call SYI(DC0[10],1,DT0[10])
call SYI('n013',1.1,DT0[10])
call SYI('n014',1.2,DT0[10])
call SYI('n015',1.3,DT0[10])
call SYI('n004',1,DT0[10])
call SYI('n018',1.1,DT0[10])
call SYI('n01C',1.2,DT0[10])
call SYI('n01G',1.3,DT0[10])
set DR0[i]="Spirit Bear is great to have in the lane and allowing Syllabear to fight neutral creeps because of its high HP and damage. "
set DP0[i]="Leveling Spirit Bear also gets various bonuses that make it very powerful for fighting heroes and towers so it is usually the first thing to max out."
set DQ0[i]="Your Spirit Bear might be able to handle a lot of damage, but if it dies you will also take damage (100 X its level). If you die, it dies as well."
set DU0[i]="Give items to your bear instead of Syllabear since it is usually engaging the enemy for you. Remember that stat-increasing items do not benefit the bear."
set E00[i]="True Form gives Syllabear massive HP in his melee form, and Rabid and Battle Cry give both him and his Bear huge damage temporarily."
set i=i+1
set DC0[11]='H004'
set DT0[11]='h049'
set DD0[11]='n09Z'
set DS0[11]="ReplaceableTextures\\CommandButtons\\BTNSorceress.blp"
call SNI(DC0[11],"stand victory")
call SYI(DC0[11],1.2,DT0[11])
set DR0[i]="Light Strike Array is usually a good skill to get at level 1 because it provides you with a stun."
set DP0[i]="Target the ground in their direction instead of clicking on enemies to maximize Dragon Slave's long range."
set DQ0[i]="Cheap items will help Lina do her job: Bracers, Bottle, Phase Boots. A Point booster provides a nice HP/mana bonus for its cost."
set DU0[i]="Fiery Soul can help you maneuver better during a fight."
set E00[i]="Try to stun as many heroes as possible during team fights"
set i=i+1
set DC0[12]='Nbbc'
set DT0[12]='h04A'
set DD0[12]='n0A5'
set DS0[12]="ReplaceableTextures\\CommandButtons\\BTNChaosBlademaster.blp"
call SNI(DC0[12],"stand victory")
call SYI(DC0[12],1,DT0[12])
set DR0[i]="Blade Fury is your most important skill early game for getting hero kills and avoiding magic damage."
set DP0[i]="Avoid follow-command (right-clicking) heroes with Blade Fury and instead click the ground near the opponent."
set DQ0[i]="Isolate enemy heroes before using Omnislash to prevent Juggernaut from attacking multiple targets and doing less damage."
set DU0[i]="Increasing your attack speed will give you 'extra attacks' during Omnislash, which are treated like a normal attack (in terms of damage and orb effects)."
set E00[i]="Protect the 1-HP Healing Ward in battles and it can prolong and save the lives of your entire team."
set i=i+1
set DC0[13]='N01A'
set DT0[13]='h04B'
set DD0[13]='n097'
set DS0[13]="ReplaceableTextures\\CommandButtons\\BTNSpellBreaker.blp"
call SNI(DC0[13],"stand ready")
call SYI(DC0[13],1,DT0[13])
set DR0[i]="Glaives of Wisdom is useful to get early because it is useful for killing creeps and harassing your opponent manually ('W' and then the target)."
set DP0[i]="Curse of the Silent will cause an enemy to lose HP/mana if they do not choose to use their spells, or cannot use their spells (disabled, silenced, cooldown)."
set DQ0[i]="Last Word will prevent enemies from using multiple spells on you and your team at the same time provided you get close enough."
set DU0[i]="Global Silence can be used for initiating on enemies or saving allies early on. Try to pay attention to your teammates and enemies, even those not nearby."
set E00[i]="Global Silence will also give your allies the opportunity in team battles to use their spells without repercussions - making it a powerful control spell."
set i=i+1
set DC0[14]='Hamg'
set DT0[14]='h04C'
set DD0[14]='n09F'
set DS0[14]="ReplaceableTextures\\CommandButtons\\BTNTreant.blp"
call SNI(DC0[14],"stand 3")
call SYI(DC0[14],0.72,DT0[14])
set DR0[i]="Thanks to his high base damage and survivability, Rooftrellen can usually obtain high-tier damage or caster items depending on the needs of the team."
set DP0[i]="Living armor adds significant defensive bonuses to an allied unit. It can even be cast on buildings to make them more resilient and provide regeneration."
set DQ0[i]="Nature's Guise is more than an escape tool, it can be used offensively as well. Use it to position allies and yourself near trees before surprising the enemy."
set DU0[i]="Use Eyes in the Forest whenever you can to gain vision of key locations such as the rune spots, neutral creep camps and Roshan."
set E00[i]="Enemies under the effect of Overgrowth can still use spells and items, so make sure your team acts quickly while enemies remain immobilized."
set i=i+1
set DC0[15]='O015'
set DT0[15]='h07P'
set DD0[15]='n0GC'
set DS0[15]="ReplaceableTextures\\CommandButtons\\BTNHeroTaurenChieftain.blp"
call SNI(DC0[15],"stand victory")
call SYI(DC0[15],1.1,DT0[15])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[16]='Hblm'
set DT0[16]='h04E'
set DD0[16]='n09G'
set DS0[16]="ReplaceableTextures\\CommandButtons\\BTNHeroArchMage.blp"
call SNI(DC0[16],"stand victory")
call SYI(DC0[16],1.2,DT0[16])
call SYI('H06X',1.5,DT0[16])
call SYI('H06Y',1.5,DT0[16])
call SYI('H06W',1.5,DT0[16])
set DR0[i]="Chakra Magic is an amazing support skill that you should cast on allies as often as possible if they have powerful spells."
set DP0[i]="Illuminate can be useful for earning gold or clearing creeps quickly, but channeling the blast can leave you vulnerable. "
set DQ0[i]="Mana Leak gives you the offensive: An enemy that moves loses his resources to cast spells, but if he does not, you can punish him with spells and attacks."
set DU0[i]="When in your Spirit Form, use Blinding Light to push enemies aside, and Recall for saving or calling on the assistance of an ally."
set E00[i]="Keeper of the Light usually needs to stay back in fights and make use of the long range of his spells as a support hero when pushing and defending."
set i=i+1
set DC0[17]='Huth'
set DT0[17]='h04F'
set DD0[17]='n09V'
set DS0[17]="ReplaceableTextures\\CommandButtons\\BTNFurbolgTracker.blp"
call SNI(DC0[17],"attack spell")
call SYI(DC0[17],1.2,DT0[17])
set DR0[i]="Get Fury Swipes and Overpower early. Fury Swipes is a very powerful orb effect on Ursa, replacing it with another is not advised."
set DP0[i]="Ursa is a very effective hero to fight neutral creeps with: Vladimir's Offering is a recommended item choice."
set DQ0[i]="Thanks to Enrage, Ursa usually purchases items that increase HP or Strength over Agility and Damage items."
set DU0[i]="It is a good idea to fight the two ancient camps when you need a quick boost in experience and gold. They are marked red in your minimap."
set E00[i]="Certain items like Kelen's Dagger and Lothar's Edge will help both close the distance on enemies and take them by surprise."
set i=i+1
set DC0[18]='Hmkg'
set DT0[18]='h04G'
set DD0[18]='n0A1'
set DS0[18]="ReplaceableTextures\\CommandButtons\\BTNOgreMagi.blp"
call SNI(DC0[18],"sleep")
call SYI(DC0[18],1.4,DT0[18])
set DR0[i]="Buying a few Clarity Potions, Ring of Basilius or Bottle in the beginning of the game will help you cast a few more spells."
set DP0[i]="Fireblast provides a disable, Ignite provides a slow. Both deal damage, usually making them good skills early."
set DQ0[i]="Ogre Magi has a lot of survivability but he does need the ability to use his spells: An Arcane Ring might be the only item you will need all game."
set DU0[i]="Use Bloodlust to help teammates chase and escape enemies and on the hero capable of dealing the most damage before major battles."
set E00[i]="Focus heroes that need to be shut down quickly with Fireblast: Hopefully they are repeatedly damaged and disabled by the effect of Multicast."
set i=i+1
set DC0[19]='Ntin'
set DT0[19]='h04H'
set DD0[19]='n0AA'
set DS0[19]="ReplaceableTextures\\CommandButtons\\BTNHeroTinker.blp"
call SNI(DC0[19],"stand 2")
call SYI(DC0[19],1,DT0[19])
set DR0[i]="Laser and Missile give Tinker massive burst damage, so it is usually a good idea to get these two skills before Rearm, your ultimate."
set DP0[i]="Laser is not reduced by magic resistance or armor; you deal the number in the description exactly."
set DQ0[i]="You can use the active effects of items indefinitely with Rearm, which makes Boots of Travel a very powerful item for Tinker."
set DU0[i]="March of the Machines can be very useful for killing creeps quickly, its large area of effect makes it useful for pushing and team fights."
set E00[i]="Level 1 of Rearm is generally enough until much later when you have the mana pool to support levels 2 and 3."
set i=i+1
set DC0[20]='Emns'
set DT0[20]='h04I'
set DD0[20]='n0A4'
set DS0[20]="ReplaceableTextures\\CommandButtons\\BTNFurion.blp"
call SNI(DC0[20],"spell")
call SYI(DC0[20],1.2,DT0[20])
set DR0[i]="Get Force of Nature early if you plan on leaving the lane to kill neutral creeps. Start with a Ring of Basilius to provide you with mana and armor."
set DP0[i]="Invest points in Teleportation, it gives you the mobility to be anywhere in the map: Cancel the spell if you change your mind by clicking 'S'."
set DQ0[i]="Sprout can be extremely useful offensively and defensively so get at least one point in it. Higher levels increase the duration but also the mana cost."
set DU0[i]="Teleportation shows allies and enemies where you intend to go, so if you want to surprise enemies, teleport where they cannot see."
set E00[i]="Wrath of Nature is a great farming tool but also a powerful nuke on enemy heroes: Hit other units nearby to deal more damage to the intended target."
set i=i+1
set DC0[21]='Ogrh'
set DT0[21]='h04J'
set DD0[21]='n0A3'
set DS0[21]="ReplaceableTextures\\CommandButtons\\BTNHellScream.blp"
call SNI(DC0[21],"stand victory")
call SYI(DC0[21],1,DT0[21])
set DR0[i]="Get Spirit Lance and Doppelwalk first because Juxtapose is better when your illusions have more health and damage."
set DP0[i]="Beware of the high mana costs of your spells early game, especially for Doppelwalk, which can be an escape mechanism."
set DQ0[i]="Keep your opponents guessing by controlling your illusions created by Doppelwalk and Juxtapose."
set DU0[i]="Your illusions are amazing for pushing later on. Focus creeps and heroes first because illusions will not create new ones when attacking buildings."
set E00[i]="Diffusal Blade and Manta Style are good choices of because they make his images much stronger by adding Agility directly."
set i=i+1
set DC0[22]='Ucrl'
set DT0[22]='h04K'
set DD0[22]='n0A7'
set DS0[22]="ReplaceableTextures\\CommandButtons\\BTNMountainGiant.blp"
call SNI(DC0[22],"spell")
call SYI(DC0[22],0.5,DT0[22])
set DR0[i]="Buy items that give you at least 3 Intelligence or 39 mana in the beginning of the game so that you can use both of your spells at level 2."
set DP0[i]="Avalanche and Toss should be the two spells you level first because they make you a force to be reckoned with early game."
set DQ0[i]="You can sometimes kill a hero outright by casting Avalanche on him, and then Tossing him on the Avalanche area of effect before the animation ends."
set DU0[i]="To ensure that you Toss your desired target, isolate him by making him the only one in the area of effect. Kelen's Dagger can help you with placement."
set E00[i]="Tiny deals most of his damage through Avalanche and Toss, so the reduced attack speed from Grow is less important than the bonuses given."
set i=i+1
set DC0[23]='H00K'
set DT0[23]='h04L'
set DD0[23]='n0A9'
set DS0[23]="ReplaceableTextures\\CommandButtons\\BTNGoblinSapper.blp"
call SNI(DC0[23],"stand 2")
call SYI(DC0[23],1,DT0[23])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[24]='H00A'
set DT0[24]='h04M'
set DD0[24]='n0AB'
set DS0[24]="ReplaceableTextures\\CommandButtons\\BTNHeroFarseer.blp"
call SNI(DC0[24],"spell chain lightning")
call SYI(DC0[24],1,DT0[24])
set DR0[i]="Chen can take control of high level neutral creeps with Holy Persuasion, making him extremely powerful at low levels even without items."
set DP0[i]="Neutrals with special abilities usually are more useful, try to find out what has a disable or slow as this will be much better for attacking heroes with."
set DQ0[i]="When preparing to attack from the forest, start with Penitence to slow enemies. Engage enemies from the side or from behind to catch them off guard."
set DU0[i]="Chen excels as a support hero, items that contribute to teammates such as Mekansm usually benefit the team more than damage items."
set E00[i]="Hand of God is really useful early on for helping allies across the map. Later, it can be used to assist with pushing or defending."
set i=i+1
set DC0[25]='E005'
set DT0[25]='h04N'
set DD0[25]='n0BE'
set DS0[25]="ReplaceableTextures\\CommandButtons\\BTNHuntress.blp"
call SNI(DC0[25],"spell")
call SYI(DC0[25],1,DT0[25])
set DR0[i]="The level of Lucent Beam determines the damage of Eclipse, making it the most important spell to get first. "
set DP0[i]="Moon Glaives can be useful early if you plan to kill neutral creeps. Lifesteal items like Helm of the Dominator can help you survive against neutral creeps."
set DQ0[i]="Try to cast Eclipse on enemy heroes when other units are not present to maximize the damage dealt to a single target. "
set DU0[i]="Later on with some attack speed, Lunar Blessing and Moon Glaives provide you with both massive damage and pushing power."
set E00[i]="You should also consider items that allow you to land Eclipse successfully and increase your carry potential in battles, such as a Black King Bar."
set i=i+1
set DC0[26]='Usyl'
set DT0[26]='h04O'
set DD0[26]='n0BD'
set DS0[26]="ReplaceableTextures\\CommandButtons\\BTNRifleman.blp"
call SNI(DC0[26],"spell")
call SYI(DC0[26],1.1,DT0[26])
set DR0[i]="Headshot will provide you with bonus damage and a short stun, making it useful for killing creeps and harassing with his incredible attack animation."
set DP0[i]="Sniper usually needs to find a combination of damage, attack speed and survivability that allow him to deal significant damage but survive to do so."
set DQ0[i]="Sniper is very fragile so he needs to maintain his range. Getting Take Aim and/or Shrapnel can help provide means of staying out of harm's way."
set DU0[i]="Shrapenl can also be used for slowing opponents, pushing or defending against large waves of creeps."
set E00[i]="Try to use Assassinate to heavily damage an enemy before the fight even begins to give your team an advantage."
set i=i+1
set DC0[27]='N016'
set DT0[27]='h04P'
set DD0[27]='n0A8'
set DS0[27]="ReplaceableTextures\\CommandButtons\\BTNForestTroll.blp"
call SNI(DC0[27],"stand 3")
call SYI(DC0[27],1.25,DT0[27])
call SYI('N02B',1.25,DT0[27])
call SYI('N017',1.25,DT0[27])
set DR0[i]="Berserker's Rage gives Troll the option of melee combat, which gives him many powerful offensive bonuses at the cost of losing his ranged ability."
set DP0[i]="roll Warlord generally does not have to worry about attack speed thanks to his set of skills, go for damage or survivability items instead."
set DQ0[i]="Blind will prevent your opponents from landing all their attacks, making it harder from them to harass you or kill your creeps for gold."
set DU0[i]="Play defensively and fight neutral creeps too. Switch to melee form and it will allow you to have an easier time."
set E00[i]="In team battles, it is vital that you cast Blind on the enemy hero that deals the most damage as this will greatly reduce their damage output."
set i=i+1
set DC0[28]='Orkn'
set DT0[28]='h057'
set DD0[28]='n094'
set DS0[28]="ReplaceableTextures\\CommandButtons\\BTNShadowHunter.blp"
call SNI(DC0[28],"stand victory")
call SYI(DC0[28],1,DT0[28])
set DR0[i]="At least one level of Shackles is advised early on for immobilizing opponents. Remember that it is channeling so it can be interrupted or broken by yourself."
set DP0[i]="Rhasta needs survivability and the mana to use his spells: Bracers, Null Talismans, Point Booster are examples of items that will help out a lot."
set DQ0[i]="Forked Lightning is your primary nuke and finisher due to its range and ability to hit multiple targets, so it more effective to get it earlier than later."
set DU0[i]="Use Shackles and Voodoo on enemy heroes when casting Mass Serpent Ward. You can even surround an enemy completely with the right timing."
set E00[i]="Mass Serpent Wards can clear creeps quickly and deal a lot of damage over time to buildings, making them really useful for pushing and defending."
set i=i+1
set DC0[29]='O01F'
set DT0[29]='h0CI'
set DD0[29]='n0KS'
set DS0[29]="ReplaceableTextures\\CommandButtons\\BTNWispHero.blp"
call SNI(DC0[29],"stand 3")
call SYI(DC0[29],1.30,DT0[29])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[30]='Npbm'
set DT0[30]='h053'
set DD0[30]='n0AO'
set DS0[30]="ReplaceableTextures\\CommandButtons\\BTNPandarenBrewmaster.blp"
call SNI(DC0[30],"stand ready")
call SYI(DC0[30],1,DT0[30])
set DR0[i]="Thunder Clap is a great skill early game but you may need to invest in regeneration items such as a Bottle, Magic Stick, Ring of Basilius or Void Stone."
set DP0[i]="Drunken Haze works not only as a slow, but the miss chance reduces the damage severely for enemy heroes."
set DQ0[i]="Primal Split is not only for escaping: Once you master your three Pandas, Earth, Storm and Fire, you can use them offensively as well."
set DU0[i]="In Primal Split form, Mangix has two useful disables that can be used against enemies: Storm's Cyclone and Earth's Hurl Boulder."
set E00[i]="Mangix usually initiates for the team, so survivability items are helpful, investing in a Kelen's Dagger to help land Thunder Clap is often a good idea."
set i=i+1
set DC0[31]='H000'
set DT0[31]='h04X'
set DD0[31]='n0AN'
set DS0[31]="ReplaceableTextures\\CommandButtons\\BTNCentaurKhan.blp"
call SNI(DC0[31],"stand 3")
call SYI(DC0[31],1.75,DT0[31])
set DR0[i]="Return should be leveled if Centaur plans to fight neutral creeps, otherwise Double Edge is more useful in the lane."
set DP0[i]="Thanks to a high strength gain and the bonus strength from your ultimate, Centaur is a great at heading into battle first and receiving damage."
set DQ0[i]="A Hood of Defiance can prove to be just as useful as a Vanguard depending on whether the other team has a lot of magical spells."
set DU0[i]="Avoid putting yourself at risk after using Double Edge. You can use it to commit suicide if you are about to die to deny opponents experience and gold."
set E00[i]="Kelen's Dagger is a great way of initiating on opponents and dealing with his slow casting animation of Stomp."
set i=i+1
set DC0[32]='Naka'
set DT0[32]='h052'
set DD0[32]='n0AM'
set DS0[32]="ReplaceableTextures\\CommandButtons\\BTNakama.blp"
call SNI(DC0[32],"stand var4")
call SYI(DC0[32],1.2,DT0[32])
set DR0[i]="Shuriken Toss, Wind Walk and Track are much more useful than Jinada early on."
set DP0[i]="You're going to need mana regen: Bottle, Ring Of Basillius and Void Stone are examples of good options. "
set DQ0[i]="Use Wind Walk cautiously: If you wait until the cooldown is complete before breaking out of invisibility, you can cast it again immediately afterward."
set DU0[i]="Shuriken Toss and Wind Walk deal a lot of damage quickly: Search the map often for low HP heroes to hunt. "
set E00[i]="Use Track on a nearby enemy hero to allow you and your allies to outrun them. Also cast it on nearly dead heroes for bonus gold."
set i=i+1
set DC0[33]='Hlgr'
set DT0[33]='h04V'
set DD0[33]='n0AQ'
set DS0[33]="ReplaceableTextures\\CommandButtons\\BTNTheCaptain.blp"
call SNI(DC0[33],"stand victory")
call SYI(DC0[33],1.35,DT0[33])
call SYI('H00F',1,DT0[33])
call SYI('H00G',1,DT0[33])
call SYI('H00E',1,DT0[33])
call FZ1('H00G',255,255,200)
call FZ1('H00F',255,255,200)
call FZ1('H00G',255,200,200)
set DR0[i]="Breath Fire is a strong nuke and farming ability. However, against difficult opponents, Dragon's Blood is very useful."
set DP0[i]="Dragon Tail is the longest duration level 1 stun in the game. One point is usually sufficient until later on."
set DQ0[i]="Thanks to the defensive bonuses on Dragon's Blood, he can often focus on other damage items instead of increasing armor and regeneration."
set DU0[i]="Level 1 of Elder Dragon Form has a special passive called Corrosive Attack, which deals significant damage over time against towers."
set E00[i]="The ranged splash damage and slow of his Level 3 ultimate makes him extremely powerful; getting to level 16 is very important for DK."
set i=i+1
set DC0[34]='Edem'
set DT0[34]='h04T'
set DD0[34]='n0AR'
set DS0[34]="ReplaceableTextures\\CommandButtons\\BTNHeroDemonHunter.blp"
call SNI(DC0[34],"stand channel")
call SYI(DC0[34],1,DT0[34])
set DR0[i]="Blink is very versatile, allowing you to chase, escape and even avoid certain spells. It is definitely worth at least one point in the beginning."
set DP0[i]="You can also use Mana Break to prevent enemy heroes from casting spells on you, but be careful since it forces you to get in melee range to attack."
set DQ0[i]="Spell Shield might be useful for reducing magic damage, but it does not prevent you from being disabled or status effects (slow, poison, etc.)."
set DU0[i]="Offensive items without orb effects such as a Battlefury, Monkey King Bar or Butterfly are usually desired over items that would override your Mana Break."
set E00[i]="Sometimes survivability is just as important as damage, items such as Linken's Sphere or Manta Style offer a good mix of both offense and defense."
set i=i+1
set DC0[35]='Nbrn'
set DT0[35]='h055'
set DD0[35]='n0AL'
set DS0[35]="ReplaceableTextures\\CommandButtons\\BTNBansheeRanger.tga"
call SNI(DC0[35],"spell")
call SYI(DC0[35],1,DT0[35])
set DR0[i]="Frost Arrows make Drow an excellent chaser early game and allow her to harass opponents safely by manually casting them (clicking 'R' and the target)."
set DP0[i]="An early level of Silence is great for preventing opponents from using multiple spells on you or your allies."
set DQ0[i]="Trueshot Aura and Marksmanship provide Traxex with plenty of damage even with just a few Wraith Bands and Power Treads."
set DU0[i]="Lothar's Edge provides damage and an escape mechanism, the latter of which can help Traxex survive."
set E00[i]="Stay out of danger in major battles, only close in on your enemies when you are chasing and finishing off heroes near the end."
set i=i+1
set DC0[36]='Harf'
set DT0[36]='h04Z'
set DD0[36]='n0AS'
set DS0[36]="ReplaceableTextures\\CommandButtons\\BTNArthas.blp"
call SNI(DC0[36],"stand victory")
call SYI(DC0[36],1.1,DT0[36])
set DR0[i]="Omniknight is a powerful support hero, items that provide mana such as Arcane Ring help make sure that you can use all your spells."
set DP0[i]="Purification can be used offensively and defensively: The unit you cast it on will deal damage around it, making it a powerful heal and nuke."
set DQ0[i]="Degen Aura is a very strong passive slow that is useful both to chase down enemy heroes and help you and your allies escape as well."
set DU0[i]="Repel is used to remove buffs from allies and enemies, and to prevent heroes with spells from being interrupted or damage dealers from being disabled."
set E00[i]="Guardian Angel makes a team nearly impervious to physical damage and provides 25/sec HP regeneration, use this time wisely to survive or attack."
set i=i+1
set DC0[37]='H00D'
set DT0[37]='h04S'
set DD0[37]='n0AK'
set DS0[37]="ReplaceableTextures\\CommandButtons\\BTNBeastMaster.blp"
call SNI(DC0[37],"spell slam")
call SYI(DC0[37],1,DT0[37])
set DR0[i]="Endurance Aura is usually more useful later in the game when your team is fighting together, so get your other skills first."
set DP0[i]="Call of the Wild is very powerful: The boar gives damage and slow, while the hawk can provide vision over runes, neutral creeps and other key locations."
set DQ0[i]="Wild Axes are more useful early game and against heroes with less armor. Destroy trees with Wild Axes to surprise your opponents and for escaping."
set DU0[i]="Try casting Wild Axes behind the target to compensate for their movement. You can also manipulate their return path by moving Rexxar."
set E00[i]="Find opportunities to use Roar whenever it is available. It is useful on heroes who have an escape mechanism or are immune to magic."
set i=i+1
set DC0[38]='E00P'
set DT0[38]='h04R'
set DD0[38]='n0AJ'
set DS0[38]="ReplaceableTextures\\CommandButtons\\BTNChimaera.blp"
call SNI(DC0[38],"stand 3")
call SYI(DC0[38],1,DT0[38])
set DR0[i]="Dual Breath and Ice Path help to make Jakiro a strong offensive and defensive support hero. "
set DP0[i]="Jakiro can cast his spells immediately by clicking the nearby ground in the desired direction, sometimes this is more effective than clicking on the target."
set DQ0[i]="A level of Liquid Fire early on can be useful for deterring physical attacks "
set DU0[i]="Macropyre is a slow but powerful spell, combine it with other spells (yours or a teammate) to make sure the opponent is standing in the area of effect."
set E00[i]="It is often a good idea to purchase useful support items like Mekansm or Shiva's Guard, two items that also increase his low armor significantly."
set i=i+1
set DC0[39]='N01I'
set DT0[39]='h054'
set DD0[39]='n0AI'
set DS0[39]="ReplaceableTextures\\CommandButtons\\BTNHeroAlchemist.blp"
call SNI(DC0[39],"stand 2")
call SYI(DC0[39],1,DT0[39])
call SYI('N01J',1,DT0[39])
call SYI('N01H',1,DT0[39])
call SYI('N01T',1,DT0[39])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[40]='N01V'
set DT0[40]='h04W'
set DD0[40]='n0AH'
set DS0[40]="ReplaceableTextures\\CommandButtons\\BTNPriestessOfTheMoon.blp"
call SNI(DC0[40],"stand ready")
call SYI(DC0[40],1,DT0[40])
set DR0[i]="PotM can be extremely efficient and gank with just a few Wraith Bands, Boots of Speed and a Bottle."
set DP0[i]="Getting one level of Leap is usually sufficient early on until Starfall and Elune's Arrow are fully leveled."
set DQ0[i]="Land your Elune's Arrow by coordinating with allies and predicting enemy movements. You can even hit invisible or faraway targets with practice."
set DU0[i]="Starfall hits a second time for half damage to one random enemy within 200 range, get close if you can to deal bonus damage"
set E00[i]="Moonlight Shadow can be used to initiate or escape but sometimes it can be learned later when PotM can use it without compromising her mana pool."
set i=i+1
set DC0[41]='H00S'
set DT0[41]='h04Q'
set DD0[41]='n0AT'
set DS0[41]="ReplaceableTextures\\CommandButtons\\BTNStorm.blp"
call SNI(DC0[41],"spell")
call SYI(DC0[41],1,DT0[41])
set DR0[i]="Do not get Overload at level 1 since you do not have any spells to activate its effect with."
set DP0[i]="Choosing which ability to max first can be difficult, but generally at least one point in all three skills is a good idea."
set DQ0[i]="You have to wait 1 second after casting Static Remnant before it begins detecting nearby units for its explosion effect."
set DU0[i]="In addition to chasing and escaping, Lightning Ball can be used to dodge many spells with the right timing."
set E00[i]="An item like Bloodstone is useful on Storm Spirit because the percentage-based mana cost of Lightning Ball makes regeneration an important asset."
set i=i+1
set DC0[42]='H00Q'
set DT0[42]='h04Y'
set DD0[42]='n0AG'
set DS0[42]="ReplaceableTextures\\CommandButtons\\BTNHeadHunterBerserker.blp"
call SNI(DC0[42],"stand alternate 3")
call SYI(DC0[42],1.15,DT0[42])
set DR0[i]="A level of Burning Spears early on is great for harassing enemy heroes. Use it manually by clicking 'R' then the desired target to avoid drawing focus fire."
set DP0[i]="Berserker's Blood makes you stronger as you take damage. The bonuses stop when you have 51% HP, so there is little point in taking additional damage."
set DQ0[i]="Life Break deals damage based on the remaining health of the target, making it strongest at the beginning of a fight. "
set DU0[i]="Inner Vitality heals more when you have less than 40% of your life, but avoid making the mistake of casting it too late in battles."
set E00[i]="Survivability while in low health is important for Huskar: Consider items such as Armlet of Mordiggan, Black King Bar, or Heart of Tarrasque."
set i=i+1
set DC0[43]='E01Y'
set DT0[43]='h058'
set DD0[43]='n0AF'
set DS0[43]="ReplaceableTextures\\CommandButtons\\BTNAssassin.blp"
call SNI(DC0[43],"stand victory")
call SYI(DC0[43],1.2,DT0[43])
set DR0[i]="Refraction is a great way of surviving in a lane, just be careful not to get hit by creeps too much."
set DP0[i]="Meld starts cooling down when you click the spell, so you can hit him twice with it if you can predict your enemy's movements."
set DQ0[i]="Traps can be used for vision, most effectively in cramped areas like the end of ramps or at the rune powerup spots."
set DU0[i]="You can farm extremely fast by positioning yourself so that the Psi Blades splash on multiple creeps at once."
set E00[i]="Placing a trap or two before engaging a fight can be a good idea, to cut off possible escape and/or chase routes."
set i=i+1
set DC0[44]='N00B'
set DT0[44]='h050'
set DD0[44]='n0AE'
set DS0[44]="ReplaceableTextures\\CommandButtons\\BTNFaerieDragon.blp"
call SNI(DC0[44],"attack spell")
call SYI(DC0[44],1.1,DT0[44])
set DR0[i]="Illusory Orb and Jaunt are used to travel short distances quickly, but if you wait too long to Jaunt, you will lose the opportunity."
set DP0[i]="Puck is very fragile early game, some Bracers or Null Talismans and a level of Phase Shift can help you survive."
set DQ0[i]="Using Phase Shift manually instead of Autocast will prevent stray attacks from triggering it on Autocast. In general you will have better control of its use."
set DU0[i]="Waning Rift deals damage and silences, but forces you to be close enough. Use Illusory Orb or Dream Coil to help you land the spell on enemies."
set E00[i]="Puck is a great initiator in fights who offers control of the battle with his spells, allowing allies to join the battle and use their spells or attacks safely."
set i=i+1
set DC0[45]='H00T'
set DT0[45]='h051'
set DD0[45]='n0AU'
set DS0[45]="ReplaceableTextures\\CommandButtons\\BTNClockWerkGoblin.blp"
call SNI(DC0[45],"Birth")
call SYI(DC0[45],1.5,DT0[45])
set DR0[i]="You can use Rocket Flare for harassing and killing creeps early on. With the right timing, you can even fire at enemies across the map."
set DP0[i]="Power Cogs can be used to trap an enemy, push them away while draining mana, or as an escape mechanism since Rattletrap destroys Cogs in only 1 hit."
set DQ0[i]="Battery Assault adds a lot of damage and the stuns help you with chasing, use it when no other units are nearby for best results."
set DU0[i]="Hookshot's long range and high speed lets you reach enemies from out of sight. Follow up with your other spells quickly so your target cannot escape."
set E00[i]="Rocket Flare also gives vision where it lands, making it very useful for scouting areas such as rune spots, neutral creeps, the enemy base."
set i=i+1
set DC0[46]='H06S'
set DT0[46]='h06T'
set DD0[46]='n0EE'
set DS0[46]="ReplaceableTextures\\CommandButtons\\BTNProudmoore.blp"
call SNI(DC0[46],"stand victory")
call SYI(DC0[46],1.1,DT0[46])
set DR0[i]="Tidebringer is extremely useful early game: Use the bonus damage for killing creeps and the cleave effect to harass opponents at the same time."
set DP0[i]="The bubble animation from Torrent can only be seen by your team so try to use this to your advantage."
set DQ0[i]="An ally's assistance or X Marks the Spot is a great way of making sure Torrent and Ghost Ship hit your opponent."
set DU0[i]="Escaping enemy heroes is easy by casting X Marks the Spot on them. It also prevents them from getting away."
set E00[i]="The Ghost Ship will crash 1000 range from where you stand when you cast it. Keep your distance when you use it."
set i=i+1
set DC0[47]='N0EG'
set DT0[47]='h07A'
set DD0[47]='n0EH'
set DS0[47]="ReplaceableTextures\\CommandButtons\\BTNSylvanusWindrunner.blp"
call SNI(DC0[47],"stand victory")
call SYI(DC0[47],1.2,DT0[47])
set DR0[i]="Powershot deals significant damage, making it ideal to max first. Be sure not to fire through creeps if you want to deal maximum damage to your target."
set DP0[i]="An early level of Windrunner can provide you with a quick getaway and chasing tool."
set DQ0[i]="Shackleshot can either be used on your intended target to bind him to a nearby unit, or to bind the designated target located BEHIND the unit that you fired it at."
set DU0[i]="Focus Fire is also a powerful spell to use on buildings and Roshan."
set E00[i]="As long as you do not attack another target, the effect of Focus Fire will stay on. Use your spells and active items to help you fire at your target."
set i=i+1
set DC0[48]='E02N'
set DT0[48]='h0CC'
set DD0[48]='n0KN'
set DS0[48]="ReplaceableTextures\\CommandButtons\\BTNFlyingMachine.blp"
call SNI(DC0[48],"stand 3")
call SYI(DC0[48],1.10,DT0[48])
call SYI('E02O',1.10,DT0[48])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[49]='E02J'
set DT0[49]='h0CD'
set DD0[49]='n0KR'
set DS0[49]="ReplaceableTextures\\CommandButtons\\BTNThrall.blp"
call SNI(DC0[49],"stand 3")
call SYI(DC0[49],1.10,DT0[49])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[50]='E02I'
set DT0[50]='h0C9'
set DD0[50]='n0KK'
set DS0[50]="ReplaceableTextures\\CommandButtons\\BTNTuskaarBrown.blp"
call SNI(DC0[50],"stand 3")
call SYI(DC0[50],1.00,DT0[50])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[51]='E02F'
set DT0[51]='h0C8'
set DD0[51]='n0KM'
set DS0[51]="ReplaceableTextures\\CommandButtons\\BTNPhoenix.blp"
call SNI(DC0[51],"stand 3")
call SYI(DC0[51],1.05,DT0[51])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[52]='H008'
set DT0[52]='h04U'
set DD0[52]='n0AC'
set DS0[52]="ReplaceableTextures\\CommandButtons\\BTNRazorback.blp"
call SNI(DC0[52],"stand")
call SYI(DC0[52],1.65,DT0[52])
set DR0[i]="Rigwarl is a known for punishing heroes that attack him and surviving for long times but he still needs armor, regeneration and hit points."
set DP0[i]="Quill spray doesn't initially deal much damage, but the stacking effect makes it very powerful over time in battles."
set DQ0[i]="Sometimes one level of Goo can be enough to slow down an enemy hero early game."
set DU0[i]="Rigwarl needs a fair amount of mana early-game, Ring of Basilius, Magic Stick or Bottle can boost his early offensive power immensely."
set E00[i]="You can mitigate a lot of damage if you turn your hero at the right times thanks to your passive Bristleback. Play mind games on your opponent."
set i=i+1
set DC0[53]='E02X'
set DT0[53]='h0CT'
set DD0[53]='n0LK'
set DS0[53]="ReplaceableTextures\\CommandButtons\\BTNMedivh.blp"
call SNI(DC0[53],"stand 3")
call SYI(DC0[53],1.15,DT0[53])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[54]='N0M0'
set DT0[54]='h0DG'
set DD0[54]='n0M1'
set DS0[54]="ReplaceableTextures\\CommandButtons\\BTNFireBrewmaster.blp"
call SNI(DC0[54],"stand 3")
call SYI(DC0[54],1,DT0[54])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[55]='E02K'
set DT0[55]='h0CA'
set DD0[55]='n0KJ'
set DS0[55]="ReplaceableTextures\\CommandButtons\\BTNGarithos.blp"
call SNI(DC0[55],"stand 3")
call SYI(DC0[55],1.3,DT0[55])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[56]='H0DO'
set DT0[56]='h0DH'
set DD0[56]='n0M6'
set DS0[56]="ReplaceableTextures\\CommandButtons\\BTNDragonHawk.blp"
call SNI(DC0[56],"stand 3")
call SYI(DC0[56],1.1,DT0[56])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[57]='E032'
set DT0[57]='h0EB'
set DD0[57]='n0ME'
set DS0[57]="ReplaceableTextures\\CommandButtons\\BTNJunkGolem.blp"
call SNI(DC0[57],"stand 3")
call SYI(DC0[57],1,DT0[57])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[58]='N0MU'
set DT0[58]='h0EK'
set DD0[58]='n0MV'
set DS0[58]="ReplaceableTextures\\CommandButtons\\BTNEarthBrewmaster.blp"
call SNI(DC0[58],"stand 3")
call SYI(DC0[58],1,DT0[58])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[59]='N0MD'
set DT0[59]='h0EP'
set DD0[59]='n0MG'
set DS0[59]="ReplaceableTextures\\CommandButtons\\BTNPriest.blp"
call SNI(DC0[59],"stand victory")
call SYI(DC0[59],1.25,DT0[59])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DF0=59
set i=60
set DG0=60
set DC0[60]='Ewar'
set DT0[60]='h05J'
set DD0[60]='n0B5'
set DS0[60]="ReplaceableTextures\\CommandButtons\\BTNHeroWarden.blp"
call SNI(DC0[60],"spell slam")
call SYI(DC0[60],1,DT0[60])
set DR0[i]="Stifling Dagger is used for creep-killing and slowing opponents; prevent enemies from escaping by using it with Blink Strike."
set DP0[i]="Try to Blink Strike to a nearby allied or enemy unit to make a quick escape when caught in a defensive situation. "
set DQ0[i]="Be cautious when entering battles with Blink Strike, you could be caught outnumbered or disabled without your escape mechanism."
set DU0[i]="Blur can sometimes allow you to surprise opponents if they aren't paying attention."
set E00[i]="Items like Battlefury are useful, but getting a Black King Bar or a Satanic afterward will help you survive long enough to deal damage."
set i=i+1
set DC0[61]='H00V'
set DT0[61]='h05K'
set DD0[61]='n0B6'
set DS0[61]="ReplaceableTextures\\CommandButtons\\BTNNagaSeaWitch.blp"
call SNI(DC0[61],"stand ready")
call SYI(DC0[61],1,DT0[61])
call SYI('H08D',1,DT0[61])
call SYI('H08C',1,DT0[61])
call SYI('H084',1,DT0[61])
call SYI('H08B',1,DT0[61])
set DR0[i]="Mystic Snake is a smart choice to have early game: Its damage and mana drain makes it great for harassing and offsetting its own mana cost."
set DP0[i]="Mana Shield will increase your survivability drastically. Use it wisely or it can also leave you with no mana for your other spells."
set DQ0[i]="Using Split Shot allows you to attack multiple units, but the extra arrows from Split Shot do not gain the properties of orb effects."
set DU0[i]="Stone Gaze is an ultimate that is used to slow opponents and remove their buffs, making it easy to escape or attack the purged enemies."
set E00[i]="Items that increase statistics and regeneration like Linkens Sphere will always be a good choice because of Mana Shield."
set i=i+1
set DC0[62]='Udre'
set DT0[62]='h05L'
set DD0[62]='n0B7'
set DS0[62]="ReplaceableTextures\\CommandButtons\\BTNTichondrius.blp"
call SNI(DC0[62],"spell slam")
call SYI(DC0[62],1,DT0[62])
set DR0[i]="Night Stalker may be passive during the day, but at night his spells make him much more powerful and great for hunting heroes down."
set DP0[i]="Void is your primary source of damage early game and can be used to interrupt spells and teleports with its mini-stun."
set DQ0[i]="While Hunter in the Night does nothing during the day, get it so that during nighttime it will give you massive movement and attack speed."
set DU0[i]="Use Crippling Fear when you are hunting heroes so that they cannot disable or slow you while you are chasing them."
set E00[i]="Since Darkness will pause time when activated, casting it at night whenever it is on cooldown will extend the total nighttime."
set i=i+1
set DC0[63]='NC00'
set DT0[63]='h05M'
set DD0[63]='n0C0'
set DS0[63]="ReplaceableTextures\\CommandButtons\\BTNSkeletonArcher.blp"
call SNI(DC0[63],"stand victory")
call SYI(DC0[63],1.8,DT0[63])
call FZ1(DC0[63],100,125,100)
set DR0[i]="Skeleton King is a hero who is known for his ability to reincarnate if focused upon and dealing a lot of damage if he is ignored by opponents. "
set DP0[i]="Hellfire Blast is a great spell for the early laning phase and a few levels of Attribute Bonus can give you stat points for additional stuns."
set DQ0[i]="Critical Strike is generally preferred over Vampiric Aura because its lifesteal is not very effective earlier when Leoric needs more damage."
set DU0[i]="Make sure you have enough mana for Hellfire Blasts and especially Reincarnation. Buying a Magic Stick and/or a Bottle can pay off nicely."
set E00[i]="Get cheaper damage items like Armlet of Mordiggan and Desolator. A Black King Bar will allow you to dish out damage without being disabled."
set i=i+1
set DC0[64]='UC42'
set DT0[64]='h05N'
set DD0[64]='n0BV'
set DS0[64]="ReplaceableTextures\\CommandButtons\\BTNDoomGuard.blp"
call SNI(DC0[64],"stand victory")
call SYI(DC0[64],1.1,DT0[64])
set DR0[i]="Lucifer can obtain gold very quickly thanks to Devour, so getting regeneration items like Perseverance will help him to cast spells and survive in the lane."
set DP0[i]="Devour deals 20 damage per second, so consume creeps with low HP remaining so you can finish digesting the enemy quickly."
set DQ0[i]="Use the command -ma to find your opponents' level for potential LVL? Death targets. Its mini-stun will also interrupt channeling spells and teleports."
set DU0[i]="Doom is usually used in conjunction with LVL? Death for killing enemy heroes; you can also use it on heroes to silence their spells."
set E00[i]="When chasing or escaping with Scorched Earth, cast it in front of you so that you will experience the movement speed bonuses for a longer period of time."
set i=i+1
set DC0[65]='U000'
set DT0[65]='h05O'
set DD0[65]='n0BU'
set DS0[65]="ReplaceableTextures\\CommandButtons\\BTNHeroCryptLord.tga"
call SNI(DC0[65],"spell throw")
call SYI(DC0[65],0.8,DT0[65])
set DR0[i]="Effective use of Impale and Mana Burn early game requires you to purchase some Null Talismans or Bracers and Bottle."
set DP0[i]="Mana Burn is a devastating spell to have in the lane, force opponents to play defensively by preventing them from casting spells."
set DQ0[i]="Unlike other Agility heroes, Anub'arak is a caster. Getting items like Dagon can be more useful than purchasing damage items."
set DU0[i]="Vendetta is a good initiating spell for surprising opponents. Cast it far away so that they cannot hear its sound effect upon activation."
set E00[i]="Be careful when using Vendetta against multiple opponents and going near towers where they can see you while you are invisible."
set i=i+1
set DC0[66]='UC91'
set DT0[66]='h05P'
set DD0[66]='n0C1'
set DS0[66]="ReplaceableTextures\\CommandButtons\\BTNNagaMyrmidon.tga"
call SNI(DC0[66],"spell")
call SYI(DC0[66],1,DT0[66])
call FZ1(DC0[66],175,75,200)
set DR0[i]="Slithereen Crush requires good positioning, so do your best to stand next to the hero you are trying to stun."
set DP0[i]="Sprint is a great spell for both chasing and escaping but be careful when using it because you will take bonus damage."
set DQ0[i]="In addition to lowering armor, Amplify Damage provides vision of enemies, even heroes that have the ability to become invisible."
set DU0[i]="Bash is usually more effective later in the game when you have more items like Armlet of Mordiggan."
set E00[i]="Slardar's role in battles is to initiate with Slithereen Crush and focus an enemy with Bash and Amplify Damage. Pick off escapees with Sprint."
set i=i+1
set DC0[67]='UC01'
set DT0[67]='h05Q'
set DD0[67]='n0C2'
set DS0[67]="ReplaceableTextures\\CommandButtons\\BTNBlueDemoness.tga"
call SNI(DC0[67],"spell slam")
call SYI(DC0[67],1.3,DT0[67])
set DR0[i]="Blink provides you with an escape mechanism and spell dodge but on higher levels it becomes a powerful chasing tool as well."
set DP0[i]="Scream of Pain is used for killing creeps and harassing opponents, making it more useful than Shadow Strike early game."
set DQ0[i]="Try to hit as many targets as possible with Sonic Wave by targeting the ground instead of on an enemy hero directly."
set DU0[i]="Shadow Strike does decent damage but its primary use is for the slow it provides for chasing and outrunning opponents."
set E00[i]="Her spell reliance, mobility and survivability allows her to buy expensive Intelligence items such as a Guinsoo's Scythe of Vyse."
set i=i+1
set DC0[68]='E004'
set DT0[68]='h05R'
set DD0[68]='n0BW'
set DS0[68]="ReplaceableTextures\\CommandButtons\\BTNSkeletonMage.blp"
call SNI(DC0[68],"stand victory")
call SYI(DC0[68],1,DT0[68])
set DR0[i]="Searing Arrows provide damage for last hitting creeps and harassing enemy heroes by using it manually by clicking 'R' followed by the designated target."
set DP0[i]="Wind Walk is commonly used for chasing and escaping but the invisibility and movement speed can help you avoid specific spells with the right timing."
set DQ0[i]="Cast Death Pact on enemy or neutral creeps instead of allied units whenever possible because it will give you the gold for killing the unit."
set DU0[i]="Regeneration items like Orchid Malevolence or a Linkens Sphere will allow liberal use of his abilities in battle and help him against spellcasters and nukers."
set E00[i]="Strafe is usually gotten later, but combined with Searing Arrows, Clinkz can deal a lot of damage quickly, powerful against enemy heroes and buildings."
set i=i+1
set DC0[69]='EC45'
set DT0[69]='h05S'
set DD0[69]='n0BS'
set DS0[69]="ReplaceableTextures\\CommandButtons\\BTNFacelessOne.blp"
call SNI(DC0[69],"spell slam")
call SYI(DC0[69],1.3,DT0[69])
call FZ1(DC0[69],0,255,150)
set DR0[i]="Time Walk is your escaping and chasing skill, but it will allow you to avoid spells and damage since you are invulnerable during the animation."
set DP0[i]="Get Backtrack early game if you need to play defensively, while Time Lock will allow you to be a little more aggressive."
set DQ0[i]="Since Darkterror is so fragile, enter battles by using Time Walk and then cast Chronosphere to prevent yourself from being disabled or killed otherwise."
set DU0[i]="Chronosphere affects all units that are not controlled by you, including both allies and enemies. Avoid hitting teammates or it could cost them their lives."
set E00[i]="Items such as Power Treads and Butterfly will give both damage and attack speed, which is useful if Void wants to repetitively stun with Time Lock."
set i=i+1
set DC0[70]='EC77'
set DT0[70]='h05T'
set DD0[70]='n0BR'
set DS0[70]="ReplaceableTextures\\CommandButtons\\BTNNetherDragon.blp"
call SNI(DC0[70],"spell slam")
call SYI(DC0[70],1.2,DT0[70])
call FZ1(DC0[70],75,255,25)
set DR0[i]="Poison Attack allows you to harass an opponent and permanently chase them thanks to a 0 cooldown starting at level 3."
set DP0[i]="Prevent creeps and towers from attacking you by casting Poison Attack manually by clicking 'C' and then the designated target."
set DQ0[i]="Neurotoxin will add bonus damage, useful early for getting the last hit on creeps and also for dealing damage to heroes as well."
set DU0[i]="Early HP and movement speed items like Phase Boots or a Point/Vitality Booster can really make a difference."
set E00[i]="Sometimes it is wise to invest in a Lothar's Edge or Kelen's Dagger to provide you with the ability to get in and out of combat safely."
set i=i+1
set DC0[71]='E002'
set DT0[71]='h05U'
set DD0[71]='n0BY'
set DS0[71]="ReplaceableTextures\\CommandButtons\\BTNRevenant.blp"
call SNI(DC0[71],"spell")
call SYI(DC0[71],1,DT0[71])
set DR0[i]="Use your attack range to help gauge how far opponents need to be for Plasma Field to deal the most damage."
set DP0[i]="Unstable Current will slow opponents who cast spells on you and could be useful to help prevent yourself from being killed."
set DQ0[i]="Static Link is powerful if you can stay within the range of opponents - getting Unstable Current can sometimes help with that."
set DU0[i]="Storm Seeker strikes the target with the lowest health, so use it after creeps have died or when chasing a solitary target."
set E00[i]="Consider increasing your HP along with damage when purchasing items."
set i=i+1
set DC0[72]='U00C'
set DT0[72]='h05V'
set DD0[72]='n0BQ'
set DS0[72]="ReplaceableTextures\\CommandButtons\\BTNGhoul.blp"
call SNI(DC0[72],"victory")
call SYI(DC0[72],1.5,DT0[72])
call FZ1(DC0[72],100,100,100)
set DR0[i]="Open Wounds is a powerful slow that nearly stops enemies in their tracks; it also lets you and your allies heal for attacking that unit.Open Wounds is a powerful slow that nearly stops enemies in their tracks; it also lets you and your allies heal for attacking that unit."
set DP0[i]="Feast deals percentage-based damage, which is useful against heroes with high HP and lets Naix fight neutral creeps with ease."
set DQ0[i]="Rage can be used to avoid spells and to prevent opponents from disabling you while you are attacking them or trying to escape from them."
set DU0[i]="Infest can be used for escaping, surprising your opponents, to neutral, or to just gain significant health quickly when necessary."
set E00[i]="Thanks to your physical damage and ability to steal life, Armlet of Mordiggan or Desolator are both solid choices for high-tier items."
set i=i+1
set DC0[73]='H00H'
set DT0[73]='h05W'
set DD0[73]='n0BT'
set DS0[73]="ReplaceableTextures\\CommandButtons\\BTNPugna.BLP"
call SNI(DC0[73],"stand ready")
call SYI(DC0[73],1,DT0[73])
set DR0[i]="Nether Blast gives you an incredible skill for killing creeps, harassing heroes and pushing. Use it to score the killing blow to a tower."
set DP0[i]="Decrepify can be used on opponents either to increase spell damage from you and your allies or to prevent them from attacking."
set DQ0[i]="Nether Ward will drain mana and punish opponents for using spells. Just remember to cast it where opponents cannot destroy it easily."
set DU0[i]="Aghanim's Scepter, Linkens Sphere and Bloodstone are examples of items that offer survivability while improving his spellcasting abilities."
set E00[i]="Life Drain deals a lot of damage unless opponents disable you or run away. With an Aghanim's Scepter, its cooldown becomes 0."
set i=i+1
set DC0[74]='Ofar'
set DT0[74]='h05X'
set DD0[74]='n0BP'
set DS0[74]="ReplaceableTextures\\CommandButtons\\BTNSeaGiantGreen.blp"
call SNI(DC0[74],"attack slam")
call SYI(DC0[74],1,DT0[74])
set DR0[i]="Be sure to attack enemies slowed by Gush, the armor reduction means that your hits will deal more damage than normal."
set DP0[i]="Anchor Smash is an offensive damage spell that lets you hurt multiple units, good for killing neutral creeps and useful in team battles."
set DQ0[i]="Kraken Shell gives you some protection against physical damage as well as a debuff removal against certain spells."
set DU0[i]="In fights, Tidehunter should be in the middle of the action drawing focus fire and dealing damage because of his skill set and high survivability."
set E00[i]="Ravage has a large area of effect but Kelen's Dagger will allow you to initiate without being disabled and use it in an optimal spot."
set i=i+1
set DC0[75]='Oshd'
set DT0[75]='h05Y'
set DD0[75]='n0BO'
set DS0[75]="ReplaceableTextures\\CommandButtons\\BTNVoidWalker.blp"
call SNI(DC0[75],"spell")
call SYI(DC0[75],1.5,DT0[75])
call FZ1(DC0[75],150,0,150)
set DR0[i]="High costs and cooldowns give Atropos limited ability use: Cast spells intelligently and get items like Null Talismans and/or Magic Stick for your mana pool."
set DP0[i]="Brain Sap is a powerful nuke and heal and deals exact unreduced damage so get it early and always try to use it on enemy heroes when using the spell."
set DQ0[i]="Use Nightmare to help teammates to aim their spells and remove an opponent from battles temporarily while you fight their allies."
set DU0[i]="Enfeeble is usually a skill to get after Brain Sap and Nightmare to use on enemy heroes with high damage to reduce their damage capabilities severely."
set E00[i]="Fiend's Grip will work on Magic Immune units such as those under the active effect of Black King Bar, holding them in place but dealing no damage."
set i=i+1
set DC0[76]='U00E'
set DT0[76]='h05Z'
set DD0[76]='n0B8'
set DS0[76]="ReplaceableTextures\\CommandButtons\\BTNGhostOfKelThuzad.blp"
call SNI(DC0[76],"stand victory")
call SYI(DC0[76],1.3,DT0[76])
set DR0[i]="Death Pulse lets you kill creeps and harass heroes simultaneously, great for pushing and healing allied units because of its low cooldown."
set DP0[i]="Sadist will provide you with some early regeneration for killing creeps, while Heartstopper Aura becomes effective as the game goes on."
set DQ0[i]="Reaper's Scythe is known for its ability to kill heroes outright, allowing you to bring down even high-HP Strength heroes with ease."
set DU0[i]="Your ultimate can also be used to stun opponents in certain situations, such as interrupting channeling spells and teleports."
set E00[i]="Items like Bloodstone or Heart of Tarrasque allow you to survive long enough in team battles to make your spells more effective."
set i=i+1
set DC0[77]='U00F'
set DT0[77]='h060'
set DD0[77]='n0C5'
set DS0[77]="ReplaceableTextures\\CommandButtons\\BTNAbomination.blp"
call SNI(DC0[77],"stand 3")
call SYI(DC0[77],1.0,DT0[77])
set DR0[i]="Pudge can known for his ability to isolate enemies with Meat Hook and using Rot and Dismember afterward, killing them outright. "
set DP0[i]="Early regeneration and movement speed items such as Bottle and Phase Boots help provide Pudge with the means to cast spells and chase his opponents."
set DQ0[i]="Use Meat Hook from a location where you are not obstructed by any allied or enemy units other than your target to ensure a better chance of landing it."
set DU0[i]="A Hood of Defiance will improve your magic resistance to reduce damage from using Rot and getting hit by spells; The massive regeneration is also good."
set E00[i]="Use your spells defensively: Rot can be used to commit suicide if necessary and Meat Hook can be used to rescue an ally from one or more enemies."
set i=i+1
set DC0[78]='O00J'
set DT0[78]='h061'
set DD0[78]='n0C3'
set DS0[78]="ReplaceableTextures\\CommandButtons\\BTNSpiritWalker.blp"
call SNI(DC0[78],"stand ready")
call SYI(DC0[78],1.2,DT0[78])
set DR0[i]="Empowering Haste is a smart skill to level first, it gives Barathrum movement speed and significant damage for killing creeps and heroes."
set DP0[i]="A level of Greater Bash early game can be useful as an extra disable, since the 17% chance is the same for all levels.A level of Greater Bash early game can be useful as an extra disable, since the 17% chance is the same for all levels."
set DQ0[i]="Get Strength Power Treads because the attack and movement speed benefits your other skills and the boost in HP helps you survive."
set DU0[i]="Charge of Darkness gives Barathrum spell immunity after 12 seconds and provides vision of the target for you and your allies."
set E00[i]="Nether Strike puts you from the opposite side of where you were facing, push opponents backwards and into your allies."
set i=i+1
set DC0[79]='Ubal'
set DT0[79]='h062'
set DD0[79]='n0BX'
set DS0[79]="ReplaceableTextures\\CommandButtons\\BTNNerubianQueen.blp"
call SNI(DC0[79],"attack")
call SYI(DC0[79],1.0,DT0[79])
call FZ1(DC0[79],255,200,200)
set DR0[i]="Take care of Weaver's HP/damage problems with Bracers or Wraith Bands and get regeneration so he can use his spells freely."
set DP0[i]="An early level of Watchers can be used to provide vision over the rune powerups. Patrol them to increase their area of detection."
set DQ0[i]="Shukuchi is used for harassing and chasing opponents offensively, and escaping and avoiding certain projectile spells defensively."
set DU0[i]="If your Geminate Attack is not working, make sure that you input an attack command ('A' or right-click) and are not simply auto-attacking."
set E00[i]="Use Time Lapse after taking a lot of recent damage to heal yourself, allowing you to pull off some dangerous moves like diving into towers."
set i=i+1
set DC0[80]='Nfir'
set DT0[80]='h063'
set DD0[80]='n0BN'
set DS0[80]="ReplaceableTextures\\CommandButtons\\BTNShade.blp"
call SNI(DC0[80],"stand channel")
call SYI(DC0[80],1.15,DT0[80])
call FZ1(DC0[80],0,0,0)
set DR0[i]="Necromastery is important because of its massive damage gain and because your ultimate deals damage based on the number of souls."
set DP0[i]="Shadow Raze gives you three powerful nuke spells that should be maxed out first. Gauge the distance correctly and hit multiple times."
set DQ0[i]="Requiem of Souls deals more damage the closer you are: Placement items like Lothar's Edge and Kelen's Dagger can help you land it."
set DU0[i]="After maxing your other two spells, Presence of the Dark Lord will be useful by then, good for pushing and dealing more physical damage."
set E00[i]="If you die, remember to fill up on souls again before major fights when you respawn or you will be much less effective in battles."
set i=i+1
set DC0[81]='U00K'
set DT0[81]='h064'
set DD0[81]='n0C4'
set DS0[81]="ReplaceableTextures\\CommandButtons\\BTNArachnathidGreen.blp"
call SNI(DC0[81],"attack 3")
call SYI(DC0[81],1,DT0[81])
set DR0[i]="Burrowstrike is both versatile and powerful: It deals damage, stuns and provides you with a useful escape or chasing mechanism."
set DP0[i]="Using Sandstorm at the right time will dodge certain projectile spells and can protect you temporarily if it is necessary."
set DQ0[i]="Getting Kelen's Dagger will give him increased mobility and reach, and also the ability to Blink into battle right after channeling Epicenter."
set DU0[i]="While you cannot move while Epicenter is channeling, once the pulses begin you can freely move around (mostly to chase your opponent)."
set E00[i]="Caustic Finale might be an orb effect but it is extremely useful for killing multiple units quickly for fighting neutrals, pushing and defending."
set i=i+1
set DC0[82]='Opgh'
set DT0[82]='h065'
set DD0[82]='n0BM'
set DS0[82]="ReplaceableTextures\\CommandButtons\\BTNChaosGrom.blp"
call SNI(DC0[82],"stand victory")
call SYI(DC0[82],1,DT0[82])
set DR0[i]="Counter Helix gives Axe the flexibility to both lane and jungle. A Stout Shield will help reduce the damage from taking attacks in order to activate Helix."
set DP0[i]="A Vanguard or a Hood of Defiance offers survivability and regeneration, which are usually more useful to Axe than increasing his attack speed or damage."
set DQ0[i]="Berserker's Call is used to initiate fights and draw focus fire. Using it when there are more enemy units increases the chance of activating Counter Helix."
set DU0[i]="Monitor your opponent's HP for the perfect Culling Blade opportunity to finish them off. However, if your enemy has too much HP, it will hardly do anything."
set E00[i]="Kelen's Dagger and/or Phase Boots can help you enter the fight first and get close enough for a Berserker's Call."
set i=i+1
set DC0[83]='Hvsh'
set DT0[83]='h066'
set DD0[83]='n0BZ'
set DS0[83]="ReplaceableTextures\\CommandButtons\\BTNShaman.blp"
call SNI(DC0[83],"stand victory")
call SYI(DC0[83],1.25,DT0[83])
call FZ1(DC0[83],250,150,150)
set DR0[i]="Getting Blood Bath will allow you to take a few hits as you are killing creeps because you will recover your health immediately afterwards."
set DP0[i]="An early level of Bloodrage can be useful for silencing enemies temporarily and for dealing a little bit of damage."
set DQ0[i]="Phase Boots and HP can be just as useful as damage items because they increase his survivability for chasing enemies and other longer battles."
set DU0[i]="Use Rupture when your enemy has to either run away or to prevent them from moving, such as when an ally is about to use a powerful spell."
set E00[i]="Both allies and enemies gain the massive damage increase and are silenced from Bloodrage, which can be disastrous if used incorrectly."
set i=i+1
set DC0[84]='Udea'
set DT0[84]='h067'
set DD0[84]='n0BL'
set DS0[84]="ReplaceableTextures\\CommandButtons\\BTNHeroDeathKnight.blp"
call SNI(DC0[84],"stand ready")
call SYI(DC0[84],1,DT0[84])
set DR0[i]="Abbadon's spells can save allies while dealing damage, so support and regeneration items like Vladmir's Offering can be more useful than damage items."
set DP0[i]="Death Coil can be used both as a nuke and a heal, just remember that it deals damage to you unless you are using Aphotic Shield or Borrowed Time."
set DQ0[i]="Aphotic Shield prevents damage but can also be used to remove certain debuffs, such as removing the stun duration effect on an ally."
set DU0[i]="Frostmourne is usually gotten later but it is very useful for chasing and helping your allies outrun your opponents."
set E00[i]="Borrowed Time can be cast manually as well. If you know you are going to receive a lot of damage sometimes it can be wiser to use it then."
set i=i+1
set DC0[85]='E01B'
set DT0[85]='h068'
set DD0[85]='n0B9'
set DS0[85]="ReplaceableTextures\\CommandButtons\\BTNvengeanceincarnate.blp"
call SNI(DC0[85],"stand ready")
call SYI(DC0[85],0.8,DT0[85])
set DR0[i]="Spectral Dagger is your utility spell. You can use it for chasing people down, scouting dangerous areas and escaping. "
set DP0[i]="You also walk through units, trees, even cliffs while you are walking on Spectral Dagger's black path, making it very handy when used properly."
set DQ0[i]="Desolate is great for dealing target to isolated targets but Dispersion helps you to survive in the lane: Chose whatever combination suits you best."
set DU0[i]="Haunt lets you jump into a fight directly from anywhere in the map; just make sure that you pay attention to the actions of your team."
set E00[i]="Getting HP will allow you to withstand and dish out more Dispersion damage, which is extremely powerful in team fights."
set i=i+1
set DC0[86]='E01A'
set DT0[86]='h069'
set DD0[86]='n0BK'
set DS0[86]="ReplaceableTextures\\CommandButtons\\BTNWitchDoctor.blp"
call SNI(DC0[86],"stand victory")
call SYI(DC0[86],1.25,DT0[86])
set DR0[i]="Paralyzing Cask is your initiating spell for your other skills and can effectively keep two nearby units stun-locked at higher levels."
set DP0[i]="Maledict drastically reduces the damage needed to kill opponents and is an important spell to land in every fight."
set DQ0[i]="An early level of Voodoo Restoration can provide a relatively cheap heal if you are forced to play defensively."
set DU0[i]="Damaging your opponent immediately after using Maledict is wise because it will deal more bonus damage overall at the 3 ticks."
set E00[i]="Death Ward is a powerful channeling spell if not interrupted. A Black King Bar will help to prevent enemies from disabling you."
set i=i+1
set DC0[87]='U00P'
set DT0[87]='h06A'
set DD0[87]='n0BA'
set DS0[87]="ReplaceableTextures\\CommandButtons\\BTNDestroyer.blp"
call SNI(DC0[87],"stand alternate 2")
call SYI(DC0[87],0.85,DT0[87])
set DR0[i]="Getting Intelligence and mana items is extremely important for Harbringer as the power of Arcane Orb and Sanity's Eclipse rely on this."
set DP0[i]="Use Astral Imprisonment to control your opponents' mana, for escaping/chasing, or on yourself and allies to avoid spells."
set DQ0[i]="Cast Arcane Orb manually early on because you will have a greater chance of activating Essence Aura to use it endlessly."
set DU0[i]="Guinsoo's Scythe of Vyse is a great choice because it offers Intelligence, balanced stats and provides Harbringer with a powerful disable."
set E00[i]="Use Sanity's Eclipse early in fights so that you drain casters with high Intelligence of their mana and cripple their ability to cast spells."
set i=i+1
set DC0[88]='E01C'
set DT0[88]='h06C'
set DD0[88]='n0BB'
set DS0[88]="ReplaceableTextures\\CommandButtons\\BTNGuldan.blp"
call SNI(DC0[88],"spell")
call SYI(DC0[88],1.5,DT0[88])
set DR0[i]="Shadow Word is either a heal or damage over time, definitely the most powerful early game spell to have."
set DP0[i]="The affordable Mekansm is a good support item for Warlock, who is not a hero who is reliant on gold and items to be effective."
set DQ0[i]="Rain of Chaos creates a powerful Infernal that can take on heroes and is also great for killing creeps and pushing buildings."
set DU0[i]="Fatal Bonds can deal huge damage if you and your teammates have other area of effect (AoE) spells that would hurt multiple linked units."
set E00[i]="The stun when using Rain of Chaos along with its huge casting range (1200) is great for interrupting spells and initiating battles."
set i=i+1
set DC0[89]='H00I'
set DT0[89]='h06D'
set DD0[89]='n0BJ'
set DS0[89]="ReplaceableTextures\\CommandButtons\\BTNKoboldGeomancer.blp"
call SNI(DC0[89],"spell")
call SYI(DC0[89],1.4,DT0[89])
call SYI('H00J',1.4,DT0[89])
set DR0[i]="Vladmir's Offering and/or Mekansm provides valuable auras and useful heals that can help support your team and keep your Meepos alive."
set DP0[i]="Poof is both a teleport and damage spell and is great against neutrals. Poof to yourself to deal double the damage (from departure and arrival).Poof is both a teleport and damage spell and is great against neutrals. Poof to yourself to deal double the damage (from departure and arrival)."
set DQ0[i]="Geomancer is an advanced hero: Be sure to monitor their individual health because if one dies, they all will."
set DU0[i]="Strength Power Treads are suggested since clones will receive all of the Strength from footwear along with a 2.5 bonus (12.5 total)."
set E00[i]="Time Earthbind with each of your clones. With 4 Meepos and Level 4 Earthbind, you can almost permanently immobilize them."
set i=i+1
set DC0[90]='N01W'
set DT0[90]='h06E'
set DD0[90]='n0BI'
set DS0[90]="ReplaceableTextures\\CommandButtons\\BTNDarkTrollShadowPriest.blp"
call SNI(DC0[90],"spell")
call SYI(DC0[90],1.2,DT0[90])
set DR0[i]="An early level of both Shadow Wave and Shallow Grave provides a lot of support before getting Poison Touch to level 3 for its added stun."
set DP0[i]="Try to use Shadow Wave to heal and damage opponents at the same time. Surround an enemy with multiple allied units for more damage."
set DQ0[i]="In addition to slowing and damaging opponents, Poison Touch will allow you to interrupt channeling spells and teleports"
set DU0[i]="Dazzle generally does not need many items and can sometimes focus on increasing his spell use with regeneration and support items like Mekansm."
set E00[i]="Weave is a powerful spell, try to hit both allies and enemies with it, and it can also be used to provide vision before major battles occur."
set i=i+1
set DC0[91]='N00R'
set DT0[91]='h06F'
set DD0[91]='n0BC'
set DS0[91]="ReplaceableTextures\\CommandButtons\\BTNPitLord.blp"
call SNI(DC0[91],"stand channel")
call SYI(DC0[91],0.95,DT0[91])
set DR0[i]="Firestorm will be your main ability for killing creeps but it can deal a lot of damage to heroes if you combine it with disables or slows."
set DP0[i]="The Pit of Malice is a useful disable that lasts for 10 seconds so it will both ensnare opponents and deter opponents from entering the circle."
set DQ0[i]="Expulsion is usually used after some creeps have died so the spell lasts longer and will deal damage and mini-stun enemies."
set DU0[i]="Pit Lord is played more as a caster, increase his team presence and spell use by obtaining expensive Intelligence items like Shiva's Guard."
set E00[i]="Dark Rift is a great spell for transporting multiple allies to surprise opponents, and more importantly to defend and attack the base."
set i=i+1
set DC0[92]='H00R'
set DT0[92]='h06G'
set DD0[92]='n0BH'
set DS0[92]="ReplaceableTextures\\CommandButtons\\BTNZombie.blp"
call SNI(DC0[92],"stand")
call SYI(DC0[92],2,DT0[92])
call SYI('H07I',1.3,DT0[92])
set DR0[i]="Decay is used to deal damage and make opponents more vulnerable, while increasing the survivability of Dirge temporarily."
set DP0[i]="Make sure Dirge is a presence who can cast his spells in fights by buying regeneration items like Vladmir's Offering and Void Stone."
set DQ0[i]="Soul Rip is a powerful heal or nuke but remember that it will have almost no effect without nearby units. Cast it in crowds."
set DU0[i]="Use Tombstone when engaging the enemy because the zombies have a slowing capability and may also help block your opponents."
set E00[i]="Tombstone Zombies become extremely powerful when your opponents have low health and attack and move much faster."
set i=i+1
set DC0[93]='H00N'
set DT0[93]='h06H'
set DD0[93]='n0BG'
set DS0[93]="ReplaceableTextures\\CommandButtons\\BTNDranaiMage.blp"
call SNI(DC0[93],"spell")
call SYI(DC0[93],1.15,DT0[93])
set DR0[i]="Ion shell is great for killing creeps and dealing damage to heroes, but it will not damage an enemy target if you cast it on them directly."
set DP0[i]="A level of Surge early game can help you and allies escape and chase enemies, and works nicely to help you close in on opponents with Ion Shell."
set DQ0[i]="Vacuum is an extremely powerful skill that can be used for initiating and combining with other spells. It can also interrupt channeling and teleport spells."
set DU0[i]="Make sure they are standing closer to the edge of your targeting circle when casting Vacuum to pull your opponents further."
set E00[i]="Use Wall of Replica where multiple heroes will touch it; try using it with Vacuum. Get your allies to run through the wall too."
set i=i+1
set DC0[94]='H00U'
set DT0[94]='h06B'
set DD0[94]='n0BF'
set DS0[94]="ReplaceableTextures\\CommandButtons\\BTNHeroBloodElfPrince.blp"
call SNI(DC0[94],"spell")
call SYI(DC0[94],1.25,DT0[94])
set DR0[i]="Having at least one level in Quas, Wex and Exort will give you a larger repertoire of spells. Type -invokelist to obtain a full list of combinations."
set DP0[i]="Ghost Walk (QQW) can be used to get yourself out of a tight situation, and also for slowing opponents so that your allies can chase/escape."
set DQ0[i]="Sunstrike (EEE) is a global-ranged nuke that deals damage based on the level of Exort. When using it, you have to factor in the 1.7 casting time."
set DU0[i]="Forge Spirit (EEQ) and Cold Snap (QQQ) can be effective for pushing towers and against heroes with low armor. "
set E00[i]="EMP (WWW) and Tornado (WWQ) can completely drain off heroes with low mana pools and have a impressive casting range."
set i=i+1
set DC0[95]='Uktl'
set DT0[95]='h04D'
set DD0[95]='n0A6'
set DS0[95]="ReplaceableTextures\\CommandButtons\\BTNSpell_Shadow_SummonVoidWalker.blp"
call SNI(DC0[95],"stand")
call SYI(DC0[95],1.5,DT0[95])
set DR0[i]="Conversion allows Enigma to neutral creep effectively. Target the highest level creep possible and move your low HP Eidolons out of the way to save them."
set DP0[i]="In the lane, Conversion can be used on allied creeps to deny your opponents of experience and gold, and for making sure you last hit enemy creeps."
set DQ0[i]="The multiple stuns on higher levels of Malefice make it useful for preventing an opponent from channeling spells or help you chase/escape them."
set DU0[i]="Use Midnight Pulse in conjunction with Black Hole to deal massive damage to enemies. Just make sure that you cast it before Black Hole."
set E00[i]="Kelen's Dagger is great for Black Hole placement, and a Black King Bar will prevent most spells from stopping the channeling effect of the spell."
set i=i+1
set DC0[96]='O016'
set DT0[96]='h07R'
set DD0[96]='n0G9'
set DS0[96]="ReplaceableTextures\\CommandButtons\\BTNTrollBatRider.blp"
call SNI(DC0[96],"stand")
call SYI(DC0[96],1.2,DT0[96])
call SYI('O017',1.2,DT0[96])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[97]='N0HP'
set DT0[97]='h0B0'
set DD0[97]='n0HR'
set DS0[97]="ReplaceableTextures\\CommandButtons\\BTNIcyGhost.blp"
call SNI(DC0[97],"stand")
call SYI(DC0[97],1.17,DT0[97])
call SYI('N0HP',1.2,DT0[97])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[98]='H071'
set DT0[98]='h072'
set DD0[98]='n0EF'
set DS0[98]="ReplaceableTextures\\CommandButtons\\BTNMurgulShadowCaster.blp"
call SNI(DC0[98],"stand 3")
call SYI(DC0[98],1.25,DT0[98])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[99]='Eevi'
set DT0[99]='h056'
set DD0[99]='n0AV'
set DS0[99]="ReplaceableTextures\\CommandButtons\\BTNEvilIllidan.blp"
call SNI(DC0[99],"spell channel")
call SYI(DC0[99],1,DT0[99])
call SYI('Eevm',1,DT0[99])
call SYI('E02V',1,DT0[99])
call SYI('E02W',1,DT0[99])
call SYI('E02U',1,DT0[99])
set DR0[i]="Get Soul Steal if you need healing in the lane."
set DP0[i]="Purchase statistic-increasing items like Wraith Bands and later items like Sange and Yasha to benefit both Terrorblade and his images."
set DQ0[i]="It might be difficult to escape due to the trail you leave behind when walking, you may have to use an image to act as a block or decoy."
set DU0[i]="Sunder can turn fights around when you have low health but be careful of disables and high damage spells when trying to swap."
set E00[i]="Creating ranged images in Metamorphosis will allow you to deal damage safely in fights as well as push down buildings very quickly."
set i=i+1
set DC0[100]='Ekee'
set DT0[100]='h059'
set DD0[100]='n0AW'
set DS0[100]="ReplaceableTextures\\CommandButtons\\BTNKeeperGhostBlue.blp"
call SNI(DC0[100],"stand victory")
call SYI(DC0[100],1,DT0[100])
set DR0[i]="Split Earth is a very useful disable while Lightning Storm is taken because of its low cooldown. Both are powerful spells that hit multiple targets."
set DP0[i]="By using Lightning Storm to finish low-health creeps with nearby opponents, you can get gold and harass enemy heroes at the same time."
set DQ0[i]="Diabolic Edict is one of the most powerful spells for destroying buildings. Eliminate the creeps first so that you only have one target."
set DU0[i]="Turn off Pulse Nova when you have finished using it because the spell will continue until you have exhausted your entire mana pool."
set E00[i]="Items like Bloodstone or Aghanim's Scepter will allow Leshrac to use his spells more liberally and survive in the midst of battle."
set i=i+1
set DC0[101]='E02H'
set DT0[101]='h0CB'
set DD0[101]='n0KL'
set DS0[101]="ReplaceableTextures\\CommandButtons\\BTNArchimonde.blp"
call SNI(DC0[101],"stand 3")
call SYI(DC0[101],1.25,DT0[101])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[102]='Ulic'
set DT0[102]='h05A'
set DD0[102]='n0AX'
set DS0[102]="ReplaceableTextures\\CommandButtons\\BTNLichVersion2.blp"
call SNI(DC0[102],"stand channel")
call SYI(DC0[102],1.3,DT0[51])
set DR0[i]="Dark Ritual is useful for denying allied creeps and provides you with mana to use spells without buying regeneration items."
set DP0[i]="Frost Nova is a very powerful spell that allows you to be aggressive. Attack the enemy a few extra times while they are slowed."
set DQ0[i]="Chain Frost is most effective when used against 2-3 nearby targets (ideally heroes), but will not bounce when used on a lone unit."
set DU0[i]="Frost Armor should be cast on multiple teammates when you have the mana for it later on; it works nicely against melee units."
set E00[i]="The first target of your Chain Frost can interrupt channeling and teleport spells if absolutely necessary."
set i=i+1
set DC0[103]='UC76'
set DT0[103]='h05B'
set DD0[103]='n0AY'
set DS0[103]="ReplaceableTextures\\CommandButtons\\BTNBanshee.blp"
call SNI(DC0[103],"spell wail")
call SYI(DC0[103],1.35,DT0[103])
set DR0[i]="Carrion Swarm is your primary nuke and first skill to max. Make use of its range by casting it on the ground instead of on a unit directly."
set DP0[i]="An early level of Silence can help prevent you and your allies from being attacked by multiple spells."
set DQ0[i]="The ghosts of Exorcism will attack whatever you attack, so if you want to direct all attention to a single unit simply focus them and stay nearby."
set DU0[i]="Exorcism also makes Krobelus extremely effective for quickly destroying enemy buildings, so be sure to push the enemy base when you can"
set E00[i]="The effect of Exorcism stops if you die in combat: Invest in items that improve your survivability, such as a Bloodstone or a Heart of Tarrasque."
set i=i+1
set DC0[104]='UC18'
set DT0[104]='h05C'
set DD0[104]='n0AZ'
set DS0[104]="ReplaceableTextures\\CommandButtons\\BTNLion.BLP"
call SNI(DC0[104],"spell callstorm")
call SYI(DC0[104],1.3,DT0[104])
call FZ1(DC0[104],50,100,255)
set DR0[i]="With plenty of damage and disables, Lion is quite a force to be reckoned with cheap utility items such as Bottle and Phase Boots."
set DP0[i]="Impale gives Lion the ability to disable multiple targets and deals decent damage, so it is definitely the most versatile of his three skills for the early game."
set DQ0[i]="Mana Drain only works on units with mana: Using Mana Drain on enemy heroes will reduce their spell use while replenishing mana."
set DU0[i]="Avoid wasting Finger of Death on low-health enemy heroes when a few extra attacks or using another spell like Impale will deal enough damage."
set E00[i]="Wait until the duration of your first disable wears off before using another one for maximum disable time when using Impale and Voodoo."
set i=i+1
set DC0[105]='EC57'
set DT0[105]='h05D'
set DD0[105]='n0B0'
set DS0[105]="ReplaceableTextures\\CommandButtons\\BTNHydralisk.blp"
call SNI(DC0[105],"attack")
call SYI(DC0[105],1.0,DT0[105])
call FZ1(DC0[105],150,200,255)
set DR0[i]="Venomous Gale is a spell that hits multiple opponents and slows them, making it very useful for getting early kills."
set DP0[i]="At least one level of Poison Sting is recommended early game for its slow effect."
set DQ0[i]="Bottle and Magic Stick will help deal with his low HP/mana, while Phase Boots are a cheap way to improve his chasing capabilities."
set DU0[i]="Wards are very useful for pushing a lane and killing neutral and enemy creeps, but you can also use it to provide vision."
set E00[i]="Poison Nova deals a lot of damage but you have to combine it with other spells and attacks because it does not deal fatal damage (stops at 1 HP)."
set i=i+1
set DC0[106]='UC11'
set DT0[106]='h05E'
set DD0[106]='n0A2'
set DS0[106]="ReplaceableTextures\\CommandButtons\\BTNBlueMagnataur.tga"
call SNI(DC0[106],"stand channel")
call SYI(DC0[106],1,DT0[106])
call FZ1(DC0[106],150,150,100)
set DR0[i]="Bottle and Perseverance help with early regeneration,. while purchasing Kelen's Dagger later will help you to land Reverse Polarity."
set DP0[i]="A few Attribute Bonus points can help you cast more spells. Save Mighty Swing for later levels when you have more damage."
set DQ0[i]="By targeting the ground where you want to fire Shockwave, you can hit both creeps and opponents and make use of its long range."
set DU0[i]="Magnus should cast Empower on himself and other allies with high damage before initiating team battles with his ultimate."
set E00[i]="The cleave of Battlefury stacks directly with Mighty Swing, making it a good damage item especially if you already have a Perseverance."
set i=i+1
set DC0[107]='UC60'
set DT0[107]='h05F'
set DD0[107]='n0B1'
set DS0[107]="ReplaceableTextures\\CommandButtons\\BTNSpiritWyvern.blp"
call SNI(DC0[107],"stand victory")
call SYI(DC0[107],1,DT0[107])
call FZ1(DC0[107],150,150,150)
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[108]='U00A'
set DT0[108]='h05G'
set DD0[108]='n0B2'
set DS0[108]="ReplaceableTextures\\CommandButtons\\BTNChaosWarlord.blp"
call SNI(DC0[108],"stand victory")
call SYI(DC0[108],1.05,DT0[108])
set DR0[i]="Chaos Bolt and Blink Strike are active abilities that are more useful in the lane and for killing opponents than Critical Strike."
set DP0[i]="Chaos Bolt is a disable that switches between average and extremely powerful, the sooner you have max out this spell, the better."
set DQ0[i]="His high natural movement speed (325 - the highest in the game) and Blink Strike make him very difficult for opponents to outrun or chase him."
set DU0[i]="If you Blink Strike and then use Chaos Bolt, you can spend more time hitting opponents and less time waiting for his slow casting animation. "
set E00[i]="Make Nessaj and Phantasm stronger by buying Strength items like Armlet of Mordiggan (when activated) and Heart of Tarrasque."
set i=i+1
set DC0[109]='N0M7'
set DT0[109]='h0DW'
set DD0[109]='n0M8'
set DS0[109]="ReplaceableTextures\\CommandButtons\\BTNFrostWyrm.blp"
call SNI(DC0[109],"stand victory")
call SYI(DC0[109],0.9,DT0[109])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[110]='N0MK'
set DT0[110]='h0EF'
set DD0[110]='n0ML'
set DS0[110]="ReplaceableTextures\\CommandButtons\\BTNGnollWarden.blp"
call SNI(DC0[110],"stand victory")
call SYI(DC0[110],1.1,DT0[110])
set DR0[i]=""
set DP0[i]=""
set DQ0[i]=""
set DU0[i]=""
set E00[i]=""
set i=i+1
set DC0[111]='U008'
set DT0[111]='h05H'
set DD0[111]='n0B3'
set DS0[111]="ReplaceableTextures\\CommandButtons\\BTNKiljaedin.blp"
call SNI(DC0[111],"spell")
call SYI(DC0[111],1.2,DT0[111])
call SYI('E015',1,DT0[111])
call FZ1(DC0[111],255,75,255)
set DR0[i]="If you want to neutral creeps, start with Summon Wolves and a Ring of Basilius, which can be used to make Vladmir's Offering later."
set DP0[i]="Spirit Wolves gain invisibility at level 4, making them difficult to kill and easy to harass heroes with in the lane."
set DQ0[i]="Feral Heart make you and your wolves stronger overall, while Howl is an offensive spell used before engaging the enemy."
set DU0[i]="Shapeshift makes you incredibly powerful and gives you max movement speed. Avoid being blocked by your wolves when chasing."
set E00[i]="A Black King Bar will prevent enemies from disabling you, making you very fearsome and almost unstoppable when attacking heroes."
set i=i+1
set DC0[112]='U006'
set DT0[112]='h05I'
set DD0[112]='n0B4'
set DS0[112]="ReplaceableTextures\\CommandButtons\\BTNSpiderBlack.blp"
call SNI(DC0[112],"walk")
call SYI(DC0[112],1.36,DT0[112])
set DR0[i]="At least one level in Spin Web early game will increase your survivability greatly. Remember that attacking/using spells will cause you to break invisibility."
set DP0[i]="Spawn Spiderlings is both a nuke and pushing spell, so getting items like a Ring of Basilius will provide you with both mana and armor for pushing."
set DQ0[i]="Incapacitating Bite makes it very difficult for enemies to get away from you, great for chasing and slowing opponents temporarily for your allies."
set DU0[i]="Try to space out your webs with least 2 seconds of walking distance so that you can benefit from its bonuses on as much ground as possible."
set E00[i]="With the damage and lifesteal from Insatiable Hunger, sometimes it is best to get items that will prevent you from being disabled, such as a Black King Bar."
set i=i+1
set DH0=112
set DZ0[1]='Nbrn'
set DZ0[2]='Edem'
set DZ0[3]='N016'
set DZ0[4]='Nbbc'
set DZ0[5]='Naka'
set DZ0[6]='O00P'
set DZ0[7]='Usyl'
set DZ0[8]='E005'
set DZ0[9]='N01O'
set DZ0[10]='HC92'
set DZ0[11]='Hvwd'
set DZ0[12]='HC49'
set DZ0[13]='Huth'
set DZ0[14]='Ogrh'
set DZ0[15]='U006'
set DZ0[16]='EC57'
set DZ0[17]='Eevi'
set DZ0[18]='Ubal'
set DZ0[19]='E004'
set DZ0[20]='EC77'
set DZ0[21]='Hvsh'
set DZ0[22]='Nfir'
set DZ0[23]='E002'
set DZ0[24]='EC45'
set DZ0[25]='Ewar'
set DZ0[26]='U000'
set DZ0[27]='H00V'
set DZ0[28]='E01B'
set DZ0[29]='N01V'
set DZ0[30]='H00I'
set DZ0[31]='E01Y'
set DZ0[32]='H071'
set DZ0[33]='E02N'
set DZ0[34]='N0M0'
set DZ0[35]='N0MK'
set DV0=35
set DW0[1]='Npbm'
set DW0[2]='Hlgr'
set DW0[3]='Harf'
set DW0[4]='H000'
set DW0[5]='H001'
set DW0[6]='Hamg'
set DW0[7]='H008'
set DW0[8]='Ucrl'
set DW0[9]='Otch'
set DW0[10]='NC00'
set DW0[11]='Udre'
set DW0[12]='UC11'
set DW0[13]='Ofar'
set DW0[14]='U00F'
set DW0[15]='U00K'
set DW0[16]='O00J'
set DW0[17]='Udea'
set DW0[18]='Opgh'
set DW0[19]='U00A'
set DW0[20]='U00C'
set DW0[21]='UC91'
set DW0[22]='UC42'
set DW0[23]='U008'
set DW0[24]='H00D'
set DW0[25]='N01I'
set DW0[26]='H00Q'
set DW0[27]='N00R'
set DW0[28]='H00T'
set DW0[29]='H06S'
set DW0[30]='H00R'
set DW0[31]='O015'
set DW0[32]='E02I'
set DW0[33]='E02F'
set DW0[34]='O01F'
set DW0[35]='E032'
set DW0[36]='E02K'
set DW0[37]='N0MU'
set DX0=37
set DY0[1]='Orkn'
set DY0[2]='Emoo'
set DY0[3]='Emns'
set DY0[4]='H004'
set DY0[5]='Hjai'
set DY0[6]='Uktl'
set DY0[7]='Hmbr'
set DY0[8]='H00K'
set DY0[9]='Ntin'
set DY0[10]='Hmkg'
set DY0[11]='Hblm'
set DY0[12]='N01A'
set DY0[13]='H00A'
set DY0[14]='Ulic'
set DY0[15]='Ekee'
set DY0[16]='UC76'
set DY0[17]='UC18'
set DY0[18]='UC01'
set DY0[19]='UC60'
set DY0[20]='H00H'
set DY0[21]='Oshd'
set DY0[22]='U00E'
set DY0[23]='E01A'
set DY0[24]='U00P'
set DY0[25]='E00P'
set DY0[26]='E01C'
set DY0[27]='N01W'
set DY0[28]='H00N'
set DY0[29]='N0EG'
set DY0[30]='H00S'
set DY0[31]='N00B'
set DY0[32]='H00U'
set DY0[33]='O016'
set DY0[34]=DC0[97]
set DY0[35]='E02H'
set DY0[36]='E02J'
set DY0[37]='E02X'
set DY0[38]='H0DO'
set DY0[39]='N0M7'
set DY0[40]='N0MD'
set DJ0=40
set DK0[1]='Orkn'
set DK0[2]='Emoo'
set DK0[3]='Emns'
set DK0[4]='H004'
set DK0[5]='Hjai'
set DK0[6]='Uktl'
set DK0[7]='Hmbr'
set DK0[8]='H00K'
set DK0[9]='Ntin'
set DK0[10]='Nbrn'
set DK0[11]='Hblm'
set DK0[12]='N01A'
set DK0[13]='H00A'
set DK0[14]='Ulic'
set DK0[15]='Ekee'
set DK0[16]='UC76'
set DK0[17]='UC18'
set DK0[18]='UC01'
set DK0[19]='UC60'
set DK0[20]='H00H'
set DK0[21]='Oshd'
set DK0[22]='U00E'
set DK0[23]='E01A'
set DK0[24]='U00P'
set DK0[25]='E00P'
set DK0[26]='E01C'
set DK0[27]='N01W'
set DK0[28]='N0EG'
set DK0[29]='H00S'
set DK0[30]='N00B'
set DK0[31]='H00U'
set DK0[32]='N016'
set DK0[33]='O00P'
set DK0[34]='Usyl'
set DK0[35]='E005'
set DK0[36]='N01O'
set DK0[37]='E01Y'
set DK0[38]='Hvwd'
set DK0[39]='EC57'
set DK0[40]='Ubal'
set DK0[41]='E004'
set DK0[42]='EC77'
set DK0[43]='Nfir'
set DK0[44]='E002'
set DK0[45]='H00V'
set DK0[46]='N01V'
set DK0[47]='H00Q'
set DK0[48]='O016'
set DK0[49]=DC0[97]
set DK0[50]='O01F'
set DK0[51]='E02H'
set DK0[52]='E02N'
set DK0[53]='E02J'
set DK0[54]='E02F'
set DK0[55]='E02X'
set DK0[56]='H0DO'
set DK0[57]='N0MK'
set DK0[58]='N0M7'
set DK0[59]='N0MD'
set DL0=59
set DM0[1]='Hmkg'
set DM0[2]='H00N'
set DM0[3]='Edem'
set DM0[4]='Nbbc'
set DM0[5]='Naka'
set DM0[6]='HC49'
set DM0[7]='Huth'
set DM0[8]='Ogrh'
set DM0[9]='U006'
set DM0[10]='Eevi'
set DM0[11]='Hvsh'
set DM0[12]='EC45'
set DM0[13]='Ewar'
set DM0[14]='U000'
set DM0[15]='E01B'
set DM0[16]='H00I'
set DM0[17]='HC92'
set DM0[18]='Npbm'
set DM0[19]='Hlgr'
set DM0[20]='Harf'
set DM0[21]='H000'
set DM0[22]='H001'
set DM0[23]='Hamg'
set DM0[24]='H008'
set DM0[25]='Ucrl'
set DM0[26]='Otch'
set DM0[27]='NC00'
set DM0[28]='Udre'
set DM0[29]='UC11'
set DM0[30]='Ofar'
set DM0[31]='U00F'
set DM0[32]='U00K'
set DM0[33]='O00J'
set DM0[34]='Udea'
set DM0[35]='Opgh'
set DM0[36]='U00A'
set DM0[37]='U00C'
set DM0[38]='UC91'
set DM0[39]='UC42'
set DM0[40]='U008'
set DM0[41]='H00D'
set DM0[42]='N01I'
set DM0[43]='N00R'
set DM0[44]='H00T'
set DM0[45]='H06S'
set DM0[46]='H00R'
set DM0[47]='O015'
set DM0[48]='H071'
set DM0[49]='E02I'
set DM0[50]='N0M0'
set DM0[51]='E032'
set DM0[52]='E02K'
set DM0[53]='N0MU'
set DN0=53
call TWI()
endfunction
function InitTrig_Hero takes nothing returns nothing
call ZE1()
endfunction
function ZF1 takes nothing returns nothing
call SNI('esen',"stand 4")
call SNI('e00V',"stand 4")
call SNI('edry',"spell")
call SNI('e00W',"spell")
call SNI('ugho',"stand victory")
call SNI('u001',"stand victory")
call SNI('unec',"stand channel")
call SNI('u002',"stand channel")
call SYI('n00M',0.4,'n00M')
call SYI('e02R',0.5,'e02R')
call SYI('e02T',1.2,'e02T')
call SYI('e02S',0.5,'e02S')
call SYI('e030',0.5,'e030')
call SYI('n0LS',1,'n0LS')
endfunction
function InitTrig_Unit takes nothing returns nothing
call ZF1()
endfunction
function ZG1 takes nothing returns nothing
local trigger t=CreateTrigger()
local player T4I=Player(15)
local real ZH1=GetUnitX(VX)
local real ZZ1=GetUnitY(VX)
local real ZV1=GetUnitX(MZ)
local real ZW1=GetUnitY(MZ)
local real ZX1=GetUnitX(HX)
local real ZY1=GetUnitY(HX)
local real ZJ1=GetUnitX(YY)
local real ZK1=GetUnitY(YY)
local real ZL1=GetUnitX(LZ)
local real ZM1=GetUnitY(LZ)
local real ZN1=GetUnitX(NZ)
local real ZS1=GetUnitY(NZ)
local real ZT1=GetUnitX(IZ)
local real ZR1=GetUnitY(IZ)
local real ZP1=GetUnitX(KY)
local real ZQ1=GetUnitY(KY)
local real ZU1=GetUnitX(EZ)
local real V01=GetUnitY(EZ)
local real VI1=GetUnitX(ZX)
local real V11=GetUnitY(ZX)
local real VO1=GetUnitX(HY)
local real V21=GetUnitY(HY)
local real V31=GetUnitX(JY)
local real V41=GetUnitY(JY)
call RemoveUnit(VX)
call RemoveUnit(NZ)
call RemoveUnit(MZ)
call RemoveUnit(LZ)
call RemoveUnit(HX)
call RemoveUnit(IZ)
call RemoveUnit(EZ)
call RemoveUnit(ZX)
call RemoveUnit(HY)
call RemoveUnit(YY)
call RemoveUnit(KY)
call RemoveUnit(JY)
set EI0=CreateUnit(T4I,'n008',ZL1,ZM1,270)
set E10=CreateUnit(T4I,'n0GJ',ZN1,ZS1,270)
set EO0=CreateUnit(T4I,'n01D',ZT1,ZR1,270)
set E20=CreateUnit(T4I,'n0LH',ZP1,ZQ1,270)
set E30=CreateUnit(T4I,'n01N',ZH1,ZZ1,270)
set E40=CreateUnit(T4I,'n007',ZV1,ZW1,270)
set E50=CreateUnit(T4I,'n005',ZX1,ZY1,270)
set E60=CreateUnit(T4I,'n0LI',ZJ1,ZK1,270)
set E70=CreateUnit(T4I,'n01B',ZU1,V01,270)
set E80=CreateUnit(T4I,'n01P',VI1,V11,270)
set E90=CreateUnit(T4I,'n0GK',VO1,V21,270)
set EA0=CreateUnit(T4I,'n0LJ',V31,V41,270)
call SetUnitColor(EI0,ConvertPlayerColor(1))
call SetUnitColor(E10,ConvertPlayerColor(1))
call SetUnitColor(EO0,ConvertPlayerColor(9))
call SetUnitColor(E20,ConvertPlayerColor(9))
call SetUnitColor(E30,ConvertPlayerColor(6))
call SetUnitColor(E40,ConvertPlayerColor(6))
call SetUnitColor(E50,ConvertPlayerColor(10))
call SetUnitColor(E60,ConvertPlayerColor(10))
call SetUnitColor(E70,ConvertPlayerColor(0))
call SetUnitColor(E80,ConvertPlayerColor(0))
call SetUnitColor(E90,ConvertPlayerColor(11))
call SetUnitColor(EA0,ConvertPlayerColor(11))
set t=null
endfunction
function InitTrig_Tavern takes nothing returns nothing
call ZG1()
endfunction
function V51 takes integer id returns boolean
return id=='H00J' or id=='N0MM'
endfunction
function V61 takes integer id returns boolean
local integer i=0
loop
exitwhen i>EE0
if ED0[i]==id then
return true
endif
set i=i+1
endloop
return false
endfunction
function V71 takes nothing returns nothing
set EE0=EE0+1
set ED0[EE0]='A1ZW'
set EE0=EE0+1
set ED0[EE0]='A0B6'
set EE0=EE0+1
set ED0[EE0]='A0K7'
set EE0=EE0+1
set ED0[EE0]='A0T7'
set EE0=EE0+1
set ED0[EE0]='A0T8'
set EE0=EE0+1
set ED0[EE0]='A11F'
set EE0=EE0+1
set ED0[EE0]='A11H'
set EE0=EE0+1
set ED0[EE0]='A11G'
set EE0=EE0+1
set ED0[EE0]='A11D'
set EE0=EE0+1
set ED0[EE0]='A0S3'
set EE0=EE0+1
set ED0[EE0]='A11E'
set EE0=EE0+1
set ED0[EE0]='A15W'
set EE0=EE0+1
set ED0[EE0]='A2HQ'
set EE0=EE0+1
set ED0[EE0]='A231'
set EE0=EE0+1
set ED0[EE0]='A2HO'
set EE0=EE0+1
set ED0[EE0]='A02O'
set EE0=EE0+1
set ED0[EE0]='A08Y'
set EE0=EE0+1
set ED0[EE0]='A08Z'
set EE0=EE0+1
set ED0[EE0]='A090'
set EE0=EE0+1
set ED0[EE0]='A092'
set EE0=EE0+1
set ED0[EE0]='AIpg'
set EE0=EE0+1
set ED0[EE0]='AItb'
set EE0=EE0+1
set ED0[EE0]='A0H6'
set EE0=EE0+1
set ED0[EE0]='A1QD'
set EE0=EE0+1
set ED0[EE0]='A1T7'
set EE0=EE0+1
set ED0[EE0]='A19M'
set EE0=EE0+1
set ED0[EE0]='A1AC'
set EE0=EE0+1
set ED0[EE0]='AChx'
set EE0=EE0+1
set ED0[EE0]='A28Y'
set EE0=EE0+1
set ED0[EE0]='AIbk'
set EE0=EE0+1
set ED0[EE0]='A1EW'
set EE0=EE0+1
set ED0[EE0]='A017'
set EE0=EE0+1
set ED0[EE0]='A0JY'
set EE0=EE0+1
set ED0[EE0]='A0FO'
set EE0=EE0+1
set ED0[EE0]='A0H7'
set EE0=EE0+1
set ED0[EE0]='A0B8'
set EE0=EE0+1
set ED0[EE0]='A1WE'
set EE0=EE0+1
set ED0[EE0]='AIxk'
set EE0=EE0+1
set ED0[EE0]='A1ZI'
set EE0=EE0+1
set ED0[EE0]='A0CK'
set EE0=EE0+1
set ED0[EE0]='A0JL'
set EE0=EE0+1
set ED0[EE0]='A1FO'
set EE0=EE0+1
set ED0[EE0]='AIda'
set EE0=EE0+1
set ED0[EE0]='A0HB'
set EE0=EE0+1
set ED0[EE0]='A0D3'
set EE0=EE0+1
set ED0[EE0]='A0DF'
set EE0=EE0+1
set ED0[EE0]='A0FD'
set EE0=EE0+1
set ED0[EE0]='A12W'
set EE0=EE0+1
set ED0[EE0]='A14A'
set EE0=EE0+1
set ED0[EE0]='A1FD'
set EE0=EE0+1
set ED0[EE0]='A1IO'
set EE0=EE0+1
set ED0[EE0]='A02W'
set EE0=EE0+1
set ED0[EE0]='A269'
set EE0=EE0+1
set ED0[EE0]='A2KG'
set EE0=EE0+1
set ED0[EE0]='A1FP'
set EE0=EE0+1
set ED0[EE0]='A0T9'
set EE0=EE0+1
set ED0[EE0]='A1Q8'
set EE0=EE0+1
set ED0[EE0]='A1MO'
set EE0=EE0+1
set ED0[EE0]='A28D'
set EE0=EE0+1
set ED0[EE0]='Aeat'
set EE0=EE0+1
set ED0[EE0]='A0K0'
set EE0=EE0+1
set ED0[EE0]='AIpl'
set EE0=EE0+1
set ED0[EE0]='A0JT'
set EE0=EE0+1
set ED0[EE0]='AIpr'
set EE0=EE0+1
set ED0[EE0]='A02X'
set EE0=EE0+1
set ED0[EE0]='A1R5'
set EE0=EE0+1
set ED0[EE0]='AIsw'
set EE0=EE0+1
set ED0[EE0]='A206'
set EE0=EE0+1
set ED0[EE0]='A1ZH'
set EE0=EE0+1
set ED0[EE0]='A2EA'
set EE0=EE0+1
set ED0[EE0]='A2K4'
set EE0=EE0+1
set ED0[EE0]='A2K7'
set EE0=EE0+1
set ED0[EE0]='A2K1'
set EE0=EE0+1
set ED0[EE0]='A2VE'
endfunction
function V81 takes integer id returns boolean
return id=='A21F' or id=='A21G' or id=='A21H' or id=='A1S9' or id=='A24A' or id=='A24B' or id=='A1S9' or id=='A06K' or id=='A1VG' or id=='A28Q' or id=='A1WF' or id=='A0T8' or id=='A0T7' or id=='A20N' or id=='A1Z2' or id=='A1Z3' or id=='A205' or id=='A14A' or id=='A269' or id=='A2KG' or id=='A2NI' or id=='A27X' or id=='A28Y' or id=='A24E' or id=='A1ZH' or id=='A1WO' or id=='A1FQ' or id=='A0TE' or id=='A2JO' or id=='A2FX' or id=='A0MP' or id=='A2KE' or id=='A2KH' or id=='A2K9' or id=='A2JL' or id=='A2N1' or id=='A2MB' or id=='A2O2' or id=='A2O9' or id=='A2TH' or id=='A2TK' or id=='A2LI' or id=='A1C0' or id=='A2XK'
endfunction
function V91 takes nothing returns nothing
set EC0=EC0+1
set EB0[EC0]='A0H6'
set EC0=EC0+1
set EB0[EC0]='A012'
set EC0=EC0+1
set EB0[EC0]='A06K'
set EC0=EC0+1
set EB0[EC0]='A0I9'
set EC0=EC0+1
set EB0[EC0]='A0HA'
set EC0=EC0+1
set EB0[EC0]='A0K5'
set EC0=EC0+1
set EB0[EC0]='A0PY'
set EC0=EC0+1
set EB0[EC0]='A1FO'
set EC0=EC0+1
set EB0[EC0]='A2XJ'
set EC0=EC0+1
set EB0[EC0]='A0SA'
set EC0=EC0+1
set EB0[EC0]='A0T7'
set EC0=EC0+1
set EB0[EC0]='A0T8'
set EC0=EC0+1
set EB0[EC0]='A14A'
set EC0=EC0+1
set EB0[EC0]='A0BE'
set EC0=EC0+1
set EB0[EC0]='A21X'
set EC0=EC0+1
set EB0[EC0]='A21W'
set EC0=EC0+1
set EB0[EC0]='A21V'
set EC0=EC0+1
set EB0[EC0]='Anh1'
set EC0=EC0+1
set EB0[EC0]='A1OZ'
set EC0=EC0+1
set EB0[EC0]='A13D'
set EC0=EC0+1
set EB0[EC0]='A026'
set EC0=EC0+1
set EB0[EC0]='A1Q8'
endfunction
function VA1 takes nothing returns nothing
set T2[1]='AImt'
set T2[2]='AIda'
set T2[3]='ANtm'
set T2[4]='A2V4'
set T2[5]='AIxk'
set T2[6]='A0CK'
set T2[7]='A017'
set T2[8]='A0B8'
set T2[9]='A0HB'
set T2[10]='A0D3'
set T2[10]='A0DF'
set T2[11]='A02W'
set T2[12]='AIpr'
set T2[13]='AIpl'
set T2[14]='A0FO'
set T2[15]='A0H7'
set T2[16]='A0H6'
set T2[17]='A02X'
set T2[18]='AIsw'
set T2[19]='A0CX'
set T2[20]='A0B6'
set T2[21]='Aeat'
set T2[22]='A08L'
set T2[23]='AIcy'
set T2[24]='A05Z'
set T2[25]='AIbk'
set T2[26]='A0DY'
set T2[27]='A0LZ'
set T2[28]='A0OI'
set T2[29]='A0KX'
set T2[30]='A0KW'
set T2[31]='A026'
set T2[32]='A0C4'
set T2[33]='A012'
set T2[34]='A06K'
set T2[35]='A02T'
set T2[36]='AHfa'
set T2[37]='A09V'
set T2[38]='A05Y'
set T2[39]='A0I9'
set T2[40]='A0HA'
set T2[41]='A0K5'
set T2[42]='A0PY'
set T2[43]='A0QN'
set T2[44]='A2XJ'
set T2[45]='A0RP'
set T2[46]='A12W'
set T2[47]='A0SA'
set T2[48]='A0T7'
set T2[49]='A0T8'
set T2[50]='A14A'
set T2[51]='A0BE'
set T2[52]='A21X'
set T2[53]='A21W'
set T2[54]='A21V'
set T2[55]='A0MP'
set T2[56]='A13D'
set T2[57]='A0JY'
set T2[58]='A15W'
set T2[59]='A1FO'
set T2[60]='A1FD'
set T2[61]='A1OZ'
set T2[62]='A1MO'
set T2[63]='A1IO'
set T2[64]='A1Q8'
set T2[65]='A1RA'
set T2[66]='A1QV'
set T2[67]='A1WE'
set T2[68]='A1WB'
set T2[69]='A2KG'
set T2[70]='A2N3'
set T2[71]='A2UM'
set T2[72]='A2VE'
set R2=72
endfunction
function VB1 takes nothing returns boolean
call VA1()
call V91()
call V71()
return false
endfunction
function VD1 takes nothing returns nothing
call CreateQuestBJ(0,"TRIGSTR_50004","TRIGSTR_50005","ReplaceableTextures\\CommandButtons\\BTNSpy.blp")
call CreateQuestBJ(0,"TRIGSTR_50006","TRIGSTR_50007","ReplaceableTextures\\CommandButtons\\BTNTome.blp")
call CreateQuestBJ(0,"TRIGSTR_50008","TRIGSTR_50009","ReplaceableTextures\\CommandButtons\\BTNAmbush.blp")
call CreateQuestBJ(2,"TRIGSTR_50010","TRIGSTR_50011","ReplaceableTextures\\CommandButtons\\BTNScrollOfHaste.blp")
call CreateQuestBJ(2,"TRIGSTR_50012","TRIGSTR_50013","ReplaceableTextures\\CommandButtons\\BTNBansheeMaster.blp")
call CreateQuestBJ(2,"TRIGSTR_50014","TRIGSTR_50015","ReplaceableTextures\\CommandButtons\\BTNCarrionScarabs.blp")
endfunction
function VF1 takes nothing returns boolean
local string s
if IsUnitIllusion(GetTriggerUnit())==false and V51(GetUnitTypeId(GetTriggerUnit()))==false then
set s=GetUnitName(GetTriggerUnit())+" "+"学习了"+" "+GetObjectName(GetLearnedSkill())+" ("+"level"+" "+I2S(GetUnitAbilityLevel(GetTriggerUnit(),GetLearnedSkill()))+")"
call DisplayTimedTextToPlayer(D60,0,0,3,s)
call DisplayTimedTextToPlayer(D70,0,0,3,s)
endif
return false
endfunction
function VG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function VF1))
set t=null
endfunction
function VH1 takes nothing returns nothing
call QRI(bj_FORCE_ALL_PLAYERS,25.00,(D80[GetPlayerId((GetTriggerPlayer()))])+"|c00ff0303 "+"离开了游戏"+"|r")
endfunction
function VZ1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player VV1=(LoadPlayerHandle(LY,(handle_id),(78)))
local integer TGI=1
local integer VW1
local integer ROI=GetPlayerState(VV1,PLAYER_STATE_RESOURCE_GOLD)
if RX0[GetPlayerId(VV1)]==false and JL==true then
if GetTriggerEvalCount(t)==4 then
if IsPlayerAlly(GetLocalPlayer(),VV1)==true then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,6,"如果你想使用离开玩家英雄的物品/金钱，请使用 -unlock")
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,6,"一旦你这么做，你将无法再与敌方玩家交换那名离开玩家的位置")
endif
endif
return false
endif
if ROI>20 then
call SetPlayerState(VV1,PLAYER_STATE_RESOURCE_GOLD,0)
set EL0[GetPlayerId(VV1)]=0
if IsPlayerTeam1(VV1)then
set VW1=T8I(OO)
else
set VW1=T8I(AO)
endif
if IsPlayerTeam1(VV1)then
loop
exitwhen TGI>5
if T3I(BO[TGI])then
call SetPlayerState(BO[TGI],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(BO[TGI],PLAYER_STATE_RESOURCE_GOLD)+ROI/VW1)
endif
set TGI=TGI+1
endloop
else
loop
exitwhen TGI>5
if T3I(CO[TGI])then
call SetPlayerState(CO[TGI],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(CO[TGI],PLAYER_STATE_RESOURCE_GOLD)+ROI/VW1)
endif
set TGI=TGI+1
endloop
endif
endif
return false
endfunction
function VX1 takes player VV1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SavePlayerHandle(LY,(handle_id),(78),(VV1))
call TriggerRegisterTimerEvent(t,2,true)
call TriggerAddCondition(t,Condition(function VZ1))
set t=null
endfunction
function VY1 takes player p returns nothing
local multiboarditem N8I=MultiboardGetItem(M0,S50[GetPlayerId(p)],S40[GetPlayerId(p)])
call MultiboardSetItemValue(N8I,"|c00333333"+(D80[GetPlayerId((p))])+"|r")
call MultiboardReleaseItem(N8I)
endfunction
function VJ1 takes nothing returns nothing
local integer ZB1=T8I(OO)
local integer ZA1=T8I(AO)
local integer TGI
local integer THI
local string GW1
local string DD0
local unit SFI=K1[GetPlayerId(GetTriggerPlayer())]
if SFI==null then
set DD0="没有英雄"
else
set DD0=GetUnitName(SFI)
endif
if(Z0<10)then
set GW1=I2S(H0)+":0"+I2S(Z0)
else
set GW1=I2S(H0)+":"+I2S(Z0)
endif
if Q2==false then
set K3[GetPlayerId(GetTriggerPlayer())]="|c00555555"+GW1+"|r"
call QRI(bj_FORCE_ALL_PLAYERS,25.00,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+" ("+DD0+")|r|c00ff0303 "+"离开了游戏"+"|r")
if(IsPlayerTeam1(GetTriggerPlayer())==true)then
set TGI=1
set THI=5
loop
exitwhen TGI>THI
if(BO[TGI]!=GetTriggerPlayer())then
if(T3I(BO[TGI])==true)then
call SetPlayerAllianceStateBJ(GetTriggerPlayer(),BO[TGI],4)
endif
endif
set TGI=TGI+1
endloop
else
set TGI=1
set THI=5
loop
exitwhen TGI>THI
if(CO[TGI]!=GetTriggerPlayer())then
if(T3I(CO[TGI])==true)then
call SetPlayerAllianceStateBJ(GetTriggerPlayer(),CO[TGI],4)
endif
endif
set TGI=TGI+1
endloop
endif
if IsPlayerTeam1(GetTriggerPlayer())or IsPlayerTeam2(GetTriggerPlayer())then
set EG0=EG0+1
endif
call FL1("C"+"K"+I2S(A[GetPlayerId(GetTriggerPlayer())])+"D"+I2S(B[GetPlayerId(GetTriggerPlayer())])+"N"+I2S((LoadInteger(LY,(400+GetPlayerId(GetTriggerPlayer())),(79)))),GetPlayerId(GetTriggerPlayer()))
set RO0=GetTriggerPlayer()
call ExecuteFunc("VK1")
if JL then
call B91(GetTriggerPlayer())
endif
set EF0[GetPlayerId(GetTriggerPlayer())]=true
call VY1(GetTriggerPlayer())
call VX1(GetTriggerPlayer())
if EG0==2 and C2==false and VL==true then
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60," ")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60," ")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60,"|c006699CC"+"提示：-switch命令可以重新排列玩家队伍，条件是所有玩家都同意"+"|r")
endif
if EG0==3 then
set RI0=true
call ExecuteFunc("VL1")
set RI0=false
endif
else
set K3[GetPlayerId(GetTriggerPlayer())]="|c00555555End|r"
call ExecuteFunc("VM1")
endif
endfunction
function VS1 takes unit SFI returns nothing
if GetUnitTypeId(SFI)!='H00J' and GetUnitTypeId(SFI)!='H00I' then
if GetOwningPlayer(SFI)==GetLocalPlayer()then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,1," ")
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,1,"|c006699CC"+"你的英雄已经重生了")
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,1," ")
endif
call OQ1(KE,GetOwningPlayer(SFI))
endif
call SetUnitInvulnerable(SFI,false)
call UnitRemoveAbility(SFI,'A0AZ')
call UnitRemoveAbility(SFI,'A09J')
call UnitRemoveAbility(SFI,'A0KT')
call UnitRemoveAbility(SFI,'A0NW')
call UnitRemoveAbility(SFI,'A0NU')
call UnitRemoveAbility(SFI,'A0OW')
call UnitRemoveAbility(SFI,'A0OV')
call UnitRemoveAbility(SFI,'A0OX')
call UnitRemoveAbility(SFI,'A0OY')
call UnitRemoveAbility(SFI,'A0P0')
call UnitRemoveAbility(SFI,'A17K')
call UnitRemoveAbility(SFI,'A0PV')
call UnitRemoveAbility(SFI,'A0QO')
call UnitRemoveAbility(SFI,'A0RC')
call UnitRemoveAbility(SFI,'A0RF')
call UnitRemoveAbility(SFI,FN)
call UnitRemoveAbility(SFI,GN)
call UnitRemoveAbility(SFI,HN)
call UnitRemoveAbility(SFI,ZN)
call UnitRemoveAbility(SFI,'A0NU')
call UnitRemoveAbility(SFI,'A0NW')
call UnitRemoveAbility(SFI,N90)
call UnitRemoveAbility(SFI,'A0I5')
call UnitRemoveAbility(SFI,'A0C9')
call UnitRemoveAbility(SFI,'A0IH')
call UnitRemoveAbility(SFI,'B067')
call UnitRemoveAbility(SFI,'B08L')
call UnitRemoveAbility(SFI,'A0SR')
call UnitRemoveAbility(SFI,'A0WO')
call UnitRemoveAbility(SFI,'A0WR')
call UnitRemoveAbility(SFI,'A1CN')
call UnitRemoveAbility(SFI,'A0VH')
call UnitRemoveAbility(SFI,'A0VJ')
call UnitRemoveAbility(SFI,'A109')
call UnitRemoveAbility(SFI,'A0VW')
call UnitRemoveAbility(SFI,'A0XM')
call UnitRemoveAbility(SFI,'A11O')
call UnitRemoveAbility(SFI,'A11R')
call UnitRemoveAbility(SFI,'A147')
call UnitRemoveAbility(SFI,'A148')
call UnitRemoveAbility(SFI,'A11U')
call UnitRemoveAbility(SFI,'A149')
call UnitRemoveAbility(SFI,'A121')
call UnitRemoveAbility(SFI,'A126')
call UnitRemoveAbility(SFI,'A179')
call UnitRemoveAbility(SFI,'Aetl')
call UnitRemoveAbility(SFI,WN[0])
call UnitRemoveAbility(SFI,WN[1])
call UnitRemoveAbility(SFI,WN[2])
call UnitRemoveAbility(SFI,WN[3])
call UnitRemoveAbility(SFI,WN[4])
call UnitRemoveAbility(SFI,WN[5])
call UnitRemoveAbility(SFI,'A1G5')
call UnitRemoveAbility(SFI,'A1G3')
call UnitRemoveAbility(SFI,'A1G6')
call UnitRemoveAbility(SFI,'A1G4')
call SaveBoolean(LY,(GetHandleId(SFI)),(80),(false))
call SetUnitPathing(SFI,true)
call PauseUnit(SFI,false)
call SetUnitFlyHeight(SFI,GetUnitDefaultFlyHeight(SFI),0)
call SetUnitScale(SFI,SMI(SFI)*OAI,SMI(SFI)*OAI,SMI(SFI)*OAI)
call UnitRemoveAbility(SFI,'A1CA')
call UnitRemoveAbility(SFI,'A1C9')
call UnitRemoveAbility(SFI,'A1CB')
call UnitRemoveAbility(SFI,'A1CC')
call UnitRemoveAbility(SFI,'A1GA')
call UnitRemoveAbility(SFI,'A1W3')
call UnitRemoveAbility(SFI,'B0DO')
call UnitRemoveAbility(SFI,'A1UH')
call UnitRemoveAbility(SFI,'A1UI')
call UnitRemoveAbility(SFI,'A1Z4')
call UnitRemoveAbility(SFI,'A1ZA')
call UnitRemoveAbility(SFI,'A1ZB')
call UnitRemoveAbility(SFI,'A1Z9')
call UnitRemoveAbility(SFI,'B0DV')
call UnitRemoveAbility(SFI,'A266')
call UnitRemoveAbility(SFI,'A265')
call UnitRemoveAbility(SFI,'A24L')
call UnitRemoveAbility(SFI,'B0ED')
call UnitRemoveAbility(SFI,'A23O')
call UnitRemoveAbility(SFI,'B0E9')
call GA1(SFI,0)
if GetUnitTypeId(SFI)=='E02N' or GetUnitTypeId(SFI)=='E02O' then
call UnitRemoveAbility(SFI,'A237')
call UnitAddAbility(SFI,'A22B')
call UnitRemoveAbility(SFI,'A22B')
if ES1(SFI,FR0[KN0])!=null then
call UnitAddAbility(SFI,'A237')
endif
endif
if GetUnitTypeId(SFI)=='N0MU' or GetUnitTypeId(SFI)=='N0MW' then
call UnitAddAbility(SFI,'A2QR')
call UnitRemoveAbility(SFI,'A2QR')
endif
if GetUnitTypeId(SFI)=='H0EL' or GetUnitTypeId(SFI)=='H0EO' then
call UnitAddAbility(SFI,'A2SX')
call UnitRemoveAbility(SFI,'A2SX')
endif
if GetUnitTypeId(SFI)=='H0ER' then
call UnitAddAbility(SFI,'A2VV')
call UnitRemoveAbility(SFI,'A2VV')
endif
call UnitRemoveAbility(SFI,'A2WL')
call UnitRemoveAbility(SFI,'A23F')
call UnitRemoveAbility(SFI,'A2WK')
call UnitRemoveAbility(SFI,'A2WJ')
call UnitRemoveAbility(SFI,'A2S1')
call BS1(SFI)
set GK=SFI
call ExecuteFunc("VT1")
endfunction
function VP1 takes nothing returns boolean
if GetPlayerAlliance(GetOwningPlayer(GetFilterUnit()),EZ0,ALLIANCE_SHARED_CONTROL)==true and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false then
set EH0=EH0+1
endif
return false
endfunction
function VQ1 takes unit u,player p,real x,real y,boolean VU1 returns nothing
local group g=NTI()
set EH0=0
set EZ0=p
call GroupEnumUnitsSelected(g,p,Condition(function VP1))
if EH0==0 and GetLocalPlayer()==p then
if VU1==false then
call ClearSelection()
call SelectUnit(u,true)
endif
call PanCameraToTimed(x,y,0)
endif
set EH0=0
call NSI(g)
set g=null
endfunction
function W01 takes unit AD1 returns boolean
return GetUnitTypeId(AD1)=='H00I' or GetUnitTypeId(AD1)=='H00J'
endfunction
function WI1 takes unit W11 returns nothing
local integer WO1
if ES1(W11,FR0[WM0])!=null and GetUnitTypeId(W11)!='H00J' then
set WO1=R2I(GetItemCharges(ES1(W11,FR0[WM0]))*0.67)
if GetItemCharges(ES1(W11,FR0[WM0]))==1 then
set WO1=0
endif
call SetItemCharges(ES1(W11,FR0[WM0]),WO1)
call AddHeroXP(W11,GetHeroXP(M70[GetPlayerId(GetOwningPlayer(W11))]),true)
call RemoveUnit(M70[GetPlayerId(GetOwningPlayer(W11))])
endif
endfunction
function W21 takes unit W31 returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(W31))
local unit W41=(LoadUnitHandle(LY,(handle_id),(699)))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
local unit W91
set W91=W41
if W91!=null then
call RemoveUnit(W91)
endif
set W91=W51
if W91!=null then
call RemoveUnit(W91)
endif
set W91=W61
if W91!=null then
call RemoveUnit(W91)
endif
set W91=W71
if W91!=null then
call RemoveUnit(W91)
endif
set W91=W81
if W91!=null then
call RemoveUnit(W91)
endif
endfunction
function WA1 takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
set NR0=false
return false
endfunction
function WB1 takes unit WC1 returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(WC1))
local unit W41=(LoadUnitHandle(LY,(handle_id),(699)))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
local unit W91
local real x=GetUnitX(W41)
local real y=GetUnitY(W41)
local trigger t
if NR0==false then
if IsPlayerTeam1(GetOwningPlayer(W41))then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
else
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,2,false)
call TriggerAddCondition(t,Condition(function WA1))
endif
set W91=W41
if W91!=null and WC1!=W91 then
call ReviveHero(W91,x,y,false)
call MUSetUnitX(W91,x)
call MUSetUnitY(W91,y)
call VS1(W91)
call SetUnitPathing(W91,true)
call SetUnitState(W91,UNIT_STATE_MANA,10000)
endif
set W91=W51
if W91!=null and WC1!=W91 then
call ReviveHero(W91,x,y,false)
call MUSetUnitX(W91,x)
call MUSetUnitY(W91,y)
call VS1(W91)
call SetUnitPathing(W91,true)
call SetUnitState(W91,UNIT_STATE_MANA,10000)
endif
set W91=W61
if W91!=null and WC1!=W91 then
call ReviveHero(W91,x,y,false)
call MUSetUnitX(W91,x)
call MUSetUnitY(W91,y)
call VS1(W91)
call SetUnitPathing(W91,true)
call SetUnitState(W91,UNIT_STATE_MANA,10000)
endif
set W91=W71
if W91!=null and WC1!=W91 then
call ReviveHero(W91,x,y,false)
call MUSetUnitX(W91,x)
call MUSetUnitY(W91,y)
call VS1(W91)
call SetUnitPathing(W91,true)
call SetUnitState(W91,UNIT_STATE_MANA,10000)
endif
set W91=W81
if W91!=null and WC1!=W91 then
call ReviveHero(W91,x,y,false)
call MUSetUnitX(W91,x)
call MUSetUnitY(W91,y)
call VS1(W91)
call SetUnitPathing(W91,true)
call SetUnitState(W91,UNIT_STATE_MANA,10000)
endif
endfunction
function WD1 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local player T4I=GetOwningPlayer(PKI)
local real x
local real y
local integer WO1
set XS[GetPlayerId((T4I))]=false
set HJ[GetPlayerId(GetOwningPlayer((PKI)))]=false
if IsPlayerTeam1(GetOwningPlayer(PKI))then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
if LW0 then
set YS[GetPlayerId(T4I)]=R2I(TimerGetRemaining(F0[GetPlayerId(T4I)])*0.25)
set JS[GetPlayerId(T4I)]=(TimerGetElapsed(M))+TimerGetRemaining(F0[GetPlayerId(T4I)])
else
set YS[GetPlayerId(T4I)]=0
endif
call TimerStart(F0[GetPlayerId(T4I)],0.0,false,null)
if W01(PKI)then
call WB1(PKI)
else
call VQ1(PKI,T4I,x,y,false)
endif
call MUSetUnitX(PKI,x)
call MUSetUnitY(PKI,y)
call VS1(PKI)
call SetUnitPathing(PKI,true)
if ES1(PKI,FR0[WM0])!=null and GetUnitTypeId(PKI)!='H00J' then
set WO1=(R2I(((GetItemCharges(ES1(PKI,FR0[WM0]))*0.67)*1.0)))
if GetItemCharges(ES1(PKI,FR0[WM0]))==1 then
set WO1=0
endif
call SetItemCharges(ES1(PKI,FR0[WM0]),WO1)
call AddHeroXP(PKI,GetHeroXP(M70[GetPlayerId(GetOwningPlayer(PKI))]),true)
call RemoveUnit(M70[GetPlayerId(GetOwningPlayer(PKI))])
endif
endfunction
function WF1 takes unit SFI returns nothing
local integer WG1=GetUnitPointValue(SFI)
local unit WH1
if(WG1==34)then
call ExecuteFunc("WZ1")
call ExecuteFunc("WV1")
call ExecuteFunc("WW1")
elseif(WG1==37)then
call ExecuteFunc("WX1")
call ExecuteFunc("WY1")
call ExecuteFunc("WJ1")
call ExecuteFunc("WK1")
elseif(WG1==38)then
call ExecuteFunc("WL1")
call ExecuteFunc("WM1")
call ExecuteFunc("WN1")
call ExecuteFunc("WS1")
elseif(WG1==32)then
call ExecuteFunc("WT1")
call ExecuteFunc("WR1")
call ExecuteFunc("WP1")
call ExecuteFunc("WQ1")
elseif(WG1==52)then
call ExecuteFunc("WU1")
call ExecuteFunc("X01")
call ExecuteFunc("XI1")
call ExecuteFunc("X11")
elseif(WG1==31)then
call ExecuteFunc("XO1")
call ExecuteFunc("X21")
call ExecuteFunc("X31")
elseif(WG1==24)then
call ExecuteFunc("X41")
call ExecuteFunc("X51")
call ExecuteFunc("X61")
call ExecuteFunc("X71")
elseif(WG1==5)then
call ExecuteFunc("X81")
call ExecuteFunc("X91")
call ExecuteFunc("XA1")
call ExecuteFunc("XB1")
elseif(WG1==8)then
call ExecuteFunc("XC1")
call ExecuteFunc("XD1")
call ExecuteFunc("XE1")
call ExecuteFunc("XF1")
call ExecuteFunc("XG1")
elseif(WG1==3)then
call ExecuteFunc("XH1")
call ExecuteFunc("XZ1")
call ExecuteFunc("XV1")
call ExecuteFunc("XW1")
elseif(WG1==95)then
call ExecuteFunc("XX1")
call ExecuteFunc("XY1")
call ExecuteFunc("XJ1")
call ExecuteFunc("XK1")
elseif(WG1==20)then
call ExecuteFunc("XL1")
call ExecuteFunc("XM1")
call ExecuteFunc("XN1")
call ExecuteFunc("XS1")
elseif(WG1==12)then
call ExecuteFunc("XT1")
call ExecuteFunc("XR1")
call ExecuteFunc("XP1")
elseif(WG1==16)then
call ExecuteFunc("XQ1")
call ExecuteFunc("XU1")
call ExecuteFunc("Y01")
call ExecuteFunc("YI1")
call ExecuteFunc("Y11")
call ExecuteFunc("YO1")
call ExecuteFunc("Y21")
elseif(WG1==25)then
call ExecuteFunc("Y31")
call ExecuteFunc("Y41")
elseif(WG1==4)then
call ExecuteFunc("Y51")
call ExecuteFunc("Y61")
call ExecuteFunc("Y71")
call ExecuteFunc("Y81")
call ExecuteFunc("Y91")
call SetUnitPathing(SFI,false)
call MUDisableItemTrigger()
set TQ0=true
set WH1=CreateUnit(GetOwningPlayer(SFI),GetUnitTypeId(SFI),GetUnitX(SFI),GetUnitY(SFI),GetUnitFacing(SFI))
call SaveBoolean(LY,(GetHandleId(WH1)),(85),(true))
set K1[GetPlayerId(GetOwningPlayer(SFI))]=WH1
call SetUnitPathing(WH1,false)
call SetUnitPosition(WH1,GetUnitX(SFI),GetUnitY(SFI))
if X0 then
call SetHeroXP(WH1,GetHeroXP(SFI),false)
call UnitAddItem(WH1,UnitItemInSlot(SFI,0))
call UnitAddItem(WH1,UnitItemInSlot(SFI,1))
call UnitAddItem(WH1,UnitItemInSlot(SFI,2))
call UnitAddItem(WH1,UnitItemInSlot(SFI,3))
call UnitAddItem(WH1,UnitItemInSlot(SFI,4))
call UnitAddItem(WH1,UnitItemInSlot(SFI,5))
endif
call Q5I(SFI)
call MUEnableItemTrigger()
call SetUnitPathing(WH1,true)
call ClearSelectionForPlayer(GetOwningPlayer(WH1))
call SelectUnitAddForPlayer(WH1,GetOwningPlayer(WH1))
elseif(WG1==7)then
call ExecuteFunc("YA1")
call ExecuteFunc("YB1")
call ExecuteFunc("YC1")
elseif(WG1==18)then
call ExecuteFunc("YD1")
call ExecuteFunc("YE1")
elseif(WG1==36)then
call ExecuteFunc("YF1")
elseif(WG1==21)then
call ExecuteFunc("YG1")
call ExecuteFunc("YH1")
call ExecuteFunc("YZ1")
call ExecuteFunc("YV1")
elseif(WG1==14)then
call ExecuteFunc("YW1")
call ExecuteFunc("YX1")
call ExecuteFunc("YY1")
call ExecuteFunc("YJ1")
call ExecuteFunc("YK1")
call ExecuteFunc("YL1")
elseif(WG1==13)then
call ExecuteFunc("YM1")
call ExecuteFunc("YN1")
call ExecuteFunc("GS")
call ExecuteFunc("YS1")
elseif(WG1==26)then
call ExecuteFunc("YT1")
call ExecuteFunc("YR1")
call ExecuteFunc("YP1")
call ExecuteFunc("YQ1")
elseif(WG1==9)then
call ExecuteFunc("YU1")
call ExecuteFunc("J01")
call ExecuteFunc("JI1")
call ExecuteFunc("J11")
elseif(WG1==10)then
call ExecuteFunc("JO1")
call ExecuteFunc("J21")
call ExecuteFunc("J31")
call ExecuteFunc("J41")
call ExecuteFunc("J51")
call ExecuteFunc("J61")
call ExecuteFunc("J71")
call ExecuteFunc("J81")
elseif(WG1==23)then
call ExecuteFunc("J91")
call ExecuteFunc("JA1")
call ExecuteFunc("JB1")
call ExecuteFunc("JC1")
call ExecuteFunc("JD1")
elseif(WG1==19)then
call ExecuteFunc("JE1")
call ExecuteFunc("JF1")
call ExecuteFunc("JG1")
call ExecuteFunc("JH1")
elseif(WG1==22)then
call ExecuteFunc("JZ1")
call ExecuteFunc("JV1")
call ExecuteFunc("JW1")
call ExecuteFunc("JX1")
elseif(WG1==17)then
call ExecuteFunc("JY1")
call ExecuteFunc("JJ1")
call ExecuteFunc("JK1")
elseif(WG1==1)then
call ExecuteFunc("JL1")
call ExecuteFunc("JM1")
call ExecuteFunc("JN1")
call ExecuteFunc("JS1")
elseif(WG1==2)then
call ExecuteFunc("JT1")
call ExecuteFunc("JR1")
call ExecuteFunc("JP1")
call ExecuteFunc("JQ1")
elseif(WG1==27)then
call ExecuteFunc("JU1")
call ExecuteFunc("K01")
call ExecuteFunc("KI1")
call ExecuteFunc("K11")
call ExecuteFunc("KO1")
elseif(WG1==82)then
call ExecuteFunc("K21")
call ExecuteFunc("K31")
call ExecuteFunc("K41")
call ExecuteFunc("K51")
elseif(WG1==75)then
call ExecuteFunc("K61")
call ExecuteFunc("K71")
call ExecuteFunc("K81")
elseif(WG1==83)then
call ExecuteFunc("K91")
call ExecuteFunc("KA1")
call ExecuteFunc("KB1")
call ExecuteFunc("KC1")
elseif(WG1==112)then
call ExecuteFunc("KD1")
call ExecuteFunc("KE1")
call ExecuteFunc("KF1")
elseif(WG1==108)then
call ExecuteFunc("KG1")
call ExecuteFunc("KH1")
call ExecuteFunc("KZ1")
elseif(WG1==69)then
call ExecuteFunc("KV1")
call ExecuteFunc("KW1")
call ExecuteFunc("KX1")
call ExecuteFunc("KY1")
call ExecuteFunc("KJ1")
elseif(WG1==100)then
call ExecuteFunc("KK1")
call ExecuteFunc("KL1")
call ExecuteFunc("KM1")
call ExecuteFunc("KN1")
elseif(WG1==102)then
call ExecuteFunc("KS1")
call ExecuteFunc("KT1")
call ExecuteFunc("KR1")
elseif(WG1==64)then
call ExecuteFunc("KP1")
call ExecuteFunc("KQ1")
call ExecuteFunc("KU1")
call ExecuteFunc("L01")
elseif(WG1==106)then
call ExecuteFunc("LI1")
call ExecuteFunc("L11")
call ExecuteFunc("LO1")
elseif(WG1==61)then
call ExecuteFunc("L21")
call ExecuteFunc("L31")
call ExecuteFunc("L41")
elseif(WG1==76)then
call ExecuteFunc("L51")
call ExecuteFunc("L61")
call ExecuteFunc("L71")
call ExecuteFunc("L81")
elseif(WG1==80)then
call ExecuteFunc("L91")
call ExecuteFunc("LA1")
call ExecuteFunc("LB1")
call ExecuteFunc("LC1")
call ExecuteFunc("NL")
elseif(WG1==62)then
call ExecuteFunc("LD1")
call ExecuteFunc("LE1")
call ExecuteFunc("LF1")
call ExecuteFunc("LG1")
elseif(WG1==60)then
call ExecuteFunc("LH1")
call ExecuteFunc("LZ1")
call ExecuteFunc("LV1")
elseif(WG1==77)then
call ExecuteFunc("LW1")
call ExecuteFunc("LX1")
call ExecuteFunc("LY1")
call ExecuteFunc("LJ1")
elseif(WG1==73)then
call ExecuteFunc("NW")
call ExecuteFunc("LK1")
call ExecuteFunc("LL1")
elseif(WG1==81)then
call ExecuteFunc("LM1")
call ExecuteFunc("LN1")
call ExecuteFunc("LS1")
elseif(WG1==66)then
call ExecuteFunc("LT1")
call ExecuteFunc("LR1")
elseif(WG1==78)then
call ExecuteFunc("LP1")
call ExecuteFunc("LQ1")
call ExecuteFunc("LU1")
call ExecuteFunc("M01")
elseif(WG1==99)then
call ExecuteFunc("MI1")
call ExecuteFunc("M11")
call ExecuteFunc("MO1")
call ExecuteFunc("M21")
call ExecuteFunc("M31")
call ExecuteFunc("M41")
elseif(WG1==74)then
call ExecuteFunc("M51")
call ExecuteFunc("M61")
call ExecuteFunc("M71")
call ExecuteFunc("M81")
elseif(WG1==105)then
call ExecuteFunc("M91")
call ExecuteFunc("MA1")
call ExecuteFunc("MB1")
elseif(WG1==70)then
call ExecuteFunc("MC1")
call ExecuteFunc("MD1")
call ExecuteFunc("ME1")
elseif(WG1==107)then
call ExecuteFunc("MF1")
call ExecuteFunc("MG1")
call ExecuteFunc("MH1")
call ExecuteFunc("MZ1")
elseif(WG1==79)then
call ExecuteFunc("MV1")
call ExecuteFunc("MW1")
call ExecuteFunc("MX1")
call ExecuteFunc("MY1")
elseif(WG1==68)then
call ExecuteFunc("MJ1")
call ExecuteFunc("MK1")
elseif(WG1==84)then
call ExecuteFunc("ML1")
call ExecuteFunc("MM1")
call ExecuteFunc("MN1")
call ExecuteFunc("MS1")
elseif(WG1==85)then
call ExecuteFunc("MT1")
call ExecuteFunc("MR1")
call ExecuteFunc("MP1")
call ExecuteFunc("MQ1")
call ExecuteFunc("MU1")
elseif(WG1==86)then
call ExecuteFunc("N01")
call ExecuteFunc("NI1")
call ExecuteFunc("N11")
call ExecuteFunc("NO1")
elseif(WG1==87)then
call ExecuteFunc("N21")
call ExecuteFunc("N31")
call ExecuteFunc("N41")
call ExecuteFunc("N51")
elseif(WG1==33)then
call ExecuteFunc("N61")
call ExecuteFunc("N71")
call ExecuteFunc("N81")
elseif(WG1==39)then
call ExecuteFunc("N91")
call ExecuteFunc("NA1")
call ExecuteFunc("NB1")
elseif(WG1==88)then
call ExecuteFunc("NC1")
call ExecuteFunc("ND1")
call ExecuteFunc("NE1")
call ExecuteFunc("NF1")
elseif(WG1==40)then
call ExecuteFunc("NG1")
call ExecuteFunc("NH1")
call ExecuteFunc("NZ1")
call ExecuteFunc("NV1")
elseif WG1==89 then
call ExecuteFunc("NW1")
call ExecuteFunc("NX1")
elseif WG1==90 then
call ExecuteFunc("NY1")
call ExecuteFunc("NJ1")
call ExecuteFunc("NK1")
call ExecuteFunc("NL1")
elseif WG1==71 then
call ExecuteFunc("NM1")
call ExecuteFunc("NN1")
call ExecuteFunc("NS1")
call ExecuteFunc("NT1")
elseif WG1==93 then
call ExecuteFunc("NR1")
call ExecuteFunc("NP1")
call ExecuteFunc("NQ1")
call ExecuteFunc("NU1")
elseif WG1==42 then
call ExecuteFunc("S01")
call ExecuteFunc("SI1")
call ExecuteFunc("S11")
call ExecuteFunc("SO1")
elseif WG1==91 then
call ExecuteFunc("S21")
call ExecuteFunc("S31")
call ExecuteFunc("S41")
call ExecuteFunc("S51")
call ExecuteFunc("S61")
call ExecuteFunc("S71")
call ExecuteFunc("S81")
call ExecuteFunc("S91")
elseif WG1==92 then
call ExecuteFunc("SA1")
call ExecuteFunc("SB1")
call ExecuteFunc("SC1")
call ExecuteFunc("SD1")
elseif WG1==41 then
call ExecuteFunc("SE1")
call ExecuteFunc("SF1")
call ExecuteFunc("SG1")
call ExecuteFunc("SH1")
call ExecuteFunc("SZ1")
elseif WG1==43 then
call ExecuteFunc("SV1")
call ExecuteFunc("SW1")
call ExecuteFunc("SX1")
call ExecuteFunc("SY1")
elseif WG1==44 then
call ExecuteFunc("SJ1")
call ExecuteFunc("SK1")
call ExecuteFunc("SL1")
call ExecuteFunc("SM1")
elseif WG1==72 then
call ExecuteFunc("SN1")
call ExecuteFunc("SS1")
call ExecuteFunc("ST1")
call ExecuteFunc("SR1")
elseif WG1==94 then
call ExecuteFunc("SP1")
elseif WG1==6 then
call ExecuteFunc("SQ1")
call ExecuteFunc("SU1")
call ExecuteFunc("T01")
elseif WG1==104 then
call ExecuteFunc("TI1")
call ExecuteFunc("T11")
elseif WG1==65 then
call ExecuteFunc("TO1")
call ExecuteFunc("T21")
call ExecuteFunc("T31")
call ExecuteFunc("T41")
elseif WG1==111 then
call ExecuteFunc("T51")
call ExecuteFunc("T61")
call ExecuteFunc("T71")
elseif WG1==63 then
call ExecuteFunc("T81")
call ExecuteFunc("T91")
call ExecuteFunc("TA1")
call ExecuteFunc("TB1")
elseif WG1==45 then
call ExecuteFunc("TC1")
call ExecuteFunc("TD1")
call ExecuteFunc("TE1")
call ExecuteFunc("TF1")
elseif WG1==46 then
call ExecuteFunc("TG1")
call ExecuteFunc("TH1")
call ExecuteFunc("TZ1")
call ExecuteFunc("TV1")
elseif WG1==47 then
call ExecuteFunc("TW1")
call ExecuteFunc("TX1")
call ExecuteFunc("TY1")
call ExecuteFunc("TJ1")
elseif WG1==11 then
call ExecuteFunc("TK1")
call ExecuteFunc("TL1")
elseif WG1==96 then
call ExecuteFunc("TM1")
call ExecuteFunc("TN1")
call ExecuteFunc("TS1")
call ExecuteFunc("TT1")
elseif WG1==15 then
call ExecuteFunc("TR1")
call ExecuteFunc("TP1")
call ExecuteFunc("TQ1")
call ExecuteFunc("TU1")
elseif WG1==97 then
call ExecuteFunc("R01")
call ExecuteFunc("RI1")
call ExecuteFunc("R11")
call ExecuteFunc("RO1")
call ExecuteFunc("R21")
elseif WG1==98 then
call ExecuteFunc("R31")
call ExecuteFunc("R41")
call ExecuteFunc("R51")
call ExecuteFunc("R61")
call ExecuteFunc("R71")
elseif WG1==67 then
call ExecuteFunc("R81")
call ExecuteFunc("R91")
elseif WG1==28 then
call ExecuteFunc("RA1")
call ExecuteFunc("RB1")
elseif WG1==51 then
call ExecuteFunc("RC1")
call ExecuteFunc("RD1")
call ExecuteFunc("RE1")
call ExecuteFunc("RF1")
call ExecuteFunc("RG1")
call ExecuteFunc("RH1")
call ExecuteFunc("RZ1")
call ExecuteFunc("RV1")
elseif WG1==100 then
elseif WG1==101 then
call ExecuteFunc("RW1")
call ExecuteFunc("RX1")
call ExecuteFunc("RY1")
call ExecuteFunc("RJ1")
elseif WG1==48 then
call ExecuteFunc("RK1")
call ExecuteFunc("RL1")
call ExecuteFunc("RM1")
call ExecuteFunc("RN1")
elseif WG1==49 then
call ExecuteFunc("RS1")
call ExecuteFunc("RT1")
call ExecuteFunc("RR1")
call ExecuteFunc("RP1")
elseif WG1==29 then
call ExecuteFunc("RQ1")
call ExecuteFunc("RU1")
call ExecuteFunc("P01")
call ExecuteFunc("PI1")
elseif WG1==50 then
call ExecuteFunc("P11")
call ExecuteFunc("PO1")
call ExecuteFunc("P21")
call ExecuteFunc("P31")
elseif WG1==30 then
call ExecuteFunc("P41")
call ExecuteFunc("P51")
elseif WG1==53 then
call ExecuteFunc("P61")
call ExecuteFunc("P71")
call ExecuteFunc("P81")
call ExecuteFunc("P91")
elseif WG1==103 then
call ExecuteFunc("PA1")
elseif WG1==54 then
call ExecuteFunc("PB1")
call ExecuteFunc("PC1")
call ExecuteFunc("PD1")
call ExecuteFunc("PE1")
call ExecuteFunc("PF1")
elseif WG1==55 then
call ExecuteFunc("PG1")
call ExecuteFunc("PH1")
call ExecuteFunc("PZ1")
call ExecuteFunc("PV1")
elseif WG1==56 then
call ExecuteFunc("PW1")
call ExecuteFunc("PX1")
call ExecuteFunc("PY1")
call ExecuteFunc("PJ1")
elseif WG1==57 then
call ExecuteFunc("PK1")
call ExecuteFunc("PL1")
call ExecuteFunc("PM1")
call ExecuteFunc("PN1")
call ExecuteFunc("PS1")
elseif WG1==109 then
call ExecuteFunc("PT1")
call ExecuteFunc("PR1")
call ExecuteFunc("PP1")
call ExecuteFunc("PQ1")
call ExecuteFunc("PU1")
call ExecuteFunc("Q01")
elseif WG1==110 then
call ExecuteFunc("QI1")
call ExecuteFunc("Q11")
call ExecuteFunc("QO1")
call ExecuteFunc("Q21")
call ExecuteFunc("Q31")
elseif WG1==35 then
call ExecuteFunc("Q41")
call ExecuteFunc("Q51")
call ExecuteFunc("Q61")
elseif WG1==58 then
call ExecuteFunc("Q71")
call ExecuteFunc("Q81")
call ExecuteFunc("Q91")
call ExecuteFunc("QA1")
call ExecuteFunc("QB1")
call ExecuteFunc("QC1")
set GK=SFI
call ExecuteFunc("QD1")
elseif WG1==59 then
call ExecuteFunc("QE1")
call ExecuteFunc("QF1")
call ExecuteFunc("QG1")
call ExecuteFunc("QH1")
endif
endfunction
function QZ1 takes player MDI,string NII returns nothing
if IsPlayerInForce(GetLocalPlayer(),MCI(MDI))then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,U2,40,C0[GetPlayerId(MDI)]+(D80[GetPlayerId((MDI))])+"|r "+NII)
endif
endfunction
function Main_AllHasHero takes nothing returns boolean
return K1[GetPlayerId(BO[1])]!=null and K1[GetPlayerId(BO[2])]!=null and K1[GetPlayerId(BO[3])]!=null and K1[GetPlayerId(BO[4])]!=null and K1[GetPlayerId(BO[5])]!=null and K1[GetPlayerId(CO[1])]!=null and K1[GetPlayerId(CO[2])]!=null and K1[GetPlayerId(CO[3])]!=null and K1[GetPlayerId(CO[4])]!=null and K1[GetPlayerId(CO[5])]!=null
endfunction
function QV1 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
set EN=true
call FlushTrigger(t)
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_MASKED,PC0,PD0,700,false,false))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_MASKED,PC0,PD0,700,false,false))
set t=null
return false
endfunction
function QW1 takes unit u returns boolean
return GetUnitTypeId(u)!='H00M' and GetUnitTypeId(u)!='N0MM' and GetUnitTypeId(u)!='H07G' and GetUnitTypeId(u)!='H00Y' and GetUnitTypeId(u)!='H00J' and GetUnitTypeId(u)!='H0B8' and GetUnitTypeId(u)!='H0ES'
endfunction
function QX1 takes nothing returns boolean
return IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetTriggerUnit())==false and HaveSavedBoolean(LY,GetHandleId(GetTriggerUnit()),85)==false and QW1(GetTriggerUnit())
endfunction
function QY1 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='n00C'
endfunction
function QJ1 takes nothing returns nothing
call RemoveUnit(GetEnumUnit())
endfunction
function QK1 takes player T4I returns nothing
local group Z51=NTI()
local boolexpr QL1=Condition(function QY1)
call GroupEnumUnitsOfPlayer(Z51,T4I,QL1)
call ForGroup(Z51,function QJ1)
call NSI(Z51)
endfunction
function QM1 takes nothing returns nothing
call QK1(BO[1])
call QK1(BO[2])
call QK1(BO[3])
call QK1(BO[4])
call QK1(BO[5])
call QK1(CO[1])
call QK1(CO[2])
call QK1(CO[3])
call QK1(CO[4])
call QK1(CO[5])
endfunction
function QN1 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='ncop'
endfunction
function QS1 takes nothing returns nothing
if IAI then
//call UnitRemoveAbility(D30[GetPlayerId(GetOwningPlayer(GetEnumUnit()))],'A14F')
call UnitRemoveAbility(D30[GetPlayerId(GetOwningPlayer(GetEnumUnit()))],'A14E')
call UnitRemoveAbility(D30[GetPlayerId(GetOwningPlayer(GetEnumUnit()))],'A14H')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A0I4')==0 then
call UnitAddAbility(GetEnumUnit(),'A0I4')
endif
endfunction
function QT1 takes player p returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,p,Condition(function QN1))
call ForGroup(g,function QS1)
call NSI(g)
set g=null
endfunction
function DelayedHeroTech_Helper takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer SSI=(LoadInteger(LY,(handle_id),(86)))
call TCI(SSI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function QR1 takes unit SFI,player p returns string
local string s="从$p那里得到了$hero"
set s=FS1(s,"$hero",GetUnitName(SFI))
set s=FS1(s,"$p",(D80[GetPlayerId((p))]))
return s
endfunction
function QP1 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local player T4I=GetOwningPlayer(PKI)
local real x
local real y
local region r=CreateRegion()
local player QQ1=T4I
local item BA1
local unit SFI=PKI
local trigger t
if X0==false then
call GK1(GetOwningPlayer(PKI))
endif
if "语言：简体中文"=="Language: English"and(DR0[(GetUnitPointValue(PKI))]!="")then
call DisplayTimedTextToPlayer(T4I,0,0,4,"A |c006699CC-tips|r command is available if you would like some pointers for this hero")
endif
if PB0[GetPlayerId(T4I)]==true then
call GD1(T4I,GetUnitPointValue(PKI))
endif
if EN==false and(K1[GetPlayerId(BO[1])]!=null and K1[GetPlayerId(BO[2])]!=null and K1[GetPlayerId(BO[3])]!=null and K1[GetPlayerId(BO[4])]!=null and K1[GetPlayerId(BO[5])]!=null and K1[GetPlayerId(CO[1])]!=null and K1[GetPlayerId(CO[2])]!=null and K1[GetPlayerId(CO[3])]!=null and K1[GetPlayerId(CO[4])]!=null and K1[GetPlayerId(CO[5])]!=null)then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,7,false)
call TriggerAddCondition(t,Condition(function QV1))
set t=null
endif
set HJ[GetPlayerId(GetOwningPlayer((PKI)))]=false
call RegionAddRect(r,RA)
if B3 and G3==false then
set E3[GetPlayerId(T4I)]=true
set T4I=(LoadPlayerHandle(LY,(2000),(550+GetPlayerId(T4I))))
call SetUnitOwner(PKI,T4I,true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(PKI),'A2TS',false)
if IsPlayerTeam1(GetOwningPlayer(PKI))then
if IsUnitInRegion(r,PKI)then
set x=GetRandomReal(GetRectMinX(O4),GetRectMaxX(O4))
set y=GetRandomReal(GetRectMinY(O4),GetRectMaxY(O4))
else
set x=GetUnitX(PKI)
set y=GetUnitY(PKI)
endif
else
if IsUnitInRegion(r,PKI)then
set x=GetRandomReal(GetRectMinX(S3),GetRectMaxX(S3))
set y=GetRandomReal(GetRectMinY(S3),GetRectMaxY(S3))
else
set x=GetUnitX(PKI)
set y=GetUnitY(PKI)
endif
endif
set C3[GetPlayerId(T4I)]=true
if(not B3 or G3)then
if QT0==false and BN==false then
call PanCameraToTimedForPlayer(T4I,x,y,0)
endif
if GetUnitTypeId(PKI)!='N0MM' then
call ClearSelectionForPlayer(T4I)
endif
call SelectUnitAddForPlayer(PKI,T4I)
endif
call MUSetUnitX(PKI,x)
call MUSetUnitY(PKI,y)
if GetUnitTypeId(PKI)!='N0MM' then
set K1[GetPlayerId(T4I)]=PKI
endif
call FJ1(T4I,"9",GetUnitTypeId(PKI))
if B3 and G3==false then
call TFI(QQ1)
else
call TFI(T4I)
endif
call SaveBoolean(LY,(GetHandleId(PKI)),(85),(true))
if not F2 then
set R[GetUnitPointValue(PKI)]=true
call TCI(GetUnitTypeId(PKI))
endif
if X0 then
if IsPlayerTeam1(T4I)then
set T1[0]=T1[0]+1
else
set T1[1]=T1[1]+1
endif
set IO[GetPlayerId(T4I)]=IO[GetPlayerId(T4I)]+1
if IO[GetPlayerId(GetOwningPlayer(PKI))]>1 and PKI!=U1[GetPlayerId(GetOwningPlayer(PKI))]then
call WI1(U1[GetPlayerId(GetOwningPlayer(PKI))])
call MUDisableItemTrigger()
call SetHeroXP(PKI,GetHeroXP(U1[GetPlayerId(GetOwningPlayer(PKI))]),false)
call UnitAddItem(PKI,UnitItemInSlot(U1[GetPlayerId(GetOwningPlayer(PKI))],0))
call UnitAddItem(PKI,UnitItemInSlot(U1[GetPlayerId(GetOwningPlayer(PKI))],1))
call UnitAddItem(PKI,UnitItemInSlot(U1[GetPlayerId(GetOwningPlayer(PKI))],2))
call UnitAddItem(PKI,UnitItemInSlot(U1[GetPlayerId(GetOwningPlayer(PKI))],3))
call UnitAddItem(PKI,UnitItemInSlot(U1[GetPlayerId(GetOwningPlayer(PKI))],4))
call UnitAddItem(PKI,UnitItemInSlot(U1[GetPlayerId(GetOwningPlayer(PKI))],5))
call MUEnableItemTrigger()
if W01(U1[GetPlayerId(GetOwningPlayer(PKI))])then
call W21(U1[GetPlayerId(GetOwningPlayer(PKI))])
else
call Q5I(U1[GetPlayerId(GetOwningPlayer(PKI))])
endif
endif
endif
if T4I!=BO[0]and T4I!=CO[0]then
if B3 then
if TimerGetElapsed(M)>60 then
call QZ1(T4I,"自动分配到了"+" "+GetUnitName(PKI))
elseif S0[GetPlayerId(QQ1)]==true then
call QZ1(T4I,QR1(PKI,QQ1))
else
call SetPlayerState(QQ1,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(QQ1,PLAYER_STATE_RESOURCE_GOLD)+250)
call QZ1(T4I,"被给予了"+" "+GetUnitName(PKI)+" "+"被"+" "+(D80[GetPlayerId((QQ1))]))
endif
elseif Y2==false or T4I==WO then
if(D0[GetPlayerId(GetOwningPlayer(PKI))]==true and Y2==false)then
call QZ1(T4I,"重新选择了"+" "+GetUnitName(PKI)+".")
elseif((S0[GetPlayerId(T4I)]==true and X0==false)or Y0 or J0 or N2)then
call QZ1(T4I,"随机选择了"+" "+GetUnitName(PKI)+".")
else
call QZ1(T4I,"选择了"+" "+GetUnitName(PKI)+".")
endif
endif
endif
if TK then
if B3 then
call QK1(QQ1)
else
call QK1(T4I)
endif
endif
if(QT0 or BN)and TK then
call QK1(T4I)
endif
call QT1(T4I)
if(GetUnitTypeId(PKI)=='E005')then
call DisplayTimedTextToPlayer(T4I,0,U2,60.00," ")
call DisplayTimedTextToPlayer(T4I,0,U2,60.00,"|c00ff0303"+"不要为月之骑士买以下物品："+"黯灭、漩涡和雷神锤"+" "+"上述法球效果会导致她的攻击无效"+"|r")
elseif GetUnitTypeId(PKI)=='O00J' or GetUnitTypeId(PKI)=='N016' or GetUnitTypeId(PKI)=='UC91' or GetUnitTypeId(PKI)=='EC45' then
call DisplayTimedTextToPlayer(T4I,0,U2,10.00," ")
call DisplayTimedTextToPlayer(T4I,0,U2,10.00,"|c00ff0303"+"重击效果不与其他被动击晕技能叠加"+"|r")
endif
if(GetUnitTypeId(PKI)=='E01B')then
call DisplayTimedTextToPlayer(T4I,0,U2,30.00," ")
call DisplayTimedTextToPlayer(T4I,0,U2,30.00,"|c00ff0303"+"死亡后会掉落的物品不会在相位移动时掉出"+" "+"在死亡时会出现效果的物品（比如不朽之守护）在相位移动至无法到达的地形时将不会起作用"+"|r")
endif
if(S0[GetPlayerId(T4I)]==false)then
if(J2)then
call SetPlayerState(T4I,PLAYER_STATE_RESOURCE_GOLD,175+GetPlayerState(T4I,PLAYER_STATE_RESOURCE_GOLD))
endif
endif
if HaveSavedBoolean(LY,600+GetUnitPointValue(PKI),87)==false then
call SaveBoolean(LY,(600+GetUnitPointValue(PKI)),(87),(true))
call WF1(PKI)
endif
set GK=PKI
call ExecuteFunc("QU1")
if RP0[GetPlayerId(GetLocalPlayer())]==false then
call SetPlayerName(T4I,(D80[GetPlayerId((T4I))])+" ("+S8I(K1[GetPlayerId(T4I)])+")")
endif
call RemoveRegion(r)
endfunction
function U11 takes nothing returns boolean
return IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==true
endfunction
function UO1 takes nothing returns nothing
local unit SFI=GetSoldUnit()
local player T4I=GetOwningPlayer(SFI)
call TFI(T4I)
endfunction
function U31 takes nothing returns boolean
local integer ROI=1
if R0 then
set ROI=2
endif
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD)+ROI)
return false
endfunction
function U51 takes nothing returns nothing
local integer QHI=R2I(TimerGetElapsed(M)-N)
local integer BX1=QHI/60-1/2
local integer BY1=ModuloInteger(QHI,60)
if CL then
call BW1(BX1,BY1,false)
elseif AL==false then
set QHI=R2I(16-TimerGetElapsed(M))
set BX1=QHI/60-1/2
set BY1=ModuloInteger(QHI,60)
call BW1(BX1,BY1,true)
endif
endfunction
function U71 takes nothing returns boolean
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and(LoadInteger(EY0,(GetSpellAbilityId()),(GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId()))))>0 then
call TimerStart(EJ0[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))],(LoadInteger(EY0,(GetSpellAbilityId()),(GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId())))),false,null)
endif
if GetSpellAbilityId()=='A02W' then
call TimerStart(EJ0[GetPlayerId((GetOwningPlayer(GetTriggerUnit())))],0,false,null)
endif
return false
endfunction
function U81 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer i
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U71))
set i=0
loop
exitwhen(i>13)
set EJ0[i]=CreateTimer()
set i=i+1
endloop
set EY0=InitHashtable()
call SaveInteger(EY0,('A11K'),(1),(60))
call SaveInteger(EY0,('A11K'),(2),(50))
call SaveInteger(EY0,('A11K'),(3),(40))
call SaveInteger(EY0,('A0O2'),(1),(80))
call SaveInteger(EY0,('A0O2'),(2),(75))
call SaveInteger(EY0,('A0O2'),(3),(70))
call SaveInteger(EY0,('A289'),(1),(45))
call SaveInteger(EY0,('A289'),(2),(45))
call SaveInteger(EY0,('A289'),(3),(45))
call SaveInteger(EY0,('A0DH'),(1),(150))
call SaveInteger(EY0,('A0DH'),(2),(130))
call SaveInteger(EY0,('A0DH'),(3),(110))
call SaveInteger(EY0,('A1OB'),(1),(150))
call SaveInteger(EY0,('A1OB'),(2),(130))
call SaveInteger(EY0,('A1OB'),(3),(110))
call SaveInteger(EY0,('A0ER'),(1),(150))
call SaveInteger(EY0,('A0ER'),(2),(150))
call SaveInteger(EY0,('A0ER'),(3),(150))
call SaveInteger(EY0,('A2S8'),(1),(150))
call SaveInteger(EY0,('A2S8'),(2),(150))
call SaveInteger(EY0,('A2S8'),(3),(150))
call SaveInteger(EY0,('A0MQ'),(1),(140))
call SaveInteger(EY0,('A0MQ'),(2),(120))
call SaveInteger(EY0,('A0MQ'),(3),(100))
call SaveInteger(EY0,('A1B6'),(1),(140))
call SaveInteger(EY0,('A1B6'),(2),(120))
call SaveInteger(EY0,('A1B6'),(3),(100))
call SaveInteger(EY0,('A1WH'),(1),(80))
call SaveInteger(EY0,('A1WH'),(2),(80))
call SaveInteger(EY0,('A1WH'),(3),(80))
call SaveInteger(EY0,('A1A1'),(1),(100))
call SaveInteger(EY0,('A1A1'),(2),(100))
call SaveInteger(EY0,('A1A1'),(3),(100))
call SaveInteger(EY0,('A07Z'),(1),(70))
call SaveInteger(EY0,('A07Z'),(2),(70))
call SaveInteger(EY0,('A07Z'),(3),(70))
call SaveInteger(EY0,('ANcr'),(1),(45))
call SaveInteger(EY0,('ANcr'),(2),(45))
call SaveInteger(EY0,('ANcr'),(3),(45))
call SaveInteger(EY0,('A0Z8'),(1),(70))
call SaveInteger(EY0,('A0Z8'),(2),(55))
call SaveInteger(EY0,('A0Z8'),(3),(40))
call SaveInteger(EY0,('A1CV'),(1),(12))
call SaveInteger(EY0,('A1CV'),(2),(12))
call SaveInteger(EY0,('A1CV'),(3),(12))
call SaveInteger(EY0,('A03G'),(1),(115))
call SaveInteger(EY0,('A03G'),(2),(115))
call SaveInteger(EY0,('A03G'),(3),(115))
call SaveInteger(EY0,('A29L'),(1),(120))
call SaveInteger(EY0,('A29L'),(2),(110))
call SaveInteger(EY0,('A29L'),(3),(100))
call SaveInteger(EY0,('A0QR'),(1),(45))
call SaveInteger(EY0,('A0QR'),(2),(30))
call SaveInteger(EY0,('A0QR'),(3),(15))
call SaveInteger(EY0,('A1B3'),(1),(4))
call SaveInteger(EY0,('A1B3'),(2),(4))
call SaveInteger(EY0,('A1B3'),(3),(4))
call SaveInteger(EY0,('A06R'),(1),(140))
call SaveInteger(EY0,('A06R'),(2),(120))
call SaveInteger(EY0,('A06R'),(3),(100))
call SaveInteger(EY0,('A1B4'),(1),(120))
call SaveInteger(EY0,('A1B4'),(2),(100))
call SaveInteger(EY0,('A1B4'),(3),(80))
call SaveInteger(EY0,('A0G4'),(1),(80))
call SaveInteger(EY0,('A0G4'),(2),(70))
call SaveInteger(EY0,('A0G4'),(3),(60))
call SaveInteger(EY0,('A1D8'),(1),(20))
call SaveInteger(EY0,('A1D8'),(2),(20))
call SaveInteger(EY0,('A1D8'),(3),(20))
call SaveInteger(EY0,('A29I'),(1),(150))
call SaveInteger(EY0,('A29I'),(2),(150))
call SaveInteger(EY0,('A29I'),(3),(150))
call SaveInteger(EY0,('A0E2'),(1),(75))
call SaveInteger(EY0,('A0E2'),(2),(65))
call SaveInteger(EY0,('A0E2'),(3),(55))
call SaveInteger(EY0,('A1MR'),(1),(6))
call SaveInteger(EY0,('A1MR'),(2),(6))
call SaveInteger(EY0,('A1MR'),(3),(6))
call SaveInteger(EY0,('A03O'),(1),(140))
call SaveInteger(EY0,('A03O'),(2),(140))
call SaveInteger(EY0,('A03O'),(3),(140))
call SaveInteger(EY0,('A0RW'),(1),(20))
call SaveInteger(EY0,('A0RW'),(2),(20))
call SaveInteger(EY0,('A0RW'),(3),(20))
call SaveInteger(EY0,('A0MU'),(1),(100))
call SaveInteger(EY0,('A0MU'),(2),(100))
call SaveInteger(EY0,('A0MU'),(3),(100))
call SaveInteger(EY0,('A0A2'),(1),(100))
call SaveInteger(EY0,('A0A2'),(2),(100))
call SaveInteger(EY0,('A0A2'),(3),(100))
call SaveInteger(EY0,('A0SW'),(1),(100))
call SaveInteger(EY0,('A0SW'),(2),(100))
call SaveInteger(EY0,('A0SW'),(3),(100))
call SaveInteger(EY0,('A093'),(1),(120))
call SaveInteger(EY0,('A093'),(2),(90))
call SaveInteger(EY0,('A093'),(3),(60))
call SaveInteger(EY0,('A03K'),(1),(180))
call SaveInteger(EY0,('A03K'),(2),(150))
call SaveInteger(EY0,('A03K'),(3),(120))
call SaveInteger(EY0,('A1B0'),(1),(180))
call SaveInteger(EY0,('A1B0'),(2),(150))
call SaveInteger(EY0,('A1B0'),(3),(120))
call SaveInteger(EY0,('A0R0'),(1),(130))
call SaveInteger(EY0,('A0R0'),(2),(130))
call SaveInteger(EY0,('A0R0'),(3),(130))
call SaveInteger(EY0,('A0FL'),(1),(30))
call SaveInteger(EY0,('A0FL'),(2),(30))
call SaveInteger(EY0,('A0FL'),(3),(30))
call SaveInteger(EY0,('A1CX'),(1),(30))
call SaveInteger(EY0,('A1CX'),(2),(30))
call SaveInteger(EY0,('A1CX'),(3),(30))
call SaveInteger(EY0,('A034'),(1),(5))
call SaveInteger(EY0,('A034'),(2),(5))
call SaveInteger(EY0,('A034'),(3),(5))
call SaveInteger(EY0,('A15J'),(1),(75))
call SaveInteger(EY0,('A15J'),(2),(75))
call SaveInteger(EY0,('A15J'),(3),(75))
call SaveInteger(EY0,('A2WE'),(1),(70))
call SaveInteger(EY0,('A2WE'),(2),(70))
call SaveInteger(EY0,('A2WE'),(3),(70))
call SaveInteger(EY0,('A04P'),(1),(20))
call SaveInteger(EY0,('A04P'),(2),(15))
call SaveInteger(EY0,('A04P'),(3),(10))
call SaveInteger(EY0,('A0M1'),(1),(130))
call SaveInteger(EY0,('A0M1'),(2),(120))
call SaveInteger(EY0,('A0M1'),(3),(110))
call SaveInteger(EY0,('A1AX'),(1),(70))
call SaveInteger(EY0,('A1AX'),(2),(70))
call SaveInteger(EY0,('A1AX'),(3),(70))
call SaveInteger(EY0,('A054'),(1),(160))
call SaveInteger(EY0,('A054'),(2),(150))
call SaveInteger(EY0,('A054'),(3),(140))
call SaveInteger(EY0,('A00U'),(1),(160))
call SaveInteger(EY0,('A00U'),(2),(150))
call SaveInteger(EY0,('A00U'),(3),(140))
call SaveInteger(EY0,('A0G8'),(1),(80))
call SaveInteger(EY0,('A0G8'),(2),(80))
call SaveInteger(EY0,('A0G8'),(3),(80))
call SaveInteger(EY0,('A07U'),(1),(180))
call SaveInteger(EY0,('A07U'),(2),(120))
call SaveInteger(EY0,('A07U'),(3),(60))
call SaveInteger(EY0,('A0KU'),(1),(140))
call SaveInteger(EY0,('A0KU'),(2),(120))
call SaveInteger(EY0,('A0KU'),(3),(100))
call SaveInteger(EY0,('A1EJ'),(1),(30))
call SaveInteger(EY0,('A1EJ'),(2),(30))
call SaveInteger(EY0,('A1EJ'),(3),(30))
call SaveInteger(EY0,('A0B4'),(1),(4))
call SaveInteger(EY0,('A0B4'),(2),(4))
call SaveInteger(EY0,('A0B4'),(3),(4))
call SaveInteger(EY0,('A1IN'),(1),(60))
call SaveInteger(EY0,('A1IN'),(2),(60))
call SaveInteger(EY0,('A1IN'),(3),(60))
call SaveInteger(EY0,('A0J1'),(1),(130))
call SaveInteger(EY0,('A0J1'),(2),(115))
call SaveInteger(EY0,('A0J1'),(3),(100))
call SaveInteger(EY0,('A1D7'),(1),(60))
call SaveInteger(EY0,('A1D7'),(2),(60))
call SaveInteger(EY0,('A1D7'),(3),(60))
call SaveInteger(EY0,('A1MI'),(1),(40))
call SaveInteger(EY0,('A1MI'),(2),(40))
call SaveInteger(EY0,('A1MI'),(3),(40))
call SaveInteger(EY0,('A2QE'),(1),(40))
call SaveInteger(EY0,('A2QE'),(2),(40))
call SaveInteger(EY0,('A2QE'),(3),(40))
call SaveInteger(EY0,('A1AO'),(1),(80))
call SaveInteger(EY0,('A1AO'),(2),(70))
call SaveInteger(EY0,('A1AO'),(3),(60))
call SaveInteger(EY0,('A1UV'),(1),(80))
call SaveInteger(EY0,('A1UV'),(2),(70))
call SaveInteger(EY0,('A1UV'),(3),(60))
call SaveInteger(EY0,('A1NE'),(1),(180))
call SaveInteger(EY0,('A1NE'),(2),(160))
call SaveInteger(EY0,('A1NE'),(3),(140))
call SaveInteger(EY0,('A2IG'),(1),(180))
call SaveInteger(EY0,('A2IG'),(2),(160))
call SaveInteger(EY0,('A2IG'),(3),(140))
call SaveInteger(EY0,('A1AT'),(1),(90))
call SaveInteger(EY0,('A1AT'),(2),(90))
call SaveInteger(EY0,('A1AT'),(3),(90))
call SaveInteger(EY0,('A0RP'),(1),(11))
call SaveInteger(EY0,('A0RP'),(2),(9))
call SaveInteger(EY0,('A0RP'),(3),(7))
call SaveInteger(EY0,('A0LC'),(1),(25))
call SaveInteger(EY0,('A0LC'),(2),(25))
call SaveInteger(EY0,('A0LC'),(3),(25))
call SaveInteger(EY0,('A0IN'),(1),(45))
call SaveInteger(EY0,('A0IN'),(2),(45))
call SaveInteger(EY0,('A0IN'),(3),(45))
call SaveInteger(EY0,('A1AW'),(1),(10))
call SaveInteger(EY0,('A1AW'),(2),(10))
call SaveInteger(EY0,('A1AW'),(3),(10))
call SaveInteger(EY0,('A0LH'),(1),(70))
call SaveInteger(EY0,('A0LH'),(2),(60))
call SaveInteger(EY0,('A0LH'),(3),(50))
call SaveInteger(EY0,('A04Q'),(1),(45))
call SaveInteger(EY0,('A04Q'),(2),(40))
call SaveInteger(EY0,('A04Q'),(3),(35))
call SaveInteger(EY0,('A0WQ'),(1),(45))
call SaveInteger(EY0,('A0WQ'),(2),(45))
call SaveInteger(EY0,('A0WQ'),(3),(45))
call SaveInteger(EY0,('A09U'),(1),(70))
call SaveInteger(EY0,('A09U'),(2),(60))
call SaveInteger(EY0,('A09U'),(3),(50))
call SaveInteger(EY0,('A0CT'),(1),(60))
call SaveInteger(EY0,('A0CT'),(2),(50))
call SaveInteger(EY0,('A0CT'),(3),(40))
call SaveInteger(EY0,('A29J'),(1),(120))
call SaveInteger(EY0,('A29J'),(2),(110))
call SaveInteger(EY0,('A29J'),(3),(100))
call SaveInteger(EY0,('A07Q'),(1),(120))
call SaveInteger(EY0,('A07Q'),(2),(80))
call SaveInteger(EY0,('A07Q'),(3),(40))
call SaveInteger(EY0,('A0H9'),(1),(120))
call SaveInteger(EY0,('A0H9'),(2),(120))
call SaveInteger(EY0,('A0H9'),(3),(120))
call SaveInteger(EY0,('A013'),(1),(140))
call SaveInteger(EY0,('A013'),(2),(120))
call SaveInteger(EY0,('A013'),(3),(100))
call SaveInteger(EY0,('A0A6'),(1),(140))
call SaveInteger(EY0,('A0A6'),(2),(120))
call SaveInteger(EY0,('A0A6'),(3),(60))
call SaveInteger(EY0,('A080'),(1),(80))
call SaveInteger(EY0,('A080'),(2),(50))
call SaveInteger(EY0,('A080'),(3),(30))
call SaveInteger(EY0,('A03R'),(1),(150))
call SaveInteger(EY0,('A03R'),(2),(120))
call SaveInteger(EY0,('A03R'),(3),(90))
call SaveInteger(EY0,('A0AV'),(1),(150))
call SaveInteger(EY0,('A0AV'),(2),(120))
call SaveInteger(EY0,('A0AV'),(3),(90))
call SaveInteger(EY0,('A0S8'),(1),(85))
call SaveInteger(EY0,('A0S8'),(2),(85))
call SaveInteger(EY0,('A0S8'),(3),(85))
call SaveInteger(EY0,('A1QP'),(1),(85))
call SaveInteger(EY0,('A1QP'),(2),(85))
call SaveInteger(EY0,('A1QP'),(3),(85))
call SaveInteger(EY0,('A0LT'),(1),(160))
call SaveInteger(EY0,('A0LT'),(2),(140))
call SaveInteger(EY0,('A0LT'),(3),(120))
call SaveInteger(EY0,('A1CS'),(1),(30))
call SaveInteger(EY0,('A1CS'),(2),(30))
call SaveInteger(EY0,('A1CS'),(3),(30))
call SaveInteger(EY0,('A11T'),(1),(80))
call SaveInteger(EY0,('A11T'),(2),(70))
call SaveInteger(EY0,('A11T'),(3),(60))
call SaveInteger(EY0,('A1W8'),(1),(90))
call SaveInteger(EY0,('A1W8'),(2),(75))
call SaveInteger(EY0,('A1W8'),(3),(60))
call SaveInteger(EY0,('A1W9'),(1),(90))
call SaveInteger(EY0,('A1W9'),(2),(75))
call SaveInteger(EY0,('A1W9'),(3),(60))
call SaveInteger(EY0,('A29G'),(1),(90))
call SaveInteger(EY0,('A29G'),(2),(90))
call SaveInteger(EY0,('A29G'),(3),(90))
call SaveInteger(EY0,('A29H'),(1),(90))
call SaveInteger(EY0,('A29H'),(2),(90))
call SaveInteger(EY0,('A29H'),(3),(90))
call SaveInteger(EY0,('A0L3'),(1),(130))
call SaveInteger(EY0,('A0L3'),(2),(130))
call SaveInteger(EY0,('A0L3'),(3),(130))
call SaveInteger(EY0,('A2QC'),(1),(130))
call SaveInteger(EY0,('A2QC'),(2),(130))
call SaveInteger(EY0,('A2QC'),(3),(130))
call SaveInteger(EY0,('A01P'),(1),(70))
call SaveInteger(EY0,('A01P'),(2),(60))
call SaveInteger(EY0,('A01P'),(3),(50))
call SaveInteger(EY0,('A09Z'),(1),(70))
call SaveInteger(EY0,('A09Z'),(2),(60))
call SaveInteger(EY0,('A09Z'),(3),(50))
call SaveInteger(EY0,('A12P'),(1),(60))
call SaveInteger(EY0,('A12P'),(2),(60))
call SaveInteger(EY0,('A12P'),(3),(60))
call SaveInteger(EY0,('A1D6'),(1),(15))
call SaveInteger(EY0,('A1D6'),(2),(15))
call SaveInteger(EY0,('A1D6'),(3),(15))
call SaveInteger(EY0,('A19O'),(1),(90))
call SaveInteger(EY0,('A19O'),(2),(75))
call SaveInteger(EY0,('A19O'),(3),(60))
call SaveInteger(EY0,('A0AK'),(1),(10))
call SaveInteger(EY0,('A0AK'),(2),(10))
call SaveInteger(EY0,('A0AK'),(3),(10))
call SaveInteger(EY0,('A1FY'),(1),(10))
call SaveInteger(EY0,('A1FY'),(2),(10))
call SaveInteger(EY0,('A1FY'),(3),(10))
call SaveInteger(EY0,('A0VF'),(1),(22))
call SaveInteger(EY0,('A0VF'),(2),(17))
call SaveInteger(EY0,('A0VF'),(3),(12))
call SaveInteger(EY0,('A0VF'),(4),(5))
call SaveInteger(EY0,('A1B5'),(1),(16))
call SaveInteger(EY0,('A1B5'),(2),(8))
call SaveInteger(EY0,('A1B5'),(3),(4))
call SaveInteger(EY0,('A1B5'),(4),(2))
call SaveInteger(EY0,('A07K'),(1),(6))
call SaveInteger(EY0,('A07K'),(2),(6))
call SaveInteger(EY0,('A07K'),(3),(6))
call SaveInteger(EY0,('A10Q'),(1),(40))
call SaveInteger(EY0,('A10Q'),(2),(40))
call SaveInteger(EY0,('A10Q'),(3),(40))
call SaveInteger(EY0,('A1DB'),(1),(40))
call SaveInteger(EY0,('A1DB'),(2),(40))
call SaveInteger(EY0,('A1DB'),(3),(40))
call SaveInteger(EY0,('A00H'),(1),(120))
call SaveInteger(EY0,('A00H'),(2),(120))
call SaveInteger(EY0,('A00H'),(3),(120))
call SaveInteger(EY0,('A0A1'),(1),(120))
call SaveInteger(EY0,('A0A1'),(2),(120))
call SaveInteger(EY0,('A0A1'),(3),(120))
call SaveInteger(EY0,('A0O5'),(1),(60))
call SaveInteger(EY0,('A0O5'),(2),(60))
call SaveInteger(EY0,('A0O5'),(3),(60))
call SaveInteger(EY0,('A1B1'),(1),(60))
call SaveInteger(EY0,('A1B1'),(2),(60))
call SaveInteger(EY0,('A1B1'),(3),(60))
call SaveInteger(EY0,('A0NT'),(1),(80))
call SaveInteger(EY0,('A0NT'),(2),(80))
call SaveInteger(EY0,('A0NT'),(3),(80))
call SaveInteger(EY0,('A0NX'),(1),(80))
call SaveInteger(EY0,('A0NX'),(2),(80))
call SaveInteger(EY0,('A0NX'),(3),(80))
call SaveInteger(EY0,('A02Q'),(1),(100))
call SaveInteger(EY0,('A02Q'),(2),(100))
call SaveInteger(EY0,('A02Q'),(3),(100))
call SaveInteger(EY0,('A1D9'),(1),(100))
call SaveInteger(EY0,('A1D9'),(2),(100))
call SaveInteger(EY0,('A1D9'),(3),(100))
call SaveInteger(EY0,('A0QK'),(1),(100))
call SaveInteger(EY0,('A0QK'),(2),(100))
call SaveInteger(EY0,('A0QK'),(3),(100))
call SaveInteger(EY0,('A073'),(1),(135))
call SaveInteger(EY0,('A073'),(2),(135))
call SaveInteger(EY0,('A073'),(3),(135))
call SaveInteger(EY0,('A03J'),(1),(135))
call SaveInteger(EY0,('A03J'),(2),(135))
call SaveInteger(EY0,('A03J'),(3),(135))
call SaveInteger(EY0,('A04J'),(1),(135))
call SaveInteger(EY0,('A04J'),(2),(135))
call SaveInteger(EY0,('A04J'),(3),(135))
call SaveInteger(EY0,('A04M'),(1),(135))
call SaveInteger(EY0,('A04M'),(2),(135))
call SaveInteger(EY0,('A04M'),(3),(135))
call SaveInteger(EY0,('A04N'),(1),(135))
call SaveInteger(EY0,('A04N'),(2),(135))
call SaveInteger(EY0,('A04N'),(3),(135))
call SaveInteger(EY0,('A095'),(1),(160))
call SaveInteger(EY0,('A095'),(2),(100))
call SaveInteger(EY0,('A095'),(3),(40))
call SaveInteger(EY0,('A09W'),(1),(100))
call SaveInteger(EY0,('A09W'),(2),(60))
call SaveInteger(EY0,('A09W'),(3),(20))
call SaveInteger(EY0,('A1BX'),(1),(200))
call SaveInteger(EY0,('A1BX'),(2),(190))
call SaveInteger(EY0,('A1BX'),(3),(180))
call SaveInteger(EY0,('A05T'),(1),(120))
call SaveInteger(EY0,('A05T'),(2),(90))
call SaveInteger(EY0,('A05T'),(3),(60))
call SaveInteger(EY0,('A08H'),(1),(120))
call SaveInteger(EY0,('A08H'),(2),(90))
call SaveInteger(EY0,('A08H'),(3),(60))
call SaveInteger(EY0,('A067'),(1),(100))
call SaveInteger(EY0,('A067'),(2),(85))
call SaveInteger(EY0,('A067'),(3),(70))
call SaveInteger(EY0,('A08P'),(1),(70))
call SaveInteger(EY0,('A08P'),(2),(70))
call SaveInteger(EY0,('A08P'),(3),(70))
call SaveInteger(EY0,('A0CC'),(1),(22))
call SaveInteger(EY0,('A0CC'),(2),(22))
call SaveInteger(EY0,('A0CC'),(3),(22))
call SaveInteger(EY0,('A0OK'),(1),(160))
call SaveInteger(EY0,('A0OK'),(2),(160))
call SaveInteger(EY0,('A0OK'),(3),(160))
call SaveInteger(EY0,('A1VW'),(1),(160))
call SaveInteger(EY0,('A1VW'),(2),(160))
call SaveInteger(EY0,('A1VW'),(3),(160))
call SaveInteger(EY0,('A306'),(1),(135))
call SaveInteger(EY0,('A306'),(2),(135))
call SaveInteger(EY0,('A306'),(3),(135))
call SaveInteger(EY0,('A307'),(1),(40))
call SaveInteger(EY0,('A307'),(2),(40))
call SaveInteger(EY0,('A307'),(3),(40))
call SaveInteger(EY0,('S008'),(1),(165))
call SaveInteger(EY0,('S008'),(2),(165))
call SaveInteger(EY0,('S008'),(3),(165))
call SaveInteger(EY0,('S00U'),(1),(165))
call SaveInteger(EY0,('S00U'),(2),(165))
call SaveInteger(EY0,('S00U'),(3),(165))
call SaveInteger(EY0,('A1TB'),(1),(90))
call SaveInteger(EY0,('A1TB'),(2),(75))
call SaveInteger(EY0,('A1TB'),(3),(60))
call SaveInteger(EY0,('A1U6'),(1),(90))
call SaveInteger(EY0,('A1U6'),(2),(80))
call SaveInteger(EY0,('A1U6'),(3),(70))
call SaveInteger(EY0,('A2V8'),(1),(90))
call SaveInteger(EY0,('A2V8'),(2),(80))
call SaveInteger(EY0,('A2V8'),(3),(70))
call SaveInteger(EY0,('A1T5'),(1),(55))
call SaveInteger(EY0,('A1T5'),(2),(50))
call SaveInteger(EY0,('A1T5'),(3),(45))
call SaveInteger(EY0,('A235'),(1),(55))
call SaveInteger(EY0,('A235'),(2),(50))
call SaveInteger(EY0,('A235'),(3),(45))
call SaveInteger(EY0,('A1SA'),(1),(50))
call SaveInteger(EY0,('A1SA'),(2),(50))
call SaveInteger(EY0,('A1SA'),(3),(50))
call SaveInteger(EY0,('A1RK'),(1),(110))
call SaveInteger(EY0,('A1RK'),(2),(110))
call SaveInteger(EY0,('A1RK'),(3),(110))
call SaveInteger(EY0,('A1YQ'),(1),(25))
call SaveInteger(EY0,('A1YQ'),(2),(20))
call SaveInteger(EY0,('A1YQ'),(3),(15))
call SaveInteger(EY0,('A27H'),(1),(20))
call SaveInteger(EY0,('A27H'),(2),(18))
call SaveInteger(EY0,('A27H'),(3),(16))
call SaveInteger(EY0,('A2V9'),(1),(2))
call SaveInteger(EY0,('A2V9'),(2),(2))
call SaveInteger(EY0,('A2V9'),(3),(2))
call SaveInteger(EY0,('A2BG'),(1),(60))
call SaveInteger(EY0,('A2BG'),(2),(40))
call SaveInteger(EY0,('A2BG'),(3),(20))
call SaveInteger(EY0,('A2CI'),(1),(50))
call SaveInteger(EY0,('A2CI'),(2),(50))
call SaveInteger(EY0,('A2CI'),(3),(50))
call SaveInteger(EY0,('A2E5'),(1),(8))
call SaveInteger(EY0,('A2E5'),(2),(8))
call SaveInteger(EY0,('A2E5'),(3),(8))
call SaveInteger(EY0,('A2M0'),(1),(65))
call SaveInteger(EY0,('A2M0'),(2),(60))
call SaveInteger(EY0,('A2M0'),(3),(55))
call SaveInteger(EY0,('A0Z0'),(1),(90))
call SaveInteger(EY0,('A0Z0'),(2),(80))
call SaveInteger(EY0,('A0Z0'),(3),(70))
call SaveInteger(EY0,('A2O6'),(1),(90))
call SaveInteger(EY0,('A2O6'),(2),(75))
call SaveInteger(EY0,('A2O6'),(3),(60))
call SaveInteger(EY0,('A2TI'),(1),(80))
call SaveInteger(EY0,('A2TI'),(2),(80))
call SaveInteger(EY0,('A2TI'),(3),(80))
call SaveInteger(EY0,('A2TF'),(1),(20))
call SaveInteger(EY0,('A2TF'),(2),(20))
call SaveInteger(EY0,('A2TF'),(3),(20))
endfunction
function U91 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer id=(LoadInteger(LY,(handle_id),(758)))
set EK0[id]=GetPlayerState(Player(id),PLAYER_STATE_RESOURCE_GOLD)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function UA1 takes nothing returns boolean
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer id=GetPlayerId(GetOwningPlayer(GetTriggerUnit()))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function U91))
call SaveInteger(LY,(handle_id),(758),(id))
set t=null
return false
endfunction
function UB1 takes nothing returns boolean
local player p
local integer i
local integer id
local integer UC1
set i=1
loop
exitwhen i>5
set p=BO[i]
set id=GetPlayerId(p)
set UC1=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
if JS[id]<(TimerGetElapsed(M))then
set EK0[id]=UC1
elseif UC1>EK0[id]then
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,EK0[id])
else
set EK0[id]=UC1
endif
set p=CO[i]
set id=GetPlayerId(p)
set UC1=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
if JS[id]<(TimerGetElapsed(M))then
set EK0[id]=UC1
elseif UC1>EK0[id]then
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,EK0[id])
else
set EK0[id]=UC1
endif
set i=i+1
endloop
return false
endfunction
function UD1 takes nothing returns boolean
local player p
local integer i
local integer id
local integer UC1
set i=1
loop
exitwhen i>5
set p=BO[i]
set id=GetPlayerId(p)
set UC1=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
if UC1<EL0[id]then
set EL0[id]=UC1
endif
set p=CO[i]
set id=GetPlayerId(p)
set UC1=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
if UC1<EL0[id]then
set EL0[id]=UC1
endif
set i=i+1
endloop
return false
endfunction
function UG1 takes integer hero,integer target returns boolean
local integer i=ET0-1
local real UH1=0
local real SOI=(TimerGetElapsed(M))
local integer NPI=0
loop
exitwhen i==ET0 or UH1>ER0 or NPI>200
if i==0 then
set i=8000-1
endif
set NPI=NPI+1
set UH1=SOI-EM0[i]
if EN0[i]==hero and ES0[i]==target and UH1<ER0 then
set EN0[i]=0
set ES0[i]=0
return true
endif
set i=i-1
endloop
return false
endfunction
function UZ1 takes integer hero,integer target returns boolean
local integer i=ET0-1
local real UH1=0
local real SOI=(TimerGetElapsed(M))
local integer NPI=0
loop
exitwhen i==ET0 or UH1>ER0 or NPI>200
if i==0 then
set i=8000-1
endif
set NPI=NPI+1
set UH1=SOI-EM0[i]
if EN0[i]==hero and ES0[i]==target and UH1<ER0 then
return true
endif
set i=i-1
endloop
return false
endfunction
function UV1 takes nothing returns nothing
local integer hero=GetPlayerId(GetOwningPlayer(GetEventDamageSource()))
local integer target=GetPlayerId(GetOwningPlayer(GetTriggerUnit()))
local real PAI=GetEventDamage()
set EM0[ET0]=(TimerGetElapsed(M))
set EN0[ET0]=hero
set ES0[ET0]=target
set ET0=ET0+1
if ET0==8000 then
set ET0=1
endif
endfunction
function UW1 takes unit AD1,unit UX1 returns string
local integer i=1
local integer UY1=GetPlayerId(GetOwningPlayer(AD1))
local integer UJ1=GetPlayerId(GetOwningPlayer(UX1))
local integer O91
local string UK1=" "+"助攻："+" "
local boolean UL1=false
loop
exitwhen i>5
if IsPlayerTeam1(GetOwningPlayer(UX1))then
set O91=GetPlayerId(BO[i])
else
set O91=GetPlayerId(CO[i])
endif
if UJ1!=O91 and UG1(O91,UY1)then
set D[O91]=D[O91]+1
call FL1("Assist"+I2S(O91),UY1)
if UL1 then
set UK1=UK1+"/"+C0[O91]+(D80[GetPlayerId((Player(O91)))])+"|r"
else
set UK1=UK1+C0[O91]+(D80[GetPlayerId((Player(O91)))])+"|r"
endif
set UL1=true
endif
set i=i+1
endloop
if UL1 then
return UK1
endif
return" "
endfunction
function UM1 takes unit AD1,unit UX1 returns string
local integer i=1
local integer UY1=GetPlayerId(GetOwningPlayer(AD1))
local integer UJ1=GetPlayerId(GetOwningPlayer(UX1))
local integer O91
local string UK1=""
local boolean UL1=false
loop
exitwhen i>5
if IsPlayerTeam1(GetOwningPlayer(UX1))then
set O91=GetPlayerId(BO[i])
else
set O91=GetPlayerId(CO[i])
endif
if UJ1!=O91 and UZ1(O91,UY1)then
if UL1 then
set UK1=UK1+"/"+C0[O91]+(D80[GetPlayerId((Player(O91)))])+"|r"
else
set UK1=UK1+C0[O91]+(D80[GetPlayerId((Player(O91)))])+"|r"
endif
set UL1=true
endif
set i=i+1
endloop
if UL1 then
return UK1
endif
return" "
endfunction
function UN1 takes unit AD1,unit UX1 returns integer
local integer i=1
local integer UY1=GetPlayerId(GetOwningPlayer(AD1))
local integer UJ1=GetPlayerId(GetOwningPlayer(UX1))
local integer O91
local integer NPI=0
loop
exitwhen i>5
if IsPlayerTeam1(GetOwningPlayer(UX1))then
set O91=GetPlayerId(BO[i])
else
set O91=GetPlayerId(CO[i])
endif
if UJ1!=O91 and UZ1(O91,UY1)then
set NPI=NPI+1
endif
set i=i+1
endloop
return NPI
endfunction
function US1 takes unit AD1,unit UX1 returns boolean
local integer i=1
local integer UY1=GetPlayerId(GetOwningPlayer(AD1))
local integer UJ1=GetPlayerId(GetOwningPlayer(UX1))
local integer O91
local string UK1=" Assists: "
local boolean UL1=false
local integer x=1
set EP0[1]=null
set EP0[2]=null
set EP0[3]=null
set EP0[4]=null
set EP0[5]=null
loop
exitwhen i>5
if IsPlayerTeam1(GetOwningPlayer(UX1))then
set O91=GetPlayerId(BO[i])
else
set O91=GetPlayerId(CO[i])
endif
if UJ1!=O91 and UZ1(O91,UY1)then
set EP0[x]=Player(O91)
set x=x+1
set UL1=true
endif
set i=i+1
endloop
return UL1
endfunction
function UT1 takes unit AD1,unit UX1,real ROI returns nothing
local integer i=1
local integer NPI=0
call US1(AD1,UX1)
loop
exitwhen i>5
if EP0[i]!=null then
set NPI=NPI+1
endif
set i=i+1
endloop
set i=1
loop
exitwhen i>5
if EP0[i]!=null then
set EL0[GetPlayerId(EP0[i])]=EL0[GetPlayerId(EP0[i])]+R2I(ROI/NPI)
set EK0[GetPlayerId(EP0[i])]=EK0[GetPlayerId(EP0[i])]+R2I(ROI/NPI)
call AA1(EP0[i],R2I(ROI/NPI),K1[GetPlayerId(EP0[i])])
endif
set i=i+1
endloop
endfunction
function UR1 takes nothing returns nothing
endfunction
function UP1 takes nothing returns nothing
local integer id=GetUnitTypeId(GetTriggerUnit())
if GetOwningPlayer(GetTriggerUnit())==DO then
set C[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=C[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
elseif(id=='ugho')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='unec')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='esen')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='edry')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='u001')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='u002')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='e00V')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='e00W')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='ebal')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='e026')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='umtw')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
elseif(id=='u00R')then
if(IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit())))then
set B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=B[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
else
set A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=A[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
endif
call UR1()
endfunction
function UU1 takes integer i returns nothing
local integer x=1
local integer y=1
set EQ0[i]=null
set EU0[i]=0
set F00[i]=false
loop
exitwhen y>FI0
if EU0[y]!=0 then
set F10[x]=EQ0[y]
set FO0[x]=EU0[y]
set F20[x]=F00[y]
set EQ0[y]=null
set EU0[y]=0
set F00[y]=false
set x=x+1
endif
set y=y+1
endloop
set FI0=x-1
set x=1
loop
exitwhen x>FI0
set EQ0[x]=F10[x]
set EU0[x]=FO0[x]
set F00[x]=F20[x]
set x=x+1
endloop
endfunction
function I0O takes unit AD1 returns boolean
return GetUnitTypeId(AD1)=='H00I' or GetUnitTypeId(AD1)=='H00J'
endfunction
function IIO takes unit AD1 returns boolean
local integer handle_id=GetHandleId(GetOwningPlayer(AD1))
local unit W41=(LoadUnitHandle(LY,(handle_id),(699)))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
if GetUnitAbilityLevel(W41,'A0OV')!=0 or GetUnitAbilityLevel(W51,'A0OV')!=0 or GetUnitAbilityLevel(W61,'A0OV')!=0 or GetUnitAbilityLevel(W71,'A0OV')!=0 or GetUnitAbilityLevel(W81,'A0OV')!=0 then
return true
endif
return false
endfunction
function I1O takes unit AD1 returns boolean
local integer i=0
local integer handle_id=GetHandleId(GetOwningPlayer(AD1))
local unit W31=(LoadUnitHandle(LY,(handle_id),(699)))
loop
exitwhen i>5
if GetItemTypeId(UnitItemInSlot(W31,i))==FR0[VL0]and GetItemCharges(UnitItemInSlot(W31,i))>0 then
return true
endif
set i=i+1
endloop
return false
endfunction
function IOO takes unit AD1,location I2O returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(AD1))
local unit W41=(LoadUnitHandle(LY,(handle_id),(699)))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
if W41!=null then
call ReviveHeroLoc(W41,I2O,true)
call VS1(W41)
endif
if W51!=null then
call ReviveHeroLoc(W51,I2O,true)
call VS1(W51)
endif
if W61!=null then
call ReviveHeroLoc(W61,I2O,true)
call VS1(W61)
endif
if W71!=null then
call ReviveHeroLoc(W71,I2O,true)
call VS1(W71)
endif
if W81!=null then
call ReviveHeroLoc(W81,I2O,true)
call VS1(W81)
endif
endfunction
function CustomHeroRevive_GetTime takes nothing returns real
return TimerGetElapsed(M)
endfunction
function I3O takes unit SFI,real GW1,boolean I4O returns nothing
set FI0=FI0+1
set EQ0[FI0]=SFI
set EU0[FI0]=(TimerGetElapsed(M))+GW1
set F00[FI0]=I4O
endfunction
function I5O takes integer i returns nothing
local unit AD1=EQ0[i]
local boolean I4O=F00[i]
local player I6O=GetOwningPlayer(AD1)
local location I2O
if IsPlayerTeam2(I6O)then
set I2O=GetRectCenter(S3)
else
set I2O=GetRectCenter(O4)
endif
if Q2==false and IsUnitDead(AD1)then
call VQ1(AD1,I6O,GetLocationX(I2O),GetLocationY(I2O),true)
if I0O(AD1)==false or GetUnitAbilityLevel(AD1,'A0MW')==0 then
call ReviveHeroLoc(AD1,I2O,true)
else
call IOO(AD1,I2O)
endif
call SetUnitState(AD1,UNIT_STATE_MANA,GetUnitState(AD1,UNIT_STATE_MAX_MANA))
endif
call RemoveLocation(I2O)
call UU1(i)
set AD1=null
set I6O=null
set I2O=null
endfunction
function I7O takes nothing returns boolean
local real SOI=(TimerGetElapsed(M))
local integer i
set i=1
loop
exitwhen i>FI0
if EU0[i]<SOI and EU0[i]!=0 then
call I5O(i)
endif
if EU0[i]!=0 and IsUnitDead(EQ0[i])==false then
call UU1(i)
endif
set i=i+1
endloop
return false
endfunction
function I9O takes unit AD1,integer IAO returns nothing
local unit IBO=(LoadUnitHandle(LY,(GetHandleId(AD1)),(788)))
local integer ICO=(LoadInteger(LY,(GetHandleId(IBO)),(787)))
call SaveInteger(LY,(GetHandleId(IBO)),(787),(IMaxBJ(ICO-IAO,0)))
set IBO=null
endfunction
function IDO takes unit IEO,unit IFO returns nothing
if QLI(IEO,IFO)>1300 or(IsUnitDead(IEO)and GetUnitTypeId(IEO)=='H00K')then
if IsPlayerAlly(GetOwningPlayer(IEO),GetOwningPlayer(IFO))==false then
call AddHeroXP(IEO,RUI(IFO),true)
endif
endif
endfunction
function IGO takes nothing returns nothing
if ES1(GetEnumUnit(),FR0[WM0])!=null then
call SetItemCharges(ES1(GetEnumUnit(),FR0[WM0]),GetItemCharges(ES1(GetEnumUnit(),FR0[WM0]))+1)
endif
endfunction
function IHO takes nothing returns boolean
if(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetFilterUnit())==false then
if IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(F30))and ES1(GetFilterUnit(),FR0[WM0])!=null then
return true
endif
endif
return false
endfunction
function IZO takes nothing returns boolean
local item i
local integer EY1
if F50==0 and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetFilterUnit())==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(F40))then
if ES1(GetFilterUnit(),FR0[X60])!=null then
set F50=F50+1
set EY1=GetItemCharges(ES1(GetFilterUnit(),FR0[X60]))
if EY1==0 then
set EY1=2
else
set EY1=EY1+1
endif
call SetItemCharges(ES1(GetFilterUnit(),FR0[X60]),EY1)
endif
endif
return false
endfunction
function AncientJangoo_FindNearbyHeroes takes nothing returns boolean
local item i
local integer EY1
if F60==0 and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetFilterUnit())==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(F40))then
if ES1(GetFilterUnit(),FR0[HP0])!=null then
set F60=F60+1
set EY1=GetItemCharges(ES1(GetFilterUnit(),FR0[HP0]))
set EY1=IMinBJ(EY1+1,5)
call SetItemCharges(ES1(GetFilterUnit(),FR0[HP0]),EY1)
endif
endif
return false
endfunction
function IVO takes unit u,unit IWO returns nothing
local group g=NTI()
set F30=u
call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1625,Condition(function IHO))
if IsUnitAlly(u,GetOwningPlayer(IWO))==false then
call GroupAddUnit(g,IWO)
endif
call ForGroup(g,function IGO)
call NSI(g)
set g=null
endfunction
function IXO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IYO=(LoadUnitHandle(LY,(handle_id),(335)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x
local real y
local real a
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()!=IYO then
call KillUnit(IYO)
endif
else
set a=GetUnitFacing(target)*bj_RADTODEG
set x=GetUnitX(target)+75
set y=GetUnitY(target)+75
call MUSetUnitX(IYO,x)
call MUSetUnitY(IYO,y)
call IssueTargetOrder(IYO,"attack",target)
endif
set t=null
set IYO=null
set target=null
return false
endfunction
function IJO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit IYO
if GetSummoningUnit()==dummy then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set IYO=GetSummonedUnit()
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterDeathEvent(t,IYO)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function IXO))
call SaveUnitHandle(LY,(handle_id),(335),(IYO))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call UnitAddAbility(IYO,'Aloc')
call SetUnitPosition(IYO,GetUnitX(target)+100,GetUnitY(target)+100)
call IssueTargetOrder(IYO,"attack",target)
call SetUnitMoveSpeed(IYO,522)
endif
set t=null
set target=null
set hero=null
set dummy=null
return false
endfunction
function IKO takes unit hero,unit IWO returns nothing
local unit target=IWO
local unit dummy
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if RLI(target)then
set target=(K1[GetPlayerId(GetOwningPlayer((target)))])
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function IJO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call AddSkill(dummy,'A2E7')
call IssueTargetOrderById(dummy,852274,target)
set t=null
set target=null
set dummy=null
endfunction
function ILO takes nothing returns boolean
if(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetFilterUnit())==false then
if IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(F30))==false and ES1(GetFilterUnit(),FR0[HU0])!=null then
endif
endif
return false
endfunction
function IMO takes unit u returns nothing
local group g=NTI()
set F30=u
call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1625,Condition(function ILO))
call NSI(g)
set g=null
endfunction
function INO takes unit u returns nothing
local group g=NTI()
set F50=0
set F40=u
call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1425,Condition(function IZO))
call NSI(g)
set F50=0
set g=null
endfunction
function ISO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer ITO=(LoadInteger(LY,(handle_id),(88)))
local integer i=1
local player p
local string N7I
loop
exitwhen i>5
if ITO==0 then
set p=BO[i]
set N7I=C0[GetPlayerId(BO[0])]+"近卫军团"+"|r "+"正在"+" "+C0[GetPlayerId(BO[0])]+"向胜利迈进！！！"+"|r"
else
set p=CO[i]
set N7I=C0[GetPlayerId(CO[0])]+"天灾军团"+"|r "+"正在"+" "+C0[GetPlayerId(CO[0])]+"向胜利迈进！！！"+"|r"
endif
call DisplayTimedTextToPlayer(p,0,0,10,N7I)
call OQ1(JD,p)
set i=i+1
endloop
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function IRO takes integer ITO returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerAddCondition(t,Condition(function ISO))
call SaveInteger(LY,(handle_id),(88),(ITO))
set t=null
endfunction
function IPO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer IQO=(LoadInteger(LY,(handle_id),(89)))
local string N7I=(LoadStr(LY,(handle_id),(90)))
if IQO==1 then
call OP1(HC)
elseif IQO==2 then
call OP1(AE)
elseif IQO==3 then
call OP1(ME)
elseif IQO==4 then
call OP1(NE)
endif
call QRI(P2,10.00,N7I)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function IUO takes string N7I,integer IQO returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerAddCondition(t,Condition(function IPO))
call SaveStr(LY,(handle_id),(90),(N7I))
call SaveInteger(LY,(handle_id),(89),(IQO))
set t=null
endfunction
function O0O takes player AB1,integer AC1 returns nothing
local integer TGI=1
local integer VW1
if IsPlayerTeam1(AB1)then
set VW1=T8I(OO)
else
set VW1=T8I(AO)
endif
if IsPlayerTeam1(AB1)then
loop
exitwhen TGI>5
if T3I(BO[TGI])then
set EL0[GetPlayerId(BO[TGI])]=EL0[GetPlayerId(BO[TGI])]+AC1/VW1
set EK0[GetPlayerId(BO[TGI])]=EK0[GetPlayerId(BO[TGI])]+AC1/VW1
call AA1(BO[TGI],AC1/VW1,K1[GetPlayerId(BO[TGI])])
endif
set TGI=TGI+1
endloop
else
loop
exitwhen TGI>5
if T3I(CO[TGI])then
set EL0[GetPlayerId(CO[TGI])]=EL0[GetPlayerId(CO[TGI])]+AC1/VW1
set EK0[GetPlayerId(CO[TGI])]=EK0[GetPlayerId(CO[TGI])]+AC1/VW1
call AA1(CO[TGI],AC1/VW1,K1[GetPlayerId(CO[TGI])])
endif
set TGI=TGI+1
endloop
endif
endfunction
function OIO takes unit AD1,integer IAO returns nothing
local player I6O=GetOwningPlayer(AD1)
call SetPlayerState(I6O,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(I6O,PLAYER_STATE_RESOURCE_GOLD)-IAO)
endfunction
function O1O takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())=='o003' then
call KillUnit(GetFilterUnit())
return true
endif
return false
endfunction
function OOO takes nothing returns nothing
local boolexpr QL1=Condition(function O1O)
local group Z51=NTI()
call GroupEnumUnitsInRect(Z51,bj_mapInitialPlayableArea,QL1)
call NSI(Z51)
endfunction
function O2O takes player T1I returns boolean
if T1I==DO then
return true
endif
return false
endfunction
function O3O takes nothing returns boolean
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and GetUnitTypeId(GetTriggerUnit())!='N0MM' then
if GetUnitTypeId(GetTriggerUnit())=='H00J' and I1O(GetTriggerUnit())then
return false
endif
return true
endif
return false
endfunction
function O4O takes player I6O,player AB1,unit UX1 returns boolean
return UX1==null or GetKillingUnit()==null or(IsPlayerTeam1(I6O)and IsPlayerTeam1(AB1))or(IsPlayerTeam2(I6O)and IsPlayerTeam2(AB1))
endfunction
function O5O takes nothing returns nothing
if V51(GetUnitTypeId(GetEnumUnit()))==false then
set FC0=FC0+1
set FD0=FD0+1
endif
endfunction
function O6O takes nothing returns nothing
if(GetUnitTypeId((GetEnumUnit()))=='H00J')==false and V51(GetUnitTypeId(GetEnumUnit()))==false then
call AddHeroXP(GetEnumUnit(),F90,true)
set FA0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=FA0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]+F90
set FB0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=FB0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]+F80
set EL0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=EL0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]+F80
set EK0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=EK0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]+F80
call AA1(GetOwningPlayer(GetEnumUnit()),F80,GetEnumUnit())
endif
endfunction
function O7O takes player p returns integer
local integer O8O=0
local integer i=1
local player p2
loop
exitwhen i==6
set p2=BO[i]
if IsPlayerAlly(p,p2)then
set O8O=O8O+GetHeroXP(K1[GetPlayerId(p2)])
endif
set p2=CO[i]
if IsPlayerAlly(p,p2)then
set O8O=O8O+GetHeroXP(K1[GetPlayerId(p2)])
endif
set i=i+1
endloop
return O8O
endfunction
function O9O takes nothing returns boolean
return(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or CI1(GetFilterUnit()))and IsUnitIllusion(GetFilterUnit())==false
endfunction
function OAO takes player p returns integer
local integer OBO=0
local group g=NTI()
local unit u
local integer i
local item BA1
call GroupEnumUnitsOfPlayer(g,p,Condition(function O9O))
loop
exitwhen FirstOfGroup(g)==null
set u=FirstOfGroup(g)
set i=0
loop
exitwhen i==6
set BA1=UnitItemInSlot(u,i)
if BA1!=null and GetItemPlayer(BA1)==p then
set OBO=OBO+(FU0[GetItemId((BA1))])
endif
set i=i+1
endloop
call GroupRemoveUnit(g,u)
endloop
call NSI(g)
set OBO=OBO+GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
return OBO
endfunction
function OCO takes player p returns integer
local integer ODO=0
local integer i=1
local player p2
loop
exitwhen i==6
set p2=BO[i]
if IsPlayerAlly(p,p2)then
set ODO=ODO+OAO(p2)
endif
set p2=CO[i]
if IsPlayerAlly(p,p2)then
set ODO=ODO+OAO(p2)
endif
set i=i+1
endloop
return ODO
endfunction
function OEO takes nothing returns boolean
local integer level
local real OFO=0
local real OGO=0
local group g
local player OHO
local player OZO
local integer OVO
local integer OWO
local real OXO
local real OYO
local real OJO
local real OKO
local real OLO
local real OMO
local real ONO
local real OSO
local real OTO
local unit ORO=F70
if IsUnitType(ORO,UNIT_TYPE_HERO)==true and IsUnitIllusion(ORO)==false and(GetUnitTypeId((ORO))=='H00J')==false and V51(GetUnitTypeId(ORO))==false then
set level=GetHeroLevel(ORO)
set F90=0
set F80=0
set g=NTI()
set FC0=0
set FD0=0
set GK=ORO
call GroupEnumUnitsInRange(g,GetUnitX(ORO),GetUnitY(ORO),1300+25,Condition(function D01))
call ForGroup(g,function O5O)
if IsPlayerAlly(GetOwningPlayer(ORO),BO[0])then
set OHO=BO[0]
set OZO=CO[0]
else
set OHO=CO[0]
set OZO=BO[0]
endif
set OVO=level
set OWO=GetHeroXP(ORO)
set OXO=O7O(OHO)
set OYO=O7O(OZO)+1
set OJO=RMaxBJ((OXO-OYO)/(OXO+OYO),0)
set OKO=OJO*OWO
set OLO=OAO(GetOwningPlayer(ORO))
set OMO=OCO(OHO)
set ONO=OCO(OZO)+1
set OSO=RMaxBJ(RMinBJ(OMO/ONO-1,1),0)
set OTO=OSO*OLO
if FC0==1 then
set OFO=20*OVO+OKO*0.23
elseif FC0==2 then
set OFO=15*OVO+OKO*0.23
elseif FC0==3 then
set OFO=10*OVO+OKO*0.2
elseif FC0==4 then
set OFO=7*OVO+OKO*0.15
elseif FC0==5 then
set OFO=5*OVO+OKO*0.12
endif
if FD0==1 then
set OGO=40+7*level+0.05*OTO
elseif FD0==2 then
set OGO=30+6*level+0.05*OTO
elseif FD0==3 then
set OGO=20+5*level+0.05*OTO
elseif FD0==4 then
set OGO=10+4*level+0.04*OTO
elseif FD0==5 then
set OGO=10+4*level+0.03*OTO
endif
if R0 then
endif
set F90=R2I(OFO)
set F80=R2I(OGO)
call ForGroup(g,function O6O)
call NSI(g)
set g=null
endif
return false
endfunction
function OPO takes nothing returns nothing
local boolean OQO=false
local unit AD1=GetDyingUnit()
local unit UX1=GetKillingUnit()
local player AB1=GetOwningPlayer(UX1)
local player I6O=GetOwningPlayer(AD1)
local location I2O
local integer AC1=0
local integer IAO=0
local boolean OUO=false
local string A0O=""
local string AIO=""
local string A1O=""
local string MidText
local integer x
local string AOO
local string A2O
local string A3O
local string A4O
local boolean I4O=false
local real A5O=1
local real A6O=1
local real A7O=1
local real A8O=1
local real A9O=0
local real AAO=1
local trigger t
local integer ABO
local integer ACO
local integer id
local integer ADO=GetPlayerState(I6O,PLAYER_STATE_RESOURCE_GOLD)
local integer AEO=ADO-EL0[GetPlayerId(I6O)]
local unit AFO
local unit AGO
local boolean AHO=((LoadInteger(LY,(GetHandleId((AD1))),((4418))))==1)
if IsPlayerAlly(AB1,I6O)==false and O2O(AB1)==false then
set F70=GetTriggerUnit()
call ExecuteFunc("OEO")
endif
if AHO then
set XS[GetPlayerId((I6O))]=true
endif
if UX1==null and GetUnitTypeId(AD1)=='Npbm' then
set UX1=YXI
set AB1=GetOwningPlayer(UX1)
endif
if IsPlayerAlly(AB1,I6O)==true and((LoadInteger(LY,(GetHandleId((UX1))),((4328))))==1)==true and KDI!=null then
set UX1=KDI
set AB1=GetOwningPlayer(UX1)
endif
if((LoadInteger(LY,(GetHandleId((AD1))),((4333))))==1)then
set UX1=ZJI
set AB1=GetOwningPlayer(UX1)
endif
set ACO=UN1(AD1,UX1)
if UX1!=null then
set id=GetUnitTypeId(UX1)
call IDO(K1[GetPlayerId(GetOwningPlayer(UX1))],AD1)
endif
if O4O(I6O,AB1,UX1)==false and ACO==1 and T2I(AB1)==false and AB1!=DO then
call US1(AD1,UX1)
set AB1=EP0[1]
set UX1=K1[GetPlayerId(AB1)]
endif
if IsPlayerTeam1(GetOwningPlayer(AD1))then
if GetOwningPlayer(AD1)!=BO[1]then
endif
if GetOwningPlayer(AD1)!=BO[2]then
endif
if GetOwningPlayer(AD1)!=BO[3]then
endif
if GetOwningPlayer(AD1)!=BO[4]then
endif
if GetOwningPlayer(AD1)!=BO[5]then
endif
else
if GetOwningPlayer(AD1)!=CO[1]then
endif
if GetOwningPlayer(AD1)!=CO[2]then
endif
if GetOwningPlayer(AD1)!=CO[3]then
endif
if GetOwningPlayer(AD1)!=CO[4]then
endif
if GetOwningPlayer(AD1)!=CO[5]then
endif
endif
set HJ[GetPlayerId(GetOwningPlayer((AD1)))]=true
if GetUnitAbilityLevel(AD1,'A0OV')!=0 or(I0O(AD1)and IIO(AD1))then
set I4O=true
call UnitRemoveAbility(AD1,'A0OV')
set XO=AD1
set A2=UX1
if IsUnitType(UX1,UNIT_TYPE_STRUCTURE)==false then
endif
endif
if AB1==null then
set AB1=I6O
endif
if L0 and GetUnitTypeId(AD1)!='H00J' then
set K2=UnitRemoveItemFromSlot(AD1,GetRandomInt(0,5))
if GetItemTypeId(K2)=='I00K' then
call CreateItem('I00G',GetItemX(K2),GetItemY(K2))
call RemoveItem(K2)
endif
endif
if IsPlayerTeam1(I6O)then
if IsPlayerTeam1(AB1)then
set OQO=true
if(AB1==I6O)then
call QRI(P2,10.00,(C0[GetPlayerId(I6O)]+(D80[GetPlayerId((I6O))])+"|r "+"自杀了！"))
else
call QRI(P2,10.00,GI1(I6O,AB1))
endif
elseif IsPlayerTeam2(AB1)then
set OUO=true
set O[GetPlayerId(BO[0])]=O[GetPlayerId(BO[0])]+1
set I[GetPlayerId(CO[0])]=I[GetPlayerId(CO[0])]+1
set I0[2]=I0[2]+1
set I0[1]=0
if AB1!=CO[0]then
set I[GetPlayerId(AB1)]=I[GetPlayerId(AB1)]+1
set P[GetPlayerId(AB1)]=P[GetPlayerId(AB1)]+1
endif
endif
endif
if IsPlayerTeam2(I6O)then
if IsPlayerTeam2(AB1)then
set OQO=true
if(AB1==I6O)then
call QRI(P2,10.00,(C0[GetPlayerId(I6O)]+(D80[GetPlayerId((I6O))])+"|r "+"自杀了！"))
else
call QRI(P2,10.00,GI1(I6O,AB1))
endif
elseif IsPlayerTeam1(AB1)then
set OUO=true
set O[GetPlayerId(CO[0])]=O[GetPlayerId(CO[0])]+1
set I[GetPlayerId(BO[0])]=I[GetPlayerId(BO[0])]+1
set I0[1]=I0[1]+1
set I0[2]=0
if AB1!=BO[0]then
set I[GetPlayerId(AB1)]=I[GetPlayerId(AB1)]+1
set P[GetPlayerId(AB1)]=P[GetPlayerId(AB1)]+1
endif
endif
endif
if AB1==DO then
set OUO=false
if GetUnitTypeId(UX1)=='n00L' then
call QRI(P2,10.00,(C0[GetPlayerId(I6O)]+(D80[GetPlayerId((I6O))])+"|r "+"被Roshan杀死了"))
else
call QRI(P2,10.00,(C0[GetPlayerId(I6O)]+(D80[GetPlayerId((I6O))])+"|r "+"被中立生物杀死了"))
endif
set OQO=true
endif
if VN then
call IO1(WC,GetUnitX(AD1),GetUnitY(AD1))
endif
call FL1("Hero"+I2S(GetPlayerId(I6O)),GetPlayerId(AB1))
set x=P[GetPlayerId(I6O)]
if x>2 and OQO==false then
if x==3 then
set AC1=60
set A0O="|c0000ff40"+"大杀特杀"+"|r"
elseif x==4 then
set AC1=120
set A0O="|c00400080"+"主宰比赛"+"|r"
elseif x==5 then
set AC1=180
set A0O="|c00ff0080"+"杀人如麻"+"|r"
elseif x==6 then
set AC1=240
set A0O="|c00ff8000"+"无人能挡"+"|r"
elseif x==7 then
set AC1=300
set A0O="|c00808000"+"变态杀戮"+"|r"
elseif x==8 then
set AC1=360
set A0O="|c00ff80ff"+"妖怪般的杀戮"+"|r"
elseif x==9 then
set AC1=420
set A0O="|c00ff0000"+"如同神一般"+"|r"
else
set AC1=480
set A0O="|c00ff8000"+"超越神的杀戮"+"|r"
endif
endif
set x=P[GetPlayerId(AB1)]
if x>H[GetPlayerId(AB1)]then
set H[GetPlayerId(AB1)]=x
endif
set AFO=UX1
if IsUnitType(AFO,UNIT_TYPE_HERO)==false then
set AFO=K1[GetPlayerId(GetOwningPlayer(AFO))]
endif
if x>2 and GetUnitTypeId(AFO)!='U00F' and PA0[GetPlayerId(GetOwningPlayer(AFO))]==0 then
endif
set AGO=AD1
if IsUnitType(AGO,UNIT_TYPE_HERO)==false then
set AGO=K1[GetPlayerId(GetOwningPlayer(AGO))]
endif
if OQO==false and OUO==true then
endif
if x>2 and OQO==false then
if x==3 then
call OP1(RC)
set AIO=" "+"正在"+" |c0000ff40"+"大杀特杀"+"|r"+"！"
elseif x==4 then
call OP1(GC)
set AIO=" "+"已经"+" |c00400080"+"主宰比赛"+"|r"+"！"
elseif x==5 then
call OP1(QC)
set AIO=" "+"已经"+" |c00ff0080"+"杀人如麻"+"|r"+"！"
elseif x==6 then
call OP1(EE)
set AIO=" "+"已经"+" |c00ff8000"+"无人能挡"+"|r"+"！！"
elseif x==7 then
call OP1(HE)
set AIO=" "+"已经"+" |c00808000"+"变态杀戮"+"|r"+"！！"
elseif x==8 then
call OP1(OD)
set AIO=" "+"已经"+" |c00ff80ff"+"妖怪般的杀戮"+"|r"+"！！"
elseif x==9 then
call OP1(XC)
set AIO=" "+"已经"+" |c00ff0000"+"如同神一般"+"|r"+"！！！"
else
call OP1(JC)
set AIO=" "+"已经"+" |c00ff8000"+"超越神的杀戮"+"|r. "+"拜托谁去杀了他吧！！！"+"！！！"
endif
endif
if OQO==false then
set AC1=AC1+100+GetHeroLevel(AD1)*9+100
set AOO=C0[GetPlayerId(I6O)]+(D80[GetPlayerId((I6O))])+"|r"
set A2O=C0[GetPlayerId(AB1)]+(D80[GetPlayerId((AB1))])+"|r"
set A4O="|c00FFDC00"+I2S(AC1)+"|r"
if AB1==BO[0]or AB1==CO[0]then
if ACO==0 then
if AB1==BO[0]then
set A3O=A2O+" "+"杀死了"+" "+AOO+"！"+"！"+" "+A4O+" "+"金钱平分给英雄们"+"."
call O0O(AB1,AC1)
elseif AB1==CO[0]then
set A3O=A2O+" "+"杀死了"+" "+AOO+"！"+"！"+" "+A4O+" "+"金钱平分给英雄们"+"."
call O0O(AB1,AC1)
endif
elseif ACO>1 then
set A3O=A2O+" "+"杀死了"+" "+AOO+"！"+"！"+" "+A4O+" "+"金钱平分给英雄们"+"."
call UT1(AD1,UX1,AC1)
endif
elseif A0O==""and AIO==""then
set A3O=A2O+" "+"杀死了"+" "+AOO+"！"+" "+"得到"+" "+A4O+" "+"金钱！"+"！"
elseif A0O==""and AIO!=""then
set A3O=A2O+" "+"杀死了"+" "+AOO+"！"+" "+"得到"+" "+A4O+" "+"金钱！"+"！"
elseif A0O!=""and AIO==""then
set A3O=A2O+" "+"终结了"+" "+AOO+" 的"+" "+A0O+" "+"得到"+" "+A4O+" "+"金钱！"+"！"
elseif A0O!=""and AIO!=""then
set A3O=A2O+" "+"终结了"+" "+AOO+" 的"+" "+A0O+" "+"得到"+" "+A4O+" "+"金钱！"+"！"
endif
if OUO then
set A1O=UW1(AD1,UX1)
endif
call QRI(P2,10,A3O+A1O)
if AIO!=""then
call QRI(P2,10,A2O+AIO)
endif
set EL0[GetPlayerId(AB1)]=EL0[GetPlayerId(AB1)]+AC1
set EK0[GetPlayerId(AB1)]=EK0[GetPlayerId(AB1)]+AC1
call AA1(AB1,AC1,AD1)
set Y[GetPlayerId(AB1)]=Y[GetPlayerId(AB1)]+AC1
if I0[1]>4 then
call IRO(0)
endif
if I0[2]>4 then
call IRO(1)
endif
endif
set IAO=GetHeroLevel(AD1)*30
if ES1(AD1,FR0[WM0])!=null then
if GetItemCharges(ES1(AD1,FR0[WM0]))>0 then
set A9O=-1*(4*GetItemCharges(ES1(AD1,FR0[WM0])))
set IAO=IMaxBJ(R2I(IAO-25*GetItemCharges(ES1(AD1,FR0[WM0]))),0)
endif
endif
if IAO>AEO then
set IAO=AEO
endif
call IVO(AD1,AFO)
call INO(AD1)
call IMO(AD1)
if I4O==false then
set G[GetPlayerId(I6O)]=G[GetPlayerId(I6O)]+IAO
call OIO(AD1,IAO)
call I9O(AD1,IAO)
endif
call SaveInteger(LY,(400+GetPlayerId(AB1)),(450+GetPlayerId(I6O)),((LoadInteger(LY,(400+GetPlayerId(AB1)),(450+GetPlayerId(I6O))))+1))
call SaveInteger(LY,(400+GetPlayerId(I6O)),(500+GetPlayerId(AB1)),((LoadInteger(LY,(400+GetPlayerId(I6O)),(500+GetPlayerId(AB1))))+1))
call StartTimerBJ(E0[GetPlayerId(AB1)],false,18)
if OQO==false and AB1!=BO[0]and AB1!=CO[0]and AB1!=DO then
set Q[GetPlayerId(AB1)]=Q[GetPlayerId(AB1)]+1
if Q[GetPlayerId(AB1)]==2 then
set Z[GetPlayerId(AB1)]=Z[GetPlayerId(AB1)]+1
call IUO(C0[GetPlayerId(AB1)]+(D80[GetPlayerId((AB1))])+"|r "+"完成了一次"+" |c000000ff"+"双杀"+"|r"+"！",1)
endif
if Q[GetPlayerId(AB1)]==3 then
set V[GetPlayerId(AB1)]=V[GetPlayerId(AB1)]+1
call IUO(C0[GetPlayerId(AB1)]+(D80[GetPlayerId((AB1))])+"|r "+"完成了一次"+" |c0000ff40"+"三杀"+"|r"+"！！！",2)
endif
if Q[GetPlayerId(AB1)]==4 then
set V[GetPlayerId(AB1)]=V[GetPlayerId(AB1)]+1
call IUO(C0[GetPlayerId(AB1)]+(D80[GetPlayerId((AB1))])+"|r "+"完成了一次"+" |c0000FFFF"+"疯狂杀戮"+"|r"+"！！！",3)
endif
if Q[GetPlayerId(AB1)]>4 then
set V[GetPlayerId(AB1)]=V[GetPlayerId(AB1)]+1
call IUO(C0[GetPlayerId(AB1)]+(D80[GetPlayerId((AB1))])+"|r "+"正在"+" |c0000AAFF"+"暴走"+"|r"+"！！！",4)
endif
endif
if(OQO==false)then
set P[GetPlayerId(I6O)]=0
endif
set P[0]=0
set P[6]=0
set O[GetPlayerId(I6O)]=O[GetPlayerId(I6O)]+1
if I4O then
set A5O=0.4
endif
if OQO==true and GetUnitTypeId(AD1)=='H00K' then
set A8O=0.5
endif
set ABO=R2I((GetHeroLevel(AD1)*3.8+5)*A5O*A6O*A7O*A8O)+R2I(A9O)
if OCI==true then
set ABO=R2I(ABO*0.5)
endif
set ABO=ABO+YS[GetPlayerId(I6O)]
if(((LoadInteger(LY,(GetHandleId((AD1))),((4333))))==1)==true)then
set ABO=R2I(ABO+30)
endif
if GetUnitAbilityLevel(AD1,'A0MW')==1 or GetUnitAbilityLevel(AD1,'A27C')==1 then
set AAO=0.8
endif
if GetUnitAbilityLevel(AD1,'A0MW')==2 or GetUnitAbilityLevel(AD1,'A27C')==2 then
set AAO=0.8
endif
if GetUnitAbilityLevel(AD1,'A0MW')==3 or GetUnitAbilityLevel(AD1,'A27C')==3 then
set AAO=0.8
endif
set ABO=R2I(ABO*AAO)
if WL then
set W[GetPlayerId(I6O)]=0
call TimerStart(F0[GetPlayerId(I6O)],1.00,false,null)
else
set W[GetPlayerId(I6O)]=W[GetPlayerId(I6O)]+ABO
call TimerStart(F0[GetPlayerId(I6O)],ABO,false,null)
endif
call TriggerExecute(CH)
if X0==false then
call I3O(AD1,ABO,I4O)
else
if(IsPlayerTeam1(I6O))then
set W0[0]=W0[0]+1
endif
if IsPlayerTeam2(I6O)then
set W0[1]=W0[1]+1
endif
set U1[GetPlayerId(I6O)]=AD1
if GetUnitTypeId(AD1)=='H00J' then
set U1[GetPlayerId(I6O)]=(LoadUnitHandle(LY,(GetHandleId(GetOwningPlayer(AD1))),(699)))
endif
if W0[0]==YL then
call TriggerExecute(PK)
endif
if W0[1]==YL then
call TriggerExecute(RK)
endif
if(GetUnitTypeId(AD1)=='U006')then
call ExecuteFunc("OOO")
elseif GetUnitTypeId(AD1)=='U008' or GetUnitTypeId(AD1)=='E015' then
set NK=AD1
call ExecuteFunc("AZO")
elseif GetUnitTypeId(AD1)=='Ucrl' then
set NK=AD1
call ExecuteFunc("AVO")
endif
endif
endfunction
function AXO takes integer MSI,integer AYO returns nothing
set FF0[FE0]=MSI
set FG0[FE0]=AYO
set FE0=FE0+1
endfunction
function AKO takes unit hero returns integer
local integer i=0
local integer MSI=GetUnitTypeId(hero)
loop
exitwhen i>FE0
if FF0[i]==MSI then
return FG0[i]
endif
set i=i+1
endloop
return-1
endfunction
function ALO takes unit hero returns integer
local integer AMO=AKO(hero)
if AMO==-1 then
if IsUnitType(hero,UNIT_TYPE_HERO)==true then
set AMO=RUI(hero)
else
set AMO=SQI(GetUnitLevel(hero))
endif
endif
if IsUnitType(hero,UNIT_TYPE_SUMMONED)==true then
set AMO=R2I(AMO*0.5)
endif
return AMO
endfunction
function ANO takes nothing returns nothing
call AddHeroXP(GetEnumUnit(),FH0,true)
endfunction
function ASO takes nothing returns boolean
local unit target=GetFilterUnit()
local unit ATO=GetDyingUnit()
local integer MSI=GetUnitTypeId(target)
if(GetOwningPlayer((ATO))==DO)==false or IsUnitType(ATO,UNIT_TYPE_ANCIENT)==true then
if IsUnitEnemy(target,GetOwningPlayer(ATO))==false then
return false
endif
endif
if IsUnitType(target,UNIT_TYPE_HERO)==false or IsUnitDead(target)then
return false
endif
if B81(MSI)then
return false
endif
if QNI(FZ0,FV0,GetUnitX(target),GetUnitY(target))>1300+25 then
return false
endif
return true
endfunction
function ARO takes nothing returns boolean
local unit APO=GetKillingUnit()
local unit ATO=GetDyingUnit()
local integer AMO=ALO(ATO)
local integer NPI
local group g
local group g2
local real x=GetUnitX(ATO)
local real y=GetUnitY(ATO)
local player p
if IsUnitIllusion(ATO)or GetUnitAbilityLevel(ATO,'Aloc')>0 or AMO==0 then
return false
endif
if APO==null or IsPlayerAlly(GetOwningPlayer(APO),GetOwningPlayer(ATO))==true or(GetOwningPlayer((APO))==DO)then
return false
endif
set g=NTI()
set g2=NTI()
set FZ0=x
set FV0=y
set p=BO[1]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=BO[2]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=BO[3]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=BO[4]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=BO[5]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=CO[1]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=CO[2]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=CO[3]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=CO[4]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set p=CO[5]
call GroupEnumUnitsOfPlayer(g,p,Condition(function ASO))
call GroupAddGroup(g,g2)
set NPI=CountUnitsInGroup(g2)
if NPI>0 then
set FH0=AMO/NPI
call ForGroup(g2,function ANO)
endif
call NSI(g)
call NSI(g2)
set g=null
set g2=null
set APO=null
set ATO=null
return false
endfunction
function AUO takes nothing returns boolean
local unit IYO=GetSummonedUnit()
local integer x
if IsUnitIllusion(IYO)==true then
set x=P[GetPlayerId(GetOwningPlayer(IYO))]
if x>2 and PA0[GetPlayerId(GetOwningPlayer(IYO))]==0 then
call AddSkill(IYO,'A2KJ')
else
call UnitRemoveAbility(IYO,'A2KJ')
endif
endif
set IYO=null
return false
endfunction
function BIO takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local player AB1=GetOwningPlayer(GetKillingUnit())
local player I6O=GetOwningPlayer(GetTriggerUnit())
local string N7I
local integer ACO=UN1(GetTriggerUnit(),GetKillingUnit())
if AB1==BO[0]or AB1==CO[0]then
call UT1(GetTriggerUnit(),GetKillingUnit(),150)
set N7I=UM1(GetTriggerUnit(),GetKillingUnit())+" "+"拿下了"+" |c00ff0303"+"第一滴血"+"！"+"|r "
if ACO>1 then
set N7I=N7I+"(+150 "+"金钱平分给英雄们"+")"
else
set N7I=N7I+"(+150 "+"金钱！"+")"
endif
else
set N7I=C0[GetPlayerId(AB1)]+(D80[GetPlayerId((AB1))])+"|r "+"拿下了"+" |c00ff0303"+"第一滴血"+"！"+"|r "
set N7I=N7I+"(+150 "+"金钱！"+")"
call AA1(AB1,150,K1[GetPlayerId(AB1)])
set EL0[GetPlayerId(AB1)]=EL0[GetPlayerId(AB1)]+150
set EK0[GetPlayerId(AB1)]=EK0[GetPlayerId(AB1)]+150
endif
call QRI(P2,10,N7I)
call OP1(ZC)
call FlushTrigger(t)
set t=null
endfunction
function B1O takes nothing returns boolean
if GetOwningPlayer(GetKillingUnit())!=DO and GetKillingUnit()!=null and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and IsPlayerEnemy(GetOwningPlayer(GetTriggerUnit()),GetOwningPlayer(GetKillingUnit()))==true then
if GetOwningPlayer(GetKillingUnit())==BO[0]or GetOwningPlayer(GetKillingUnit())==CO[0]then
if UN1(GetTriggerUnit(),GetKillingUnit())>0 then
call BIO()
endif
else
call BIO()
endif
endif
return false
endfunction
function B2O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if NPI>4 or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetEventDamage()>0)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+0.2*GetUnitState(hero,UNIT_STATE_MAX_LIFE))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+0.2*GetUnitState(hero,UNIT_STATE_MAX_MANA))
set t=null
set hero=null
return false
endfunction
function B3O takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1.0,true)
call TriggerAddCondition(t,Condition(function B2O))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endfunction
function B4O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u
local region r
local integer level=1+R2I((TimerGetElapsed(M))/240)
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set u=(LoadUnitHandle(LY,(handle_id),(53)))
call SetUnitAbilityLevel(u,'ACtc',level)
set r=CreateRegion()
call RegionAddRect(r,PA)
call RegionAddRect(r,QA)
call RegionAddRect(r,PB)
if IsUnitInRegion(r,u)==false then
if(LoadBoolean(LY,(handle_id),(91)))==true then
call SaveBoolean(LY,(handle_id),(91),(false))
else
call MUSetUnitX(u,GetRectCenterX(P4))
call MUSetUnitY(u,GetRectCenterY(P4))
call SaveBoolean(LY,(handle_id),(91),(true))
endif
endif
call RemoveRegion(r)
set u=null
set r=null
endif
set t=null
return false
endfunction
function B5O takes unit u returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,10,true)
call TriggerAddCondition(t,Condition(function B4O))
call SaveUnitHandle(LY,(handle_id),(53),(u))
call SaveBoolean(LY,(handle_id),(91),(true))
set t=null
endfunction
function B6O takes nothing returns boolean
local item BA1
local integer NPI=GetTriggerEvalCount(GetTriggeringTrigger())
if NPI==FK0 then
call FlushTrigger(GetTriggeringTrigger())
endif
if NPI==FK0-180 or NPI==FK0-60 then
if FW0!=null then
set BA1=ES1(FW0,FR0[VL0])
if BA1!=null then
if NPI==FK0-180 then
if IsPlayerTeam1(GetOwningPlayer(FW0))then
call QRI(OO,15,"距离Roshan收回不朽之守护还有"+" |c00ff0303"+"3分钟"+"|r")
else
call QRI(AO,15,"距离Roshan收回不朽之守护还有"+" |c00ff0303"+"3分钟"+"|r")
endif
else
if IsPlayerTeam1(GetOwningPlayer(FW0))then
call QRI(OO,15,"距离Roshan收回不朽之守护还有"+" |c00ff0303"+"1分钟"+"|r")
else
call QRI(AO,15,"距离Roshan收回不朽之守护还有"+" |c00ff0303"+"1分钟"+"|r")
endif
endif
endif
endif
endif
set BA1=null
return false
endfunction
function B7O takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function B6O))
call TriggerEvaluate(t)
set t=null
endfunction
function B8O takes nothing returns boolean
set FY0=GetTriggerEvalCount(GetTriggeringTrigger())
if N0!=null and GetUnitState(N0,UNIT_STATE_LIFE)>1 then
call SetPlayerTechResearched(GetOwningPlayer(N0),'R00F',FY0)
call MUAddMaxLife(N0, 600) //
if GetUnitAbilityLevel(N0,'A142')==0 then
call UnitAddAbility(N0,'A142')
endif
call SetUnitAbilityLevel(N0,'A142',FY0+1)
endif
return false
endfunction
function B9O takes nothing returns nothing
local integer i=1
local unit SFI
set FW0=null
loop
exitwhen i>5
set SFI=K1[GetPlayerId(BO[i])]
if SFI!=null and ES1(SFI,FR0[VL0])!=null then
call MUDisableItemTrigger()
call FL1("AegisOff",GetPlayerId(GetOwningPlayer(SFI)))
call RemoveItem(ES1(SFI,FR0[VL0]))
call B3O(SFI)
call MUEnableItemTrigger()
endif
set SFI=K1[GetPlayerId(CO[i])]
if SFI!=null and ES1(SFI,FR0[VL0])!=null then
call MUDisableItemTrigger()
call FL1("AegisOff",GetPlayerId(GetOwningPlayer(SFI)))
call RemoveItem(ES1(SFI,FR0[VL0]))
call B3O(SFI)
call MUEnableItemTrigger()
endif
set i=i+1
endloop
set SFI=null
endfunction
function BAO takes string BBO,string BCO returns string
local string s="Roshan被$team杀死了！每个$team的玩家获得200金钱"
set s=FS1(s,"$team",BBO)
set s=FS1(s,"$team",BCO)
return s
endfunction
function BDO takes nothing returns boolean
return GetUnitTypeId(GetDyingUnit())=='n00L'
endfunction
function IsHero takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true
endfunction
function BEO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local location BFO
local real SKI
if GetTriggerEvalCount(t)==FJ0 or R90 then
set R90=false
set BFO=GetRectCenter(P4)
call B9O()
set FM0=FM0+1
set N0=CreateUnitAtLoc(Player(12),'n00L',BFO,bj_UNIT_FACING)
call SetUnitAcquireRange(N0,150)
call B5O(N0)
call UnitAddAbility(N0,'A142')
call SetPlayerTechResearched(GetOwningPlayer(N0),'R00F',FY0)
call MUAddMaxLife(N0, FY0 * 600) //
call SetUnitAbilityLevel(N0,'A142',FY0+1)
call RemoveLocation(BFO)
if FM0>1 then
call UnitRemoveAbility(N0,'A0K2')
call UnitAddAbility(N0,'A0Q6')
call UnitAddItem(N0,CreateItem(FR0[ZE0],0,0))
endif
call UnitAddItem(N0,CreateItem(FR0[VL0],0,0))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)==FK0 then
call B9O()
endif
set t=null
return false
endfunction
function BGO takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function BEO))
set R90=false
set FJ0=GetRandomInt(480,660)
call B7O()
set FX0=false
if(IsPlayerTeam1(GetOwningPlayer(GetKillingUnit())))then
call FL1("Roshan",0)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,BAO("|c00ff0000"+"近卫军团"+"|r","近卫军团"))
call AdjustPlayerStateBJ(200,BO[1],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,BO[2],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,BO[3],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,BO[4],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,BO[5],PLAYER_STATE_RESOURCE_GOLD)
endif
if(IsPlayerTeam2(GetOwningPlayer(GetKillingUnit())))then
call FL1("Roshan",1)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,BAO("|c00004000"+"天灾军团"+"|r","天灾军团"))
call AdjustPlayerStateBJ(200,CO[1],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,CO[2],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,CO[3],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,CO[4],PLAYER_STATE_RESOURCE_GOLD)
call AdjustPlayerStateBJ(200,CO[5],PLAYER_STATE_RESOURCE_GOLD)
endif
set t=null
endfunction
function BZO takes nothing returns nothing
local texttag t=CreateTextTag()
local unit u=GetTriggerUnit()
local player p=GetOwningPlayer(GetKillingUnit())
call SetTextTagText(t,"$",0.027)
call SetTextTagPosUnit(t,u,0)
call SetTextTagColorBJ(t,D90[GetPlayerId(p)],DA0[GetPlayerId(p)],DB0[GetPlayerId(p)],15)
call SetTextTagVelocity(t,0,0.035)
call SetTextTagFadepoint(t,3)
call SetTextTagLifespan(t,1.5)
call SetTextTagPermanent(t,false)
call SetTextTagVisibility(t,false)
if GetLocalPlayer()==D60 or GetLocalPlayer()==D70 then
call SetTextTagVisibility(t,true)
endif
set t=null
set u=null
set p=null
endfunction
function BVO takes unit u,player p returns nothing
local texttag t=CreateTextTag()
call SetTextTagText(t,"!",0.03)
call SetTextTagPosUnit(t,u,0)
call SetTextTagColorBJ(t,D90[GetPlayerId(p)],DA0[GetPlayerId(p)],DB0[GetPlayerId(p)],15)
call SetTextTagVelocity(t,0,0.035)
call SetTextTagFadepoint(t,3)
call SetTextTagLifespan(t,1.5)
call SetTextTagPermanent(t,false)
call SetTextTagVisibility(t,false)
if RN0[GetPlayerId(GetLocalPlayer())]==true or(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))then
call SetTextTagVisibility(t,true)
endif
set t=null
endfunction
function BWO takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_MELEE_ATTACKER)==true then
call AddHeroXP(GetEnumUnit(),OK/UJ,true)
else
call AddHeroXP(GetEnumUnit(),IK/UJ,true)
endif
endfunction
function BXO takes nothing returns nothing
local group g=NTI()
local integer BYO
local integer BJO=20
local integer BKO=31
call GroupEnumUnitsInRange(g,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),1300+25,Condition(function D01))
set BYO=O51(g)
set UJ=BYO
set IK=BJO
set OK=BKO
call ForGroup(g,function BWO)
call NSI(g)
call BVO(GetDyingUnit(),GetOwningPlayer(GetKillingUnit()))
set g=null
endfunction
function BLO takes nothing returns boolean
if IsUnitAlly(GetKillingUnit(),GetOwningPlayer(GetTriggerUnit()))==true then
call BXO()
else
if C2 and T2I(GetOwningPlayer(GetKillingUnit()))then
call BZO()
endif
endif
return false
endfunction
function BNO takes player G11,player GO1 returns string
local string s="$dead的信使被杀死了！"
set s=FS1(s,"$dead",(D80[GetPlayerId((G11))]))
return s
endfunction
function BSO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
call SetTerrainPathable(x,y,PATHING_TYPE_WALKABILITY,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function BTO takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
call SetTerrainPathable(x,y,PATHING_TYPE_WALKABILITY,true)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function BSO))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set hero=null
set t=null
endfunction
function BRO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit BPO=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=GetTriggerEvalCount(t)
local integer BQO
local integer i=1
local integer id
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer BUO=140
// todo:这里直接判断的单位类型,如果被变形了就会判断错误,要改
if RXI(BPO)then
set BUO=180
endif
set BQO=BUO-NPI
loop
exitwhen i>5
if IsPlayerAlly(GetOwningPlayer(BPO),BO[0])then
set id=GetPlayerId(BO[i])
else
set id=GetPlayerId(CO[i])
endif
set i=i+1
if BQO==0 then
call LeaderboardDisplay(FN0[id],false)
if IsPlayerAlly(BO[0],Player(id))then
set FS0[GetPlayerId(BO[0])]=false
endif
if IsPlayerAlly(CO[0],Player(id))then
set FS0[GetPlayerId(CO[0])]=false
endif
else
if IsUnitDead(K1[id])==false then
call PlayerSetLeaderboard(Player(id),FN0[id])
call LeaderboardDisplay(FN0[id],true)
call LeaderboardSetLabel(FN0[id],"    "+"信使复活时间："+" "+I2S(BQO))
endif
endif
endloop
if BQO==2 then
call SetUnitPosition(BPO,x,y)
endif
if BQO==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set BPO=null
return false
endfunction
function C0O takes player MDI,integer ROI returns nothing
local texttag t
if ROI>0 then
set t=CreateTextTag()
call SetPlayerState(MDI,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(MDI,PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetTextTagText(t,"+"+I2S(ROI),0.025)
call SetTextTagPosUnit(t,K1[GetPlayerId(MDI)],0)
call SetTextTagColor(t,255,220,0,255)
call SetTextTagVelocity(t,0,0.03)
if GetLocalPlayer()==MDI then
call SetTextTagVisibility(t,true)
else
call SetTextTagVisibility(t,false)
endif
call SetTextTagFadepoint(t,2)
call SetTextTagLifespan(t,3)
call SetTextTagPermanent(t,false)
endif
endfunction
function CIO takes nothing returns boolean
local real x
local real y
local unit BPO=GetTriggerUnit()
local integer i=1
local integer R4I=175
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if RXI(BPO)==false then
set R4I=150
endif
call FL1("Courier"+I2S(GetPlayerId(GetOwningPlayer(GetTriggerUnit()))),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call QRI(P2,10.00,BNO(GetOwningPlayer(GetTriggerUnit()),GetOwningPlayer(GetKillingUnit())))
call PingMinimapEx(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),6,255,0,0,false)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function BRO))
call SaveUnitHandle(LY,(handle_id),(2),(BPO))
if IsPlayerAlly(GetOwningPlayer(BPO),BO[0])and FS0[GetPlayerId(BO[0])]==false then
set FS0[GetPlayerId(BO[0])]=true
loop
exitwhen i>5
call C0O(CO[i],R4I)
set i=i+1
endloop
endif
set i=1
if IsPlayerAlly(GetOwningPlayer(BPO),CO[0])and FS0[GetPlayerId(CO[0])]==false then
set FS0[GetPlayerId(CO[0])]=true
loop
exitwhen i>5
call C0O(BO[i],R4I)
set i=i+1
endloop
endif
//改成判断阵营
if GetPlayerTeam(GetOwningPlayer(BPO)) == 0 then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
if IsTerrainPathable(GetUnitX(BPO),GetUnitY(BPO),PATHING_TYPE_WALKABILITY)then
call BTO(BPO)
endif
set t=null
return false
endfunction
function C1O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=QS
local real y=US
if IsPlayerTeam2(GetOwningPlayer(hero))then
set x=O50
set y=O60
endif
if IsUnitDead(hero)==false then
if QNI(GetUnitX(hero),GetUnitY(hero),x,y)<800 then
call AddSkill(hero,'Avul')
else
call UnitRemoveAbility(hero,'Avul')
endif
endif
set t=null
set hero=null
return false
endfunction
function COO takes unit BPO returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call MUInitMessenger(BPO)
call SetPlayerAbilityAvailable(GetOwningPlayer(BPO),'A29N',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(BPO),'A2XM',false)
call UnitMakeAbilityPermanent(BPO,true,'A29M')
call TriggerRegisterDeathEvent(t,BPO)
call TriggerAddCondition(t,Condition(function CIO))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function C1O))
call SaveUnitHandle(LY,(handle_id),(2),(BPO))
set t=null
endfunction
function C2O takes nothing returns nothing
if RYI(GetTriggerUnit())and IsUnitIllusion(GetTriggerUnit())==false then
call FL1("Courier"+I2S(GetPlayerId(GetOwningPlayer(GetTriggerUnit()))),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call QRI(P2,10.00,BNO(GetOwningPlayer(GetTriggerUnit()),GetOwningPlayer(GetKillingUnit())))
call PingMinimapEx(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),6,255,0,0,false)
endif
endfunction
function C3O takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
set FS0[GetPlayerId(BO[0])]=false
set FS0[GetPlayerId(CO[0])]=false
set FN0[GetPlayerId(BO[1])]=CreateLeaderboard()
set FN0[GetPlayerId(BO[2])]=CreateLeaderboard()
set FN0[GetPlayerId(BO[3])]=CreateLeaderboard()
set FN0[GetPlayerId(BO[4])]=CreateLeaderboard()
set FN0[GetPlayerId(BO[5])]=CreateLeaderboard()
set FN0[GetPlayerId(CO[1])]=CreateLeaderboard()
set FN0[GetPlayerId(CO[2])]=CreateLeaderboard()
set FN0[GetPlayerId(CO[3])]=CreateLeaderboard()
set FN0[GetPlayerId(CO[4])]=CreateLeaderboard()
set FN0[GetPlayerId(CO[5])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[1],FN0[GetPlayerId(BO[1])])
call PlayerSetLeaderboard(BO[2],FN0[GetPlayerId(BO[2])])
call PlayerSetLeaderboard(BO[3],FN0[GetPlayerId(BO[3])])
call PlayerSetLeaderboard(BO[4],FN0[GetPlayerId(BO[4])])
call PlayerSetLeaderboard(BO[5],FN0[GetPlayerId(BO[5])])
call PlayerSetLeaderboard(CO[1],FN0[GetPlayerId(CO[1])])
call PlayerSetLeaderboard(CO[2],FN0[GetPlayerId(CO[2])])
call PlayerSetLeaderboard(CO[3],FN0[GetPlayerId(CO[3])])
call PlayerSetLeaderboard(CO[4],FN0[GetPlayerId(CO[4])])
call PlayerSetLeaderboard(CO[5],FN0[GetPlayerId(CO[5])])
call LeaderboardDisplay(FN0[GetPlayerId(BO[1])],false)
call LeaderboardDisplay(FN0[GetPlayerId(BO[2])],false)
call LeaderboardDisplay(FN0[GetPlayerId(BO[3])],false)
call LeaderboardDisplay(FN0[GetPlayerId(BO[4])],false)
call LeaderboardDisplay(FN0[GetPlayerId(BO[5])],false)
call LeaderboardDisplay(FN0[GetPlayerId(CO[1])],false)
call LeaderboardDisplay(FN0[GetPlayerId(CO[2])],false)
call LeaderboardDisplay(FN0[GetPlayerId(CO[3])],false)
call LeaderboardDisplay(FN0[GetPlayerId(CO[4])],false)
call LeaderboardDisplay(FN0[GetPlayerId(CO[5])],false)
call LeaderboardSetLabelBJ(FN0[GetPlayerId(BO[1])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(BO[2])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(BO[3])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(BO[4])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(BO[5])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(CO[1])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(CO[2])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(CO[3])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(CO[4])]," ")
call LeaderboardSetLabelBJ(FN0[GetPlayerId(CO[5])]," ")
return false
endfunction
function C5O takes nothing returns nothing
local integer id=GetUnitTypeId(GetTriggerUnit())
if id=='e00R' or id=='e011' or id=='e00S' or id=='e019' or id=='u00M' or id=='u00D' or id=='u00N' or id=='u00T' then
if IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit()))then
set X[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=X[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
call QRI(P2,10,C0[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetKillingUnit())))])+"|r "+"反补了一座防御塔"+".")
else
call QRI(P2,10,C0[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetKillingUnit())))])+"|r "+"摧毁了一座防御塔"+".")
endif
endif
endfunction
function C8O takes integer i returns boolean
return i=='I006' or i=='I008' or i=='I00J' or i=='I00K' or i=='I007' or i=='I0RC'
endfunction
function C9O takes nothing returns nothing
if GetWidgetLife(GetEnumItem())>0 and C8O(GetItemTypeId(GetEnumItem()))then
set VK=GetEnumItem()
endif
endfunction
function CAO takes nothing returns integer
local integer i=GetRandomInt(1,5)
loop
exitwhen i!=J30
set i=GetRandomInt(1,5)
endloop
set J30=i
return i
endfunction
function CBO takes nothing returns boolean
local real x
local real y
local real x1
local real y1
local real x2
local real y2
local integer CCO
local item CDO
local item CEO
if GetRandomInt(1,2)==1 then
set x1=GetLocationX(F1)
set y1=GetLocationY(F1)
set x2=GetLocationX(G1)
set y2=GetLocationY(G1)
else
set x1=GetLocationX(G1)
set y1=GetLocationY(G1)
set x2=GetLocationX(F1)
set y2=GetLocationY(F1)
endif
set VK=null
call EnumItemsInRect(G4,Condition(function N1I),function C9O)
set CDO=VK
set VK=null
call EnumItemsInRect(D4,Condition(function N1I),function C9O)
set CEO=VK
call RemoveItem(CDO)
call RemoveItem(CEO)
if J40==false then
set CCO=CAO()
if CCO==1 then
call CreateItem('I007',x1,y1)
elseif CCO==2 then
call CreateItem('I006',x1,y1)
elseif CCO==3 then
call CreateItem('I00K',x1,y1)
elseif CCO==4 then
call CreateItem('I008',x1,y1)
elseif CCO==5 then
call CreateItem('I00J',x1,y1)
endif
set VK=CreateItem('I0RC',x2,y2)
call SaveBoolean(LY,(GetHandleId(VK)),(835),(false))
else
set J40=false
set VK=CreateItem('I0RC',x1,y1)
call SaveBoolean(LY,(GetHandleId(VK)),(835),(true))
set VK=CreateItem('I0RC',x2,y2)
call SaveBoolean(LY,(GetHandleId(VK)),(835),(true))
endif
return false
endfunction
function CGO takes nothing returns nothing
set JC0=JC0+1
set J50[JC0]=HI0
set J60[JC0]=HB0
set JB0[JC0]=ZV0
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=GY0
set J70[JC0]=XV0
set JB0[JC0]=ZW0
set JC0=JC0+1
set J50[JC0]=GC0
set J60[JC0]=GY0
set J70[JC0]=XW0
set JB0[JC0]=ZX0
set JC0=JC0+1
set J50[JC0]=H10
set J60[JC0]=H50
set JB0[JC0]=ZY0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=XX0
set JB0[JC0]=ZK0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=G60
set J70[JC0]=G50
set JB0[JC0]=ZL0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=G80
set J70[JC0]=G50
set JB0[JC0]=ZM0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=H20
set J70[JC0]=G50
set JB0[JC0]=ZN0
set JC0=JC0+1
set J50[JC0]=G50
set J60[JC0]=XJ0
set JB0[JC0]=ZS0
set JC0=JC0+1
set J50[JC0]=H00
set J60[JC0]=H20
set J70[JC0]=H50
set JB0[JC0]=ZR0
set JC0=JC0+1
set J50[JC0]=G70
set J60[JC0]=GH0
set J70[JC0]=XK0
set JB0[JC0]=ZP0
set JC0=JC0+1
set J50[JC0]=G70
set J60[JC0]=H40
set J70[JC0]=XL0
set JB0[JC0]=ZQ0
set JC0=JC0+1
set J50[JC0]=G70
set J60[JC0]=GL0
set J70[JC0]=XM0
set JB0[JC0]=ZU0
set JC0=JC0+1
set J50[JC0]=G90
set J60[JC0]=G60
set J70[JC0]=XN0
set JB0[JC0]=V00
set JC0=JC0+1
set J50[JC0]=GR0
set J60[JC0]=G80
set J70[JC0]=XS0
set JB0[JC0]=VI0
set JC0=JC0+1
set J50[JC0]=HC0
set J60[JC0]=G80
set J70[JC0]=XT0
set JB0[JC0]=V10
set JC0=JC0+1
set J50[JC0]=GB0
set J60[JC0]=GC0
set J70[JC0]=H20
set JB0[JC0]=V20
set JC0=JC0+1
set J50[JC0]=GS0
set J60[JC0]=G50
set J70[JC0]=XR0
set JB0[JC0]=V30
set JC0=JC0+1
set J50[JC0]=G90
set J60[JC0]=G90
set J70[JC0]=H20
set J80[JC0]=XP0
set JB0[JC0]=V40
set JC0=JC0+1
set J50[JC0]=V40
set J60[JC0]=XP0
set JB0[JC0]=V50
set JC0=JC0+1
set J50[JC0]=V60
set J60[JC0]=XP0
set JB0[JC0]=V50
set JC0=JC0+1
set J50[JC0]=GW0
set J60[JC0]=GM0
set JB0[JC0]=V80
set JC0=JC0+1
set J50[JC0]=GM0
set J60[JC0]=XQ0
set JB0[JC0]=VA0
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=H60
set J70[JC0]=HB0
set J80[JC0]=XU0
set JB0[JC0]=VB0
set JC0=JC0+1
set J50[JC0]=GU0
set J60[JC0]=GG0
set J70[JC0]=HA0
set JB0[JC0]=VC0
set JC0=JC0+1
set J50[JC0]=ZW0
set J60[JC0]=ZX0
set J70[JC0]=Y00
set JB0[JC0]=VD0
set JC0=JC0+1
set J50[JC0]=VI0
set J60[JC0]=V00
set JB0[JC0]=VE0
set JC0=JC0+1
set J50[JC0]=GS0
set J60[JC0]=GS0
set J70[JC0]=Y10
set JB0[JC0]=VF0
set JC0=JC0+1
set J50[JC0]=ZV0
set J60[JC0]=GB0
set J70[JC0]=GD0
set JB0[JC0]=VG0
set JC0=JC0+1
set J50[JC0]=GA0
set J60[JC0]=GB0
set J70[JC0]=YO0
set JB0[JC0]=VH0
set JC0=JC0+1
set J50[JC0]=GS0
set J60[JC0]=GR0
set J70[JC0]=Y20
set JB0[JC0]=VZ0
set JC0=JC0+1
set J50[JC0]=V00
set J60[JC0]=H90
set J70[JC0]=Y30
set JB0[JC0]=VN0
set JC0=JC0+1
set J50[JC0]=GD0
set J60[JC0]=XE0
set JB0[JC0]=VS0
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=ZU0
set J70[JC0]=Y50
set JB0[JC0]=VT0
set JC0=JC0+1
set J50[JC0]=VT0
set J60[JC0]=Y50
set JB0[JC0]=VR0
set JC0=JC0+1
set J50[JC0]=VR0
set J60[JC0]=Y50
set JB0[JC0]=VP0
set JC0=JC0+1
set J50[JC0]=VP0
set J60[JC0]=Y50
set JB0[JC0]=VQ0
set JC0=JC0+1
set J50[JC0]=VQ0
set J60[JC0]=Y50
set JB0[JC0]=VU0
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=G80
set J70[JC0]=Y60
set JB0[JC0]=W00
set JC0=JC0+1
set J50[JC0]=W00
set J60[JC0]=Y60
set JB0[JC0]=WI0
set JC0=JC0+1
set J50[JC0]=WI0
set J60[JC0]=Y60
set JB0[JC0]=W10
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=ZV0
set J70[JC0]=Y70
set JB0[JC0]=WO0
set JC0=JC0+1
set J50[JC0]=GE0
set J60[JC0]=H30
set JB0[JC0]=W30
set JC0=JC0+1
set J50[JC0]=VH0
set J60[JC0]=GE0
set J70[JC0]=Y80
set JB0[JC0]=W50
set JC0=JC0+1
set J50[JC0]=GE0
set J60[JC0]=HC0
set J70[JC0]=HC0
set JB0[JC0]=W60
set JC0=JC0+1
set J50[JC0]=H30
set J60[JC0]=Y90
set JB0[JC0]=W80
set JC0=JC0+1
set J50[JC0]=GN0
set J60[JC0]=HA0
set J70[JC0]=YA0
set JB0[JC0]=WA0
set JC0=JC0+1
set J50[JC0]=GN0
set J60[JC0]=V80
set J70[JC0]=YB0
set JB0[JC0]=WC0
set JC0=JC0+1
set J50[JC0]=GN0
set J60[JC0]=V90
set J70[JC0]=YB0
set JB0[JC0]=WC0
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=H90
set J70[JC0]=GU0
set J80[JC0]=G20
set JB0[JC0]=WD0
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=H90
set J70[JC0]=GU0
set J80[JC0]=G30
set JB0[JC0]=WD0
set JC0=JC0+1
set J50[JC0]=GF0
set J60[JC0]=H00
set J70[JC0]=HN0
set JB0[JC0]=WF0
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=GC0
set J70[JC0]=YR0
set JB0[JC0]=XA0
set JC0=JC0+1
set J50[JC0]=GU0
set J60[JC0]=GR0
set J70[JC0]=G90
set J80[JC0]=H60
set JB0[JC0]=JD0
set JC0=JC0+1
set J50[JC0]=ZV0
set J60[JC0]=ZR0
set J70[JC0]=YE0
set JB0[JC0]=WH0
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=GT0
set J70[JC0]=HB0
set JB0[JC0]=WZ0
set JC0=JC0+1
set J50[JC0]=HA0
set J60[JC0]=HI0
set J70[JC0]=H70
set JB0[JC0]=WV0
set JC0=JC0+1
set J50[JC0]=HA0
set J60[JC0]=HI0
set J70[JC0]=H80
set JB0[JC0]=WV0
set JC0=JC0+1
set J50[JC0]=GG0
set J60[JC0]=H10
set J70[JC0]=YF0
set JB0[JC0]=WX0
set JC0=JC0+1
set J50[JC0]=GX0
set J60[JC0]=V30
set J70[JC0]=YL0
set JB0[JC0]=WY0
set JC0=JC0+1
set J50[JC0]=ZD0
set J70[JC0]=YG0
set JB0[JC0]=WJ0
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=ZY0
set J70[JC0]=GM0
set J80[JC0]=YH0
set JB0[JC0]=WK0
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=ZJ0
set J70[JC0]=GM0
set J80[JC0]=YH0
set JB0[JC0]=WK0
set JC0=JC0+1
set J50[JC0]=GX0
set J60[JC0]=GQ0
set J70[JC0]=GC0
set J80[JC0]=YZ0
set JB0[JC0]=WL0
set JC0=JC0+1
set J50[JC0]=VC0
set J60[JC0]=X80
set J70[JC0]=J10
set JB0[JC0]=WM0
set JC0=JC0+1
set J50[JC0]=WV0
set J60[JC0]=ZX0
set J70[JC0]=JO0
set JB0[JC0]=Z40
set JC0=JC0+1
set J50[JC0]=WW0
set J60[JC0]=ZX0
set J70[JC0]=JO0
set JB0[JC0]=Z40
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=HO0
set J70[JC0]=HI0
set J80[JC0]=GP0
set JB0[JC0]=WN0
set JC0=JC0+1
set J50[JC0]=G50
set J60[JC0]=GW0
set J70[JC0]=GA0
set J80[JC0]=YV0
set JB0[JC0]=WP0
set JC0=JC0+1
set J50[JC0]=GT0
set J60[JC0]=GQ0
set J70[JC0]=YW0
set JB0[JC0]=WQ0
set JC0=JC0+1
set J50[JC0]=ZR0
set J60[JC0]=ZR0
set J70[JC0]=YQ0
set JB0[JC0]=X00
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=GA0
set J70[JC0]=GA0
set JB0[JC0]=XI0
set JC0=JC0+1
set J50[JC0]=HK0
set J60[JC0]=GY0
set J70[JC0]=GY0
set J80[JC0]=GY0
set J90[JC0]=YX0
set JB0[JC0]=X10
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=HO0
set J70[JC0]=YY0
set JB0[JC0]=XO0
set JC0=JC0+1
set J50[JC0]=WN0
set J60[JC0]=ZW0
set J70[JC0]=YJ0
set JB0[JC0]=X20
set JC0=JC0+1
set J50[JC0]=H70
set J60[JC0]=H40
set J70[JC0]=H40
set JB0[JC0]=X30
set JC0=JC0+1
set J50[JC0]=H80
set J60[JC0]=H40
set J70[JC0]=H40
set JB0[JC0]=X30
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=GH0
set J70[JC0]=GH0
set J80[JC0]=YM0
set JB0[JC0]=X60
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=HO0
set J70[JC0]=YN0
set JB0[JC0]=X80
set JC0=JC0+1
set J50[JC0]=GF0
set J60[JC0]=X50
set JB0[JC0]=HS0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=GG0
set JB0[JC0]=X90
set JC0=JC0+1
set J50[JC0]=H20
set J60[JC0]=ZP0
set J70[JC0]=YT0
set JB0[JC0]=HP0
set JC0=JC0+1
set J50[JC0]=HP0
set J60[JC0]=YT0
set JB0[JC0]=HP0
set JC0=JC0+1
set J50[JC0]=HQ0
set J60[JC0]=YT0
set JB0[JC0]=HP0
set JC0=JC0+1
set J50[JC0]=GW0
set J60[JC0]=ZU0
set J70[JC0]=YP0
set JB0[JC0]=XB0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=H10
set J70[JC0]=HO0
set JB0[JC0]=Z00
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=H60
set J70[JC0]=HA0
set JB0[JC0]=Z10
set JC0=JC0+1
set J50[JC0]=VI0
set J60[JC0]=HN0
set JB0[JC0]=XC0
set JC0=JC0+1
set J50[JC0]=V10
set J60[JC0]=H30
set JB0[JC0]=XD0
set JC0=JC0+1
set J50[JC0]=ZQ0
set J60[JC0]=ZY0
set JB0[JC0]=Z20
set JC0=JC0+1
set J50[JC0]=ZQ0
set J60[JC0]=ZJ0
set JB0[JC0]=Z30
set JC0=JC0+1
set J50[JC0]=XG0
set J60[JC0]=XG0
set J70[JC0]=XG0
set J80[JC0]=XG0
set J90[JC0]=XG0
set JA0[JC0]=XG0
set JB0[JC0]=XH0
endfunction
function InitTrig_Recipe_Definitions takes nothing returns nothing
call CGO()
endfunction
function CHO takes nothing returns nothing
set GO0=GO0+1
set FT0[GO0]='I0AZ'
set FR0[GO0]='I011'
set FP0[GO0]=0
set FQ0[GO0]='I0EY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JE0=GO0
set GO0=GO0+1
set FT0[GO0]='I00F'
set FR0[GO0]='I00D'
set FP0[GO0]=0
set FQ0[GO0]='I0EZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JF0=GO0
set GO0=GO0+1
set FT0[GO0]='I0R9'
set FR0[GO0]='I0RA'
set FP0[GO0]=0
set FQ0[GO0]='I0RB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L60=GO0
set GO0=GO0+1
set FT0[GO0]='I0R6'
set FR0[GO0]='I0R7'
set FP0[GO0]=0
set FQ0[GO0]='I0R8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L50=GO0
set GO0=GO0+1
set FT0[GO0]='I018'
set FR0[GO0]='I009'
set FP0[GO0]=0
set FQ0[GO0]='I0F0'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JG0=GO0
set GO0=GO0+1
set FT0[GO0]='I019'
set FR0[GO0]='I005'
set FP0[GO0]=0
set FQ0[GO0]='I0F6'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JH0=GO0
set GO0=GO0+1
set FT0[GO0]='I01A'
set FR0[GO0]='I00G'
set FP0[GO0]=0
set FQ0[GO0]='I0F1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JZ0=GO0
set GO0=GO0+1
set FT0[GO0]='I01B'
set FR0[GO0]='I004'
set FP0[GO0]=0
set FQ0[GO0]='I0F2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JV0=GO0
set GO0=GO0+1
set FT0[GO0]='I0R3'
set FR0[GO0]='I0R4'
set FP0[GO0]=0
set FQ0[GO0]='I0R5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L40=GO0
set GO0=GO0+1
set FT0[GO0]='I01H'
set FR0[GO0]='I003'
set FP0[GO0]=0
set FQ0[GO0]='I0F3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JW0=GO0
set GO0=GO0+1
set FT0[GO0]='I01I'
set FR0[GO0]='I002'
set FP0[GO0]=0
set FQ0[GO0]='I0F5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JX0=GO0
set GO0=GO0+1
set FT0[GO0]='I02K'
set FR0[GO0]='I001'
set FP0[GO0]=0
set FQ0[GO0]='I0F4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JY0=GO0
set GO0=GO0+1
set FT0[GO0]='I02L'
set FR0[GO0]='I00I'
set FP0[GO0]=0
set FQ0[GO0]='I0FE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JJ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0R1'
set FR0[GO0]='I0R0'
set FP0[GO0]=0
set FQ0[GO0]='I0R2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JK0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B2'
set FR0[GO0]='I00H'
set FP0[GO0]=0
set FQ0[GO0]='I0F9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JM0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B3'
set FR0[GO0]='I00P'
set FP0[GO0]=0
set FQ0[GO0]='I0FA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JN0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B4'
set FR0[GO0]='I00U'
set FP0[GO0]=0
set FQ0[GO0]='I0F7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JS0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B7'
set FR0[GO0]='I000'
set FP0[GO0]=0
set FQ0[GO0]='I0FD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JT0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B6'
set FR0[GO0]='I016'
set FP0[GO0]=0
set FQ0[GO0]='I0FC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JR0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B5'
set FR0[GO0]='I017'
set FP0[GO0]=0
set FQ0[GO0]='I0FB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JP0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B9'
set FR0[GO0]='I00O'
set FP0[GO0]=0
set FQ0[GO0]='I0F8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JQ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0J5'
set FR0[GO0]='I0IT'
set FP0[GO0]=0
set FQ0[GO0]='I0IJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JU0=GO0
set GO0=GO0+1
set FT0[GO0]='I0IV'
set FR0[GO0]='I0IU'
set FP0[GO0]=0
set FQ0[GO0]='I0I9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K00=GO0
set GO0=GO0+1
set FT0[GO0]='I0IW'
set FR0[GO0]='I0IS'
set FP0[GO0]=0
set FQ0[GO0]='I0II'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KI0=GO0
set GO0=GO0+1
set FT0[GO0]='I0IX'
set FR0[GO0]='I0IR'
set FP0[GO0]=0
set FQ0[GO0]='I0IA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K10=GO0
set GO0=GO0+1
set FT0[GO0]='I0IY'
set FR0[GO0]='I0IQ'
set FP0[GO0]=0
set FQ0[GO0]='I0IH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KO0=GO0
set GO0=GO0+1
set FT0[GO0]='I0IZ'
set FR0[GO0]='I0IK'
set FP0[GO0]=0
set FQ0[GO0]='I0IG'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K20=GO0
set GO0=GO0+1
set FT0[GO0]='I0J0'
set FR0[GO0]='I0IL'
set FP0[GO0]=0
set FQ0[GO0]='I0IF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K30=GO0
set GO0=GO0+1
set FT0[GO0]='I0J1'
set FR0[GO0]='I0IM'
set FP0[GO0]=0
set FQ0[GO0]='I0IE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K40=GO0
set GO0=GO0+1
set FT0[GO0]='I0J2'
set FR0[GO0]='I0IP'
set FP0[GO0]=0
set FQ0[GO0]='I0ID'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K50=GO0
set GO0=GO0+1
set FT0[GO0]='I0J3'
set FR0[GO0]='I0IO'
set FP0[GO0]=0
set FQ0[GO0]='I0IC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K60=GO0
set GO0=GO0+1
set FT0[GO0]='I0J4'
set FR0[GO0]='I0IN'
set FP0[GO0]=0
set FQ0[GO0]='I0IB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K70=GO0
set GO0=GO0+1
set FT0[GO0]='I0I6'
set FR0[GO0]='I0I7'
set FP0[GO0]=0
set FQ0[GO0]='I0I8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K80=GO0
set GO0=GO0+1
set FT0[GO0]='I0JZ'
set FR0[GO0]='I0JS'
set FP0[GO0]=0
set FQ0[GO0]='I0JR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K90=GO0
set GO0=GO0+1
set FT0[GO0]='I0K0'
set FR0[GO0]='I0JT'
set FP0[GO0]=0
set FQ0[GO0]='I0JL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KA0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K1'
set FR0[GO0]='I0JU'
set FP0[GO0]=0
set FQ0[GO0]='I0JM'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KB0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K2'
set FR0[GO0]='I0JW'
set FP0[GO0]=0
set FQ0[GO0]='I0JN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KC0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K3'
set FR0[GO0]='I0JV'
set FP0[GO0]=0
set FQ0[GO0]='I0JQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KD0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K4'
set FR0[GO0]='I0JY'
set FP0[GO0]=0
set FQ0[GO0]='I0JP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KE0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K5'
set FR0[GO0]='I0JX'
set FP0[GO0]=0
set FQ0[GO0]='I0JO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KF0=GO0
set GO0=GO0+1
set FT0[GO0]='I0KI'
set FR0[GO0]='I0KH'
set FP0[GO0]=0
set FQ0[GO0]='I0KJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KG0=GO0
set GO0=GO0+1
set FT0[GO0]='I0L4'
set FR0[GO0]='I0L5'
set FP0[GO0]=0
set FQ0[GO0]='I0L8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JL0=GO0
set GO0=GO0+1
set FT0[GO0]='I0L3'
set FR0[GO0]='I0L0'
set FP0[GO0]=0
set FQ0[GO0]='I0L9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KH0=GO0
set GO0=GO0+1
set FT0[GO0]='I0L2'
set FR0[GO0]='I0L7'
set FP0[GO0]=0
set FQ0[GO0]='I0LA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KZ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0LU'
set FR0[GO0]='I0LV'
set FP0[GO0]=0
set FQ0[GO0]='I0LW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KV0=GO0
set GO0=GO0+1
set FT0[GO0]='I0M1'
set FR0[GO0]='I0M0'
set FP0[GO0]=0
set FQ0[GO0]='I0M2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KW0=GO0
set GO0=GO0+1
set FT0[GO0]='I0M5'
set FR0[GO0]='I0M4'
set FP0[GO0]=0
set FQ0[GO0]='I0M3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KX0=GO0
set GO0=GO0+1
set FT0[GO0]='I0M6'
set FR0[GO0]='I0M7'
set FP0[GO0]=0
set FQ0[GO0]='I0M8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KY0=GO0
set GO0=GO0+1
set FT0[GO0]='I0MF'
set FR0[GO0]='I0MG'
set FP0[GO0]=0
set FQ0[GO0]='I0MH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KJ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0MM'
set FR0[GO0]='I0ML'
set FP0[GO0]=0
set FQ0[GO0]='I0MN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KK0=GO0
set GO0=GO0+1
set FT0[GO0]='I0MO'
set FR0[GO0]='I0MP'
set FP0[GO0]=0
set FQ0[GO0]='I0MQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KL0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NQ'
set FR0[GO0]='I0NR'
set FP0[GO0]=0
set FQ0[GO0]='I0NS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KM0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NT'
set FR0[GO0]='I0NU'
set FP0[GO0]=0
set FQ0[GO0]='I0NV'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KN0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NW'
set FR0[GO0]='I0NX'
set FP0[GO0]=0
set FQ0[GO0]='I0NY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KS0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NZ'
set FR0[GO0]='I0O0'
set FP0[GO0]=0
set FQ0[GO0]='I0O1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KT0=GO0
set GO0=GO0+1
set FT0[GO0]='I0OR'
set FR0[GO0]='I0OS'
set FP0[GO0]=0
set FQ0[GO0]='I0OT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KR0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PG'
set FR0[GO0]='I0PH'
set FP0[GO0]=0
set FQ0[GO0]='I0PI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KP0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PJ'
set FR0[GO0]='I0PK'
set FP0[GO0]=0
set FQ0[GO0]='I0PL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KQ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PP'
set FR0[GO0]='I0PQ'
set FP0[GO0]=0
set FQ0[GO0]='I0PR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KU0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PS'
set FR0[GO0]='I0PT'
set FP0[GO0]=0
set FQ0[GO0]='I0PU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L00=GO0
set GO0=GO0+1
set FT0[GO0]='I0PV'
set FR0[GO0]='I0PW'
set FP0[GO0]=0
set FQ0[GO0]='I0PX'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set LI0=GO0
set GO0=GO0+1
set FT0[GO0]='I0Q0'
set FR0[GO0]='I0Q2'
set FP0[GO0]=0
set FQ0[GO0]='I0Q4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set LO0=GO0
set GO0=GO0+1
set FT0[GO0]='I0Q1'
set FR0[GO0]='I0Q3'
set FP0[GO0]=0
set FQ0[GO0]='I0Q5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L10=GO0
set GO0=GO0+1
set FT0[GO0]='I0QL'
set FR0[GO0]='I0QM'
set FP0[GO0]=0
set FQ0[GO0]='I0QN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L20=GO0
set GO0=GO0+1
set FT0[GO0]='I0QO'
set FR0[GO0]='I0QP'
set FP0[GO0]=0
set FQ0[GO0]='I0QQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L30=GO0
set GO0=GO0+1
set FT0[GO0]='I0RJ'
set FR0[GO0]='I0RK'
set FP0[GO0]=0
set FQ0[GO0]='I0RL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L70=GO0
set GO0=GO0+1
set FT0[GO0]='I0RM'
set FR0[GO0]='I0RN'
set FP0[GO0]=0
set FQ0[GO0]='I0RO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L80=GO0
endfunction
function InitTrig_Aghanims_Scepter_Definitions takes nothing returns nothing
call CHO()
endfunction
function CZO takes unit hero returns nothing
local real x
local real y
// 改成判断阵营
if GetPlayerTeam(GetOwningPlayer(hero)) == 0 then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
call IssuePointOrder(hero,"move",x,y)
endfunction
function CVO takes nothing returns nothing
	local item BA1=GetEnumItem()
	if GetWidgetLife(BA1)>0 and GetItemPlayer(BA1)==LG0 and LV0==0 and IsItemVisible(BA1)==true then
		set LV0=LV0+1
		call UnitAddItem(LH0,BA1)
	endif
	set BA1=null
endfunction
function CWO takes nothing returns nothing
local item BA1=GetEnumItem()
if GetWidgetLife(BA1)>0 and GetItemPlayer(BA1)==LG0 and IsItemVisible(BA1)==true then
call UnitAddItem(LZ0,BA1)
endif
set BA1=null
endfunction
// 尝试捡附近的物品
function CXO takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
	local unit BPO=(LoadUnitHandle(LY,(handle_id),(92)))
	local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
	local real x=(LoadReal(LY,(handle_id),(6)))
	local real y=(LoadReal(LY,(handle_id),(7)))
	local rect r=Rect(x-300,y-300,x+300,y+300)
	if GetTriggerEventId()==EVENT_WIDGET_DEATH then
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
		set LG0=p
		set LH0=hero
		set LZ0=BPO
		call EnumItemsInRect(r,Condition(function N1I),function CWO)
	else
		if GetTriggerEvalCount(t)>9 then
			call FlushChildHashtable(LY,(handle_id))
			call FlushTrigger(t)
			set LG0=p
			set LH0=hero
			set LZ0=BPO
			call EnumItemsInRect(r,Condition(function N1I),function CWO)
		else
			set LG0=p
			set LH0=hero
			set LV0=0
			call EnumItemsInRect(r,Condition(function N1I),function CVO)
		endif
	endif
	call RemoveRect(r)
	set t=null
	set hero=null
	set BPO=null
	set r=null
	return false
endfunction
// 信使把物品给英雄
function CYO takes unit BPO,unit hero returns nothing
	local player p=GetOwningPlayer(hero)
	local integer i
	local item BA1
	local trigger t=CreateTrigger()
	local integer handle_id=GetHandleId(t)
	local real x=GetUnitX(BPO)
	local real y=GetUnitY(BPO)
	local integer E81
	if IsTerrainPathable(x,y,PATHING_TYPE_WALKABILITY)then
		set x=GetUnitX(hero)
		set y=GetUnitY(hero)
	endif
	call TriggerRegisterDeathEvent(t,hero)
	call TriggerRegisterTimerEvent(t,0.01,true)
	call TriggerAddCondition(t,Condition(function CXO))
	call SaveUnitHandle(LY,(handle_id),(2),(hero))
	call SaveUnitHandle(LY,(handle_id),(92),(BPO))
	call SavePlayerHandle(LY,(handle_id),(54),(p))
	call SaveReal(LY,(handle_id),(6),((x)*1.0))
	call SaveReal(LY,(handle_id),(7),((y)*1.0))
	set i=0
	loop
		exitwhen i>5
		set BA1=UnitItemInSlot(BPO,i)
		set E81=GetItemId(BA1)
		if BA1!=null and GetItemPlayer(BA1)==p and EG1(BA1)==false and(E81!=HZ0 and E81!=HV0 and E81!=HW0 and E81!=HX0 and E81!=HY0)then
			call UnitRemoveItem(BPO,BA1)
			call SetItemPosition(BA1,x,y)
		endif
		set i=i+1
	endloop
	set t=null
	set BA1=null
endfunction
function CJO takes unit B71 returns boolean
local integer CKO=GetUnitCurrentOrder(B71)
return(CKO==0)or(CKO==851973)or(CKO==851975)or(CKO==851987)or(CKO==851993)
endfunction
function CLO takes trigger t returns nothing
local integer handle_id=GetHandleId(t)
local unit BPO=(LoadUnitHandle(LY,(handle_id),(92)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(2)))
local real x
local real y
local real CMO
local real CNO
local real CSO
local real CTO
local real CRO
local real QWI
local real CPO
local real CQO=GetUnitX(SFI)
local real CUO=GetUnitY(SFI)
if(CJO(SFI)==false)then
set x=GetUnitX(SFI)
set y=GetUnitY(SFI)
set CTO=(LoadReal(LY,(handle_id),(677)))
set CRO=(LoadReal(LY,(handle_id),(678)))
call SaveReal(LY,(handle_id),(677),((x)*1.0))
call SaveReal(LY,(handle_id),(678),((y)*1.0))
set CSO=Atan2(y-CRO,x-CTO)
set CMO=SquareRoot((x-CTO)*(x-CTO)+(y-CRO)*(y-CRO))/0.2
set CNO=GetUnitMoveSpeed(BPO)
set QWI=QNI(GetUnitX(SFI),GetUnitY(SFI),GetUnitX(BPO),GetUnitY(BPO))
set CPO=RAbsBJ(CSO*bj_RADTODEG-GetUnitFacing(BPO))
if(QWI<CNO-CMO and CNO>CMO)or(QWI<RMaxBJ(CNO,CMO)and CPO>=90)then
else
set CQO=x+CMO*Cos(CSO)
set CUO=y+CMO*Sin(CSO)
endif
endif
call SaveInteger(LY,(handle_id),(679),(1))
call IssuePointOrder(BPO,"move",CQO,CUO)
set BPO=null
set SFI=null
set t=null
endfunction
function D0O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit BPO=(LoadUnitHandle(LY,(handle_id),(92)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x
local real y
local integer i
local player p=GetOwningPlayer(hero)
local item BA1
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
if GetTriggerUnit()==hero then
call CZO(BPO)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER then
if(LoadInteger(LY,(handle_id),(679)))==1 then
call SaveInteger(LY,(handle_id),(679),(0))
elseif GetIssuedOrderId()!=852100 and GetIssuedOrderId()!=852090 then
call FlushTrigger(t)
endif
else
if QLI(BPO,hero)<300 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call CYO(BPO,hero)
call CZO(BPO)
else
call CLO(t)
endif
endif
set t=null
set BPO=null
set hero=null
set BA1=null
return false
endfunction
function DIO takes unit SFI,boolean D1O returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit BPO=GetSellingUnit()
local integer DOO=(LoadInteger(LY,(GetHandleId(BPO)),(8000)))
if SFI!=null then
if SFI!=(LoadUnitHandle(LY,(GetHandleId(BPO)),(8002+DOO)))and D1O then
set DOO=DOO+1
call SaveInteger(LY,(GetHandleId(BPO)),(8000),(DOO))
call SaveUnitHandle(LY,(GetHandleId(BPO)),(8002+DOO),(SFI))
endif
call SaveReal(LY,(handle_id),(677),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(678),((GetUnitY(SFI))*1.0))
call IssueTargetOrder(BPO,"move",SFI)
call TriggerRegisterDeathEvent(t,BPO)
call TriggerRegisterDeathEvent(t,SFI)
call TriggerRegisterUnitEvent(t,BPO,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,BPO,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,BPO,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function D0O))
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveUnitHandle(LY,(handle_id),(92),(BPO))
endif
set t=null
set BPO=null
endfunction
function D2O takes nothing returns nothing
local item BA1=GetEnumItem()
local unit u=M80
local player p=GetOwningPlayer(u)
local integer id=GetPlayerId(p)
if GetWidgetLife(BA1)>0 and GetItemPlayer(BA1)==p and IsItemVisible(BA1)==true then
call SetItemPosition(BA1,D40[id],D50[id])
call UnitAddItem(LX0,BA1)
endif
set BA1=null
set u=null
set p=null
endfunction
function D3O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(53)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
set M80=u
set LX0=hero
if IsPlayerTeam1(GetOwningPlayer(M80))then
call EnumItemsInRect(G5,Condition(function N1I),function D2O)
else
call EnumItemsInRect(H5,Condition(function N1I),function D2O)
endif
if GetTriggerEvalCount(t)==3 then
call KillUnit(u)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set u=null
return false
endfunction
function D4O takes unit SFI returns nothing
local unit u=GetSoldUnit()
local integer i=0
local item BA1
local integer id=GetPlayerId(GetOwningPlayer(u))
local region r=CreateRegion()
local trigger t
local integer handle_id
local unit hero=GetSellingUnit()
if IsPlayerTeam1(GetOwningPlayer(u))then
call RegionAddRect(r,G5)
else
call RegionAddRect(r,H5)
endif
if IsUnitInRegion(r,hero)then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function D3O))
call SaveUnitHandle(LY,(handle_id),(53),(u))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
loop
exitwhen i>5
set BA1=UnitItemInSlot(hero,i)
if E91(GetItemId(BA1))==false and GetItemId(BA1)!=VL0 and EG1(BA1)==false then
call UnitRemoveItemFromSlot(hero,i)
if IsUnitInRegion(r,hero)and IsPlayerAlly(GetItemPlayer(BA1),GetOwningPlayer(hero))==true then
set id=GetPlayerId(GetItemPlayer(BA1))
call SetItemPosition(BA1,D40[id],D50[id])
endif
endif
set i=i+1
endloop
endif
call RemoveRegion(r)
set u=null
set r=null
endfunction
function D5O takes unit u returns string
local string s="$hero已经复活（买活）"
set s=FS1(s,"$hero",C0[GetPlayerId(GetOwningPlayer(u))]+GetUnitName(u)+"|r")
return s
endfunction
function D6O takes unit hero returns boolean
if GetOwningPlayer(hero)!=GetLocalPlayer()then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,D5O(K1[GetPlayerId(GetOwningPlayer(hero))]))
endif
return false
endfunction
function D7O takes nothing returns nothing
if GetUnitTypeId(GetSoldUnit())=='h085' then
if K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]!=null and IsUnitDead(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))])==false then
call DIO(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))],true)
endif
call KillUnit(GetSoldUnit())
elseif GetUnitTypeId(GetSoldUnit())=='h0BV' then
if K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]!=null then
call D4O(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))])
endif
call KillUnit(GetSoldUnit())
elseif GetUnitTypeId(GetSoldUnit())=='h0DE' then
if K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]!=null then
call DIO((LoadUnitHandle(LY,(GetHandleId(GetSellingUnit())),(8002+(LoadInteger(LY,(GetHandleId(GetSellingUnit())),(8000)))-1))),false)
endif
call KillUnit(GetSoldUnit())
elseif GZ1(GetUnitTypeId(GetSoldUnit()))then
if K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]!=null then
if IsUnitDead(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))])==true and GetOwningPlayer(GetSoldUnit())==GetOwningPlayer(GetSellingUnit())and((LoadInteger(LY,(GetHandleId((K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]))),((4304))))==1)==false and(XS[GetPlayerId((GetOwningPlayer(GetSoldUnit())))]==false)then
call D6O(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))])
set LW0=true
call ReviveHero(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))],GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),true)
set LW0=false
call SetUnitState(K1[GetPlayerId(GetOwningPlayer(GetSoldUnit()))],UNIT_STATE_MANA,10000)
set EL0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]=IMaxBJ(0,EL0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]-WS[GV1(GetHeroLevel(K1[GetPlayerId(GetOwningPlayer(GetSellingUnit()))]))])
call GN1(GetOwningPlayer(GetSoldUnit()))
else
call SetPlayerState(GetOwningPlayer(GetSoldUnit()),PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(GetOwningPlayer(GetSoldUnit()),PLAYER_STATE_RESOURCE_GOLD)+WS[GV1(GetHeroLevel(K1[GetPlayerId(GetOwningPlayer(GetSellingUnit()))]))])
if(XS[GetPlayerId((GetOwningPlayer(GetSoldUnit())))]==false)==false then
call PZI(GetOwningPlayer(GetSoldUnit()),"被死神镰刀杀死，无法买活")
endif
endif
endif
call KillUnit(GetSoldUnit())
endif
endfunction
function D9O takes player MDI,unit SWI,integer DAO,integer i0,integer i1,integer i2,integer i3,integer i4,integer i5 returns nothing
local item BA1
call DisableTrigger(MO0)
if i0>0 then
set BA1=UnitItemInSlot(SWI,0)
call EL1(BA1)
endif
if i1>0 then
set BA1=UnitItemInSlot(SWI,1)
call EL1(BA1)
endif
if i2>0 then
set BA1=UnitItemInSlot(SWI,2)
call EL1(BA1)
endif
if i3>0 then
set BA1=UnitItemInSlot(SWI,3)
call EL1(BA1)
endif
if i4>0 then
set BA1=UnitItemInSlot(SWI,4)
call EL1(BA1)
endif
if i5>0 then
set BA1=UnitItemInSlot(SWI,5)
call EL1(BA1)
endif
set BA1=UnitAddItemById(SWI,FR0[DAO])
call SetItemPlayer(BA1,MDI,true)
call SetItemUserData(BA1,0)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIem\\AIemTarget.mdl",SWI,"origin"))
if GetItemId(BA1)==WM0 then
call SetItemCharges(BA1,8)
endif
call EnableTrigger(MO0)
if IsPlayerAlly(GetLocalPlayer(),MDI)==true then
if DAO==VD0 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(MDI)]+(D80[GetPlayerId((MDI))])+"|r |c00ffff00"+"购买了梅肯斯姆"+"|r")
elseif DAO==W30 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(MDI)]+(D80[GetPlayerId((MDI))])+"|r |c00ffff00"+"购买了圣剑"+"|r")
endif
endif
set BA1=null
endfunction
// 物品合成
function DBO takes player p,unit SWI,integer E81 returns boolean
	local integer i
	local integer x
	local integer y
	local integer array DCO
	local boolean array DDO
	local integer array DEO
	local boolean array DFO
	local boolean array FW1
	local integer array FB1
	local player MDI
	local integer DGO=1
	local integer k
	local player array DHO
	local integer m
	local item DZO
	local item DVO
	local item DWO
	local item DXO
	local item DYO
	local item DJO
	local player DKO
	local player DLO
	local player DMO
	local player DNO
	local player DSO
	local player DTO
	local integer DRO
	local integer DPO
	local integer DQO
	local integer DUO
	local integer E0O
	local integer EIO
	local integer E1O
	local integer EOO
	local integer E2O
	local integer E3O
	local integer E4O
	local integer E5O
	local boolean E6O=false
	local boolean E7O=true
	set DZO=UnitItemInSlot(SWI,0)
	set DVO=UnitItemInSlot(SWI,1)
	set DWO=UnitItemInSlot(SWI,2)
	set DXO=UnitItemInSlot(SWI,3)
	set DYO=UnitItemInSlot(SWI,4)
	set DJO=UnitItemInSlot(SWI,5)
	set DKO=GetItemPlayer(DZO)
	set DLO=GetItemPlayer(DVO)
	set DMO=GetItemPlayer(DWO)
	set DNO=GetItemPlayer(DXO)
	set DSO=GetItemPlayer(DYO)
	set DTO=GetItemPlayer(DJO)
	set DRO=GetItemUserData(DZO)
	set DPO=GetItemUserData(DVO)
	set DQO=GetItemUserData(DWO)
	set DUO=GetItemUserData(DXO)
	set E0O=GetItemUserData(DYO)
	set EIO=GetItemUserData(DJO)
	set E1O=GetItemId(DZO)
	set EOO=GetItemId(DVO)
	set E2O=GetItemId(DWO)
	set E3O=GetItemId(DXO)
	set E4O=GetItemId(DYO)
	set E5O=GetItemId(DJO)
	if(GetPlayerSlotState((p))==PLAYER_SLOT_STATE_LEFT)then
		set DGO=5
		set E6O=true
	endif
	set DHO[1]=p
	if E6O then
		set k=2
		set m=1
		loop
			exitwhen k>DGO
			if IsPlayerTeam1(p)then
				if p!=BO[m]then
					set DHO[k]=BO[m]
					set k=k+1
				endif
			else
				if p!=CO[m]then
					set DHO[k]=CO[m]
					set k=k+1
				endif
			endif
			set m=m+1
		endloop
	endif
	set k=1
	loop
		exitwhen k>DGO
		set MDI=DHO[k]
		set i=0
		if DZO!=null and DRO==1 and(DKO==MDI or ZL or(GetPlayerSlotState((DKO))==PLAYER_SLOT_STATE_LEFT)==true)then
			set DCO[i+1]=E1O
		else
			set DCO[i+1]=0
		endif
		set i=1
		if DVO!=null and DPO==1 and(DLO==MDI or ZL or(GetPlayerSlotState((DLO))==PLAYER_SLOT_STATE_LEFT)==true)then
			set DCO[i+1]=EOO
		else
			set DCO[i+1]=0
		endif
		set i=2
		if DWO!=null and DQO==1 and(DMO==MDI or ZL or(GetPlayerSlotState((DMO))==PLAYER_SLOT_STATE_LEFT)==true)then
			set DCO[i+1]=E2O
		else
			set DCO[i+1]=0
		endif
		set i=3
		if DXO!=null and DUO==1 and(DNO==MDI or ZL or(GetPlayerSlotState((DNO))==PLAYER_SLOT_STATE_LEFT)==true)then
			set DCO[i+1]=E3O
		else
			set DCO[i+1]=0
		endif
		set i=4
		if DYO!=null and E0O==1 and(DSO==MDI or ZL or(GetPlayerSlotState((DSO))==PLAYER_SLOT_STATE_LEFT)==true)then
			set DCO[i+1]=E4O
		else
			set DCO[i+1]=0
		endif
		set i=5
		if DJO!=null and EIO==1 and(DTO==MDI or ZL or(GetPlayerSlotState((DTO))==PLAYER_SLOT_STATE_LEFT)==true)then
			set DCO[i+1]=E5O
		else
			set DCO[i+1]=0
		endif
		set DCO[0]=E81
		set i=1
		loop
			exitwhen i>(JC0)
			set DEO[0]=J50[i]
			set DEO[1]=J60[i]
			set DEO[2]=J70[i]
			set DEO[3]=J80[i]
			set DEO[4]=J90[i]
			if E7O then
				set DFO[0]=true
				set DFO[1]=true
				set DFO[2]=true
				set DFO[3]=true
				set DFO[4]=true
				set DFO[5]=true
				set DFO[6]=true
				set DDO[0]=true
				set DDO[1]=true
				set DDO[2]=true
				set DDO[3]=true
				set DDO[4]=true
				set DDO[5]=true
				set DDO[6]=true
				set FB1[0]=0
				set FB1[1]=0
				set FB1[2]=0
				set FB1[3]=0
				set FB1[4]=0
				set FB1[5]=0
				set FB1[6]=0
				set E7O=false
			endif
			set FW1[0]=false
			set FW1[1]=false
			set FW1[2]=false
			set FW1[3]=false
			set FW1[4]=false
			set x=0
			loop
				exitwhen x==5
				if DEO[x]==0 then
					set FW1[x]=true
				else
					set y=0
					loop
						exitwhen y==7
						if DCO[y]==DEO[x]and DDO[y]and DFO[x]then
							set DDO[y]=false
							set DFO[x]=false
							set FW1[x]=true
							set FB1[y]=1
							set y=7
							set E7O=true
						else
							set y=y+1
						endif
					endloop
				endif
				if FW1[x]==true then
					set x=x+1
				else
					set x=5
				endif
			endloop
			if FW1[0]and FW1[1]and FW1[2]and FW1[3]and FW1[4]then
				call D9O(MDI,SWI,JB0[i],FB1[1],FB1[2],FB1[3],FB1[4],FB1[5],FB1[6])
				set i=JC0+2
			else
				set i=i+1
			endif
		endloop
		set KK=FB1[0]==1
		if i==(JC0+2)then
			set DZO=null
			set DVO=null
			set DWO=null
			set DXO=null
			set DYO=null
			set DJO=null
			return true
		endif
		set k=k+1
	endloop
	set DZO=null
	set DVO=null
	set DWO=null
	set DXO=null
	set DYO=null
	set DJO=null
	return false
endfunction
function E8O takes player MDI,unit SWI,integer E81 returns boolean
local integer i=1
local boolean FB1
set KK=false
set FB1=DBO(MDI,SWI,E81)
return FB1
endfunction
function E9O takes nothing returns boolean
if IsUnitAlly(GetFilterUnit(),GetOwningPlayer(GK))==true and GetUnitAbilityLevel(GetFilterUnit(),'Aloc')==0 and UnitInventorySize(GetFilterUnit())>1 and GetUnitTypeId(GetFilterUnit())!='ncop' and GetPlayerAlliance(GetOwningPlayer(GetFilterUnit()),GetOwningPlayer(GK),ALLIANCE_SHARED_CONTROL)and GetOwningPlayer(GK)!=GetOwningPlayer(GetFilterUnit())and IsUnitIllusion(GetFilterUnit())==false and IsUnitDead(GetFilterUnit())==false then
if RYI(GetFilterUnit())==true then
set UJ=UJ+1
set HK=GetFilterUnit()
endif
endif
return false
endfunction
function EAO takes nothing returns boolean
if IsUnitAlly(GetFilterUnit(),GetOwningPlayer(GK))==true and GetUnitAbilityLevel(GetFilterUnit(),'Aloc')==0 and UnitInventorySize(GetFilterUnit())>1 and GetUnitTypeId(GetFilterUnit())!='ncop' and IsUnitIllusion(GetFilterUnit())==false and IsUnitDead(GetFilterUnit())==false then
if GetOwningPlayer(GK)==GetOwningPlayer(GetFilterUnit())then
if IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true then
if GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 then
set HK=GetFilterUnit()
endif
elseif IsUnitType(HK,UNIT_TYPE_HERO)==false then
set HK=GetFilterUnit()
endif
endif
endif
return false
endfunction
function EBO takes unit SWI,integer ECO returns unit
local group g=NTI()
set GK=SWI
set HK=null
call GroupEnumUnitsInRange(g,GetUnitX(ZK),GetUnitY(ZK),1300+ECO,Condition(function EAO))
if HK==null then
set UJ=0
call NSI(g)
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(ZK),GetUnitY(ZK),1100+ECO,Condition(function E9O))
if UJ>1 then
set HK=null
endif
endif
call NSI(g)
set g=null
return HK
endfunction
// 转换马甲物品
function EDO takes player MDI,unit SWI,unit EEO,integer E81,real x,real y,integer EY1,integer EFO returns nothing
	local unit EGO
	local item EJ1
	set ZK=EEO
	if GetUnitPointValue(SWI)==200 then
		set EGO=EBO(SWI,0)
		if EGO==null then
			set EGO=EBO(SWI,300)
		endif
	else
		set EGO=SWI
	endif
	if EGO==null or E8O(MDI,EGO,E71(E81))==false or KK==false then
		if EV1(E71(E81))then
			if EQ1(EGO)==0 or EGO==null then
				call EK1(FT0[E81],x,y,MDI,true,EY1)
			else
				set EJ1=UnitAddItemById(EGO,FR0[E81])
				call SetItemCharges(EJ1,EY1)
				call SetItemPlayer(EJ1,MDI,true)
				call SetItemUserData(EJ1,EFO)
			endif
		elseif EZ1(E71(E81))then
			if EGO==null or(EQ1(EGO)==0 and ES1(EGO,FR0[E81])==null)then
				call EK1(FT0[E81],x,y,MDI,true,F51(E81))
			else
				set EJ1=CreateItem(FT0[E81],x,y)
				call SetItemPlayer(EJ1,MDI,true)
				call SetItemUserData(EJ1,EFO)
				call SetItemCharges(EJ1,F51(E81))
				call UnitAddItem(EGO,EJ1)
			endif
		else
			if EQ1(EGO)==0 or EGO==null then
				call EK1(FT0[E81],x,y,MDI,false,0)
			else
				set EJ1=UnitAddItemById(EGO,FR0[E81])
				call SetItemPlayer(EJ1,MDI,true)
				call SetItemUserData(EJ1,0)
			endif
		endif
	else
		if IsUnitType(EGO,UNIT_TYPE_HERO)==true then
			if EFO==0 then
				call FL1("PUI_"+I2S(GetPlayerId(GetOwningPlayer(EGO))),FR0[E71(E81)])
			endif
		endif
	endif
	set EGO=null
	set EJ1=null
endfunction
function EHO takes player p,integer E81 returns nothing
local integer i=GetPlayerId(p)
if E81==Z50 then
set E[i]=E[i]+1
elseif E81==Z70 then
set E[i]=E[i]+1
elseif E81==Z80 then
set E[i]=E[i]+3
elseif E81==ZA0 then
set E[i]=E[i]+2
set F[i]=F[i]+2
elseif E81==ZB0 then
set E[i]=E[i]+2
set F[i]=F[i]+2
elseif E81==ZC0 then
set E[i]=E[i]+1
elseif E81==ZG0 then
set E[i]=E[i]+2
elseif E81==Z60 then
set E[i]=E[i]+2
elseif E81==ZH0 then
set E[i]=E[i]+2
endif
endfunction
function EZO takes unit EVO,unit EWO returns boolean
local integer E81
if GetUnitTypeId(EWO)=='N0MM' then
return true
endif
if(EVO==BL0 or EVO==BY0)and IsUnitAlly(EWO,CO[0])then
return false
elseif(EVO==II0 or EVO==QQ)and IsUnitAlly(EWO,BO[0])then
return false
endif
set E81=FO1(EWO)
if E81==ZA0 or E81==GZ0 or E81==ZZ0 then
return true
endif
return false
endfunction
function EXO takes unit EEO,unit EYO returns real
if EEO==QQ or EEO==UQ or EEO==I00 or EEO==II0 or EEO==I10 or EEO==IO0 or EEO==I20 or EEO==I30 or EEO==I40 or EEO==I50 then
return D40[GetPlayerId(GetOwningPlayer(EYO))]
elseif EEO==BY0 or EEO==BJ0 or EEO==BK0 or EEO==BL0 or EEO==BM0 or EEO==BN0 or EEO==BS0 or EEO==BT0 or EEO==BR0 or EEO==BP0 then
return D40[GetPlayerId(GetOwningPlayer(EYO))]
elseif EEO==VY or EEO==KZ then
return-7133.0
elseif EEO==WY or EEO==XY then
return 7207.0
endif
return GetUnitX(EYO)
endfunction
function EJO takes unit EEO,unit EYO returns real
if EEO==QQ or EEO==UQ or EEO==I00 or EEO==II0 or EEO==I10 or EEO==IO0 or EEO==I20 or EEO==I30 or EEO==I40 or EEO==I50 then
return D50[GetPlayerId(GetOwningPlayer(EYO))]
elseif EEO==BY0 or EEO==BJ0 or EEO==BK0 or EEO==BL0 or EEO==BM0 or EEO==BN0 or EEO==BS0 or EEO==BT0 or EEO==BR0 or EEO==BP0 then
return D50[GetPlayerId(GetOwningPlayer(EYO))]
elseif EEO==VY or EEO==KZ then
return 4317.0
elseif EEO==WY or EEO==XY then
return-4243.0
endif
return GetUnitY(EYO)
endfunction
function EKO takes unit EEO,unit EYO returns real
if EEO==QQ or EEO==UQ or EEO==I00 or EEO==II0 or EEO==I10 or EEO==IO0 or EEO==I20 or EEO==I30 or EEO==I40 or EEO==I50 then
return GetRectCenterX(O4)
elseif EEO==BY0 or EEO==BJ0 or EEO==BK0 or EEO==BL0 or EEO==BM0 or EEO==BN0 or EEO==BS0 or EEO==BT0 or EEO==BR0 or EEO==BP0 then
return GetRectCenterX(S3)
endif
return GetUnitX(EYO)
endfunction
function ELO takes unit EEO,unit EYO returns real
if EEO==QQ or EEO==UQ or EEO==I00 or EEO==II0 or EEO==I10 or EEO==IO0 or EEO==I20 or EEO==I30 or EEO==I40 or EEO==I50 then
return GetRectCenterY(O4)
elseif EEO==BY0 or EEO==BJ0 or EEO==BK0 or EEO==BL0 or EEO==BM0 or EEO==BN0 or EEO==BS0 or EEO==BT0 or EEO==BR0 or EEO==BP0 then
return GetRectCenterY(S3)
endif
return GetUnitY(EYO)
endfunction
function UnitItem_Delayed_Expire takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local unit u=(LoadUnitHandle(LY,(handle_id),(53)))
local unit s=(LoadUnitHandle(LY,(handle_id),(94)))
local integer E81=(LoadInteger(LY,(handle_id),(93)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer EY1=(LoadInteger(LY,(handle_id),(76)))
call EDO(p,u,s,E71(E81),x,y,EY1,0)
call ShowUnit(u,false)
call UnitApplyTimedLife(u,'BTLF',2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set p=null
set u=null
return false
endfunction
function EMO takes nothing returns nothing
local unit u=GetSoldUnit()
local player p=GetOwningPlayer(u)
local integer E81=FO1(u)
local real x
local real y
if EZO(GetSellingUnit(),u)then
call PZI(p,"你不能从敌方商店购买侦查守卫")
if IsUnitAlly(u,BO[0])then
set p=CO[0]
else
set p=BO[0]
endif
set x=EKO(GetSellingUnit(),u)
set y=ELO(GetSellingUnit(),u)
call EK1(FT0[FO1(u)],x,y,p,true,F51(FO1(u)))
else
call EHO(p,E71(E81))
if FR0[E81]==0 then
call PZI(p,"你不用为这个物品购买合成卷轴")
else
set x=EXO(GetSellingUnit(),u)
set y=EJO(GetSellingUnit(),u)
if E81==ZG0 then
call EDO(p,u,GetSellingUnit(),E71(E81),x,y,2,0)
else
call EDO(p,u,GetSellingUnit(),E71(E81),x,y,0,0)
endif
endif
endif
call UnitAddAbility(u,'Aloc')
call ShowUnit(u,false)
call UnitApplyTimedLife(u,'BTLF',2)
set u=null
set p=null
endfunction
function ENO takes nothing returns boolean
if SS==false then
if GetUnitPointValue(GetSoldUnit())>=200 then
call EMO()
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(GetSoldUnit()))or(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))then
if GetUnitTypeId(GetSoldUnit())=='h02F' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,20,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了一个动物信使"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h03Q' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,20,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了一个飞行信使"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h076' then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了显影之尘"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h02C' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了侦查守卫"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h02D' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了岗哨守卫"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h0BA' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了影之灵龛"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h01G' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了真视宝石"+"|r")
elseif GetUnitTypeId(GetSoldUnit())=='h0D3' then
call PingMinimapEx(GetUnitX(GetSoldUnit()),GetUnitY(GetSoldUnit()),3,255,255,255,false)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r |c00ffff00"+"购买了诡计之雾"+"|r")
endif
endif
else
call D7O()
endif
else
endif
return false
endfunction
function ETO takes unit u returns boolean
local integer id=GetUnitTypeId(u)
return id=='Eevi' or id=='Eevm' or id=='E02V' or id=='E02W' or id=='E02U'
endfunction
function ERO takes unit SFI,item BA1 returns nothing
local unit u=SFI
local integer EE1=GetUnitTypeId(u)
local integer E81=EC1(BA1)
if IsUnitType(u,UNIT_TYPE_MELEE_ATTACKER)==true or IsUnitType(u,UNIT_TYPE_HERO)==false then
if E81==WE0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[WD0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HM0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[HL0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==H80 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[H70])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==X40 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[X30])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==WW0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[WV0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==G30 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[G20])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==VN0 then
if ETO(u)==false then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[VM0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
elseif E81==VM0 then
if ETO(u)==true then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[VN0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
elseif E81==HR0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[HT0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
else
if E81==WD0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[WE0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HL0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[HM0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==H70 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[H80])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==X30 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[X40])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==WV0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[WW0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==G20 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[G30])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==VM0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[VN0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HT0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[HR0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
endif
set u=null
endfunction
function EPO takes unit SFI,item BA1 returns nothing
local unit u=SFI
local integer EE1=GetUnitTypeId(u)
local integer E81=EC1(BA1)
if IsUnitType(u,UNIT_TYPE_MELEE_ATTACKER)==false or IsUnitType(u,UNIT_TYPE_HERO)==false then
if E81==WE0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[WD0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HM0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[HL0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==H80 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[H70])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==X40 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[X30])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==WW0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[WV0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==G30 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[G20])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==VN0 then
if ETO(u)==false then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[VM0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
elseif E81==HR0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[HT0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
else
if E81==WD0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[WE0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HL0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[HM0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==H70 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[H80])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==X30 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[X40])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==WV0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[WW0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==G20 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[G30])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==VM0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[VN0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HT0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[HR0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
endif
set u=null
endfunction
function EQO takes unit SFI returns nothing
local integer i=0
local item BA1
call MUDisableItemTrigger()
loop
exitwhen i>5
set BA1=UnitItemInSlot(SFI,i)
if BA1!=null then
call EPO(SFI,BA1)
endif
set i=i+1
endloop
call MUEnableItemTrigger()
set BA1=null
endfunction
function EUO takes unit SFI,item BA1 returns boolean
local unit u=SFI
local integer EE1=GetUnitTypeId(u)
local integer E81=GetItemId(BA1)
local real x
local real y
local boolean F0O=true
local integer FIO=(LoadInteger(LY,(GetHandleId(GetOwningPlayer(u))),(4345)))
local integer F1O=0
local integer FF1
if FIO==0 then
set FIO=10
endif
set x=GetUnitX(u)
set y=GetUnitY(u)
if(E81==VZ0 and FIO<10)or(E81==VV0 and FIO<9)or(E81==VW0 and FIO<8)or(E81==VX0 and FIO<7)or(E81==VY0 and FIO<6)or(E81==VJ0 and FIO<5)or(E81==VK0 and FIO<4)then
if FIO==10 then
set F1O=VZ0
elseif FIO==9 then
set F1O=VV0
elseif FIO==8 then
set F1O=VW0
elseif FIO==7 then
set F1O=VX0
elseif FIO==6 then
set F1O=VY0
elseif FIO==5 then
set F1O=VJ0
elseif FIO==4 then
set F1O=VK0
endif
if F1O>0 then
set FF1=A11(u,BA1)
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=FD1(u,FR0[F1O],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
endif
if E81==HD0 then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",u,"overhead"))
call PEI(GetOwningPlayer(u),"Abilities\\Spells\\Human\\Heal\\HealTarget.wav")
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[HH0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if E81==V40 and GetItemCharges(BA1)==0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[V60])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if E81==HP0 and GetItemCharges(BA1)==0 then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[HQ0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
call MUDisableItemTrigger()
if(E81==ZM0 or E81==ZL0 or E81==ZN0)and(EM1(u,FR0[ZM0],BA1)!=null or EM1(u,FR0[ZL0],BA1)!=null or EM1(u,FR0[ZN0],BA1)!=null)then
call PZI(GetOwningPlayer(u),"你只能携带一个动力鞋")
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=CreateItem(FT0[E81],x,y)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if(E81==HL0)and(EM1(u,FR0[HL0],BA1)!=null or EM1(u,FR0[HM0],BA1)!=null)then
call PZI(GetOwningPlayer(u),"你只能携带一个压制之刃")
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=CreateItem(FT0[E81],x,y)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
set F0O=false
endif
if F0O and(E81==HM0)and(EM1(u,FR0[HL0],BA1)!=null or EM1(u,FR0[HM0],BA1)!=null)then
call PZI(GetOwningPlayer(u),"你只能携带一个压制之刃")
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=CreateItem(FT0[E81],x,y)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
set F0O=false
endif
if(E81==WT0 or E81==WS0 or E81==WP0 or E81==WR0)and(EM1(u,FR0[WT0],BA1)!=null or EM1(u,FR0[WS0],BA1)!=null or EM1(u,FR0[WP0],BA1)!=null or EM1(u,FR0[WR0],BA1)!=null)then
call PZI(GetOwningPlayer(u),"你只能携带一个莫尔迪基安的臂章")
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=CreateItem(FT0[E81],x,y)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if(E81==W30 and IsPlayerEnemy(GetItemPlayer(BA1),GetOwningPlayer(u)))then
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=UnitAddItemById(u,FR0[W40])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if(E81==VL0)and(RXI(u)or B61(u))then
if RXI(u)then
call PZI(GetOwningPlayer(u),"你的信使不能携带这件物品")
endif
set JK=GetItemPlayer(BA1)
set UJ=GetItemCharges(BA1)
call RemoveItem(BA1)
if E81==VL0 then
set VK=CreateItem(FT0[E81],GetRectCenterX(P4),GetRectCenterY(P4))
endif
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
if E81==VL0 then
call SetItemCharges(VK,UJ)
endif
endif
if B61(u)and E81==Z00 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=UnitAddItemById(u,FR0[ZI0])
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if F0O and(E81==HL0 or E81==HM0)and(EE1=='H06S')then
call PZI(GetOwningPlayer(u),"你的英雄不能携带这件物品")
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set VK=CreateItem(FT0[E81],x,y)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
set F0O=false
endif
if(E81==VZ0 or E81==VV0 or E81==VW0 or E81==VX0 or E81==VY0 or E81==VJ0)and EE1=='U00C' then
call DisplayTimedTextToPlayer(GetOwningPlayer(u),0,U2,10,"|c00ff0303"+"由于War3的自有bug，不要在一次天神下凡结束前使用另一次"+"|r")
endif
call MUEnableItemTrigger()
if F0O then
call ERO(SFI,BA1)
endif
set u=null
set BA1=null
return false
endfunction
function FOO takes integer E81 returns boolean
return E81==V90 or E81==WR0 or E81==WP0 or E81==WU0 or E81==V80 or E81==WS0 or E81==WT0 or E81==WQ0 or E81==GZ0 or E81==GV0 or E81==ZS0 or E81==ZT0
endfunction
function F2O takes integer E81 returns boolean
return E81==GZ0 or E81==GV0
endfunction
function F3O takes unit SFI,item BA1 returns boolean
local integer FE1=0
local item AO1=BA1
local integer E81=F01(AO1)
local integer F4O=0
local boolean FB1=false
local integer F5O=FI1(AO1)
local boolean F6O=false
if IsUnitType(SFI,UNIT_TYPE_HERO)==true then
if E81==V90 then
set F4O=V80
endif
if E81==ZT0 then
set F4O=ZS0
endif
if E81==WR0 then
set F4O=WS0
endif
if E81==WP0 then
set F4O=WT0
endif
if E81==WU0 then
set F4O=WQ0
endif
if E81==GV0 then
set F4O=GZ0
endif
if F5O==GV0 then
set F4O=GZ0
set F6O=true
endif
if F4O!=0 then
set JK=GetItemPlayer(AO1)
call EL1(AO1)
if F6O then
set VK=UnitAddItemById(SFI,FQ0[F4O])
else
set VK=UnitAddItemById(SFI,FR0[F4O])
endif
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
set FB1=true
endif
else
if E81==V80 then
set F4O=V90
endif
if E81==ZS0 then
set F4O=ZT0
endif
if E81==WS0 then
set F4O=WR0
endif
if E81==WT0 then
set F4O=WP0
endif
if E81==WQ0 then
set F4O=WU0
endif
if E81==GZ0 then
set F4O=GV0
endif
if F5O==GZ0 then
set F4O=GV0
set F6O=true
endif
if F4O!=0 then
set JK=GetItemPlayer(AO1)
call EL1(AO1)
if F6O then
set VK=UnitAddItemById(SFI,FQ0[F4O])
else
set VK=UnitAddItemById(SFI,FR0[F4O])
endif
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
set FB1=true
endif
endif
set AO1=null
return FB1
endfunction
function F7O takes unit SFI,item BA1 returns boolean
if FOO(F01(BA1))or F2O(FI1(BA1))then
return F3O(SFI,BA1)
endif
return false
endfunction
function ModeTT_ItemHack_End takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer id=(LoadInteger(LY,(handle_id),(34)))
set AII[id]=false
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function F8O takes unit u returns nothing
local integer id=GetPlayerId(GetOwningPlayer(u))
set AII[id]=true
endfunction
// 转换物品
function F9O takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit B71=(LoadUnitHandle(LY,(handle_id),(26)))
	local integer FAO=(LoadInteger(LY,(handle_id),(97)))
	local integer E81=(LoadInteger(LY,(handle_id),(93)))
	local boolean FBO=(LoadBoolean(LY,(handle_id),(95)))
	local item BA1
	local player p=GetOwningPlayer(B71)
	local player FCO
	local integer EY1
	local boolean EX1=false
	local item EJ1
	local integer FDO
	local integer FEO
	local integer newCharges
	local item FFO
	local integer targetCount
	local item FGO
	local boolean FHO=false
	call DisableTrigger(MO0)
	if FBO then
		set FGO=null
		set FCO=(LoadPlayerHandle(LY,(handle_id),(54)))
		set EY1=(LoadInteger(LY,(handle_id),(76)))
	else
		set BA1=(LoadItemHandle(LY,(handle_id),(96)))
		set FGO=BA1
		set FCO=GetItemPlayer(BA1)
		set EY1=GetItemCharges(BA1)
	endif
	if FBO==false and BA1==null then
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
		call EnableTrigger(MO0)
		set t=null
		set B71=null
		set p=null
		return false
	endif
	if FAO==1 then
		// 获得物品
		if p!=FCO and GetUnitTypeId(B71)=='ncop' then
			if EZ1(E71(E81))or EV1(E71(E81))then
				set EX1=true
			endif
			if IsPlayerEnemy(p,FCO)then
				call EK1(FT0[E81],D40[GetPlayerId(p)],D50[GetPlayerId(p)],FCO,EX1,EY1)
			else
				call EK1(FT0[E81],D40[GetPlayerId(FCO)],D50[GetPlayerId(FCO)],FCO,EX1,EY1)
			endif
			call PZI(p,"你不可以用你的能量环來拿起其他人的物品")
			if FBO==false then
				set FHO=true
				call EL1(BA1)
			endif
		elseif ZL==false and FBO==false and GetItemType(BA1)==ITEM_TYPE_CAMPAIGN and F11(BA1)!=0 and((p==FCO and not MUIsMessenger(B71)) or(GetPlayerSlotState((FCO))==PLAYER_SLOT_STATE_LEFT))then
			if EV1(E81)or EZ1(E81)then
				set EX1=true
			else
				set EX1=false
			endif
			if(GetPlayerSlotState((FCO))==PLAYER_SLOT_STATE_LEFT)and E91(E81)then
				else
				call EL1(BA1)
				set FHO=true
				set EJ1=UnitAddItemById(B71,FR0[E81])
				set FGO=EJ1
				call SetItemPlayer(EJ1,FCO,false)
				call SetItemUserData(EJ1,0)
				if EX1 then
					call SetItemCharges(EJ1,EY1)
				endif
			endif
		elseif ZL==false and FBO==false and GetItemType(BA1)==ITEM_TYPE_PERMANENT and (p!=FCO or MUIsMessenger(B71)) and FQ0[GetItemId(BA1)]!=0 and(GetPlayerSlotState((FCO))==PLAYER_SLOT_STATE_LEFT)==false then
			if EV1(E81)or EZ1(E81)then
				set EX1=true
			else
				set EX1=false
			endif
			call EL1(BA1)
			set FHO=true
			set EJ1=UnitAddItemById(B71,FQ0[E81])
			set FGO=EJ1
			call SetItemPlayer(EJ1,FCO,false)
			call SetItemUserData(EJ1,0)
			if EX1 then
				call SetItemCharges(EJ1,EY1)
			endif
		elseif FBO==false and GetItemType(BA1)==ITEM_TYPE_PERMANENT and EH1(BA1)and IsUnitType(B71,UNIT_TYPE_HERO)==true then
			set FDO=ED1(B71)
			set FEO=EF1(B71)
			if FEO!=0 then
				call UnitAddAbility(B71,FEO)
				call UnitMakeAbilityPermanent(B71,true,FEO)
				call SetPlayerAbilityAvailable(p,FEO,false)
				if GetUnitTypeId(B71)=='H00U' then
					set GK=B71
					call ExecuteFunc("FZO")
				elseif GetUnitTypeId(B71)=='Hmkg' then
					set GK=B71
					call ExecuteFunc("FVO")
				endif
			endif
			if E81!=FDO then
				call EL1(BA1)
				set EJ1=UnitAddItemById(B71,FR0[FDO])
				set FGO=EJ1
				call SetItemPlayer(EJ1,FCO,false)
				call SetItemUserData(EJ1,1)
			endif
		elseif FBO==false and GetItemType(BA1)==ITEM_TYPE_ARTIFACT then
			call MUDisableItemTrigger()
			set FFO=ET1(FCO,B71,E81,BA1)
			if FFO==null then
			else
				call SetItemCharges(FFO,EY1+GetItemCharges(FFO))
				call EL1(BA1)
				set FGO=null
			endif
			call MUEnableItemTrigger()
		elseif FBO and EZ1(E71(E81))then
			call MUDisableItemTrigger()
			if EQ1(B71)==0 and ER1(FCO,B71,E81)==null then
				call PZI(p,"物品栏已满")
				call EK1(FT0[(E81)],(((LoadReal(LY,(handle_id),(6))))*1.0),(((LoadReal(LY,(handle_id),(7))))*1.0),(FCO),(true),(EY1))
			else
				set FFO=ER1(FCO,B71,E81)
				if FFO==null then
					//call MUDisableItemTrigger()
					set EJ1=UnitAddItemById(B71,FR0[E81])
					set FGO=EJ1
					call SetItemPlayer(EJ1,FCO,false)
					call SetItemUserData(EJ1,1)
					call SetItemCharges(EJ1,EY1)
				else
					call SetItemCharges(FFO,EY1+GetItemCharges(FFO))
				endif
			endif
			call MUEnableItemTrigger()
		elseif FBO==true then
			call EDO(FCO,B71,null,E81,(LoadReal(LY,(handle_id),(6))),(LoadReal(LY,(handle_id),(7))),EY1,1)
		elseif FBO==false and(GetItemType(BA1)==ITEM_TYPE_PERMANENT or GetItemType(BA1)==ITEM_TYPE_CAMPAIGN)then
			call SetItemUserData(BA1,1)
			set FHO=E8O(FCO,B71,0)
		endif
		if FHO==false and FGO!=null and F61(FGO)==false then
			set FHO=F7O(B71,FGO)
		endif
		if FHO==false and FGO!=null and F61(FGO)==false then
			call EUO(B71,FGO)
		endif
	else
		// 丢弃物品
		if GetWidgetLife(BA1)>0 then
			set FDO=ED1(B71)
			set FEO=EF1(B71)
			if ES1(B71,FR0[FDO])==null and GetUnitAbilityLevel(B71,FEO)>0 then
				call UnitRemoveAbility(B71,FEO)
				if GetUnitTypeId(B71)=='Hmkg' then
					set GK=B71
					call ExecuteFunc("FWO")
				endif
			endif
			if IsItemOwned(BA1)==false then
				if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(E81)or EZ1(E81)then
					set EX1=true
				endif
				call EK1(FT0[E81],GetItemX(BA1),GetItemY(BA1),FCO,EX1,EY1)
				call EL1(BA1)
			endif
		endif
	endif
	call FlushChildHashtable(LY,(handle_id))
	call FlushTrigger(t)
	call EnableTrigger(MO0)
	set t=null
	set BA1=null
	set B71=null
	set p=null
	set FCO=null
	set EJ1=null
	set FFO=null
	set FGO=null
	return false
endfunction
function FXO takes nothing returns boolean
call MUEnableItemTrigger()
call FlushTrigger(GetTriggeringTrigger())
return false
endfunction
function DelayTrigger takes nothing returns nothing
local trigger t=CreateTrigger()
call MUDisableItemTrigger()
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function FXO))
set t=null
endfunction
// 获得/失去物品
function FYO takes nothing returns boolean
	local item BA1
	local integer FAO
	local unit B71=GetTriggerUnit()
	local trigger t
	local integer handle_id
	local integer FDO
	local integer FEO
	local integer id
	set id=GetPlayerId(GetOwningPlayer(B71))
	if(IsUnitType(B71,UNIT_TYPE_HERO)==true or B61(B71))and IsUnitIllusion(B71)==false and GetUnitTypeId(B71)!='N0MM' then
		if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
			if GetItemTypeId(GetManipulatedItem())==FR0[HC0]then
				set LK0=LK0+1
				set L90[id]=L90[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[GJ0]then
				set LL0=LL0+1
				set LA0[id]=LA0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[WM0]then
				set LM0=LM0+1
				set LB0[id]=LB0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V10]or GetItemTypeId(GetManipulatedItem())==FR0[XD0]then
				set LN0=LN0+1
				set LC0[id]=LC0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[WA0]then
				set LS0=LS0+1
				set M90[id]=M90[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[WO0]then
				set LJ0=LJ0+1
				set LD0[id]=LD0[id]+1
				call F71(B71,'I0HM')
			elseif GetItemTypeId(GetManipulatedItem())==FR0[VE0]then
				set LT0=LT0+1
				set LE0[id]=LE0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[VI0]then
				set LR0=LR0+1
				set LF0[id]=LF0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[XC0]then
				set LP0=LP0+1
				set M00[id]=M00[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[Z00]then
				set LQ0=LQ0+1
				set MA0[id]=MA0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V40]then
				set LU0=LU0+1
				set MI0[id]=MI0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V50]then
				set LU0=LU0+1
				set MI0[id]=MI0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V60]then
				set LU0=LU0+1
				set MI0[id]=MI0[id]+1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V70]then
				set LU0=LU0+1
				set MI0[id]=MI0[id]+1
			endif
		elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM then
			if GetItemTypeId(GetManipulatedItem())==FR0[HC0]then
				set L90[id]=L90[id]-1
				set LK0=LK0-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[GJ0]and GetUnitTypeId(B71)!='N0MM' then
				set LA0[id]=LA0[id]-1
				set LL0=LL0-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[Z00]then
				set MA0[id]=MA0[id]-1
				set LQ0=LQ0-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[WM0]then
				set LB0[id]=LB0[id]-1
				set LM0=LM0-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V10]or GetItemTypeId(GetManipulatedItem())==FR0[XD0]then
				set LN0=LN0-1
				set LC0[id]=LC0[id]-1
				if LC0[id]<1 or EM1(B71,FR0[V10],GetManipulatedItem())==null or EM1(B71,FR0[XD0],GetManipulatedItem())==null then
					call UnitRemoveAbility(B71,'A174')
				endif
			elseif GetItemTypeId(GetManipulatedItem())==FR0[WA0]and GetUnitTypeId(B71)!='N0MM' then
				set M90[id]=M90[id]-1
				set LS0=LS0-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[WO0]or GetItemTypeId(GetManipulatedItem())==FQ0[WO0]then
				set LJ0=IMaxBJ(LJ0-1,0)
				set LD0[id]=IMaxBJ(LD0[id]-1,0)
				call UnitRemoveAbility(B71,'B0BI')
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V40]then
				set LU0=LU0-1
				set MI0[id]=MI0[id]-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V50]then
				set LU0=LU0-1
				set MI0[id]=MI0[id]-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V60]then
				set LU0=LU0-1
				set MI0[id]=MI0[id]-1
			elseif GetItemTypeId(GetManipulatedItem())==FR0[V70]then
				set LU0=LU0-1
				set MI0[id]=MI0[id]-1
			endif
		endif
	endif
	if GetTriggerEventId()==EVENT_PLAYER_UNIT_PAWN_ITEM then
		set BA1=GetSoldItem()
		call SetItemUserData(BA1,-2)
		set FDO=ED1(B71)
		set FEO=EF1(B71)
		if EM1(B71,FR0[FDO],BA1)==null and GetUnitAbilityLevel(B71,FEO)>0 then
			call UnitRemoveAbility(B71,FEO)
			if GetUnitTypeId(B71)=='Hmkg' then
				set GK=B71
				call ExecuteFunc("FWO")
			endif
		endif
		if OSI==true then
			call F8O(B71)
		endif
	elseif GetItemTypeId(GetManipulatedItem())!='I00E' and GetItemTypeId(GetManipulatedItem())!='I02M' then
		set BA1=GetManipulatedItem()
		if IsUnitIllusion(B71)or GetItemUserData(BA1)==-2 then
			set BA1=null
			set B71=null
			set t=null
			return false
		endif
		if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
			set FAO=1
		else
			set FAO=2
		endif
		if(FAO==1 or(FAO==2 and F61(BA1)==false and GetWidgetLife(BA1)>0))and GetUnitTypeId(B71)!='H00J' then
			set t=CreateTrigger()
			set handle_id=GetHandleId(t)
			call TriggerRegisterTimerEvent(t,0,false)
			call TriggerAddCondition(t,Condition(function F9O))
			call SaveUnitHandle(LY,(handle_id),(26),(B71))
			call SaveInteger(LY,(handle_id),(97),(FAO))
			call SaveInteger(LY,(handle_id),(93),(GetItemId(BA1)))
			if F61(BA1)then
				call SaveBoolean(LY,(handle_id),(95),(true))
				call SavePlayerHandle(LY,(handle_id),(54),(GetItemPlayer(BA1)))
				call SaveInteger(LY,(handle_id),(76),(GetItemCharges(BA1)))
				call SaveReal(LY,(handle_id),(6),((GetItemX(BA1))*1.0))
				call SaveReal(LY,(handle_id),(7),((GetItemY(BA1))*1.0))
			else
				call SaveBoolean(LY,(handle_id),(95),(false))
				call SaveItemHandle(LY,(handle_id),(96),(BA1))
				call SaveInteger(LY,(handle_id),(76),(GetItemCharges(BA1)))
				call SetItemUserData(BA1,0)
			endif
		else
		endif
	endif
	set BA1=null
	set B71=null
	set t=null
	return false
endfunction
function FKO takes nothing returns boolean
if GetSpellAbilityId()=='A1RI' or GetSpellAbilityId()=='A0BE' then
if IsUnitDead(GetTriggerUnit())==false then
call EQO(GetTriggerUnit())
endif
endif
return false
endfunction
function RestrictedItems_UpdateMeleeRange_All2 takes nothing returns nothing
call EQO(GK)
endfunction
function FMO takes unit SFI,integer FNO,boolean FSO returns nothing
local string FTO
local string s
local player p=GetOwningPlayer(SFI)
local real d=2
local string FRO="Use"
if FSO then
set FRO="Store"
endif
if FNO=='I006' then
set FTO="|c00ff0000"+"加速"+"|r"
call FL1("Rune"+FRO+"1",GetPlayerId(p))
elseif FNO=='I008' then
set FTO="|c0000ff00"+"恢复"+"|r"
call FL1("Rune"+FRO+"2",GetPlayerId(p))
elseif FNO=='I00K' then
set FTO="|c000000ff"+"双倍伤害"+"|r"
call FL1("Rune"+FRO+"3",GetPlayerId(p))
elseif FNO=='I007' then
set FTO="|c00afaf00"+"幻象"+"|r"
call FL1("Rune"+FRO+"4",GetPlayerId(p))
elseif FNO=='I00J' then
set FTO="|c00652DC1"+"隐身"+"|r"
call FL1("Rune"+FRO+"5",GetPlayerId(p))
elseif FNO=='I0RC' then
set FTO="|c00FFD700"+"赏金"+"|r"
call FL1("Rune"+FRO+"6",GetPlayerId(p))
endif
if FSO then
set s=C0[GetPlayerId(p)]+GetUnitName(SFI)+"|r "+"装载了"+"|r "+FTO+" "+"神符"
set d=1
else
if M10 then
set s=C0[GetPlayerId(p)]+GetUnitName(SFI)+"|r "+"使用了储备的"+"|r "+FTO+" "+"神符"
else
set s=C0[GetPlayerId(p)]+GetUnitName(SFI)+"|r "+"获得了"+"|r "+FTO+" "+"神符"
endif
endif
if(IsPlayerAlly(GetLocalPlayer(),p)and GetLocalPlayer()!=p)or P0I(GetLocalPlayer())then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,d,s)
endif
endfunction
function FPO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetUnitAbilityLevel(SFI,'B01S')==0 then
call UnitRemoveAbility(SFI,'B01S')
call UnitRemoveAbility(SFI,'B04A')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetUnitState(SFI,UNIT_STATE_LIFE)==GetUnitState(SFI,UNIT_STATE_MAX_LIFE)and GetUnitState(SFI,UNIT_STATE_MANA)==GetUnitState(SFI,UNIT_STATE_MAX_MANA)then
call UnitRemoveAbility(SFI,'B01S')
call UnitRemoveAbility(SFI,'B04A')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
return false
endfunction
function FQO takes unit SFI,item BA1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function FPO))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
endfunction
function FUO takes unit SFI,item BA1 returns nothing
local integer G0O=R2I((TimerGetElapsed(M))/60)
local integer XP=50+5*G0O
local integer ROI=50+2*G0O
local boolean GIO=(LoadBoolean(LY,(GetHandleId(BA1)),(835)))
if GIO then
set XP=100
set ROI=100
endif
call AddHeroXP(SFI,XP,true)
call AA1(GetOwningPlayer(SFI),ROI,SFI)
call PlaySoundOnUnitBJ(AG,100,SFI)
endfunction
function G1O takes unit SFI,item BA1 returns nothing
local unit u=SFI
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local unit dummy=CreateUnit(GetOwningPlayer(u),'e00E',x,y,0)
if IsUnitType(u,UNIT_TYPE_MELEE_ATTACKER)==true then
call UnitAddAbility(dummy,'A2XN')
else
call UnitAddAbility(dummy,'A0GR')
endif
call IssueTargetOrderById(dummy,852274,u)
call IssueTargetOrderById(dummy,852274,u)
set u=null
set dummy=null
endfunction
function GOO takes unit SFI,item BA1 returns nothing
if GetItemTypeId(BA1)=='I007' or GetItemTypeId(BA1)=='I006' or GetItemTypeId(BA1)=='I008' or GetItemTypeId(BA1)=='I00K' or GetItemTypeId(BA1)=='I00J' or GetItemTypeId(BA1)=='I0RC' then
call FMO(SFI,GetItemTypeId(BA1),false)
endif
if GetItemTypeId(BA1)=='I007' then
call G1O(SFI,BA1)
elseif GetItemTypeId(BA1)=='I00J' then
if GetUnitAbilityLevel(SFI,'B09Y')>0 then
call UnitRemoveAbility(SFI,'B09Y')
call UnitRemoveAbility(SFI,'B01Q')
call DisableTrigger(GetTriggeringTrigger())
call UnitAddItemById(SFI,'I00J')
call EnableTrigger(GetTriggeringTrigger())
endif
elseif GetItemTypeId(BA1)=='I008' then
call FQO(SFI,BA1)
elseif GetItemTypeId(BA1)=='I0RC' then
call FUO(SFI,BA1)
endif
endfunction
function G2O takes unit SFI,item BA1 returns nothing
local integer IB1
local integer level
call UnitRemoveAbility(SFI,'A27S')
call UnitRemoveAbility(SFI,'A27Q')
call UnitRemoveAbility(SFI,'A27R')
call UnitRemoveAbility(SFI,'A27T')
if GetUnitAbilityLevel(SFI,'A28F')>0 then
call UnitRemoveAbility(SFI,'A28F')
call UnitAddAbility(SFI,'A28F')
endif
if GetUnitTypeId(SFI)=='Edem' then
set IB1='A0KY'
elseif GetUnitTypeId(SFI)=='U00F' then
set IB1='A06D'
elseif GetUnitTypeId(SFI)=='EC77' then
set IB1='A0MM'
elseif GetUnitTypeId(SFI)=='Ogrh' then
set IB1='A0YK'
elseif GetUnitTypeId(SFI)=='H00J' or GetUnitTypeId(SFI)=='H00I' then
set IB1='A2QA'
elseif GetUnitTypeId(SFI)=='UC60' then
set IB1='A2TS'
else
set SFI=null
return
endif
set level=GetUnitAbilityLevel(SFI,IB1)
if level>0 then
call UnitRemoveAbility(SFI,IB1)
call UnitAddAbility(SFI,IB1)
call SetUnitAbilityLevel(SFI,IB1,level)
endif
endfunction
function G3O takes item BA1,unit hero,boolean G4O returns nothing
local integer E81=GetItemId(BA1)
local integer handle_id=GetHandleId(hero)
local string s=""
if(E81==GZ0 and EM1(hero,GZ0,BA1)==null)or(E81==GV0 and EM1(hero,GV0,BA1)==null)then
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))==true or P0I(GetLocalPlayer())then
set s="Abilities\\Spells\\Human\\MagicSentry\\MagicSentryCaster.mdl"
endif
if G4O then
if EQ1(hero)>0 or GetItemType(BA1)==ITEM_TYPE_PERMANENT or GetItemType(BA1)==ITEM_TYPE_CAMPAIGN then
if GetUnitAbilityLevel(hero,'A26A')==0 and GetUnitAbilityLevel(hero,'A26B')==0 then
if s=="Abilities\\Spells\\Human\\MagicSentry\\MagicSentryCaster.mdl" then
call AddSkill(hero,'A26A')
else
call AddSkill(hero,'A26B')
endif
endif
endif
else
if not(GetUnitAbilityLevel(hero,'A26A')==0 and GetUnitAbilityLevel(hero,'A26B')==0)then
call UnitRemoveAbility(hero,'A26B')
call UnitRemoveAbility(hero,'A26A')
call RemoveSavedHandle(LY,(handle_id),(670))
endif
endif
endif
endfunction
function G5O takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local item BA1=GetManipulatedItem()
local integer id=GetItemTypeId(BA1)
if BA1==null or IsUnitIllusion(SFI)==true or IsUnitType(SFI,UNIT_TYPE_HERO)==false or V51(GetUnitTypeId(SFI))or GetItemTypeId(BA1)=='I00E' or GetItemTypeId(BA1)=='I02M' then
set SFI=null
set BA1=null
return false
endif
if(GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM and GetItemType(BA1)!=ITEM_TYPE_PURCHASABLE)or GetTriggerEventId()==EVENT_PLAYER_UNIT_PAWN_ITEM then
call G3O(BA1,SFI,false)
call FL1("DRI_"+I2S(GetPlayerId(GetOwningPlayer(SFI))),FR0[E71(GetItemId(BA1))])
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
call G3O(BA1,SFI,true)
call FL1("PUI_"+I2S(GetPlayerId(GetOwningPlayer(SFI))),FR0[E71(GetItemId(BA1))])
endif
set SFI=null
set BA1=null
return false
endfunction
function G7O takes nothing returns boolean
local integer i
if M50>0 and M30[1]<1 then
set i=2
loop
exitwhen i>M50
set M30[i-1]=M30[i]
set M40[i-1]=M40[i]
set i=i+1
endloop
set M50=M50-1
endif
set i=1
loop
exitwhen i>M50
if M30[i]>=1 then
set M30[i]=M30[i]-1
if M30[i]<1 then
call SetItemDroppable(M40[i],true)
endif
endif
set i=i+1
endloop
return false
endfunction
function G8O takes item BA1 returns nothing
set M50=M50+1
set M40[M50]=BA1
set M30[M50]=(GI0[(F01(BA1))])
call SetItemDroppable(BA1,false)
endfunction
function G9O takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())!='e00E' and(GI0[(F01(GetManipulatedItem()))])>0 then
call G8O(GetManipulatedItem())
endif
return false
endfunction
function GAO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(26)))
local integer GBO=(LoadInteger(LY,(handle_id),(98)))
local item BA1=UnitItemInSlot(u,GBO)
if BA1!=null and E91(GetItemId(BA1))==false and GetWidgetLife(BA1)>0 and EG1(BA1)==false then
call SetItemDroppable(BA1,true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set BA1=null
return false
endfunction
function GCO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(26)))
local integer GBO=(LoadInteger(LY,(handle_id),(98)))
local item BA1=UnitItemInSlot(u,GBO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if(u!=null and GetUnitTypeId(u)>1 and IsUnitType(u,UNIT_TYPE_DEAD)==false)and(BA1!=null and GetWidgetLife(BA1)>0)then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SetItemDroppable(BA1,false)
call SaveInteger(LY,(handle_id),(98),(GBO))
call SaveUnitHandle(LY,(handle_id),(26),(u))
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerAddCondition(t,Condition(function GAO))
endif
set BA1=null
set u=null
set t=null
return false
endfunction
function GDO takes nothing returns nothing
local integer GBO
local unit u=GetTriggerUnit()
local trigger t
local integer handle_id
local item BA1
if GetIssuedOrderId()==852008 then
set GBO=0
elseif GetIssuedOrderId()==852009 then
set GBO=1
elseif GetIssuedOrderId()==852010 then
set GBO=2
elseif GetIssuedOrderId()==852011 then
set GBO=3
elseif GetIssuedOrderId()==852012 then
set GBO=4
elseif GetIssuedOrderId()==852013 then
set GBO=5
endif
set BA1=UnitItemInSlot(u,GBO)
if BA1!=null and GetWidgetLife(BA1)>0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(98),(GBO))
call SaveUnitHandle(LY,(handle_id),(26),(u))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function GCO))
endif
set BA1=null
set u=null
set t=null
endfunction
function ItemCooldown_CheckOrderID takes nothing returns boolean
if GetIssuedOrderId()==852008 or GetIssuedOrderId()==852009 or GetIssuedOrderId()==852010 or GetIssuedOrderId()==852011 or GetIssuedOrderId()==852012 or GetIssuedOrderId()==852013 then
call GDO()
endif
return false
endfunction
function GFO takes nothing returns nothing
local unit u=GetTriggerUnit()
local item BA1
local integer i=0
local real x=GetUnitX(u)
local real y=GetUnitY(u)
local integer E81
local item EJ1
call MUDisableItemTrigger()
loop
exitwhen i>5
set BA1=UnitItemInSlot(u,i)
set E81=GetItemId(BA1)
if E81==ZV0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[HI0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[HB0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==ZY0 or E81==ZJ0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[H10],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[H50],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==WQ0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[GQ0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[GT0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[YW0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==WU0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[GQ0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[GT0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[YW0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==WY0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[GX0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[V30],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[YL0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==X90 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[G40],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[GG0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==V80 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[GW0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[GM0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==V90 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[GW0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[GM0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==VM0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[V00],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[H90],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[Y30],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==VN0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[V00],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[H90],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[Y30],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==HS0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[GF0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[X50],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==VE0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[VI0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[V00],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==Z20 or E81==Z30 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[ZQ0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[ZY0],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
elseif E81==XD0 then
set JK=GetItemPlayer(BA1)
call RemoveItem(BA1)
set EJ1=CreateItem(FT0[H30],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
set EJ1=CreateItem(FT0[V10],x,y)
call SetItemPlayer(EJ1,JK,false)
call SetItemUserData(EJ1,1)
endif
set i=i+1
endloop
call MUEnableItemTrigger()
set u=null
set BA1=null
set EJ1=null
endfunction
function GGO takes nothing returns boolean
if GetSpellAbilityId()=='A0K5' or GetSpellAbilityId()=='A1RF' then
call GFO()
endif
return false
endfunction
function GZO takes integer E81 returns boolean
return E81!=W30 and E81!=WM0 and E81!=GZ0 and E81!=VL0
endfunction
function GVO takes nothing returns nothing
if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
call SetItemPawnable(GetManipulatedItem(),false)
else
call SetItemPawnable(GetManipulatedItem(),true)
endif
endfunction
function GWO takes nothing returns boolean
if GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and GZO(F01(GetManipulatedItem()))and RYI(GetTriggerUnit())then
call GVO()
endif
return false
endfunction
function GYO takes nothing returns nothing
local integer x=1
local player p
loop
exitwhen x>16
if ES1(K1[x],FR0[WM0])!=null then
call RemoveUnit(M70[GetPlayerId(GetOwningPlayer(K1[x]))])
endif
set x=x+1
endloop
endfunction
function Bloodstone_ItemCondition takes nothing returns boolean
return GetItemTypeId(GetManipulatedItem())==FR0[WM0]and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true
endfunction
function GJO takes nothing returns boolean
return IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and V51(GetUnitTypeId(GetFilterUnit()))==false and ES1(GetTriggerUnit(),FR0[WM0])!=null
endfunction
function GKO takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')!=1 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1
endfunction
function GLO takes nothing returns nothing
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)+JO)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\BloodstoneHealTarget.mdx",GetEnumUnit(),"origin"))
endfunction
function Bloodstone_RegisterUnit takes nothing returns nothing
call SCI(GetEnumUnit(),4254,40)
endfunction
function GMO takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),1700,Condition(function GKO))
set JO=500+30*GetItemCharges(ES1(GetTriggerUnit(),FR0[WM0]))
call ForGroup(g,function GLO)
call NSI(g)
set g=null
endfunction
function GNO takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'H00M',GetUnitX(SFI),GetUnitY(SFI),GetUnitFacing(SFI))
set M70[GetPlayerId(GetOwningPlayer(SFI))]=dummy
call GMO()
endfunction
function GTO takes unit u returns nothing
local integer GRO=GetItemCharges(ES1(u,FR0[WM0]))
if GRO>0 then
call SetUnitState(u,UNIT_STATE_MANA,GetUnitState(u,UNIT_STATE_MANA)+GRO)
endif
endfunction
function GPO takes nothing returns boolean
local integer i=1
local unit SFI
local integer id
if LM0>0 then
loop
exitwhen i>5
set id=GetPlayerId(BO[i])
set SFI=K1[id]
if LB0[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false then
call GTO(SFI)
endif
set id=GetPlayerId(CO[i])
set SFI=K1[id]
if LB0[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false then
call GTO(SFI)
endif
set i=i+1
endloop
endif
set SFI=null
return false
endfunction
function GUO takes unit H0O,unit hero returns nothing
local string fx=""
if IsPlayerEnemy(GetLocalPlayer(),GetOwningPlayer(hero))and P0I(GetLocalPlayer())==false then
set fx="war3mapImported\\WardMark_T2.mdx"
endif
call AddSpecialEffectTarget(fx,H0O,"origin")
endfunction
function HIO takes nothing returns boolean
return true
endfunction
function H1O takes unit SFI,unit H0O returns nothing
local integer HOO
local item H2O
if GetUnitTypeId(H0O)=='o004' then
set HOO=FR0[ZA0]
else
set HOO=FR0[ZB0]
endif
call MUDisableItemTrigger()
set H2O=ES1(SFI,HOO)
if H2O==null then
set JK=GetOwningPlayer(SFI)
set VK=CreateItem(HOO,0,0)
call UnitAddItem(SFI,VK)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
else
call SetItemCharges(H2O,GetItemCharges(H2O)+1)
endif
call MUEnableItemTrigger()
endfunction
function H3O takes nothing returns nothing
local unit H0O=GetSummonedUnit()
local unit SFI=GetSummoningUnit()
if GetUnitTypeId(GetSummonedUnit())=='o004' then
endif
if GetUnitTypeId(GetSummonedUnit())=='o004' or GetUnitTypeId(GetSummonedUnit())=='oeye' then
if IsUnitInRegion(R60,H0O)then
call H1O(SFI,H0O)
call RemoveUnit(H0O)
elseif RYI(SFI)then
call H1O(SFI,H0O)
call PZI(GetOwningPlayer(H0O),"Couriers cannot place wards")
call RemoveUnit(H0O)
else
call GUO(GetSummonedUnit(),GetSummoningUnit())
if GetUnitTypeId(GetSummonedUnit())=='oeye' then
call I41(GetOwningPlayer(GetSummonedUnit()),12,GetUnitX(GetSummonedUnit()),GetUnitY(GetSummonedUnit()),150)
endif
endif
elseif GetUnitTypeId(H0O)=='osp4' or GetUnitTypeId(H0O)=='o008' or GetUnitTypeId(H0O)=='o009' or GetUnitTypeId(H0O)=='o01C' or GetUnitTypeId(H0O)=='o01D' or GetUnitTypeId(H0O)=='o01E' then
call SelectUnitAddForPlayer(H0O,GetOwningPlayer(H0O))
elseif GetUnitTypeId(H0O)=='o000' or GetUnitTypeId(H0O)=='o001' or GetUnitTypeId(H0O)=='o00A' or GetUnitTypeId(H0O)=='o00X' then
call SelectUnitAddForPlayer(H0O,GetOwningPlayer(H0O))
endif
endfunction
function H5O takes nothing returns nothing
local unit u=GetEnumUnit()
local integer i=0
local player p=GetOwningPlayer(GetTriggerUnit())
local item BA1
local integer id=GetPlayerId(p)
loop
exitwhen i>5
set BA1=UnitItemInSlot(u,i)
if BA1!=null and GetItemPlayer(BA1)==p then
call UnitRemoveItem(u,BA1)
call SetItemPosition(BA1,D40[id],D50[id])
endif
set i=i+1
endloop
set u=null
set BA1=null
endfunction
function H6O takes nothing returns nothing
local item BA1=GetEnumItem()
local unit u=M80
local player p=GetOwningPlayer(u)
local integer id=GetPlayerId(p)
if GetWidgetLife(BA1)>0 and GetItemPlayer(BA1)==p and IsItemVisible(BA1)==true then
call SetItemPosition(BA1,D40[id],D50[id])
call UnitAddItem(D30[id],BA1)
endif
set BA1=null
set u=null
set p=null
endfunction
function H7O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(53)))
set M80=u
if IsPlayerTeam1(GetOwningPlayer(M80))then
call EnumItemsInRect(G5,Condition(function N1I),function H6O)
else
call EnumItemsInRect(H5,Condition(function N1I),function H6O)
endif
if GetTriggerEvalCount(t)==2 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set u=null
return false
endfunction
function H8O takes nothing returns boolean
return RYI(GetFilterUnit())
endfunction
function H9O takes nothing returns nothing
local unit u=GetTriggerUnit()
local integer i=0
local group g=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1300,Condition(function H8O))
call ForGroup(g,function H5O)
call NSI(g)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function H7O))
call SaveUnitHandle(LY,(handle_id),(53),(u))
set u=null
set g=null
endfunction
function HAO takes nothing returns nothing
if GetSpellAbilityId()=='A14D' then
call H9O()
endif
endfunction
function HBO takes nothing returns nothing
local unit u=GetTriggerUnit()
local integer i=0
local item BA1
local integer id=GetPlayerId(GetOwningPlayer(u))
local region r=CreateRegion()
if IsPlayerTeam1(GetOwningPlayer(u))then
call RegionAddRect(r,G5)
else
call RegionAddRect(r,H5)
endif
loop
exitwhen i>5
set BA1=UnitItemInSlot(u,i)
if E91(GetItemId(BA1))==false and GetItemId(BA1)!=VL0 and EG1(BA1)==false then
call UnitRemoveItemFromSlot(u,i)
if(GetUnitTypeId(u)=='ncop' or IsUnitInRegion(r,u))and IsPlayerAlly(GetItemPlayer(BA1),GetOwningPlayer(u))==true then
set id=GetPlayerId(GetItemPlayer(BA1))
call SetItemPosition(BA1,D40[id],D50[id])
endif
endif
set i=i+1
endloop
call RemoveRegion(r)
set u=null
set r=null
endfunction
function HCO takes nothing returns nothing
if GetSpellAbilityId()=='A138' or GetSpellAbilityId()=='A14C' then
call HBO()
endif
endfunction
function HDO takes unit hero returns boolean
local integer handle_id=GetHandleId(hero)
local integer i=0
local real GW1=(TimerGetElapsed(M))
local real HEO=13
loop
exitwhen i>0
if(LoadReal(LY,(handle_id),(730+i)))<GW1-HEO then
return false
endif
set i=i+1
endloop
return true
endfunction
function HFO takes unit hero returns nothing
local integer handle_id=GetHandleId(hero)
local integer HGO=(LoadInteger(LY,(handle_id),(729)))
call SaveReal(LY,(handle_id),(730+HGO),(((TimerGetElapsed(M)))*1.0))
set HGO=HGO+1
if HGO==1 then
set HGO=0
endif
call SaveInteger(LY,(handle_id),(729),(HGO))
endfunction
function HHO takes unit SFI returns nothing
local integer i=0
local item HZO
local integer E81
local boolean HVO=false
if HDO(SFI)then
set HVO=true
endif
loop
exitwhen i>5
set HZO=UnitItemInSlot(SFI,i)
set E81=F01(HZO)
if E81==Z00 and HVO==true then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HZO)
call RemoveItem(HZO)
set VK=FD1(SFI,FR0[ZI0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
if E81==ZI0 and HVO==false then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HZO)
call RemoveItem(HZO)
set VK=FD1(SFI,FR0[Z00],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
set i=i+1
endloop
set SFI=null
set HZO=null
endfunction
function HWO takes unit SFI returns nothing
local integer i=0
local item HXO
local integer E81
local boolean HYO=false
local real Q4I=4
if IsUnitType(SFI,UNIT_TYPE_MELEE_ATTACKER)==false then
set Q4I=6
endif
if(LoadReal(LY,(GetHandleId(SFI)),(785)))+Q4I>(TimerGetElapsed(M))then
set HYO=true
endif
loop
exitwhen i>5
set HXO=UnitItemInSlot(SFI,i)
set E81=F01(HXO)
if E81==WA0 and HYO==true then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HXO)
call RemoveItem(HXO)
set VK=FD1(SFI,FR0[WB0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
if E81==WB0 and HYO==false then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HXO)
call RemoveItem(HXO)
set VK=FD1(SFI,FR0[WA0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
set i=i+1
endloop
set SFI=null
set HXO=null
endfunction
function HJO takes nothing returns nothing
if GetEventDamage()>2 and(T2I(GetOwningPlayer(GetEventDamageSource()))or GetUnitTypeId(GetEventDamageSource())=='n00L')and GetUnitAbilityLevel(GetTriggerUnit(),'A0RN')==0 then
if NJ0[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]==false then
call SaveReal(LY,(GetHandleId(GetTriggerUnit())),(785),(((TimerGetElapsed(M)))*1.0))
if GetEventDamage()>20 then
endif
endif
endif
endfunction
function HKO takes unit SFI returns nothing
local integer i=0
local item HLO
local integer E81
local boolean HMO=false
if(LoadReal(LY,(GetHandleId(SFI)),(785)))+3>(TimerGetElapsed(M))then
set HMO=true
endif
loop
exitwhen i>5
set HLO=UnitItemInSlot(SFI,i)
set E81=F01(HLO)
if E81==GJ0 and HMO==true then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HLO)
call RemoveItem(HLO)
set VK=FD1(SFI,FR0[GK0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
if E81==GK0 and HMO==false then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HLO)
call RemoveItem(HLO)
set VK=FD1(SFI,FR0[GJ0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
set i=i+1
endloop
set SFI=null
set HLO=null
endfunction
function HNO takes nothing returns nothing
local unit SFI=GetEnumUnit()
local integer id=GetPlayerId(GetOwningPlayer(SFI))
if LA0[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false then
call HKO(SFI)
endif
if M90[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false then
call HWO(SFI)
endif
if MA0[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false then
call HHO(SFI)
endif
set SFI=null
endfunction
function HSO takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and GetUnitTypeId(GetFilterUnit())!='H00J' and GetUnitTypeId(GetFilterUnit())!='H0B8'
endfunction
function HTO takes nothing returns boolean
local integer i=1
local unit SFI
local integer id
local group g
if LL0>0 or LS0>0 or LQ0>0 then
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function HSO))
loop
exitwhen i>5
set id=GetPlayerId(BO[i])
set SFI=K1[id]
call GroupAddUnit(g,SFI)
set id=GetPlayerId(CO[i])
set SFI=K1[id]
call GroupAddUnit(g,SFI)
set i=i+1
endloop
call ForGroup(g,function HNO)
call NSI(g)
set g=null
endif
set SFI=null
return false
endfunction
function HPO takes nothing returns nothing
local unit SFI=GetFilterUnit()
local integer i=0
local item BA1
local integer E81
loop
exitwhen i>5
set BA1=UnitItemInSlot(SFI,i)
set E81=GetItemId(BA1)
if(E81==HE0 or E81==HF0 or E81==HG0)and GetItemUserData(BA1)>0 then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",SFI,"overhead"))
call PEI(GetOwningPlayer(SFI),"Abilities\\Spells\\Human\\Heal\\HealTarget.wav")
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(SFI,FR0[HH0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call UnitRemoveAbility(SFI,'B0GI')
endif
set i=i+1
endloop
set SFI=null
set BA1=null
endfunction
function HQO takes nothing returns boolean
if UnitInventorySize(GetFilterUnit())>0 and IsPlayerTeam1(GetOwningPlayer(GetFilterUnit()))and IsUnitIllusion(GetFilterUnit())==false and IsUnitDead(GetFilterUnit())==false then
call HPO()
endif
return false
endfunction
function HUO takes nothing returns boolean
if UnitInventorySize(GetFilterUnit())>0 and IsPlayerTeam2(GetOwningPlayer(GetFilterUnit()))and IsUnitIllusion(GetFilterUnit())==false and IsUnitDead(GetFilterUnit())==false then
call HPO()
endif
return false
endfunction
function Z0O takes nothing returns boolean
local group g=NTI()
call GroupEnumUnitsInRange(g,QS,US,750,Condition(function HQO))
call NSI(g)
set g=NTI()
call GroupEnumUnitsInRange(g,O50,O60,750,Condition(function HUO))
call NSI(g)
set g=null
return false
endfunction
function Z1O takes unit ZOO returns boolean
local unit Z2O=K1[GetPlayerId(GetOwningPlayer(ZOO))]
if((GetUnitX(Z2O)-GetUnitX(ZOO))*(GetUnitX(Z2O)-GetUnitX(ZOO))+(GetUnitY(Z2O)-GetUnitY(ZOO))*(GetUnitY(Z2O)-GetUnitY(ZOO))>=855625)then
return true
endif
return false
endfunction
function Z3O takes nothing returns nothing
local unit Z4O=GetAttacker()
local integer GP1=UnitInventorySize(Z4O)
local integer x=0
local item i
loop
exitwhen x>GP1
set i=UnitItemInSlot(Z4O,x)
if F01(i)==HC0 then
if GetRandomReal(0,1)<=0.2 and BU1(Z4O)==false then
if B61(Z4O)then
if Z1O(Z4O)==false then
if GetUnitAbilityLevel(GetTriggerUnit(),'A04R')==0 then
call Damage(Z4O,GetTriggerUnit(),2,40)
endif
endif
else
if GetUnitAbilityLevel(GetTriggerUnit(),'A04R')==0 then
call Damage(Z4O,GetTriggerUnit(),2,40)
endif
endif
endif
endif
set x=x+1
endloop
set x=0
set Z4O=GetAttacker()
set GP1=UnitInventorySize(Z4O)
loop
exitwhen x>GP1
set i=UnitItemInSlot(Z4O,x)
if F01(i)==Z00 or F01(i)==ZI0 then
call HFO(Z4O)
endif
set x=x+1
endloop
set x=0
set Z4O=GetTriggerUnit()
set GP1=UnitInventorySize(Z4O)
loop
exitwhen x>GP1
set i=UnitItemInSlot(Z4O,x)
if F01(i)==Z00 or F01(i)==ZI0 then
call HFO(Z4O)
endif
set x=x+1
endloop
set i=null
set Z4O=null
endfunction
function Z6O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(692)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or Z7O<(TimerGetElapsed(M))then
call UnitRemoveAbility(hero,'A265')
call UnitRemoveAbility(hero,'B08N')
call UnitRemoveAbility(hero,'A26C')
call SaveReal(LY,(GetHandleId(hero)),(692),((0)*1.0))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function Z8O takes unit hero returns nothing
local trigger t
local integer handle_id
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(692)))
call SaveReal(LY,(GetHandleId(hero)),(692),(((TimerGetElapsed(M))+MC0)*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,MC0+0.01,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function Z6O))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call AddSkill(hero,'A265')
call AddSkill(hero,'A26C')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A265',false)
set t=null
endfunction
function Z9O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetEventDamageSource()==hero and GetEventDamage()>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if BJ1(target)==false then
call Z8O(target)
endif
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function ZAO takes nothing returns nothing
local unit hero=GetAttacker()
local unit target=GetTriggerUnit()
local trigger t
local integer handle_id
if((LoadInteger(LY,(GetHandleId((hero))),((4309))))==1)==false then
call SCI(hero,4309,0.2)
if GetRandomReal(0,100)<MB0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function Z9O))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
endif
set hero=null
set target=null
endfunction
function DiffusalBlade_End takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(833)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or Z7O<(TimerGetElapsed(M))then
call UnitRemoveAbility(hero,'A265')
call UnitRemoveAbility(hero,'B08N')
call UnitRemoveAbility(hero,'A26C')
call SaveReal(LY,(GetHandleId(hero)),(833),((0)*1.0))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function ZBO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real ZCO
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetEventDamageSource()==hero and GetEventDamage()>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetUnitAbilityLevel(hero,'A022')==0 then
set ZCO=RMinBJ(25,GetUnitState(target,UNIT_STATE_MANA))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)-ZCO)
call Damage(hero,target,2,ZCO)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Feedback\\ArcaneTowerAttack.mdl",target,"origin"))
endif
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function ZDO takes nothing returns nothing
local unit hero=GetAttacker()
local unit target=GetTriggerUnit()
local trigger t
local integer handle_id
if((LoadInteger(LY,(GetHandleId((hero))),((4340))))==1)==false and GetUnitState(target,UNIT_STATE_MANA)>0 then
call SCI(hero,4340,0.2)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function ZBO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set hero=null
set target=null
endfunction
function ZEO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(693)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or Z7O<(TimerGetElapsed(M))then
call UnitRemoveAbility(hero,'A266')
call UnitRemoveAbility(hero,'B02I')
call UnitRemoveAbility(hero,'A26C')
call SaveReal(LY,(GetHandleId(hero)),(693),((0)*1.0))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function ZFO takes unit hero returns nothing
local trigger t
local integer handle_id
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(693)))
call SaveReal(LY,(GetHandleId(hero)),(693),(((TimerGetElapsed(M))+ME0)*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,ME0+0.01,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function ZEO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call AddSkill(hero,'A266')
call AddSkill(hero,'A26C')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A266',false)
set t=null
endfunction
function ZGO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetEventDamageSource()==hero and GetEventDamage()>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if BJ1(target)==false then
call ZFO(target)
endif
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function ZHO takes nothing returns nothing
local unit hero=GetAttacker()
local unit target=GetTriggerUnit()
local trigger t
local integer handle_id
if((LoadInteger(LY,(GetHandleId((hero))),((4309))))==1)==false then
call SCI(hero,4309,0.2)
if GetRandomReal(0,100)<MD0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function ZGO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
endif
set hero=null
set target=null
endfunction
function ZZO takes nothing returns nothing
local unit Z4O=GetAttacker()
local integer ZVO=25
local integer id=GetPlayerId(GetOwningPlayer(GetAttacker()))
local integer handle_id=GetHandleId(Z4O)
local real SOI=(TimerGetElapsed(M))
local real ZWO=(LoadReal(LY,(handle_id),(101)))
local boolean ZXO=(LoadBoolean(LY,(handle_id),(99)))
local boolean ZYO=(LoadBoolean(LY,(handle_id),(100)))
local boolean ZJO=SOI<ZWO
local boolean ZKO=false
if IsUnitType(Z4O,UNIT_TYPE_MELEE_ATTACKER)==false then
set ZVO=10
endif
if GetRandomInt(0,100)<ZVO then
set ZKO=true
endif
if GetUnitAbilityLevel(Z4O,'A0JJ')>0 or GetUnitAbilityLevel(Z4O,'A081')>0 or GetUnitAbilityLevel(Z4O,'A0G5')>0 or GetUnitAbilityLevel(Z4O,'A09E')>0 then
call UnitRemoveAbility(Z4O,'A174')
set Z4O=null
return
endif
if ZXO and ZJO==false and ZYO==false then
call SaveReal(LY,(handle_id),(101),((SOI+2)*1.0))
if ZKO==false then
call SaveBoolean(LY,(handle_id),(100),(true))
endif
elseif ZJO or ZYO then
call UnitRemoveAbility(Z4O,'A174')
call SaveBoolean(LY,(handle_id),(99),(false))
call SaveBoolean(LY,(handle_id),(100),(false))
endif
if ZKO then
call AddSkill(Z4O,'A174')
call UnitMakeAbilityPermanent(Z4O,true,'A175')
call SaveBoolean(LY,(handle_id),(99),(true))
endif
set Z4O=null
endfunction
function ZMO takes unit u returns unit
if IsUnitType(u,UNIT_TYPE_HERO)or GetUnitAbilityLevel(u,'A04R')==0 then
return u
else
return K1[GetPlayerId(GetOwningPlayer(u))]
endif
endfunction
function ZNO takes nothing returns boolean
if IsUnitType(GetKillingUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitAlly(GetDyingUnit(),GetOwningPlayer(GetKillingUnit()))==false then
if GetUnitTypeId(GetTriggerUnit())=='n00J' then
call Damage(GetDyingUnit(),ZMO(GetKillingUnit()),1,550)
elseif GetUnitTypeId(GetTriggerUnit())=='n00A' then
call Damage(GetDyingUnit(),ZMO(GetKillingUnit()),1,675)
elseif GetUnitTypeId(GetTriggerUnit())=='n006' then
call Damage(GetDyingUnit(),ZMO(GetKillingUnit()),1,800)
endif
endif
return false
endfunction
function ZTO takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local integer level=1
if ES1(SFI,FR0[ZI0])!=null then
set level=2
endif
if EM1(SFI,FR0[G40],GetManipulatedItem())!=null then
set level=3
endif
if EM1(SFI,FR0[XI0],GetManipulatedItem())!=null then
set level=4
endif
if EM1(SFI,FR0[ZL0],GetManipulatedItem())!=null or EM1(SFI,FR0[ZM0],GetManipulatedItem())!=null or EM1(SFI,FR0[ZN0],GetManipulatedItem())!=null then
set level=5
endif
if EM1(SFI,FR0[X90],GetManipulatedItem())!=null then
set level=6
endif
if EM1(SFI,FR0[Z00],GetManipulatedItem())!=null then
set level=7
endif
if EM1(SFI,FR0[ZK0],GetManipulatedItem())!=null then
set level=8
endif
if EM1(SFI,FR0[VB0],GetManipulatedItem())!=null then
call UnitAddAbility(SFI,'A0V0')
call SetUnitAbilityLevel(SFI,'A0V0',level)
call UnitMakeAbilityPermanent(SFI,true,'A0V0')
else
call UnitRemoveAbility(SFI,'A0V0')
endif
set SFI=null
return false
endfunction
function ZRO takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local integer level=1
if ES1(SFI,FR0[ZI0])!=null then
set level=2
endif
if ES1(SFI,FR0[G40])!=null then
set level=3
endif
if ES1(SFI,FR0[XI0])!=null then
set level=4
endif
if ES1(SFI,FR0[ZL0])!=null or ES1(SFI,FR0[ZM0])!=null or ES1(SFI,FR0[ZN0])!=null then
set level=5
endif
if ES1(SFI,FR0[X90])!=null then
set level=6
endif
if EM1(SFI,FR0[Z00],GetManipulatedItem())!=null then
set level=7
endif
if ES1(SFI,FR0[ZK0])!=null then
set level=8
endif
if ES1(SFI,FR0[VB0])!=null then
call UnitAddAbility(SFI,'A0V0')
call SetUnitAbilityLevel(SFI,'A0V0',level)
call UnitMakeAbilityPermanent(SFI,true,'A0V0')
endif
set SFI=null
return false
endfunction
function ZQO takes nothing returns nothing
local unit SFI=GetTriggerUnit()
if GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM then
if F01(GetManipulatedItem())==WT0 or F01(GetManipulatedItem())==WP0 then
call UnitRemoveAbility(SFI,'A2QD')
endif
if F01(GetManipulatedItem())==WC0 then
call UnitRemoveAbility(SFI,'A1BW')
endif
if F01(GetManipulatedItem())==WM0 then
call UnitRemoveAbility(SFI,'A0G3')
call UnitRemoveAbility(SFI,'A09M')
call UnitRemoveAbility(SFI,'A0UX')
call UnitRemoveAbility(SFI,'A2KL')
endif
if F01(GetManipulatedItem())==WS0 or F01(GetManipulatedItem())==WR0 then
call UnitRemoveAbility(SFI,'A2QD')
call UnitRemoveAbility(SFI,'A0TC')
call UnitRemoveAbility(SFI,'A0UK')
endif
if F01(GetManipulatedItem())==Z40 then
call UnitRemoveAbility(SFI,'A2YE')
call UnitRemoveAbility(SFI,'A2YF')
call UnitRemoveAbility(SFI,'A319')
endif
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
if F01(GetManipulatedItem())==WT0 or F01(GetManipulatedItem())==WP0 then
call UnitAddAbility(SFI,'A2QD')
call UnitMakeAbilityPermanent(SFI,true,'A2QD')
endif
if F01(GetManipulatedItem())==WC0 then
call UnitAddAbility(SFI,'A1BW')
call UnitMakeAbilityPermanent(SFI,true,'A1BW')
endif
if F01(GetManipulatedItem())==Z40 then
call AddSkill(SFI,'A319')
if IsUnitType(SFI,UNIT_TYPE_MELEE_ATTACKER)==true then
call AddSkill(SFI,'A2YE')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2YE',false)
else
call AddSkill(SFI,'A2YF')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2YF',false)
endif
endif
if F01(GetManipulatedItem())==WM0 then
call AddSkill(SFI,'A0G3')
call AddSkill(SFI,'A09M')
call AddSkill(SFI,'A0UX')
call AddSkill(SFI,'A2KL')
endif
if F01(GetManipulatedItem())==WS0 or F01(GetManipulatedItem())==WR0 then
call UnitAddAbility(SFI,'A2QD')
call UnitMakeAbilityPermanent(SFI,true,'A2QD')
call UnitAddAbility(SFI,'A0TC')
call UnitMakeAbilityPermanent(SFI,true,'A0TC')
call UnitAddAbility(SFI,'A0UK')
call UnitMakeAbilityPermanent(SFI,true,'A0UK')
endif
endif
set SFI=null
endfunction
function ZUO takes nothing returns boolean
if GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and(F01(GetManipulatedItem())==WS0 or F01(GetManipulatedItem())==WT0 or F01(GetManipulatedItem())==WR0 or F01(GetManipulatedItem())==WP0 or F01(GetManipulatedItem())==WC0 or F01(GetManipulatedItem())==WM0 or F01(GetManipulatedItem())==Z40)then
call ZQO()
endif
return false
endfunction
function VIO takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,MG0[0])
call UnitRemoveAbility(u,MG0[1])
call UnitRemoveAbility(u,MG0[2])
call UnitRemoveAbility(u,MG0[3])
call UnitRemoveAbility(u,MG0[4])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=4
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call AddSkill(u,MG0[i])
else
call UnitRemoveAbility(u,MG0[i])
endif
set i=i+1
endloop
endfunction
function V1O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local item BA1=(LoadItemHandle(LY,(handle_id),(96)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real VOO=GetUnitState(SFI,UNIT_STATE_MAX_LIFE)-GetUnitState(SFI,UNIT_STATE_LIFE)
if GetTriggerEventId()==EVENT_UNIT_DROP_ITEM and GetManipulatedItem()==BA1 then
call SaveInteger(LY,(GetHandleId((SFI))),((4298)),(2))
call VIO(SFI,0)
call SetUnitState(SFI,UNIT_STATE_LIFE,QDI(GetUnitState(SFI,UNIT_STATE_MAX_LIFE)-VOO,1))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_DROP_ITEM and NPI<25 then
call SaveInteger(LY,(GetHandleId((SFI))),((4298)),(1))
set NPI=NPI+1
call VIO(SFI,NPI)
call SetUnitState(SFI,UNIT_STATE_LIFE,QDI(GetUnitState(SFI,UNIT_STATE_MAX_LIFE)-VOO,1))
call SaveInteger(LY,(handle_id),(34),(NPI))
else
call SaveInteger(LY,(GetHandleId((SFI))),((4298)),(2))
endif
set t=null
set SFI=null
set BA1=null
return false
endfunction
function V2O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local item BA1=(LoadItemHandle(LY,(handle_id),(96)))
if GetTriggerEventId()==EVENT_UNIT_DROP_ITEM and GetManipulatedItem()==BA1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_DROP_ITEM then
if((LoadInteger(LY,(GetHandleId((SFI))),((4310))))==1)==false then
call SetUnitState(SFI,UNIT_STATE_LIFE,QDI(GetUnitState(SFI,UNIT_STATE_LIFE)-MF0*0.1,1))
endif
endif
set t=null
set SFI=null
set BA1=null
return false
endfunction
function V3O takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function V2O))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveItemHandle(LY,(handle_id),(96),(GetManipulatedItem()))
call TriggerEvaluate(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.7/25,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function V1O))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveItemHandle(LY,(handle_id),(96),(GetManipulatedItem()))
call SaveInteger(LY,(handle_id),(34),(0))
set t=null
set SFI=null
endfunction
function V4O takes nothing returns boolean
if GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and(F01(GetManipulatedItem())==WS0 or F01(GetManipulatedItem())==WR0)then
call V3O()
endif
return false
endfunction
function V6O takes nothing returns nothing
local unit hero=MH0
local unit target=GetEnumUnit()
if((LoadInteger(LY,(GetHandleId((target))),((4341))))==1)==false then
call SCI(target,4341,0.99)
set MZ0=true
call Damage(hero,target,1,50)
set MZ0=false
call U5I("Abilities\\Spells\\Items\\HealingSalve\\HealingSalveTarget.mdl",target,"origin",0.9)
endif
set hero=null
set target=null
endfunction
function V7O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local item BA1=(LoadItemHandle(LY,(handle_id),(96)))
local group g
if SFI==null or(GetTriggerEventId()==EVENT_UNIT_DROP_ITEM and GetManipulatedItem()==BA1)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_DROP_ITEM then
if IsUnitDead(SFI)==false then
set g=NTI()
set GK=SFI
set MH0=SFI
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),725,Condition(function CA1))
call ForGroup(g,function V6O)
call NSI(g)
set g=null
endif
endif
set t=null
set SFI=null
set BA1=null
return false
endfunction
function V8O takes unit SFI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function V7O))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveItemHandle(LY,(handle_id),(96),(GetManipulatedItem()))
set t=null
endfunction
function V9O takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM and GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and F01(GetManipulatedItem())==W80 then
call V8O(GetTriggerUnit())
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SUMMON and UnitInventorySize(GetSummonedUnit())>0 and ES1(GetSummonedUnit(),FR0[W80])!=null then
call V8O(GetSummonedUnit())
endif
return false
endfunction
// 检查是否能获取物品(?)
function VBO takes unit u returns boolean
local item VCO=CreateItem('I0KK',GetUnitX(u),GetUnitY(u))
local boolean FB1=UnitAddItem(u,VCO)
if FB1==false then
call RemoveItem(VCO)
endif
return FB1
endfunction
// 把物品放到单位物品栏中的指定格子(单位, 物品, 格子)
function VDO takes unit SFI,item BA1,integer FF1 returns item
local real x=FA1(SFI)
local real y=FC1(SFI)
local integer i=0
local boolean array FG1
local item FH1
loop
exitwhen i>(UnitInventorySize(SFI)-1)
if UnitItemInSlot(SFI,i)==null and i!=FF1 then
set FH1=CreateItem('I02M',x,y)
call UnitAddItem(SFI,FH1)
set FG1[i]=true
else
set FG1[i]=false
endif
if i==FF1 then
call UnitAddItem(SFI,BA1)
endif
set i=i+1
endloop
set i=0
loop
exitwhen i>5
if FG1[i]==true then
call RemoveItem(UnitItemInSlot(SFI,i))
endif
set i=i+1
endloop
set VK=BA1
set FH1=null
return VK
endfunction
// 让林肯进入CD/获得林肯buff(单位, 物品ID)(W20是进入CD, WO0是获得buff, 写一起真坑)
function VEO takes unit SFI,integer VFO returns nothing
	local integer i=0
	local item VGO
	local integer E81
	local unit dummy
	local item VHO
	// 判断单位存活
	if IsUnitDead(SFI)then
		return
	endif
	call MUDisableItemTrigger()
	// 林肯计数 > 0 且 物品是林肯buff
	if LD0[GetPlayerId(GetOwningPlayer(SFI))]>0 and VFO==WO0 then
		// 让英雄获林肯buff
		call F71(SFI,'I0HM')
	endif
	loop
		exitwhen i>5
		set VGO=UnitItemInSlot(SFI,i)
		// 获得物品ID
		set E81=F01(VGO)
		// 如果物品是林肯
		if E81==W20 or E81==WO0 then
			set JK=GetItemPlayer(VGO)
			call RemoveItem(VGO)
			// 创建马甲用一下林肯
			set dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
			call UnitAddAbility(dummy,'AInv')
			set VHO=UnitAddItemById(dummy,FR0[VFO])
			call UnitResetCooldown(dummy)
			call UnitUseItem(dummy,VHO)
			// 把物品放到物品栏里
			set VK=VDO(SFI,VHO,i)
			call SetItemPlayer(VHO,JK,false)
			call SetItemUserData(VHO,1)
			call UnitRemoveAbility(dummy,'AInv')
			set dummy=null
			set VHO=null
		endif
		set VGO=null
		set i=i+1
	endloop
	call MUEnableItemTrigger()
endfunction
// 尝试恢复林肯buff
function VZO takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
	local integer i=0
	local item VGO
	local integer E81
	local unit dummy
	local item VHO
	if GetTriggerEventId()==EVENT_UNIT_DEATH then
		// 设置英雄的102为假(表示林肯不在冷却中)
		call SaveBoolean(LY,(GetHandleId(SFI)),(102),(false))
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
	elseif VBO(SFI)==false then
		// 如果不能获得物品,再等待5.5秒
		call TriggerRegisterTimerEvent(t,5.5,false)
	else
		// 设置英雄的102为假(表示林肯不在冷却中)
		call SaveBoolean(LY,(GetHandleId(SFI)),(102),(false))
		// 获得林肯buff
		call VEO(SFI,WO0)
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
	endif
	set t=null
	set SFI=null
	return false
endfunction
// 触发林肯
function VVO takes unit SFI returns nothing
	local trigger t=CreateTrigger()
	local integer handle_id=GetHandleId(t)
	local integer i=0
	local item VGO
	local integer E81
	local unit dummy
	local item VHO
	// 英雄的102为真(表示林肯正在冷却中)
	call SaveBoolean(LY,(GetHandleId(SFI)),(102),(true))
	// 英雄死亡或17秒后执行 VZO (尝试恢复林肯buff)
	call TriggerRegisterTimerEvent(t,MV0,false)
	call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
	call TriggerAddCondition(t,Condition(function VZO))
	call SaveUnitHandle(LY,(handle_id),(14),(SFI))
	call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",SFI,"origin"))
	// 让林肯物品进入冷却
	call VEO(SFI,W20)
	set t=null
endfunction
// 每0.5秒遍历所有英雄检查林肯buff
function VWO takes nothing returns boolean
	local integer i=1
	local unit SFI
	local integer id
	// 可能是判断游戏结束
	if Q2 then
		return false
	endif
	// 可能是全局的林肯计数
	if LJ0>0 then
		loop
			exitwhen i>5
			set id=GetPlayerId(BO[i])
			set SFI=K1[id]
			// 林肯计数 > 0 and             英雄存在               and                英雄活着                 and       英雄的102为假(林肯不在冷却中)                   and  英雄不可抵挡技能   and       todo:英雄的129为假
			if LD0[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false and(LoadBoolean(LY,(GetHandleId(SFI)),(102)))==false and CanResistSkill(SFI)==false and(LoadBoolean(LY,(GetHandleId(SFI)),(129)))==false then
				// 林肯被触发
				call VVO(SFI)
			endif
			set id=GetPlayerId(CO[i])
			set SFI=K1[id]
			if LD0[id]>0 and SFI!=null and GetUnitTypeId(SFI)>1 and IsUnitType(SFI,UNIT_TYPE_DEAD)==false and(LoadBoolean(LY,(GetHandleId(SFI)),(102)))==false and CanResistSkill(SFI)==false and(LoadBoolean(LY,(GetHandleId(SFI)),(129)))==false then
				call VVO(SFI)
			endif
			set i=i+1
		endloop
	endif
	set SFI=null
	return false
endfunction
// 队友的林肯buff
function VXO takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
	local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
	if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetUnitAbilityLevel(target,'B0BI')==0 then
		// 如果队友死了或队友身上的林肯buff没了
		// 开始林肯恢复计时
		call VVO(hero)
		if GetTriggerEventId()!=EVENT_WIDGET_DEATH then
			call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl",target,"origin"))
		endif
		call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
	elseif GetTriggerEvalCount(t)>=R2I(MV0/0.1)then
		// 队友的林肯时间结束
		// 设置英雄的林肯不在冷却
		call SaveBoolean(LY,(GetHandleId(hero)),(102),(false))
		// 获得林肯buff
		call VEO(hero,WO0)
		// 删除林肯buff
		call UnitRemoveAbility(target,'B0BI')
		call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
	endif
	set t=null
	set hero=null
	set target=null
	return false
endfunction
// 对队友使用林肯
function VYO takes nothing returns nothing
	local trigger t=CreateTrigger()
	local integer handle_id=GetHandleId(t)
	local unit hero=GetTriggerUnit()
	local unit target=GetSpellTargetUnit()
	// 让队友获得林肯buff
	call F71(target,'I0HM')
	// 每0.1秒或队友死亡
	call TriggerRegisterTimerEvent(t,0.1,true)
	call TriggerRegisterDeathEvent(t,target)
	call TriggerAddCondition(t,Condition(function VXO))
	call SaveUnitHandle(LY,(handle_id),(2),(hero))
	call SaveUnitHandle(LY,(handle_id),(17),(target))
	call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\Linkens_Main.mdx",target,"chest")))
	// 英雄的林肯处于冷却状态
	call SaveBoolean(LY,(GetHandleId(hero)),(102),(true))
	// 删掉英雄身上的林肯buff
	call UnitRemoveAbility(hero,'B0BI')
	// 让林肯进入冷却
	call VEO(hero,W20)
	set t=null
	set hero=null
	set target=null
endfunction
// 对队友使用林肯判断
function VJO takes nothing returns boolean
if GetSpellAbilityId()=='A2VE' and IsUnitIllusion(GetSpellTargetUnit())==false then
	call VYO()
endif
return false
endfunction
function VLO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if hero!=target then
call Damage(hero,target,1,50)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function VMO takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
if target==null then
set target=hero
endif
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A13V')
call IssueTargetOrder(dummy,"cyclone",target)
call TriggerRegisterTimerEvent(t,2.51,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function VLO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function VNO takes nothing returns boolean
if GetSpellAbilityId()=='A1T7' then
if GetTriggerUnit()==GetSpellTargetUnit()or RKI(GetSpellTargetUnit())==false then
if CanResistSkill(GetSpellTargetUnit())==false or GetTriggerUnit()==GetSpellTargetUnit()then
call VMO()
endif
endif
endif
return false
endfunction
function VTO takes integer FE1 returns integer
if FE1=='I006' then
return HW0
elseif FE1=='I008' then
return HX0
elseif FE1=='I00J' then
return HZ0
elseif FE1=='I00K' then
return HV0
elseif FE1=='I007' then
return HY0
elseif FE1=='I0RC' then
return HJ0
endif
return-1
endfunction
function VRO takes nothing returns boolean
if GetSpellAbilityId()=='A0H6' then
call SaveUnitHandle(LY,(GetHandleId(GetTriggerUnit())),(103),(null))
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(104),(0))
if(ES1(GetTriggerUnit(),FR0[HE0])!=null or ES1(GetTriggerUnit(),FQ0[HE0])!=null)and(GetUnitTypeId(GetSpellTargetUnit())=='nfoh' or GetUnitTypeId(GetSpellTargetUnit())=='ndfl')then
call SaveUnitHandle(LY,(GetHandleId(GetTriggerUnit())),(103),(GetSpellTargetUnit()))
elseif C8O(GetItemTypeId(GetSpellTargetItem()))then
call FMO(GetTriggerUnit(),GetItemTypeId(GetSpellTargetItem()),true)
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(104),(GetItemTypeId(GetSpellTargetItem())))
call EL1(GetSpellTargetItem())
endif
endif
return false
endfunction
function VPO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(26)))
local integer GBO=(LoadInteger(LY,(handle_id),(98)))
local item BA1=UnitItemInSlot(u,GBO)
local integer VQO=(LoadInteger(LY,(handle_id),(105)))
local item VHO
local integer FF1
if BA1!=null and E91(GetItemId(BA1))and GetHandleId(BA1)==VQO and IsUnitDead(u)==false and IsUnitDead(u)==false then
set VHO=CreateItem((LoadInteger(LY,(GetHandleId(BA1)),(GetHandleId(u)))),GetUnitX(u),GetUnitY(u))
call FlushChildHashtable(LY,(GetHandleId(BA1)))
set FF1=A11(u,BA1)
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(u,FR0[HH0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitAddItem(u,VHO)
call UnitRemoveAbility(u,'B0GI')
endif
set t=null
set u=null
set BA1=null
set VHO=null
return false
endfunction
function VUO takes unit u,item VHO returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer GBO=A11(u,VHO)
call SaveInteger(LY,(handle_id),(98),(GBO))
call SaveInteger(LY,(handle_id),(105),(GetHandleId(VHO)))
call SaveUnitHandle(LY,(handle_id),(26),(u))
call TriggerRegisterTimerEvent(t,120,true)
call TriggerAddCondition(t,Condition(function VPO))
set t=null
endfunction
function W0O takes nothing returns nothing
local unit u=GetTriggerUnit()
local item BA1=GetManipulatedItem()
local integer E81=GetItemId(BA1)
local unit WIO
local integer W1O
local boolean TargetFrog
local integer FF1
local item VHO
local integer WOO
if E81==HE0 then
set FF1=A11(u,BA1)
set WIO=(LoadUnitHandle(LY,(GetHandleId(u)),(103)))
set W1O=(LoadInteger(LY,(GetHandleId(u)),(104)))
if GetUnitTypeId(WIO)=='nfoh' or GetUnitTypeId(WIO)=='ndfl' then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",u,"overhead"))
call PEI(GetOwningPlayer(u),"Abilities\\Spells\\Human\\Heal\\HealTarget.wav")
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(u,FR0[HH0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call UnitRemoveAbility(u,'B0GI')
elseif C8O(W1O)then
set WOO=VTO(W1O)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",u,"overhead"))
set JK=GetItemPlayer(BA1)
call EL1(BA1)
call MUDisableItemTrigger()
if GetOwningPlayer(u)==JK then
set VK=FD1(u,FR0[WOO],FF1)
else
set VK=FD1(u,FQ0[WOO],FF1)
endif
call MUEnableItemTrigger()
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
set VHO=UnitItemInSlot(u,FF1)
call SaveInteger(LY,(GetHandleId(VHO)),(GetHandleId(u)),(W1O))
call VUO(u,VHO)
call UnitRemoveAbility(u,'B0GI')
endif
elseif E81==HH0 then
set FF1=A11(u,BA1)
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(u,FR0[HG0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HG0 then
set FF1=A11(u,BA1)
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(u,FR0[HF0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HF0 then
set FF1=A11(u,BA1)
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(u,FR0[HE0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,0)
elseif E91(E81)then
if(LoadInteger(LY,(GetHandleId(BA1)),(GetHandleId(u))))>0 then
set M10=true
set FF1=A11(u,BA1)
set VHO=CreateItem((LoadInteger(LY,(GetHandleId(BA1)),(GetHandleId(u)))),GetUnitX(u),GetUnitY(u))
call FlushChildHashtable(LY,(GetHandleId(BA1)))
set JK=GetItemPlayer(BA1)
call EL1(BA1)
set VK=FD1(u,FR0[HH0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call UnitAddItem(u,VHO)
set M10=false
call UnitRemoveAbility(u,'B0GI')
endif
endif
set u=null
set BA1=null
set WIO=null
set VHO=null
endfunction
function W2O takes nothing returns boolean
if IsUnitType(GetEventDamageSource(),UNIT_TYPE_MELEE_ATTACKER)==true then
call DisableTrigger(GetTriggeringTrigger())
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,GetEventDamage()*0.5)
call EnableTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function W3O takes nothing returns boolean
if GetIssuedOrderId()==851971 then
if GetOrderTargetItem()!=null and C8O(GetItemTypeId(GetOrderTargetItem()))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"信使不能使用神符")
endif
endif
return false
endfunction
function W4O takes unit W5O returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterUnitEvent(t,W5O,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerAddCondition(t,Condition(function W3O))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,W5O,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function W2O))
set t=null
endfunction
function W6O takes player p returns integer
local integer r=GetRandomInt(1,6)
if IsPlayerTeam1(p)then
if r==1 then
return 'n00I'
elseif r==2 then
return 'n022'
elseif r==3 then
return 'n021'
elseif r==4 then
return 'n0KY'
elseif r==5 then
return 'n0KZ'
else
return 'n0LE'
endif
else
if r==1 then
return 'n023'
elseif r==2 then
return 'n024'
elseif r==3 then
return 'n025'
elseif r==4 then
return 'n0L0'
elseif r==5 then
return 'n0L1'
else
return 'n0M4'
endif
endif
return 0
endfunction
function W7O takes player p returns integer
if GetRandomInt(1,3)==1 then
return 'e02R'
elseif IsPlayerTeam1(p)then
return 'e01H'
else
return 'e01Z'
endif
return 0
endfunction
function W8O takes nothing returns nothing
local unit W9O=CreateUnit(GetOwningPlayer(GetTriggerUnit()),W6O(GetOwningPlayer(GetTriggerUnit())),GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),GetUnitFacing(GetTriggerUnit()))
local real x=GetUnitX(GetTriggerUnit())
local real y=GetUnitY(GetTriggerUnit())
local real a=GetUnitFacing(GetTriggerUnit())
call COO(W9O)
call SetUnitPosition(W9O,x+25*Cos(a*bj_DEGTORAD),y+25*Sin(a*bj_DEGTORAD))
if WM[GetPlayerId(GetOwningPlayer(W9O))]==false then
call UnitRemoveType(W9O,UNIT_TYPE_PEON)
else
call UnitAddType(W9O,UNIT_TYPE_PEON)
endif
endfunction
function WAO takes nothing returns nothing
local unit W9O=CreateUnit(GetOwningPlayer(GetTriggerUnit()),W7O(GetOwningPlayer(GetTriggerUnit())),GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),GetUnitFacing(GetTriggerUnit()))
call COO(W9O)
if WM[GetPlayerId(GetOwningPlayer(W9O))]==false then
call UnitRemoveType(W9O,UNIT_TYPE_PEON)
else
call UnitAddType(W9O,UNIT_TYPE_PEON)
endif
call W4O(W9O)
endfunction
function WBO takes nothing returns boolean
if GetSpellAbilityId()=='A0B6' then
call W8O()
endif
if GetSpellAbilityId()=='A0JT' then
call WAO()
endif
return false
endfunction
function WCO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit W9O=(LoadUnitHandle(LY,(handle_id),(124)))
local integer WDO=(LoadInteger(LY,(handle_id),(125)))
local integer WEO=(LoadInteger(LY,(handle_id),(106)))
local integer WFO=(LoadInteger(LY,(handle_id),(107)))
local integer WGO=(LoadInteger(LY,(handle_id),(108)))
local integer WHO=(LoadInteger(LY,(handle_id),(109)))
local integer WZO=(LoadInteger(LY,(handle_id),(110)))
local integer WVO=(LoadInteger(LY,(handle_id),(111)))
local player p0=(LoadPlayerHandle(LY,(handle_id),(118)))
local player p1=(LoadPlayerHandle(LY,(handle_id),(119)))
local player p2=(LoadPlayerHandle(LY,(handle_id),(120)))
local player p3=(LoadPlayerHandle(LY,(handle_id),(121)))
local player p4=(LoadPlayerHandle(LY,(handle_id),(122)))
local player p5=(LoadPlayerHandle(LY,(handle_id),(123)))
local integer WWO=(LoadInteger(LY,(handle_id),(112)))
local integer WXO=(LoadInteger(LY,(handle_id),(113)))
local integer WYO=(LoadInteger(LY,(handle_id),(114)))
local integer WJO=(LoadInteger(LY,(handle_id),(115)))
local integer WKO=(LoadInteger(LY,(handle_id),(116)))
local integer WLO=(LoadInteger(LY,(handle_id),(117)))
call MUDisableItemTrigger()
if GetTriggerEvalCount(t)==1 then
call UnitAddAbility(W9O,WDO)
if WM[GetPlayerId(GetOwningPlayer(W9O))]==false then
call UnitRemoveType(W9O,UNIT_TYPE_PEON)
else
call UnitAddType(W9O,UNIT_TYPE_PEON)
endif
else
if WEO>0 then
set VK=CreateItem(WEO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p0,false)
call SetItemUserData(VK,1)
endif
if WWO>0 then
call SetItemCharges(VK,WWO)
endif
if WFO>0 then
set VK=CreateItem(WFO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p1,false)
call SetItemUserData(VK,1)
endif
if WXO>0 then
call SetItemCharges(VK,WXO)
endif
if WGO>0 then
set VK=CreateItem(WGO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p2,false)
call SetItemUserData(VK,1)
endif
if WYO>0 then
call SetItemCharges(VK,WYO)
endif
if WHO>0 then
set VK=CreateItem(WHO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p3,false)
call SetItemUserData(VK,1)
endif
if WJO>0 then
call SetItemCharges(VK,WJO)
endif
if WZO>0 then
set VK=CreateItem(WZO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p4,false)
call SetItemUserData(VK,1)
endif
if WKO>0 then
call SetItemCharges(VK,WKO)
endif
if WVO>0 then
set VK=CreateItem(WVO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p5,false)
call SetItemUserData(VK,1)
endif
if WLO>0 then
call SetItemCharges(VK,WLO)
endif
if WM[GetPlayerId(GetOwningPlayer(W9O))]==false then
call UnitRemoveType(W9O,UNIT_TYPE_PEON)
else
call UnitAddType(W9O,UNIT_TYPE_PEON)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call MUEnableItemTrigger()
set t=null
set W9O=null
set p0=null
set p1=null
set p2=null
set p3=null
set p4=null
set p5=null
return false
endfunction
function WMO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit WNO=(LoadUnitHandle(LY,(handle_id),(2)))
local integer WSO=GetUnitTypeId(WNO)
local real x=GetUnitX(WNO)
local real y=GetUnitY(WNO)
local item WTO
local item WRO
local item WPO
local item WQO
local item WUO
local item X0O
local player p0
local player p1
local player p2
local player p3
local player p4
local player p5
local integer WEO
local integer WFO
local integer WGO
local integer WHO
local integer WZO
local integer WVO
local integer WWO=-1
local integer WXO=-1
local integer WYO=-1
local integer WJO=-1
local integer WKO=-1
local integer WLO=-1
local integer WDO
local item BA1
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if WNO==null or IsUnitDead(WNO)then
return false
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set WTO=UnitItemInSlot(WNO,0)
set WRO=UnitItemInSlot(WNO,1)
set WPO=UnitItemInSlot(WNO,2)
set WQO=UnitItemInSlot(WNO,3)
set WUO=UnitItemInSlot(WNO,4)
set X0O=UnitItemInSlot(WNO,5)
set WEO=GetItemTypeId(WTO)
set WFO=GetItemTypeId(WRO)
set WGO=GetItemTypeId(WPO)
set WHO=GetItemTypeId(WQO)
set WZO=GetItemTypeId(WUO)
set WVO=GetItemTypeId(X0O)
set p0=GetItemPlayer(WTO)
set p1=GetItemPlayer(WRO)
set p2=GetItemPlayer(WPO)
set p3=GetItemPlayer(WQO)
set p4=GetItemPlayer(WUO)
set p5=GetItemPlayer(X0O)
set BA1=WTO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WWO=GetItemCharges(BA1)
endif
set BA1=WRO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WXO=GetItemCharges(BA1)
endif
set BA1=WPO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WYO=GetItemCharges(BA1)
endif
set BA1=WQO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WJO=GetItemCharges(BA1)
endif
set BA1=WUO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WKO=GetItemCharges(BA1)
endif
set BA1=X0O
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WLO=GetItemCharges(BA1)
endif
call EL1(WTO)
call EL1(WRO)
call EL1(WPO)
call EL1(WQO)
call EL1(WUO)
call EL1(X0O)
if WSO=='n00I' then
set WDO='S009'
elseif WSO=='n022' then
set WDO='S00V'
elseif WSO=='n021' then
set WDO='S00C'
elseif WSO=='n023' then
set WDO='S00E'
elseif WSO=='n024' then
set WDO='S00B'
elseif WSO=='n025' then
set WDO='S00F'
elseif WSO=='n0KY' then
set WDO='S00W'
elseif WSO=='n0KZ' then
set WDO='S00Y'
elseif WSO=='n0L0' then
set WDO='S00X'
elseif WSO=='n0L1' then
set WDO='S00D'
elseif WSO=='n0LE' then
set WDO='S01F'
elseif WSO=='n0M4' then
set WDO='S015'
endif
if GetRandomInt(1,10)==1 then
set WDO='S00G'
endif
if GetRandomInt(1,10)<3 then
set WDO='S016'
endif
if WSO=='n00M' then
set WDO='S00L'
elseif WSO=='n0LS' then
set WDO='S00L'
elseif WSO=='n0HV' then
set WDO='S00F'
endif
if WSO=='e01H' then
set WDO='S012'
elseif WSO=='e01Z' then
set WDO='S010'
elseif WSO=='e02R' then
set WDO='S014'
elseif WSO=='e02T' then
set WDO='S011'
elseif WSO=='e02S' then
set WDO='S017'
elseif WSO=='e030' then
set WDO='S013'
endif
call SavePlayerHandle(LY,(handle_id),(118),(p0))
call SavePlayerHandle(LY,(handle_id),(119),(p1))
call SavePlayerHandle(LY,(handle_id),(120),(p2))
call SavePlayerHandle(LY,(handle_id),(121),(p3))
call SavePlayerHandle(LY,(handle_id),(122),(p4))
call SavePlayerHandle(LY,(handle_id),(123),(p5))
call SaveInteger(LY,(handle_id),(106),(WEO))
call SaveInteger(LY,(handle_id),(107),(WFO))
call SaveInteger(LY,(handle_id),(108),(WGO))
call SaveInteger(LY,(handle_id),(109),(WHO))
call SaveInteger(LY,(handle_id),(110),(WZO))
call SaveInteger(LY,(handle_id),(111),(WVO))
call SaveInteger(LY,(handle_id),(112),(WWO))
call SaveInteger(LY,(handle_id),(113),(WXO))
call SaveInteger(LY,(handle_id),(114),(WYO))
call SaveInteger(LY,(handle_id),(115),(WJO))
call SaveInteger(LY,(handle_id),(116),(WKO))
call SaveInteger(LY,(handle_id),(117),(WLO))
call SaveUnitHandle(LY,(handle_id),(124),(WNO))
call SaveInteger(LY,(handle_id),(125),(WDO))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function WCO))
set t=null
set WNO=null
set WTO=null
set WRO=null
set WPO=null
set WQO=null
set WUO=null
set X0O=null
set p0=null
set p1=null
set p2=null
set p3=null
set p4=null
set p5=null
return false
endfunction
function XIO takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,false)
call TriggerAddCondition(t,Condition(function WMO))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
set t=null
endfunction
function X1O takes nothing returns boolean
if GetSpellAbilityId()=='A0OT' then
call XIO()
endif
return false
endfunction
function XOO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit W9O=(LoadUnitHandle(LY,(handle_id),(124)))
local integer WDO=(LoadInteger(LY,(handle_id),(125)))
local integer WEO=(LoadInteger(LY,(handle_id),(106)))
local integer WFO=(LoadInteger(LY,(handle_id),(107)))
local integer WGO=(LoadInteger(LY,(handle_id),(108)))
local integer WHO=(LoadInteger(LY,(handle_id),(109)))
local integer WZO=(LoadInteger(LY,(handle_id),(110)))
local integer WVO=(LoadInteger(LY,(handle_id),(111)))
local player p0=(LoadPlayerHandle(LY,(handle_id),(118)))
local player p1=(LoadPlayerHandle(LY,(handle_id),(119)))
local player p2=(LoadPlayerHandle(LY,(handle_id),(120)))
local player p3=(LoadPlayerHandle(LY,(handle_id),(121)))
local player p4=(LoadPlayerHandle(LY,(handle_id),(122)))
local player p5=(LoadPlayerHandle(LY,(handle_id),(123)))
local integer WWO=(LoadInteger(LY,(handle_id),(112)))
local integer WXO=(LoadInteger(LY,(handle_id),(113)))
local integer WYO=(LoadInteger(LY,(handle_id),(114)))
local integer WJO=(LoadInteger(LY,(handle_id),(115)))
local integer WKO=(LoadInteger(LY,(handle_id),(116)))
local integer WLO=(LoadInteger(LY,(handle_id),(117)))
call MUDisableItemTrigger()
if GetTriggerEvalCount(t)==1 then
call UnitAddAbility(W9O,WDO)
if WM[GetPlayerId(GetOwningPlayer(W9O))]==false then
call UnitRemoveType(W9O,UNIT_TYPE_PEON)
else
call UnitAddType(W9O,UNIT_TYPE_PEON)
endif
else
if WEO>0 then
set VK=CreateItem(WEO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p0,false)
call SetItemUserData(VK,1)
endif
if WWO>0 then
call SetItemCharges(VK,WWO)
endif
if WFO>0 then
set VK=CreateItem(WFO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p1,false)
call SetItemUserData(VK,1)
endif
if WXO>0 then
call SetItemCharges(VK,WXO)
endif
if WGO>0 then
set VK=CreateItem(WGO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p2,false)
call SetItemUserData(VK,1)
endif
if WYO>0 then
call SetItemCharges(VK,WYO)
endif
if WHO>0 then
set VK=CreateItem(WHO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p3,false)
call SetItemUserData(VK,1)
endif
if WJO>0 then
call SetItemCharges(VK,WJO)
endif
if WZO>0 then
set VK=CreateItem(WZO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p4,false)
call SetItemUserData(VK,1)
endif
if WKO>0 then
call SetItemCharges(VK,WKO)
endif
if WVO>0 then
set VK=CreateItem(WVO,GetUnitX(W9O),GetUnitY(W9O))
call UnitAddItem(W9O,VK)
call SetItemPlayer(VK,p5,false)
call SetItemUserData(VK,1)
endif
if WLO>0 then
call SetItemCharges(VK,WLO)
endif
if WM[GetPlayerId(GetOwningPlayer(W9O))]==false then
call UnitRemoveType(W9O,UNIT_TYPE_PEON)
else
call UnitAddType(W9O,UNIT_TYPE_PEON)
endif
call SetUnitFlyHeight(W9O,240,0)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call MUEnableItemTrigger()
set t=null
set W9O=null
set p0=null
set p1=null
set p2=null
set p3=null
set p4=null
set p5=null
return false
endfunction
function X2O takes unit WNO returns nothing
local integer WSO=GetUnitTypeId(WNO)
local real x=GetUnitX(WNO)
local real y=GetUnitY(WNO)
local item WTO
local item WRO
local item WPO
local item WQO
local item WUO
local item X0O
local player p0
local player p1
local player p2
local player p3
local player p4
local player p5
local integer WEO
local integer WFO
local integer WGO
local integer WHO
local integer WZO
local integer WVO
local integer WWO=-1
local integer WXO=-1
local integer WYO=-1
local integer WJO=-1
local integer WKO=-1
local integer WLO=-1
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer WDO
local item BA1
local integer i
local item X3O
set i=0
loop
exitwhen i>5
set X3O=UnitItemInSlot(WNO,i)
if GetItemId(X3O)==GZ0 then
call UnitRemoveItem(WNO,X3O)
endif
set i=i+1
endloop
set WTO=UnitItemInSlot(WNO,0)
set WRO=UnitItemInSlot(WNO,1)
set WPO=UnitItemInSlot(WNO,2)
set WQO=UnitItemInSlot(WNO,3)
set WUO=UnitItemInSlot(WNO,4)
set X0O=UnitItemInSlot(WNO,5)
set WEO=GetItemTypeId(WTO)
set WFO=GetItemTypeId(WRO)
set WGO=GetItemTypeId(WPO)
set WHO=GetItemTypeId(WQO)
set WZO=GetItemTypeId(WUO)
set WVO=GetItemTypeId(X0O)
set p0=GetItemPlayer(WTO)
set p1=GetItemPlayer(WRO)
set p2=GetItemPlayer(WPO)
set p3=GetItemPlayer(WQO)
set p4=GetItemPlayer(WUO)
set p5=GetItemPlayer(X0O)
set BA1=WTO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WWO=GetItemCharges(BA1)
endif
set BA1=WRO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WXO=GetItemCharges(BA1)
endif
set BA1=WPO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WYO=GetItemCharges(BA1)
endif
set BA1=WQO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WJO=GetItemCharges(BA1)
endif
set BA1=WUO
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WKO=GetItemCharges(BA1)
endif
set BA1=X0O
if GetItemType(BA1)==ITEM_TYPE_ARTIFACT or EV1(GetItemId(BA1))or EZ1(GetItemId(BA1))then
set WLO=GetItemCharges(BA1)
endif
call EL1(WTO)
call EL1(WRO)
call EL1(WPO)
call EL1(WQO)
call EL1(WUO)
call EL1(X0O)
if IsPlayerTeam1(GetOwningPlayer(WNO))then
set WDO='S00I'
else
set WDO='S00J'
endif
if GetRandomInt(1,3)==1 then
set WDO='S00Z'
endif
call SavePlayerHandle(LY,(handle_id),(118),(p0))
call SavePlayerHandle(LY,(handle_id),(119),(p1))
call SavePlayerHandle(LY,(handle_id),(120),(p2))
call SavePlayerHandle(LY,(handle_id),(121),(p3))
call SavePlayerHandle(LY,(handle_id),(122),(p4))
call SavePlayerHandle(LY,(handle_id),(123),(p5))
call SaveInteger(LY,(handle_id),(106),(WEO))
call SaveInteger(LY,(handle_id),(107),(WFO))
call SaveInteger(LY,(handle_id),(108),(WGO))
call SaveInteger(LY,(handle_id),(109),(WHO))
call SaveInteger(LY,(handle_id),(110),(WZO))
call SaveInteger(LY,(handle_id),(111),(WVO))
call SaveInteger(LY,(handle_id),(112),(WWO))
call SaveInteger(LY,(handle_id),(113),(WXO))
call SaveInteger(LY,(handle_id),(114),(WYO))
call SaveInteger(LY,(handle_id),(115),(WJO))
call SaveInteger(LY,(handle_id),(116),(WKO))
call SaveInteger(LY,(handle_id),(117),(WLO))
call SaveUnitHandle(LY,(handle_id),(124),(WNO))
call SaveInteger(LY,(handle_id),(125),(WDO))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function XOO))
set t=null
set WNO=null
set WTO=null
set WRO=null
set WPO=null
set WQO=null
set WUO=null
set X0O=null
set p0=null
set p1=null
set p2=null
set p3=null
set p4=null
set p5=null
endfunction
function X4O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local item X5O=U8I(hero,FR0[YG0])
if X5O==null then
set X5O=U8I(hero,FQ0[YG0])
endif
if X5O!=null then
call RemoveItem(X5O)
call X2O(hero)
else
call PZI(GetOwningPlayer(hero),"合成所需物品尚未备齐！")
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function X6O takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call W4O(hero)
call TriggerRegisterTimerEvent(t,0.05,false)
call TriggerAddCondition(t,Condition(function X4O))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endfunction
function X7O takes nothing returns boolean
if GetSpellAbilityId()=='A0GD' then
call X6O(GetTriggerUnit())
endif
return false
endfunction
function X8O takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local item BA1=GetManipulatedItem()
local integer id=GetItemTypeId(BA1)
local integer i
if(id==FR0[ZC0]or id==FR0[ZK0])and IsUnitType(SFI,UNIT_TYPE_HERO)==true then
set MW0[GetPlayerId(GetOwningPlayer(SFI))]=GetItemX(BA1)
set MX0[GetPlayerId(GetOwningPlayer(SFI))]=GetItemY(BA1)
endif
call GOO(SFI,BA1)
call G2O(SFI,BA1)
if(GetItemTypeId(BA1)==FR0[WS0]or GetItemTypeId(BA1)==FR0[WT0])and RYI(SFI)then
call UnitRemoveItem(SFI,BA1)
elseif GetItemTypeId(BA1)==FR0[X10]and IsUnitType(SFI,UNIT_TYPE_HERO)==true then
set i=(LoadInteger(LY,(GetHandleId(SFI)),(750)))
if i>0 then
if(LoadBoolean(LY,(GetHandleId(SFI)),(751)))==false then
call SaveBoolean(LY,(GetHandleId(SFI)),(751),(true))
call SetItemCharges(BA1,i)
endif
endif
elseif GetItemTypeId(BA1)==FR0[VL0]and GetUnitTypeId(SFI)!='n00L' and FX0==false then
set FW0=SFI
set FX0=true
call FL1("AegisOn",GetPlayerId(GetOwningPlayer(SFI)))
call QRI(bj_FORCE_ALL_PLAYERS,10.00,C0[GetPlayerId(GetOwningPlayer(SFI))]+GetUnitName(SFI)+"|r "+"获得了不朽之守护")
elseif GetItemTypeId(BA1)==FR0[YG0]and RWI(SFI)then
call X6O(SFI)
elseif GetItemTypeId(BA1)==FR0[KL0]and GetUnitTypeId(SFI)=='Emoo' then
call SetPlayerTechResearched(GetOwningPlayer(SFI),'R00J',1)
elseif GetItemTypeId(BA1)==FR0[KS0]and GetUnitTypeId(SFI)=='H00I' then
set GK=SFI
call ExecuteFunc("X9O")
elseif GetItemTypeId(BA1)==FR0[JK0]and GetUnitTypeId(SFI)=='E032' then
set GK=SFI
call ExecuteFunc("XAO")
elseif GetItemTypeId(BA1)==FR0[L70]and GetUnitTypeId(SFI)=='Hamg' then
set GK=SFI
call ExecuteFunc("XBO")
elseif GetItemTypeId(BA1)==FR0[L80]and GetUnitTypeId(SFI)=='N0MU' then
set GK=SFI
call ExecuteFunc("XCO")
elseif GetItemTypeId(BA1)==FR0[KJ0]and GetUnitTypeId(SFI)=='Ucrl' then
call UnitAddAbility(SFI,'A2KB')
call UnitRemoveAbility(SFI,'A2KB')
call AddUnitAnimationProperties(SFI,"upgrade",true)
call SetPlayerTechResearched(GetOwningPlayer(SFI),'R00K',1)
endif
set SFI=null
set BA1=null
return false
endfunction
function XEO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='Aeat' then
call SaveInteger(LY,(handle_id),(34),(16))
endif
elseif IsUnitDead(hero)or GetTriggerEventId()==EVENT_UNIT_DEATH or NPI==0 then
call UnitRemoveAbility(hero,'A0PV')
call UnitRemoveAbility(hero,'B07L')
call SaveInteger(LY,(GetHandleId((hero))),((4255)),(2))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+115/16)
call SaveInteger(LY,(handle_id),(34),(NPI-1))
endif
return false
endfunction
function XFO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId((hero))),((4255)),(1))
call AddSkill(hero,'A0PV')
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(16))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XEO))
call TriggerEvaluate(t)
set hero=null
set t=null
endfunction
function Tango_AddSingleTango takes nothing returns nothing
call UnitAddItemById(GetSpellTargetUnit(),'I0Q6')
endfunction
function XGO takes nothing returns nothing
if GetSpellAbilityId()=='Aeat' or GetSpellAbilityId()=='A2VG' then
if((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4255))))==1)==false and GetSpellTargetDestructable()!=null then
call XFO()
elseif GetSpellTargetUnit()!=null then
call UnitAddItemById(GetSpellTargetUnit(),'I0Q6')
endif
endif
endfunction
function XHO takes integer id,real x,real y returns nothing
if IsPointInRegion(MT0,x,y)==false then
set MM0=MM0+1
set MY0[MM0]=Player(id)
set MJ0[MM0]=x
set MK0[MM0]=y
set ML0[MM0]=(TimerGetElapsed(M))
endif
endfunction
function XZO takes integer id,real x,real y returns integer
local real GW1=(TimerGetElapsed(M))
local integer i=0
local integer NPI=0
if IsPointInRegion(MT0,x,y)==true then
return NPI
endif
loop
exitwhen i>MM0
if(GW1<ML0[i]+MN0)and(QNI(x,y,MJ0[i],MK0[i])<MS0*2+50)and IsPlayerAlly(Player(id),MY0[i])==true then
set NPI=NPI+1
endif
set i=i+1
endloop
return NPI
endfunction
function XVO takes integer MLI returns integer
if MLI==GetPlayerId(BO[1])then
return 'h0BI'
elseif MLI==GetPlayerId(BO[2])then
return 'h0BK'
elseif MLI==GetPlayerId(BO[3])then
return 'h0BG'
elseif MLI==GetPlayerId(BO[4])then
return 'h0BF'
elseif MLI==GetPlayerId(BO[5])then
return 'h0BL'
elseif MLI==GetPlayerId(CO[1])then
return 'h0BH'
elseif MLI==GetPlayerId(CO[2])then
return 'h0BJ'
elseif MLI==GetPlayerId(CO[3])then
return 'h0BM'
elseif MLI==GetPlayerId(CO[4])then
return 'h0A5'
elseif MLI==GetPlayerId(CO[5])then
return 'h0BN'
endif
return 'h0BN'
endfunction
function XWO takes integer MLI returns integer
return 'h0AX'
endfunction
function XXO takes integer MLI returns string
if MLI==GetPlayerId(BO[1])then
return"war3mapImported\\TeleportTarget_Blue.mdx"
elseif MLI==GetPlayerId(BO[2])then
return"war3mapImported\\TeleportTarget_Teal.mdx"
elseif MLI==GetPlayerId(BO[3])then
return"war3mapImported\\TeleportTarget_Purple.mdx"
elseif MLI==GetPlayerId(BO[4])then
return"war3mapImported\\TeleportTarget_Yellow.mdx"
elseif MLI==GetPlayerId(BO[5])then
return"war3mapImported\\TeleportTarget_Orange.mdx"
elseif MLI==GetPlayerId(CO[1])then
return"war3mapImported\\TeleportTarget_Pink.mdx"
elseif MLI==GetPlayerId(CO[2])then
return"war3mapImported\\TeleportTarget_Gray.mdx"
elseif MLI==GetPlayerId(CO[3])then
return"war3mapImported\\TeleportTarget_LightBlue.mdx"
elseif MLI==GetPlayerId(CO[4])then
return"war3mapImported\\TeleportTarget_DarkGreen.mdx"
elseif MLI==GetPlayerId(CO[5])then
return"war3mapImported\\TeleportTarget_Brown.mdx"
endif
return"Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTarget.mdl"
endfunction
function XYO takes integer MLI returns string
return"Abilities\\Spells\\Human\\MassTeleport\\MassTeleportCaster.mdl"
endfunction
function XJO takes nothing returns boolean
local real d
if IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>0 and GetUnitAbilityLevel(GetFilterUnit(),'Asud')==0 and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(HK))==true and GetUnitTypeId(GetFilterUnit())!='u00S' and GetUnitTypeId(GetFilterUnit())!='ncop' and GetUnitTypeId(GetFilterUnit())!='emow' and GetUnitTypeId(GetFilterUnit())!='uzig' and IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false then
set d=QNI(BK,CK,GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()))
if d<AK then
set AK=d
set GK=GetFilterUnit()
endif
endif
return false
endfunction
function XKO takes unit SWI,real x,real y returns unit
local group g=NTI()
set GK=null
set HK=SWI
set AK=99999
set BK=x
set CK=y
call GroupEnumUnitsInRange(g,x,y,99999,Condition(function XJO))
call NSI(g)
set g=null
return GK
endfunction
function XLO takes unit u returns boolean
local integer id=GetUnitTypeId(u)
return id=='n0FH' or id=='n0F6' or id=='n0FI' or id=='n0FJ'
endfunction
function XMO takes unit u returns boolean
local integer id=GetUnitTypeId(u)
return id=='u00R' or id=='umtw' or id=='e026' or id=='ebal'
endfunction
function XNO takes nothing returns boolean
local real d
if(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 or XMO(GetFilterUnit())or GetUnitTypeId(GetFilterUnit())=='nfoh' or GetUnitTypeId(GetFilterUnit())=='ndfl' or XLO(GetFilterUnit()))and IsUnitDead(GetFilterUnit())==false and GetUnitAbilityLevel(GetFilterUnit(),'Asud')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(HK))==true and GetOwningPlayer(GetFilterUnit())!=EO and IsUnitIllusion(GetFilterUnit())==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)==false and GetUnitTypeId(GetFilterUnit())!='n0F5' then
set d=QNI(BK,CK,GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()))
if d<AK then
set AK=d
set GK=GetFilterUnit()
endif
endif
return false
endfunction
function XSO takes nothing returns boolean
local real d
if(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 or XMO(GetFilterUnit())or GetUnitTypeId(GetFilterUnit())=='nfoh' or GetUnitTypeId(GetFilterUnit())=='ndfl' or XLO(GetFilterUnit()))and IsUnitDead(GetFilterUnit())==false and GetUnitAbilityLevel(GetFilterUnit(),'Asud')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(HK))==true and GetOwningPlayer(GetFilterUnit())!=EO and IsUnitIllusion(GetFilterUnit())==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_FLYING)==false and GetUnitTypeId(GetFilterUnit())!='n0F5' then
set d=QNI(BK,CK,GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()))
if d<AK and d<325 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true then
set AK=d
set GK=GetFilterUnit()
endif
endif
return false
endfunction
function XTO takes unit SWI,real x,real y returns unit
local group g=NTI()
set GK=null
set HK=SWI
set AK=99999
set BK=x
set CK=y
call GroupEnumUnitsInRange(g,x,y,99999,Condition(function XSO))
if GK==null then
call GroupEnumUnitsInRange(g,x,y,99999,Condition(function XNO))
endif
call NSI(g)
set g=null
return GK
endfunction
function XRO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit XPO=(LoadUnitHandle(LY,(handle_id),(448)))
local unit XQO=(LoadUnitHandle(LY,(handle_id),(447)))
local ubersplat AR1=(LoadUbersplatHandle(LY,(handle_id),(131)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real DC1=(LoadReal(LY,(handle_id),(57)))
local real GW1=(LoadReal(LY,(handle_id),(442)))
local integer id=GetPlayerId(GetOwningPlayer(SFI))
local boolean XUO=false
local integer i=0
local integer EY1
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
if GetSpellAbilityId()=='A1R5' then
set XUO=true
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==1 then
if DC1>3 then
call SetUnitAnimationByIndex(XPO,1)
call SetUnitAnimationByIndex(XQO,1)
endif
elseif NPI==2 then
set XUO=true
else
endif
endif
if XUO then
call SaveInteger(LY,(GetHandleId((SFI))),((4256)),(2))
call KillUnit(XPO)
call KillUnit(XQO)
call DestroyUbersplat(AR1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if NPI==2 then
call DestroyEffect(AddSpecialEffect(XYO(id),GetUnitX(SFI),GetUnitY(SFI)))
call DestroyEffect(AddSpecialEffect(XXO(id),x,y))
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
call PauseUnit(SFI,true)
call PauseUnit(SFI,false)
call UPI(x,y,240)
set GK=SFI
call ExecuteFunc("Y0O")
endif
endif
set t=null
set SFI=null
set XPO=null
set XQO=null
set AR1=null
return false
endfunction
function YIO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit XPO=(LoadUnitHandle(LY,(handle_id),(448)))
local unit XQO=(LoadUnitHandle(LY,(handle_id),(447)))
local ubersplat AR1=(LoadUbersplatHandle(LY,(handle_id),(131)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real DC1=(LoadReal(LY,(handle_id),(57)))
local real GW1=(LoadReal(LY,(handle_id),(442)))
local integer id=GetPlayerId(GetOwningPlayer(SFI))
local boolean XUO=false
local integer i=0
local integer EY1
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
if GetSpellAbilityId()=='A231' then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call SaveInteger(LY,(GetHandleId((SFI))),((4256)),(2))
call KillUnit(XPO)
call KillUnit(XQO)
call DestroyUbersplat(AR1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveType(target,UNIT_TYPE_PEON)
endif
elseif GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call UnitRemoveType(target,UNIT_TYPE_PEON)
call SaveInteger(LY,(GetHandleId((SFI))),((4256)),(2))
call KillUnit(XPO)
call KillUnit(XQO)
call DestroyUbersplat(AR1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTarget.mdl",GetUnitX(SFI),GetUnitY(SFI)))
call SaveInteger(LY,(GetHandleId((SFI))),((4256)),(2))
call KillUnit(XPO)
call KillUnit(XQO)
call DestroyUbersplat(AR1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveType(target,UNIT_TYPE_PEON)
call UPI(GetUnitX(target)-1,GetUnitY(target)-1,240)
call MUSetUnitX(SFI,GetUnitX(target)-1)
call MUSetUnitY(SFI,GetUnitY(target)-1)
call PauseUnit(SFI,true)
call PauseUnit(SFI,false)
set GK=SFI
call ExecuteFunc("Y0O")
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTarget.mdl",GetUnitX(SFI),GetUnitY(SFI)))
endif
set t=null
set SFI=null
set XPO=null
set XQO=null
set AR1=null
set target=null
return false
endfunction
function Y1O takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local location point
local real x
local real y
local real a
local trigger t
local integer handle_id
local unit XPO
local unit XQO
local ubersplat AR1
local integer id=GetPlayerId(GetOwningPlayer(SFI))
local integer NPI
local real YOO
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId((SFI))),((4256)),(1))
if target==null then
set point=GetSpellTargetLoc()
set x=GetLocationX(point)
set y=GetLocationY(point)
if x==MW0[id]and y==MX0[id]then
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set x=GetUnitX(PQ)
set y=GetUnitY(PQ)
else
set x=GetUnitX(BX0)
set y=GetUnitY(BX0)
endif
endif
set target=XKO(SFI,x,y)
call RemoveLocation(point)
else
set x=GetUnitX(target)
set y=GetUnitY(target)
endif
if QNI(x,y,GetUnitX(target),GetUnitY(target))>MS0 then
set a=Atan2(y-GetUnitY(target),x-GetUnitX(target))
set x=GetUnitX(target)+MS0*Cos(a)
set y=GetUnitY(target)+MS0*Sin(a)
elseif QNI(x,y,GetUnitX(target),GetUnitY(target))<50 then
set a=Atan2(y-GetUnitY(target),x-GetUnitX(target))
set x=GetUnitX(target)+120*Cos(a)
set y=GetUnitY(target)+120*Sin(a)
endif
if IsPointInRegion(LN,x,y)==true then
set a=Atan2(y-GetUnitY(target),x-GetUnitX(target))
set x=GetUnitX(target)+200*Cos(a)
set y=GetUnitY(target)+200*Sin(a)
endif
set x=PTI(x)
set y=PUI(y)
if(IsUnitAlly(SFI,GetLocalPlayer())and GetLocalPlayer()!=GetOwningPlayer(SFI))or(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))then
call PingMinimapEx(x,y,3,255,255,255,false)
endif
set XQO=CreateUnit(GetOwningPlayer(SFI),XVO(id),x,y,0)
set XPO=CreateUnit(GetOwningPlayer(SFI),XWO(id),GetUnitX(SFI),GetUnitY(SFI),0)
set AR1=CreateUbersplat(GetUnitX(SFI),GetUnitY(SFI),"SCTP",255,255,255,255,false,false)
if IsUnitVisible(SFI,GetLocalPlayer())==true then
call SetUbersplatRenderAlways(AR1,true)
else
call SetUbersplatRenderAlways(AR1,false)
endif
set NPI=XZO(GetPlayerId(GetOwningPlayer(SFI)),x,y)
set YOO=3
if NPI>0 then
set YOO=4.5+0.5*NPI
endif
call XHO(GetPlayerId(GetOwningPlayer(SFI)),x,y)
if NPI>0 then
call SetUnitAnimationByIndex(XPO,2)
call SetUnitAnimationByIndex(XQO,2)
endif
call TriggerRegisterTimerEvent(t,YOO-3,false)
call TriggerRegisterTimerEvent(t,YOO,false)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function XRO))
call I41(GetOwningPlayer(SFI),YOO,x,y,200)
call SaveUnitHandle(LY,(handle_id),(447),(XQO))
call SaveUnitHandle(LY,(handle_id),(448),(XPO))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M)))*1.0))
call SaveReal(LY,(handle_id),(57),((YOO)*1.0))
call SaveUbersplatHandle(LY,(handle_id),(131),(AR1))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(34),(0))
call AI1(SFI,XF,x,y,2400)
set SFI=null
set target=null
set XPO=null
set XQO=null
set point=null
set t=null
set AR1=null
endfunction
function Y2O takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local location point
local real x
local real y
local real a
local trigger t
local integer handle_id
local unit XPO
local unit XQO
local ubersplat AR1
local integer id=GetPlayerId(GetOwningPlayer(SFI))
local integer NPI
local real YOO
set t=CreateTrigger()
set handle_id=GetHandleId(t)
if target==null then
set point=GetSpellTargetLoc()
set x=GetLocationX(point)
set y=GetLocationY(point)
if x==MW0[id]and y==MX0[id]then
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set x=GetUnitX(PQ)
set y=GetUnitY(PQ)
else
set x=GetUnitX(BX0)
set y=GetUnitY(BX0)
endif
endif
set target=XTO(SFI,x,y)
call RemoveLocation(point)
endif
call SaveInteger(LY,(GetHandleId((SFI))),((4256)),(1))
set x=GetUnitX(target)
set y=GetUnitY(target)
if(IsUnitAlly(SFI,GetLocalPlayer())and GetLocalPlayer()!=GetOwningPlayer(SFI))or(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))then
call PingMinimapEx(x,y,3,255,255,255,false)
endif
set AR1=CreateUbersplat(GetUnitX(SFI),GetUnitY(SFI),"SCTP",255,255,255,255,false,false)
if IsUnitVisible(SFI,GetLocalPlayer())==true then
call SetUbersplatRenderAlways(AR1,true)
else
call SetUbersplatRenderAlways(AR1,false)
endif
set YOO=3
call UnitAddType(target,UNIT_TYPE_PEON)
call TriggerRegisterTimerEvent(t,YOO,false)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function YIO))
call I41(GetOwningPlayer(SFI),YOO,x,y,200)
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M)))*1.0))
call SaveReal(LY,(handle_id),(57),((YOO)*1.0))
call SaveUbersplatHandle(LY,(handle_id),(131),(AR1))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTo.mdl",SFI,"origin")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportCaster.mdl",SFI,"origin")))
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTo.mdl",target,"origin")))
call AI1(SFI,XF,x,y,2400)
set SFI=null
set target=null
set XPO=null
set XQO=null
set point=null
set t=null
set AR1=null
endfunction
function Y3O takes nothing returns nothing
if GetSpellAbilityId()=='A1R5' and RYI(GetTriggerUnit())==false then
call Y1O()
endif
if GetSpellAbilityId()=='A231' then
call Y2O()
endif
endfunction
function Y4O takes nothing returns nothing
if MR0==(LoadInteger(LY,(GetHandleId(GetEnumUnit())),(784)))then
call KillUnit(GetEnumUnit())
endif
endfunction
function Y5O takes unit u returns boolean
local integer i=GetUnitTypeId(u)
return i=='n00H' or i=='n00G' or i=='n00K' or i=='n00J' or i=='n00A' or i=='n006'
endfunction
function Y6O takes nothing returns boolean
return Y5O(GetFilterUnit())
endfunction
function Y7O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit Y8O
local unit Y9O
local integer YAO
local integer YBO
local group g=NTI()
local real a=GetUnitFacing(hero)*bj_DEGTORAD
local real x1=GetUnitX(hero)+50*Cos(a)
local real y1=GetUnitY(hero)+50*Sin(a)
local real x2=GetUnitX(hero)+50*Cos(a)
local real y2=GetUnitY(hero)+50*Sin(a)
if GetSpellAbilityId()=='A0HB' then
set YAO='n00H'
set YBO='n00J'
elseif GetSpellAbilityId()=='A0D3' then
set YAO='n00G'
set YBO='n00A'
elseif GetSpellAbilityId()=='A0DF' then
set YAO='n00K'
set YBO='n006'
endif
set MR0=GetUnitTypeId(hero)
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(GetTriggerUnit()),Condition(function Y6O))
call ForGroup(g,function Y4O)
call NSI(g)
set Y8O=CreateUnit(GetOwningPlayer(hero),YAO,x1,y1,GetUnitFacing(hero))
call SaveInteger(LY,(GetHandleId(Y8O)),(784),(MR0))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.mdl",Y8O,"origin"))
call UnitApplyTimedLife(Y8O,'BTLF',40)
set Y9O=CreateUnit(GetOwningPlayer(hero),YBO,x2,y2,GetUnitFacing(hero))
call SaveInteger(LY,(GetHandleId(Y9O)),(784),(MR0))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.mdl",Y9O,"origin"))
call UnitApplyTimedLife(Y9O,'BTLF',40)
set g=null
set Y8O=null
set Y9O=null
set hero=null
endfunction
function YCO takes nothing returns nothing
if GetSpellAbilityId()=='A0HB' or GetSpellAbilityId()=='A0D3' or GetSpellAbilityId()=='A0DF' then
call Y7O()
endif
endfunction
function YDO takes nothing returns nothing
if GetSpellAbilityId()=='A1FP' then
call U5I("Abilities\\Spells\\Items\\VampiricPotion\\VampPotionCaster.mdl",GetTriggerUnit(),"origin",3.5)
call AH1(GetTriggerUnit(),'A1CN',1,3.5)
endif
endfunction
function YEO takes nothing returns boolean
return((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4323))))==1)
endfunction
function YFO takes nothing returns nothing
local group g
local unit u
if GetSpellAbilityId()=='A2V4' and Y5O(GetSpellTargetUnit())==false then
set g=NTI()
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(GetTriggerUnit()),Condition(function YEO))
set u=FirstOfGroup(g)
call NSI(g)
if u!=null then
call KillUnit(u)
endif
call SetUnitOwner(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()),true)
call SaveInteger(LY,(GetHandleId((GetSpellTargetUnit()))),((4323)),(1))
call UnitAddAbility(GetSpellTargetUnit(),'Aeth')
call UnitAddAbility(GetSpellTargetUnit(),'ACrk')
call AddSkill(GetSpellTargetUnit(),'A2YD')
call QSI(GetSpellTargetUnit())
endif
endfunction
function YGO takes integer i returns integer
if i==MP0 then
return N20
endif
if i==MQ0 then
return N30
endif
if i==MU0 then
return N40
endif
if i==N00 then
return N50
endif
if i==NI0 then
return N60
endif
if i==N10 then
return N70
endif
if i==NO0 then
return N80
endif
return 0
endfunction
function YHO takes integer i returns integer
if i==MP0 then
return 10
endif
if i==MQ0 then
return 9
endif
if i==MU0 then
return 8
endif
if i==N00 then
return 7
endif
if i==NI0 then
return 6
endif
if i==N10 then
return 5
endif
if i==NO0 then
return 4
endif
return 0
endfunction
function YZO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if IsUnitDead(SFI)==false and SFI!=null then
call SetUnitScale(SFI,SMI(SFI)*OAI,SMI(SFI)*OAI,SMI(SFI)*OAI)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function YVO takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
local trigger t=CreateTrigger()
local real DC1=YHO(GetSpellAbilityId())
call O21(SFI,N90,DC1)
call UnitMakeAbilityPermanent(SFI,true,N90)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),N90,false)
call UnitAddAbility(dummy,YGO(GetSpellAbilityId()))
call IssueTargetOrder(dummy,"antimagicshell",SFI)
call DU1(SFI,0,0)
call UnitRemoveAbility(SFI,'BHtc')
call UnitRemoveAbility(SFI,'B02U')
if RYI(SFI)then
call O01(SFI,DC1,3)
else
call O01(SFI,DC1,1.4)
endif
call TriggerRegisterTimerEvent(t,DC1+7,false)
call TriggerAddCondition(t,Condition(function YZO))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
set t=null
set SFI=null
set dummy=null
endfunction
function YWO takes nothing returns nothing
if YGO(GetSpellAbilityId())>0 then
call YVO()
endif
endfunction
function YXO takes nothing returns nothing
if((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4258))))==1)==true then
call PZI(GetOwningPlayer(GetEnumUnit()),"梅肯斯姆不能治疗"+" "+GetUnitName(GetEnumUnit())+" "+"，因为该目标在前25秒内已经被梅肯斯姆治疗过一次")
else
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
call SCI(GetEnumUnit(),4258,25)
endif
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)+250)
endif
endfunction
function YYO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),775,Condition(function CS1))
call ForGroup(g,function YXO)
call NSI(g)
set hero=null
set g=null
endfunction
function YJO takes nothing returns nothing
if GetSpellAbilityId()=='A0CK' then
call YYO()
endif
endfunction
function YKO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'A31A')
call UnitRemoveAbility(hero,'A2YJ')
call UnitRemoveAbility(hero,'A2YH')
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
set t=null
set hero=null
return false
endfunction
function YLO takes nothing returns nothing
local trigger t
local integer handle_id
if((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4346))))==1)==true then
call PZI(GetOwningPlayer(GetEnumUnit()),"赤红甲未能应用于"+" "+GetUnitName(GetEnumUnit()))
else
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
call SCI(GetEnumUnit(),4346,70)
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call AddSkill(GetEnumUnit(),'A31A')
call AddSkill(GetEnumUnit(),'A2YJ')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A31A',false)
call AddSkill(GetEnumUnit(),'A2YH')
call TriggerRegisterTimerEvent(t,10,false)
call TriggerRegisterDeathEvent(t,GetEnumUnit())
call TriggerAddCondition(t,Condition(function YKO))
call SaveUnitHandle(LY,(handle_id),(2),(GetEnumUnit()))
set t=null
endif
endfunction
function YMO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
call PlaySoundOnUnitBJ(BG,100,hero)
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),775,Condition(function CS1))
call ForGroup(g,function YLO)
call NSI(g)
set hero=null
set g=null
endfunction
function YNO takes nothing returns nothing
if GetSpellAbilityId()=='A2YG' then
call YMO()
endif
endfunction
function YSO takes nothing returns nothing
if((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4278))))==1)==true then
call PZI(GetOwningPlayer(GetEnumUnit()),"梅肯斯姆不能治疗")
else
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
call SCI(GetEnumUnit(),4278,50)
endif
if GetUnitAbilityLevel(GetEnumUnit(),'B0BT')==0 and GetUnitAbilityLevel(GetEnumUnit(),'B0BU')==0 then
call IssueTargetOrder(NA0,"antimagicshell",GetEnumUnit())
endif
endif
endfunction
function YTO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
set NA0=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(NA0,'A1EV')
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),925,Condition(function CP1))
call ForGroup(g,function YSO)
call NSI(g)
set hero=null
set g=null
endfunction
function YRO takes nothing returns nothing
if GetSpellAbilityId()=='A1EW' then
call YTO()
endif
endfunction
function YPO takes nothing returns nothing
if GetSpellAbilityId()=='A02W' then
call UnitResetCooldown(GetTriggerUnit())
endif
endfunction
function YQO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local real PAI=(LoadReal(LY,(handle_id),(20)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or GetUnitAbilityLevel(GetTriggerUnit(),'B031')==0 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set JJI=true
call Damage(hero,target,1,PAI)
set JJI=false
if PAI>0 then
call UYI("+"+I2S(R2I(PAI)),1,target,0.023,255,0,0,216)
endif
elseif GetEventDamage()>1 then
call SaveReal(LY,(handle_id),(20),((PAI+GetEventDamage()*0.3)*1.0))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function YUO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Silence\\SilenceTarget.mdl",target,"overhead")))
call SaveReal(LY,(handle_id),(20),((0)*1.0))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,5,false)
call TriggerAddCondition(t,Condition(function YQO))
set t=null
return false
endfunction
function J0O takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function YUO))
call SaveUnitHandle(LY,(handle_id),(17),(GetSpellTargetUnit()))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
set t=null
endfunction
function JIO takes nothing returns nothing
if GetSpellAbilityId()=='A0FD' and CanResistSkill(GetSpellTargetUnit())==false then
call J0O()
endif
endfunction
function J1O takes unit u,real d returns boolean
if IsUnitType(u,UNIT_TYPE_HERO)or GetUnitAbilityLevel(u,'A04R')>0 then
return d>5
endif
return true
endfunction
function JOO takes nothing returns nothing
local unit dummy
if NC0>0 then
set NC0=NC0-1
set dummy=CreateUnit(GetOwningPlayer(NB0),'e00E',GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)
call UnitAddAbility(dummy,'A0K6')
call IssueTargetOrder(dummy,"forkedlightning",GetEnumUnit())
endif
set dummy=null
endfunction
function J2O takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy
local unit hero
local group g
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SCI(GetTriggerUnit(),4257,1)
set hero=(LoadUnitHandle(LY,(handle_id),(2)))
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)
call UnitAddAbility(dummy,'A0K6')
set NB0=hero
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),925,Condition(function CA1))
set NC0=5
if QLI(GetTriggerUnit(),GetEventDamageSource())<900 then
set NC0=NC0-1
call IssueTargetOrder(dummy,"forkedlightning",GetEventDamageSource())
endif
call GroupRemoveUnit(g,GetEventDamageSource())
call ForGroup(g,function JOO)
call NSI(g)
endif
set t=null
set g=null
set dummy=null
set hero=null
endfunction
function J3O takes nothing returns boolean
if(GetTriggerEventId()==EVENT_UNIT_DAMAGED and J1O(GetEventDamageSource(),GetEventDamage())and GetRandomInt(1,100)<21 and((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4257))))==1)==false)or GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call J2O()
endif
return false
endfunction
function J4O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if target==null then
set target=hero
endif
call SCI(target,4279,15)
call TriggerRegisterTimerEvent(t,15,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function J3O))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\LightningShield\\LightningShieldTarget.mdl",target,"origin")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
set target=null
endfunction
function J5O takes nothing returns nothing
if GetSpellAbilityId()=='A0JL' and((LoadInteger(LY,(GetHandleId((GetSpellTargetUnit()))),((4279))))==1)==false then
call J4O()
endif
endfunction
function J6O takes nothing returns nothing
local unit J7O=GetTriggerUnit()
local item X5O=U8I(J7O,FR0[YG0])
if X5O==null then
set X5O=U8I(J7O,FQ0[YG0])
endif
if X5O!=null then
call EL1(X5O)
call UnitRemoveAbility(J7O,'A0VR')
call UnitAddAbility(J7O,'A0VU')
call SetUnitState(J7O,UNIT_STATE_MANA,400)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIem\\AIemTarget.mdl",J7O,"origin"))
else
call PZI(GetOwningPlayer(J7O),"合成所需物品尚未备齐！")
endif
set J7O=null
endfunction
function J8O takes nothing returns nothing
if GetSpellAbilityId()=='A0VR' then
call J6O()
endif
endfunction
function J9O takes nothing returns nothing
local unit target=GetEnumUnit()
local group JAO=ND0
local unit hero=NE0
if IsUnitInGroup(target,JAO)==false then
call GroupAddUnit(JAO,target)
call IssueTargetOrder(NF0,"slow",target)
set JJI=true
call Damage(hero,target,1,200)
set JJI=false
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\FrostNova\\FrostNovaTarget.mdl",target,"origin"))
endif
set target=null
set JAO=null
set hero=null
endfunction
function JBO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local real d
local real x
local real x0=GetUnitX(hero)
local real y
local real y0=GetUnitY(hero)
local group g=NTI()
local integer NPI=GetTriggerEvalCount(t)
local integer i
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
set ND0=JAO
set NE0=hero
set NF0=(LoadUnitHandle(LY,(handle_id),(132)))
if GetTriggerEvalCount(t)>37 then
call KillUnit(dummy)
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set d=NPI*21
set i=0
loop
exitwhen i>36
set x=x0+d*Cos(360*i/36*bj_DEGTORAD)
set y=y0+d*Sin(360*i/36*bj_DEGTORAD)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,150,Condition(function C81))
call ForGroup(g,function J9O)
set i=i+1
endloop
endif
call NSI(g)
set t=null
set dummy=null
set JAO=null
set hero=null
set g=null
return false
endfunction
function JCO takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local group JAO=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'h091',x,y,0)
local unit JDO=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
call UnitAddAbility(JDO,'A0T0')
call SaveGroupHandle(LY,(handle_id),(133),(JAO))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(132),(JDO))
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call TriggerRegisterTimerEvent(t,0.06,true)
call TriggerAddCondition(t,Condition(function JBO))
set t=null
set JAO=null
set dummy=null
set JDO=null
set SFI=null
endfunction
function JEO takes nothing returns nothing
if GetSpellAbilityId()=='A0T9' then
call JCO()
endif
endfunction
function JFO takes unit hero,integer JGO returns nothing
local integer handle_id=GetHandleId(hero)
call SaveInteger(LY,(handle_id),(750),(JGO))
endfunction
function JHO takes nothing returns nothing
local integer i=0
local integer EY1=0
local boolean JZO=false
if GetSpellAbilityId()=='A0JY' then
loop
exitwhen i>5
if F01(UnitItemInSlot(GetTriggerUnit(),i))==HK0 or F01(UnitItemInSlot(GetTriggerUnit(),i))==X10 then
set EY1=GetItemCharges(UnitItemInSlot(GetTriggerUnit(),i))
if EY1>0 then
call SetItemCharges(UnitItemInSlot(GetTriggerUnit(),i),0)
call JFO(GetTriggerUnit(),0)
if JZO==false then
set JZO=true
call SetUnitState(GetTriggerUnit(),UNIT_STATE_MANA,GetUnitState(GetTriggerUnit(),UNIT_STATE_MANA)+15*EY1)
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+15*EY1)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIre\\AIreTarget.mdl",GetTriggerUnit(),"origin"))
endif
endif
return
endif
set i=i+1
endloop
endif
endfunction
function JVO takes integer id returns boolean
local integer i=1
loop
exitwhen i>EC0
if id==EB0[i]then
return false
endif
set i=i+1
endloop
return true
endfunction
function JWO takes unit JXO,unit hero returns nothing
if IsUnitVisible(JXO,GetOwningPlayer(hero))==false and GetRandomInt(1,100)<10 then
call PlaySoundOnUnitBJ(IF,100,hero)
endif
endfunction
function JYO takes nothing returns nothing
local unit SFI=GetEnumUnit()
local integer i=0
loop
exitwhen i>5
if IsUnitVisible(GetTriggerUnit(),GetOwningPlayer(GetEnumUnit()))==true then
if F01(UnitItemInSlot(SFI,i))==HK0 or F01(UnitItemInSlot(SFI,i))==X10 then
if F01(UnitItemInSlot(SFI,i))==X10 then
if GetItemCharges(UnitItemInSlot(SFI,i))==17 then
call JWO(GetTriggerUnit(),SFI)
endif
call JFO(SFI,Q9I(GetItemCharges(UnitItemInSlot(SFI,i))+1,17))
call SetItemCharges(UnitItemInSlot(SFI,i),Q9I(GetItemCharges(UnitItemInSlot(SFI,i))+1,17))
else
if GetItemCharges(UnitItemInSlot(SFI,i))==10 then
call JWO(GetTriggerUnit(),SFI)
endif
call JFO(SFI,Q9I(GetItemCharges(UnitItemInSlot(SFI,i))+1,10))
call SetItemCharges(UnitItemInSlot(SFI,i),Q9I(GetItemCharges(UnitItemInSlot(SFI,i))+1,10))
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",SFI,"chest"))
set i=5
endif
endif
set i=i+1
endloop
set SFI=null
endfunction
function JJO takes nothing returns nothing
local group g=NTI()
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
call GroupEnumUnitsInRange(g,x,y,1225,Condition(function D01))
call ForGroup(g,function JYO)
call NSI(g)
set g=null
set hero=null
endfunction
function JKO takes nothing returns nothing
if JVO(GetSpellAbilityId())==true and TRI(GetSpellAbilityId())==true and GetUnitAbilityLevel(GetTriggerUnit(),'A04R')==0 and V81(GetSpellAbilityId())==false then
call JJO()
endif
endfunction
function JLO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit JMO=(LoadUnitHandle(LY,(handle_id),(134)))
if GetTriggerEventId()!=EVENT_UNIT_DEATH then
call UnitRemoveAbility(JMO,'A17R')
call UnitRemoveAbility(JMO,'A24F')
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set JMO=null
return false
endfunction
function JNO takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>0.5 and IsUnitAlly(GetFilterUnit(),NG0)==true and GetOwningPlayer(GetFilterUnit())!=EO and GetUnitTypeId(GetFilterUnit())!='ncop' and GetUnitTypeId(GetFilterUnit())!='n0FJ' and GetUnitTypeId(GetFilterUnit())!='n0FI' and GetUnitTypeId(GetFilterUnit())!='n0F6' and GetUnitTypeId(GetFilterUnit())!='n0FH'
endfunction
function JSO takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit JMO=GetEnumUnit()
local string s
call UnitAddAbility(JMO,'A17R')
call UnitAddAbility(JMO,'A24F')
if IsPlayerTeam1(NG0)then
set s="effects\\GlyphSent.mdx"
else
set s="effects\\GlyphScourge.mdx"
endif
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(s,JMO,"origin")))
call SaveUnitHandle(LY,(handle_id),(134),(JMO))
call TriggerRegisterUnitEvent(t,JMO,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,NV0,false)
call TriggerAddCondition(t,Condition(function JLO))
set t=null
set JMO=null
endfunction
function JTO takes unit JRO,player p returns nothing
local integer i
if IsPlayerTeam1(p)then
set i=1
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=2
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=3
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=4
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=5
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
else
set i=7
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=8
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=9
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=10
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
set i=11
if JRO!=D30[i]then
call IssueImmediateOrder(D30[i],"coldarrows")
endif
endif
endfunction
function JPO takes nothing returns nothing
local group g
local unit JRO=GetTriggerUnit()
local player p=GetOwningPlayer(JRO)
if(IsPlayerTeam1(p)and NH0==false)or(IsPlayerTeam1(p)==false and NZ0==false)then
set g=NTI()
set NG0=p
call GroupEnumUnitsInRange(g,0,0,12000,Condition(function JNO))
call ForGroup(g,function JSO)
call NSI(g)
if IsPlayerTeam1(p)then
set NH0=true
call JTO(JRO,p)
set NH0=false
else
set NZ0=true
call JTO(JRO,p)
set NZ0=false
endif
endif
set g=null
set JRO=null
set p=null
endfunction
function JQO takes nothing returns nothing
if GetSpellAbilityId()=='A141' or GetSpellAbilityId()=='A1WI' then
call JPO()
endif
endfunction
function JUO takes nothing returns nothing
if GetSpellAbilityId()=='A12W' and GetUnitAbilityLevel(GetTriggerUnit(),'Bpsh')>0 then
call UnitRemoveAbility(GetTriggerUnit(),'Bpsh')
endif
endfunction
function K0O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if RSI(GetEventDamage())and IsUnitAlly(GetEventDamageSource(),GetOwningPlayer(GetTriggerUnit()))==false and IsUnitType(GetEventDamageSource(),UNIT_TYPE_STRUCTURE)==false and NW0==false then
if GetUnitAbilityLevel(GetEventDamageSource(),'A04R')==0 then
call DisableTrigger(t)
set NW0=true
call Damage(GetTriggerUnit(),GetEventDamageSource(),3,GetEventDamage())
set NW0=false
call EnableTrigger(t)
endif
endif
endif
set t=null
return false
endfunction
function KIO takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,4.5,false)
call TriggerAddCondition(t,Condition(function K0O))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\SpikeBarrier\\SpikeBarrier.mdl",hero,"chest")))
set t=null
set hero=null
endfunction
function K1O takes nothing returns nothing
if GetSpellAbilityId()=='A15W' then
call KIO()
endif
endfunction
function KOO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real d=(LoadReal(LY,(handle_id),(138)))
local real x=PTI(GetUnitX(target)+d/10*Cos(a*bj_DEGTORAD))
local real y=PUI(GetUnitY(target)+d/10*Sin(a*bj_DEGTORAD))
if GetTriggerEvalCount(t)==11 or GetTriggerEventId()==EVENT_UNIT_DEATH or((LoadInteger(LY,(GetHandleId((target))),((4260))))==1)==true then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",x,y))
if((LoadInteger(LY,(GetHandleId((target))),((4306))))==1)==false and((LoadInteger(LY,(GetHandleId((target))),((4324))))==1)==false and GetUnitAbilityLevel(target,'B08V')==0 and GetUnitAbilityLevel(target,'B0FG')==0 then
call UPI(x,y,150)
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
endif
endif
set target=null
set t=null
return false
endfunction
function K2O takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x
local real y
local real d
local real a
local integer i=-1
local boolean K3O=false
if GetSpellTargetItem()!=null then
set target=GetTriggerUnit()
endif
call SCI(target,4414,3)
set a=GetUnitFacing(target)
loop
exitwhen K3O or i==23
set i=i+1
set x=PTI(GetUnitX(target)+(600-i*25)*Cos(a*bj_DEGTORAD))
set y=PUI(GetUnitY(target)+(600-i*25)*Sin(a*bj_DEGTORAD))
if(IsPointInRegion(LN,((x)*1.0),((y)*1.0)))==false then
set K3O=true
endif
endloop
set d=QNI(x,y,GetUnitX(target),GetUnitY(target))
call TriggerRegisterTimerEvent(t,0.04,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function KOO))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(138),((d)*1.0))
set target=null
set t=null
endfunction
function K4O takes nothing returns nothing
if GetSpellAbilityId()=='A19M' and GetUnitTypeId(GetSpellTargetUnit())!='n00L' then
if IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true or(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))==false then
call K2O()
endif
endif
endfunction
function K5O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEvalCount(t)>30 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(hero,'A1QC')
call UnitRemoveAbility(hero,'B0CY')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set hero=null
set t=null
return false
endfunction
function K6O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer DC1=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEvalCount(t)>DC1/0.1 or GetTriggerEventId()==EVENT_UNIT_DEATH or((LoadInteger(LY,(GetHandleId((hero))),((4256))))==1)then
call UnitRemoveAbility(hero,'Aetl')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set hero=null
set t=null
return false
endfunction
function K7O takes unit u,integer DC1 returns nothing
local unit hero=u
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UnitAddAbility(hero,'Aetl')
call UnitMakeAbilityPermanent(hero,true,'Aetl')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'Aetl',false)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function K6O))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(DC1))
set hero=null
set t=null
endfunction
function EtherBlast_AddToEnemies takes nothing returns nothing
call K7O(GetEnumUnit(),3)
endfunction
function EtherBlast_DamageEnemies takes nothing returns nothing
call Damage(GetTriggerUnit(),GetEnumUnit(),1,NX0)
endfunction
function K8O takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
local trigger t
local integer DC1=3
if hero==target then
set DC1=4
endif
if IsPlayerAlly(GetOwningPlayer(target),GetOwningPlayer(hero))==true and hero!=target then
call K7O(target,4)
elseif hero!=target then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1QC',false)
call UnitAddAbility(target,'A1QC')
call UnitMakeAbilityPermanent(target,true,'A1QC')
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function K5O))
call SaveUnitHandle(LY,(handle_id),(2),(target))
call K7O(target,DC1)
call UYI("+"+I2S(R2I(PAI)),2,target,0.027,3,216,120,216)
set JJI=true
call Damage(hero,target,1,PAI)
set JJI=false
else
call K7O(hero,DC1)
endif
set hero=null
set target=null
endfunction
function K9O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t2=IJ1(hero,target,'h0BS',"K8O",1000,false)
local integer KAO=GetHandleId(t2)
local integer KBO=SEI(hero)
local real KCO
if KBO==2 then
set KCO=GetHeroAgi(hero,true)
elseif KBO==3 then
set KCO=GetHeroStr(hero,true)
elseif KBO==1 then
set KCO=GetHeroInt(hero,true)
endif
call SaveReal(LY,(KAO),(20),((KCO*2.0+75)*1.0))
set hero=null
set target=null
set t2=null
endfunction
function KDO takes nothing returns nothing
if GetSpellAbilityId()=='A1QD' and(IsPlayerAlly(GetOwningPlayer(GetSpellTargetUnit()),GetOwningPlayer(GetTriggerUnit()))==true or CanResistSkill(GetSpellTargetUnit())==false)then
call K9O()
endif
endfunction
function KEO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEvalCount(t)>40 or GetTriggerEventId()==EVENT_UNIT_DEATH or RKI(hero)or((LoadInteger(LY,(GetHandleId((hero))),((4256))))==1)then
call UnitRemoveAbility(hero,'Aetl')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set hero=null
set t=null
return false
endfunction
function KFO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t
local integer handle_id
if RYI(hero)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UnitAddAbility(hero,'Aetl')
call UnitMakeAbilityPermanent(hero,true,'Aetl')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'Aetl',false)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function KEO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
set hero=null
set t=null
endfunction
function KGO takes nothing returns nothing
if GetSpellAbilityId()=='A1AC' and RKI(GetTriggerUnit())==false then
call KFO()
endif
endfunction
function KHO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real KZO=(LoadReal(LY,(handle_id),(529)))
local real KVO=(LoadReal(LY,(handle_id),(530)))
local real KWO=GetUnitState(hero,UNIT_STATE_MANA)
local real KXO=GetUnitState(hero,UNIT_STATE_MAX_MANA)
local real KYO=(LoadReal(LY,(handle_id),(668)))
local real KJO=GetUnitStatePercent(hero,UNIT_STATE_MANA,UNIT_STATE_MAX_MANA)
local real KKO=(KYO-KJO)/100
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)==20*10 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if KZO<150 then
call SetUnitState(hero,UNIT_STATE_MANA,KWO-(150-KZO-KVO))
endif
else
if KKO>0 then
set KZO=KZO+KKO*KXO
if KVO>0 then
if KKO*KXO>KVO then
call SetUnitState(hero,UNIT_STATE_MANA,KWO+KVO)
set KVO=0
else
if KVO>(KXO-KWO)then
set KVO=KVO-(KXO-KWO)
call SetUnitState(hero,UNIT_STATE_MANA,KXO)
else
set KVO=KVO-KKO*KXO
call SetUnitState(hero,UNIT_STATE_MANA,KWO+KKO*KXO)
endif
endif
endif
endif
set KYO=KJO
call SaveReal(LY,(handle_id),(668),((KYO)*1.0))
call SaveReal(LY,(handle_id),(529),((KZO)*1.0))
call SaveReal(LY,(handle_id),(530),((KVO)*1.0))
endif
set t=null
set hero=null
return false
endfunction
function KLO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real KMO=GetUnitState(hero,UNIT_STATE_LIFE)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real KWO=GetUnitState(hero,UNIT_STATE_MANA)
if KMO>151 then
call SetUnitState(hero,UNIT_STATE_LIFE,KMO-150)
else
call SetUnitState(hero,UNIT_STATE_LIFE,1)
endif
call U5I("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl",hero,"origin",2)
call SetUnitState(hero,UNIT_STATE_MANA,KWO+150)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function KHO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(242),((GetUnitState(hero,UNIT_STATE_MANA))*1.0))
call SaveReal(LY,(handle_id),(529),((0)*1.0))
call SaveReal(LY,(handle_id),(668),((GetUnitStatePercent(hero,UNIT_STATE_MANA,UNIT_STATE_MAX_MANA))*1.0))
if(KWO+150)>GetUnitState(hero,UNIT_STATE_MAX_MANA)then
call SaveReal(LY,(handle_id),(530),(((KWO+150)-GetUnitState(hero,UNIT_STATE_MAX_MANA))*1.0))
endif
set hero=null
endfunction
function KNO takes nothing returns nothing
if GetSpellAbilityId()=='A1Q8' then
call KLO()
endif
endfunction
function KSO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x
local real y
//改成判断阵营
if GetPlayerTeam(GetOwningPlayer(hero)) == 0 then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
call IssuePointOrder(hero,"move",x,y)
set hero=null
endfunction
function KTO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x
local real y
//改成判断阵营
if GetPlayerTeam(GetOwningPlayer(hero)) == 0 then
set x=-4533
set y=1158
else
set x=3190
set y=-35
endif
call IssuePointOrder(hero,"move",x,y)
set hero=null
endfunction
function KRO takes nothing returns nothing
if GetSpellAbilityId()=='A1AS' then
call KSO()
elseif GetSpellAbilityId()=='A2KS' then
call KTO()
endif
endfunction
function KPO takes nothing returns nothing
local unit SFI=GetTriggerUnit()
call SaveBoolean(LY,(GetHandleId(SFI)),(129),(true))
set SFI=null
endfunction
function KQO takes nothing returns nothing
if(GetSpellAbilityId()=='A0B8' or GetSpellAbilityId()=='A1WE')and CanResistSkill(GetTriggerUnit())==true then
call KPO()
endif
endfunction
function KUO takes integer id returns boolean
return id=='ugho' or id=='unec' or id=='esen' or id=='edry' or id=='u001' or id=='u002' or id=='e00V' or id=='e00W' or id=='ebal' or id=='e026' or id=='umtw' or id=='u00R'
endfunction
function L0O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>8 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set mu_damage_dot = true
call Damage(hero,target,3,150.0/8.0) // 影之灵龛造成伤害
set mu_damage_dot = false
endif
set t=null
set hero=null
set target=null
return false
endfunction
function LIO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and(KUO(GetUnitTypeId(GetEventDamageSource()))==false and(GetOwningPlayer(GetEventDamageSource())!=DO or GetUnitTypeId(GetEventDamageSource())=='n00L')and GetEventDamage()>0)or NY0==true)then
call UnitRemoveAbility(target,'B0CG')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
// 影之灵龛
function L1O takes nothing returns nothing
local trigger t
local integer handle_id
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
local integer i=0
local boolean FW1=false
local boolean K3O=false
local integer EY1
if target==null then
set target=GetTriggerUnit()
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
loop
exitwhen i>5 or K3O
if F01(UnitItemInSlot(hero,i))==X60 then
set EY1=GetItemCharges(UnitItemInSlot(hero,i))
if EY1>0 then
set FW1=true
set EY1=EY1-1
else
set K3O=true
set FW1=false
endif
endif
set i=i+1
endloop
if FW1==true then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
if IsUnitAlly(target,GetOwningPlayer(hero))==true then
call UnitAddAbility(dummy,'A1MM')
call IssueTargetOrderById(dummy,852609,target)
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,NK0,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function LIO))
else
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\Urn_Enemy.mdx",target,"overhead")))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function L0O))
endif
endif
set hero=null
set dummy=null
set target=null
set t=null
endfunction
function LOO takes nothing returns nothing
if GetSpellAbilityId()=='A1MO' then
call L1O()
endif
endfunction
function L2O takes nothing returns nothing
local integer i=0
loop
exitwhen i>16
set NJ0[i]=false
set i=i+1
endloop
endfunction
function L3O takes nothing returns nothing
if BJ1(GetEnumUnit())==false then
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A1ZX',false)
call AX1(GetEnumUnit(),'A1ZX',1,NL0,'B0DX')
endif
endfunction
function L4O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer i=0
local boolean FW1=false
local boolean K3O=false
local integer EY1
local group g
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),925,Condition(function CM1))
call ForGroup(g,function L3O)
call NSI(g)
set g=null
set hero=null
endfunction
function L5O takes nothing returns nothing
if GetSpellAbilityId()=='A1ZW' then
call L4O()
endif
endfunction
function L6O takes unit u returns boolean
local integer SSI=GetUnitTypeId(u)
return SSI=='H0B8' or SSI=='n0FJ' or SSI=='n0FI' or SSI=='n0F6' or SSI=='n0FH' or SSI=='u00S'
endfunction
function L7O takes unit u returns boolean
local integer id=GetUnitTypeId(u)
return P3I(id)
endfunction
function L8O takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),NM0)and IsUnitDead(GetFilterUnit())==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true or L7O(GetFilterUnit()))and L6O(GetFilterUnit())==false
endfunction
function L9O takes unit hero returns boolean
local group g=NTI()
local boolean FW1
set NM0=GetOwningPlayer(hero)
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1050,Condition(function L8O))
set FW1=FirstOfGroup(g)!=null
call NSI(g)
return FW1
endfunction
function LAO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g
local integer NPI
local boolean LBO
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==hero then
call UnitRemoveAbility(hero,'A20L')
call UnitRemoveAbility(hero,'A20S')
call UnitRemoveAbility(hero,'B0E2')
call UnitRemoveAbility(hero,'B09Y')
call FV1(hero)
if((LoadInteger(LY,(GetHandleId((hero))),((4302))))==1)==false then
call UnitSetUsesAltIcon(hero,false)
endif
call SaveInteger(LY,(GetHandleId((hero))),((4420)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
set LBO=(LoadBoolean(LY,(handle_id),(671)))
set NPI=(LoadInteger(LY,(handle_id),(34)))
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
set g=NTI()
set NM0=GetOwningPlayer(hero)
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1050,Condition(function L8O))
if GetUnitAbilityLevel(hero,'B09Y')>0 then
call SaveBoolean(LY,(handle_id),(671),(true))
elseif LBO then
call SaveBoolean(LY,(handle_id),(671),(false))
call UnitRemoveAbility(hero,'A20L')
call AddSkill(hero,'A20L')
endif
if NPI>350 or FirstOfGroup(g)!=null then
call UnitRemoveAbility(hero,'A20L')
call UnitRemoveAbility(hero,'A20S')
call UnitRemoveAbility(hero,'B0E2')
call UnitRemoveAbility(hero,'B09Y')
call FV1(hero)
if((LoadInteger(LY,(GetHandleId((hero))),((4302))))==1)==false and((LoadInteger(LY,(GetHandleId((hero))),((4421))))==1)==false then
call UnitSetUsesAltIcon(hero,false)
endif
call SaveInteger(LY,(GetHandleId((hero))),((4420)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call NSI(g)
endif
set t=null
set hero=null
set g=null
return false
endfunction
function LCO takes nothing returns nothing
local unit hero=GetEnumUnit()
local trigger t
local integer handle_id
if T2I(GetOwningPlayer(hero))and L9O(hero)==false then
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))==false and P0I(GetLocalPlayer())==false then
call UnitSetUsesAltIcon(hero,true)
call FY1(hero)
endif
call AddSkill(hero,'A20L')
call UnitMakeAbilityPermanent(hero,true,'A20L')
if BJ1(hero)==false then
call AddSkill(hero,'A20S')
call UnitMakeAbilityPermanent(hero,true,'A20S')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A20S',false)
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(34),(0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveBoolean(LY,(handle_id),(671),(false))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\SmokeOfDeceit.mdx",hero,"chest")))
call SaveInteger(LY,(GetHandleId((hero))),((4420)),(1))
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterTimerEvent(t,.1,true)
call TriggerAddCondition(t,Condition(function LAO))
set t=null
endif
set hero=null
endfunction
function LDO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1225,Condition(function CL1))
call ForGroup(g,function LCO)
call NSI(g)
set hero=null
set g=null
endfunction
function LEO takes nothing returns nothing
if GetSpellAbilityId()=='A206' then
call LDO()
endif
endfunction
function InitTrig_Smoke_of_Deceit takes nothing returns nothing
call SetAltMinimapIcon("war3mapImported\\black.blp")
endfunction
function LFO takes nothing returns nothing
if BJ1(GetEnumUnit())==false then
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A28F',false)
call AX1(GetEnumUnit(),'A28F',1,NN0,'B0EQ')
endif
endfunction
function LGO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
call GroupEnumUnitsInRange(g,x,y,600+25,Condition(function C51))
call ForGroup(g,function LFO)
call NSI(g)
call DestroyEffect(AddSpecialEffect("war3mapImported\\DarkLightningNova.mdx",x,y))
set hero=null
set g=null
endfunction
function LHO takes nothing returns nothing
if GetSpellAbilityId()=='A28D' then
call LGO()
endif
endfunction
function LZO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(745)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or(TimerGetElapsed(M))>LVO then
call UnitRemoveAbility(target,'B0FU')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetUnitAbilityLevel(target,'B0FU')==0 then
call IssueTargetOrder(dummy,"curse",target)
endif
set t=null
set target=null
set dummy=null
return false
endfunction
function CripplingStaff takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local real d=NS0
local trigger t
local integer handle_id
if RKI(target)==false then
call AddSkill(dummy,'A2JM')
call IssueTargetOrder(dummy,"curse",target)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2EC',false)
call AX1(target,'A2EC',1,d,'B0F5')
else
call AddSkill(dummy,'A2JM')
call SetUnitAbilityLevel(dummy,'A2JM',2)
call IssueTargetOrder(dummy,"curse",target)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2EC',false)
call AX1(target,'A2EC',1,d,'B0F5')
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function LZO))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(GetHandleId(target)),(745),(((TimerGetElapsed(M))+d)*1.0))
set hero=null
set target=null
set dummy=null
set t=null
endfunction
function LWO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2K3')
call IssueTargetOrder(dummy,"slow",target)
set hero=null
set target=null
set dummy=null
endfunction
function LXO takes nothing returns nothing
if GetSpellAbilityId()=='A2EA' and CanResistSkill(GetSpellTargetUnit())==false then
call LWO()
endif
endfunction
function LYO takes unit hero returns nothing
if IsUnitIllusion(hero)or MA0[GetPlayerId(GetOwningPlayer(hero))]<=0 or(IsUnitType(hero,UNIT_TYPE_HERO)==false and B61(hero)==false)then
return
elseif EA1(hero,FR0[Z00])==true or EA1(hero,FR0[ZI0])==true then
call HFO(hero)
endif
endfunction
function LJO takes nothing returns boolean
call LYO(GetAttacker())
call LYO(GetTriggerUnit())
return false
endfunction
function LKO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or NPI==20 or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetEventDamage()>20)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+12.5)
endif
set t=null
set hero=null
return false
endfunction
function LLO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function LKO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\TranquilBootsHeal.mdx",hero,"origin")))
set hero=null
set t=null
endfunction
function LMO takes nothing returns nothing
if GetSpellAbilityId()=='A2K1' then
call LLO()
endif
endfunction
function LNO takes nothing returns boolean
local unit IYO=GetSummonedUnit()
local integer i=0
local item HZO
local integer E81
if IsUnitIllusion(IYO)==true then
loop
exitwhen i>5
set HZO=UnitItemInSlot(IYO,i)
set E81=F01(HZO)
if E81==Z00 then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HZO)
call RemoveItem(HZO)
set VK=FD1(IYO,FR0[ZI0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
set i=i+1
endloop
endif
set IYO=null
return false
endfunction
function LTO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy
if GetUnitX(hero)!=x or GetUnitY(hero)!=y or(GetUnitAbilityLevel(hero,'B0GM')==0 and GetTriggerEvalCount(t)>R2I(0.3/.05))or GetTriggerEvalCount(t)>R2I(NT0/.05)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId((hero))),((4337)),(2))
call UnitRemoveAbility(hero,'B0GL')
call UnitRemoveAbility(hero,'B0GM')
call UnitRemoveAbility(hero,'A2R3')
elseif GetTriggerEvalCount(t)==R2I(0.3/.05)then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(dummy,'A2R2')
call IssueTargetOrder(dummy,"invisibility",hero)
call SaveInteger(LY,(GetHandleId((hero))),((4337)),(2))
set dummy=null
endif
set t=null
set hero=null
return false
endfunction
function LRO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer LPO=(LoadInteger(LY,(handle_id),(375)))
local integer id=GetUnitCurrentOrder(hero)
if GetUnitX(hero)!=x or GetUnitY(hero)!=y then
call IssueImmediateOrder(hero,"holdposition")
call SaveReal(LY,(LPO),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(LPO),(7),((GetUnitY(hero))*1.0))
elseif id==0 or id==851973 or id==851983 or id==851971 then
call IssueImmediateOrder(hero,"holdposition")
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function LQO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local trigger t2=CreateTrigger()
local integer KAO=GetHandleId(t2)
local string LUO="Abilities\\Spells\\Undead\\DeathandDecay\\DeathandDecayTarget.mdl"
if GetLocalPlayer()!=GetOwningPlayer(hero)then
set LUO=""
endif
call AddSkill(hero,'A2R3')
call SaveInteger(LY,(GetHandleId((hero))),((4337)),(1))
call DestroyEffect(AddSpecialEffectTarget(LUO,hero,"chest"))
call DestroyEffect(AddSpecialEffectTarget(LUO,hero,"hand left"))
call DestroyEffect(AddSpecialEffectTarget(LUO,hero,"hand right"))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function LTO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call TriggerRegisterTimerEvent(t2,0.01,false)
call TriggerAddCondition(t2,Condition(function LRO))
call SaveUnitHandle(LY,(KAO),(2),(hero))
call SaveReal(LY,(KAO),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(KAO),(7),((GetUnitY(hero))*1.0))
call SaveInteger(LY,(KAO),(375),(handle_id))
set hero=null
set t=null
endfunction
function M0O takes nothing returns nothing
if GetSpellAbilityId()=='A2R1' and((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4337))))==1)==false then
call LQO()
endif
endfunction
function MIO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetUnitAbilityLevel(hero,'Bdet')==0 then
call UnitRemoveAbility(hero,'A2SJ')
call UnitRemoveAbility(hero,'B0GR')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if BU1(hero)==true then
if GetUnitAbilityLevel(hero,'B0GR')==0 then
call AddSkill(hero,'A2SJ')
endif
else
if GetUnitAbilityLevel(hero,'B0GR')>0 then
call UnitRemoveAbility(hero,'A2SJ')
call UnitRemoveAbility(hero,'B0GR')
endif
endif
endif
set hero=null
set t=null
return false
endfunction
function M1O takes nothing returns nothing
local unit hero=GetEnumUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function MIO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function MOO takes nothing returns nothing
local group g=NTI()
local unit hero=GetTriggerUnit()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1050+25,Condition(function D01))
call ForGroup(g,function M1O)
call NSI(g)
set g=null
set hero=null
endfunction
function M2O takes nothing returns nothing
if GetSpellAbilityId()=='AItb' then
call MOO()
endif
endfunction
function M3O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real H71=(LoadReal(LY,(handle_id),(6)))
local real H81=(LoadReal(LY,(handle_id),(7)))
call H61(hero,H71,H81,650)
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
if GetUnitAbilityLevel(hero,'B074')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function M4O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.005,true)
call TriggerAddCondition(t,Condition(function M3O))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
set t=null
set hero=null
endfunction
function M5O takes nothing returns nothing
if GetSpellAbilityId()=='A0JZ' then
call M4O()
endif
endfunction
function M6O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer M7O=0
local integer M8O=0
local item EJ1
local integer M9O
local integer M5I
local unit MAO
if GetSpellAbilityId()=='A2WI' then
set M9O='oeye'
set M5I=60*4
set M7O='I05H'
set M8O=ZB0
elseif GetSpellAbilityId()=='A2WH' then
set M9O='o004'
set M5I=60*7
set M7O='I05G'
set M8O=ZA0
endif
if(M7O!=0)then
if target!=null then
if EQ1(target)>0 then
call MUDisableItemTrigger()
set EJ1=UnitAddItemById(target,M7O)
call SetItemPlayer(EJ1,GetOwningPlayer(target),false)
call SetItemUserData(EJ1,1)
call SetItemCharges(EJ1,1)
call MUEnableItemTrigger()
else
call EK1(FT0[M8O],GetUnitX(target),GetUnitY(target),GetOwningPlayer(target),true,1)
endif
else
set MAO=CreateUnit(GetOwningPlayer(hero),M9O,GetSpellTargetX(),GetSpellTargetY(),0)
call UnitApplyTimedLife(MAO,'BTLD',M5I)
call AddSkill(MAO,'A0XB')
call II1(GetOwningPlayer(hero),UF,GetSpellTargetX(),GetSpellTargetY())
if IsUnitInRegion(R60,MAO)then
call H1O(hero,MAO)
call RemoveUnit(MAO)
else
call GUO(MAO,hero)
if GetUnitTypeId(MAO)=='oeye' then
call I41(GetOwningPlayer(MAO),12,GetUnitX(MAO),GetUnitY(MAO),150)
endif
endif
endif
endif
set hero=null
set EJ1=null
endfunction
function MBO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local item AO1=ES1(hero,FR0[WG0])
local integer FF1
if AO1!=null and(GetUnitTypeId(hero)!='N0MM' or IsUnitDead(hero)==false)then
call MUDisableItemTrigger()
set FF1=A11(hero,AO1)
set JK=GetItemPlayer(AO1)
call RemoveItem(AO1)
set VK=FD1(hero,FR0[WF0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
call UnitRemoveAbility(hero,'A30Y')
call UnitRemoveAbility(hero,'B0HL')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set hero=null
set t=null
return false
endfunction
function MCO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function MBO))
call TriggerRegisterTimerEvent(t,8,false)
call AddSkill(hero,'A30Y')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A30Y',false)
set t=null
set hero=null
endfunction
function MDO takes nothing returns nothing
if GetSpellAbilityId()=='A31F' then
call MCO()
endif
endfunction
function MEO takes nothing returns nothing
if IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==false then
call Damage(GetTriggerUnit(),GetSpellTargetUnit(),2,100)
endif
endfunction
function MFO takes nothing returns nothing
if GetSpellAbilityId()=='A1FD' then
if GetUnitTypeId(GetSpellTargetUnit())=='o004' or GetUnitTypeId(GetSpellTargetUnit())=='oeye' then
call MEO()
endif
endif
endfunction
function MGO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SetItemCharges(ES1(hero,FR0[WM0]),GetItemCharges(ES1(hero,FR0[WM0]))+1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetUnitTypeId(hero)=='Npbm' then
set YXI=hero
endif
call KillUnit(hero)
set hero=null
set t=null
return false
endfunction
function MHO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerAddCondition(t,Condition(function MGO))
call TriggerRegisterTimerEvent(t,0.01,false)
set t=null
set hero=null
endfunction
function MZO takes nothing returns nothing
if GetSpellAbilityId()=='A2TK' then
call MHO()
endif
endfunction
function MVO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy
if GetUnitX(hero)!=x or GetUnitY(hero)!=y or(GetUnitAbilityLevel(hero,'B0G8')==0 and GetTriggerEvalCount(t)>R2I(1.5/.05))then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId((hero))),((4330)),(2))
call UnitRemoveAbility(hero,'B0G6')
call UnitRemoveAbility(hero,'B0G8')
elseif GetTriggerEvalCount(t)==R2I(1.5/.05)then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(dummy,'A2N5')
call IssueTargetOrder(dummy,"invisibility",hero)
call SaveInteger(LY,(GetHandleId((hero))),((4330)),(2))
set dummy=null
endif
set t=null
set hero=null
return false
endfunction
function MWO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer LPO=(LoadInteger(LY,(handle_id),(375)))
local integer id=GetUnitCurrentOrder(hero)
if GetUnitX(hero)!=x or GetUnitY(hero)!=y then
call IssueImmediateOrder(hero,"holdposition")
call SaveReal(LY,(LPO),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(LPO),(7),((GetUnitY(hero))*1.0))
elseif id==0 or id==851973 or id==851983 or id==851971 then
call IssueImmediateOrder(hero,"holdposition")
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function MXO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local trigger t2=CreateTrigger()
local integer KAO=GetHandleId(t2)
local string LUO="Abilities\\Spells\\Undead\\DeathandDecay\\DeathandDecayTarget.mdl"
if GetLocalPlayer()!=GetOwningPlayer(hero)then
set LUO=""
endif
call SaveInteger(LY,(GetHandleId((hero))),((4330)),(1))
call DestroyEffect(AddSpecialEffectTarget(LUO,hero,"chest"))
call DestroyEffect(AddSpecialEffectTarget(LUO,hero,"hand left"))
call DestroyEffect(AddSpecialEffectTarget(LUO,hero,"hand right"))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function MVO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call TriggerRegisterTimerEvent(t2,0.01,false)
call TriggerAddCondition(t2,Condition(function MWO))
call SaveUnitHandle(LY,(KAO),(2),(hero))
call SaveReal(LY,(KAO),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(KAO),(7),((GetUnitY(hero))*1.0))
call SaveInteger(LY,(KAO),(375),(handle_id))
set hero=null
set t=null
endfunction
function MYO takes nothing returns nothing
if GetSpellAbilityId()=='A2N1' and((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4330))))==1)==false then
call MXO()
endif
endfunction
function MJO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer MKO=(LoadInteger(LY,(handle_id),(34)))
if(GetTriggerEventId()==EVENT_WIDGET_DEATH or GetTriggerEvalCount(t)>=MKO or RKI(target)==true)then
call BP1(target)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function MLO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=2
local real DC1=4.5
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if IsUnitType(target,UNIT_TYPE_MELEE_ATTACKER)==true then
set level=1
set DC1=3
endif
call BT1(target)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function MJO))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(34),(R2I(DC1*10)))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl",target,"overhead")))
set hero=null
set target=null
set dummy=null
endfunction
function MMO takes nothing returns nothing
if GetSpellAbilityId()=='A2K4' and CanResistSkill(GetSpellTargetUnit())==false then
call MLO()
endif
endfunction
function MNO takes integer level,unit hero,unit target returns nothing
set JJI=true
call Damage(hero,target,1,300+100*level)
set JJI=false
endfunction
function MSO takes nothing returns nothing
local integer MTO=0
if GetSpellAbilityId()=='A02O' then
set MTO=1
endif
if GetSpellAbilityId()=='A08Y' then
set MTO=2
endif
if GetSpellAbilityId()=='A08Z' then
set MTO=3
endif
if GetSpellAbilityId()=='A090' then
set MTO=4
endif
if GetSpellAbilityId()=='A092' then
set MTO=5
endif
if MTO>0 and CanResistSkill(GetSpellTargetUnit())==false then
call MNO(MTO,GetTriggerUnit(),GetSpellTargetUnit())
endif
endfunction
function MRO takes nothing returns nothing
if GetSpellAbilityId()=='A2HQ' then
call IKO(GetTriggerUnit(),GetSpellTargetUnit())
endif
endfunction
function MPO takes unit hero,integer RII,real x,real y returns nothing
local unit MQO=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(MQO,'BTLF',15)
set MQO=null
endfunction
function MUO takes nothing returns nothing
local unit MQO
local real x
local real y
if GetSpellAbilityId()=='A1ZL' then
set x=GetDestructableX(GetSpellTargetDestructable())
set y=GetDestructableY(GetSpellTargetDestructable())
call MPO(GetTriggerUnit(),'n0LM',x,y)
elseif GetSpellAbilityId()=='A1ZM' then
set x=GetDestructableX(GetSpellTargetDestructable())
set y=GetDestructableY(GetSpellTargetDestructable())
call MPO(GetTriggerUnit(),'n0LN',x,y)
endif
set MQO=null
endfunction
function N0O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(hero,'A308')
call UnitRemoveAbility(target,'A308')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function NIO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(hero,'A308')
call UnitRemoveAbility(target,'A309')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function N1O takes nothing returns nothing
local trigger t
local integer handle_id
if IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,7,false)
call TriggerAddCondition(t,Condition(function N0O))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(17),(GetSpellTargetUnit()))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\Cripple\\CrippleTarget.mdl",GetSpellTargetUnit(),"chest")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\Cripple\\CrippleTarget.mdl",GetTriggerUnit(),"chest")))
call UnitAddAbility(GetTriggerUnit(),'A308')
call UnitAddAbility(GetSpellTargetUnit(),'A308')
call UnitMakeAbilityPermanent(GetTriggerUnit(),true,'A308')
call UnitMakeAbilityPermanent(GetSpellTargetUnit(),true,'A308')
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,7,false)
call TriggerAddCondition(t,Condition(function NIO))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(17),(GetSpellTargetUnit()))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\Cripple\\CrippleTarget.mdl",GetSpellTargetUnit(),"chest")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\Cripple\\CrippleTarget.mdl",GetTriggerUnit(),"chest")))
call UnitAddAbility(GetTriggerUnit(),'A308')
call UnitAddAbility(GetSpellTargetUnit(),'A309')
call UnitMakeAbilityPermanent(GetTriggerUnit(),true,'A308')
call UnitMakeAbilityPermanent(GetSpellTargetUnit(),true,'A309')
endif
set t=null
endfunction
function NOO takes nothing returns nothing
if GetSpellAbilityId()=='A1ZI' then
call N1O()
endif
endfunction
function N2O takes nothing returns nothing
local unit SWI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
if GetSpellTargetUnit()==null then
if GetSpellAbilityId()=='AIpl' then
set dummy=CreateUnit(GetOwningPlayer(SWI),'e00E',GetUnitX(SWI),GetUnitY(SWI),0)
call UnitAddAbility(dummy,'A1WA')
call IssueTargetOrderById(dummy,852609,SWI)
set dummy=null
elseif GetSpellAbilityId()=='AIpr' then
set dummy=CreateUnit(GetOwningPlayer(SWI),'e00E',GetUnitX(SWI),GetUnitY(SWI),0)
call UnitAddAbility(dummy,'AIpr')
call IssueTargetOrderById(dummy,852609,SWI)
set dummy=null
endif
endif
set SWI=null
set target=null
endfunction
function N3O takes nothing returns nothing
if GetSpellAbilityId()=='AIpl' or GetSpellAbilityId()=='AIpr' then
call N2O()
endif
endfunction
function N4O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(34)))
if(GetTriggerEventId()==EVENT_UNIT_DEATH and GetKillingUnit()==hero)or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetUnitAbilityLevel(target,'B0ES')>0)then
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Transmute\\PileofGold.mdl",GetUnitX(target),GetUnitY(target)))
call AddHeroXP(hero,R2I(SQI(level)*2.5),true)
call OL1(GetOwningPlayer(hero),target,190)
set EL0[GetPlayerId(GetOwningPlayer(hero))]=EL0[GetPlayerId(GetOwningPlayer(hero))]+190
set EK0[GetPlayerId(GetOwningPlayer(hero))]=EK0[GetPlayerId(GetOwningPlayer(hero))]+190
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(target)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function N5O takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitLevel(target)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(34),(level))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function N4O))
set t=null
set hero=null
set target=null
endfunction
function N6O takes nothing returns nothing
if GetSpellAbilityId()=='A28Y' and Y5O(GetSpellTargetUnit())==false then
call N5O()
endif
endfunction
function N7O takes nothing returns nothing
call SetUnitState(GetEnumUnit(),UNIT_STATE_MANA,GetUnitState(GetEnumUnit(),UNIT_STATE_MANA)+135)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIma\\AImaTarget.mdl",GetEnumUnit(),"origin"))
endfunction
function N8O takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),25+600,Condition(function CT1))
call ForGroup(g,function N7O)
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set g=null
set hero=null
set t=null
return false
endfunction
function N9O takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g
local trigger t
if GetSpellAbilityId()=='A0K7' then
if GetUnitTypeId(hero)!='H00J' then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function N8O))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
set t=null
elseif GetUnitTypeId(hero)=='H00J' then
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+25)
endif
endif
set hero=null
endfunction
function NAO takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='e00E' then
return false
endif
call VRO()
call WBO()
call X1O()
call XGO()
call Y3O()
call YCO()
call YFO()
call YWO()
call YJO()
call YDO()
call YPO()
call JIO()
call J5O()
call JEO()
call J8O()
call JKO()
call JHO()
call HCO()
call HAO()
call JQO()
call JUO()
call K1O()
call K4O()
call KGO()
call KRO()
call X7O()
call YRO()
call KQO()
call LOO()
call KNO()
call KDO()
call N9O()
call N6O()
call N3O()
call NOO()
call MUO()
call L5O()
call LEO()
call LHO()
call LXO()
call MRO()
call MSO()
call LMO()
call MMO()
call MYO()
call MZO()
call M0O()
call M2O()
call MFO()
call M6O()
call M5O()
call YNO()
call MDO()
if GetSpellAbilityId()=='A2K7' and CanResistSkill(GetSpellTargetUnit())==false then
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\LevelerStunFX.mdx",GetSpellTargetUnit(),"head"))
endif
return false
endfunction
function NCO takes unit SFI returns nothing
call SetUnitState(SFI,UNIT_STATE_LIFE,GetUnitState(SFI,UNIT_STATE_MAX_LIFE))
call SetUnitState(SFI,UNIT_STATE_MANA,GetUnitState(SFI,UNIT_STATE_MAX_MANA))
endfunction
function NDO takes unit SFI,real x,real y returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(SFI))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
set NR0=true
if W51!=null then
call ReviveHero(W51,x,y,true)
call NCO(W51)
call VS1(W51)
call MUSetUnitX(W51,x)
call MUSetUnitY(W51,y)
endif
if W61!=null then
call ReviveHero(W61,x,y,true)
call NCO(W61)
call VS1(W61)
call MUSetUnitX(W61,x)
call MUSetUnitY(W61,y)
endif
if W71!=null then
call ReviveHero(W71,x,y,true)
call NCO(W71)
call VS1(W71)
call MUSetUnitX(W71,x)
call MUSetUnitY(W71,y)
endif
if W81!=null then
call ReviveHero(W81,x,y,true)
call NCO(W81)
call VS1(W81)
call MUSetUnitX(W81,x)
call MUSetUnitY(W81,y)
endif
set W51=null
set W61=null
set W71=null
set W81=null
endfunction
function NEO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call NCO(SFI)
call VS1(SFI)
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitAddForPlayer(SFI,GetOwningPlayer(SFI))
if GetUnitTypeId(SFI)=='H00I' then
call NDO(SFI,GetUnitX(SFI),GetUnitY(SFI))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function NFO takes unit SFI,real x,real y returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(SFI))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
call DisableTrigger(EG)
if W51!=null then
call MUSetUnitX(W51,x)
call MUSetUnitY(W51,y)
call KillUnit(W51)
endif
if W61!=null then
call MUSetUnitX(W61,x)
call MUSetUnitY(W61,y)
call KillUnit(W61)
endif
if W71!=null then
call MUSetUnitX(W71,x)
call MUSetUnitY(W71,y)
call KillUnit(W71)
endif
if W81!=null then
call MUSetUnitX(W81,x)
call MUSetUnitY(W81,y)
call KillUnit(W81)
endif
call EnableTrigger(EG)
set W51=null
set W61=null
set W71=null
endfunction
function NGO takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real x
local real y
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call FL1("AegisOff",GetPlayerId(GetOwningPlayer(SFI)))
if GetUnitTypeId(SFI)=='H00I' then
call NFO(SFI,GetUnitX(SFI),GetUnitY(SFI))
endif
set FW0=null
call TriggerRegisterTimerEvent(t,5,false)
call TriggerAddCondition(t,Condition(function NEO))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SCI(SFI,4304,5)
set t=null
set SFI=null
endfunction
function NHO takes nothing returns nothing
if F01(GetManipulatedItem())==VL0 then
call NGO()
endif
endfunction
function NZO takes nothing returns nothing
local unit SWI=GetTriggerUnit()
local item AO1=GetManipulatedItem()
local integer E81=F01(AO1)
local integer FF1
call MUDisableItemTrigger()
if GetUnitTypeId(SWI)!='H00J' then
if E81==ZL0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
//call MUDisableItemTrigger()
set VK=FD1(SWI,FR0[ZM0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==ZM0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
//call MUDisableItemTrigger()
set VK=FD1(SWI,FR0[ZN0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==ZN0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
//call MUDisableItemTrigger()
set VK=FD1(SWI,FR0[ZL0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
endif
call MUEnableItemTrigger()
set SWI=null
set AO1=null
endfunction
function NVO takes nothing returns nothing
local unit SWI=GetTriggerUnit()
local item AO1=GetManipulatedItem()
local integer E81=F01(AO1)
local integer FF1
call MUDisableItemTrigger()
if E81==ZY0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[ZJ0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==ZJ0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[ZY0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if E81==Z20 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[Z30],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==Z30 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[Z20],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if E81==W60 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[W70],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==W70 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[W60],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if E81==WF0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[WG0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==WG0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[WF0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
call MUEnableItemTrigger()
set SWI=null
set AO1=null
endfunction
function NWO takes nothing returns nothing
local unit SWI=GetTriggerUnit()
local item AO1=GetManipulatedItem()
local integer E81=F01(AO1)
local integer FF1
call MUDisableItemTrigger()
if E81==W80 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[W90],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==W90 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[W80],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
call MUEnableItemTrigger()
set SWI=null
set AO1=null
endfunction
function NXO takes nothing returns nothing
local unit SWI=GetTriggerUnit()
local item AO1=GetManipulatedItem()
local integer E81=F01(AO1)
local integer FF1
call MUDisableItemTrigger()
if E81==V40 and GetItemCharges(AO1)==0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[V60],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==V50 and GetItemCharges(AO1)==0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[V70],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
elseif E81==HP0 and GetItemCharges(AO1)==0 then
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[HQ0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
call MUEnableItemTrigger()
set SWI=null
set AO1=null
endfunction
function NYO takes nothing returns nothing
local unit SWI=GetTriggerUnit()
local item AO1=GetManipulatedItem()
local integer E81=F01(AO1)
local integer FF1
call MUDisableItemTrigger()
if E81==VZ0 then
call SaveInteger(LY,(GetHandleId(GetOwningPlayer(SWI))),(4345),(9))
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[VV0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call G8O(VK)
elseif E81==VV0 then
call SaveInteger(LY,(GetHandleId(GetOwningPlayer(SWI))),(4345),(8))
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[VW0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call G8O(VK)
elseif E81==VW0 then
call SaveInteger(LY,(GetHandleId(GetOwningPlayer(SWI))),(4345),(7))
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[VX0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call G8O(VK)
elseif E81==VX0 then
call SaveInteger(LY,(GetHandleId(GetOwningPlayer(SWI))),(4345),(6))
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[VY0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call G8O(VK)
elseif E81==VY0 then
call SaveInteger(LY,(GetHandleId(GetOwningPlayer(SWI))),(4345),(5))
set FF1=A11(SWI,AO1)
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(AO1)
set VK=FD1(SWI,FR0[VJ0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call G8O(VK)
endif
call MUEnableItemTrigger()
set SWI=null
set AO1=null
endfunction
function NJO takes nothing returns boolean
local integer FF1
local real VOO
call MUDisableItemTrigger()
if F01(GetManipulatedItem())==WT0 then
set FF1=A11(GetTriggerUnit(),GetManipulatedItem())
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(GetManipulatedItem())
set VK=FD1(GetTriggerUnit(),FR0[WS0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
if F01(GetManipulatedItem())==WS0 then
set FF1=A11(GetTriggerUnit(),GetManipulatedItem())
set JK=GetItemPlayer(GetManipulatedItem())
call RemoveItem(GetManipulatedItem())
set VK=FD1(GetTriggerUnit(),FR0[WT0],FF1)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
endif
call MUEnableItemTrigger()
return false
endfunction
function PerseveranceDisassemble takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local player p=GetItemPlayer(GetManipulatedItem())
local item EJ1
call MUDisableItemTrigger()
call RemoveItem(GetManipulatedItem())
set EJ1=UnitAddItemById(SFI,FR0[HI0])
call SetItemPlayer(EJ1,p,false)
call SetItemUserData(EJ1,1)
set EJ1=UnitAddItemById(SFI,FR0[HB0])
call SetItemPlayer(EJ1,p,false)
call SetItemUserData(EJ1,1)
call MUEnableItemTrigger()
set SFI=null
set p=null
set EJ1=null
endfunction
function NKO takes nothing returns nothing
if GetItemTypeId(GetManipulatedItem())==FR0[ZV0]then
call PZI(GetOwningPlayer(GetTriggerUnit()),"无法单击拆分，请使用你的能量圈或者飞行信使的拆分功能来拆分")
endif
endfunction
function NLO takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if VBO(hero)then
call F71(hero,'I0HM')
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveBoolean(LY,(GetHandleId(hero)),(129),(false))
set t=null
set hero=null
return false
endfunction
function NMO takes nothing returns nothing
local unit hero=GetTriggerUnit()
local item AO1=GetManipulatedItem()
local integer E81=F01(AO1)
local trigger t
if(E81==VM0 or E81==VN0)and(LoadBoolean(LY,(GetHandleId(hero)),(129)))==true then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.41,false)
call TriggerAddCondition(t,Condition(function NLO))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
set t=null
endif
set hero=null
set AO1=null
endfunction
function NNO takes nothing returns boolean
local real x
local real y
local real a
call NVO()
call NWO()
call NZO()
call W0O()
call NHO()
call NJO()
call NKO()
call NYO()
call NXO()
call NMO()
return false
endfunction
function NTO takes nothing returns boolean
return GetOwningPlayer(GetTriggerUnit())==DO
endfunction
function NRO takes nothing returns nothing
call SaveInteger(LY,(400+GetPlayerId(GetOwningPlayer(GetKillingUnit()))),(79),((LoadInteger(LY,(400+GetPlayerId(GetOwningPlayer(GetKillingUnit()))),(79)))+1))
endfunction
function NQO takes nothing returns nothing
local location BFO=GetRectCenter(P4)
set N0=CreateUnitAtLoc(Player(12),'n00L',BFO,bj_UNIT_FACING)
call SetUnitAcquireRange(N0,150)
call B5O(N0)
call RemoveLocation(BFO)
call UnitAddItem(N0,CreateItem(FR0[VL0],0,0))
call UnitAddAbility(N0,'A142')
set BFO=GetRectCenter(H4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(Z4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(V4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(W4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(X4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(Y4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(J4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(K4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(L4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(M4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(V5)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(X5)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
endfunction
function InitTrig_Spawn_Roshan takes nothing returns nothing
call NQO()
endfunction
function NUO takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==BO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",U0)
elseif GetOwningPlayer(GetTriggerUnit())==CO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",II)
endif
return false
endfunction
function SIO takes nothing returns nothing
set SI=SI+1
endfunction
function SOO takes nothing returns nothing
set NI=NI+1
endfunction
function S3O takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==BO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",BI)
endif
return false
endfunction
function S6O takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==CO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",BI)
endif
return false
endfunction
function S8O takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==BO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",CI)
endif
return false
endfunction
function SAO takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==CO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",CI)
endif
return false
endfunction
function SCO takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==BO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",DI)
endif
return false
endfunction
function SEO takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==CO[0]then
call IssuePointOrderLoc(GetTriggerUnit(),"attack",DI)
endif
return false
endfunction
function SGO takes nothing returns nothing
call AX1(GetEnumUnit(),'A2V1',1,15,'B0H2')
endfunction
function SHO takes nothing returns nothing
call AX1(GetEnumUnit(),'A2V0',1,15,'B0H1')
endfunction
function SZO takes group g returns nothing
if(TimerGetElapsed(M))<7*60 then
call ForGroup(g,function SGO)
endif
endfunction
function CreepMeetAdjustment2_Speed_Add takes nothing returns nothing
call AX1(GetEnumUnit(),'A2V1',1,10,'B0H2')
endfunction
function CreepMeetAdjustment2_Slow_Add takes nothing returns nothing
call AX1(GetEnumUnit(),'A2V0',1,20,'B0H1')
endfunction
function SVO takes group g returns nothing
if(TimerGetElapsed(M))<7*60 then
call ForGroup(g,function SHO)
endif
endfunction
function SWO takes nothing returns nothing
local integer i=1
local integer id
loop
exitwhen i>5
set id=GetPlayerId(BO[i])
call FL1("CSK"+I2S(id),A[id])
call FL1("CSD"+I2S(id),B[id])
call FL1("NK"+I2S(id),(LoadInteger(LY,(400+id),(79))))
set id=GetPlayerId(CO[i])
call FL1("CSK"+I2S(id),A[id])
call FL1("CSD"+I2S(id),B[id])
call FL1("NK"+I2S(id),(LoadInteger(LY,(400+id),(79))))
set i=i+1
endloop
endfunction
function SXO takes boolean SYO returns nothing
local unit u
local string SJO="stand work alternate"
local string SKO="stand work"
local string SLO="stand alternate"
local string SMO="stand"
set u=IZ0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SJO)
else
call SetUnitAnimation(u,SLO)
endif
endif
set u=IV0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SJO)
else
call SetUnitAnimation(u,SLO)
endif
endif
set u=IW0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SJO)
else
call SetUnitAnimation(u,SLO)
endif
endif
set u=IX0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SJO)
else
call SetUnitAnimation(u,SLO)
endif
endif
set u=IY0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SJO)
else
call SetUnitAnimation(u,SLO)
endif
endif
set u=IJ0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SJO)
else
call SetUnitAnimation(u,SLO)
endif
endif
set u=C80
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SKO)
else
call SetUnitAnimation(u,SMO)
endif
endif
set u=C90
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SKO)
else
call SetUnitAnimation(u,SMO)
endif
endif
set u=CA0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SKO)
else
call SetUnitAnimation(u,SMO)
endif
endif
set u=CB0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SKO)
else
call SetUnitAnimation(u,SMO)
endif
endif
set u=CC0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SKO)
else
call SetUnitAnimation(u,SMO)
endif
endif
set u=CD0
if IsUnitDead(u)==false then
if SYO then
call SetUnitAnimation(u,SKO)
else
call SetUnitAnimation(u,SMO)
endif
endif
endfunction
function SNO takes nothing returns boolean
call SXO(true)
return false
endfunction
function Trig_Spawn_Conditions takes nothing returns boolean
return true
if(INI)then
return ISI
endif
if(IQI)then
return IUI
endif
if(E2)then
return D2
endif
if QT0 then
return QR0
endif
if(N2)then
return I3
endif
if(K0)then
return PG0
endif
if(IAI)then
return IBI
endif
if(CN)then
return PW0
endif
return O0
endfunction
function SSO takes group STO,integer SRO returns nothing
local unit u
loop
set u=FirstOfGroup(STO)
exitwhen(u==null)
call GroupRemoveUnit(STO,u)
call SetUnitAbilityLevel(u,I2,SRO)
endloop
endfunction
function SPO takes nothing returns nothing
local boolean SQO=ModuloInteger(GetTriggerExecCount(ZG),7)==0
if R70 then
return
endif
call SXO(false)
if SQO then
call SWO()
endif
if GetTriggerExecCount(ZG)==1 and O2I==false then
call UnitResetCooldown(D30[1])
call UnitResetCooldown(D30[2])
call UnitResetCooldown(D30[3])
call UnitResetCooldown(D30[4])
call UnitResetCooldown(D30[5])
call UnitResetCooldown(D30[7])
call UnitResetCooldown(D30[8])
call UnitResetCooldown(D30[9])
call UnitResetCooldown(D30[10])
call UnitResetCooldown(D30[11])
call BK1(I70,false)
call BK1(I80,false)
call BK1(I90,false)
call BK1(BU0,false)
call BK1(C00,false)
call BK1(CI0,false)
elseif GetTriggerExecCount(ZG)==1 and O2I==true then
call BK1(I80,false)
call BK1(C00,false)
endif
if GetTriggerExecCount(ZG)==1 then
call EnableTrigger(EW0)
endif
if O2I==false and O7I==false then
if(HI)then
call CreateNUnitsAtLoc(NI,'ugho',CO[0],RI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(NI,'u001',CO[0],RI,bj_UNIT_FACING)
endif
call SZO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,2)
endif
if O6I==false then
if(ZI)then
call CreateNUnitsAtLoc(NI,'ugho',CO[0],TI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(NI,'u001',CO[0],TI,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,3)
endif
if O2I==false and O4I==false then
if(VI)then
call CreateNUnitsAtLoc(NI,'ugho',CO[0],PI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(NI,'u001',CO[0],PI,bj_UNIT_FACING)
endif
call SVO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,4)
endif
if O2I==false and O7I==false then
if(EI)then
call CreateNUnitsAtLoc(SI,'unec',CO[0],I1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'u002',CO[0],I1,bj_UNIT_FACING)
endif
call SZO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,2)
endif
if O6I==false then
if(FI)then
call CreateNUnitsAtLoc(SI,'unec',CO[0],QI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'u002',CO[0],QI,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,3)
endif
if O2I==false and O4I==false then
if(GI)then
call CreateNUnitsAtLoc(SI,'unec',CO[0],UI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'u002',CO[0],UI,bj_UNIT_FACING)
endif
call SVO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,4)
endif
if SQO==true then
if O2I==false and O7I==false then
if(EI)then
call CreateNUnitsAtLoc(SI,'umtw',CO[0],I1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'u00R',CO[0],I1,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,2)
endif
if O6I==false then
if(FI)then
call CreateNUnitsAtLoc(SI,'umtw',CO[0],QI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'u00R',CO[0],QI,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,3)
endif
if O2I==false and O4I==false then
if(GI)then
call CreateNUnitsAtLoc(SI,'umtw',CO[0],UI,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'u00R',CO[0],UI,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,4)
endif
endif
if O2I==false and O7I==false then
if(JI)then
call CreateNUnitsAtLoc(NI,'esen',BO[0],B1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(NI,'e00V',BO[0],B1,bj_UNIT_FACING)
endif
call SVO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,2)
endif
if O6I==false then
if(KI)then
call CreateNUnitsAtLoc(NI,'esen',BO[0],O1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(NI,'e00V',BO[0],O1,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,3)
endif
if O2I==false and O4I==false then
if(LI)then
call CreateNUnitsAtLoc(NI,'esen',BO[0],A1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(NI,'e00V',BO[0],A1,bj_UNIT_FACING)
endif
call SZO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,4)
endif
if O2I==false and O7I==false then
if(WI)then
call CreateNUnitsAtLoc(SI,'edry',BO[0],E1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'e00W',BO[0],E1,bj_UNIT_FACING)
endif
call SVO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,2)
endif
if O6I==false then
if(XI)then
call CreateNUnitsAtLoc(SI,'edry',BO[0],C1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'e00W',BO[0],C1,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,3)
endif
if O2I==false and O4I==false then
if(YI)then
call CreateNUnitsAtLoc(SI,'edry',BO[0],D1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'e00W',BO[0],D1,bj_UNIT_FACING)
endif
call SZO(bj_lastCreatedGroup)
call SSO(bj_lastCreatedGroup,4)
endif
if SQO==true then
if O2I==false and O7I==false then
if(WI)then
call CreateNUnitsAtLoc(SI,'ebal',BO[0],E1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'e026',BO[0],E1,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,2)
endif
if O6I==false then
if(XI)then
call CreateNUnitsAtLoc(SI,'ebal',BO[0],C1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'e026',BO[0],C1,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,3)
endif
if O2I==false and O4I==false then
if(YI)then
call CreateNUnitsAtLoc(SI,'ebal',BO[0],D1,bj_UNIT_FACING)
else
call CreateNUnitsAtLoc(SI,'e026',BO[0],D1,bj_UNIT_FACING)
endif
call SSO(bj_lastCreatedGroup,4)
endif
endif
endfunction
function T0O takes nothing returns nothing
set EI=false
call DisableTrigger(VG)
call FL1("Rax"+I2S(0)+I2S(0)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),1)
endfunction
function T1O takes nothing returns nothing
set FI=false
call DisableTrigger(WG)
call FL1("Rax"+I2S(0)+I2S(1)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),1)
endfunction
function T2O takes nothing returns nothing
set GI=false
call DisableTrigger(XG)
call FL1("Rax"+I2S(0)+I2S(2)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),1)
endfunction
function T4O takes nothing returns nothing
set HI=false
call DisableTrigger(YG)
call FL1("Rax"+I2S(0)+I2S(0)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),2)
endfunction
function T6O takes nothing returns nothing
set ZI=false
call DisableTrigger(JG)
call FL1("Rax"+I2S(0)+I2S(1)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),2)
endfunction
function T8O takes nothing returns nothing
set VI=false
call DisableTrigger(KG)
call FL1("Rax"+I2S(0)+I2S(2)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),2)
endfunction
function TAO takes nothing returns nothing
set WI=false
call DisableTrigger(LG)
call FL1("Rax"+I2S(1)+I2S(0)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),1)
endfunction
function TCO takes nothing returns nothing
set XI=false
call DisableTrigger(MG)
call FL1("Rax"+I2S(1)+I2S(1)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),1)
endfunction
function TEO takes nothing returns nothing
set YI=false
call DisableTrigger(NG)
call FL1("Rax"+I2S(1)+I2S(2)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),1)
endfunction
function TGO takes nothing returns nothing
set JI=false
call DisableTrigger(SG)
call FL1("Rax"+I2S(1)+I2S(0)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),2)
endfunction
function TZO takes nothing returns nothing
set KI=false
call DisableTrigger(TG)
call FL1("Rax"+I2S(1)+I2S(1)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),2)
endfunction
function TWO takes nothing returns nothing
set LI=false
call DisableTrigger(RG)
call FL1("Rax"+I2S(1)+I2S(2)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R6I(GetKillingUnit(),2)
endfunction
function TYO takes nothing returns boolean
local real TJO=GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)/GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_LIFE)
if TJO<0.75 and S20==false then
set S20=true
call FL1("Tree",75)
endif
if TJO<0.50 and SO0==false then
set SO0=true
call FL1("Tree",50)
endif
if TJO<0.25 and S10==false then
set S10=true
call FL1("Tree",25)
endif
if TJO<0.10 and SI0==false then
set SI0=true
call FL1("Tree",10)
endif
return false
endfunction
function TKO takes nothing returns boolean
local real TJO=GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)/GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_LIFE)
if TJO<0.75 and S00==false then
set S00=true
call FL1("Throne",75)
endif
if TJO<0.50 and NU0==false then
set NU0=true
call FL1("Throne",50)
endif
if TJO<0.25 and NQ0==false then
set NQ0=true
call FL1("Throne",25)
endif
if TJO<0.10 and NP0==false then
set NP0=true
call FL1("Throne",10)
endif
return false
endfunction
function TMO takes nothing returns boolean
if(JI or KI or LI or WI or XI or YI)then
return false
endif
return true
endfunction
function TNO takes nothing returns nothing
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"近卫军团摧毁了天灾军团所有的生产建筑"+" "+"现在近卫军团的兵力将远远超过对手并会出动超级士兵")
call SetPlayerTechResearchedSwap('R00D',(GetPlayerTechCountSimple('R00D',BO[0])+30),BO[0])
call SetPlayerTechResearchedSwap('R00C',(GetPlayerTechCountSimple('R00C',BO[0])+30),BO[0])
call DisableTrigger(PG)
endfunction
function TTO takes nothing returns boolean
if(HI or ZI or VI or EI or FI or GI)then
return false
endif
return true
endfunction
function TRO takes nothing returns nothing
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"天灾军团摧毁了近卫军团所有的生产建筑"+" "+"现在天灾军团的兵力将远远超过对手并会出动超级士兵")
call SetPlayerTechResearchedSwap('R009',(GetPlayerTechCountSimple('R009',CO[0])+30),CO[0])
call SetPlayerTechResearchedSwap('R00B',(GetPlayerTechCountSimple('R00B',CO[0])+30),CO[0])
call DisableTrigger(QG)
endfunction
function TQO takes nothing returns nothing
call SetPlayerTechResearchedSwap('R007',(GetPlayerTechCountSimple('R007',BO[0])+1),BO[0])
call SetPlayerTechResearchedSwap('R00C',(GetPlayerTechCountSimple('R00C',BO[0])+1),BO[0])
call SetPlayerTechResearchedSwap('R008',(GetPlayerTechCountSimple('R008',BO[0])+1),BO[0])
call SetPlayerTechResearchedSwap('R00D',(GetPlayerTechCountSimple('R00D',BO[0])+1),BO[0])
call SetPlayerTechResearchedSwap('R009',(GetPlayerTechCountSimple('R009',CO[0])+1),CO[0])
call SetPlayerTechResearchedSwap('R003',(GetPlayerTechCountSimple('R003',CO[0])+1),CO[0])
call SetPlayerTechResearchedSwap('R00A',(GetPlayerTechCountSimple('R00A',CO[0])+1),CO[0])
call SetPlayerTechResearchedSwap('R00B',(GetPlayerTechCountSimple('R00B',CO[0])+1),CO[0])
endfunction
function R0O takes nothing returns nothing
local location BFO=GetRectCenter(Y5)
call RemoveUnit(CreateUnitAtLoc(DO,'nbdo',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nbds',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ngst',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'n026',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nggr',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nbdk',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nbwm',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nogm',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nomg',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nfpc',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nfpu',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nsth',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nstl',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nsat',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nwlg',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nkol',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nkob',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nkot',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ncnk',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ncen',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ngns',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nftb',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nfsh',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ngh1',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'npfl',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nowe',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nowb',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nmrm',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nmrr',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'nmrl',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ndtr',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'ndtw',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'n0LC',BFO,bj_UNIT_FACING))
call RemoveUnit(CreateUnitAtLoc(DO,'n0LD',BFO,bj_UNIT_FACING))
call RemoveLocation(BFO)
endfunction
function R1O takes integer ROO,integer G0O,integer R2O returns integer
local integer R3O=S30[ROO]
local integer R4O=GetRandomInt(G0O,R2O)
loop
exitwhen R3O!=R4O
set R4O=GetRandomInt(G0O,R2O)
endloop
set S30[ROO]=R4O
return R4O
endfunction
function R5O takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'n0HW',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'n0HX',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'n0HW',x,y,0),x,y)
endfunction
function R6O takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'njg1',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'njg1',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'njga',x,y,0),x,y)
endfunction
function R7O takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nbdo',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nbdo',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nbds',x,y,0),x,y)
endfunction
function R8O takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nbdk',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nbdk',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nbwm',x,y,0),x,y)
endfunction
function R9O takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'ngst',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'ngst',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nggr',x,y,0),x,y)
endfunction
function AncientLizards_AI takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
call IssueTargetOrder(GetTriggerUnit(),"unholyfrenzy",GetTriggerUnit())
return false
endfunction
function RAO takes real x,real y returns nothing
local unit u
set u=CreateUnit(DO,'n0LC',x,y,0)
call SetUnitPosition(u,x,y)
call SetUnitPosition(CreateUnit(DO,'n0LD',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'n0LD',x,y,0),x,y)
set u=null
endfunction
function RBO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nogm',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nogm',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nomg',x,y,0),x,y)
endfunction
function RCO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nfpc',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nfpu',x,y,0),x,y)
endfunction
function RDO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nsth',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nstl',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nsat',x,y,0),x,y)
endfunction
function REO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nstl',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nstl',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nsat',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nsat',x,y,0),x,y)
endfunction
function RFO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nwlg',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nwlg',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'n00S',x,y,0),x,y)
endfunction
function RGO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'n026',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'n026',x,y,0),x,y)
endfunction
function RHO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nkol',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nkob',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nkob',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nkob',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nkot',x,y,0),x,y)
endfunction
function RZO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nftb',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nftb',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nfsh',x,y,0),x,y)
endfunction
function RVO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'ncen',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'ncnk',x,y,0),x,y)
endfunction
function RWO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'ngns',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'ngns',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'ngns',x,y,0),x,y)
endfunction
function RXO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nftb',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nftb',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nkol',x,y,0),x,y)
endfunction
function RYO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'ngh1',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'npfl',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'npfl',x,y,0),x,y)
endfunction
function RJO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'nowe',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nowb',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'nowb',x,y,0),x,y)
endfunction
function RKO takes real x,real y returns nothing
call SetUnitPosition(CreateUnit(DO,'ndtr',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'ndtr',x,y,0),x,y)
call SetUnitPosition(CreateUnit(DO,'ndtw',x,y,0),x,y)
endfunction
function RLO takes real x,real y returns nothing
local integer MLI=R1O(3,1,5)
if MLI==1 then
call RCO(x,y)
elseif MLI==2 then
call RDO(x,y)
elseif MLI==3 then
call RJO(x,y)
elseif MLI==4 then
call RKO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function RMO takes real x,real y returns nothing
local integer MLI=R1O(12,1,5)
if MLI==1 then
call RCO(x,y)
elseif MLI==2 then
call RDO(x,y)
elseif MLI==3 then
call RJO(x,y)
elseif MLI==4 then
call RKO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function RNO takes real x,real y returns nothing
local integer MLI=R1O(4,1,5)
if MLI==1 then
call RCO(x,y)
elseif MLI==2 then
call RDO(x,y)
elseif MLI==3 then
call RJO(x,y)
elseif MLI==4 then
call RKO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function RSO takes real x,real y returns nothing
local integer MLI=R1O(9,1,5)
if MLI==1 then
call RCO(x,y)
elseif MLI==2 then
call RDO(x,y)
elseif MLI==3 then
call RJO(x,y)
elseif MLI==4 then
call RKO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function RTO takes real x,real y returns nothing
local integer MLI=R1O(6,1,6)
if MLI==1 then
call RYO(x,y)
elseif MLI==2 then
call RXO(x,y)
elseif MLI==3 then
call RWO(x,y)
elseif MLI==4 then
call RHO(x,y)
elseif MLI==5 then
call RZO(x,y)
elseif MLI==6 then
call R5O(x,y)
endif
endfunction
function RRO takes real x,real y returns nothing
local integer MLI=R1O(5,1,6)
if MLI==1 then
call RYO(x,y)
elseif MLI==2 then
call RXO(x,y)
elseif MLI==3 then
call RWO(x,y)
elseif MLI==4 then
call RHO(x,y)
elseif MLI==5 then
call RZO(x,y)
elseif MLI==6 then
call R5O(x,y)
endif
endfunction
function RPO takes real x,real y returns nothing
local integer MLI=R1O(7,1,5)
if MLI==1 then
call RGO(x,y)
elseif MLI==2 then
call RBO(x,y)
elseif MLI==3 then
call REO(x,y)
elseif MLI==4 then
call RFO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function RQO takes real x,real y returns nothing
local integer MLI=R1O(8,1,5)
if MLI==1 then
call RGO(x,y)
elseif MLI==2 then
call RBO(x,y)
elseif MLI==3 then
call REO(x,y)
elseif MLI==4 then
call RFO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function RUO takes real x,real y returns nothing
local integer MLI=R1O(10,1,5)
if MLI==1 then
call RGO(x,y)
elseif MLI==2 then
call RBO(x,y)
elseif MLI==3 then
call REO(x,y)
elseif MLI==4 then
call RFO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function P0O takes real x,real y returns nothing
local integer MLI=R1O(11,1,5)
if MLI==1 then
call RGO(x,y)
elseif MLI==2 then
call RBO(x,y)
elseif MLI==3 then
call REO(x,y)
elseif MLI==4 then
call RFO(x,y)
elseif MLI==5 then
call RVO(x,y)
endif
endfunction
function PIO takes real x,real y returns nothing
local integer MLI=R1O(1,1,5)
if MLI==1 then
call R6O(x,y)
elseif MLI==2 then
call R7O(x,y)
elseif MLI==3 then
call R8O(x,y)
elseif MLI==4 then
call R9O(x,y)
elseif MLI==5 then
call RAO(x,y)
endif
endfunction
function P1O takes real x,real y returns nothing
local integer MLI=R1O(2,1,5)
if MLI==1 then
call R6O(x,y)
elseif MLI==2 then
call R7O(x,y)
elseif MLI==3 then
call R8O(x,y)
elseif MLI==4 then
call R9O(x,y)
elseif MLI==5 then
call RAO(x,y)
endif
endfunction
function POO takes nothing returns nothing
if GetUnitAbilityLevel(GetEnumUnit(),'A0P4')!=0 then
call GroupRemoveUnit(B2,GetEnumUnit())
endif
if GetUnitTypeId(GetEnumUnit())=='o003' then
call GroupRemoveUnit(B2,GetEnumUnit())
endif
if GetUnitTypeId(GetEnumUnit())=='o01X' then
call GroupRemoveUnit(B2,GetEnumUnit())
endif
if IsUnitDead(GetEnumUnit())==true then
call GroupRemoveUnit(B2,GetEnumUnit())
endif
if RYI(GetEnumUnit())==true then
call GroupRemoveUnit(B2,GetEnumUnit())
endif
endfunction
function P2O takes group g returns boolean
set B2=g
call ForGroup(g,function POO)
return FirstOfGroup(g)==null
endfunction
function P3O takes nothing returns boolean
local group g
local rect r1
local rect r2
if O3I==false then
return false
endif
set r1=Q4
set r2=H4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call PIO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=U4
set r2=Z4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call P1O(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=I5
set r2=V4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RLO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=O5
set r2=W4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RNO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=A5
set r2=X4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RRO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=B5
set r2=Y4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RTO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=C5
set r2=J4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RPO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=E5
set r2=K4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RQO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=D5
set r2=L4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RSO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=F5
set r2=M4
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RUO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=Z5
set r2=V5
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call P0O(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=W5
set r2=X5
set g=NTI()
call GroupEnumUnitsInRect(g,r1,Condition(function N1I))
if P2O(g)then
call RMO(GetRectCenterX(r2),GetRectCenterY(r2))
endif
call NSI(g)
set r1=null
set r2=null
set g=null
return false
endfunction
function P5O takes nothing returns nothing
local integer TJI=GetRandomInt(1,9)
local location point
if O2I then
set TJI=GetRandomInt(1,3)
if TJI==1 then
set TJI=2
endif
if TJI==2 then
set TJI=5
endif
if TJI==3 then
set TJI=8
endif
endif
if(TJI==1)then
set point=GetRectCenter(TA)
call CreateNUnitsAtLoc(1,'n003',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一只|cff0000ff攻城傀儡|r现在效忠于|cffff0000近卫军团|r，向上路进发！")
call SSO(bj_lastCreatedGroup,4)
endif
if(TJI==2)then
set point=GetRectCenter(SA)
call CreateNUnitsAtLoc(1,'n003',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一只|cff0000ff攻城傀儡|r现在效忠于|cffff0000近卫军团|r，向中路进发！")
call SSO(bj_lastCreatedGroup,2)
endif
if(TJI==3)then
set point=GetRectCenter(NA)
call CreateNUnitsAtLoc(1,'n003',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一只|cff0000ff攻城傀儡|r现在效忠于|cffff0000近卫军团|r，向下路进发！")
call SSO(bj_lastCreatedGroup,3)
endif
if(TJI==4)then
set point=GetRectCenter(TA)
call CreateNUnitsAtLoc(1,'n00E',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一条|cff0000ff恐怖怪鱼|r现在效忠于|cffff0000近卫军团|r，向上路进发！")
call SSO(bj_lastCreatedGroup,4)
endif
if(TJI==5)then
set point=GetRectCenter(SA)
call CreateNUnitsAtLoc(1,'n00E',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一条|cff0000ff恐怖怪鱼|r现在效忠于|cffff0000近卫军团|r，向中路进发！")
call SSO(bj_lastCreatedGroup,2)
endif
if(TJI==6)then
set point=GetRectCenter(NA)
call CreateNUnitsAtLoc(1,'n00E',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一条|cff0000ff恐怖怪鱼|r现在效忠于|cffff0000近卫军团|r，向下路进发！")
call SSO(bj_lastCreatedGroup,3)
endif
if(TJI==7)and O2I==false then
set point=GetRectCenter(TA)
call CreateNUnitsAtLoc(1,'n00D',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一头|cff0000ff远古九头蛇|r现在效忠于|cffff0000近卫军团|r，向上路进发！")
call SSO(bj_lastCreatedGroup,4)
endif
if(TJI==8)and O2I==false then
set point=GetRectCenter(SA)
call CreateNUnitsAtLoc(1,'n00D',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一头|cff0000ff远古九头蛇|r现在效忠|cffff0000近卫军团|r，向中路进发！")
call SSO(bj_lastCreatedGroup,2)
endif
if(TJI==9)then
set point=GetRectCenter(NA)
call CreateNUnitsAtLoc(1,'n00D',BO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一头|cff0000ff远古九头蛇|r现在效忠于|cffff0000近卫军团|r，向下路进发！")
call SSO(bj_lastCreatedGroup,3)
endif
if(TJI==1)then
set point=GetRectCenter(LA)
call CreateNUnitsAtLoc(1,'n003',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一只|cff0000ff攻城傀儡|r现在效忠于|cff004000天灾军团|r，向上路进发！")
call SSO(bj_lastCreatedGroup,4)
endif
if(TJI==2)then
set point=GetRectCenter(KA)
call CreateNUnitsAtLoc(1,'n003',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一只|cff0000ff攻城傀儡|r现在效忠于|cff004000天灾军团|r，向中路进发！")
call SSO(bj_lastCreatedGroup,2)
endif
if(TJI==3)then
set point=GetRectCenter(MA)
call CreateNUnitsAtLoc(1,'n003',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一只|cff0000ff攻城傀儡|r现在效忠于|cff004000天灾军团|r，向下路进发！")
call SSO(bj_lastCreatedGroup,3)
endif
if(TJI==4)then
set point=GetRectCenter(LA)
call CreateNUnitsAtLoc(1,'n00E',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一条|cff0000ff恐怖怪鱼|r现在效忠于|cff004000天灾军团|r，向上路进发！")
call SSO(bj_lastCreatedGroup,4)
endif
if(TJI==5)then
set point=GetRectCenter(KA)
call CreateNUnitsAtLoc(1,'n00E',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一条|cff0000ff恐怖怪鱼|r现在效忠于|cff004000天灾军团|r，向中路进发！")
call SSO(bj_lastCreatedGroup,2)
endif
if(TJI==6)then
set point=GetRectCenter(MA)
call CreateNUnitsAtLoc(1,'n00E',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一条|cff0000ff恐怖怪鱼|r现在效忠于|cff004000天灾军团|r，向下路进发！")
call SSO(bj_lastCreatedGroup,3)
endif
if(TJI==7)then
set point=GetRectCenter(LA)
call CreateNUnitsAtLoc(1,'n00D',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一头|cff0000ff远古九头蛇|r现在效忠于|cff004000天灾军团|r，向上路进发！")
call SSO(bj_lastCreatedGroup,4)
endif
if(TJI==8)then
set point=GetRectCenter(KA)
call CreateNUnitsAtLoc(1,'n00D',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一头|cff0000ff远古九头蛇|r现在效忠于|cff004000天灾军团|r，向中路进发！")
call SSO(bj_lastCreatedGroup,2)
endif
if(TJI==9)then
set point=GetRectCenter(MA)
call CreateNUnitsAtLoc(1,'n00D',CO[0],point,bj_UNIT_FACING)
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"一头|cff0000ff远古九头蛇|r现在效忠于|cff004000天灾军团|r，向下路进发！")
call SSO(bj_lastCreatedGroup,3)
endif
endfunction
function P7O takes nothing returns nothing
local integer TGI
local integer THI
local integer P8O
local integer P9O
local integer i
local player p
set S60=S60+1
set S90=0
set SA0=0
set i=0
loop
exitwhen i>5
set p=BO[i]
if T5I(p)then
set S90=S90+1
endif
set p=CO[i]
if T5I(p)then
set SA0=SA0+1
endif
set i=i+1
endloop
if IN==false then
set L1=S90
set M1=SA0
endif
set TGI=1
set THI=5
set P8O=1
loop
exitwhen TGI>THI
set p=BO[TGI]
if T5I(p)then
set N1[P8O]=p
set P8O=P8O+1
endif
set TGI=TGI+1
endloop
set TGI=1
set THI=5
set P8O=1
loop
exitwhen TGI>THI
set p=CO[TGI]
if T5I(p)then
set S1[P8O]=p
set P8O=P8O+1
endif
set TGI=TGI+1
endloop
if S60==1 then
set M0=CreateMultiboardBJ(7+6,3+SA0+S90," ")
call MultiboardMinimize(M0,true)
endif
call N5I(M0,2,1,"CD")
call N5I(M0,3,1,"|c00838B8BL|r")
call N5I(M0,4,1,SB0+"K|r")
call N5I(M0,5,1,SD0+"D|r")
call N5I(M0,6,1,SE0+"A|r")
call N5I(M0,1,2,"近卫军团")
call N5I(M0,4,2,SB0+"0|r")
call N5I(M0,5,2,SD0+"0|r")
call N5I(M0,1,3+S90,"天灾军团")
call N5I(M0,4,3+S90,SB0+"0|r")
call N5I(M0,5,3+S90,SD0+"0|r")
call NEI(M0,1,2,(TSI(SubString(C0[GetPlayerId((BO[0]))],4,6)))/255.0*100,(TSI(SubString(C0[GetPlayerId((BO[0]))],6,8)))/255.0*100,(TSI(SubString(C0[GetPlayerId((BO[0]))],8,10)))/255.0*100,0)
call NEI(M0,1,3+S90,(TSI(SubString(C0[GetPlayerId((CO[0]))],4,6)))/255.0*100,(TSI(SubString(C0[GetPlayerId((CO[0]))],6,8)))/255.0*100,(TSI(SubString(C0[GetPlayerId((CO[0]))],8,10)))/255.0*100,0)
set TGI=1
set THI=3+SA0+S90
loop
exitwhen TGI>THI
call NVI(M0,1,TGI,10.8)
call NVI(M0,2,TGI,2)
call NVI(M0,3,TGI,2)
call NVI(M0,4,TGI,1.3)
call NVI(M0,5,TGI,1.3)
call NVI(M0,6,TGI,1.3)
call NVI(M0,7,TGI,2.5)
call NVI(M0,8,TGI,0.01)
call NVI(M0,9,TGI,0.01)
call NVI(M0,10,TGI,0.01)
call NVI(M0,11,TGI,0.01)
call NVI(M0,12,TGI,0.01)
call NVI(M0,13,TGI,0.01)
set TGI=TGI+1
endloop
set TGI=1
set THI=7+6
loop
exitwhen TGI>THI
set P8O=1
set P9O=3+SA0+S90
loop
exitwhen P8O>P9O
call NBI(M0,TGI,P8O,true,false)
set P8O=P8O+1
endloop
set TGI=TGI+1
endloop
set TGI=1
set THI=S90
loop
exitwhen TGI>THI
call NBI(M0,1,TGI+2,true,true)
call NEI(M0,7,TGI+2,255,204,0,0)
set S40[GetPlayerId(N1[TGI])]=1-1
set S50[GetPlayerId(N1[TGI])]=TGI+2-1
call N5I(M0,1,TGI+2,(D80[GetPlayerId((N1[TGI]))]))
if T3I(N1[TGI])then
call NEI(M0,1,TGI+2,(TSI(SubString(C0[GetPlayerId((N1[TGI]))],4,6)))/255.0*100,(TSI(SubString(C0[GetPlayerId((N1[TGI]))],6,8)))/255.0*100,(TSI(SubString(C0[GetPlayerId((N1[TGI]))],8,10)))/255.0*100,0)
call NEI(M0,2,TGI+2,(TSI(SubString(C0[GetPlayerId((N1[TGI]))],4,6)))/255.0*100,(TSI(SubString(C0[GetPlayerId((N1[TGI]))],6,8)))/255.0*100,(TSI(SubString(C0[GetPlayerId((N1[TGI]))],8,10)))/255.0*100,0)
else
call N5I(M0,1,TGI+2,"|c00333333"+(D80[GetPlayerId((N1[TGI]))])+"|r")
endif
call N5I(M0,4,(TGI+2),SB0+"0|r")
call N5I(M0,5,(TGI+2),SD0+"0|r")
call N5I(M0,6,(TGI+2),SE0+"0|r")
set TGI=TGI+1
endloop
set TGI=1
set THI=SA0
loop
exitwhen TGI>THI
call NBI(M0,1,TGI+3+S90,true,true)
call NEI(M0,7,TGI+3+S90,255,204,0,0)
set S40[GetPlayerId(S1[TGI])]=1-1
set S50[GetPlayerId(S1[TGI])]=TGI+3+S90-1
call N5I(M0,1,TGI+3+S90,(D80[GetPlayerId((S1[TGI]))]))
if T3I(S1[TGI])then
call NEI(M0,1,TGI+3+S90,(TSI(SubString(C0[GetPlayerId((S1[TGI]))],4,6)))/255.0*100,(TSI(SubString(C0[GetPlayerId((S1[TGI]))],6,8)))/255.0*100,(TSI(SubString(C0[GetPlayerId((S1[TGI]))],8,10)))/255.0*100,0)
call NEI(M0,2,TGI+3+S90,(TSI(SubString(C0[GetPlayerId((S1[TGI]))],4,6)))/255.0*100,(TSI(SubString(C0[GetPlayerId((S1[TGI]))],6,8)))/255.0*100,(TSI(SubString(C0[GetPlayerId((S1[TGI]))],8,10)))/255.0*100,0)
else
call N5I(M0,1,TGI+3+S90,"|c00333333"+(D80[GetPlayerId((S1[TGI]))])+"|r")
endif
call N5I(M0,4,(TGI+3+S90),SB0+"0|r")
call N5I(M0,5,(TGI+3+S90),SD0+"0|r")
call N5I(M0,6,(TGI+3+S90),SE0+"0|r")
set TGI=TGI+1
endloop
set S70=1
set S80=3+SA0+S90-2
if C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70)and S60==1 then
call MultiboardDisplay(M0,false)
endif
call NBI(M0,7,1,false,true)
call N9I(M0,7,1,"UI\\Feedback\\Resources\\ResourceGold.blp")
call UR1()
if S60>1 then
call TriggerExecute(CH)
endif
endfunction
function PAO takes nothing returns nothing
local integer TGI
local integer THI
call N5I(M0,4,2,SB0+I2S(I[GetPlayerId(BO[0])])+"|r")
call N5I(M0,5,2,SD0+I2S(O[GetPlayerId(BO[0])])+"|r")
call N5I(M0,4,3+S90,SB0+I2S(I[GetPlayerId(CO[0])])+"|r")
call N5I(M0,5,3+S90,SD0+I2S(O[GetPlayerId(CO[0])])+"|r")
set TGI=1
set THI=S90
loop
exitwhen TGI>THI
call N5I(M0,4,(TGI+2),SB0+I2S(I[GetPlayerId(N1[TGI])])+"|r")
call N5I(M0,5,(TGI+2),SD0+I2S(O[GetPlayerId(N1[TGI])])+"|r")
call N5I(M0,6,(TGI+2),SE0+I2S(D[GetPlayerId(N1[TGI])])+"|r")
set TGI=TGI+1
endloop
set TGI=1
set THI=SA0
loop
exitwhen TGI>THI
call N5I(M0,4,(TGI+3+S90),SB0+I2S(I[GetPlayerId(S1[TGI])])+"|r")
call N5I(M0,5,(TGI+3+S90),SD0+I2S(O[GetPlayerId(S1[TGI])])+"|r")
call N5I(M0,6,(TGI+3+S90),SE0+I2S(D[GetPlayerId(S1[TGI])])+"|r")
set TGI=TGI+1
endloop
endfunction
function PCO takes nothing returns boolean
if(GetUnitTypeId(GetTriggerUnit())=='e00R')then
return true
endif
if(GetUnitTypeId(GetTriggerUnit())=='e011')then
return true
endif
if(GetUnitTypeId(GetTriggerUnit())=='e00S')then
return true
endif
if(GetUnitTypeId(GetTriggerUnit())=='e019')then
return true
endif
return false
endfunction
function PDO takes nothing returns nothing
set G0[1]=(G0[1]+1)
endfunction
function PFO takes nothing returns boolean
if(GetUnitTypeId(GetTriggerUnit())=='u00M')then
return true
endif
if(GetUnitTypeId(GetTriggerUnit())=='u00D')then
return true
endif
if(GetUnitTypeId(GetTriggerUnit())=='u00N')then
return true
endif
if(GetUnitTypeId(GetTriggerUnit())=='u00T')then
return true
endif
return false
endfunction
function PGO takes nothing returns nothing
set G0[2]=(G0[2]+1)
endfunction
function PZO takes integer a returns integer
local integer i=0
local integer x=0
local string s=I2S(a)
loop
exitwhen i>StringLength(s)
if SubString(s,i,i+1)=="1"then
set x=x+1
endif
set i=i+1
endloop
return x
endfunction
function PVO takes player T4I,integer PWO returns string
if IsPlayerAlly(GetLocalPlayer(),T4I)==true then
return F21(UnitItemInSlot(K1[GetPlayerId(T4I)],PWO-1))
else
return"UI\\Widgets\\Console\\Undead\\undead-inventory-slotfiller.blp"
endif
endfunction
function PXO takes nothing returns nothing
local integer TGI
local integer THI
local string GW1
local real QHI
local string s1=" "
local integer r
local integer i
local integer array time_1a
local string array color_1a
local integer index_1a=0
local integer array time_1b
local string array color_1b
local integer index_1b=0
local integer x=0
local integer id
local string PYO
local string PJO
local string PKO
local string PLO
local string PMO
local string s2=" "
local string s
local real PNO
local string spacer
local integer PSO=0
local string PTO=""
local string PRO=""
local integer PPO=0
local integer PQO=0
local string PUO=""
if M0==null then
return
endif
set i=1
loop
exitwhen i>5
set r=R2I(TimerGetRemaining(F0[GetPlayerId(BO[i])]))
if r>0 then
set PSO=PSO+PZO(r)
if PPO==0 then
if r<10 then
set PTO=C0[GetPlayerId(BO[i])]+"0"+I2S(r)+" |r"
else
set PTO=C0[GetPlayerId(BO[i])]+I2S(r)+" |r"
endif
else
if r<10 then
set PTO=PTO+SF0+"| |r"+C0[GetPlayerId(BO[i])]+"0"+I2S(r)+" |r"
else
set PTO=PTO+SF0+"| |r"+C0[GetPlayerId(BO[i])]+I2S(r)+" |r"
endif
endif
set PPO=PPO+1
endif
set i=i+1
endloop
if PPO>0 then
if IsPlayerAlly(GetLocalPlayer(),BO[0])==true then
set PTO=SF0+"["+"友方："+" |r"+PTO+SF0+"]|r"
else
set PTO=SC0+"["+"敌方："+" |r"+PTO+SC0+"]|r"
endif
endif
set i=1
loop
exitwhen i>5
set r=R2I(TimerGetRemaining(F0[GetPlayerId(CO[i])]))
if r>0 then
set PSO=PSO+PZO(r)
if PQO==0 then
if r<10 then
set PRO=C0[GetPlayerId(CO[i])]+"0"+I2S(r)+" |r"
else
set PRO=C0[GetPlayerId(CO[i])]+I2S(r)+" |r"
endif
else
if r<10 then
set PRO=PRO+SF0+"| |r"+C0[GetPlayerId(CO[i])]+"0"+I2S(r)+" |r"
else
set PRO=PRO+SF0+"| |r"+C0[GetPlayerId(CO[i])]+I2S(r)+" |r"
endif
endif
set PQO=PQO+1
endif
set i=i+1
endloop
if PQO>0 then
if IsPlayerAlly(GetLocalPlayer(),CO[0])==true then
set PRO=SF0+"["+"友方："+" |r"+PRO+SF0+"]|r"
else
set PRO=SC0+"["+"敌方："+" |r"+PRO+SC0+"]|r"
endif
endif
if M0!=null then
set id=GetPlayerId(GetLocalPlayer())
if id>=0 and id<16 then
if VM[x]then
set PYO=I2S(I[id])
set PJO=I2S(O[id])
set PKO=I2S(D[id])
set PLO=I2S(A[id])
set PMO=I2S(B[id])
set s2=" |c00838B8B("+PYO+"/"+PJO+"/"+PKO+" - "+PLO+"/"+PMO+" - |r|c00FFDC00"+I2S(EL0[id])+"|r |c00838B8B)|r"
endif
endif
endif
if PQO==0 and PPO==0 then
call MultiboardSetTitleText(M0,s2)
else
if IsPlayerAlly(GetLocalPlayer(),BO[0])==true then
call MultiboardSetTitleText(M0,PRO+" "+PTO+" "+s2)
else
call MultiboardSetTitleText(M0,PTO+" "+PRO+" "+s2)
endif
endif
if(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))==false then
call MultiboardDisplay(M0,true)
endif
if P20[GetPlayerId(GetLocalPlayer())]==false then
call SetWaterBaseColor(0,0,255,255)
endif
set TGI=1
set THI=S90
loop
exitwhen TGI>THI
call N9I(M0,1,TGI+2,SAI(K1[GetPlayerId(N1[TGI])]))
call N5I(M0,3,TGI+2,"|c00838B8B"+I2S(GetHeroLevel(K1[GetPlayerId(N1[TGI])]))+"|r")
if RQ0[GetPlayerId(GetLocalPlayer())]then
call NVI(M0,7,1,3)
call NVI(M0,8,1,2.8)
call NVI(M0,9,1,0.8)
call NVI(M0,10,1,0.8)
call NVI(M0,11,1,0.8)
call NVI(M0,12,1,0.8)
call NVI(M0,13,1,0.1)
call NVI(M0,7,TGI+2,3)
call NVI(M0,8,TGI+2,1.1)
call NVI(M0,9,TGI+2,1.1)
call NVI(M0,10,TGI+2,1.1)
call NVI(M0,11,TGI+2,1.1)
call NVI(M0,12,TGI+2,1.1)
call NVI(M0,13,TGI+2,0.1)
call NBI(M0,8,TGI+2,false,true)
call NBI(M0,9,TGI+2,false,true)
call NBI(M0,10,TGI+2,false,true)
call NBI(M0,11,TGI+2,false,true)
call NBI(M0,12,TGI+2,false,true)
call NBI(M0,13,TGI+2,false,true)
call N5I(M0,8,1,"Items")
else
call NVI(M0,7,1,2)
call NVI(M0,8,1,0.1)
call NVI(M0,9,1,0.1)
call NVI(M0,10,1,0.1)
call NVI(M0,11,1,0.1)
call NVI(M0,12,1,0.1)
call NVI(M0,13,1,0.1)
call NVI(M0,7,TGI+2,2.5)
call NVI(M0,8,TGI+2,0.1)
call NVI(M0,9,TGI+2,0.1)
call NVI(M0,10,TGI+2,0.1)
call NVI(M0,11,TGI+2,0.1)
call NVI(M0,12,TGI+2,0.1)
call NVI(M0,13,TGI+2,0.1)
call NBI(M0,8,TGI+2,false,false)
call NBI(M0,9,TGI+2,false,false)
call NBI(M0,10,TGI+2,false,false)
call NBI(M0,11,TGI+2,false,false)
call NBI(M0,12,TGI+2,false,false)
call NBI(M0,13,TGI+2,false,false)
call N5I(M0,8,1," ")
endif
call N9I(M0,8,TGI+2,PVO(N1[TGI],1))
call N9I(M0,9,TGI+2,PVO(N1[TGI],2))
call N9I(M0,10,TGI+2,PVO(N1[TGI],3))
call N9I(M0,11,TGI+2,PVO(N1[TGI],4))
call N9I(M0,12,TGI+2,PVO(N1[TGI],5))
call N9I(M0,13,TGI+2,PVO(N1[TGI],6))
if(SVI(K1[GetPlayerId(N1[TGI])])and K1[GetPlayerId(N1[TGI])]!=null and TimerGetRemaining(F0[GetPlayerId(N1[TGI])])>0)then
if IsPlayerAlly(GetLocalPlayer(),N1[TGI])then
set PUO=SF0+" ("+(I2S(R2I(TimerGetRemaining(F0[GetPlayerId(N1[TGI])]))))+")|r"
else
set PUO=SC0+" ("+(I2S(R2I(TimerGetRemaining(F0[GetPlayerId(N1[TGI])]))))+")|r"
endif
else
set PUO="  "
endif
if EF0[GetPlayerId(N1[TGI])]then
call N5I(M0,1,TGI+2,"|c00333333"+(D80[GetPlayerId((N1[TGI]))])+"|r"+PUO)
else
call N5I(M0,1,TGI+2,(D80[GetPlayerId((N1[TGI]))])+PUO)
endif
set PNO=(TimerGetRemaining(EJ0[GetPlayerId((N1[TGI]))]))
if PNO>0 then
set s=I2S(R2I(PNO))
else
set s=" "
endif
if IsPlayerAlly(GetLocalPlayer(),N1[TGI])==false then
call N5I(M0,7,TGI+2," ")
set s=" "
else
call N5I(M0,7,TGI+2,"|cffffcc00"+I2S(R2I(GetPlayerState(N1[TGI],PLAYER_STATE_RESOURCE_GOLD)))+"|r")
endif
call N5I(M0,2,TGI+2,s)
set TGI=TGI+1
endloop
set TGI=1
set THI=SA0
loop
exitwhen TGI>THI
call N9I(M0,1,TGI+3+S90,SAI(K1[GetPlayerId(S1[TGI])]))
call N5I(M0,3,TGI+3+S90,"|c00838B8B"+I2S(GetHeroLevel(K1[GetPlayerId(S1[TGI])]))+"|r")
if RQ0[GetPlayerId(GetLocalPlayer())]then
call NVI(M0,7,1,3)
call NVI(M0,8,1,2.8)
call NVI(M0,9,1,0.8)
call NVI(M0,10,1,0.8)
call NVI(M0,11,1,0.8)
call NVI(M0,12,1,0.8)
call NVI(M0,13,1,0.1)
call NVI(M0,7,TGI+3+S90,3)
call NVI(M0,8,TGI+3+S90,1.1)
call NVI(M0,9,TGI+3+S90,1.1)
call NVI(M0,10,TGI+3+S90,1.1)
call NVI(M0,11,TGI+3+S90,1.1)
call NVI(M0,12,TGI+3+S90,1.1)
call NVI(M0,13,TGI+3+S90,0.1)
call NBI(M0,8,TGI+3+S90,false,true)
call NBI(M0,9,TGI+3+S90,false,true)
call NBI(M0,10,TGI+3+S90,false,true)
call NBI(M0,11,TGI+3+S90,false,true)
call NBI(M0,12,TGI+3+S90,false,true)
call NBI(M0,13,TGI+3+S90,false,true)
call N5I(M0,8,1,"Items")
else
call NVI(M0,7,1,2)
call NVI(M0,8,1,0.1)
call NVI(M0,9,1,0.1)
call NVI(M0,10,1,0.1)
call NVI(M0,11,1,0.1)
call NVI(M0,12,1,0.1)
call NVI(M0,13,1,0.1)
call NVI(M0,7,TGI+3+S90,2.5)
call NVI(M0,8,TGI+3+S90,0.1)
call NVI(M0,9,TGI+3+S90,0.1)
call NVI(M0,10,TGI+3+S90,0.1)
call NVI(M0,11,TGI+3+S90,0.1)
call NVI(M0,12,TGI+3+S90,0.1)
call NVI(M0,13,TGI+3+S90,0.1)
call NBI(M0,8,TGI+3+S90,false,false)
call NBI(M0,9,TGI+3+S90,false,false)
call NBI(M0,10,TGI+3+S90,false,false)
call NBI(M0,11,TGI+3+S90,false,false)
call NBI(M0,12,TGI+3+S90,false,false)
call NBI(M0,13,TGI+3+S90,false,false)
call N5I(M0,8,1," ")
endif
call N9I(M0,8,TGI+3+S90,PVO(S1[TGI],1))
call N9I(M0,9,TGI+3+S90,PVO(S1[TGI],2))
call N9I(M0,10,TGI+3+S90,PVO(S1[TGI],3))
call N9I(M0,11,TGI+3+S90,PVO(S1[TGI],4))
call N9I(M0,12,TGI+3+S90,PVO(S1[TGI],5))
call N9I(M0,13,TGI+3+S90,PVO(S1[TGI],6))
if(SVI(K1[GetPlayerId(S1[TGI])])and K1[GetPlayerId(S1[TGI])]!=null and TimerGetRemaining(F0[GetPlayerId(S1[TGI])])>0)then
if IsPlayerAlly(GetLocalPlayer(),S1[TGI])then
set PUO=SF0+" ("+(I2S(R2I(TimerGetRemaining(F0[GetPlayerId(S1[TGI])]))))+")|r"
else
set PUO=SC0+" ("+(I2S(R2I(TimerGetRemaining(F0[GetPlayerId(S1[TGI])]))))+")|r"
endif
else
set PUO="  "
endif
if EF0[GetPlayerId(S1[TGI])]then
call N5I(M0,1,TGI+3+S90,"|c00333333"+(D80[GetPlayerId((S1[TGI]))])+"|r"+PUO)
else
call N5I(M0,1,TGI+3+S90,(D80[GetPlayerId((S1[TGI]))])+PUO)
endif
set PNO=(TimerGetRemaining(EJ0[GetPlayerId((S1[TGI]))]))
if PNO>0 then
set s=I2S(R2I(PNO))
else
set s=" "
endif
if IsPlayerAlly(GetLocalPlayer(),S1[TGI])==false then
call N5I(M0,7,TGI+3+S90," ")
set s=" "
else
call N5I(M0,7,TGI+3+S90,"|cffffcc00"+I2S(R2I(GetPlayerState(S1[TGI],PLAYER_STATE_RESOURCE_GOLD)))+"|r")
endif
call N5I(M0,2,TGI+3+S90,s)
set TGI=TGI+1
endloop
endfunction
function Trig_CS_Board_Actions takes nothing returns nothing
set GO[GetPlayerId(BO[1])]=CreateLeaderboard()
set GO[GetPlayerId(BO[2])]=CreateLeaderboard()
set GO[GetPlayerId(BO[3])]=CreateLeaderboard()
set GO[GetPlayerId(BO[4])]=CreateLeaderboard()
set GO[GetPlayerId(BO[5])]=CreateLeaderboard()
set GO[GetPlayerId(CO[1])]=CreateLeaderboard()
set GO[GetPlayerId(CO[2])]=CreateLeaderboard()
set GO[GetPlayerId(CO[3])]=CreateLeaderboard()
set GO[GetPlayerId(CO[4])]=CreateLeaderboard()
set GO[GetPlayerId(CO[5])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[1],GO[GetPlayerId(BO[1])])
call PlayerSetLeaderboard(BO[2],GO[GetPlayerId(BO[2])])
call PlayerSetLeaderboard(BO[3],GO[GetPlayerId(BO[3])])
call PlayerSetLeaderboard(BO[4],GO[GetPlayerId(BO[4])])
call PlayerSetLeaderboard(BO[5],GO[GetPlayerId(BO[5])])
call PlayerSetLeaderboard(CO[1],GO[GetPlayerId(CO[1])])
call PlayerSetLeaderboard(CO[2],GO[GetPlayerId(CO[2])])
call PlayerSetLeaderboard(CO[3],GO[GetPlayerId(CO[3])])
call PlayerSetLeaderboard(CO[4],GO[GetPlayerId(CO[4])])
call PlayerSetLeaderboard(CO[5],GO[GetPlayerId(CO[5])])
call LeaderboardDisplay(GO[GetPlayerId(BO[1])],false)
call LeaderboardDisplay(GO[GetPlayerId(BO[2])],false)
call LeaderboardDisplay(GO[GetPlayerId(BO[3])],false)
call LeaderboardDisplay(GO[GetPlayerId(BO[4])],false)
call LeaderboardDisplay(GO[GetPlayerId(BO[5])],false)
call LeaderboardDisplay(GO[GetPlayerId(CO[1])],false)
call LeaderboardDisplay(GO[GetPlayerId(CO[2])],false)
call LeaderboardDisplay(GO[GetPlayerId(CO[3])],false)
call LeaderboardDisplay(GO[GetPlayerId(CO[4])],false)
call LeaderboardDisplay(GO[GetPlayerId(CO[5])],false)
call LeaderboardSetLabelBJ(GO[GetPlayerId(BO[1])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(BO[2])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(BO[3])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(BO[4])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(BO[5])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(CO[1])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(CO[2])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(CO[3])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(CO[4])],"Creep Kills: 0 Denies: 0")
call LeaderboardSetLabelBJ(GO[GetPlayerId(CO[5])],"Creep Kills: 0 Denies: 0")
endfunction
function EndScore_GameMode takes nothing returns string
return EL
endfunction
function EndScore_GetWinner takes nothing returns string
return J3
endfunction
function Q1O takes player T4I returns string
return C0[GetPlayerId(T4I)]+(D80[GetPlayerId((T4I))])+"|r"
endfunction
function QOO takes player T4I returns string
local string Q2O=I2S(FB0[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function Q4O takes player T4I returns string
local string Q2O=I2S(FA0[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function VM1 takes nothing returns nothing
local integer i=1
local multiboarditem N8I
loop
exitwhen i>SW0
if(K3[GetPlayerId((SV0[i]))])!="Here"then
set N8I=MultiboardGetItem(SG0,SH0[i],SZ0[i])
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c00555555"+(K3[GetPlayerId((SV0[i]))])+"|r")
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
endif
set i=i+1
endloop
endfunction
function Q5O takes player T4I returns string
local string Q2O=I2S(GetPlayerState(T4I,PLAYER_STATE_RESOURCE_GOLD))
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function Q6O takes player T4I returns string
local string Q2O=I2S(E[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function Q7O takes player T4I returns string
local string Q2O=I2S(GetUnitLevel(K1[GetPlayerId(T4I)]))
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function Q8O takes player T4I returns string
local string Q2O=I2S(F[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function Q9O takes player T4I returns string
local string Q2O=I2S(Y[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QAO takes player T4I returns string
local string Q2O=I2S(G[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QBO takes player T4I returns string
local string Q2O=I2S(D[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QCO takes player T4I returns string
local string Q2O=I2S(I[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QDO takes player T4I returns string
local string Q2O=I2S(O[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QEO takes player T4I returns string
local string Q2O=I2S(A[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QFO takes player T4I returns string
local string Q2O=I2S(B[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QGO takes player T4I returns string
local string Q2O=I2S((LoadInteger(LY,(400+GetPlayerId(T4I)),(79))))
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QHO takes player T4I returns string
local string Q2O=I2S(Z[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QZO takes player T4I returns string
local string Q2O=I2S(V[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QVO takes player T4I returns string
local string Q2O=I2S(H[GetPlayerId(T4I)])
local string Q3O=Q2O
if T4I==GetLocalPlayer()then
set Q3O=SX0+Q2O+"|r"
endif
return Q3O
endfunction
function QWO takes player T4I returns string
local string QXO
local string QYO
local string Q3O
local integer k=J[GetPlayerId(T4I)]
local integer d=X[GetPlayerId(T4I)]
if k<1 then
set k=0
endif
if d<1 then
set d=0
endif
set QXO=I2S(k)
set QYO=I2S(d)
set Q3O=QXO+"/"+QYO
if T4I==GetLocalPlayer()then
set Q3O=SX0+QXO+"|r/"+SX0+QYO+"|r"
endif
return Q3O
endfunction
function QJO takes player T4I returns string
local integer QKO=W[GetPlayerId(T4I)]
local string GW1
local integer BX1
local integer BY1
set BX1=(QKO/60)-(1/2)
set BY1=ModuloInteger(QKO,60)
if(BY1<10)then
set GW1=I2S(BX1)+":0"+I2S(BY1)
else
set GW1=I2S(BX1)+":"+I2S(BY1)
endif
if T4I==GetLocalPlayer()then
set GW1=SX0+GW1+"|r"
endif
return GW1
endfunction
function QLO takes player hero,player target returns string
local string QXO
local string QYO
local string Q3O
local integer k=(LoadInteger(LY,(400+GetPlayerId(hero)),(450+GetPlayerId(target))))
local integer d=(LoadInteger(LY,(400+GetPlayerId(hero)),(500+GetPlayerId(target))))
if k<1 then
set k=0
endif
if d<1 then
set d=0
endif
set QXO=I2S(k)
set QYO=I2S(d)
set Q3O=QXO+"/"+QYO
if hero==GetLocalPlayer()then
set Q3O=SX0+QXO+"|r/"+SX0+QYO+"|r"
endif
return Q3O
endfunction
function EndScore_AllKD takes nothing returns string
return"|c00ff0303"+I2S(I[GetPlayerId(BO[0])])+"|r/|c0020c000"+I2S(O[GetPlayerId(BO[0])])+"|r"
endfunction
function QMO takes nothing returns nothing
local integer QNO=S90
local integer QSO=SA0
local player array QTO
local player array QRO
local integer QPO
local integer QQO
local integer QUO=21+QAI(QNO,QSO)+1
local integer U0O=1+(QNO+QSO)*2
local multiboarditem N8I
local integer i
local integer x
local integer curRow1
local integer curRow2
local string e="|r"
local string c0="|cff99ccff"
local integer UIO
local integer U1O
call DisableTrigger(FH)
call DestroyMultiboard(M0)
if QNO>0 and QSO>0 then
set QUO=QUO+2
endif
set SG0=CreateMultiboard()
call MultiboardSetItemsWidth(SG0,0)
call MultiboardSetRowCount(SG0,QUO)
call MultiboardSetColumnCount(SG0,U0O)
call MultiboardSetTitleText(SG0,"DotA 记分板"+" "+" - "+(EL))
call MultiboardMinimize(SG0,true)
call MultiboardSetItemsStyle(SG0,false,false)
call MultiboardDisplay(SG0,true)
call MultiboardMinimize(SG0,false)
call MultiboardSetTitleText(SG0,"DotA 记分板"+" "+" - "+(EL)+" - "+("|c00ff0303"+I2S(I[GetPlayerId(BO[0])])+"|r/|c0020c000"+I2S(O[GetPlayerId(BO[0])])+"|r"))
set x=1
set i=1
loop
exitwhen i>5
if T3I(BO[i])or GetPlayerSlotState(BO[i])==PLAYER_SLOT_STATE_LEFT then
set QTO[x]=BO[i]
set x=x+1
endif
set i=i+1
endloop
set x=1
set i=1
loop
exitwhen i>5
if T3I(CO[i])or GetPlayerSlotState(CO[i])==PLAYER_SLOT_STATE_LEFT then
set QRO[x]=CO[i]
set x=x+1
endif
set i=i+1
endloop
set i=0
set QQO=0
loop
exitwhen i>QUO
set N8I=MultiboardGetItem(SG0,i,QQO)
call MultiboardSetItemWidth(N8I,0.075)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=0
set QQO=0
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I," ")
call MultiboardReleaseItem(N8I)
set QQO=0
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,false)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q1O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q1O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,false)
call MultiboardReleaseItem(N8I)
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemValue(N8I,Q7O(QTO[i]))
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemValue(N8I,Q7O(QRO[i]))
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"物品"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(1)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(2)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(1)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(2)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+" "+e)
call MultiboardReleaseItem(N8I)
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(3)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(4)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(3)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(4)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+" "+e)
call MultiboardReleaseItem(N8I)
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(5)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(6)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(5)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(6)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"现有金钱"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q5O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q5O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"击杀/死亡/助攻"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QCO(QTO[i])+"/"+QDO(QTO[i])+"/"+QBO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QCO(QRO[i])+"/"+QDO(QRO[i])+"/"+QBO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"补兵数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QEO(QTO[i])+"/"+QFO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QEO(QRO[i])+"/"+QFO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"额外黄金"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QOO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QOO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"额外经验"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q4O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q4O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"购买守卫"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q8O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q8O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"拆塔数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QWO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QWO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"杀野数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QGO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QGO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"击杀英雄奖励"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q9O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q9O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"死亡累计时间"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QJO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QJO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"死亡损失金钱"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QAO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QAO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"消耗品"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q6O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q6O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"双杀次数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QHO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QHO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"三杀次数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QZO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QZO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"最高连杀数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QVO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QVO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
if QNO>0 and QSO>0 then
set QQO=0
set UIO=QPO
set U1O=QQO
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"击杀细节"+e)
call MultiboardReleaseItem(N8I)
set QPO=UIO
set x=1
loop
exitwhen x>QNO
set QQO=0
set QPO=UIO
set i=1
loop
exitwhen i>QSO
set QQO=x+(x-1)
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[x]))])))
call MultiboardSetItemWidth(N8I,0.01)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[i]))])))
call MultiboardSetItemValue(N8I," "+QLO(QTO[x],QRO[i]))
call MultiboardSetItemWidth(N8I,0.059)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set x=x+1
endloop
set x=QNO+1
loop
exitwhen x>(QSO+QNO)
set QQO=0
set QPO=UIO
set i=1
loop
exitwhen i>QNO
set QQO=x+(x-1)
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[x-QNO]))])))
call MultiboardSetItemWidth(N8I,0.01)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[i]))])))
call MultiboardSetItemValue(N8I," "+QLO(QRO[x-QNO],QTO[i]))
call MultiboardSetItemWidth(N8I,0.059)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set x=x+1
endloop
endif
set QPO=QPO+1
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"离开于："+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(K3[GetPlayerId((QTO[i]))]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set SW0=SW0+1
set SH0[SW0]=QPO
set SZ0[SW0]=QQO
set SV0[SW0]=QTO[i]
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(K3[GetPlayerId((QRO[i]))]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set SW0=SW0+1
set SH0[SW0]=QPO
set SZ0[SW0]=QQO
set SV0[SW0]=QRO[i]
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SG0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"胜利者"+e)
call MultiboardReleaseItem(N8I)
set N8I=MultiboardGetItem(SG0,QPO,QQO+1)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(J3))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
call MultiboardMinimize(SG0,true)
call MultiboardMinimize(SG0,false)
endfunction
function ObsBoard_GameMode takes nothing returns string
return EL
endfunction
function U2O takes player T4I returns string
return C0[GetPlayerId(T4I)]+(D80[GetPlayerId((T4I))])+"|r"
endfunction
function U3O takes player T4I returns string
local integer k=J[GetPlayerId(T4I)]
local integer d=X[GetPlayerId(T4I)]
if k<1 then
set k=0
endif
if d<1 then
set d=0
endif
return I2S(k)+"/"+I2S(d)
endfunction
function U4O takes player T4I returns string
local integer QKO=W[GetPlayerId(T4I)]
local string GW1
local integer BX1
local integer BY1
set BX1=(QKO/60)-(1/2)
set BY1=ModuloInteger(QKO,60)
if(BY1<10)then
set GW1=I2S(BX1)+":0"+I2S(BY1)
else
set GW1=I2S(BX1)+":"+I2S(BY1)
endif
return GW1
endfunction
function U5O takes player hero,player target returns string
local integer k=(LoadInteger(LY,(400+GetPlayerId(hero)),(450+GetPlayerId(target))))
local integer d=(LoadInteger(LY,(400+GetPlayerId(hero)),(500+GetPlayerId(target))))
if k<1 then
set k=0
endif
if d<1 then
set d=0
endif
return I2S(k)+"/"+I2S(d)
endfunction
function U6O takes player hero returns string
local string U7O
if IsUnitDead(K1[GetPlayerId(hero)])then
set U7O=I2S(R2I(TimerGetRemaining(F0[GetPlayerId(hero)])))
else
set U7O=" "
endif
return U7O
endfunction
function U8O takes player hero returns string
local real r=(TimerGetRemaining(EJ0[GetPlayerId((hero))]))
local string U7O
if r>0 then
set U7O=I2S(R2I(r))
else
set U7O=" "
endif
return U7O
endfunction
function U9O takes integer UAO,integer UBO returns nothing
set SY0=CreateMultiboard()
call MultiboardSetItemsWidth(SY0,0)
call MultiboardSetRowCount(SY0,UAO)
call MultiboardSetColumnCount(SY0,UBO)
call MultiboardSetTitleText(SY0,"DotA 记分板"+" "+" - "+(EL))
call MultiboardMinimize(SY0,true)
call MultiboardSetItemsStyle(SY0,false,false)
if GetLocalPlayer()==D60 or GetLocalPlayer()==D70 then
call MultiboardDisplay(SY0,true)
endif
endfunction
function ObsBoard_AllKD takes nothing returns string
return"|c00ff0303"+I2S(I[GetPlayerId(BO[0])])+"|r/|c0020c000"+I2S(O[GetPlayerId(BO[0])])+"|r"
endfunction
function UCO takes nothing returns nothing
local integer QNO=L1
local integer QSO=M1
local player array QTO
local player array QRO
local integer QPO
local integer QQO
local integer QUO=1+21+QAI(QNO,QSO)
local integer U0O=1+(QNO+QSO)*2
local multiboarditem N8I
local integer i
local integer x
local integer curRow1
local integer curRow2
local string e="|r"
local string c0="|cff99ccff"
local integer UIO
local integer U1O
local integer UDO=131
local integer UEO=139
local integer UFO=139
local integer UGO=255
local integer PSO=0
local string PTO=""
local string PRO=""
local integer PPO=0
local integer PQO=0
local integer r
if QNO>0 and QSO>0 then
set QUO=QUO+2
endif
if GetTriggerExecCount(GetTriggeringTrigger())==1 then
call U9O(QUO,U0O)
endif
if C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70)then
call MultiboardDisplay(SY0,true)
endif
set i=1
loop
exitwhen i>5
set r=R2I(TimerGetRemaining(F0[GetPlayerId(BO[i])]))
if r>0 then
set PSO=PSO+PZO(r)
if PPO==0 then
if r<10 then
set PTO=C0[GetPlayerId(BO[i])]+"0"+I2S(r)+" |r"
else
set PTO=C0[GetPlayerId(BO[i])]+I2S(r)+" |r"
endif
else
if r<10 then
set PTO=PTO+SF0+"| |r"+C0[GetPlayerId(BO[i])]+"0"+I2S(r)+" |r"
else
set PTO=PTO+SF0+"| |r"+C0[GetPlayerId(BO[i])]+I2S(r)+" |r"
endif
endif
set PPO=PPO+1
endif
set i=i+1
endloop
if PPO>0 then
set PTO=SF0+"[Sentinel: |r"+PTO+SF0+"]|r"
endif
set i=1
loop
exitwhen i>5
set r=R2I(TimerGetRemaining(F0[GetPlayerId(CO[i])]))
if r>0 then
set PSO=PSO+PZO(r)
if PQO==0 then
if r<10 then
set PRO=C0[GetPlayerId(CO[i])]+"0"+I2S(r)+" |r"
else
set PRO=C0[GetPlayerId(CO[i])]+I2S(r)+" |r"
endif
else
if r<10 then
set PRO=PRO+SF0+"| |r"+C0[GetPlayerId(CO[i])]+"0"+I2S(r)+" |r"
else
set PRO=PRO+SF0+"| |r"+C0[GetPlayerId(CO[i])]+I2S(r)+" |r"
endif
endif
set PQO=PQO+1
endif
set i=i+1
endloop
if PQO>0 then
set PRO=SF0+"[Scourge: |r"+PRO+SF0+"]|r"
endif
call MultiboardSetTitleText(SY0,PTO+" "+PRO+" "+"DotA 记分板"+" "+" - "+(EL)+" - "+("|c00ff0303"+I2S(I[GetPlayerId(BO[0])])+"|r/|c0020c000"+I2S(O[GetPlayerId(BO[0])])+"|r"))
set x=1
set i=1
loop
exitwhen i>5
if T3I(BO[i])or GetPlayerSlotState(BO[i])==PLAYER_SLOT_STATE_LEFT then
set QTO[x]=BO[i]
set x=x+1
endif
set i=i+1
endloop
set x=1
set i=1
loop
exitwhen i>5
if T3I(CO[i])or GetPlayerSlotState(CO[i])==PLAYER_SLOT_STATE_LEFT then
set QRO[x]=CO[i]
set x=x+1
endif
set i=i+1
endloop
set i=0
set QQO=0
loop
exitwhen i>QUO
set N8I=MultiboardGetItem(SY0,i,QQO)
call MultiboardSetItemWidth(N8I,0.075)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=0
set QQO=0
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I," ")
call MultiboardReleaseItem(N8I)
set QQO=0
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,false)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,U2O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,U2O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,false)
call MultiboardReleaseItem(N8I)
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemValue(N8I,"("+(I2S(GetUnitLevel(K1[GetPlayerId((QTO[i]))])))+")")
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemValue(N8I,"("+(I2S(GetUnitLevel(K1[GetPlayerId((QRO[i]))])))+")")
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"物品"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(1)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(2)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(1)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(2)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+" "+e)
call MultiboardReleaseItem(N8I)
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(3)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(4)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(3)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(4)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QPO=QPO+1
set QQO=0
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+" "+e)
call MultiboardReleaseItem(N8I)
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(5)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QTO[i]))],(6)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(5)-1))))
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(F21(UnitItemInSlot(K1[GetPlayerId((QRO[i]))],(6)-1))))
call MultiboardSetItemWidth(N8I,0.054)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"现有金钱"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(GetPlayerState((QTO[i]),PLAYER_STATE_RESOURCE_GOLD))))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(GetPlayerState((QRO[i]),PLAYER_STATE_RESOURCE_GOLD))))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"买活花费"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(WS[GV1(GetHeroLevel(K1[GetPlayerId((QTO[i]))]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(WS[GV1(GetHeroLevel(K1[GetPlayerId((QRO[i]))]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"补兵数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(A[GetPlayerId((QTO[i]))]))+"/"+(I2S(B[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(A[GetPlayerId((QRO[i]))]))+"/"+(I2S(B[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"击杀/死亡/助攻"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(I[GetPlayerId((QTO[i]))]))+"/"+(I2S(O[GetPlayerId((QTO[i]))]))+"/"+(I2S(D[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(I[GetPlayerId((QRO[i]))]))+"/"+(I2S(O[GetPlayerId((QRO[i]))]))+"/"+(I2S(D[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"额外黄金"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QOO(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,QOO(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"额外经验"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q4O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Q4O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"购买守卫"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(F[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(F[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"拆塔数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,U3O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,U3O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"杀野数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S((LoadInteger(LY,(400+GetPlayerId((QTO[i]))),(79))))))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S((LoadInteger(LY,(400+GetPlayerId((QRO[i]))),(79))))))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"击杀英雄奖励"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(Y[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(Y[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"死亡累计时间"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,U4O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,U4O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"死亡损失金钱"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(G[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(G[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"消耗品"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(E[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(E[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"双杀次数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(Z[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(Z[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"三杀次数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(V[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(V[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"最高连杀数"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(H[GetPlayerId((QTO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,(I2S(H[GetPlayerId((QRO[i]))])))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
if QNO>0 and QSO>0 then
set QQO=0
set UIO=QPO
set U1O=QQO
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"击杀细节"+e)
call MultiboardReleaseItem(N8I)
set QPO=UIO
set x=1
loop
exitwhen x>QNO
set QQO=0
set QPO=UIO
set i=1
loop
exitwhen i>QSO
set QQO=x+(x-1)
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[x]))])))
call MultiboardSetItemWidth(N8I,0.01)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[i]))])))
call MultiboardSetItemValue(N8I," "+U5O(QTO[x],QRO[i]))
call MultiboardSetItemWidth(N8I,0.059)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set x=x+1
endloop
set x=QNO+1
loop
exitwhen x>(QSO+QNO)
set QQO=0
set QPO=UIO
set i=1
loop
exitwhen i>QNO
set QQO=x+(x-1)
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[x-QNO]))])))
call MultiboardSetItemWidth(N8I,0.01)
call MultiboardReleaseItem(N8I)
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[i]))])))
call MultiboardSetItemValue(N8I," "+U5O(QRO[x-QNO],QTO[i]))
call MultiboardSetItemWidth(N8I,0.059)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set x=x+1
endloop
endif
set QPO=QPO+1
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"冷却时间"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
if U6O(QTO[i])==" "then
call MultiboardSetItemStyle(N8I,true,false)
else
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[i]))])))
endif
call MultiboardSetItemValue(N8I,U8O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemValueColor(N8I,UDO,UEO,UFO,UGO)
if U6O(QRO[i])==" "then
call MultiboardSetItemStyle(N8I,true,false)
else
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[i]))])))
endif
call MultiboardSetItemValue(N8I,U8O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set QQO=0
set QPO=QPO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,c0+"重生"+e)
call MultiboardReleaseItem(N8I)
set QQO=0
set i=1
loop
exitwhen i>QNO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
if U6O(QTO[i])==" "then
call MultiboardSetItemStyle(N8I,true,false)
else
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QTO[i]))])))
endif
call MultiboardSetItemValue(N8I,U6O(QTO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set i=1
loop
exitwhen i>QSO
set QQO=QQO+1
set N8I=MultiboardGetItem(SY0,QPO,QQO)
if U6O(QRO[i])==" "then
call MultiboardSetItemStyle(N8I,true,false)
else
call MultiboardSetItemStyle(N8I,true,true)
call MultiboardSetItemIcon(N8I,(SAI(K1[GetPlayerId((QRO[i]))])))
endif
call MultiboardSetItemValue(N8I,U6O(QRO[i]))
call MultiboardSetItemWidth(N8I,0.07)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
endfunction
function UHO takes nothing returns nothing
local trigger t
if C2 then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddAction(t,function UCO)
set SJ0=t
endif
endfunction
function UZO takes nothing returns boolean
local integer id=GetUnitTypeId(GetTriggerUnit())
local string STI
if GetLocalPlayer()==GetTriggerPlayer()then
if id=='hC95' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='n01K' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='nC38' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='e025' then
elseif id=='n00V' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='n00W' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='n002' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='n00X' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='n009' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='n0HE' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='nC35' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='u00Q' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='uC74' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='u010' then
call ResetUnitAnimation(GetTriggerUnit())
elseif id=='u00Z' then
call ResetUnitAnimation(GetTriggerUnit())
endif
endif
return false
endfunction
function UVO takes nothing returns boolean
local integer id=GetUnitTypeId(GetTriggerUnit())
local string STI = ""
if GetLocalPlayer()==GetTriggerPlayer()then
if id=='hC95' then
set STI="stand work"
elseif id=='n01K' then
set STI="stand third"
elseif id=='nC38' then
call SetUnitAnimationByIndex(GetTriggerUnit(),3)
elseif id=='e025' then
elseif id=='n00V' then
set STI="spell attack"
elseif id=='n00W' then
set STI="spell"
elseif id=='n002' then
call SetUnitAnimationByIndex(GetTriggerUnit(),3)
elseif id=='n00X' then
set STI="stand work"
elseif id=='n009' then
set STI="stand work"
elseif id=='n0HE' then
set STI="stand victory"
elseif id=='nC35' then
set STI="stand work"
elseif id=='u00Q' then
set STI="stand work"
elseif id=='uC74' then
set STI="stand work gold"
elseif id=='u010' then
set STI="stand work"
elseif id=='u00Z' then
set STI="stand work"
endif
if STI!=""then
call SetUnitAnimation(GetTriggerUnit(),STI)
call QueueUnitAnimation(GetTriggerUnit(),STI)
endif
endif
return false
endfunction
function IsChinese takes nothing returns boolean
return "只有简体中文版需要翻译该文本"!="Only Translate This String If Simplified Chinese"
endfunction
function UXO takes nothing returns boolean
local integer i=0
local string s="我开通了中文微博：@IceFrogCN(新浪)，@IceFrogdev(腾讯)"
loop
exitwhen i>12
if GetRandomInt(0,10)<11 and("只有简体中文版需要翻译该文本"!="Only Translate This String If Simplified Chinese")then
call DisplayTimedTextToPlayer(Player(i),0,0,20,"|CFF00FF00"+s+"|r")
endif
set i=i+1
endloop
return false
endfunction
function UJO takes unit u returns nothing
endfunction
function UKO takes nothing returns boolean
local real ULO
local real UMO
local unit u
if TK0==false then
set u=IA0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SK0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TL0==false then
set u=IB0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SL0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TM0==false then
set u=IC0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SM0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TJ0==false then
set u=ID0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SN0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IE0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SS0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IF0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-ST0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IG0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SR0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IH0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SP0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IZ0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SQ0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IV0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-SU0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IW0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T00)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IX0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TI0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IY0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T10)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=IJ0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TO0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=I60
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T20)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TW0==false then
set u=C10
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T30)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TX0==false then
set u=CO0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T40)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TY0==false then
set u=C20
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T50)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
if TV0==false then
set u=C30
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T60)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=C40
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T70)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=C50
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T80)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=C60
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-T90)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=C70
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TA0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=C80
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TB0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=C90
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TC0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=CA0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TD0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=CB0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TE0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=CC0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TF0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=CD0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TG0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
set u=BQ0
if u!=null then
set ULO=GetUnitState(u,UNIT_STATE_LIFE)
set UMO=ULO+TZ0
if UMO<(GetUnitState(u,UNIT_STATE_MAX_LIFE)-TH0)then
call SetUnitState(u,UNIT_STATE_LIFE,UMO)
call UJO(u)
endif
endif
endif
return false
endfunction
function UNO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TW0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T30=T30+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function USO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TX0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T40=T40+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function UTO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TY0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T50=T50+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function URO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T60=T60+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function UPO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T70=T70+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function UQO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T80=T80+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function UUO takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T90=T90+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I02 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TA0=TA0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function II2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TB0=TB0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I12 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TC0=TC0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IO2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TD0=TD0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I22 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TE0=TE0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I32 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TF0=TF0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I42 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TG0=TG0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I52 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TV0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TH0=TH0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I62 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TK0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SK0=SK0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I72 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TL0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SL0=SL0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I82 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TM0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SM0=SM0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function I92 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SN0=SN0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IA2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SS0=SS0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IB2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set ST0=ST0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IC2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SR0=SR0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function ID2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SP0=SP0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IE2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SQ0=SQ0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IF2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set SU0=SU0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IG2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T00=T00+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IH2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TI0=TI0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IZ2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T10=T10+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IV2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set TO0=TO0+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IW2 takes nothing returns boolean
local real PAI=GetEventDamage()
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
set PAI=(1-0.25)*PAI
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if TJ0 or IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true then
set T20=T20+PAI
else
if IsUnitIllusion(GetEventDamageSource())==true then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.75*PAI)
else
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+0.25*PAI)
endif
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IY2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==CO[0]then
set TJ0=true
endif
return false
endfunction
function IJ2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==CO[0]then
set TK0=true
endif
return false
endfunction
function IK2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==CO[0]then
set TL0=true
endif
return false
endfunction
function IL2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==CO[0]then
set TM0=true
endif
return false
endfunction
function IM2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==BO[0]then
set TV0=true
endif
return false
endfunction
function IN2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==BO[0]then
set TW0=true
endif
return false
endfunction
function IS2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==BO[0]then
set TX0=true
endif
return false
endfunction
function IT2 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==BO[0]then
set TY0=true
endif
return false
endfunction
function IR2 takes nothing returns boolean
local group g=NTI()
set TV0=false
set TW0=false
set TX0=false
set TY0=false
set TJ0=false
set TK0=false
set TL0=false
set TM0=false
call GroupEnumUnitsInRect(g,O6,Condition(function IY2))
call GroupEnumUnitsInRect(g,A6,Condition(function IY2))
call GroupEnumUnitsInRect(g,B6,Condition(function IY2))
call GroupEnumUnitsInRect(g,CB,Condition(function IY2))
call GroupEnumUnitsInRect(g,DB,Condition(function IY2))
call GroupEnumUnitsInRect(g,EB,Condition(function IY2))
call GroupEnumUnitsInRect(g,AB,Condition(function IJ2))
call GroupEnumUnitsInRect(g,ZB,Condition(function IK2))
call GroupEnumUnitsInRect(g,BB,Condition(function IL2))
call GroupEnumUnitsInRect(g,C6,Condition(function IM2))
call GroupEnumUnitsInRect(g,D6,Condition(function IM2))
call GroupEnumUnitsInRect(g,E6,Condition(function IM2))
call GroupEnumUnitsInRect(g,HB,Condition(function IM2))
call GroupEnumUnitsInRect(g,FB,Condition(function IM2))
call GroupEnumUnitsInRect(g,GB,Condition(function IM2))
call GroupEnumUnitsInRect(g,UA,Condition(function IN2))
call GroupEnumUnitsInRect(g,IB,Condition(function IS2))
call GroupEnumUnitsInRect(g,OB,Condition(function IT2))
call NSI(g)
set g=null
return false
endfunction
function IQ2 takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
call TriggerEvaluate(OH)
return false
endfunction
function IU2 takes nothing returns boolean
local real r=TimerGetRemaining(OL)
local real BQO=r
local integer QHI=R2I(BQO)
local integer BX1=QHI/60-1/2
local integer BY1=ModuloInteger(QHI,60)
local trigger t
local integer i
local player p
if r==0 then
set TN0=true
call FL1("GameStart",1)
call BW1(BX1,BY1,true)
set CL=true
set N=TimerGetElapsed(M)
call FlushTrigger(GetTriggeringTrigger())
call SetFloatGameState(GAME_STATE_TIME_OF_DAY,6.00)
call SuspendTimeOfDay(false)
call SetTimeOfDayScale(0.625)
if P0==false then
if HL then
call TriggerRegisterTimerEvent(J20,120,true)
else
call TriggerRegisterTimerEvent(J20,120,true)
endif
call TriggerEvaluate(J20)
endif
call TriggerRegisterTimerEvent(OH,60,true)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,30,false)
call TriggerAddCondition(t,Condition(function IQ2))
set t=null
call TriggerRegisterTimerEventPeriodic(ZG,30.00)
call TriggerExecute(ZG)
call TriggerRegisterTimerEventPeriodic(UG,450.00)
call TriggerRegisterTimerEventSingle(GG,2699.00)
call TriggerRegisterTimerEventSingle(HG,999.00)
call TriggerRegisterTimerEventSingle(HG,1999.00)
call TriggerRegisterTimerEventSingle(HG,2999.00)
call TriggerRegisterTimerEvent(FL0,300,true)
call TriggerRegisterTimerEvent(R50,300,true)
call TriggerRegisterTimerEvent(HS,30,true)
call TriggerEvaluate(HS)
if Q0 then
call TriggerRegisterTimerEvent(BH,600,true)
endif
call ExecuteFunc("O02")
elseif r==7 then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,30,true)
call TriggerAddCondition(t,Condition(function SNO))
elseif BQO<12 and DL==false then
set DL=true
call PlaySoundBJ(OE)
call BW1(BX1,BY1,true)
elseif BQO==20 then
if GetRandomInt(0,10)<2 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,6,"|c006699CC"+"如果你发现bug，请致信IceFrog@gmail.com。不要在公共场合讨论任何Bug。"+"|r")
endif
elseif BQO==60 then
call ExecuteFunc("UXO")
else
call BW1(BX1,BY1,true)
endif
if K0==true and ModuloInteger(GetTriggerEvalCount(GetTriggeringTrigger()),4)==0 then
if r==85 then
if K1[GetPlayerId(GetLocalPlayer())]==null then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,6,"|c006699CC"+"如果10秒后再不选择英雄，你的金钱将会逐秒减少"+"|r")
endif
elseif r==80 then
if K1[GetPlayerId(GetLocalPlayer())]==null then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,6,"|c006699CC"+"如果5秒后再不选择英雄，你的金钱将会逐秒减少"+"|r")
endif
elseif r<75 and r>0 then
if r==74 then
if K1[GetPlayerId(GetLocalPlayer())]==null then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,6,"|c006699CC"+"现在你将每秒损失1点金钱，直到你选择了英雄为止"+"|r")
endif
endif
set i=0
loop
exitwhen i>5
set p=BO[i]
if K1[GetPlayerId(p)]==null then
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-1)
endif
set p=CO[i]
if K1[GetPlayerId(p)]==null then
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-1)
endif
set i=i+1
endloop
endif
endif
return false
endfunction
function OI2 takes nothing returns boolean
if IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetAttacker()))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetAttacker()))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1 and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false and GetOwningPlayer(GetFilterUnit())!=DO then
if IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true then
set TS0=GetFilterUnit()
else
set TT0=GetFilterUnit()
endif
endif
return false
endfunction
function O12 takes nothing returns nothing
local unit SQO=GetAttacker()
local unit target=GetTriggerUnit()
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SQO),GetUnitY(SQO),900,Condition(function OI2))
call NSI(g)
call DisableTrigger(GetTriggeringTrigger())
if TS0!=null then
call IssueTargetOrder(SQO,"attack",TS0)
call GroupAddUnit(TR0,SQO)
elseif IsUnitType(target,UNIT_TYPE_HERO)==true and TT0!=null then
call IssueTargetOrder(SQO,"attack",TT0)
call GroupAddUnit(TR0,SQO)
endif
call EnableTrigger(GetTriggeringTrigger())
set TS0=null
set TT0=null
set SQO=null
set target=null
set g=null
endfunction
function OO2 takes nothing returns nothing
if GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)<1 then
call GroupRemoveUnit(TR0,GetEnumUnit())
endif
if GetUnitCurrentOrder(GetEnumUnit())!=OrderId("attack")then
call GroupRemoveUnit(TR0,GetEnumUnit())
call IssuePointOrderLoc(GetEnumUnit(),"attack",O2[GetUnitAbilityLevel(GetEnumUnit(),I2)])
endif
endfunction
function O22 takes nothing returns boolean
call ForGroup(TR0,function OO2)
return false
endfunction
function O42 takes string s returns nothing
set TU0=TU0+1
set R00[TU0]=s
endfunction
function O52 takes nothing returns boolean
local integer i=1
loop
exitwhen i>TU0
call ExecuteFunc(R00[i])
set i=i+1
endloop
call ExecuteFunc("UV1")
call ExecuteFunc("HJO")
return false
endfunction
function O62 takes unit SFI returns nothing
local trigger t=CreateTrigger()
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(38),(true))
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function O52))
set t=null
endfunction
function O72 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())!='H0B8' and GetUnitTypeId(GetTriggerUnit())!='H00M' and GetUnitTypeId(GetTriggerUnit())!='H07G' and GetUnitTypeId(GetTriggerUnit())!='H00Y' and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetTriggerUnit())==false and HaveSavedBoolean(LY,GetHandleId(GetTriggerUnit()),38)==false then
if TP0 and(GetUnitTypeId(GetTriggerUnit())!='O00P' or(GetUnitTypeId(GetTriggerUnit())=='O00P' and TQ0))then
call O62(GetTriggerUnit())
endif
endif
return false
endfunction
function O92 takes nothing returns boolean
local unit u
local real OA2
local boolean OB2=PLI()
set u=IK0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IL0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IM0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IN0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IS0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IT0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IR0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IP0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IQ0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=IU0
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
set u=O00
if u!=null and GetUnitState(u,UNIT_STATE_LIFE)>1 then
set OA2=GetUnitState(u,UNIT_STATE_MANA)
if OB2 then
set OA2=QDI(OA2-25,0)
else
set OA2=QCI(OA2+5,300)
endif
call SetUnitState(u,UNIT_STATE_MANA,OA2)
endif
return false
endfunction
function OE2 takes nothing returns boolean
local real d
if GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(HK))==true then
set d=QNI(BK,CK,GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()))
if d<AK then
set AK=d
set GK=GetFilterUnit()
endif
endif
return false
endfunction
function OF2 takes unit SWI,real x,real y returns unit
local group g=NTI()
set GK=null
set HK=SWI
set AK=99999
set BK=x
set CK=y
call GroupEnumUnitsInRange(g,x,y,2000,Condition(function OE2))
call NSI(g)
set g=null
return GK
endfunction
function TeleportationEffect_Remove takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target
if GetSpellAbilityId()=='A231' then
set target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(target,'Binf')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function OG2 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point
local real x
local real y
local unit target=GetSpellTargetUnit()
call SCI(SFI,4256,1)
if target==null then
set point=GetSpellTargetLoc()
set x=GetLocationX(point)
set y=GetLocationY(point)
call RemoveLocation(point)
if GetSpellAbilityId()=='A1R5' then
set target=XKO(SFI,x,y)
else
set target=OF2(SFI,x,y)
endif
set x=GetUnitX(target)
set y=GetUnitY(target)
else
set x=GetUnitX(GetSpellTargetUnit())
set y=GetUnitY(GetSpellTargetUnit())
endif
if(IsUnitAlly(SFI,GetLocalPlayer())and GetLocalPlayer()!=GetOwningPlayer(SFI))or(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))then
call PingMinimapEx(x,y,3,255,255,255,false)
endif
set SFI=null
set point=null
endfunction
function TeleportationEffect_Main takes nothing returns boolean
if GetSpellAbilityId()=='A231' then
call OG2()
endif
return false
endfunction
function OZ2 takes nothing returns nothing
call TCI('N00R')
call TCI('N0M7')
call TCI('N0MK')
call TCI('N0MD')
call TCI('N0MU')
endfunction
function OV2 takes nothing returns nothing
if RYI(GetEnumUnit())and IsUnitAlly(GetEnumUnit(),BO[0])==false and GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)>0.5 then
call UnitRemoveAbility(GetEnumUnit(),'B08H')
call Damage(PQ,GetEnumUnit(),2,500)
endif
endfunction
function OW2 takes nothing returns nothing
if RYI(GetEnumUnit())and IsUnitAlly(GetEnumUnit(),CO[0])==false and GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)>0.5 then
call UnitRemoveAbility(GetEnumUnit(),'B08H')
call Damage(BX0,GetEnumUnit(),2,500)
endif
endfunction
function OX2 takes nothing returns boolean
local group g=NTI()
call GroupEnumUnitsInRect(g,G5,Condition(function N1I))
call ForGroup(g,function OV2)
call NSI(g)
set g=NTI()
call GroupEnumUnitsInRect(g,H5,Condition(function N1I))
call ForGroup(g,function OW2)
call NSI(g)
set g=null
return false
endfunction
function OJ2 takes string winner returns nothing
local integer i
local player p
local string id
local integer QHI=R2I(TimerGetElapsed(M)-N)
local integer BX1=QHI/60-1/2
local integer BY1=ModuloInteger(QHI,60)
call RTI()
set i=1
loop
exitwhen i>5
set p=BO[i]
set id=I2S(GetPlayerId(p))
call StoreInteger(OS,id,"1",(I[GetPlayerId((p))]))
call StoreInteger(OS,id,"2",(O[GetPlayerId((p))]))
call StoreInteger(OS,id,"3",(A[GetPlayerId((p))]))
call StoreInteger(OS,id,"4",(B[GetPlayerId((p))]))
call StoreInteger(OS,id,"5",(D[GetPlayerId((p))]))
call StoreInteger(OS,id,"6",(GetPlayerState((p),PLAYER_STATE_RESOURCE_GOLD)))
call StoreInteger(OS,id,"7",(LoadInteger(LY,(400+GetPlayerId((p))),(79))))
call StoreInteger(OS,id,"8_0",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(0)))))
call StoreInteger(OS,id,"8_1",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(1)))))
call StoreInteger(OS,id,"8_2",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(2)))))
call StoreInteger(OS,id,"8_3",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(3)))))
call StoreInteger(OS,id,"8_4",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(4)))))
call StoreInteger(OS,id,"8_5",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(5)))))
call StoreInteger(OS,id,"9",(GetUnitTypeId(K1[GetPlayerId((p))])))
call StoreInteger(OS,id,"id",i)
set p=CO[i]
set id=I2S(GetPlayerId(p))
call StoreInteger(OS,id,"1",(I[GetPlayerId((p))]))
call StoreInteger(OS,id,"2",(O[GetPlayerId((p))]))
call StoreInteger(OS,id,"3",(A[GetPlayerId((p))]))
call StoreInteger(OS,id,"4",(B[GetPlayerId((p))]))
call StoreInteger(OS,id,"5",(D[GetPlayerId((p))]))
call StoreInteger(OS,id,"6",(GetPlayerState((p),PLAYER_STATE_RESOURCE_GOLD)))
call StoreInteger(OS,id,"7",(LoadInteger(LY,(400+GetPlayerId((p))),(79))))
call StoreInteger(OS,id,"8_0",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(0)))))
call StoreInteger(OS,id,"8_1",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(1)))))
call StoreInteger(OS,id,"8_2",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(2)))))
call StoreInteger(OS,id,"8_3",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(3)))))
call StoreInteger(OS,id,"8_4",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(4)))))
call StoreInteger(OS,id,"8_5",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(5)))))
call StoreInteger(OS,id,"9",(GetUnitTypeId(K1[GetPlayerId((p))])))
call StoreInteger(OS,id,"id",i+5)
if GetLocalPlayer()==WO then
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"1")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"2")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"3")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"4")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"5")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"6")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"7")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"8_0")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"8_1")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"8_2")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"8_3")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"8_4")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"8_5")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"9")
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"id")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"1")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"2")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"3")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"4")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"5")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"6")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"7")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"8_0")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"8_1")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"8_2")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"8_3")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"8_4")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"8_5")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"9")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"id")
endif
set i=i+1
endloop
if RI0==false then
call StoreInteger(OS,"Global","Winner",R10)
call StoreInteger(OS,"Global","m",BX1)
call StoreInteger(OS,"Global","s",BY1)
if GetLocalPlayer()==WO then
call SyncStoredInteger(OS,"Global","Winner")
call SyncStoredInteger(OS,"Global","m")
call SyncStoredInteger(OS,"Global","s")
endif
endif
endfunction
function VL1 takes nothing returns nothing
call OJ2("1")
endfunction
function VK1 takes nothing returns nothing
local player p=RO0
local string id=I2S(GetPlayerId(p))
call StoreInteger(OS,id,"8_0",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(0)))))
call StoreInteger(OS,id,"8_1",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(1)))))
call StoreInteger(OS,id,"8_2",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(2)))))
call StoreInteger(OS,id,"8_3",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(3)))))
call StoreInteger(OS,id,"8_4",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(4)))))
call StoreInteger(OS,id,"8_5",(GetItemTypeId(UnitItemInSlot(K1[GetPlayerId((p))],(5)))))
if GetLocalPlayer()==WO then
call SyncStoredInteger(OS,I2S(GetPlayerId(p)),"8_0")
call SyncStoredInteger(OS,I2S(GetPlayerId(p)),"8_1")
call SyncStoredInteger(OS,I2S(GetPlayerId(p)),"8_2")
call SyncStoredInteger(OS,I2S(GetPlayerId(p)),"8_3")
call SyncStoredInteger(OS,I2S(GetPlayerId(p)),"8_4")
call SyncStoredInteger(OS,I2S(GetPlayerId(p)),"8_5")
endif
endfunction
function OK2 takes nothing returns boolean
call ExecuteFunc("QMO")
return false
endfunction
function OL2 takes nothing returns nothing
call SPI(GetEnumUnit())
endfunction
function OM2 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsInRange(g,0,0,12000,Condition(function C51))
call ForGroup(g,function OL2)
call NSI(g)
set g=null
endfunction
function ON2 takes nothing returns nothing
set bj_changeLevelShowScores=true
call DisableTrigger(RK)
call DisableTrigger(PK)
call ExecuteFunc("GYO")
if C2 then
call DisableTrigger(SJ0)
endif
call DisableTrigger(EX0)
call ClearTextMessages()
call QRI(bj_FORCE_ALL_PLAYERS,60,J3+" "+"获得了胜利！|c00ff8000汉化作者：HippoVic，Outskirts。|r获取最新版本请访问："+" www.getdota.com.")
set Q2=true
call I91()
call DisableTrigger(ZG)
call DisableTrigger(FH)
call DisableTrigger(EW0)
call NRI()
endfunction
function OS2 takes nothing returns nothing
local trigger t=CreateTrigger()
call PanCameraToTimed(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function OK2))
set R10=2
set J3="|c0020c000"+"天灾军团"+"|r"
call ON2()
call OM2()
call OJ2("2")
set t=null
endfunction
function OT2 takes nothing returns boolean
call SetUnitVertexColorBJ(BQ0,100,100,100,GetTriggerEvalCount(GetTriggeringTrigger()))
if GetTriggerEvalCount(GetTriggeringTrigger())==100 then
call ShowUnit(BQ0,false)
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function OR2 takes nothing returns nothing
local trigger t=CreateTrigger()
call PanCameraToTimed(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerAddCondition(t,Condition(function OK2))
set R10=1
set J3="|c00ff0303"+"近卫军团"+"|r"
call ON2()
call OM2()
call OJ2("1")
call AddSpecialEffect("war3mapImported\\FrozenThronesDeath2.mdx",GetUnitX(BQ0)+150,GetUnitY(BQ0)+100)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function OT2))
set t=null
endfunction
function OQ2 takes real U0I returns boolean
return(100*GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)/GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_LIFE))<U0I
endfunction
function AntiTK_Building takes nothing returns boolean
return OQ2(10)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitTypeId(GetTriggerUnit())!='etol' and GetUnitTypeId(GetTriggerUnit())!='unpl'
endfunction
function AntiTK_Hero takes nothing returns boolean
return OQ2(25)and(GetUnitAbilityLevel(GetTriggerUnit(),'BNdo')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'BEsh')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B001')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B0AQ')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B0AP')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05D')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05M')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05N')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05O')>0)
endfunction
function AntiTK_Creep takes nothing returns boolean
return OQ2(50)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==false and(IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false or GetUnitTypeId(GetTriggerUnit())=='ebal' or GetUnitTypeId(GetTriggerUnit())=='e026' or GetUnitTypeId(GetTriggerUnit())=='umtw' or GetUnitTypeId(GetTriggerUnit())=='u00R')
endfunction
function AntiTK_Exception takes nothing returns boolean
return GetUnitTypeId(GetTriggerUnit())=='u00S' or GetUnitTypeId(GetTriggerUnit())=='o01V' or((LoadInteger(LY,(GetHandleId((GetAttacker()))),((4328))))==1)==true
endfunction
function OU2 takes nothing returns nothing
if not((OQ2(10)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitTypeId(GetTriggerUnit())!='etol' and GetUnitTypeId(GetTriggerUnit())!='unpl')or(OQ2(25)and(GetUnitAbilityLevel(GetTriggerUnit(),'BNdo')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'BEsh')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B001')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B0AQ')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B0AP')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05D')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05M')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05N')>0 or GetUnitAbilityLevel(GetTriggerUnit(),'B05O')>0))or(OQ2(50)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==false and(IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false or GetUnitTypeId(GetTriggerUnit())=='ebal' or GetUnitTypeId(GetTriggerUnit())=='e026' or GetUnitTypeId(GetTriggerUnit())=='umtw' or GetUnitTypeId(GetTriggerUnit())=='u00R'))or(GetUnitTypeId(GetTriggerUnit())=='u00S' or GetUnitTypeId(GetTriggerUnit())=='o01V' or((LoadInteger(LY,(GetHandleId((GetAttacker()))),((4328))))==1)==true))then
call IssueImmediateOrder(GetAttacker(),"stop")
endif
endfunction
function A02 takes nothing returns boolean
if IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call OU2()
elseif IsUnitType(GetAttacker(),UNIT_TYPE_HERO)==true or B61(GetAttacker())or IsUnitIllusion(GetAttacker())==true then
set R20=GetPlayerId(GetOwningPlayer(GetAttacker()))
if IsUnitIllusion(GetAttacker())==false then
if L90[R20]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitIllusion(GetAttacker())==false and EA1(GetAttacker(),FR0[HC0])==true then
call Z3O()
endif
if LC0[R20]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and(EA1(GetAttacker(),FR0[V10])==true or EA1(GetAttacker(),FR0[XD0])==true)then
call ZZO()
endif
if LE0[R20]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and EA1(GetAttacker(),FR0[VE0])==true then
call ZAO()
elseif(LF0[R20]>0 or M00[R20]>0)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and(EA1(GetAttacker(),FR0[VI0])==true or EA1(GetAttacker(),FR0[XC0])==true)then
call ZHO()
endif
endif
if MI0[R20]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and(EA1(GetAttacker(),FR0[V40])==true or EA1(GetAttacker(),FR0[V50])==true or EA1(GetAttacker(),FR0[V60])==true or EA1(GetAttacker(),FR0[V70])==true)then
if IsUnitIllusion(GetAttacker())==false or IsUnitType(GetAttacker(),UNIT_TYPE_MELEE_ATTACKER)==true then
call ZDO()
endif
endif
elseif GetUnitAbilityLevel(GetAttacker(),'A17S')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false then
call O12()
endif
return false
endfunction
function A12 takes nothing returns boolean
if BZ1(GetSpellAbilityId())and BV1(GetTriggerUnit())then
call PJI(GetTriggerUnit())
endif
return false
endfunction
function A22 takes nothing returns nothing
call C2O()
call C5O()
endfunction
function A42 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT or(LoadBoolean(LY,(GetHandleId(SFI)),(140)))==true then
if(LoadBoolean(LY,(GetHandleId(SFI)),(140)))==true then
call SaveBoolean(LY,(GetHandleId(SFI)),(140),(false))
call SaveInteger(LY,(GetHandleId((SFI))),((4259)),(2))
call UnitRemoveAbility(SFI,'A04R')
call BK1(SFI,false)
call PauseUnit(SFI,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetSpellTargetUnit()==SFI and GetSpellAbilityId()==R40 and(GetPlayerSlotState(GetOwningPlayer((SFI)))==PLAYER_SLOT_STATE_LEFT)and((LoadInteger(LY,(GetHandleId((SFI))),((4259))))==1)==true then
call SaveInteger(LY,(GetHandleId((SFI))),((4259)),(2))
call UnitRemoveAbility(SFI,'A04R')
call BK1(SFI,false)
call PauseUnit(SFI,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif IsUnitDead(SFI)==false then
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
call SaveInteger(LY,(GetHandleId((SFI))),((4259)),(1))
call UnitAddAbility(SFI,'A04R')
call BK1(SFI,true)
call PauseUnit(SFI,true)
endif
set SFI=null
set t=null
return false
endfunction
function A52 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetSpellTargetUnit()
call SaveBoolean(LY,(GetHandleId(SFI)),(140),(false))
call SaveInteger(LY,(GetHandleId((SFI))),((4259)),(1))
call UnitAddAbility(SFI,'A04R')
call BK1(SFI,true)
call PauseUnit(SFI,true)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
call TriggerRegisterTimerEvent(t,1,true)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function A42))
set t=null
set SFI=null
endfunction
function A62 takes nothing returns boolean
if OSI==true then
return false
endif
if GetSpellAbilityId()==R30 and(GetPlayerSlotState(GetOwningPlayer((GetSpellTargetUnit())))==PLAYER_SLOT_STATE_LEFT)and((LoadInteger(LY,(GetHandleId((GetSpellTargetUnit()))),((4259))))==1)==false then
call A52()
elseif(GetSpellAbilityId()==R40 or GetSpellAbilityId()==R30)and(GetPlayerSlotState(GetOwningPlayer((GetSpellTargetUnit())))==PLAYER_SLOT_STATE_LEFT)==false then
call PZI(GetOwningPlayer(GetTriggerUnit()),"只能以离开的英雄为目标")
endif
return false
endfunction
function A82 takes destructable d returns boolean
local real x=GetDestructableX(d)
local real y=GetDestructableY(d)
local group g=NTI()
local boolean A92
call GroupEnumUnitsInRange(g,x,y,250,Condition(function D51))
set A92=FirstOfGroup(g)!=null
call NSI(g)
set g=null
return A92
endfunction
function AA2 takes nothing returns nothing
if RJI(GetEnumDestructable())and GetDestructableLife(GetEnumDestructable())<1 and GetDestructableTypeId(GetEnumDestructable())!='B002' and GetDestructableTypeId(GetEnumDestructable())!='B003' then
if A82(GetEnumDestructable())==false then
call DestructableRestoreLife(GetEnumDestructable(),GetDestructableMaxLife(GetEnumDestructable()),false)
if BM[GetPlayerId(GetLocalPlayer())]==1 and GetDestructableTypeId(GetEnumDestructable())=='ATtr' then
call SetDestructableAnimation(GetEnumDestructable(),"stand alternate")
endif
endif
endif
endfunction
function AB2 takes nothing returns nothing
call EnumDestructablesInRectAll(bj_mapInitialPlayableArea,function AA2)
endfunction
function AD2 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='n00L' then
if IsUnitIllusion(GetAttacker())==true then
call KillUnit(GetAttacker())
elseif IsUnitInRegion(R60,GetAttacker())==false then
call PZI(GetOwningPlayer(GetAttacker()),"你不能从这里攻击Roshan")
call IssueImmediateOrder(GetAttacker(),"stop")
endif
endif
return false
endfunction
function AF2 takes nothing returns boolean
return GetUnitTypeId(GetEnteringUnit())=='e00E' or GetUnitTypeId(GetEnteringUnit())=='e022'
endfunction
function AG2 takes nothing returns nothing
call ShowUnitHide(GetEnteringUnit())
call SetUnitPathing(GetEnteringUnit(),false)
call SetUnitInvulnerable(GetEnteringUnit(),true)
call UnitApplyTimedLifeBJ(20.00,'BTLF',GetEnteringUnit())
endfunction
function AZ2 takes nothing returns boolean
if(GetUnitTypeId(GetDyingUnit())=='e00R')then
return true
endif
if(GetUnitTypeId(GetDyingUnit())=='e011')then
return true
endif
if(GetUnitTypeId(GetDyingUnit())=='e00S')then
return true
endif
if(GetUnitTypeId(GetDyingUnit())=='e019')then
return true
endif
return false
endfunction
function AV2 takes nothing returns boolean
if(not(GetDyingUnit()==IG0))then
return false
endif
if(not(IsUnitDead(IH0)==true))then
return false
endif
return true
endfunction
function AW2 takes nothing returns boolean
if(not(GetDyingUnit()==IH0))then
return false
endif
if(not(IsUnitDead(IG0)==true))then
return false
endif
return true
endfunction
function AX2 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='ncop' and IsPlayerAlly(GetOwningPlayer(GetFilterUnit()),JK)==true
endfunction
function AY2 takes player p returns nothing
local group g=NTI()
local unit u
set JK=p
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function AX2))
loop
set u=FirstOfGroup(g)
exitwhen FirstOfGroup(g)==null
if GetUnitAbilityLevel(u,'A141')>0 then
call UnitRemoveAbility(u,'A141')
call UnitAddAbility(u,'A141')
else
call UnitRemoveAbility(u,'A1WI')
call UnitAddAbility(u,'A1WI')
endif
call GroupRemoveUnit(g,u)
endloop
call NSI(g)
set g=null
set u=null
endfunction
function AJ2 takes nothing returns nothing
if IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit()))then
set J[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=J[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
if(GetDyingUnit()==I70)then
call FL1("Tower"+I2S(0)+I2S(1)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(IA0,false)
call R3I(GetKillingUnit(),1)
call AY2(GetOwningPlayer(GetTriggerUnit()))
endif
if(GetDyingUnit()==I80)then
call FL1("Tower"+I2S(0)+I2S(1)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(IB0,false)
call R3I(GetKillingUnit(),1)
call AY2(GetOwningPlayer(GetTriggerUnit()))
endif
if(GetDyingUnit()==I90)then
call FL1("Tower"+I2S(0)+I2S(1)+I2S(2),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(IC0,false)
call R3I(GetKillingUnit(),1)
call AY2(GetOwningPlayer(GetTriggerUnit()))
endif
if(GetDyingUnit()==IA0)then
call FL1("Tower"+I2S(0)+I2S(2)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(ID0,false)
call R3I(GetKillingUnit(),2)
endif
if(GetDyingUnit()==IB0)then
call FL1("Tower"+I2S(0)+I2S(2)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(IE0,false)
call R3I(GetKillingUnit(),2)
endif
if(GetDyingUnit()==IC0)then
call FL1("Tower"+I2S(0)+I2S(2)+I2S(2),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(IF0,false)
call R3I(GetKillingUnit(),2)
endif
if(GetDyingUnit()==ID0)then
call FL1("Tower"+I2S(0)+I2S(3)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),3)
call BK1(IZ0,false)
call BK1(IX0,false)
call BK1(IG0,false)
call BK1(IH0,false)
call BK1(OI0,false)
call BK1(O10,false)
call BK1(OO0,false)
call BK1(O20,false)
call BK1(IK0,false)
call BK1(IL0,false)
call BK1(IM0,false)
call BK1(IN0,false)
call BK1(IS0,false)
call BK1(IT0,false)
call BK1(IR0,false)
call BK1(IP0,false)
call BK1(IQ0,false)
call BK1(IU0,false)
call BK1(O00,false)
endif
if(GetDyingUnit()==IE0)then
call FL1("Tower"+I2S(0)+I2S(3)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),3)
call BK1(IV0,false)
call BK1(IY0,false)
call BK1(IG0,false)
call BK1(IH0,false)
call BK1(OI0,false)
call BK1(O10,false)
call BK1(OO0,false)
call BK1(O20,false)
call BK1(IK0,false)
call BK1(IL0,false)
call BK1(IM0,false)
call BK1(IN0,false)
call BK1(IS0,false)
call BK1(IT0,false)
call BK1(IR0,false)
call BK1(IP0,false)
call BK1(IQ0,false)
call BK1(IU0,false)
call BK1(O00,false)
endif
if(GetDyingUnit()==IF0)then
call FL1("Tower"+I2S(0)+I2S(3)+I2S(2),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),3)
call BK1(IW0,false)
call BK1(IJ0,false)
call BK1(IG0,false)
call BK1(IH0,false)
call BK1(OI0,false)
call BK1(O10,false)
call BK1(OO0,false)
call BK1(O20,false)
call BK1(IK0,false)
call BK1(IL0,false)
call BK1(IM0,false)
call BK1(IN0,false)
call BK1(IS0,false)
call BK1(IT0,false)
call BK1(IR0,false)
call BK1(IP0,false)
call BK1(IQ0,false)
call BK1(IU0,false)
call BK1(O00,false)
endif
if GetDyingUnit()==IG0 or GetDyingUnit()==IH0 then
call FL1("Tower"+I2S(0)+I2S(4)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),4)
endif
if(AV2())then
call BK1(I60,false)
endif
if(AW2())then
call BK1(I60,false)
endif
endfunction
function AL2 takes nothing returns boolean
if(GetUnitTypeId(GetDyingUnit())=='u00M')then
return true
endif
if(GetUnitTypeId(GetDyingUnit())=='u00D')then
return true
endif
if(GetUnitTypeId(GetDyingUnit())=='u00N')then
return true
endif
if(GetUnitTypeId(GetDyingUnit())=='u00T')then
return true
endif
return false
endfunction
function AM2 takes nothing returns boolean
if(not(GetDyingUnit()==C60))then
return false
endif
if(not(IsUnitDead(C70)==true))then
return false
endif
return true
endfunction
function AN2 takes nothing returns boolean
if(not(GetDyingUnit()==C70))then
return false
endif
if(not(IsUnitDead(C60)==true))then
return false
endif
return true
endfunction
function AS2 takes nothing returns nothing
if IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit()))then
set J[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]=J[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]+1
endif
if(GetDyingUnit()==BU0)then
call FL1("Tower"+I2S(1)+I2S(1)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(C10,false)
call R3I(GetKillingUnit(),1)
call AY2(GetOwningPlayer(GetTriggerUnit()))
endif
if(GetDyingUnit()==C00)then
call FL1("Tower"+I2S(1)+I2S(1)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(CO0,false)
call R3I(GetKillingUnit(),1)
call AY2(GetOwningPlayer(GetTriggerUnit()))
endif
if(GetDyingUnit()==CI0)then
call FL1("Tower"+I2S(1)+I2S(1)+I2S(2),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(C20,false)
call R3I(GetKillingUnit(),1)
call AY2(GetOwningPlayer(GetTriggerUnit()))
endif
if(GetDyingUnit()==C10)then
call FL1("Tower"+I2S(1)+I2S(2)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(C30,false)
call R3I(GetKillingUnit(),2)
endif
if(GetDyingUnit()==CO0)then
call FL1("Tower"+I2S(1)+I2S(2)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(C40,false)
call R3I(GetKillingUnit(),2)
endif
if(GetDyingUnit()==C20)then
call FL1("Tower"+I2S(1)+I2S(2)+I2S(2),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call BK1(C50,false)
call R3I(GetKillingUnit(),2)
endif
if(GetDyingUnit()==C30)then
call FL1("Tower"+I2S(1)+I2S(3)+I2S(0),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),3)
call BK1(C80,false)
call BK1(CB0,false)
call BK1(C60,false)
call BK1(C70,false)
call BK1(CL0,false)
call BK1(CM0,false)
call BK1(CN0,false)
call BK1(CS0,false)
call BK1(CE0,false)
call BK1(CF0,false)
call BK1(CG0,false)
call BK1(CH0,false)
call BK1(CZ0,false)
call BK1(CV0,false)
call BK1(CW0,false)
call BK1(CX0,false)
call BK1(CY0,false)
call BK1(CJ0,false)
call BK1(CK0,false)
endif
if(GetDyingUnit()==C40)then
call FL1("Tower"+I2S(1)+I2S(3)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),3)
call BK1(C90,false)
call BK1(CC0,false)
call BK1(C60,false)
call BK1(C70,false)
call BK1(CL0,false)
call BK1(CM0,false)
call BK1(CN0,false)
call BK1(CS0,false)
call BK1(CE0,false)
call BK1(CF0,false)
call BK1(CG0,false)
call BK1(CH0,false)
call BK1(CZ0,false)
call BK1(CV0,false)
call BK1(CW0,false)
call BK1(CX0,false)
call BK1(CY0,false)
call BK1(CJ0,false)
call BK1(CK0,false)
endif
if(GetDyingUnit()==C50)then
call FL1("Tower"+I2S(1)+I2S(3)+I2S(2),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),3)
call BK1(CA0,false)
call BK1(CD0,false)
call BK1(C60,false)
call BK1(C70,false)
call BK1(CL0,false)
call BK1(CM0,false)
call BK1(CN0,false)
call BK1(CS0,false)
call BK1(CE0,false)
call BK1(CF0,false)
call BK1(CG0,false)
call BK1(CH0,false)
call BK1(CZ0,false)
call BK1(CV0,false)
call BK1(CW0,false)
call BK1(CX0,false)
call BK1(CY0,false)
call BK1(CJ0,false)
call BK1(CK0,false)
endif
if GetDyingUnit()==C60 or GetDyingUnit()==C70 then
call FL1("Tower"+I2S(1)+I2S(4)+I2S(1),GetPlayerId(GetOwningPlayer(GetKillingUnit())))
call R3I(GetKillingUnit(),4)
endif
if(AM2())then
call BK1(BQ0,false)
endif
if(AN2())then
call BK1(BQ0,false)
endif
endfunction
function AR2 takes nothing returns boolean
local integer x=0
if GetPlayerSlotState(BO[1])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(BO[2])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(BO[3])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(BO[4])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(BO[5])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(CO[1])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(CO[2])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(CO[3])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(CO[4])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
if GetPlayerSlotState(CO[5])==PLAYER_SLOT_STATE_EMPTY then
set x=x+1
endif
return x==9
endfunction
function SinglePlayer_Condition takes nothing returns boolean
return bj_isSinglePlayer and AR2()
endfunction
function AP2 takes nothing returns nothing
set R70=false
endfunction
function AQ2 takes nothing returns nothing
set R90=true
endfunction
function AU2 takes nothing returns nothing
set R70=true
endfunction
function B02 takes nothing returns nothing
set TK=false
set A2I=true
endfunction
function BI2 takes nothing returns boolean
if IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false then
call KillUnit(GetFilterUnit())
endif
return false
endfunction
function B12 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,CO[0],Condition(function BI2))
call NSI(g)
set g=null
set W3=true
endfunction
function BO2 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,BO[0],Condition(function BI2))
call NSI(g)
set g=null
set W3=true
endfunction
function B22 takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())=='o004' or GetUnitTypeId(GetFilterUnit())=='oeye' then
call KillUnit(GetFilterUnit())
endif
return false
endfunction
function B32 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function B22))
call NSI(g)
set g=null
set W3=true
endfunction
function B42 takes nothing returns nothing
call BO2()
call B12()
set W3=true
endfunction
function B52 takes nothing returns boolean
if IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true then
call SetHeroLevel(GetFilterUnit(),GetHeroLevel(GetFilterUnit())+QAI(UJ,1),true)
endif
return false
endfunction
function B62 takes nothing returns nothing
local string B72=SubString(GetEventPlayerChatString(),6,StringLength(GetEventPlayerChatString()))
local integer level=S2I(B72)
local group g=NTI()
if level<1 then
set level=1
endif
set UJ=level
call GroupEnumUnitsOfPlayer(g,GetTriggerPlayer(),Condition(function B52))
call NSI(g)
set g=null
set W3=true
endfunction
function B82 takes nothing returns nothing
call TriggerExecute(ZG)
set W3=true
endfunction
function B92 takes nothing returns boolean
if IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true then
call UnitResetCooldown(GetFilterUnit())
call TimerStart(EJ0[GetPlayerId((GetOwningPlayer(GetFilterUnit())))],0,false,null)
call SetUnitState(GetFilterUnit(),UNIT_STATE_LIFE,GetUnitState(GetFilterUnit(),UNIT_STATE_MAX_LIFE))
call SetUnitState(GetFilterUnit(),UNIT_STATE_MANA,GetUnitState(GetFilterUnit(),UNIT_STATE_MAX_MANA))
endif
return false
endfunction
function BA2 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,GetTriggerPlayer(),Condition(function B92))
call NSI(g)
set g=null
set W3=true
endfunction
function BB2 takes nothing returns nothing
call KillUnit(K1[GetPlayerId(GetTriggerPlayer())])
set W3=true
endfunction
function BC2 takes nothing returns nothing
local string BD2=SubString(GetEventPlayerChatString(),5,StringLength(GetEventPlayerChatString()))
local integer GW1=S2I(BD2)
if GW1<0 or GW1>24 then
set GW1=0
endif
call SetFloatGameState(GAME_STATE_TIME_OF_DAY,GW1)
set W3=true
endfunction
function BE2 takes nothing returns nothing
local string BF2=SubString(GetEventPlayerChatString(),5,StringLength(GetEventPlayerChatString()))
local integer ROI=S2I(BF2)
call SetPlayerState(GetTriggerPlayer(),PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(GetTriggerPlayer(),PLAYER_STATE_RESOURCE_GOLD)+ROI)
set W3=true
endfunction
function BG2 takes nothing returns nothing
local unit AD1=K1[GetPlayerId(GetTriggerPlayer())]
local player I6O=GetTriggerPlayer()
local location I2O
if IsPlayerTeam2(I6O)then
set I2O=GetRectCenter(S3)
else
set I2O=GetRectCenter(O4)
endif
if Q2==false and IsUnitDead(AD1)then
call VQ1(AD1,I6O,GetLocationX(I2O),GetLocationY(I2O),true)
if I0O(AD1)==false or GetUnitAbilityLevel(AD1,'A0MW')==0 then
call ReviveHeroLoc(AD1,I2O,true)
else
call IOO(AD1,I2O)
endif
endif
call RemoveLocation(I2O)
set AD1=null
set I6O=null
set I2O=null
endfunction
function BH2 takes nothing returns nothing
local unit hero=K1[GetPlayerId(GetTriggerPlayer())]
local player BZ2
local unit BV2
local real x=GetRectCenterX(Y5)
local real y=GetRectCenterX(Y5)
if IsPlayerTeam2(GetOwningPlayer(hero))then
set BZ2=BO[1]
else
set BZ2=CO[1]
endif
set BV2=CreateUnit(BZ2,'H000',x,y,0)
call SetHeroLevel(BV2,10,false)
set hero=null
set BV2=null
set BZ2=null
endfunction
function BW2 takes nothing returns nothing
call TriggerEvaluate(J20)
endfunction
function BX2 takes nothing returns nothing
call TriggerEvaluate(OH)
endfunction
function BY2 takes nothing returns nothing
call EnumDestructablesInRectAll(bj_mapInitialPlayableArea,function AA2)
endfunction
function BJ2 takes nothing returns boolean
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60,"**** "+"提示"+" ****")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60,"系统侦测到你在使用单机模式。你可以使用下列单机命令："+" -lvlup xx, -refresh, -spawncreeps, -powerup, -neutrals, -kill, -gold xxxx, -time xx, -killsent, -killscourge, -killall, -noherolimit, -trees, -killwards, -spawnoff, -spawnon, -roshan, -respawn, -dummy")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60,"**** "+"提示"+" ****")
return false
endfunction
function BK2 takes nothing returns nothing
local player OnlyPlayer=WO
local trigger t
set R80=true
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60,"系统侦测到你在使用单机模式。你可以使用下列单机命令："+" -lvlup xx, -refresh, -spawncreeps, -powerup, -neutrals, -kill, -gold xxxx, -time xx, -killsent, -killscourge, -killall, -noherolimit, -trees, -killwards, -spawnoff, -spawnon, -roshan, -respawn, -dummy")
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function BJ2))
call TriggerRegisterTimerEvent(t,GetRandomReal(60,100),false)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-lvlup",false)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-lvlup",false)
call TriggerAddAction(t,function B62)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-spawncreeps",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-spawncreeps",true)
call TriggerAddAction(t,function B82)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-refresh",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-refresh",true)
call TriggerAddAction(t,function BA2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-kill",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-kill",true)
call TriggerAddAction(t,function BB2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-gold",false)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-gold",false)
call TriggerAddAction(t,function BE2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-time",false)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-time",false)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-time",false)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-time",false)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-time",false)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-time",false)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-time",false)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-time",false)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-time",false)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-time",false)
call TriggerAddAction(t,function BC2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-powerup",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-powerup",true)
call TriggerAddAction(t,function BW2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-killall",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-killall",true)
call TriggerAddAction(t,function B42)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-killsent",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-killsent",true)
call TriggerAddAction(t,function BO2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-killscourge",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-killscourge",true)
call TriggerAddAction(t,function B12)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-neutrals",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-neutrals",true)
call TriggerAddAction(t,function BX2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-noherolimit",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-noherolimit",true)
call TriggerAddAction(t,function B02)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-trees",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-trees",true)
call TriggerAddAction(t,function BY2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-killwards",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-killwards",true)
call TriggerAddAction(t,function B32)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-spawnoff",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-spawnoff",true)
call TriggerAddAction(t,function AU2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-spawnon",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-spawnon",true)
call TriggerAddAction(t,function AP2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-roshan",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-roshan",true)
call TriggerAddAction(t,function AQ2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-respawn",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-respawn",true)
call TriggerAddAction(t,function BG2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-dummy",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-dummy",true)
call TriggerAddAction(t,function BH2)
endfunction
function BM2 takes nothing returns boolean
return not B0
endfunction
function BN2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit B71=(LoadUnitHandle(LY,(handle_id),(26)))
if GetUnitTypeId(B71)!='ncop' then
call UnitResetCooldown(B71)
call SetUnitManaPercentBJ(B71,100)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set B71=null
return false
endfunction
function BS2 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function BN2))
call SaveUnitHandle(LY,(handle_id),(26),(GetTriggerUnit()))
set t=null
endfunction
function BT2 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer BR2=T8I(OO)+T8I(AO)
local integer NumRequired=Q9I(BR2,BR2/2+1)
local integer handle_id=GetHandleId(t)
set A2I=true
if PE0==false then
set RA0=true
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,60.00," ")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,90.00,"WTF模式已经被激活。在这个模式下使用技能不需要消耗魔法并且没有冷却时间")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,90.00,"此模式仅供娱乐")
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddAction(t,function BS2)
endif
endfunction
function BQ2 takes nothing returns boolean
if QW1(GetTriggerUnit())and IsUnitIllusion(GetTriggerUnit())==false then
call GK1(GetOwningPlayer(GetTriggerUnit()))
call FL1("Level"+I2S(GetHeroLevel(GetTriggerUnit())),GetPlayerId(GetOwningPlayer(GetTriggerUnit())))
endif
return false
endfunction
function C02 takes nothing returns nothing
if PE0==false then
call BK2()
call FlushTrigger(GetTriggeringTrigger())
endif
endfunction
function CI2 takes nothing returns boolean
if B0==false and(bj_isSinglePlayer and AR2())==false then
call C02()
endif
return false
endfunction
function CO2 takes nothing returns boolean
local integer i=0
local real C22
local real C32
local real x
local real y
local boolean C42
loop
exitwhen i>11
if GetLocalPlayer()==Player(i)then
set C22=GetCameraTargetPositionX()
set C32=GetCameraTargetPositionY()
endif
set i=i+1
endloop
set i=0
call PauseGame(true)
call TriggerSleepAction(0)
loop
exitwhen i>11
if GetLocalPlayer()==Player(i)then
call SetCameraPosition(C22+1,C32+1)
endif
set i=i+1
endloop
call TriggerSleepAction(0)
call PauseGame(false)
set i=0
loop
exitwhen i>11
if GetLocalPlayer()==Player(i)then
set x=GetCameraTargetPositionX()
if x==C22+1 then
set C42=false
else
set C42=true
endif
call SetCameraPosition(C22,C32)
endif
set i=i+1
endloop
return C42
endfunction
function C52 takes nothing returns nothing
call CinematicModeBJ(true,bj_FORCE_ALL_PLAYERS)
call PauseGame(false)
call TriggerSleepAction(.0)
call EnableUserControl(false)
call TriggerSleepAction(.0)
if CO2()==false then
set RB0=true
endif
call EnableUserControl(true)
call M4I(1)
call CinematicModeBJ(false,bj_FORCE_ALL_PLAYERS)
endfunction
function C62 takes nothing returns boolean
local integer i=1
local unit SFI
loop
exitwhen i>5
set SFI=K1[GetPlayerId(BO[i])]
if SFI!=null and IsUnitDead(SFI)==false and IsUnitEnemy(SFI,GetLocalPlayer())==true then
if RB0 and(C2==false or(C2==true and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70)))then
if IsUnitVisible(SFI,GetLocalPlayer())==false then
if UK==2 then
call FY1(SFI)
endif
else
if UK==2 then
call FV1(SFI)
endif
endif
endif
endif
set SFI=K1[GetPlayerId(CO[i])]
if SFI!=null and IsUnitDead(SFI)==false and IsUnitEnemy(SFI,GetLocalPlayer())==true then
if RB0 and(C2==false or(C2==true and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70)))then
if IsUnitVisible(SFI,GetLocalPlayer())==false then
if UK==2 then
call FY1(SFI)
endif
else
if UK==2 then
call FV1(SFI)
endif
endif
endif
endif
set i=i+1
endloop
set SFI=null
return false
endfunction
function C72 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function C62))
set t=null
endfunction
function C82 takes nothing returns nothing
call C52()
call C72()
endfunction
function C92 takes unit SWI returns boolean
return(GetOwningPlayer(SWI)==BO[0])or(GetOwningPlayer(SWI)==CO[0])
endfunction
function CA2 takes nothing returns nothing
call SetUnitUserData(GetEnumUnit(),0)
call IssuePointOrderLoc(GetEnumUnit(),"attack",(O2[GetUnitAbilityLevel((GetEnumUnit()),I2)]))
endfunction
function CB2 takes nothing returns nothing
call IssueTargetOrder(GetEnumUnit(),"attack",RE0)
call GroupAddUnit(RD0,GetEnumUnit())
call SetUnitUserData(GetEnumUnit(),RF0)
endfunction
function CC2 takes nothing returns boolean
local integer id=GetUnitTypeId(GetFilterUnit())
if id=='ebal' or id=='e026' or id=='umtw' or id=='u00R' then
return false
endif
if IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(RE0))and(GetOwningPlayer(GetFilterUnit())==BO[0]or GetOwningPlayer(GetFilterUnit())==CO[0])and GetUnitUserData(GetFilterUnit())==0 then
return true
endif
return false
endfunction
function CD2 takes nothing returns nothing
if GetUnitCurrentOrder(GetEnumUnit())==0 and IsUnitInRange(GetEnumUnit(),RE0,GetUnitAcquireRange(GetEnumUnit()))==false then
call GroupRemoveUnit(RD0,GetEnumUnit())
call SetUnitUserData(GetEnumUnit(),0)
call IssuePointOrderLoc(GetEnumUnit(),"attack",(O2[GetUnitAbilityLevel((GetEnumUnit()),I2)]))
endif
endfunction
function CE2 takes nothing returns nothing
local integer handle_id=GetHandleId((LoadUnitHandle(LY,(GetHandleId(GetExpiredTimer())),(2))))
local integer CF2=(LoadInteger(LY,(handle_id),(143)))
local group CG2=(LoadGroupHandle(LY,(handle_id),(144)))
set RC0[CF2]=null
call ForGroup(CG2,function CA2)
call GroupClear(CG2)
set CG2=null
endfunction
function CH2 takes unit SFI,unit Z4O returns nothing
local integer handle_id=GetHandleId(SFI)
local group CG2=(LoadGroupHandle(LY,(handle_id),(144)))
local integer CF2=(LoadInteger(LY,(handle_id),(143)))
local unit CZ2=RC0[CF2]
local group g
if CZ2!=null and CZ2!=Z4O then
call ForGroup(CG2,function CA2)
call GroupClear(CG2)
endif
set RC0[CF2]=Z4O
set RD0=CG2
set RE0=Z4O
set RF0=CF2
call ForGroup(CG2,function CD2)
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(Z4O),GetUnitY(Z4O),500,Condition(function CC2))
call ForGroup(g,function CB2)
call NSI(g)
call TimerStart((LoadTimerHandle(LY,(handle_id),(141))),2,false,function CE2)
set CG2=null
set CZ2=null
set g=null
endfunction
function CV2 takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local unit target=GetOrderTargetUnit()
local integer CW2=GetIssuedOrderId()
local integer CF2
if IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitIllusion(target)==false and(CW2==851983 or CW2==851971)and IsUnitEnemy(target,GetOwningPlayer(SFI))and IsUnitVisible(SFI,GetOwningPlayer(target))then
set CF2=(LoadInteger(LY,(GetHandleId(target)),(143)))
if RC0[CF2]==null or RC0[CF2]==target or IsUnitDead(RC0[CF2])then
if CF2!=0 then
call CH2(target,SFI)
endif
endif
endif
set SFI=null
set target=null
return false
endfunction
function CX2 takes nothing returns boolean
local unit SFI=GetAttacker()
local unit target=GetTriggerUnit()
local integer CW2=GetIssuedOrderId()
local integer CF2
if C92(SFI)==false then
set CF2=(LoadInteger(LY,(GetHandleId(target)),(143)))
if RC0[CF2]==null or RC0[CF2]==target or IsUnitDead(RC0[CF2])then
if CF2!=0 then
call CH2(target,SFI)
endif
endif
endif
set SFI=null
set target=null
return false
endfunction
function CY2 takes unit SFI returns nothing
local group g
local trigger t
local timer tm
local integer handle_id=GetHandleId(SFI)
set RG0=RG0+1
call SaveBoolean(LY,(handle_id),(142),(true))
call SaveInteger(LY,(handle_id),(143),(RG0))
set g=NTI()
call SaveGroupHandle(LY,(handle_id),(144),(g))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerAddCondition(t,Condition(function CV2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function CX2))
set tm=CreateTimer()
call SaveTimerHandle(LY,(GetHandleId(SFI)),(141),(tm))
call SaveUnitHandle(LY,(GetHandleId(tm)),(2),(SFI))
set g=null
set t=null
endfunction
function CJ2 takes nothing returns boolean
if RRI(GetTriggerUnit())and(LoadBoolean(LY,(GetHandleId(GetTriggerUnit())),(142)))==false then
call CY2(GetTriggerUnit())
endif
return false
endfunction
function CL2 takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==BO[0]then
call SetUnitAbilityLevel(GetTriggerUnit(),I2,5)
if RC0[GetUnitUserData(GetTriggerUnit())]==null then
call SetUnitUserData(GetTriggerUnit(),0)
call IssuePointOrderLoc(GetTriggerUnit(),"attack",(O2[GetUnitAbilityLevel((GetTriggerUnit()),I2)]))
endif
elseif GetOwningPlayer(GetTriggerUnit())==CO[0]then
call SetUnitAbilityLevel(GetTriggerUnit(),I2,1)
if RC0[GetUnitUserData(GetTriggerUnit())]==null then
call SetUnitUserData(GetTriggerUnit(),0)
call IssuePointOrderLoc(GetTriggerUnit(),"attack",(O2[GetUnitAbilityLevel((GetTriggerUnit()),I2)]))
endif
endif
return false
endfunction
constant function InvisibilityUnitId takes nothing returns integer
return 'u00B'
endfunction
function CN2 takes nothing returns nothing
local unit JMO=GetTriggerUnit()
local unit CS2=(LoadUnitHandle(LY,(GetHandleId(JMO)),(145)))
call RemoveUnit(CS2)
endfunction
function CT2 takes nothing returns nothing
local group g
local unit JMO
local unit CS2
local trigger t
local integer i
set t=CreateTrigger()
call TriggerAddAction(t,function CN2)
set g=NTI()
call GroupEnumUnitsOfPlayer(g,BO[0],Condition(function N1I))
loop
set JMO=FirstOfGroup(g)
exitwhen JMO==null
call GroupRemoveUnit(g,JMO)
if GetUnitAbilityLevel(JMO,'Adts')>0 or GetUnitAbilityLevel(JMO,'Atru')>0 then
call TriggerRegisterUnitEvent(t,JMO,EVENT_UNIT_DEATH)
set CS2=CreateUnit(BO[1],('u00B'),-5000,-5100,0)
call SetUnitScale(CS2,0,0,0)
call SetUnitPathing(CS2,false)
call SetUnitInvulnerable(CS2,true)
call MUSetUnitX(CS2,GetUnitX(JMO))
call MUSetUnitY(CS2,GetUnitY(JMO))
call SaveUnitHandle(LY,(GetHandleId(JMO)),(145),(CS2))
endif
endloop
call NSI(g)
set g=NTI()
call GroupEnumUnitsOfPlayer(g,CO[0],Condition(function N1I))
loop
set JMO=FirstOfGroup(g)
exitwhen JMO==null
call GroupRemoveUnit(g,JMO)
if GetUnitAbilityLevel(JMO,'Adts')>0 or GetUnitAbilityLevel(JMO,'Atru')>0 then
call TriggerRegisterUnitEvent(t,JMO,EVENT_UNIT_DEATH)
set CS2=CreateUnit(CO[1],('u00B'),3400,4400,0)
call SetUnitScale(CS2,0,0,0)
call SetUnitPathing(CS2,false)
call SetUnitInvulnerable(CS2,true)
call MUSetUnitX(CS2,GetUnitX(JMO))
call MUSetUnitY(CS2,GetUnitY(JMO))
call SaveUnitHandle(LY,(GetHandleId(JMO)),(145),(CS2))
endif
endloop
call NSI(g)
endfunction
function CP2 takes nothing returns nothing
local unit CQ2=GetTriggerUnit()
local unit target=RC0[GetUnitUserData(CQ2)]
call SetUnitPosition(CQ2,GetUnitX(CQ2),GetUnitY(CQ2))
if target!=null and IsUnitDead(target)==false and IsUnitVisible(target,GetOwningPlayer(target))then
call IssueTargetOrder(CQ2,"attack",target)
else
call DisableTrigger(GetTriggeringTrigger())
call IssuePointOrderLoc(CQ2,"attack",(O2[GetUnitAbilityLevel((CQ2),I2)]))
call EnableTrigger(GetTriggeringTrigger())
endif
set CQ2=null
set target=null
endfunction
function CU2 takes nothing returns boolean
if C92(GetTriggerUnit())then
call CP2()
endif
return false
endfunction
function D02 takes nothing returns nothing
local unit CQ2=GetTriggerUnit()
local unit target=RC0[GetUnitUserData(CQ2)]
call SetUnitPosition(CQ2,GetUnitX(CQ2),GetUnitY(CQ2))
if target!=null and IsUnitDead(target)==false and IsUnitVisible(target,GetOwningPlayer(target))then
call IssueTargetOrder(CQ2,"attack",target)
else
call DisableTrigger(GetTriggeringTrigger())
call IssuePointOrderLoc(CQ2,"attack",(O2[GetUnitAbilityLevel((CQ2),I2)]))
call EnableTrigger(GetTriggeringTrigger())
endif
set CQ2=null
set target=null
endfunction
function DI2 takes nothing returns boolean
if GetIssuedOrderId()==851986 then
call D02()
endif
return false
endfunction
function D12 takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())==BO[0]then
if IsUnitFogged(GetAttacker(),BO[1])or IsUnitFogged(GetAttacker(),CO[1])then
call O71(CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetUnitX(GetAttacker()),GetUnitY(GetAttacker()),128,true,false),1)
endif
elseif GetOwningPlayer(GetTriggerUnit())==CO[0]then
if IsUnitFogged(GetAttacker(),BO[1])or IsUnitFogged(GetAttacker(),CO[1])then
call O71(CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetUnitX(GetAttacker()),GetUnitY(GetAttacker()),128,true,false),1)
endif
endif
return false
endfunction
function DO2 takes nothing returns boolean
local trigger t
local group g
local unit u
if C2 then
set t=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(t,BO[0],EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[0],EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER,Condition(function N1I))
call TriggerAddCondition(t,Condition(function DI2))
set t=CreateTrigger()
set g=NTI()
call GroupEnumUnitsOfPlayer(g,BO[0],Condition(function N1I))
loop
set u=FirstOfGroup(g)
exitwhen u==null
call GroupRemoveUnit(g,u)
if GetUnitAcquireRange(u)!=0 then
call TriggerRegisterUnitInRange(t,u,600,Condition(function N1I))
endif
endloop
call NSI(g)
set g=NTI()
call GroupEnumUnitsOfPlayer(g,CO[0],Condition(function N1I))
loop
set u=FirstOfGroup(g)
exitwhen u==null
call GroupRemoveUnit(g,u)
if GetUnitAcquireRange(u)!=0 and IsUnitType(u,UNIT_TYPE_STRUCTURE)then
call TriggerRegisterUnitInRange(t,u,600,Condition(function N1I))
endif
endloop
call NSI(g)
call TriggerAddCondition(t,Condition(function CU2))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function D12))
endif
call FlushTrigger(GetTriggeringTrigger())
return false
endfunction
function D32 takes unit SWI returns nothing
local integer i=0
loop
exitwhen(i==16)
if IsUnitAlly(SWI,Player(i))then
call UnitShareVision(SWI,Player(i),true)
endif
set i=i+1
endloop
endfunction
function D42 takes nothing returns nothing
call D32(GetEnumUnit())
endfunction
function D52 takes nothing returns nothing
local integer x
local group g
set x=1
loop
exitwhen x>5
call SetPlayerAlliance(BO[0],BO[x],ConvertAllianceType(5),false)
call SetPlayerAlliance(CO[0],CO[x],ConvertAllianceType(5),false)
set x=x+1
endloop
set g=NTI()
call GroupEnumUnitsOfPlayer(g,BO[0],Condition(function N1I))
call ForGroup(g,function D42)
call NSI(g)
set g=NTI()
call GroupEnumUnitsOfPlayer(g,CO[0],Condition(function N1I))
call ForGroup(g,function D42)
call NSI(g)
set g=null
endfunction
function D62 takes nothing returns nothing
local integer x
set x=0
loop
exitwhen x>5
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(0),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(1),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(2),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(3),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(4),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(5),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(6),false)
call SetPlayerAlliance(BO[x],DO,ConvertAllianceType(7),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(0),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(1),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(2),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(3),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(4),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(5),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(6),false)
call SetPlayerAlliance(CO[x],DO,ConvertAllianceType(7),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(0),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(1),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(2),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(3),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(4),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(5),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(6),false)
call SetPlayerAlliance(DO,BO[x],ConvertAllianceType(7),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(0),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(1),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(2),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(3),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(4),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(5),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(6),false)
call SetPlayerAlliance(DO,CO[x],ConvertAllianceType(7),false)
set x=x+1
endloop
endfunction
function D72 takes nothing returns boolean
return C92(GetTriggerUnit())
endfunction
function D82 takes nothing returns nothing
call D32(GetTriggerUnit())
endfunction
function D92 takes nothing returns nothing
local trigger t
if not C2 then
return
endif
call D52()
call D62()
set t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,GetWorldBounds())
call TriggerAddCondition(t,Condition(function D72))
call TriggerAddAction(t,function D82)
set t=null
endfunction
function DB2 takes nothing returns nothing
local string DC2=StringCase(GetEventPlayerChatString(),false)
local boolean R4O=DC2=="-random"or DC2=="-random int"or DC2=="-random agi"or DC2=="-random str"
local boolean DD2=DC2=="-repick"
local boolean DE2=DC2=="-gameinfo"
local boolean DF2=SubString(DC2,0,5)=="-swap"
local boolean DG2=DC2=="-recreate"
local boolean DH2=DC2=="-unstuck"
local boolean DZ2=DC2=="-matchup"or DC2=="-ma"
local boolean DV2=DC2=="-movespeed"or DC2=="-ms"
local boolean DW2=DC2=="-msa"
local boolean DX2=DC2=="-disablehelp"
local boolean DY2=DC2=="-enablehelp"
local boolean DJ2=DC2=="-creepstats"or DC2=="-cs"
local boolean DK2=DC2=="-cson"or DC2=="-csoff"
local boolean DL2=DC2=="-hidemsg"
local boolean DM2=DC2=="-showmsg"
local boolean DN2=DC2=="-weather snow"or DC2=="-weather rain"or DC2=="-weather off"or DC2=="-weather random"or DC2=="-weather wind"or DC2=="-weather moonlight"
local boolean DS2=DC2=="-showdeny"or DC2=="-hidedeny"
local boolean DT2=DC2=="-denyinfo"or DC2=="-di"
local boolean DR2=DC2=="-don"or DC2=="-deathon"or DC2=="-doff"or DC2=="-deathoff"
local boolean DP2=SubString(DC2,0,5)=="-roll"and DC2!="-rollhero"
local boolean DQ2=DC2=="-hhn"or DC2=="-hideheronames"
local boolean DU2=DC2=="-mute"
local boolean E02=DC2=="-afk"
local boolean EI2=SubString(DC2,0,8)=="-kickafk"
local boolean E12=DC2=="-apm"
local boolean EO2=DC2=="-clear"
local boolean BPO=DC2=="-courier"
local boolean AH=DC2=="-ah"
local boolean E22=DC2=="-invokelist"or DC2=="-il"
local boolean E32=DC2=="-list"
local boolean E42=DC2=="-rolloff"
local boolean E52=DC2=="-rollon"
local boolean E62=SubString(DC2,0,6)=="-music"
local boolean E72=SubString(DC2,0,6)=="-water"
local boolean E82=SubString(DC2,0,6)=="-quote"
local boolean E92=SubString(DC2,0,3)=="-cm"
local boolean EA2=SubString(DC2,0,9)=="-itemswap"
local boolean EB2=DC2=="-bonus"
local boolean EC2=DC2=="-rollhero"or DC2=="-rh"
local boolean ED2=SubString(DC2,0,9)=="-rickroll"
local boolean NoSwitch=DC2=="-noswitch"
local boolean EE2=SubString(DC2,0,7)=="-switch"or DC2=="-ok"or DC2=="-no"
local boolean Terrain=DC2=="-terrain"or DC2=="-terrain default"or DC2=="-terrain snow"
local boolean EF2=DC2=="-tips"
local boolean EG2=DC2=="-ii"or DC2=="-iteminfo"
local boolean EH2=DC2=="-center"or DC2=="-centeroff"or DC2=="-c"or DC2=="-co"
local boolean EZ2=DC2=="-unlock"
local boolean EV2=DC2=="-disableselection"or DC2=="-ds"
local boolean EW2=DC2=="-enableselection"or DC2=="-es"
local boolean EX2=DC2=="-sleep"
local boolean EY2=DC2=="-calm"
local boolean R4I=DC2=="-st"
local boolean EJ2=DC2=="-nosanta"
call PMI("EK2",R4O)
call PMI("EL2",DD2)
call PMI("EM2",DE2)
call PMI("EN2",DF2)
call PMI("ES2",DG2)
call PMI("ET2",DH2)
call PMI("ER2",DZ2)
call PMI("EP2",DV2)
call PMI("EQ2",DW2)
call PMI("EU2",DX2)
call PMI("F02",DY2)
call PMI("FI2",DJ2)
call PMI("F12",DK2)
call PMI("FO2",DL2)
call PMI("F22",DM2)
call PMI("F32",DN2)
call PMI("F42",DS2)
call PMI("F52",DT2)
call PMI("F62",DR2)
call PMI("F72",DP2)
call PMI("F82",DQ2)
call PMI("F92",DU2)
call PMI("FA2",E02)
call PMI("FB2",EI2)
call PMI("FC2",E12)
call PMI("FD2",EO2)
call PMI("FE2",BPO)
call PMI("FF2",AH)
call PMI("FG2",E22)
call PMI("FH2",E32)
call PMI("FZ2",E42)
call PMI("FV2",E52)
call PMI("FW2",E62)
call PMI("FY2",E72)
call PMI("FJ2",E82)
call PMI("FK2",E92)
call PMI("FL2",EA2)
call PMI("FM2",EB2)
call PMI("FN2",EC2)
call PMI("FS2",ED2)
call PMI("FT2",EE2)
call PMI("FR2",EG2)
call PMI("FP2",EF2)
call PMI("FQ2",EH2)
call PMI("FU2",EZ2)
call PMI("G02",EV2)
call PMI("GI2",EW2)
call PMI("G12",EX2)
call PMI("GO2",R4I)
call PMI("G22",EY2)
call PMI("G32",EJ2)
endfunction
function FS2 takes nothing returns nothing
local integer a=S2I(SubString(GetEventPlayerChatString(),10,StringLength(GetEventPlayerChatString())))
local integer MLI=GetPlayerId(GetTriggerPlayer())
set RH0[MLI]=RH0[MLI]+1
if RH0[MLI]>10 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"你用太多次！")
return
endif
if a<1 or a>8 then
set a=GetRandomInt(1,8)
endif
if a==1 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna give you up")
elseif a==2 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna let you down")
elseif a==3 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna run around")
elseif a==4 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna desert you")
elseif a==5 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna make you cry")
elseif a==6 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna say goodbye")
elseif a==7 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna tell a lie")
elseif a==8 then
call QRI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r's never gonna hurt you")
endif
endfunction
function G52 takes nothing returns boolean
if O3==false then
return false
endif
if S0[GetPlayerId(L2)]==true then
return false
endif
if B0==false then
return false
endif
if K1[GetPlayerId(L2)]!=null and B3==false then
return false
endif
if D0[GetPlayerId(L2)]==true then
return false
endif
if C3[GetPlayerId(L2)]and B3==false then
return false
endif
if B3 and E3[GetPlayerId(L2)]then
return false
endif
return true
endfunction
function G62 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local string G72=(LoadStr(LY,(handle_id),(146)))
set L2=p
if G52()then
set S0[GetPlayerId(p)]=true
if G72=="-random int"then
call RAI(p)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-100)
elseif G72=="-random str"then
call REI(p)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-100)
elseif G72=="-random agi"then
call RFI(p)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-100)
else
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-50)
call RGI(p)
endif
else
call DisplayTimedTextToPlayer(p,0,U2,10,"不能为你随机选择英雄")
endif
set t=null
set p=null
return false
endfunction
function EK2 takes nothing returns nothing
local player T4I=GetTriggerPlayer()
local trigger t
set L2=T4I
if G52()and F3[GetPlayerId(T4I)]==false then
set F3[GetPlayerId(T4I)]=true
call TFI(T4I)
call DisplayTimedTextToPlayer(T4I,0,U2,10,"你马上会得到一个随机选择的英雄")
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function G62))
call SavePlayerHandle(LY,(GetHandleId(t)),(54),(T4I))
call SaveStr(LY,(GetHandleId(t)),(146),(StringCase(GetEventPlayerChatString(),false)))
endif
set t=null
endfunction
function G82 takes nothing returns boolean
local unit SFI=K1[GetPlayerId(GetTriggerPlayer())]
if O8I then
call PZI(GetTriggerPlayer(),"主机禁止重选英雄")
return false
endif
if A3==false then
if IAI==false and N2==false and QT0==false and BN==false and INI==false and IQI==false and B3==false and E2==false then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"-repick "+"指令在这几秒内无效")
endif
return false
endif
if(D0[GetPlayerId(GetTriggerPlayer())]==true)then
return false
endif
if(K1[GetPlayerId(GetTriggerPlayer())]==null)then
return false
endif
if X0 or N2 or B3 then
return false
endif
if(H3==true)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"已经太晚，不能重新选择英雄了")
return false
endif
if(GetPlayerState(GetTriggerPlayer(),PLAYER_STATE_RESOURCE_GOLD)<T0)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"没有足够的黄金重新选择英雄")
return false
endif
if GetPlayerState(GetTriggerPlayer(),PLAYER_STATE_RESOURCE_GOLD)<350 and K0 or J2 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"没有足够的金钱重新选择并买一个新英雄")
return false
endif
if GetUnitState(SFI,UNIT_STATE_MANA)!=GetUnitState(SFI,UNIT_STATE_MAX_MANA)or GetUnitState(SFI,UNIT_STATE_LIFE)!=GetUnitState(SFI,UNIT_STATE_MAX_LIFE)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"只有在满血满魔的状态下才能重新选择英雄")
return false
endif
return true
endfunction
function G92 takes nothing returns nothing
if(IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true)then
if(GetUnitTypeId(GetEnumUnit())=='U006')then
call ExecuteFunc("OOO")
elseif GetUnitTypeId(GetEnumUnit())=='U008' or GetUnitTypeId(GetEnumUnit())=='E015' then
set NK=GetEnumUnit()
call ExecuteFunc("AZO")
endif
call QRI(MCI(GetTriggerPlayer()),10.00,"一名对方玩家放弃使用"+" "+S8I(GetEnumUnit())+".")
endif
if(GetUnitTypeId(GetEnumUnit())=='n004')then
call RemoveUnit(GetEnumUnit())
endif
if(GetUnitTypeId(GetEnumUnit())=='n018')then
call RemoveUnit(GetEnumUnit())
endif
if(GetUnitTypeId(GetEnumUnit())=='n01C')then
call RemoveUnit(GetEnumUnit())
endif
if(GetUnitTypeId(GetEnumUnit())=='n01G')then
call RemoveUnit(GetEnumUnit())
endif
endfunction
function GA2 takes nothing returns nothing
local player T4I=GetTriggerPlayer()
local group Z51=NTI()
local integer RBI
local integer RCI
local location RDI
local unit RepickedUnit
local integer TJI
local integer TGI
local integer THI
local unit GB2
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
set bj_groupEnumOwningPlayer=T4I
call GroupEnumUnitsInRect(Z51,GetWorldBounds(),filterGetUnitsInRectOfPlayer)
if(IsPlayerTeam1(T4I)==true)then
set RBI=DE0
set RCI=DF0
set RDI=GetRectCenter(F4)
else
set RBI=DG0
set RCI=DH0
set RDI=GetRectCenter(E4)
endif
if Y0 then
if(GetRandomInt(1,2)==1)then
set RBI=DE0
set RCI=DF0
else
set RBI=DG0
set RCI=DH0
endif
endif
if K0 or J2 then
set T0=100
endif
set GB2=(LoadUnitHandle(LY,(GetHandleId(GetTriggerPlayer())),(147)))
if GB2!=null and GetUnitTypeId(GB2)=='e00C' then
call RemoveUnit(GB2)
endif
call AdjustPlayerStateBJ(-1*T0,T4I,PLAYER_STATE_RESOURCE_GOLD)
set D0[GetPlayerId(T4I)]=true
call ForGroup(Z51,function G92)
if S0[GetPlayerId(T4I)]==true then
call TEI(GetUnitTypeId(K1[GetPlayerId(T4I)]))
endif
call Q5I(K1[GetPlayerId(T4I)])
set K1[GetPlayerId(GetTriggerPlayer())]=null
if K0 or J2 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,60,GetObjectName('N05Y'))
if K0 then
set TGI=DE0
set THI=DH0
endif
if IsPlayerTeam1(T4I)then
if J2 then
set TGI=DE0
set THI=DF0
call CreateUnitAtLoc(T4I,'n00C',ZC1,bj_UNIT_FACING)
else
call CreateUnitAtLoc(T4I,'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(T4I,'n00C',ZD1,bj_UNIT_FACING)
endif
call PanCameraToTimedLocForPlayer(T4I,ZC1,0)
else
if J2 then
set TGI=DG0
set THI=DH0
call CreateUnitAtLoc(T4I,'n00C',ZD1,bj_UNIT_FACING)
else
call CreateUnitAtLoc(T4I,'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(T4I,'n00C',ZD1,bj_UNIT_FACING)
endif
call PanCameraToTimedLocForPlayer(T4I,ZD1,0)
endif
loop
exitwhen TGI>THI
if R[TGI]==false then
call SetPlayerTechMaxAllowed(T4I,DC0[TGI],1)
endif
set TGI=TGI+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
return
endif
loop
set TJI=GetRandomInt(RBI,RCI)
if(R[TJI]==false)then
set R[TJI]=true
set K1[GetPlayerId(T4I)]=CreateUnitAtLoc(T4I,DC0[TJI],RDI,bj_UNIT_FACING)
call TCI(DC0[TJI])
endif
exitwhen K1[GetPlayerId(GetTriggerPlayer())]!=null
endloop
call NSI(Z51)
call RemoveLocation(RDI)
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
endfunction
function EL2 takes nothing returns nothing
if G82()then
call GA2()
endif
endfunction
function EM2 takes nothing returns nothing
local player T4I=GetTriggerPlayer()
local string GD2="|c006699CC"
if INI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"League Mode"+"|r:      "+"两边将轮流选取英雄")
endif
if IQI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Extended League"+"|r:      "+"两边将轮流选取英雄")
call DisplayTimedTextToPlayer(T4I,0,U2,20,"                                 "+"每方阵营的队长可以从酒馆中移除4个英雄")
endif
if X0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Death Match"+"|r:        "+"当你死亡后，你将必须选择一个新英雄")
call DisplayTimedTextToPlayer(T4I,0,U2,20,"                              "+"在你的队伍用完"+" "+I2S(Q9I(DF0,DH0-DG0+1))+" "+"位英雄后，你们就输掉了这场比赛")
endif
if E2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Mirror Match"+"|r:       "+"一分钟之后，两边队伍将获得同样的英雄阵容")
endif
if K0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"All Pick"+"|r:                 "+"你可以使用任意酒馆里的英雄")
endif
if QT0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Random Draft"+"|r:                 "+"你将从被系统随机挑选出的英雄中选择一个")
endif
if IAI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Single Draft"+"|r:                 "+"你可以从系统提供的3个选项中选择一个英雄")
endif
if Y0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"All Random"+"|r:          "+"你将会随机分配到一个来自任意酒馆的英雄")
endif
if N2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Vote Random"+"|r:         "+"你将随机分配到一个英雄，该英雄来自你们所选举出的团队阵容")
endif
if J0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Team Random"+"|r:     "+"你将会随机分配到一个来自本方酒馆的英雄")
endif
if B3 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Reverse"+"|r:                 "+"你为你的对手选择他将使用的英雄")
endif
if FO then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Shuffle Players"+"|r:     "+"重新分配两个阵营的玩家")
endif
if H2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"All Agility"+"|r:             "+"只允许选择敏捷英雄")
endif
if V2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"All Strength"+"|r:         "+"只允许选择力量英雄")
endif
if Z2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"All Intelligence"+"|r:    "+"只允许选择智力英雄")
endif
if OOI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Range Only"+"|r:    "+"只对远程英雄有效")
endif
if O1I then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Melee Only"+"|r:    "+"只对近程英雄有效")
endif
if F2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Duplicate Mode"+"|r:   "+"同样的英雄可以被多次选择")
endif
if L0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Item Drop"+"|r:             "+"当你死亡后，会随机掉落物品栏某一格的物品")
endif
if P0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"No Powerups"+"|r:        "+"神符被禁止了")
endif
if Q0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Super Creeps"+"|r:        "+"攻城傀儡，恐怖怪鱼和远古九头蛇")
call DisplayTimedTextToPlayer(T4I,0,U2,20,"                             "+"将随机加入双方阵营")
endif
if R0 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Easy Mode"+"|r:           "+"削弱防御塔的攻击力和生命，提升英雄所得到的经验值以及周期性的金钱供应")
endif
if Y2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Same Hero"+"|r:           "+"所有的玩家都将得到"+" "+(D80[GetPlayerId((WO))])+"|r"+" "+"所选的英雄")
endif
if O2I then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Only Mid"+"|r:           "+"只能中路塔能够被摧毁")
endif
if O4I then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"No Bot"+"|r:           "+"下路将不会出兵")
endif
if O6I then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"No Mid"+"|r:           "+"中路将不会出兵")
endif
if O7I then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"No Top"+"|r:           "+"上路将不会出兵")
endif
if FL then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"No Swap"+"|r:           "+"禁止玩家之间交换英雄")
endif
if FL then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"No Repick"+"|r:           "+"禁止玩家重选英雄")
endif
if ZL then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Pool Mode"+"|r:           "+"允许为队友养人")
endif
if O9I then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Observer Info"+"|r:           "+"禁止为裁判显示额外信息")
endif
if OBI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Mini Hereos"+"|r:           "+"创建微缩英雄模型")
endif
if OCI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Fast Respawn"+"|r:           "+"缩短50%的死亡等待时间")
endif
if CN then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Captains Mode"+"|r:           "+"各团队的队长必须决定禁用的英雄，然后开始选择英雄")
endif
if HL then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Experimental Runes"+"|r:           "+"另一种神符刷新系统")
endif
if BN then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Captains Draft"+"|r:           "+"队长可以从限定的阵容中征召英雄")
endif
if OFI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Capture Point"+"|r:           "+"据点占据模式将会在10分钟后开始，占据据点的英雄越多，获得的额外属性越快。")
endif
if ODI then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Capture Point"+"|r:           "+"观察者将会通过放大模式观看游戏。")
endif
if J2 then
call DisplayTimedTextToPlayer(T4I,0,U2,20,GD2+"Normal Mode"+"|r:        "+"没有选择模式")
endif
endfunction
function GF2 takes nothing returns nothing
if GetUnitTypeId(GetEnumUnit())=='n004' then
call RemoveUnit(GetEnumUnit())
endif
if GetUnitTypeId(GetEnumUnit())=='o003' then
call RemoveUnit(GetEnumUnit())
endif
endfunction
function GG2 takes unit u1,unit u2 returns nothing
local player Me=GetOwningPlayer(u1)
local player GH2=GetOwningPlayer(u2)
local unit GZ2=CreateUnit(Me,'e01F',0,0,0)
local group g
local item X3O
local integer GV2
if S0[GetPlayerId(Me)]==true then
if GetPlayerState(Me,PLAYER_STATE_RESOURCE_GOLD)<100 then
return
endif
endif
if S0[GetPlayerId(GH2)]==true then
if GetPlayerState(GH2,PLAYER_STATE_RESOURCE_GOLD)<100 then
return
endif
endif
if S0[GetPlayerId(Me)]==true and D0[GetPlayerId(Me)]==false and RZ0[GetPlayerId(Me)]==0 then
set RZ0[GetPlayerId(Me)]=1
call SetPlayerState(Me,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(Me,PLAYER_STATE_RESOURCE_GOLD)-100)
endif
if S0[GetPlayerId(GH2)]==true and D0[GetPlayerId(GH2)]==false and RZ0[GetPlayerId(GH2)]==0 then
set RZ0[GetPlayerId(GH2)]=1
call SetPlayerState(GH2,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(GH2,PLAYER_STATE_RESOURCE_GOLD)-100)
endif
set GV2=EL0[GetPlayerId(Me)]
set EL0[GetPlayerId(Me)]=EL0[GetPlayerId(GH2)]
set EL0[GetPlayerId(GH2)]=GV2
call MUDisableItemTrigger()
if GetUnitAbilityLevel(u1,'A03E')>0 then
set XM=u1
set YM=u2
call ExecuteFunc("GW2")
elseif GetUnitAbilityLevel(u2,'A03E')>0 then
set XM=u2
set YM=u1
call ExecuteFunc("GW2")
endif
if GetUnitAbilityLevel(u1,'A0CY')>0 then
set XM=u1
set YM=u2
call ExecuteFunc("GX2")
elseif GetUnitAbilityLevel(u2,'A0CY')>0 then
set XM=u2
set YM=u1
call ExecuteFunc("GX2")
endif
if GetUnitAbilityLevel(u1,'A13T')>0 then
set XM=u1
set YM=u2
call ExecuteFunc("GY2")
elseif GetUnitAbilityLevel(u2,'A13T')>0 then
set XM=u2
set YM=u1
call ExecuteFunc("GY2")
endif
call FlushChildHashtable(LY,(800+GetPlayerId(GetOwningPlayer(u1))))
call FlushChildHashtable(LY,(800+GetPlayerId(GetOwningPlayer(u2))))
set g=NTI()
set bj_groupEnumOwningPlayer=Me
call GroupEnumUnitsInRect(g,GetWorldBounds(),filterGetUnitsInRectOfPlayer)
call ForGroup(g,function GF2)
call NSI(g)
set g=NTI()
set bj_groupEnumOwningPlayer=GH2
call GroupEnumUnitsInRect(g,GetWorldBounds(),filterGetUnitsInRectOfPlayer)
call ForGroup(g,function GF2)
call NSI(g)
call SetUnitOwner(u2,Me,true)
call SetUnitOwner(u1,GH2,true)
set K1[GetPlayerId(Me)]=u2
set K1[GetPlayerId(GH2)]=u1
call SetPlayerName(Me,(D80[GetPlayerId((Me))])+" ("+S8I(K1[GetPlayerId(Me)])+")")
call SetPlayerName(GH2,(D80[GetPlayerId((GH2))])+" ("+S8I(K1[GetPlayerId(GH2)])+")")
call UnitAddItem(GZ2,UnitItemInSlot(u2,0))
call UnitAddItem(GZ2,UnitItemInSlot(u2,1))
call UnitAddItem(GZ2,UnitItemInSlot(u2,2))
call UnitAddItem(GZ2,UnitItemInSlot(u2,3))
call UnitAddItem(GZ2,UnitItemInSlot(u2,4))
call UnitAddItem(GZ2,UnitItemInSlot(u2,5))
set X3O=UnitItemInSlot(u1,0)
if X3O!=null then
call SetItemPlayer(X3O,Me,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u2,X3O)
endif
set X3O=UnitItemInSlot(u1,1)
if X3O!=null then
call SetItemPlayer(X3O,Me,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u2,X3O)
endif
set X3O=UnitItemInSlot(u1,2)
if X3O!=null then
call SetItemPlayer(X3O,Me,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u2,X3O)
endif
set X3O=UnitItemInSlot(u1,3)
if X3O!=null then
call SetItemPlayer(X3O,Me,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u2,X3O)
endif
set X3O=UnitItemInSlot(u1,4)
if X3O!=null then
call SetItemPlayer(X3O,Me,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u2,X3O)
endif
set X3O=UnitItemInSlot(u1,5)
if X3O!=null then
call SetItemPlayer(X3O,Me,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u2,X3O)
endif
set X3O=UnitItemInSlot(GZ2,0)
if X3O!=null then
call SetItemPlayer(X3O,GH2,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u1,X3O)
endif
set X3O=UnitItemInSlot(GZ2,1)
if X3O!=null then
call SetItemPlayer(X3O,GH2,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u1,X3O)
endif
set X3O=UnitItemInSlot(GZ2,2)
if X3O!=null then
call SetItemPlayer(X3O,GH2,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u1,X3O)
endif
set X3O=UnitItemInSlot(GZ2,3)
if X3O!=null then
call SetItemPlayer(X3O,GH2,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u1,X3O)
endif
set X3O=UnitItemInSlot(GZ2,4)
if X3O!=null then
call SetItemPlayer(X3O,GH2,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u1,X3O)
endif
set X3O=UnitItemInSlot(GZ2,5)
if X3O!=null then
call SetItemPlayer(X3O,GH2,false)
call SetItemUserData(X3O,1)
call UnitAddItem(u1,X3O)
endif
call RemoveUnit(GZ2)
call MUEnableItemTrigger()
if(IsUnitType(u1,UNIT_TYPE_MELEE_ATTACKER)==true or GetUnitTypeId(u1)=='H06S')and ES1(u1,FR0[HM0])!=null then
call UnitRemoveItem(u1,ES1(u1,FR0[HM0]))
elseif(IsUnitType(u1,UNIT_TYPE_RANGED_ATTACKER)==true or GetUnitTypeId(u1)=='H06S')and ES1(u1,FR0[HL0])!=null then
call UnitRemoveItem(u1,ES1(u1,FR0[HL0]))
endif
if(IsUnitType(u2,UNIT_TYPE_MELEE_ATTACKER)==true or GetUnitTypeId(u1)=='H06S')and ES1(u2,FR0[HM0])!=null then
call UnitRemoveItem(u1,ES1(u2,FR0[HM0]))
elseif(IsUnitType(u2,UNIT_TYPE_RANGED_ATTACKER)==true or GetUnitTypeId(u1)=='H06S')and ES1(u2,FR0[HL0])!=null then
call UnitRemoveItem(u1,ES1(u2,FR0[HL0]))
endif
if GetUnitTypeId(u1)=='H06S' and ES1(u1,FR0[HL0])!=null then
call UnitRemoveItem(u1,ES1(u1,FR0[HL0]))
elseif GetUnitTypeId(u1)=='H06S' and ES1(u1,FR0[HM0])!=null then
call UnitRemoveItem(u1,ES1(u1,FR0[HM0]))
endif
if GetUnitTypeId(u2)=='H06S' and ES1(u2,FR0[HL0])!=null then
call UnitRemoveItem(u2,ES1(u2,FR0[HL0]))
elseif GetUnitTypeId(u2)=='H06S' and ES1(u2,FR0[HM0])!=null then
call UnitRemoveItem(u2,ES1(u2,FR0[HM0]))
endif
if(IsUnitType(u1,UNIT_TYPE_MELEE_ATTACKER)==true)and ES1(u1,FR0[X40])!=null then
call UnitRemoveItem(u1,ES1(u1,FR0[X40]))
elseif(IsUnitType(u1,UNIT_TYPE_RANGED_ATTACKER)==true)and ES1(u1,FR0[HL0])!=null then
call UnitRemoveItem(u1,ES1(u1,FR0[HL0]))
endif
if(IsUnitType(u2,UNIT_TYPE_MELEE_ATTACKER)==true)and ES1(u2,FR0[X40])!=null then
call UnitRemoveItem(u1,ES1(u2,FR0[X40]))
elseif(IsUnitType(u2,UNIT_TYPE_RANGED_ATTACKER)==true)and ES1(u2,FR0[X30])!=null then
call UnitRemoveItem(u1,ES1(u2,FR0[X30]))
endif
call ClearSelectionForPlayer(Me)
call SelectUnitAddForPlayer(u2,Me)
call ClearSelectionForPlayer(GH2)
call SelectUnitAddForPlayer(u1,GH2)
call FlushChildHashtable(LY,(800+GetPlayerId(Me)))
call FlushChildHashtable(LY,(800+GetPlayerId(GH2)))
set GK=u1
call ExecuteFunc("QU1")
set GK=u2
call ExecuteFunc("QU1")
call FJ1(GetOwningPlayer(u1),"9",GetUnitTypeId(u1))
call FJ1(GetOwningPlayer(u2),"9",GetUnitTypeId(u2))
call FL1("SWAP_"+I2S(GetPlayerId(GetOwningPlayer(u1)))+"_"+I2S(GetPlayerId(GetOwningPlayer(u2))),GetUnitTypeId(u1))
call FL1("SWAP_"+I2S(GetPlayerId(GetOwningPlayer(u2)))+"_"+I2S(GetPlayerId(GetOwningPlayer(u1))),GetUnitTypeId(u2))
call GK1(Me)
call GK1(GH2)
set Me=null
set GH2=null
set g=null
set GZ2=null
set X3O=null
endfunction
function GJ2 takes unit u1,unit u2 returns boolean
return(LoadBoolean(LY,(800+GetPlayerId(GetOwningPlayer(u2))),(GetUnitTypeId(u1)+GetUnitTypeId(u2))))
endfunction
function SwapHero_Off takes nothing returns nothing
call FlushChildHashtable(LY,(800+GetPlayerId(GetTriggerPlayer())))
endfunction
function GK2 takes player p returns integer
local integer i=1
loop
exitwhen i>5
if BO[i]==p or CO[i]==p then
return i
endif
set i=i+1
endloop
return-1
endfunction
function GL2 takes unit u1,unit u2,boolean GM2 returns boolean
call SaveBoolean(LY,(800+GetPlayerId(GetOwningPlayer(u1))),(GetUnitTypeId(u1)+GetUnitTypeId(u2)),(true))
if GJ2(u1,u2)then
call GG2(u1,u2)
return true
else
call DisplayTimedTextToPlayer(GetOwningPlayer(u2),0,U2,30,"  ")
call DisplayTimedTextToPlayer(GetOwningPlayer(u2),0,U2,30,"                         "+C0[GetPlayerId(GetOwningPlayer(u1))]+GetUnitName(u1)+"|r |cff99ccff"+"想和你交换英雄"+" "+"输入"+"|r |c00ff0303-swap "+I2S(GK2(GetOwningPlayer(u1)))+"|r |cff99ccff"+"来接受请求"+"|r")
call DisplayTimedTextToPlayer(GetOwningPlayer(u2),0,U2,30,"  ")
if GM2 then
call DisplayTimedTextToPlayer(GetOwningPlayer(u1),0,U2,30,"  ")
call DisplayTimedTextToPlayer(GetOwningPlayer(u1),0,U2,30,"|cff99ccff"+"你请求同以下玩家进行交换"+" |r"+C0[GetPlayerId(GetOwningPlayer(u2))]+GetUnitName(u2)+"|r")
call DisplayTimedTextToPlayer(GetOwningPlayer(u1),0,U2,30,"  ")
endif
endif
return false
endfunction
function GN2 takes nothing returns nothing
local integer i=S2I(SubString(GetEventPlayerChatString(),6,StringLength(GetEventPlayerChatString())))
if GetEventPlayerChatString()=="-swapall"then
set i=1
set HK=K1[GetPlayerId(GetTriggerPlayer())]
loop
exitwhen i>5
if IsPlayerTeam1(GetTriggerPlayer())then
set JK=BO[i]
else
set JK=CO[i]
endif
set GK=K1[GetPlayerId(JK)]
if not(HK==null or GetOwningPlayer(HK)!=GetTriggerPlayer()or GK==null or GetOwningPlayer(GK)!=JK or JK==GetTriggerPlayer())then
if GL2(HK,GK,false)then
return
endif
endif
set i=i+1
endloop
return
elseif i<1 or i>5 then
call PZI(GetTriggerPlayer(),"无效的交换对象")
return
endif
set HK=K1[GetPlayerId(GetTriggerPlayer())]
if IsPlayerTeam1(GetTriggerPlayer())then
set JK=BO[i]
else
set JK=CO[i]
endif
set GK=K1[GetPlayerId(JK)]
if HK==null or GetOwningPlayer(HK)!=GetTriggerPlayer()or GK==null or GetOwningPlayer(GK)!=JK or JK==GetTriggerPlayer()then
call PZI(GetTriggerPlayer(),"无效的交换对象")
return
endif
call GL2(HK,GK,true)
endfunction
function GS2 takes nothing returns nothing
local integer i
local player p
local unit u
local string s
if GetLocalPlayer()==GetTriggerPlayer()then
call ClearTextMessages()
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45,"|cff99ccff"+"交换英雄选项："+"|r")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45," ")
set i=1
loop
exitwhen i>5
set p=BO[i]
set u=K1[GetPlayerId(p)]
if IsPlayerAlly(GetTriggerPlayer(),p)and GetTriggerPlayer()!=p and u!=null and GetOwningPlayer(u)==p then
set s=" "
if GJ2(K1[GetPlayerId(GetTriggerPlayer())],u)then
set s=" |c00ff0303("+"请求与你交换"+")|r"
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45,C0[GetPlayerId(p)]+I2S(i)+"|r"+" - "+"|cff99ccff"+GetUnitName(u)+"|r"+s)
endif
set p=CO[i]
set u=K1[GetPlayerId(p)]
if IsPlayerAlly(GetTriggerPlayer(),p)and GetTriggerPlayer()!=p and u!=null and GetOwningPlayer(u)==p then
set s=" "
if GJ2(K1[GetPlayerId(GetTriggerPlayer())],u)then
set s=" |c00ff0303("+"请求与你交换"+")|r"
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45,C0[GetPlayerId(p)]+I2S(i)+"|r"+" - "+"|cff99ccff"+GetUnitName(u)+"|r"+s)
endif
set i=i+1
endloop
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45," ")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45,"|cff99ccff"+"输入"+"|r |c00ff0303-swap #|r |cff99ccff"+"来做一个选择 或者"+" -swapcancel "+"来取消交换请求"+"|r")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,45," ")
endfunction
function GT2 takes player MDI returns boolean
local integer TGI=1
local integer GR2=0
loop
exitwhen TGI>5
if IsPlayerTeam1(MDI)then
if K1[GetPlayerId(BO[TGI])]!=null and BO[TGI]!=MDI and GetHeroLevel(K1[GetPlayerId(BO[TGI])])==1 then
set GR2=GR2+1
endif
else
if K1[GetPlayerId(CO[TGI])]!=null and CO[TGI]!=MDI and GetHeroLevel(K1[GetPlayerId(CO[TGI])])==1 then
set GR2=GR2+1
endif
endif
set TGI=TGI+1
endloop
if GR2>0 then
return true
else
return false
endif
endfunction
function GP2 takes nothing returns boolean
if FL or GL==false then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"-swaphero "+"被禁止了")
return false
endif
if S0[GetPlayerId(GetTriggerPlayer())]==true then
if GetPlayerState(GetTriggerPlayer(),PLAYER_STATE_RESOURCE_GOLD)<100 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,GetObjectName('N0MT'))
return false
endif
endif
if GetUnitState(K1[GetPlayerId(GetTriggerPlayer())],UNIT_STATE_LIFE)<1 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"你必须有一个活着的英雄才能选择和别人交换")
return false
endif
if CL==true then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"已经太晚，不能使用"+" -swaphero.")
return false
endif
if GT2(GetTriggerPlayer())==false then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"没有可供交换的英雄")
return false
endif
return true
endfunction
function EN2 takes nothing returns nothing
if GP2()then
if GetEventPlayerChatString()=="-swap"or GetEventPlayerChatString()=="-swaphero"then
call GS2()
elseif GetEventPlayerChatString()=="-swapcancel"then
call FlushChildHashtable(LY,(800+GetPlayerId(GetTriggerPlayer())))
else
call GN2()
endif
endif
endfunction
function GQ2 takes nothing returns boolean
return GetSpellAbilityId()=='A0FI'
endfunction
function GU2 takes integer IB1,unit H02,unit HI2 returns nothing
local integer TGI=1
local integer THI=GetUnitAbilityLevel(H02,IB1)
loop
exitwhen TGI>THI
call SelectHeroSkill(HI2,IB1)
set TGI=TGI+1
endloop
endfunction
function H12 takes nothing returns nothing
local integer TGI
local integer THI
local unit HO2
local location BFO=GetUnitLoc(GetTriggerUnit())
set HO2=CreateUnitAtLoc(GetOwningPlayer(GetTriggerUnit()),GetUnitTypeId(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call SetHeroXP(HO2,GetHeroXP(GetTriggerUnit()),false)
set TGI=1
set THI=GetUnitAbilityLevel(GetTriggerUnit(),'Aamk')
loop
exitwhen TGI>THI
call SelectHeroSkill(bj_lastCreatedUnit,'Aamk')
set TGI=TGI+1
endloop
set TGI=0
set THI=5
loop
exitwhen TGI>THI
call UnitAddItem(HO2,UnitItemInSlot(GetTriggerUnit(),TGI))
set TGI=TGI+1
endloop
if(GetUnitTypeId(GetTriggerUnit())=='Eevi')then
call GU2('A04L',GetTriggerUnit(),HO2)
call GU2('A0H4',GetTriggerUnit(),HO2)
call GU2('AEvi',GetTriggerUnit(),HO2)
call GU2('A07Q',GetTriggerUnit(),HO2)
endif
if(GetUnitTypeId(GetTriggerUnit())=='U008')then
call GU2('A03D',GetTriggerUnit(),HO2)
call GU2('A02G',GetTriggerUnit(),HO2)
call GU2('A03E',GetTriggerUnit(),HO2)
call GU2('A093',GetTriggerUnit(),HO2)
endif
if(GetUnitTypeId(GetTriggerUnit())=='U007')then
call GU2('A0F9',GetTriggerUnit(),HO2)
call GU2('A06Y',GetTriggerUnit(),HO2)
call GU2('A01E',GetTriggerUnit(),HO2)
call GU2('A028',GetTriggerUnit(),HO2)
endif
if(GetUnitTypeId(GetTriggerUnit())=='Hlgr')then
call GU2('A03G',GetTriggerUnit(),HO2)
call GU2('A03F',GetTriggerUnit(),HO2)
call GU2('A0O3',GetTriggerUnit(),HO2)
call GU2('AEim',GetTriggerUnit(),HO2)
endif
if(GetUnitTypeId(GetTriggerUnit())=='Ekee')then
call GU2('A035',GetTriggerUnit(),HO2)
call GU2('A06W',GetTriggerUnit(),HO2)
call GU2('A06V',GetTriggerUnit(),HO2)
call GU2('A06X',GetTriggerUnit(),HO2)
endif
call Q5I(GetTriggerUnit())
call RemoveLocation(BFO)
set K1[GetPlayerId(GetOwningPlayer(HO2))]=HO2
endfunction
function H22 takes nothing returns boolean
local integer SZI=GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])
return(SZI=='U008' or SZI=='U007' or SZI=='Hlgr' or SZI=='Eevi' or SZI=='Ekee')and(RectContainsUnit(G5,K1[GetPlayerId(GetTriggerPlayer())])or RectContainsUnit(H5,K1[GetPlayerId(GetTriggerPlayer())]))
endfunction
function H32 takes nothing returns nothing
local unit SFI=K1[GetPlayerId(GetTriggerPlayer())]
call UnitAddAbility(SFI,'A0FI')
call IssueImmediateOrder(SFI,"chemicalrage")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,120.00,"|c00ff0303"+"正在使用-recreate指令"+" "+S8I(GetEnumUnit())+". "+"请耐心等待约2分钟的时间"+"|r")
endfunction
function ES2 takes nothing returns nothing
if H22()then
call H32()
endif
endfunction
function H52 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer NPI=GetTriggerEvalCount(t)
local real x
local real y
if GetTriggerEventId()==EVENT_UNIT_DEATH or NPI>60 then
if((LoadInteger(LY,(GetHandleId((SFI))),((4259))))==1)==false then
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
call SetUnitPosition(SFI,x,y)
call PauseUnit(SFI,false)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call PauseUnit(SFI,true)
endif
set t=null
set SFI=null
return false
endfunction
function H62 takes player p returns nothing
local unit SFI=K1[GetPlayerId(p)]
local trigger t
if IsUnitDead(SFI)==false then
set t=CreateTrigger()
call DisplayTimedTextToPlayer(p,0,U2,30.0,"你在使用-unstuck命令，在60秒后，你将会被传送回基地")
call UnitRemoveBuffs(SFI,true,false)
call UnitRemoveAbility(SFI,'Bcyc')
call UnitRemoveAbility(SFI,'Bcy2')
call UnitRemoveAbility(SFI,'B02J')
call UnitRemoveAbility(SFI,'BUsp')
call UnitRemoveAbility(SFI,'Bust')
call UnitRemoveAbility(SFI,'B02F')
call PauseUnit(SFI,true)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function H52))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
endif
set p=null
set SFI=null
set t=null
endfunction
function H72 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call H62(p)
endif
set t=null
return false
endfunction
function ET2 takes nothing returns nothing
local player p=GetTriggerPlayer()
local unit SFI=K1[GetPlayerId(p)]
local trigger t
if IsUnitDead(SFI)==false then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,3.5,false)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function H72))
call SavePlayerHandle(LY,(GetHandleId(t)),(54),(p))
endif
set p=null
set SFI=null
set t=null
endfunction
function H82 takes player p returns string
local string s=K3[GetPlayerId(p)]
if K3[GetPlayerId(p)]!="Here"then
return" |c00ff0303("+"离开游戏"+" at "+SubString(s,10,StringLength(s))+"|c00ff0303)|r"
endif
return" "
endfunction
function ER2 takes nothing returns nothing
local integer TGI=1
local integer THI=5
local integer MLI
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,20," ")
if(IsPlayerTeam2(GetTriggerPlayer())==true)then
loop
exitwhen TGI>THI
set MLI=GetPlayerId(BO[TGI])
if(K1[MLI]!=null)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,20,C0[MLI]+(D80[GetPlayerId((BO[TGI]))])+"|r "+"控制"+" "+GetUnitName(K1[MLI])+" ("+"等级"+" "+I2S(GetUnitLevel(K1[MLI]))+")"+H82(BO[TGI]))
endif
set TGI=TGI+1
endloop
else
loop
exitwhen TGI>THI
set MLI=GetPlayerId(CO[TGI])
if(K1[MLI]!=null)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,20,C0[MLI]+(D80[GetPlayerId((CO[TGI]))])+"|r "+"控制"+" "+GetUnitName(K1[MLI])+" ("+"等级"+" "+I2S(GetUnitLevel(K1[MLI]))+")"+H82(CO[TGI]))
endif
set TGI=TGI+1
endloop
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,20," ")
endfunction
function HA2 takes unit u returns boolean
return GetUnitTypeId(u)=='N01O' or GetUnitTypeId(u)=='N013' or GetUnitTypeId(u)=='N014' or GetUnitTypeId(u)=='N015'
endfunction
function HB2 takes unit u returns unit
local integer handle_id=GetHandleId(GetOwningPlayer(u))
return(LoadUnitHandle(LY,(handle_id),(333)))
endfunction
function EP2 takes nothing returns nothing
local unit u
local integer i=0
if(K1[GetPlayerId(GetTriggerPlayer())]==null)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"你还没有选择英雄")
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,GetUnitName(K1[GetPlayerId(GetTriggerPlayer())])+" "+"的移动速度为"+" "+I2S(R2I(0.5+H51(K1[GetPlayerId(GetTriggerPlayer())]))))
if HA2(K1[GetPlayerId(GetTriggerPlayer())])then
set u=HB2(K1[GetPlayerId(GetTriggerPlayer())])
if u!=null then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,GetUnitName(u)+" "+"的移动速度为"+" "+I2S(R2I(0.5+GetUnitMoveSpeed(u))))
endif
endif
endif
endfunction
function EQ2 takes nothing returns nothing
local unit u
local integer i=0
if(K1[GetPlayerId(GetTriggerPlayer())]==null)then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"你还没有选择英雄")
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,GetUnitName(K1[GetPlayerId(GetTriggerPlayer())])+" "+"的移动速度为"+" "+I2S(R2I(0.5+H51(K1[GetPlayerId(GetTriggerPlayer())]))))
if HA2(K1[GetPlayerId(GetTriggerPlayer())])then
set u=HB2(K1[GetPlayerId(GetTriggerPlayer())])
if u!=null then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,GetUnitName(u)+" "+"的移动速度为"+" "+I2S(R2I(0.5+GetUnitMoveSpeed(u))))
endif
endif
loop
exitwhen i>16
set u=K1[i]
if u!=null and u!=K1[GetPlayerId(GetTriggerPlayer())]and IsUnitAlly(u,GetTriggerPlayer())==true then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,GetUnitName(u)+" "+"的移动速度为"+" "+I2S(R2I(0.5+GetUnitMoveSpeed(u))))
endif
set i=i+1
endloop
endif
endfunction
function EU2 takes nothing returns nothing
call SaveBoolean(LY,(GetHandleId(GetTriggerPlayer())),(139),(true))
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"拒绝友方一些特定的技能")
endfunction
function F02 takes nothing returns nothing
call SaveBoolean(LY,(GetHandleId(GetTriggerPlayer())),(139),(false))
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"允许队友对自己施放一些特定的友方技能")
endfunction
function FI2 takes nothing returns nothing
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"   "+"正补："+" "+I2S(A[GetPlayerId(GetTriggerPlayer())])+" "+"反补："+" "+I2S(B[GetPlayerId(GetTriggerPlayer())])+" "+"消灭中立单位数量："+" "+I2S(C[GetPlayerId(GetTriggerPlayer())]))
endfunction
function F12 takes nothing returns nothing
local integer x=GetPlayerId(GetTriggerPlayer())
if(GetEventPlayerChatString()=="-cson")then
set VM[x]=true
set RN0[x]=true
else
set VM[x]=false
set RN0[x]=false
endif
call UR1()
endfunction
function HG2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer i=(LoadInteger(LY,(handle_id),(34)))
local real x
local real y
if RV0[i]==false then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif K1[i]!=null and IsUnitDead(K1[i])==false then
set x=GetUnitX(K1[i])
set y=GetUnitY(K1[i])
call PanCameraToTimedForPlayer(Player(i),x,y,0)
endif
set t=null
return false
endfunction
function FQ2 takes nothing returns nothing
local integer x=GetPlayerId(GetTriggerPlayer())
local trigger t
local integer handle_id
local integer i
if RV0[x]==false and(GetEventPlayerChatString()=="-center"or GetEventPlayerChatString()=="-c")then
set RV0[x]=true
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerAddCondition(t,Condition(function HG2))
call SaveInteger(LY,(handle_id),(34),(x))
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"你开启了镜头置中；使用 -centeroff 或 -co 关闭镜头置中")
elseif GetEventPlayerChatString()=="-centeroff"or GetEventPlayerChatString()=="-co"then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"你关闭了镜头置中；使用 -center 或 -c 重新开启")
set RV0[x]=false
endif
endfunction
function G02 takes nothing returns nothing
set RW0[GetPlayerId(GetTriggerPlayer())]=false
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,5,"控制帮助选项已经关闭")
endfunction
function GI2 takes nothing returns nothing
set RW0[GetPlayerId(GetTriggerPlayer())]=true
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,5,"控制帮助选项已经开启")
endfunction
function FU2 takes nothing returns nothing
local integer i=0
local integer id=GetPlayerId(GetTriggerPlayer())
local integer NPI=0
local integer HV2=0
local player p
if RY0==false or JL==false then
return
endif
if RK0+90<(TimerGetElapsed(M))then
loop
exitwhen i>15
set RJ0[i]=false
set i=i+1
endloop
endif
set RK0=(TimerGetElapsed(M))+90
set RJ0[id]=true
set i=0
loop
exitwhen i>15
if IsPlayerTeam1(GetTriggerPlayer())then
if IsPlayerTeam1(Player(i))and T3I(Player(i))then
set HV2=HV2+1
if RJ0[i]then
set NPI=NPI+1
endif
endif
else
if IsPlayerTeam2(Player(i))and T3I(Player(i))then
set HV2=HV2+1
if RJ0[i]then
set NPI=NPI+1
endif
endif
endif
set i=i+1
endloop
if NPI*2>HV2 then
if IsPlayerTeam1(GetTriggerPlayer())then
set i=0
loop
exitwhen i>5
set p=BO[i]
if EF0[GetPlayerId(p)]==true and RX0[GetPlayerId(p)]==false then
call QRI(OO,10,"已经为该玩家解锁金钱和物品："+" "+(D80[GetPlayerId((p))]))
call BB1(p)
set RX0[GetPlayerId(p)]=true
endif
set i=i+1
endloop
else
set i=0
loop
exitwhen i>5
set p=CO[i]
if EF0[GetPlayerId(p)]==true and RX0[GetPlayerId(p)]==false then
call QRI(AO,10,"已经为该玩家解锁金钱和物品："+" "+(D80[GetPlayerId((p))]))
call BB1(p)
set RX0[GetPlayerId(p)]=true
endif
set i=i+1
endloop
endif
else
if IsPlayerTeam1(GetTriggerPlayer())then
call QRI(OO,10,"解锁总计："+" "+I2S(NPI)+"/"+I2S(HV2)+" ("+(D80[GetPlayerId((GetTriggerPlayer()))])+")")
else
call QRI(AO,10,"解锁总计："+" "+I2S(NPI)+"/"+I2S(HV2)+" ("+(D80[GetPlayerId((GetTriggerPlayer()))])+")")
endif
endif
endfunction
function HX2 takes nothing returns nothing
local integer i=1
local integer Q4I
local player p
loop
exitwhen i>5
set p=BO[i]
set Q4I=R2I(TimerGetRemaining(F0[GetPlayerId(p)]))
if Q4I>0 and RL0[GetPlayerId(p)]and WL==false and Q2==false then
call PlayerSetLeaderboard(p,RM0[GetPlayerId(p)])
call LeaderboardDisplay(RM0[GetPlayerId(p)],true)
call LeaderboardSetLabel(RM0[GetPlayerId(p)],"   "+"复活剩余时间："+" "+I2S(Q4I)+" "+"秒")
else
call LeaderboardDisplay(RM0[GetPlayerId(p)],false)
endif
set p=CO[i]
set Q4I=R2I(TimerGetRemaining(F0[GetPlayerId(p)]))
if Q4I>0 and RL0[GetPlayerId(p)]and WL==false and Q2==false then
call PlayerSetLeaderboard(p,RM0[GetPlayerId(p)])
call LeaderboardDisplay(RM0[GetPlayerId(p)],true)
call LeaderboardSetLabel(RM0[GetPlayerId(p)],"   "+"复活剩余时间："+" "+I2S(Q4I)+" "+"秒")
else
call LeaderboardDisplay(RM0[GetPlayerId(p)],false)
endif
set i=i+1
endloop
endfunction
function HY2 takes nothing returns nothing
local integer x=0
set x=x+1
set RM0[GetPlayerId(BO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[x],RM0[GetPlayerId(BO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(BO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(BO[x])],"重生"+": ")
set RM0[GetPlayerId(CO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(CO[x],RM0[GetPlayerId(CO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(CO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(CO[x])],"重生"+": ")
set x=x+1
set RM0[GetPlayerId(BO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[x],RM0[GetPlayerId(BO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(BO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(BO[x])],"重生"+": ")
set RM0[GetPlayerId(CO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(CO[x],RM0[GetPlayerId(CO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(CO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(CO[x])],"重生"+": ")
set x=x+1
set RM0[GetPlayerId(BO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[x],RM0[GetPlayerId(BO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(BO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(BO[x])],"重生"+": ")
set RM0[GetPlayerId(CO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(CO[x],RM0[GetPlayerId(CO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(CO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(CO[x])],"重生"+": ")
set x=x+1
set RM0[GetPlayerId(BO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[x],RM0[GetPlayerId(BO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(BO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(BO[x])],"重生"+": ")
set RM0[GetPlayerId(CO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(CO[x],RM0[GetPlayerId(CO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(CO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(CO[x])],"重生"+": ")
set x=x+1
set RM0[GetPlayerId(BO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(BO[x],RM0[GetPlayerId(BO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(BO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(BO[x])],"重生"+": ")
set RM0[GetPlayerId(CO[x])]=CreateLeaderboard()
call PlayerSetLeaderboard(CO[x],RM0[GetPlayerId(CO[x])])
call LeaderboardDisplay(RM0[GetPlayerId(CO[x])],false)
call LeaderboardSetLabel(RM0[GetPlayerId(CO[x])],"重生"+": ")
endfunction
function F62 takes nothing returns nothing
local integer x=GetPlayerId(GetTriggerPlayer())
if GetEventPlayerChatString()=="-don"or GetEventPlayerChatString()=="-deathon"then
set RL0[x]=true
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"在你死后，将会出现等待复活计时器")
else
set RL0[x]=false
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"在你死后，不会出现等待复活计时器")
endif
endfunction
function HJ2 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerAddAction(t,function HY2)
call TriggerRegisterTimerEvent(t,.5,false)
set t=CreateTrigger()
call TriggerAddAction(t,function HX2)
call TriggerRegisterTimerEvent(t,1,true)
endfunction
function F42 takes nothing returns nothing
if(GetEventPlayerChatString()=="-showdeny")then
set RN0[GetPlayerId(GetTriggerPlayer())]=true
else
set RN0[GetPlayerId(GetTriggerPlayer())]=false
endif
endfunction
function F52 takes nothing returns nothing
call PZI(GetTriggerPlayer(),"-di功能默认为开启，使用-cson和-csoff命令可以开/关该功能")
endfunction
function HM2 takes nothing returns nothing
local integer i=0
loop
exitwhen i>16
set RN0[i]=true
set VM[i]=true
set i=i+1
endloop
endfunction
function FO2 takes nothing returns nothing
call ForceRemovePlayer(P2,GetTriggerPlayer())
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"隐藏信息")
endfunction
function F22 takes nothing returns nothing
call ForceAddPlayer(P2,GetTriggerPlayer())
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"显示信息")
endfunction
function HT2 takes nothing returns boolean
local integer x=GetRandomInt(1,4)
if x==1 then
set RT0=Z3
elseif x==2 then
set RT0=V3
elseif x==3 then
set RT0=KS
elseif x==4 then
set RT0=LS
endif
if RR0[GetPlayerId(GetLocalPlayer())]then
call EnableWeatherEffect(Z3,false)
call EnableWeatherEffect(V3,false)
call EnableWeatherEffect(KS,false)
call EnableWeatherEffect(LS,false)
call EnableWeatherEffect(RT0,true)
endif
return false
endfunction
function HR2 takes nothing returns nothing
local integer x=GetRandomInt(1,4)
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,300,true)
call TriggerAddCondition(t,Condition(function HT2))
set RR0[GetPlayerId(BO[1])]=false
set RR0[GetPlayerId(BO[2])]=false
set RR0[GetPlayerId(BO[3])]=false
set RR0[GetPlayerId(BO[4])]=false
set RR0[GetPlayerId(BO[5])]=false
set RR0[GetPlayerId(CO[1])]=false
set RR0[GetPlayerId(CO[2])]=false
set RR0[GetPlayerId(CO[3])]=false
set RR0[GetPlayerId(CO[4])]=false
set RR0[GetPlayerId(CO[5])]=false
if C2 then
set RR0[GetPlayerId(D60)]=false
set RR0[GetPlayerId(D70)]=false
endif
if x==1 then
set RT0=Z3
elseif x==2 then
set RT0=V3
elseif x==3 then
set RT0=KS
elseif x==4 then
set RT0=LS
endif
set t=null
endfunction
function F32 takes nothing returns nothing
local string DC2=StringCase(GetEventPlayerChatString(),false)
if RS0==true then
set RS0=false
call HR2()
endif
if DC2=="-weather snow"and GetLocalPlayer()==GetTriggerPlayer()then
set RR0[GetPlayerId(GetTriggerPlayer())]=false
call EnableWeatherEffect(Z3,true)
call EnableWeatherEffect(V3,false)
call EnableWeatherEffect(KS,false)
call EnableWeatherEffect(LS,false)
endif
if DC2=="-weather rain"and GetLocalPlayer()==GetTriggerPlayer()then
set RR0[GetPlayerId(GetTriggerPlayer())]=false
call EnableWeatherEffect(Z3,false)
call EnableWeatherEffect(V3,true)
call EnableWeatherEffect(KS,false)
call EnableWeatherEffect(LS,false)
endif
if DC2=="-weather moonlight"and GetLocalPlayer()==GetTriggerPlayer()then
set RR0[GetPlayerId(GetTriggerPlayer())]=false
call EnableWeatherEffect(Z3,false)
call EnableWeatherEffect(V3,false)
call EnableWeatherEffect(KS,true)
call EnableWeatherEffect(LS,false)
endif
if DC2=="-weather wind"and GetLocalPlayer()==GetTriggerPlayer()then
set RR0[GetPlayerId(GetTriggerPlayer())]=false
call EnableWeatherEffect(Z3,false)
call EnableWeatherEffect(V3,false)
call EnableWeatherEffect(KS,false)
call EnableWeatherEffect(LS,true)
endif
if DC2=="-weather off"and GetLocalPlayer()==GetTriggerPlayer()then
set RR0[GetPlayerId(GetTriggerPlayer())]=false
call EnableWeatherEffect(Z3,false)
call EnableWeatherEffect(V3,false)
call EnableWeatherEffect(KS,false)
call EnableWeatherEffect(LS,false)
endif
if DC2=="-weather random"then
set RR0[GetPlayerId(GetTriggerPlayer())]=true
if GetLocalPlayer()==GetTriggerPlayer()then
call EnableWeatherEffect(Z3,false)
call EnableWeatherEffect(V3,false)
call EnableWeatherEffect(KS,false)
call EnableWeatherEffect(LS,false)
call EnableWeatherEffect(RT0,true)
endif
endif
endfunction
function F72 takes nothing returns nothing
local integer a=S2I(SubString(GetEventPlayerChatString(),6,StringLength(GetEventPlayerChatString())))
local integer MLI=GetPlayerId(GetTriggerPlayer())
set FM[MLI]=FM[MLI]+1
if FM[MLI]>20 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"你用太多次！")
return
endif
if GetEventPlayerChatString()=="-rollon"or GetEventPlayerChatString()=="-rolloff"then
return
endif
if a==0 then
set a=100
endif
if a>0 and a<2001 then
call QQI(P2,5,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r "+"掷出了"+" "+I2S(GetRandomInt(1,a))+" "+"上限为"+" "+I2S(a))
else
call PZI(GetTriggerPlayer(),"Roll的取值必须在1与2000之间")
endif
endfunction
function FN2 takes nothing returns nothing
local integer a
if GetRandomInt(1,2)==1 then
set a=GetRandomInt(DG0,DH0)
else
set a=GetRandomInt(DE0,DF0)
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"你随机掷到了"+" "+S9I(a))
endfunction
function FK2 takes nothing returns nothing
local integer a=S2I(SubString(GetEventPlayerChatString(),4,StringLength(GetEventPlayerChatString())))
if GetTriggerPlayer()!=BO[1]or a>2 or a<1 or CN==false or TimerGetElapsed(M)>14 or PV0==true then
return
endif
set PK0=a
set PL0=a
set PZ0=true
if a==1 then
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(BO[1])]+(D80[GetPlayerId((BO[1]))])+"|r "+"被手动指定以开始选择英雄")
else
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(CO[1])]+(D80[GetPlayerId((CO[1]))])+"|r "+"被手动指定以开始选择英雄")
endif
if PK0==1 then
set PM0=BO[1]
set PN0=CO[1]
else
set PM0=CO[1]
set PN0=BO[1]
endif
endfunction
function FZ2 takes nothing returns nothing
set GM[GetPlayerId(GetTriggerPlayer())]=false
endfunction
function FV2 takes nothing returns nothing
set GM[GetPlayerId(GetTriggerPlayer())]=true
endfunction
function F82 takes nothing returns nothing
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"聊天中的英雄名称将被隐藏")
set RP0[GetPlayerId(GetTriggerPlayer())]=true
if GetLocalPlayer()==GetTriggerPlayer()then
call SetPlayerName(BO[1],(D80[GetPlayerId((BO[1]))]))
call SetPlayerName(BO[2],(D80[GetPlayerId((BO[2]))]))
call SetPlayerName(BO[3],(D80[GetPlayerId((BO[3]))]))
call SetPlayerName(BO[4],(D80[GetPlayerId((BO[4]))]))
call SetPlayerName(BO[5],(D80[GetPlayerId((BO[5]))]))
call SetPlayerName(CO[1],(D80[GetPlayerId((CO[1]))]))
call SetPlayerName(CO[2],(D80[GetPlayerId((CO[2]))]))
call SetPlayerName(CO[3],(D80[GetPlayerId((CO[3]))]))
call SetPlayerName(CO[4],(D80[GetPlayerId((CO[4]))]))
call SetPlayerName(CO[5],(D80[GetPlayerId((CO[5]))]))
endif
endfunction
function F92 takes nothing returns nothing
local integer id=GetPlayerId(GetTriggerPlayer())
if HM[id]==true then
set HM[id]=false
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"打开特殊音效")
else
set HM[id]=true
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"关闭特殊音效")
endif
endfunction
function FR2 takes nothing returns nothing
local integer id=GetPlayerId(GetTriggerPlayer())
set RQ0[id]=true
endfunction
function FH2 takes nothing returns nothing
endfunction
function FC2 takes nothing returns nothing
local integer i=1
local player p
local real Z12
loop
exitwhen i>5
set p=BO[i]
if T3I(p)then
set Z12=K[GetPlayerId(p)]/(TimerGetElapsed(M))*60
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"的APM为"+" "+R2S(Z12))
endif
set p=CO[i]
if T3I(p)then
set Z12=K[GetPlayerId(p)]/(TimerGetElapsed(M))*60
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"的APM为"+" "+R2S(Z12))
endif
set i=i+1
endloop
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00," ")
set p=null
endfunction
function FD2 takes nothing returns nothing
call A31(GetTriggerPlayer())
endfunction
function ZO2 takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
set RU0=true
return false
endfunction
function Z22 takes real d returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,d,false)
call TriggerAddCondition(t,Condition(function ZO2))
set t=null
endfunction
function Z32 takes player MDI returns nothing
local integer Z42
local player Z52
set Z42=0
loop
set Z52=Player(Z42)
if(PlayersAreCoAllied(MDI,Z52)and MDI!=Z52)then
call SetPlayerAlliance(MDI,Z52,ALLIANCE_SHARED_VISION,true)
call SetPlayerAlliance(MDI,Z52,ALLIANCE_SHARED_CONTROL,true)
call SetPlayerAlliance(Z52,MDI,ALLIANCE_SHARED_CONTROL,true)
endif
set Z42=Z42+1
exitwhen Z42==12
endloop
endfunction
function FB2 takes nothing returns nothing
local integer MLI=S2I(SubString(GetEventPlayerChatString(),9,StringLength(GetEventPlayerChatString())))
local integer i=1
local player p
local string GW1
if RU0 then
if(Z0<10)then
set GW1=I2S(H0)+":0"+I2S(Z0)
else
set GW1=I2S(H0)+":"+I2S(Z0)
endif
if MLI<1 or P00[MLI]==false then
loop
exitwhen i>5
set p=BO[i]
if T3I(p)and((TimerGetElapsed(M))-L[GetPlayerId(p)])>300.0 and P00[GetPlayerId(p)]==false then
set P00[GetPlayerId(p)]=true
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"已经离开游戏超过"+" "+R2S(((TimerGetElapsed(M))-L[GetPlayerId(p)])/60)+" "+GetObjectName('N05F'))
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,"你可以使用"+" |cff99ccff-kickafk "+I2S(GetPlayerId(p))+" |r "+"将这位玩家踢出游戏")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00," ")
endif
set p=CO[i]
if T3I(p)and((TimerGetElapsed(M))-L[GetPlayerId(p)])>300.0 and P00[GetPlayerId(p)]==false then
set P00[GetPlayerId(p)]=true
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"已经离开游戏超过"+" "+R2S(((TimerGetElapsed(M))-L[GetPlayerId(p)])/60)+" "+GetObjectName('N05F'))
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,"你可以使用"+" |cff99ccff-kickafk "+I2S(GetPlayerId(p))+" |r "+"将这位玩家踢出游戏")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00," ")
endif
set i=i+1
endloop
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00," ")
elseif T3I(Player(MLI))==true and IsPlayerAlly(GetTriggerPlayer(),Player(MLI))==true then
call DisplayTimedTextToPlayer(Player(MLI),0,U2,3600,"|c00ff0303"+"因为暂离时间过长而被踢出游戏！"+"|r")
call VY1(Player(MLI))
set K3[GetPlayerId(Player(MLI))]="|c00555555"+GW1+"|r"
call RemovePlayer(Player(MLI),PLAYER_GAME_RESULT_DEFEAT)
call Z32(Player(MLI))
if JL then
call B91(Player(MLI))
endif
set EF0[GetPlayerId(Player(MLI))]=true
call VX1(Player(MLI))
call QRI(P2,30.00,"|c00ff0303"+(D80[GetPlayerId((Player(MLI)))])+" "+"因为暂离时间过长而被踢出游戏！"+"|r")
endif
endif
endfunction
function FA2 takes nothing returns nothing
local integer i=1
local player p
local integer x=0
if RU0 then
loop
exitwhen i>5
set p=BO[i]
if T3I(p)and((TimerGetElapsed(M))-L[GetPlayerId(p)])/60>0.2 then
set x=x+1
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"已经离开游戏了"+" "+R2S(((TimerGetElapsed(M))-L[GetPlayerId(p)])/60)+" "+GetObjectName('N05F'))
endif
set p=CO[i]
if T3I(p)and((TimerGetElapsed(M))-L[GetPlayerId(p)])/60>0.2 then
set x=x+1
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"已经离开游戏了"+" "+R2S(((TimerGetElapsed(M))-L[GetPlayerId(p)])/60)+" "+GetObjectName('N05F'))
endif
set i=i+1
endloop
if x<1 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,GetObjectName('N05Q'))
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00," ")
endif
endif
endfunction
function Z62 takes nothing returns boolean
local integer i=1
local player p
local real GW1=(TimerGetElapsed(M))
if RU0 then
loop
exitwhen i>5
set p=BO[i]
if T3I(p)and(GW1-L[GetPlayerId(p)])>300.0 and P00[GetPlayerId(p)]==false then
set P00[GetPlayerId(p)]=true
call QRI(OO,15,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"已经离开游戏超过"+" "+R2S((GW1-L[GetPlayerId(p)])/60)+" "+GetObjectName('N05F'))
call QRI(OO,15,"你可以使用"+" |cff99ccff-kickafk "+I2S(GetPlayerId(p))+" |r "+"将这位玩家踢出游戏")
call QRI(OO,15," ")
endif
set p=CO[i]
if T3I(p)and(GW1-L[GetPlayerId(p)])>300.0 and P00[GetPlayerId(p)]==false then
set P00[GetPlayerId(p)]=true
call QRI(AO,15,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r"+" "+"已经离开游戏超过"+" "+R2S((GW1-L[GetPlayerId(p)])/60)+" "+GetObjectName('N05F'))
call QRI(AO,15,"你可以使用"+" |cff99ccff-kickafk "+I2S(GetPlayerId(p))+" |r "+"将这位玩家踢出游戏")
call QRI(AO,15," ")
endif
set i=i+1
endloop
endif
return false
endfunction
function Z72 takes nothing returns boolean
if GetOwningPlayer(GetTriggerUnit())!=BO[0]and GetOwningPlayer(GetTriggerUnit())!=CO[0]then
set K[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]=K[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]+1
if GetIssuedOrderId()!=851983 then
set L[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]=(TimerGetElapsed(M))
set P00[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]=false
endif
if(GetIssuedOrderId()==851983 or GetIssuedOrderId()==851971)and GetOrderTargetItem()!=null then
	if GetIssuedOrderId()==851983 then
		// 发布攻击指令
		if IsPlayerAlly(GetItemPlayer(GetOrderTargetItem()), GetOwningPlayer(GetTriggerUnit())) and GetItemPlayer(GetOrderTargetItem())!=Player(15) then
			call DisableTrigger(GetTriggeringTrigger())
			call PJI(GetTriggerUnit())
			call PZI(GetOwningPlayer(GetTriggerUnit()),"不能攻击友方的物品")
			call EnableTrigger(GetTriggeringTrigger())
		endif
	elseif (GetIssuedOrderId()==851971 and(LoadBoolean(LY,(GetHandleId(GetItemPlayer(GetOrderTargetItem()))),(139)))==true) then
		// 开启disablehelp后发布右键物品指令
		if IsPlayerAlly(GetItemPlayer(GetOrderTargetItem()), GetOwningPlayer(GetTriggerUnit())) and GetItemPlayer(GetOrderTargetItem()) != GetOwningPlayer(GetTriggerUnit()) then
			call DisableTrigger(GetTriggeringTrigger())
			call PJI(GetTriggerUnit())
			call PZI(GetOwningPlayer(GetTriggerUnit()),"不能拾取友方的物品,他拒绝帮助(-disablehelp)")
			call EnableTrigger(GetTriggeringTrigger())
		endif
	endif
endif
endif
return false
endfunction
function Z92 takes nothing returns boolean
return RYI(GetFilterUnit())and GetOwningPlayer(GetFilterUnit())==GetTriggerPlayer()
endfunction
function Courier_Add takes nothing returns nothing
call UnitAddType(GetEnumUnit(),UNIT_TYPE_PEON)
endfunction
function Courier_Remove takes nothing returns nothing
call UnitRemoveType(GetEnumUnit(),UNIT_TYPE_PEON)
endfunction
function FE2 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsInRange(g,0,0,12000,Condition(function Z92))
call NSI(g)
set g=null
endfunction
function ZB2 takes nothing returns nothing
local string DC2=StringCase(GetEventPlayerChatString(),false)
local boolean ZC2=DC2=="-mode1"
local boolean ZD2=DC2=="-mode2"
if ZC2==false and ZD2==false then
return
endif
if(TimerGetElapsed(M))>60 then
call PXI(GetTriggerPlayer(),"命令必须在游戏开始后15至60秒内键入")
return
elseif(TimerGetElapsed(M))<15 then
call PXI(GetTriggerPlayer(),"命令必须在游戏开始后15至60秒内键入")
return
endif
if ZC2 then
set UK=1
elseif ZD2 then
set UK=2
endif
call C82()
call QRI(P2,15,"这个指令带有实验性质。如果在使用中遇到bug，"+" "+"请致信IceFrog@gmail.com。")
call QRI(P2,15,"游戏中出现的暂停并非bug")
call FlushTrigger(GetTriggeringTrigger())
endfunction
function ZE2 takes nothing returns boolean
call ExecuteFunc("ZB2")
return false
endfunction
function AH_RegisterCommands takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,WO,"-",false)
call TriggerAddCondition(t,Condition(function ZE2))
call QRI(P2,30,"|cff99ccff"+"游戏在选择这个模式后将暂停一会"+"|r")
call QRI(P2,30,"提示文字将在不久后被清除"+" "+"如果你想阅读屏幕当前文字，请先暂停游戏"+" "+"当你准备好之后，继续进行游戏并选择一个模式"+" ")
call QRI(P2,30," ")
call QRI(P2,30,"|cff99ccff-mode1|r "+"这个模式是一个基础模式，只监控小地图"+". ("+"只在-mode2 遇到问题时使用此模式"+")")
call QRI(P2,30,"|cff99ccff-mode2|r "+"这个模式监控更广的区域，也是|c00ff0303推荐|r模式")
endfunction
function AH_RegisterCommands_Delayed takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.5,false)
set t=null
endfunction
function FF2 takes nothing returns nothing
if(TimerGetElapsed(M))>60 then
call PXI(GetTriggerPlayer(),"命令必须在游戏开始后15至60秒内键入")
return
elseif(TimerGetElapsed(M))<15 then
call PXI(GetTriggerPlayer(),"命令必须在游戏开始后15至60秒内键入")
return
endif
if GetTriggerPlayer()!=WO then
call PXI(GetTriggerPlayer(),"只有选择游戏模式的玩家才能使用该命令")
return
endif
if IL==false then
set IL=true
set UK=2
call C82()
call QRI(P2,15,"这个指令带有实验性质。如果在使用中遇到bug，"+" "+"请致信IceFrog@gmail.com。")
call QRI(P2,15,"游戏中出现的暂停并非bug")
else
call PZI(GetTriggerPlayer(),"代码已经被激活")
endif
endfunction
function FG2 takes nothing returns nothing
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"阳炎冲击"+" [|cffff0000E|r|cffff0000E|r|cffff0000E|r] - [|cffffcc00T|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"浑沌陨石"+" [|cffff0000E|r|cffff0000E|r|cff00ffffW|r] - [|cffffcc00D|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"熔炉精灵"+" [|cffff0000E|r|cffff0000E|r|cff0000ffQ|r] - [|cffffcc00F|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"急速冷却"+" [|cff0000ffQ|r|cff0000ffQ|r|cff0000ffQ|r] - [|cffffcc00Y|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"幽灵漫步"+" [|cff0000ffQ|r|cff0000ffQ|r|cff00ffffW|r] - [|cffffcc00V|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"寒冰之墙"+" [|cff0000ffQ|r|cff0000ffQ|r|cffff0000E|r] - [|cffffcc00G|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"灵动迅捷"+" [|cff00ffffW|r|cff00ffffW|r|cffff0000E|r] - [|cffffcc00Z|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"龙卷风"+" [|cff00ffffW|r|cff00ffffW|r|cff0000ffQ|r] - [|cffffcc00X|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"电磁脉冲"+" [|cff00ffffW|r|cff00ffffW|r|cff00ffffW|r] - [|cffffcc00C|r]")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"超震声波"+" [|cff0000ffQ|r|cff00ffffW|r|cffff0000E|r] - [|cffffcc00B|r]")
endfunction
function ZF2 takes string s returns nothing
call StopMusic(true)
call PlayMusic(s)
endfunction
function FW2 takes nothing returns nothing
local string s=GetEventPlayerChatString()
local integer TJI=GetRandomInt(1,P10)
if GetLocalPlayer()==GetTriggerPlayer()then
if s=="-music off"then
call StopMusic(false)
elseif s=="-music random"then
call ZF2(PI0[TJI])
elseif s=="-music nightelf1"then
call ZF2(AD)
elseif s=="-music nightelf2"then
call ZF2(BD)
elseif s=="-music nightelf3"then
call ZF2(DD)
elseif s=="-music human1"then
call ZF2(KC)
elseif s=="-music human2"then
call ZF2(LC)
elseif s=="-music human3"then
call ZF2(MC)
elseif s=="-music orc1"then
call ZF2(FD)
elseif s=="-music orc2"then
call ZF2(GD)
elseif s=="-music orc3"then
call ZF2(HD)
elseif s=="-music undead1"then
call ZF2(BE)
elseif s=="-music undead2"then
call ZF2(CE)
elseif s=="-music undead3"then
call ZF2(DE)
elseif s=="-music other1"then
call ZF2(ZD)
elseif s=="-music other2"then
call ZF2(VD)
elseif s=="-music other3"then
call ZF2(WD)
elseif s=="-music other4"then
call ZF2(XD)
elseif s=="-music other5"then
call ZF2(YD)
elseif s=="-music other6"then
call ZF2(GF)
elseif s=="-music other7"then
call ZF2(HF)
elseif s=="-music other8"then
call ZF2(ZF)
elseif s=="-music other9"then
call ZF2(VF)
elseif s=="-music special"then
call ZF2(PO0)
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"可以使用 -music [曲目] 命令来播放音乐，具体[曲目]为："+" ")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"off, random, nightelf1, nightelf2, nightelf3, human1, human2, human3, orc1, orc2, orc3, undead1, undead2, undead3, other1, other2, other3, other4, other5, other6, other7, other8, other9, special")
endif
endif
endfunction
function ZG2 takes nothing returns boolean
set P10=P10+1
set PI0[P10]=AD
set P10=P10+1
set PI0[P10]=BD
set P10=P10+1
set PI0[P10]=DD
set P10=P10+1
set PI0[P10]=KC
set P10=P10+1
set PI0[P10]=LC
set P10=P10+1
set PI0[P10]=MC
set P10=P10+1
set PI0[P10]=FD
set P10=P10+1
set PI0[P10]=GD
set P10=P10+1
set PI0[P10]=HD
set P10=P10+1
set PI0[P10]=BE
set P10=P10+1
set PI0[P10]=CE
set P10=P10+1
set PI0[P10]=DE
set P10=P10+1
set PI0[P10]=ZD
set P10=P10+1
set PI0[P10]=VD
set P10=P10+1
set PI0[P10]=WD
set P10=P10+1
set PI0[P10]=XD
set P10=P10+1
set PI0[P10]=YD
set P10=P10+1
set PI0[P10]=GF
set P10=P10+1
set PI0[P10]=HF
set P10=P10+1
set PI0[P10]=ZF
set P10=P10+1
set PI0[P10]=VF
set P10=P10+1
set PI0[P10]=PO0
return false
endfunction
function ZZ2 takes player p,integer r,integer g,integer b,integer a returns nothing
if GetLocalPlayer()==p then
call SetWaterBaseColor(r,g,b,a)
endif
endfunction
function ZV2 takes string s returns nothing
local string ZW2=""
local string ZX2=""
local string ZY2=""
local integer i=0
local integer EU1=StringLength(s)
local integer ZJ2=1
loop
exitwhen i>EU1
if SubString(s,i,i+1)==" "then
set ZJ2=ZJ2+1
else
if ZJ2==1 then
set ZW2=ZW2+SubString(s,i,i+1)
elseif ZJ2==2 then
set ZX2=ZX2+SubString(s,i,i+1)
else
set ZY2=ZY2+SubString(s,i,i+1)
endif
endif
set i=i+1
endloop
set P30=S2I(ZW2)
set P40=S2I(ZX2)
set P50=S2I(ZY2)
endfunction
function FY2 takes nothing returns nothing
local string ZK2=SubString(GetEventPlayerChatString(),7,StringLength(GetEventPlayerChatString()))
local player p=GetTriggerPlayer()
local integer r
local integer g
local integer b
set P20[GetPlayerId(p)]=true
if ZK2=="red"then
call ZZ2(p,255,0,0,255)
elseif ZK2=="blue"then
call ZZ2(p,0,0,255,255)
elseif ZK2=="green"then
call ZZ2(p,0,255,0,255)
elseif ZK2=="default"then
call ZZ2(p,0,0,255,255)
elseif ZK2=="random"then
set r=GetRandomInt(0,255)
set g=GetRandomInt(0,255)
set b=GetRandomInt(0,255)
call ZZ2(p,r,g,b,255)
call DisplayTimedTextToPlayer(p,0,0,5,"你随机地设置水的颜色为"+" r="+I2S(r)+" g="+I2S(g)+" b="+I2S(b))
else
call ZV2(ZK2)
set r=P30
set g=P40
set b=P50
if r==0 and g==0 and b==0 and ZK2!="0 0 0"then
return
endif
if r>=0 and r<=255 and g>=0 and g<=255 and b>=0 and b<=255 then
call ZZ2(p,r,g,b,255)
endif
endif
endfunction
function FL2 takes nothing returns nothing
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,15.00,"This command has been temporarily disabled")
endfunction
function FM2 takes nothing returns boolean
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"Total Bonus XP/Gold: "+I2S(FA0[GetPlayerId(GetTriggerPlayer())])+"/"+I2S(FB0[GetPlayerId(GetTriggerPlayer())]))
return false
endfunction
function GO2 takes nothing returns boolean
if BII>0 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"赏金总计"+": "+I2S(BII))
endif
return false
endfunction
function Quote_ReplaySound takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer x=(LoadInteger(LY,(handle_id),(148)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
call PEI(p,P60[x])
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set p=null
return false
endfunction
function FJ2 takes nothing returns nothing
local string s=GetEventPlayerChatString()
local trigger t
local integer x=S2I(SubString(GetEventPlayerChatString(),7,StringLength(GetEventPlayerChatString())))
local integer i=1
if x<1 or x>P80 then
set x=GetRandomInt(1,P80)
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"你随机地引用编号"+" "+I2S(x))
endif
if P90 then
loop
exitwhen i>P80
call AM1(P60[i])
set i=i+1
endloop
set P90=false
endif
if P70[x]==false then
endif
call PEI(GetTriggerPlayer(),P60[x])
endfunction
function ZN2 takes player p1 returns string
local string s="$p1 $c1 拒绝了你的交换请求"
set s=FS1(s,"$c1","|c00ff0303")
set s=FS1(s,"$p1",C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r")
return s
endfunction
function ZS2 takes nothing returns string
local string s="$c1如果你想投否决票，键入|r $c2-no|r"
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c2","|c00ff0303")
return s
endfunction
function ZT2 takes nothing returns nothing
local integer i=1
local unit SFI
if IL then
loop
exitwhen i>5
set SFI=K1[GetPlayerId(BO[i])]
if SFI!=null then
if UK==2 then
call FV1(SFI)
endif
call UnitSetUsesAltIcon(SFI,false)
endif
set SFI=K1[GetPlayerId(CO[i])]
if SFI!=null then
if UK==2 then
call FV1(SFI)
endif
call UnitSetUsesAltIcon(SFI,false)
endif
set i=i+1
endloop
set SFI=null
endif
endfunction
function ZR2 takes player p1,player p2 returns string
local string s="$c1键入|r $c2-switch accept|r $c1或|r $c2-ok|r $c1来允许玩家|r $p1 $c1与玩家|r $p2 $c1的交换|r"
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c2","|c00ff0303")
set s=FS1(s,"$c2","|c00ff0303")
set s=FS1(s,"$p1",C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r")
set s=FS1(s,"$p2",C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r")
return s
endfunction
function ZP2 takes string ZQ2,string ZU2 returns string
local string s="$c1|r$p1 和 |r $p2 $c1的交换已经成功"
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$c1","|c006699CC")
set s=FS1(s,"$p1",ZQ2)
set s=FS1(s,"$p2",ZU2)
return s
endfunction
function V02 takes player p2 returns string
local string s="$c1你已经请求玩家|r$p2$c1与交换位置|r"
set s=FS1(s,"$p2",C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r")
set s=FS1(s,"$c1","|c006699CC")
return s
endfunction
function VI2 takes player p returns nothing
local integer TGI
local integer THI
if(IsPlayerTeam1(p)==true)then
set TGI=1
set THI=5
loop
exitwhen TGI>THI
if(BO[TGI]!=p)then
if(T3I(BO[TGI])==true)then
call SetPlayerAllianceStateBJ(p,BO[TGI],4)
endif
endif
set TGI=TGI+1
endloop
else
set TGI=1
set THI=5
loop
exitwhen TGI>THI
if(CO[TGI]!=p)then
if(T3I(CO[TGI])==true)then
call SetPlayerAllianceStateBJ(p,CO[TGI],4)
endif
endif
set TGI=TGI+1
endloop
endif
endfunction
function V12 takes nothing returns nothing
if GetOwningPlayer(GetEnumUnit())==KM then
call SetUnitOwner(GetEnumUnit(),SM,true)
elseif GetOwningPlayer(GetEnumUnit())==SM then
call SetUnitOwner(GetEnumUnit(),KM,true)
endif
endfunction
function VO2 takes unit u,player p returns nothing
local real x1
local real y1
local real x2
local real y2
local integer i
local item BA1
if IsPlayerTeam1(p)then
set x1=GetRectCenterX(S3)
set y1=GetRectCenterY(S3)
set x2=GetRectCenterX(O4)
set y2=GetRectCenterY(O4)
else
set x1=GetRectCenterX(O4)
set y1=GetRectCenterY(O4)
set x2=GetRectCenterX(S3)
set y2=GetRectCenterY(S3)
endif
call MUSetUnitX(u,x1)
call MUSetUnitY(u,y1)
if RYI(u)then
call IssueImmediateOrder(u,"creepanimatedead")
endif
if IsUnitType(u,UNIT_TYPE_HERO)==true then
call SaveBoolean(LY,(GetHandleId(u)),(140),(true))
call SaveInteger(LY,(GetHandleId((u))),((4259)),(2))
call UnitRemoveAbility(u,'A04R')
call SetUnitInvulnerable(u,false)
call PauseUnit(u,false)
set i=0
loop
exitwhen i>5
set BA1=UnitItemInSlot(u,i)
if GetUnitTypeId(u)!='H00J' and BA1!=null and(GetItemPlayer(BA1)!=GetOwningPlayer(u)and GetItemId(BA1)!=W30 and GetItemId(BA1)!=W40)and GetItemTypeId(BA1)!=FR0[VL0]then
call UnitRemoveItem(u,BA1)
endif
set i=i+1
endloop
endif
call MUSetUnitX(u,x2)
call MUSetUnitY(u,y2)
call SetUnitColor(u,GetPlayerColor(p))
set BA1=null
endfunction
function V22 takes nothing returns boolean
if IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or RYI(GetFilterUnit())then
call VO2(GetFilterUnit(),QM)
elseif GetUnitTypeId(GetFilterUnit())=='ncop' then
call IssueImmediateOrder(GetFilterUnit(),"creepanimatedead")
elseif GetUnitTypeId(GetFilterUnit())=='u00B' then
return true
endif
return false
endfunction
function V32 takes item i,player p returns nothing
local real x
local real y
if IsPlayerTeam1(p)then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
call SetItemPosition(i,x,y)
endfunction
function V42 takes nothing returns nothing
if GetItemPlayer(GetEnumItem())==QM then
call V32(GetEnumItem(),QM)
endif
endfunction
function V52 takes player p1,player p2 returns nothing
local group g1=NTI()
local group g2=NTI()
set QM=p1
call GroupEnumUnitsOfPlayer(g1,p1,Condition(function V22))
set QM=p2
call GroupEnumUnitsOfPlayer(g2,p2,Condition(function V22))
call ForGroup(g1,function V12)
call ForGroup(g2,function V12)
set QM=p1
call EnumItemsInRect(GetWorldBounds(),Condition(function ULI),function V42)
set QM=p2
call EnumItemsInRect(GetWorldBounds(),Condition(function ULI),function V42)
call NSI(g1)
call NSI(g2)
set g1=null
set g2=null
endfunction
function V62 takes player p1,player p2 returns nothing
local integer x
local integer y
local integer i
local integer i1
local integer i2
local real x1
local real y1
local real x2
local real y2
local player p
local string ZQ2=C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"
local string ZU2=C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"
local integer GV2
set GV2=EL0[GetPlayerId(p1)]
set EL0[GetPlayerId(p1)]=EL0[GetPlayerId(p2)]
set EL0[GetPlayerId(p2)]=GV2
if IsPlayerTeam1(p1)then
set x1=GetRectCenterX(S3)
set y1=GetRectCenterY(S3)
else
set x1=GetRectCenterX(O4)
set y1=GetRectCenterY(O4)
endif
if IsPlayerTeam1(p2)then
set x2=GetRectCenterX(S3)
set y2=GetRectCenterY(S3)
else
set x2=GetRectCenterX(O4)
set y2=GetRectCenterY(O4)
endif
set i=1
loop
exitwhen i>5
if BO[i]==p1 or CO[i]==p1 then
set i1=i
endif
if BO[i]==p2 or CO[i]==p2 then
set i2=i
endif
set i=i+1
endloop
if IsPlayerTeam1(p1)then
set CO[i2]=p1
set BO[i1]=p2
else
set BO[i2]=p1
set CO[i1]=p2
endif
call SetPlayerTeam(BO[0],0)
call SetPlayerTeam(BO[1],0)
call SetPlayerTeam(BO[2],0)
call SetPlayerTeam(BO[3],0)
call SetPlayerTeam(BO[4],0)
call SetPlayerTeam(BO[5],0)
call SetPlayerTeam(CO[0],1)
call SetPlayerTeam(CO[1],1)
call SetPlayerTeam(CO[2],1)
call SetPlayerTeam(CO[3],1)
call SetPlayerTeam(CO[4],1)
call SetPlayerTeam(CO[5],1)
call Z11()
set x=0
set y=0
loop
exitwhen x>5
loop
exitwhen y>5
call SetPlayerAllianceStateBJ(BO[x],BO[y],3)
call SetPlayerAllianceStateBJ(CO[x],CO[y],3)
call SetPlayerAllianceStateBJ(BO[x],CO[y],0)
call SetPlayerAllianceStateBJ(CO[x],BO[y],0)
set y=y+1
endloop
set y=0
set x=x+1
endloop
call ForceClear(OO)
call ForceClear(AO)
call ForceAddPlayer(OO,BO[0])
call ForceAddPlayer(OO,BO[1])
call ForceAddPlayer(OO,BO[2])
call ForceAddPlayer(OO,BO[3])
call ForceAddPlayer(OO,BO[4])
call ForceAddPlayer(OO,BO[5])
call ForceAddPlayer(AO,CO[0])
call ForceAddPlayer(AO,CO[1])
call ForceAddPlayer(AO,CO[2])
call ForceAddPlayer(AO,CO[3])
call ForceAddPlayer(AO,CO[4])
call ForceAddPlayer(AO,CO[5])
call ExecuteFunc("ZO1")
call V52(p1,p2)
set IN=true
call PanCameraToTimedForPlayer(p1,x1,y1,0)
call PanCameraToTimedForPlayer(p2,x2,y2,0)
call ZI1()
set JM=false
if UM!=null then
call TriggerEvaluate(UM)
endif
if GetPlayerSlotState(p2)==PLAYER_SLOT_STATE_EMPTY then
set D80[GetPlayerId(p2)]=GetPlayerName(p2)
endif
set i=1
loop
exitwhen i>5
set p=BO[i]
if T6I(p)then
call VI2(p)
endif
set p=CO[i]
if T6I(p)then
call VI2(p)
endif
set i=i+1
endloop
call ZT2()
call P7O()
call ClearTextMessages()
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20," ")
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20,ZP2(ZQ2,ZU2))
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20," ")
call GY1(p1)
call GY1(p2)
endfunction
function V72 takes nothing returns nothing
local integer i=1
local player p
set ON=0
set AN=0
loop
exitwhen i>5
set p=BO[i]
if T3I(p)then
set AN=AN+1
if TM[GetPlayerId(p)]==true then
set ON=ON+1
endif
endif
set p=CO[i]
if T3I(p)then
set AN=AN+1
if TM[GetPlayerId(p)]==true then
set ON=ON+1
endif
endif
set i=i+1
endloop
endfunction
function V82 takes nothing returns nothing
set JM=false
if UM!=null then
call TriggerEvaluate(UM)
endif
call ClearTextMessages()
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20,ZN2(GetTriggerPlayer()))
endfunction
function V92 takes nothing returns nothing
local integer i=1
local player p
local integer VA2=0
local integer VB2=0
local integer VC2=0
if TM[GetPlayerId(GetTriggerPlayer())]==false then
set TM[GetPlayerId(GetTriggerPlayer())]=true
call V72()
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20,C0[GetPlayerId(GetTriggerPlayer())]+(D80[GetPlayerId((GetTriggerPlayer()))])+"|r|c006699CC "+"接受交换的请求"+"|r ("+I2S(ON)+"/"+I2S(AN)+")")
endif
loop
exitwhen i>5
set p=BO[i]
if T3I(p)and TM[GetPlayerId(p)]==false then
set VA2=VA2+1
set VC2=VC2+1
endif
if T3I(p)and TM[GetPlayerId(p)]==true then
set VB2=VB2+1
set VC2=VC2+1
endif
set p=CO[i]
if T3I(p)and TM[GetPlayerId(p)]==false then
set VA2=VA2+1
set VC2=VC2+1
endif
if T3I(p)and TM[GetPlayerId(p)]==true then
set VB2=VB2+1
set VC2=VC2+1
endif
set i=i+1
endloop
if VA2<2 and VB2>=R2I(VC2/2)then
if(VC2==2 and VB2>1)or VC2!=2 then
call V62(KM,SM)
endif
endif
endfunction
function VD2 takes nothing returns nothing
local integer i=1
local player p=GetTriggerPlayer()
local player VE2
local string s
local string s2
loop
exitwhen i>5
set s=""
set s2=""
if IsPlayerTeam1(p)then
set VE2=CO[i]
else
set VE2=BO[i]
endif
if GetPlayerSlotState(VE2)==PLAYER_SLOT_STATE_LEFT and GetPlayerController(VE2)==MAP_CONTROL_USER then
set s="|c00ff0303["+"离开游戏"+"]|r"
endif
if K1[GetPlayerId(VE2)]!=null then
set s2=" ("+GetUnitName(K1[GetPlayerId(VE2)])+")"
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,15,"输入"+"|c006699CC "+"-switch "+I2S(i)+"|r "+"交换位置"+" "+C0[GetPlayerId(VE2)]+(D80[GetPlayerId((VE2))])+s2+"|r "+s)
set i=i+1
endloop
endfunction
function VF2 takes nothing returns boolean
local integer i=0
if JM then
call DisplayTimedTextToForce(bj_FORCE_ALL_PLAYERS,20,"|c00ff0303"+"投票数不足，交换请求被驳回"+"|r")
endif
set RY0=true
set JM=false
set KM=null
set SM=null
loop
exitwhen i>16
set TM[i]=false
set i=i+1
endloop
call FlushTrigger(GetTriggeringTrigger())
set UM=null
return false
endfunction
function VG2 takes player p1,player p2 returns nothing
local trigger t=CreateTrigger()
local integer i=0
local string s
local string PUO
local string msg2
local string msg3
local player p
local string s2
set RY0=false
set JM=true
set KM=p1
set SM=p2
loop
exitwhen i>16
set TM[i]=false
set i=i+1
endloop
set TM[GetPlayerId(KM)]=true
call TriggerRegisterTimerEvent(t,60,false)
call TriggerAddCondition(t,Condition(function VF2))
set UM=t
set s=ZR2(p1,p2)
set s2=ZS2()
set i=1
loop
exitwhen i>5
set p=BO[i]
if p!=p1 then
call DisplayTimedTextToPlayer(p,0,0,20,s)
call DisplayTimedTextToPlayer(p,0,0,20,s2)
endif
set p=CO[i]
if p!=p1 then
call DisplayTimedTextToPlayer(p,0,0,20,s)
call DisplayTimedTextToPlayer(p,0,0,20,s2)
endif
set i=i+1
endloop
set s=V02(p2)
call DisplayTimedTextToPlayer(p1,0,0,20,s)
set t=null
endfunction
function FT2 takes nothing returns nothing
if JL==false then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"-switch命令在这场比赛中已被禁用")
return
endif
if C2 and GetEventPlayerChatString()!="-ok"and GetEventPlayerChatString()!="-switch accept"and GetEventPlayerChatString()!="-no"then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"OB模式下无法使用-switch命令，不久之后会改进这一点")
return
endif
if GetEventPlayerChatString()=="-switch accept"or GetEventPlayerChatString()=="-ok"then
if JM then
call V92()
endif
elseif GetEventPlayerChatString()=="-no"then
if JM then
call V82()
endif
elseif GetEventPlayerChatString()=="-switch"then
if JM==false then
call VD2()
endif
elseif JM==false then
set RM=S2I(SubString(GetEventPlayerChatString(),8,StringLength(GetEventPlayerChatString())))
if RM>0 and RM<6 then
if IsPlayerTeam1(GetTriggerPlayer())then
if RX0[GetPlayerId(CO[RM])]==false then
call VG2(GetTriggerPlayer(),CO[RM])
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"敌方队伍解锁了那名英雄的物品，因此他将不能被交换。")
endif
else
if RX0[GetPlayerId(BO[RM])]==false then
call VG2(GetTriggerPlayer(),BO[RM])
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"敌方队伍解锁了那名英雄的物品，因此他将不能被交换。")
endif
endif
endif
endif
endfunction
function Command_NoSwitch takes nothing returns nothing
if B0==false and JL and GetTriggerPlayer()==WO then
set JL=false
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"-switch命令在这场比赛中已被禁用")
endif
endfunction
function VH2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
set t=null
return false
endfunction
function G12 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=K1[GetPlayerId(GetTriggerPlayer())]
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\Sleep\\SleepTarget.mdl",hero,"overhead")))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerAddCondition(t,Condition(function VH2))
call SetUnitAnimation(hero,"sleep")
set t=null
set hero=null
endfunction
function G22 takes nothing returns nothing
call SetUnitAnimationByIndex(K1[GetPlayerId(GetTriggerPlayer())],23)
endfunction
function G32 takes nothing returns nothing
if K1[GetPlayerId(GetTriggerPlayer())]!=null then
set PA0[GetPlayerId(GetTriggerPlayer())]=1
call UnitRemoveAbility(K1[GetPlayerId(GetTriggerPlayer())],'A2KJ')
endif
endfunction
function FP2 takes nothing returns nothing
if PB0[GetPlayerId(GetTriggerPlayer())]==false then
set PB0[GetPlayerId(GetTriggerPlayer())]=true
if "语言：简体中文"=="Language: English"then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"You have activated the -tips system.")
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"Please remember that these are just introductory recommendations and are not the only way to play heroes.")
endif
if K1[GetPlayerId(GetTriggerPlayer())]!=null then
call GD1(GetTriggerPlayer(),GetUnitPointValue(K1[GetPlayerId(GetTriggerPlayer())]))
endif
endif
endfunction
function VV2 takes integer VW2,integer VX2 returns integer
if VX2==0 then
return VW2
elseif VX2==1 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Idki'
endif
if VW2=='Cvin' then
return 'Isnw'
endif
if VW2=='Cgrs' then
return 'Isnw'
endif
if VW2=='Clvg' then
return 'Isnw'
endif
if VW2=='Zvin' then
return 'Idki'
endif
if VW2=='Zbks' then
return 'Ibsq'
endif
if VW2=='Ndrd' then
return 'Ibsq'
endif
elseif VX2==2 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Yblm'
endif
if VW2=='Cvin' then
return 'Ybtl'
endif
if VW2=='Cgrs' then
return 'Cgrs'
endif
if VW2=='Clvg' then
return 'Clvg'
endif
if VW2=='Zvin' then
return 'Yrtl'
endif
if VW2=='Zbks' then
return 'Ywmb'
endif
if VW2=='Ndrd' then
return 'Jbtl'
endif
elseif VX2==3 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Yblm'
endif
if VW2=='Cvin' then
return 'Ybtl'
endif
if VW2=='Cgrs' then
return 'Yrtl'
endif
if VW2=='Clvg' then
return 'Clvg'
endif
if VW2=='Zvin' then
return 'Yrtl'
endif
if VW2=='Zbks' then
return 'Ybtl'
endif
if VW2=='Ndrd' then
return 'Jbtl'
endif
elseif VX2==4 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Crck'
endif
if VW2=='Cvin' then
return 'Avin'
endif
if VW2=='Cgrs' then
return 'Agrd'
endif
if VW2=='Clvg' then
return 'Alvd'
endif
if VW2=='Zvin' then
return 'Agrd'
endif
if VW2=='Zbks' then
return 'Crck'
endif
if VW2=='Ndrd' then
return 'Cvin'
endif
elseif VX2==5 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Qdrr'
endif
if VW2=='Cvin' then
return 'Qcbp'
endif
if VW2=='Cgrs' then
return 'Qgrt'
endif
if VW2=='Clvg' then
return 'Qgrs'
endif
if VW2=='Zvin' then
return 'Qgrt'
endif
if VW2=='Zbks' then
return 'Qcbp'
endif
if VW2=='Ndrd' then
return 'Qstp'
endif
elseif VX2==6 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Dbrk'
endif
if VW2=='Cvin' then
return 'Dgrs'
endif
if VW2=='Cgrs' then
return 'Odrt'
endif
if VW2=='Clvg' then
return 'Ofst'
endif
if VW2=='Zvin' then
return 'Drds'
endif
if VW2=='Zbks' then
return 'Dsqd'
endif
if VW2=='Ndrd' then
return 'Osmb'
endif
elseif VX2==7 then
if VW2=='Cdrt' then
return 'Cdrt'
endif
if VW2=='Cdrd' then
return 'Gbrk'
endif
if VW2=='Cvin' then
return 'Glvc'
endif
if VW2=='Cgrs' then
return 'Gdrt'
endif
if VW2=='Clvg' then
return 'Gdkr'
endif
if VW2=='Zvin' then
return 'Grds'
endif
if VW2=='Zbks' then
return 'Gsqd'
endif
if VW2=='Ndrd' then
return 'Ggrs'
endif
endif
return 0
endfunction
function VY2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real VJ2=(LoadReal(LY,(handle_id),(149)))
local real VK2=(LoadReal(LY,(handle_id),(150)))
local real VL2=(LoadReal(LY,(handle_id),(151)))
local real VM2=128
local real x
local real y
local integer KBO=(LoadInteger(LY,(handle_id),(152)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer VN2=(LoadInteger(LY,(handle_id),(153)))
loop
exitwhen VJ2>VL2
loop
exitwhen VK2>8192
if GetLocalPlayer()==p then
set VN2=VN2+1
set x=VJ2
set y=VK2
call SetTerrainType(x,y,VV2(SL[VN2],KBO),QL[VN2],1,0)
set x=-VJ2
set y=VK2
call SetTerrainType(x,y,VV2(TL[VN2],KBO),UL[VN2],1,0)
set x=-VJ2
set y=-VK2
call SetTerrainType(x,y,VV2(RL[VN2],KBO),IM[VN2],1,0)
set x=VJ2
set y=-VK2
call SetTerrainType(x,y,VV2(PL[VN2],KBO),AM[VN2],1,0)
endif
set VK2=VK2+VM2
endloop
set VK2=0
set VJ2=VJ2+VM2
endloop
set VL2=VL2+256
call SaveReal(LY,(handle_id),(149),((VJ2)*1.0))
call SaveReal(LY,(handle_id),(150),((VK2)*1.0))
call SaveInteger(LY,(handle_id),(153),(VN2))
call SaveReal(LY,(handle_id),(151),((VL2)*1.0))
if VL2>8192 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function VS2 takes nothing returns nothing
if GetTriggerPlayer()==GetLocalPlayer()and(GetDestructableTypeId(GetEnumDestructable())=='ATtr' or GetDestructableTypeId(GetEnumDestructable())=='B002')then
call SetDestructableAnimation(GetEnumDestructable(),"stand alternate")
endif
endfunction
function VT2 takes nothing returns nothing
if GetTriggerPlayer()==GetLocalPlayer()and(GetDestructableTypeId(GetEnumDestructable())=='ATtr' or GetDestructableTypeId(GetEnumDestructable())=='B002')then
call SetDestructableAnimation(GetEnumDestructable(),"stand")
endif
endfunction
function VR2 takes integer KBO returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if KBO==1 then
call EnumDestructablesInRectAll(GetWorldBounds(),function VS2)
else
call EnumDestructablesInRectAll(GetWorldBounds(),function VT2)
endif
set BM[GetPlayerId(GetTriggerPlayer())]=KBO
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function VY2))
call SaveInteger(LY,(handle_id),(152),(KBO))
call SaveReal(LY,(handle_id),(149),((0)*1.0))
call SaveReal(LY,(handle_id),(150),((0)*1.0))
call SaveReal(LY,(handle_id),(151),((160)*1.0))
call SavePlayerHandle(LY,(handle_id),(54),(GetTriggerPlayer()))
set t=null
endfunction
function Command_Terrain takes nothing returns nothing
if LL[GetPlayerId(GetTriggerPlayer())]==false then
set KL[GetPlayerId(GetTriggerPlayer())]=KL[GetPlayerId(GetTriggerPlayer())]+1
if KL[GetPlayerId(GetTriggerPlayer())]<9 then
if GetEventPlayerChatString()=="-terrain"or GetEventPlayerChatString()=="-terrain default"then
call VR2(0)
elseif GetEventPlayerChatString()=="-terrain snow"then
call VR2(1)
elseif GetEventPlayerChatString()=="-terrain city1"then
call VR2(2)
elseif GetEventPlayerChatString()=="-terrain city2"then
call VR2(3)
elseif GetEventPlayerChatString()=="-terrain jungle"then
call VR2(4)
elseif GetEventPlayerChatString()=="-terrain highlands"then
call VR2(5)
elseif GetEventPlayerChatString()=="-terrain reddungeon"then
call VR2(6)
elseif GetEventPlayerChatString()=="-terrain bluedungeon"then
call VR2(7)
endif
else
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"你用这条命令太多次了！")
endif
endif
endfunction
function VP2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real VJ2=(LoadReal(LY,(handle_id),(149)))
local real VK2=(LoadReal(LY,(handle_id),(150)))
local real VL2=(LoadReal(LY,(handle_id),(151)))
local real VM2=128
local real x
local real y
loop
exitwhen VJ2>VL2
loop
exitwhen VK2>8192
set ML=ML+1
set x=VJ2
set y=VK2
if IsPointBlighted(x,y)==false then
set SL[ML]=GetTerrainType(x,y)
set QL[ML]=GetTerrainVariance(x,y)
endif
set x=-VJ2
set y=VK2
if IsPointBlighted(x,y)==false then
set TL[ML]=GetTerrainType(x,y)
set UL[ML]=GetTerrainVariance(x,y)
endif
set x=-VJ2
set y=-VK2
if IsPointBlighted(x,y)==false then
set RL[ML]=GetTerrainType(x,y)
set IM[ML]=GetTerrainVariance(x,y)
endif
set x=VJ2
set y=-VK2
if IsPointBlighted(x,y)==false then
set PL[ML]=GetTerrainType(x,y)
set AM[ML]=GetTerrainVariance(x,y)
endif
set VK2=VK2+VM2
endloop
set VK2=0
set VJ2=VJ2+VM2
endloop
set VL2=VL2+256
call SaveReal(LY,(handle_id),(149),((VJ2)*1.0))
call SaveReal(LY,(handle_id),(150),((VK2)*1.0))
call SaveReal(LY,(handle_id),(151),((VL2)*1.0))
if VL2>8192 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function VU2 takes nothing returns nothing
local trigger t
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function IU2))
set OL=CreateTimer()
call TimerStart(OL,BL+1,false,null)
call RemoveUnitFromStock(II0,'h02C')
call AddUnitToStock(II0,'h02C',1,2)
call RemoveUnitFromStock(BL0,'h02C')
call AddUnitToStock(BL0,'h02C',1,2)
set t=null
endfunction
function W02 takes string G72 returns boolean
if G72=="-ma"or G72=="-ms"or G72=="-cs"or G72=="-cson"or G72=="-disablehelp"or G72=="-enablehelp"or G72=="-unstuck"or G72=="-recreate"then
return true
elseif G72=="-swaphero"or G72=="-showmsg"or G72=="-hidemsg"or G72=="-showdeny"or G72=="-hidedeny"or G72=="-weather rain"or G72=="-weather snow"or G72=="-weather moonlight"or G72=="-weather wind"or G72=="-weather random"or G72=="-weather off"or G72=="-denyinfo"or G72=="-di"or G72=="-deathon"or G72=="-don"or G72=="-deathoff"or G72=="-doff"or G72=="-roll"or G72=="-hideheronames"or G72=="-hhn"or G72=="-test"or G72=="-mute"or G72=="-wtf"or G72=="-fleshstr"or G72=="-fs"or G72=="-switchon"then
return true
endif
return false
endfunction
function WI2 takes nothing returns boolean
return not B0
endfunction
function W12 takes string WO2 returns nothing
if W2==""then
set W2="|c006699CC"+WO2+"|r"
else
set W2=W2+"/|c006699CC"+WO2+"|r"
endif
endfunction
function W22 takes string W32,integer W42,integer W52 returns string
return SubString(W32,0,W42)+SubString(W32,W52,StringLength(W32))
endfunction
function W62 takes string W32 returns string
local integer FQ1=StringLength(W32)
local string W72
local string A92=""
local integer i=0
loop
exitwhen(i==FQ1)
set W72=StringCase(SubString(W32,i,i+1),false)
if not(W72==StringCase(W72,true))then
set A92=A92+W72
endif
set i=i+1
endloop
return A92
endfunction
function W82 takes string W92,integer KBO returns nothing
local string DC2=W62(W92)
local string array WA2
local string array WB2
local string array GameModeString
local boolean array WC2
local integer WD2
local integer FQ1=StringLength(DC2)
local integer x=0
local integer y=0
local integer z=0
local boolean AP
local boolean AR
local boolean LM
local boolean MM
local boolean TR
local boolean DM
local boolean MR
local boolean SP
local boolean AA
local boolean AI
local boolean AS
local boolean ID
local boolean NP
local boolean SC
local boolean EM
local boolean DU
local boolean SH
local boolean VR
local boolean RV
local boolean RD
local boolean OM
local boolean NT
local boolean NB
local boolean NM
local boolean NS
local boolean SO
local boolean NR
local boolean XL
local boolean SD
local boolean PM
local boolean OI
local boolean MI
local boolean CM
local boolean FR
local boolean MO
local boolean RO
local boolean ER
local boolean CD
local boolean RS
local boolean CP
local boolean ZM
local boolean UB
local boolean TT
local boolean mode_js
local boolean mode_up
set WA2[1]="allpick"
set WB2[1]="ap"
set WA2[2]="allrandom"
set WB2[2]="ar"
set WA2[3]="leaguemode"
set WB2[3]="lm"
set WA2[4]="mirrormatch"
set WB2[4]="mm"
set WA2[5]="teamrandom"
set WB2[5]="tr"
set WA2[6]="deathmatch"
set WB2[6]="dm"
set WA2[7]="moderandom"
set WB2[7]="mr"
set WA2[8]="shuffleplayers"
set WB2[8]="sp"
set WA2[9]="allagility"
set WB2[9]="aa"
set WA2[10]="allintelligence"
set WB2[10]="ai"
set WA2[11]="allstrength"
set WB2[11]="as"
set WA2[12]="itemdrop"
set WB2[12]="id"
set WA2[13]="nopowerups"
set WB2[13]="np"
set WA2[14]="supercreeps"
set WB2[14]="sc"
set WA2[15]="easymode"
set WB2[15]="em"
set WA2[16]="duplicatemode"
set WB2[16]="du"
set WA2[17]="samehero"
set WB2[17]="sh"
set WA2[18]="voterandom"
set WB2[18]="vr"
set WA2[19]="reverse"
set WB2[19]="rv"
set WA2[20]="randomdraft"
set WB2[20]="rd"
set WA2[21]="onlymid"
set WB2[21]="om"
set WA2[22]="extendedleague"
set WB2[22]="xl"
set WA2[23]="nomid"
set WB2[23]="nm"
set WA2[24]="notop"
set WB2[24]="nt"
set WA2[25]="nobot"
set WB2[25]="nb"
set WA2[26]="noswap"
set WB2[26]="ns"
set WA2[27]="norepick"
set WB2[27]="nr"
set WA2[28]="captainsdraft"
set WB2[28]="cd"
set WA2[29]="singledraft"
set WB2[29]="sd"
set WA2[30]="poolingmode"
set WB2[30]="pm"
set WA2[31]="observerinfo"
set WB2[31]="oi"
set WA2[32]="miniheroes"
set WB2[32]="mi"
set WA2[33]="captainsmode"
set WB2[33]="cm"
set WA2[34]="fastrespawn"
set WB2[34]="fr"
set WA2[35]="meleeonly"
set WB2[35]="mo"
set WA2[36]="rangeonly"
set WB2[36]="ro"
set WA2[37]="experimentalrunes"
set WB2[37]="er"
set WA2[38]="randomside"
set WB2[38]="rs"
set WA2[39]="switchon"
set WB2[39]="so"
set WA2[40]="zoommode"
set WB2[40]="zm"
set WA2[41]="capturepoint"
set WB2[41]="cp"
set WA2[42]="unban"
set WB2[42]="ub"
set WA2[43]="tagteam"
set WB2[43]="tt"
set WA2[44] = "js"
set WB2[44] = "js"
set WA2[45] = "up"
set WB2[45] = "up"
set WD2=45
set x=-1
loop
exitwhen x==FQ1-1
set x=x+1
set y=x
loop
exitwhen y==FQ1
set y=y+1
set z=1
loop
exitwhen z>WD2
if WA2[z]==SubString(DC2,x,y)then
set WC2[z]=true
set z=WD2+1
set DC2=W22(DC2,x,y)
set x=-1
set FQ1=StringLength(DC2)
set y=FQ1
else
set z=z+1
endif
endloop
endloop
endloop
set x=-1
loop
exitwhen x==FQ1-1
set x=x+1
set y=x
loop
exitwhen y==FQ1
set y=y+1
set z=1
loop
exitwhen z>WD2
if WB2[z]==SubString(DC2,x,y)then
set WC2[z]=true
set z=WD2+1
set DC2=W22(DC2,x,y)
set x=-1
set FQ1=StringLength(DC2)
set y=FQ1
else
set z=z+1
endif
endloop
endloop
endloop
set AP=WC2[1]
set AR=WC2[2]
set LM=WC2[3]
set MM=WC2[4]
set TR=WC2[5]
set DM=WC2[6]
set MR=WC2[7]
set SP=WC2[8]
set AA=WC2[9]
set AI=WC2[10]
set AS=WC2[11]
set ID=WC2[12]
set NP=WC2[13]
set SC=WC2[14]
set EM=WC2[15]
set DU=WC2[16]
set SH=WC2[17]
set VR=WC2[18]
set RV=WC2[19]
set RD=WC2[20]
set OM=WC2[21]
set XL=WC2[22]
set NM=WC2[23]
set NT=WC2[24]
set NB=WC2[25]
set NS=WC2[26]
set NR=WC2[27]
set CD=WC2[28]
set SD=WC2[29]
set PM=WC2[30]
set OI=WC2[31]
set MI=WC2[32]
set CM=WC2[33]
set FR=WC2[34]
set MO=WC2[35]
set RO=WC2[36]
set ER=WC2[37]
set RS=WC2[38]
set SO=WC2[39]
set ZM=WC2[40]
set CP=WC2[41]
set UB=WC2[42]
set TT=WC2[43]
set mode_js = WC2[44]
set mode_up = WC2[45]
if DC2!=""or W02(W92)then
return
endif
if(AR and(CM or AP or TR or LM or MR or RV or RD or CD or SD or TT or mode_js))or(AP and(TR or MR))or(TR and(LM or MR))or(LM and MR)or(MM and SH)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if(AA and(AI or AS or DM))or(AS and(AI or DM))or(AI and DM)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if(RO and(MO or DM))or(MO and DM)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if RV and(CM or AR or TR or MR or LM or DM or SH or TT)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if(DM and(CM or TR or LM or MR or SH or RV or RD or CD or SD or TT or mode_js))or(MM and DM)or(SH and DM)then
call PZI(WO,"死亡模式与已选模式不兼容！")
return
endif
if LM and(TT or CM or AP or RD or CD or AR or SD or MM or TR or DM or MR or AA or AI or AS or ID or NP or SC or EM or DU or SH or RV or OM or NB or NM or NT or XL or MO or RO or mode_js)then
call PZI(WO,"联赛模式与已选模式不兼容！")
return
endif
if XL and(TT or CM or AP or RD or CD or AR or SD or MM or TR or DM or MR or AA or AI or AS or ID or NP or SC or EM or DU or SH or RV or OM or NB or NM or NT or LM or RO or MO or mode_js)then
call PZI(WO,"全近程模式|r(|cffff0303MO|r)")
return
endif
if CM and(TT or SP or XL or AP or RD or CD or AR or SD or MM or TR or DM or MR or AA or AI or AS or ID or NP or SC or EM or DU or SH or RV or OM or NB or NM or NT or LM or MO or RO or mode_js)then
call PZI(WO,"全近程模式|r(|cffff0303MO|r)")
return
endif
if RD and(TT or CD or CM or AP or LM or AR or SD or MM or TR or DM or MR or AA or AI or AS or SH or RV or RO or MO or mode_js)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if CD and(TT or RD or CM or AP or LM or AR or SD or MM or TR or DM or MR or AA or AI or AS or SH or RV or RO or MO or mode_js)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if mode_js and(TT or RD or CD or CM or AP or LM or AR or SD or MM or TR or DM or MR or AA or AI or AS or SH or RV or RO or MO)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if MR and(TT or CM or AP or LM or AR or SD or MM or TR or DM or AA or AI or AS or SH or RV or RO or MO)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if SD and(TT or CM or AP or LM or AR or RD or CD or MM or TR or DM or MR or AA or AI or AS or SH or RV or RO or MO or mode_js)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if VR and(TT or CM or LM or RD or CD or SD or AR or MM or TR or DM or MR or AA or AI or AS or SH or RV or RO or MO or mode_js)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if TT and(SO or VR or CM or LM or RD or CD or SD or AR or MM or TR or DM or MR or AA or AI or AS or SH or RV or RO or MO or mode_js)then
call PZI(WO,"无效的游戏组合模式！")
return
endif
if MM and T8I(OO)!=T8I(AO)then
call PZI(WO,"两边必须拥有相等的人数才能激活这个模式")
return
endif
if VR and T8I(OO)!=T8I(AO)then
call PZI(WO,"两边必须拥有相等的人数才能激活这个模式")
return
endif
if RV and T8I(OO)!=T8I(AO)then
call PZI(WO,"两边必须拥有相等的人数才能激活这个模式")
return
endif
if LM and not(T3I(BO[1])and T3I(BO[2])and T3I(BO[3])and T3I(BO[4])and T3I(BO[5])and T3I(CO[1])and T3I(CO[2])and T3I(CO[3])and T3I(CO[4])and T3I(CO[5]))then
endif
if XL and not(T3I(BO[1])and T3I(BO[2])and T3I(BO[3])and T3I(BO[4])and T3I(BO[5])and T3I(CO[1])and T3I(CO[2])and T3I(CO[3])and T3I(CO[4])and T3I(CO[5]))then
endif
if TT or ZM or CP or FR or CM or AP or AR or LM or MM or TR or DM or MR or SP or AA or AI or AS or ID or NP or SC or DU or EM or SH or VR or RV or RD or CD or OM or NB or NM or NT or NS or NR or XL or SD or PM or OI or MI or MO or RO or ER or RS or SO or mode_js then
call DisableTrigger(PF0)
else
return
endif
if CM==false then
call P7O()
call UHO()
endif
if LM==false and XL==false then
call HJ2()
endif
set EL=W62(W92)
if PE0 then
call FL1("Mode"+EL,0)
else
call FL1("Mode"+EL,GetPlayerId(WO))
endif
set J2=false
if LM then
set D3="联赛模式|r(|cffff0303LM|r)"
elseif XL then
set D3="扩展联赛模式|r(|cffff0303XL|r)"
elseif RD then
set D3="随机征召模式|r(|cffff0303RD|r)"
elseif CD then
set D3="随机队长模式|r(|cffff0303CD|r)"
elseif MM then
set D3="镜像模式|r(|cffff0303MM|r)"
elseif DM then
set D3="死亡竞赛模式|r(|cffff0303DM|r)"
elseif RV then
set D3="反转模式|r(|cffff0303RV|r)"
elseif AP then
set D3="全阵营选择|r(|cffff0303AP|r)"
elseif AR then
set D3="全阵营随机模式|r(|cffff0303AR|r)"
elseif TR then
set D3="阵营内随机模式|r(|cffff0303TR|r)"
elseif MR then
set D3="模式随机|r(|cffff0303MR|r)"
elseif VR then
set D3="阵容投票模式|r(|cffff0303VR|r)"
elseif SD then
set D3="单选方案模式|r(|cffff0303SD|r)"
elseif CM then
set D3="队长模式|r(|cffff0303CM|r)"
elseif TT then
set D3="Teamteam"
elseif mode_js then
set D3 = "竞赛模式|r(|cffff0303JS|r)"
endif
if CM then
call W12("队长模式|r(|cffff0303CM|r)")
endif
if TT then
call W12("双英雄模式")
endif
if LM then
call W12("联赛模式|r(|cffff0303LM|r)")
endif
if XL then
call W12("扩展联赛模式|r(|cffff0303XL|r)")
endif
if RD then
call W12("随机征召模式|r(|cffff0303RD|r)")
endif
if mode_js then
call W12("竞赛模式|r(|cffff0303JS|r)")
endif
if mode_up then
call W12("魔改|r(|cffff0303UP|r)")
endif
if CD then
call W12("随机队长模式|r(|cffff0303CD|r)")
endif
if DM then
call W12("死亡竞赛模式|r(|cffff0303DM|r)")
endif
if MM then
call W12("镜像模式|r(|cffff0303MM|r)")
endif
if AP then
call W12("全阵营选择|r(|cffff0303AP|r)")
endif
if AR then
call W12("全阵营随机模式|r(|cffff0303AR|r)")
endif
if VR then
call W12("阵容投票模式|r(|cffff0303VR|r)")
endif
if MR then
call W12("模式随机|r(|cffff0303MR|r)")
endif
if TR then
call W12("阵营内随机模式|r(|cffff0303TR|r)")
endif
if SP then
call W12("洗牌模式|r(|cffff0303SP|r)")
endif
if AA then
call W12("全敏捷模式|r(|cffff0303AA|r)")
endif
if AS then
call W12("全力量模式|r(|cffff0303AS|r)")
endif
if AI then
call W12("全智力模式|r(|cffff0303AI|r)")
endif
if RO then
call W12("全远程模式|r(|cffff0303RO|r)")
endif
if MO then
call W12("全近程模式|r(|cffff0303MO|r)")
endif
if DU then
call W12("复选模式|r(|cffff0303DU|r)")
endif
if ID then
call W12("物品掉落模式|r(|cffff0303ID|r)")
endif
if NP then
call W12("无神符模式|r(|cffff0303NP|r)")
endif
if SC then
call W12("超级士兵|r(|cffff0303SC|r)")
endif
if EM then
call W12("简易模式|r(|cffff0303EM|r)")
endif
if SH then
call W12("相同英雄|r(|cffff0303SH|r)")
endif
if RV then
call W12("反转模式|r(|cffff0303RV|r)")
endif
if OM then
call W12("中路模式|r(|cffff0303OM|r)")
endif
if NM then
call W12("中路禁兵|r(|cffff0303NM|r)")
endif
if NB then
call W12("下路禁兵|r(|cffff0303NB|r)")
endif
if NT then
call W12("上路禁兵|r(|cffff0303NT|r)")
endif
if NS then
call W12("禁止交换|r(|cffff0303NS|r)")
endif
if NR then
call W12("禁止重选|r(|cffff0303NR|r)")
endif
if SD then
call W12("单选方案模式|r(|cffff0303SD|r)")
endif
if PM then
call W12("养人模式|r(|cffff0303PM|r)")
endif
if OI then
call W12("观察者信息|r(|cffff0303OI|r)")
endif
if MI then
call W12("迷你英雄模式|r(|cffff0303MI|r)")
endif
if FR then
call W12("快速重生|r(|cffff0303FR|r)")
endif
if ER then
call W12("实验神符|r(|cffff0303ER|r)")
endif
if RS then
call W12("随机阵营模式|r(|cffff0303RS|r)")
endif
if SO then
call W12("交换命令开启|r(|cffff0303SO|r)")
endif
if ZM then
call W12("放大模式|r(|cffff0303ZM|r)")
endif
if CP then
call W12("据点占据模式|r(|cffff0303CP|r)")
endif
if UB then
call W12("反禁用")
endif
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
if KBO==1 then
call QRI(bj_FORCE_ALL_PLAYERS,20.00,C0[GetPlayerId(WO)]+(D80[GetPlayerId((WO))])+"|r"+" "+"选择了"+" "+W2)
else
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"游戏模式已被自动设定为"+" "+W2)
endif
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"需要获取更多关于游戏模式的信息，请使用"+" -gameinfo.")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call PMI("WE2",SP)
call PMI("WF2",RS)
call PMI("WG2",UB)
call PMI("WH2",DM)
call PMI("WZ2",MM)
call PMI("WV2",SH)
call PMI("WW2",AA)
call PMI("WX2",AI)
call PMI("WY2",AS)
call PMI("WJ2",RO)
call PMI("WK2",MO)
call PMI("WL2",DU)
call PMI("WM2",AR)
call PMI("WN2",VR)
call PMI("WS2",AP)
call PMI("WT2",TR)
call PMI("WR2",RV)
call PMI("WP2",LM)
call PMI("WQ2",XL)
call PMI("WU2",CM)
call PMI("X02",RD)
call PMI("MUModeJS",mode_js)
call PMI("MUModeUP",mode_up)
call PMI("XI2",SD)
call PMI("X12",MR)
call PMI("XO2",ID)
call PMI("X22",NP)
call PMI("X32",SC)
call PMI("X42",EM)
call PMI("X52",OM)
call PMI("X62",NB)
call PMI("X72",NT)
call PMI("X82",NM)
call PMI("X92",SO)
call PMI("XA2",NS)
call PMI("XB2",NR)
call PMI("XC2",PM)
call PMI("XD2",OI)
call PMI("XE2",MI)
call PMI("XF2",FR)
call PMI("XG2",ER)
call PMI("XH2",CD)
call PMI("XZ2",ZM)
call PMI("XV2",CP)
call PMI("XW2",TT)
set AL=true
call BW1(0,0,false)
if CN==false and BN==false then
call VU2()
endif
call UR1()
if SO==false then
set RX0[0]=true
set RX0[1]=true
set RX0[2]=true
set RX0[3]=true
set RX0[4]=true
set RX0[5]=true
set RX0[6]=true
set RX0[7]=true
set RX0[8]=true
set RX0[9]=true
set RX0[10]=true
set RX0[11]=true
set RX0[12]=true
set RX0[13]=true
set RX0[14]=true
set RX0[15]=true
set RX0[16]=true
endif
endfunction
function XX2 takes nothing returns nothing
call W82(GetEventPlayerChatString(),1)
endfunction
function XY2 takes nothing returns boolean
if(MY)!=""and AL==false then
set PE0=true
call W82("-"+(MY),2)
else
call TriggerRegisterPlayerChatEvent(PF0,WO,"-",false)
endif
return false
endfunction
function WS2 takes nothing returns nothing
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
local integer x=1
set K0=true
set BL=150
loop
exitwhen x>5
if T3I(BO[x])then
call CreateUnitAtLoc(BO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
if T3I(CO[x])then
call CreateUnitAtLoc(CO[x],'n00C',ZC1,bj_UNIT_FACING)
endif
set x=x+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set ZC1=null
set ZD1=null
endfunction
function XL2 takes nothing returns integer
if PJ0==BO[1]then
return 1
endif
return 2
endfunction
function XM2 takes string S,real XN2,real XS2,real XT2,real XR2,real XP2,boolean XQ2,integer r,integer g,integer b returns image
set MK=CreateImage(S,XN2,XS2,0,XT2-(XN2/2),XR2-(XS2/2),XP2,0,0,0,2)
call SetImageRenderAlways(MK,true)
call ShowImage(MK,XQ2)
call SetImageColor(MK,r,g,b,255)
return MK
endfunction
function XU2 takes image i returns nothing
call ShowImage(i,false)
call DestroyImage(i)
endfunction
function Y02 takes integer YI2 returns nothing
local real x=QV0+40
local real y=QW0-50
local integer Y12=255
local integer YO2=0
local integer Y22=0
local integer Y32=0
local integer Y42=0
local integer Y52=255
local integer r
local integer g
local integer b
if YI2==1 then
set r=Y12
set g=YO2
set b=Y22
set Q30=XM2("Fonts\\B.blp",90,90,x-40,y,0,true,r,g,b)
set Q40=XM2("Fonts\\A.blp",90,90,x,y,0,true,r,g,b)
set Q50=XM2("Fonts\\N.blp",90,90,x+50,y,0,true,r,g,b)
elseif YI2==2 then
set r=Y32
set g=Y42
set b=Y52
call XU2(Q30)
call XU2(Q40)
call XU2(Q50)
set Q30=XM2("Fonts\\P.blp",90,90,x-60,y,0,true,r,g,b)
set Q40=XM2("Fonts\\I.blp",90,90,x-20,y,0,true,r,g,b)
set Q50=XM2("Fonts\\C.blp",90,90,x,y,0,true,r,g,b)
set Q60=XM2("Fonts\\K.blp",90,90,x+45,y,0,true,r,g,b)
elseif YI2==3 then
set r=Y12
set g=YO2
set b=Y22
call XU2(Q30)
call XU2(Q40)
call XU2(Q50)
call XU2(Q60)
set Q30=XM2("Fonts\\B.blp",90,90,x-40,y,0,true,r,g,b)
set Q40=XM2("Fonts\\A.blp",90,90,x,y,0,true,r,g,b)
set Q50=XM2("Fonts\\N.blp",90,90,x+50,y,0,true,r,g,b)
elseif YI2==4 then
set r=Y32
set g=Y42
set b=Y52
call XU2(Q30)
call XU2(Q40)
call XU2(Q50)
set Q30=XM2("Fonts\\P.blp",90,90,x-60,y,0,true,r,g,b)
set Q40=XM2("Fonts\\I.blp",90,90,x-20,y,0,true,r,g,b)
set Q50=XM2("Fonts\\C.blp",90,90,x,y,0,true,r,g,b)
set Q60=XM2("Fonts\\K.blp",90,90,x+45,y,0,true,r,g,b)
elseif YI2==5 then
set r=Y12
set g=YO2
set b=Y22
call XU2(Q30)
call XU2(Q40)
call XU2(Q50)
call XU2(Q60)
set Q30=XM2("Fonts\\B.blp",90,90,x-40,y,0,true,r,g,b)
set Q40=XM2("Fonts\\A.blp",90,90,x,y,0,true,r,g,b)
set Q50=XM2("Fonts\\N.blp",90,90,x+50,y,0,true,r,g,b)
elseif YI2==6 then
set r=Y32
set g=Y42
set b=Y52
call XU2(Q30)
call XU2(Q40)
call XU2(Q50)
set Q30=XM2("Fonts\\P.blp",90,90,x-60,y,0,true,r,g,b)
set Q40=XM2("Fonts\\I.blp",90,90,x-20,y,0,true,r,g,b)
set Q50=XM2("Fonts\\C.blp",90,90,x,y,0,true,r,g,b)
set Q60=XM2("Fonts\\K.blp",90,90,x+45,y,0,true,r,g,b)
elseif YI2==7 then
call XU2(Q30)
call XU2(Q40)
call XU2(Q50)
call XU2(Q60)
endif
endfunction
function Y62 takes integer i,integer Y72 returns string
if i<0 then
set i=0
endif
if TimerGetElapsed(M)<15 then
return "|c00555555"+I2S(i)
endif
if PL0==3 then
return "|c00555555"+I2S(i)
endif
if PL0==1 and Y72!=XL2()then
return "|c00555555"+I2S(i)
elseif PL0==2 and Y72!=XL2()then
return "|c00555555"+I2S(i)
elseif i==0 then
return "|c00555555"+I2S(i)
elseif i<6 then
return "|c00ff0303"+I2S(i)
else
return I2S(i)
endif
endfunction
function Y82 takes nothing returns boolean
local multiboarditem N8I
local integer i
local integer QPO
local integer QQO
local integer DJ1=7
local integer Y92=0
set QPO=1
set QQO=Y92
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemWidth(N8I,0.5)
call MultiboardSetItemValue(N8I,C0[GetPlayerId(BO[1])]+(D80[GetPlayerId((BO[1]))])+"|r")
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=Y92
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"禁止的英雄:")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set i=0
set QPO=QPO
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PR0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PR0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=1
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PR0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PR0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=2
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PR0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PR0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=3
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PR0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PR0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=4
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PR0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PR0[i]])
endif
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=Y92
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"选取：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set i=0
set QPO=QPO
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if Q00[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[Q00[i]])
endif
call MultiboardReleaseItem(N8I)
set i=1
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if Q00[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[Q00[i]])
endif
call MultiboardReleaseItem(N8I)
set i=2
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if Q00[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[Q00[i]])
endif
call MultiboardReleaseItem(N8I)
set i=3
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if Q00[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[Q00[i]])
endif
call MultiboardReleaseItem(N8I)
set i=4
set QQO=Y92+i+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if Q00[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[Q00[i]])
endif
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=Y92
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"时间：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QQO=Y92+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
if PJ0==BO[1]then
call MultiboardSetItemValue(N8I,Y62(PY0,1))
else
call MultiboardSetItemValue(N8I," ")
endif
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QPO=QPO+1
set QQO=Y92
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"额外时间：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QQO=Y92+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Y62(PX0[1],1))
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=Y92
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"状态：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QQO=Y92+1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
if TimerGetElapsed(M)<15 then
call MultiboardSetItemValue(N8I,"|c00555555"+"等待")
elseif PL0==1 then
call MultiboardSetItemValue(N8I,"激活")
elseif PL0==2 then
call MultiboardSetItemValue(N8I,"|c00555555"+"等待")
else
call MultiboardSetItemValue(N8I,"|c00555555"+"完成")
endif
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QPO=1
set QQO=DJ1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemWidth(N8I,1.5)
call MultiboardSetItemValue(N8I,"   "+C0[GetPlayerId(CO[1])]+(D80[GetPlayerId((CO[1]))])+"|r")
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=DJ1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+" "+"禁止的英雄:")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set i=0
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PP0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PP0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=1
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PP0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PP0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=2
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PP0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PP0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=3
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PP0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PP0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=4
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if PP0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[PP0[i]])
endif
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=DJ1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+" "+"选取：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set i=0
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if QI0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[QI0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=1
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if QI0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[QI0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=2
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if QI0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[QI0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=3
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if QI0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[QI0[i]])
endif
call MultiboardReleaseItem(N8I)
set i=4
set QQO=DJ1+i+1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemWidth(N8I,0.015)
if QI0[i]>0 then
call MultiboardSetItemStyle(N8I,false,true)
call MultiboardSetItemIcon(N8I,DS0[QI0[i]])
endif
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=DJ1-2
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"时间：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QQO=DJ1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
if PJ0==CO[1]then
call MultiboardSetItemValue(N8I,Y62(PY0,2))
else
call MultiboardSetItemValue(N8I," ")
endif
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QPO=QPO+1
set QQO=DJ1-2
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"额外时间：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QQO=DJ1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,Y62(PX0[2],2))
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QPO=QPO+2
set QQO=DJ1-2
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
call MultiboardSetItemValue(N8I,"|c006699CC"+"状态：")
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
set QQO=DJ1-1
set N8I=MultiboardGetItem(Q20,QPO,QQO)
call MultiboardSetItemStyle(N8I,true,false)
if TimerGetElapsed(M)<15 then
call MultiboardSetItemValue(N8I,"|c00555555"+"等待")
elseif PL0==2 then
call MultiboardSetItemValue(N8I,"激活")
elseif PL0==1 then
call MultiboardSetItemValue(N8I,"|c00555555"+"等待")
else
call MultiboardSetItemValue(N8I,"|c00555555"+"完成")
endif
call MultiboardSetItemWidth(N8I,0.035)
call MultiboardReleaseItem(N8I)
return false
endfunction
function YA2 takes nothing returns nothing
local integer QUO=12
local integer U0O=14
local trigger t=CreateTrigger()
local integer i
local multiboarditem N8I
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function Y82))
set Q20=CreateMultiboard()
call MultiboardSetItemsWidth(Q20,0.015)
call MultiboardSetRowCount(Q20,QUO)
call MultiboardSetColumnCount(Q20,U0O)
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)")
call MultiboardSetItemsStyle(Q20,false,false)
call MultiboardMinimize(Q20,false)
call MultiboardDisplay(Q20,true)
set i=0
loop
exitwhen i>U0O
set N8I=MultiboardGetItem(Q20,0,i)
call MultiboardSetItemWidth(N8I,0.015)
call MultiboardReleaseItem(N8I)
set i=i+1
endloop
set t=null
set N8I=null
endfunction
function YB2 takes nothing returns boolean
local unit YC2=GetSoldUnit()
local player p=GetOwningPlayer(YC2)
local integer i
local real x
local real y
local real a
if GetUnitTypeId(YC2)=='h06N' and IsPlayerAlly(GetOwningPlayer(YC2),GetOwningPlayer(GetSellingUnit()))then
if K1[GetPlayerId(p)]!=null then
call PZI(p,"你已经选择了英雄")
call KillUnit(YC2)
set YC2=null
set p=null
return false
endif
set x=GetUnitX(GetSellingUnit())
set y=GetUnitY(GetSellingUnit())
set i=RPI(GetUnitTypeId(GetSellingUnit()))
set a=GetUnitFacing(GetSellingUnit())
call RemoveUnit(GetSellingUnit())
call CreateUnit(p,i,x,y,a)
endif
if GetUnitTypeId(YC2)=='h06N' then
call KillUnit(YC2)
endif
if K1[GetPlayerId(BO[1])]!=null and K1[GetPlayerId(BO[2])]!=null and K1[GetPlayerId(BO[3])]!=null and K1[GetPlayerId(BO[4])]!=null and K1[GetPlayerId(BO[5])]!=null and K1[GetPlayerId(CO[1])]!=null and K1[GetPlayerId(CO[2])]!=null and K1[GetPlayerId(CO[3])]!=null and K1[GetPlayerId(CO[4])]!=null and K1[GetPlayerId(CO[5])]!=null then
call FlushTrigger(GetTriggeringTrigger())
endif
set YC2=null
set p=null
return false
endfunction
function YD2 takes nothing returns boolean
set PW0=true
call FlushTrigger(GetTriggeringTrigger())
call DestroyMultiboard(Q20)
call P7O()
call UHO()
call UR1()
return false
endfunction
function ModeCM_SpawnSound takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
call PlaySoundBJ(OE)
return false
endfunction
function YE2 takes nothing returns boolean
local trigger t=CreateTrigger()
local integer BY1
local integer BX1
local string GW1
local unit u
local real x
local real y
local integer i
local real d
local real YF2=GetRectCenterX(O4)
local real YG2=GetRectCenterY(O4)
local real YH2=GetRectCenterX(S3)
local real YZ2=GetRectCenterY(S3)
set PL0=3
set TP0=true
call FlushTrigger(GetTriggeringTrigger())
set i=0
loop
exitwhen i==5
set x=YF2-300+i*150
set y=YG2
set u=CreateUnit(BO[0],DT0[Q00[i]],x,y,270)
call MUDisableMove(u)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_SELL)
call PanCameraToTimedForPlayer(BO[i+1],YF2,YG2,0)
call CreateUnit(BO[i+1],'n00C',YF2,YG2,bj_UNIT_FACING)
call SetPlayerState(BO[i+1],PLAYER_STATE_RESOURCE_GOLD,PH0[GetPlayerId(BO[i+1])]-250)
set i=i+1
endloop
set i=0
loop
exitwhen i==5
set x=YH2-300+i*150
set y=YZ2
set u=CreateUnit(CO[0],DT0[QI0[i]],x,y,270)
call MUDisableMove(u)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_SELL)
call PanCameraToTimedForPlayer(CO[i+1],YH2,YZ2,0)
call CreateUnit(CO[i+1],'n00C',YH2,YZ2,bj_UNIT_FACING)
call SetPlayerState(CO[i+1],PLAYER_STATE_RESOURCE_GOLD,PH0[GetPlayerId(CO[i+1])]-250)
set i=i+1
endloop
call TriggerAddCondition(t,Condition(function YB2))
call SuspendTimeOfDay(false)
call EnableTrigger(EV0)
call EnableTrigger(DN)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function YD2))
set BL=90
call VU2()
call TZI()
set t=null
set u=null
return false
endfunction
function YV2 takes integer YW2,integer i returns nothing
call TCI(DC0[i])
if YW2==1 then
set Q00[Q10]=i
set Q10=Q10+1
else
set QI0[QO0]=i
set QO0=QO0+1
endif
endfunction
function YX2 takes integer YW2 returns nothing
local integer i=TYI()
loop
if R[i]==false then
set R[i]=true
call YV2(YW2,i)
return
endif
endloop
endfunction
function YY2 takes integer YW2,integer i returns nothing
call FL1("Ban"+I2S(GetPlayerId(GetOwningPlayer(GetSoldUnit()))),DC0[i])
call TCI(DC0[i])
if YW2==1 then
set PR0[PQ0]=i
set PQ0=PQ0+1
else
set PP0[PU0]=i
set PU0=PU0+1
endif
endfunction
function YJ2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function YE2))
call Y02(7)
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)")
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,0)
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YM2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YJ2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YN2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call Y02(6)
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YM2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)"+" - |c00ffffff"+"第三阶段选人")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"|c006699CC"+"第三阶段选人已开始"+"|r")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YS2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YN2))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YT2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call Y02(5)
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YS2))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)"+" - |c00ffffff"+"第三阶段禁用")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"|c006699CC"+"第三阶段禁用已开始"+"|r")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YR2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YT2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YP2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YR2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YQ2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YP2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function YU2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call Y02(4)
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YQ2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)"+" - |c00ffffff"+"选择阶段 #2")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"|c006699CC"+"第二选择阶段已经开始"+"|r")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J02 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function YU2))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function JI2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J02))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J12 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function JI2))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function JO2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call Y02(3)
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J12))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)"+" - |c00ffffff"+"禁用阶段 #2")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"|c006699CC"+"第二禁用阶段已经开始"+"|r")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J22 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function JO2))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J32 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J22))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J42 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>40 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YV2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YX2(YW2)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J32))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>40 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J52 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call Y02(2)
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J42))
set PY0=40
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)"+" - |c00ffffff"+"选择阶段 #1")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"|c006699CC"+"第一选择阶段已经开始"+"|r")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J62 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J52))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J72 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PN0
local player YL2=PM0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J62))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J82 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer YW2=PL0
local player YK2=PM0
local player YL2=PN0
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL or(GetTriggerEvalCount(t)>30 and PX0[YW2]==0)then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL and IsUnitType(GetSoldUnit(),UNIT_TYPE_HERO)==false then
set t=null
return false
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SELL then
call YY2(YW2,GetUnitPointValue(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
else
call YY2((YW2),-1)
endif
call FlushTrigger(t)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J72))
set PY0=30
set PJ0=YL2
set PL0=XL2()
call SetPlayerState(YL2,PLAYER_STATE_RESOURCE_GOLD,250)
call SetPlayerState(YK2,PLAYER_STATE_RESOURCE_GOLD,0)
call PEI(YL2,"Sound\\Interface\\Rescue.wav")
else
if GetTriggerEvalCount(t)>30 then
if PX0[YW2]>0 then
set PX0[YW2]=PX0[YW2]-1
endif
else
set PY0=PY0-1
endif
endif
set t=null
set YL2=null
return false
endfunction
function J92 takes nothing returns boolean
local trigger t=CreateTrigger()
set PV0=true
call FlushTrigger(GetTriggeringTrigger())
if PZ0==false then
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(PM0)]+(D80[GetPlayerId((PM0))])+"|r "+"被随机指定以开始选择英雄")
endif
set PJ0=PM0
set PY0=30
call SetPlayerState(PM0,PLAYER_STATE_RESOURCE_GOLD,250)
call PEI(PM0,"Sound\\Interface\\Rescue.wav")
call Y02(1)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"|c006699CC"+"第一禁用阶段已经开始"+"|r")
call MultiboardSetTitleText(Q20,"队长模式|r(|cffff0303CM|r)"+" - |c00ffffff"+"禁用阶段 #1")
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J82))
set t=null
return false
endfunction
function WU2 takes nothing returns nothing
local trigger t
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
local integer x=1
local player p
loop
exitwhen x>5
if T3I(BO[x])then
call CreateUnitAtLoc(BO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
if T3I(CO[x])then
call CreateUnitAtLoc(CO[x],'n00C',ZC1,bj_UNIT_FACING)
endif
set x=x+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set CN=true
set A3=false
set O3=false
set TP0=false
set RU0=false
call SuspendTimeOfDay(true)
call DisableTrigger(EV0)
call DisableTrigger(DN)
if O5I==false then
call OZ2()
endif
set PH0[GetPlayerId(BO[1])]=GetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(BO[2])]=GetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(BO[3])]=GetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(BO[4])]=GetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(BO[5])]=GetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(CO[1])]=GetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(CO[2])]=GetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(CO[3])]=GetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(CO[4])]=GetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD)
set PH0[GetPlayerId(CO[5])]=GetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD)
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD,0)
set PK0=GetRandomInt(1,2)
set PZ0=false
set PL0=PK0
if PK0==1 then
set PM0=BO[1]
set PN0=CO[1]
else
set PM0=CO[1]
set PN0=BO[1]
endif
set PS0=1
set PT0=2
set PX0[1]=110
set PX0[2]=110
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15-TimerGetElapsed(M),false)
call TriggerAddCondition(t,Condition(function J92))
call YA2()
call QRI(bj_FORCE_ALL_PLAYERS,4.00,"起始队伍将被随机抽取")
call QRI(bj_FORCE_ALL_PLAYERS,4.00,"输入 |c006699CC-cm 1|r 让近卫军团先选，或者输入 |c006699CC-cm 2|r 让天灾军团先选")
set t=null
set ZC1=null
set ZD1=null
set p=null
endfunction
function JA2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
set EN=true
call FlushTrigger(t)
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_MASKED,QQ0,QU0,700,false,false))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_MASKED,QQ0,QU0,700,false,false))
set t=null
return false
endfunction
function JB2 takes nothing returns nothing
local integer i=0
loop
exitwhen i>UO0
call RemoveUnit(U10[i])
set i=i+1
endloop
endfunction
function JC2 takes real x,real y returns nothing
set U10[UO0]=CreateUnit(Player(0),'h06I',x,y,0)
set UO0=UO0+1
endfunction
function JD2 takes string S,real XN2,real XS2,real XT2,real XR2,real XP2,boolean XQ2 returns nothing
set MK=CreateImage(S,XN2,XS2,0,XT2-(XN2/2),XR2-(XS2/2),XP2,0,0,0,2)
call SetImageRenderAlways(MK,true)
call ShowImage(MK,XQ2)
endfunction
function JE2 takes integer JF2,integer r,integer g,integer b,integer a,real x,real y,integer handle_id returns nothing
if StringLength(I2S(JF2))>1 then
call JD2("Fonts\\"+SubString(I2S(JF2),0,1)+".blp",90,90,x-20,y,0,true)
call SetImageColor(MK,r,g,b,a)
call SaveImageHandle(LY,(handle_id),(158),(MK))
call JD2("Fonts\\"+SubString(I2S(JF2),1,2)+".blp",90,90,x+20,y,0,true)
call SetImageColor(MK,r,g,b,a)
call SaveImageHandle(LY,(handle_id),(159),(MK))
else
call JD2("Fonts\\0.blp",90,90,x-20,y,0,true)
call SetImageColor(MK,r,g,b,a)
call SaveImageHandle(LY,(handle_id),(158),(MK))
call JD2("Fonts\\"+SubString(I2S(JF2),0,1)+".blp",90,90,x+20,y,0,true)
call SetImageColor(MK,r,g,b,a)
call SaveImageHandle(LY,(handle_id),(159),(MK))
endif
endfunction
function JG2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer DC1=(LoadInteger(LY,(handle_id),(57)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer NPI=GetTriggerEvalCount(t)
local integer JH2=DC1-NPI
local image JZ2=(LoadImageHandle(LY,(handle_id),(158)))
local image JV2=(LoadImageHandle(LY,(handle_id),(159)))
local integer r
local integer g
local integer b
local integer a
if NPI>0 then
call ShowImage(JZ2,false)
call DestroyImage(JZ2)
call ShowImage(JV2,false)
call DestroyImage(JV2)
endif
if NPI==DC1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if JH2<6 then
set r=255
set g=0
set b=0
elseif GetLocalPlayer()==QM0 or GetLocalPlayer()==QN0 then
set r=D90[GetPlayerId(GetLocalPlayer())]
set g=DA0[GetPlayerId(GetLocalPlayer())]
set b=DB0[GetPlayerId(GetLocalPlayer())]
else
set r=255
set g=255
set b=255
endif
if IsPlayerAlly(QM0,GetLocalPlayer())then
set a=255
else
set a=125
endif
call JE2(JH2,r,g,b,a,x,y,handle_id)
endif
set t=null
set JZ2=null
set JV2=null
return false
endfunction
function JW2 takes integer DC1,real x,real y returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function JG2))
call SaveInteger(LY,(handle_id),(57),(DC1))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call TriggerEvaluate(t)
set t=null
endfunction
function JX2 takes integer a,real x,real y,integer handle_id returns nothing
call JD2("Fonts\\Y.blp",90,90,x-150,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(158),(MK))
call JD2("Fonts\\O.blp",90,90,x-110,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(159),(MK))
call JD2("Fonts\\U.blp",90,90,x-70,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(160),(MK))
call JD2("Fonts\\R.blp",90,90,x-30,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(161),(MK))
call JD2("Fonts\\T.blp",90,90,x+30,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(162),(MK))
call JD2("Fonts\\U.blp",90,90,x+70,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(163),(MK))
call JD2("Fonts\\R.blp",90,90,x+110,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(164),(MK))
call JD2("Fonts\\N.blp",90,90,x+150,y,0,true)
call SetImageColor(MK,255,0,0,a)
call SaveImageHandle(LY,(handle_id),(165),(MK))
endfunction
function JY2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x
local real y
local integer NPI=GetTriggerEvalCount(t)
local image JZ2=(LoadImageHandle(LY,(handle_id),(158)))
local image JV2=(LoadImageHandle(LY,(handle_id),(159)))
local image JJ2=(LoadImageHandle(LY,(handle_id),(160)))
local image JK2=(LoadImageHandle(LY,(handle_id),(161)))
local image JL2=(LoadImageHandle(LY,(handle_id),(162)))
local image JM2=(LoadImageHandle(LY,(handle_id),(163)))
local image JN2=(LoadImageHandle(LY,(handle_id),(164)))
local image JS2=(LoadImageHandle(LY,(handle_id),(165)))
local integer r
local integer g
local integer b
local integer a
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
if IsPlayerTeam1(p)then
set x=QQ0
set y=QU0+250
else
set x=U00
set y=UI0+250
endif
if NPI>0 then
call ShowImage(JZ2,false)
call DestroyImage(JZ2)
call ShowImage(JV2,false)
call DestroyImage(JV2)
call ShowImage(JJ2,false)
call DestroyImage(JJ2)
call ShowImage(JK2,false)
call DestroyImage(JK2)
call ShowImage(JL2,false)
call DestroyImage(JL2)
call ShowImage(JM2,false)
call DestroyImage(JM2)
call ShowImage(JN2,false)
call DestroyImage(JN2)
call ShowImage(JS2,false)
call DestroyImage(JS2)
endif
if NPI==20 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetLocalPlayer()==QM0 or GetLocalPlayer()==QN0 then
set a=255
else
set a=0
endif
call JX2(a,x,y,handle_id)
endif
set t=null
set JZ2=null
set JV2=null
set JJ2=null
set JK2=null
set JL2=null
set JM2=null
set JN2=null
set JS2=null
set p=null
return false
endfunction
function JT2 takes player p returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function JY2))
call SavePlayerHandle(LY,(handle_id),(54),(p))
call TriggerEvaluate(t)
set t=null
endfunction
function JR2 takes player p,integer MLI,boolean randomed returns nothing
local integer i=T0I(p)
local real d
if T3I(p)==false then
return
endif
if IsPlayerTeam1(p)then
call SetUnitPosition(QA0[MLI],QB0[i],QC0[i])
set d=QDI(SMI(QA0[MLI])-0.3,0.5)
call SetUnitScale(QA0[MLI],d,d,d)
call SetUnitFacing(QA0[MLI],270)
call UnitRemoveAbility(QA0[MLI],'Amov')
else
call SetUnitPosition(QA0[MLI],QD0[i],QE0[i])
set d=QDI(SMI(QA0[MLI])-0.3,0.5)
call SetUnitScale(QA0[MLI],d,d,d)
call SetUnitFacing(QA0[MLI],90)
call UnitRemoveAbility(QA0[MLI],'Amov')
endif
call SetUnitColor(QA0[MLI],GetPlayerColor(p))
call PauseUnit(QA0[MLI],true)
call SetUnitOwner(QA0[MLI],p,true)
set QP0[GetPlayerId(p)]=true
set Q90[MLI]=true
if IsPlayerTeam1(p)then
set K1[GetPlayerId(p)]=CreateUnit(p,DC0[Q80[MLI]],GetRectCenterX(O4),GetRectCenterY(O4),0)
else
set K1[GetPlayerId(p)]=CreateUnit(p,DC0[Q80[MLI]],GetRectCenterX(S3),GetRectCenterY(S3),0)
endif
endfunction
function JP2 takes nothing returns integer
local integer i=1
loop
exitwhen i>40
if Q90[i]==false then
return i
endif
set i=i+1
endloop
return 0
endfunction
function JQ2 takes player p returns nothing
local integer i=1
local boolean JU2=IsPlayerTeam1(p)
loop
exitwhen i==40
if GetOwningPlayer(QA0[i])==BO[0]or GetOwningPlayer(QA0[i])==CO[0]then
if JU2 then
call SetUnitOwner(QA0[i],BO[0],false)
else
call SetUnitOwner(QA0[i],CO[0],false)
endif
endif
set i=i+1
endloop
endfunction
function K02 takes player p,unit u returns nothing
local integer a=80
if GetLocalPlayer()==p then
set a=255
endif
call SetUnitVertexColor(u,255,255,255,a)
endfunction
function KI2 takes player p1,player p2 returns nothing
local unit dummy
local real x
local real y
call JT2(p1)
call PEI(p1,"Sound\\Interface\\Rescue.wav")
if IsPlayerTeam1(p1)then
if GetLocalPlayer()==p1 then
call PingMinimapEx(QV0,QW0,5,255,255,255,false)
endif
set dummy=CreateUnit(p1,'n02A',QV0-250,QW0,0)
call UnitApplyTimedLife(dummy,'BTLF',20)
call UnitAddAbility(dummy,'Aloc')
set U30[GetPlayerId(p1)]=dummy
call K02(p1,dummy)
if GetLocalPlayer()==p1 then
call ClearTextMessages()
endif
call DisplayTimedTextToPlayer(p1,0,0,10," ")
call DisplayTimedTextToPlayer(p1,0,0,10," ")
call DisplayTimedTextToPlayer(p1,0,0,20,"|c006699CC使用|r |c00ff0303选择英雄|r |c006699CC键来选择一个英雄|r")
call DisplayTimedTextToPlayer(p1,0,0,10," ")
else
call JT2(p1)
if GetLocalPlayer()==p1 then
call PingMinimapEx(QX0,QY0,5,255,255,255,false)
endif
set dummy=CreateUnit(p1,'n02A',QV0-250,QW0,0)
call SetUnitVertexColor(dummy,255,255,255,175)
call UnitApplyTimedLife(dummy,'BTLF',20)
call UnitAddAbility(dummy,'Aloc')
set U40[GetPlayerId(p1)]=dummy
call K02(p1,dummy)
if GetLocalPlayer()==p1 then
call ClearTextMessages()
endif
call DisplayTimedTextToPlayer(p1,0,0,10," ")
call DisplayTimedTextToPlayer(p1,0,0,10," ")
call DisplayTimedTextToPlayer(p1,0,0,20,"|c006699CC使用|r |c00ff0303选择英雄|r |c006699CC键来选择一个英雄|r")
call DisplayTimedTextToPlayer(p1,0,0,10," ")
endif
if p2!=null then
call JT2(p2)
call PEI(p2,"Sound\\Interface\\Rescue.wav")
if IsPlayerTeam1(p2)then
if GetLocalPlayer()==p2 then
call PingMinimapEx(QV0,QW0,5,255,255,255,false)
endif
set dummy=CreateUnit(p2,'n02A',QV0+250,QW0,0)
call UnitApplyTimedLife(dummy,'BTLF',20)
call UnitAddAbility(dummy,'Aloc')
set U30[GetPlayerId(p2)]=dummy
call K02(p2,dummy)
if GetLocalPlayer()==p2 then
call ClearTextMessages()
endif
call DisplayTimedTextToPlayer(p2,0,0,10," ")
call DisplayTimedTextToPlayer(p2,0,0,10," ")
call DisplayTimedTextToPlayer(p2,0,0,20,"|c006699CC使用|r |c00ff0303选择英雄|r |c006699CC键来选择一个英雄|r")
call DisplayTimedTextToPlayer(p2,0,0,10," ")
else
if GetLocalPlayer()==p2 then
call PingMinimapEx(QX0,QY0,5,255,255,255,false)
endif
set dummy=CreateUnit(p2,'n02A',QV0+250,QW0,0)
call UnitApplyTimedLife(dummy,'BTLF',20)
call UnitAddAbility(dummy,'Aloc')
set U40[GetPlayerId(p2)]=dummy
call K02(p2,dummy)
if GetLocalPlayer()==p2 then
call ClearTextMessages()
endif
call DisplayTimedTextToPlayer(p2,0,0,10," ")
call DisplayTimedTextToPlayer(p2,0,0,10," ")
call DisplayTimedTextToPlayer(p2,0,0,20,"|c006699CC使用|r |c00ff0303选择英雄|r |c006699CC键来选择一个英雄|r")
call DisplayTimedTextToPlayer(p2,0,0,10," ")
endif
endif
set dummy=null
endfunction
function K12 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer KO2=(LoadInteger(LY,(handle_id),(25)))
local player K22=QM0
local player K32=QN0
local integer i
set QM0=null
set QN0=null
if KO2==0 then
if QS0==1 then
set QM0=BO[1]
else
set QM0=CO[1]
endif
call JQ2(QM0)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QM0)]+(D80[GetPlayerId((QM0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call KI2(QM0,QN0)
call JW2(20,QQ0,QU0)
elseif KO2==1 then
if QS0==1 then
if U50==false then
set QM0=CO[1]
set QN0=CO[2]
else
set QM0=CO[1]
set QN0=CO[1]
endif
else
if U50==false then
set QM0=BO[1]
set QN0=BO[2]
else
set QM0=BO[1]
set QN0=BO[1]
endif
endif
if QP0[GetPlayerId(K22)]==false then
call JR2(K22,JP2(),true)
endif
call JQ2(QM0)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QM0)]+(D80[GetPlayerId((QM0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QN0)]+(D80[GetPlayerId((QN0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call KI2(QM0,QN0)
call JW2(20,QQ0,QU0)
elseif KO2==2 then
if QS0==1 then
if U50==false then
set QM0=BO[2]
set QN0=BO[3]
else
set QM0=BO[1]
set QN0=BO[1]
endif
else
if U50==false then
set QM0=CO[2]
set QN0=CO[3]
else
set QM0=CO[1]
set QN0=CO[1]
endif
endif
if QP0[GetPlayerId(K22)]==false then
call JR2(K22,JP2(),true)
endif
if QP0[GetPlayerId(K32)]==false then
call JR2(K32,JP2(),true)
endif
call JQ2(QM0)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QM0)]+(D80[GetPlayerId((QM0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QN0)]+(D80[GetPlayerId((QN0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call KI2(QM0,QN0)
call JW2(20,QQ0,QU0)
elseif KO2==3 then
if QS0==1 then
if U50==false then
set QM0=CO[3]
set QN0=CO[4]
else
set QM0=CO[1]
set QN0=CO[1]
endif
else
if U50==false then
set QM0=BO[3]
set QN0=BO[4]
else
set QM0=BO[1]
set QN0=BO[1]
endif
endif
if QP0[GetPlayerId(K22)]==false then
call JR2(K22,JP2(),true)
endif
if QP0[GetPlayerId(K32)]==false then
call JR2(K32,JP2(),true)
endif
call JQ2(QM0)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QM0)]+(D80[GetPlayerId((QM0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QN0)]+(D80[GetPlayerId((QN0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call KI2(QM0,QN0)
call JW2(20,QQ0,QU0)
elseif KO2==4 then
if QS0==1 then
if U50==false then
set QM0=BO[4]
set QN0=BO[5]
else
set QM0=BO[1]
set QN0=BO[1]
endif
else
if U50==false then
set QM0=CO[4]
set QN0=CO[5]
else
set QM0=CO[1]
set QN0=CO[1]
endif
endif
if QP0[GetPlayerId(K22)]==false then
call JR2(K22,JP2(),true)
endif
if QP0[GetPlayerId(K32)]==false then
call JR2(K32,JP2(),true)
endif
call JQ2(QM0)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QM0)]+(D80[GetPlayerId((QM0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QN0)]+(D80[GetPlayerId((QN0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call KI2(QM0,QN0)
call JW2(20,QQ0,QU0)
elseif KO2==5 then
if QS0==1 then
if U50==false then
set QM0=CO[5]
else
set QM0=CO[1]
endif
else
if U50==false then
set QM0=BO[5]
else
set QN0=BO[1]
endif
endif
if QP0[GetPlayerId(K22)]==false then
call JR2(K22,JP2(),true)
endif
if QP0[GetPlayerId(K32)]==false then
call JR2(K32,JP2(),true)
endif
call JQ2(QM0)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(QM0)]+(D80[GetPlayerId((QM0))])+"|r"+" "+"有20秒的时间选择一个英雄")
call KI2(QM0,QN0)
call JW2(20,QQ0,QU0)
elseif KO2==6 then
if QP0[GetPlayerId(K22)]==false then
call JR2(K22,JP2(),true)
endif
call SuspendTimeOfDay(false)
endif
if KO2==7 then
set QR0=true
endif
if KO2==8 then
call JB2()
set i=1
loop
exitwhen i>40
call RemoveUnit(QA0[i])
set i=i+1
endloop
call QM1()
call Z22(60)
call UnitApplyTimedLife(Q70[1],'BTLF',2)
call UnitApplyTimedLife(Q70[2],'BTLF',2)
call UnitApplyTimedLife(Q70[3],'BTLF',2)
call UnitApplyTimedLife(Q70[4],'BTLF',2)
call UnitApplyTimedLife(Q70[5],'BTLF',2)
call UnitApplyTimedLife(Q70[6],'BTLF',2)
call UnitApplyTimedLife(Q70[7],'BTLF',2)
call UnitApplyTimedLife(Q70[8],'BTLF',2)
call UnitApplyTimedLife(Q70[9],'BTLF',2)
call UnitApplyTimedLife(Q70[10],'BTLF',2)
call UnitApplyTimedLife(Q70[11],'BTLF',2)
call UnitApplyTimedLife(Q70[12],'BTLF',2)
call FlushTrigger(U20)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,7,false)
call TriggerAddCondition(t,Condition(function JA2))
else
call SaveInteger(LY,(handle_id),(25),(KO2+1))
endif
set t=null
set K22=null
set K32=null
return false
endfunction
function K42 takes unit SFI returns integer
local integer i=1
loop
exitwhen i>40
if QA0[i]==SFI then
return i
endif
set i=i+1
endloop
return 0
endfunction
function K52 takes nothing returns boolean
local unit YC2=GetSoldUnit()
local player p=GetOwningPlayer(YC2)
call KillUnit(YC2)
if LoadBoolean(LY, StringHash("全局"), StringHash("竞赛模式禁用阶段")) then
	set YC2=null
	set p=null
	return false
endif
if QP0[GetPlayerId(p)]==true then
call PZI(p,"你已经有一个英雄了")
set YC2=null
set p=null
return false
endif
if LoadBoolean(LY, StringHash("全局"), StringHash("竞赛模式选人阶段")) == false and p!=QM0 and p!=QN0 then
call PZI(p,"没有轮到你选择")
set YC2=null
set p=null
return false
endif
if GetUnitTypeId(YC2)=='h06N' then
call JR2(p,K42(GetSellingUnit()),false)
call KillUnit(U30[GetPlayerId(p)])
call KillUnit(U40[GetPlayerId(p)])
endif
set YC2=null
set p=null
return false
endfunction
function ModeRD_Selected takes nothing returns boolean
local unit K62=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local player p=GetOwningPlayer(K62)
if GetSpellAbilityId()=='A0ZB' and K42(target)!=0 then
if(p==QM0 or p==QN0)and QP0[GetPlayerId(p)]==false and Q90[K42(target)]==false then
call JR2(p,K42(target),false)
call RemoveUnit(K62)
endif
endif
set target=null
set p=null
return false
endfunction
function K72 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id
local integer i=1
if t != null then
	call FlushTrigger(t)
endif
call SuspendTimeOfDay(true)
set QS0=GetRandomInt(1,2)
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
if QS0==1 then
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"从"+" "+C0[GetPlayerId(BO[0])]+"近卫军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
else
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"从"+" "+C0[GetPlayerId(CO[0])]+"天灾军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
endif
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,20,true)
call TriggerAddCondition(t,Condition(function K12))
call SaveInteger(LY,(handle_id),(25),(0))
call TriggerEvaluate(t)
set t=null
return false
endfunction
function ModeRD_SetCap takes nothing returns boolean
if U50==false then
set U50=true
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"RD队长模式已被激活")
endif
return false
endfunction
function X02 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer i=1
local real x
local real y
local real a
local integer r
local integer TJI
local boolean K82=false
local boolean K92=false
local boolean KA2=false
local boolean KB2=false
local boolean KC2=false
local boolean KD2=false
local boolean KE2=false
local boolean KF2=false
local boolean KG2=false
local boolean array KH2
local player p
local real DJ1
local boolean KZ2=false
local real z
set RU0=false
set U20=CreateTrigger()
call TriggerAddCondition(U20,Condition(function K52))
call PEI(GetLocalPlayer(),"Sound\\Interface\\Rescue.wav")
set p=BO[1]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[2]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[3]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[4]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[5]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[1]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[2]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[3]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[4]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[5]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
call TriggerRegisterTimerEvent(t,15-TimerGetElapsed(M),false)
call TriggerAddCondition(t,Condition(function K72))
set QT0=true
set BL=180
set A3=false
set O3=false
call UnitAddAbility(EI0,'Agho')
call UnitAddAbility(E10,'Agho')
call UnitAddAbility(EO0,'Agho')
call UnitAddAbility(E20,'Agho')
call UnitAddAbility(E70,'Agho')
call UnitAddAbility(E80,'Agho')
call UnitAddAbility(E90,'Agho')
call UnitAddAbility(EA0,'Agho')
call UnitAddAbility(E30,'Agho')
call UnitAddAbility(E40,'Agho')
call UnitAddAbility(E50,'Agho')
call UnitAddAbility(E60,'Agho')
call ShowUnit(EI0,false)
call ShowUnit(E10,false)
call ShowUnit(EO0,false)
call ShowUnit(E20,false)
call ShowUnit(E70,false)
call ShowUnit(E80,false)
call ShowUnit(E90,false)
call ShowUnit(EA0,false)
call ShowUnit(E30,false)
call ShowUnit(E40,false)
call ShowUnit(E50,false)
call ShowUnit(E60,false)
set i=1
loop
exitwhen i>24
set TJI=RHI(true,true)
if K82 then
set K82=false
set TJI=91
elseif K92 then
set K92=false
set TJI=51
elseif KA2 then
set KA2=false
set TJI=99
elseif KB2 then
set KB2=false
if GetRandomInt(1,2)==1 then
set TJI=104
else
set TJI=65
endif
elseif KC2 then
set KC2=false
set TJI=109
elseif KD2 then
set KD2=false
set TJI=15
elseif KE2 then
set KE2=false
set TJI=110
elseif KF2 then
set KF2=false
elseif KG2 then
set KG2=false
endif
if KH2[TJI]==false and((TJI)!=23)then
set KH2[TJI]=true
set Q80[i]=TJI
set i=i+1
endif
endloop
set Q70[1]=CreateUnit(BO[0],'n0DC',QV0,QW0,0)
set Q70[2]=CreateUnit(BO[1],'n0DC',QV0,QW0,0)
set Q70[3]=CreateUnit(BO[2],'n0DC',QV0,QW0,0)
set Q70[4]=CreateUnit(BO[3],'n0DC',QV0,QW0,0)
set Q70[5]=CreateUnit(BO[4],'n0DC',QV0,QW0,0)
set Q70[6]=CreateUnit(BO[5],'n0DC',QV0,QW0,0)
set Q70[7]=CreateUnit(CO[0],'n0DC',QX0,QY0,0)
set Q70[8]=CreateUnit(CO[1],'n0DC',QX0,QY0,0)
set Q70[9]=CreateUnit(CO[2],'n0DC',QX0,QY0,0)
set Q70[10]=CreateUnit(CO[3],'n0DC',QX0,QY0,0)
set Q70[11]=CreateUnit(CO[4],'n0DC',QX0,QY0,0)
set Q70[12]=CreateUnit(CO[5],'n0DC',QX0,QY0,0)
call PanCameraToTimedForPlayer(BO[1],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[2],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[3],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[4],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[5],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[1],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[2],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[3],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[4],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[5],QV0,QW0,0)
set QQ0=QV0
set QU0=QW0
set U00=QX0
set UI0=QY0
set QB0[1]=QV0+QK0*(-2)
set QC0[1]=QW0+QL0
set QB0[2]=QV0+QK0*(-1)
set QC0[2]=QW0+QL0
set QB0[3]=QV0+QK0*(0)
set QC0[3]=QW0+QL0
set QB0[4]=QV0+QK0*(1)
set QC0[4]=QW0+QL0
set QB0[5]=QV0+QK0*(2)
set QC0[5]=QW0+QL0
set QD0[1]=QV0+QK0*(-2)
set QE0[1]=QW0-QL0
set QD0[2]=QV0+QK0*(-1)
set QE0[2]=QW0-QL0
set QD0[3]=QV0+QK0*(0)
set QE0[3]=QW0-QL0
set QD0[4]=QV0+QK0*(1)
set QE0[4]=QW0-QL0
set QD0[5]=QV0+QK0*(2)
set QE0[5]=QW0-QL0
set QF0[1]=QX0+QK0*(-2)
set QG0[1]=QY0+QL0
set QF0[2]=QX0+QK0*(-1)
set QG0[2]=QY0+QL0
set QF0[3]=QX0+QK0*(0)
set QG0[3]=QY0+QL0
set QF0[4]=QX0+QK0*(1)
set QG0[4]=QY0+QL0
set QF0[5]=QX0+QK0*(2)
set QG0[5]=QY0+QL0
set QH0[1]=QX0+QK0*(-2)
set QZ0[1]=QY0-QL0
set QH0[2]=QX0+QK0*(-1)
set QZ0[2]=QY0-QL0
set QH0[3]=QX0+QK0*(0)
set QZ0[3]=QY0-QL0
set QH0[4]=QX0+QK0*(1)
set QZ0[4]=QY0-QL0
set QH0[5]=QX0+QK0*(2)
set QZ0[5]=QY0-QL0
set DJ1=QJ0
set i=1
loop
exitwhen i>24
if KZ2==false then
set KZ2=true
else
set KZ2=false
endif
set a=i/I2R(24)*360.0
set x=QV0+DJ1*Cos(a*bj_DEGTORAD)
set y=QW0+DJ1*Sin(a*bj_DEGTORAD)
set QA0[i]=CreateUnit(BO[0],DT0[Q80[i]],x,y,UEI(x,y,QV0,QW0))
call MUDisableMove(QA0[i])
call JC2(x,y)
if KZ2 then
call SetUnitColor(QA0[i],GetPlayerColor(CO[5]))
else
call SetUnitColor(QA0[i],GetPlayerColor(CO[4]))
endif
call TriggerRegisterUnitEvent(U20,QA0[i],EVENT_UNIT_SELL)
set i=i+1
endloop
call TZI()
set t=null
set p=null
endfunction

function MUModeJS_AllPickCountDown takes nothing returns nothing
	local integer handle_id = GetHandleId(GetExpiredTimer())
	local integer count = LoadInteger(LY, handle_id, 5)
	local real x = QV0 + 30
	local real y = QW0 - 0
	local integer i
	if count < 60 then
		call DestroyImage(LoadImageHandle(LY, handle_id, 158))
		call DestroyImage(LoadImageHandle(LY, handle_id, 159))
	endif
	if count <= 0 then
		call DestroyTimer(GetExpiredTimer())
		call SaveBoolean(LY, StringHash("全局"), StringHash("竞赛模式选人阶段"), false)

		call DestroyImage(LoadImageHandle(LY, handle_id, 1))
		call DestroyImage(LoadImageHandle(LY, handle_id, 2))
		call DestroyImage(LoadImageHandle(LY, handle_id, 3))
		call DestroyImage(LoadImageHandle(LY, handle_id, 4))

		call FlushChildHashtable(LY, handle_id)

        set i = 0
		loop
    		exitwhen i > 11
    		if QP0[i] == false then
        		call JR2(Player(i), JP2(), true)
    		endif
    		set i = i + 1
		endloop
		return
	endif
	if count > 10 then
		call JE2(count, 255, 255, 255, 255, x, y, handle_id)
	elseif count > 5 then
		call JE2(count, 255, 255, 50, 255, x, y, handle_id)
	else
		call JE2(count, 255, 50, 50, 255, x, y, handle_id)
	endif
	call SaveInteger(LY, handle_id, 5, count - 1)
endfunction

function MUModeJS_AllPick takes nothing returns nothing
    local image array temp_image
    local timer t
	local real x = QV0 + 40
	local real y = QW0 + 70
	local integer i

    call DestroyTimer(GetExpiredTimer())
    call PEI(GetLocalPlayer(),"Sound\\Interface\\Rescue.wav")
	call SaveBoolean(LY, StringHash("全局"), StringHash("竞赛模式选人阶段"), true)
	set temp_image[1] = XM2("Fonts\\P.blp", 90, 90, x - 60, y, 0, true, 255, 0, 0)
	set temp_image[2] = XM2("Fonts\\I.blp", 90, 90, x - 20 , y, 0, true, 255, 0, 0)
	set temp_image[3] = XM2("Fonts\\C.blp", 90, 90, x, y, 0, true, 255, 0, 0)
	set temp_image[4] = XM2("Fonts\\K.blp", 90, 90, x + 45, y, 0, true, 255, 0, 0)

	set t = CreateTimer()
	call SaveImageHandle(LY, GetHandleId(t), 1, temp_image[1])
	call SaveImageHandle(LY, GetHandleId(t), 2, temp_image[2])
	call SaveImageHandle(LY, GetHandleId(t), 3, temp_image[3])
	call SaveImageHandle(LY, GetHandleId(t), 4, temp_image[4])
	call SaveInteger(LY, GetHandleId(t), 5, 60)
	call TimerStart(t, 1, true, function MUModeJS_AllPickCountDown)

	call Z22(60)
	set t = null

	set temp_image[1] = null
	set temp_image[2] = null
	set temp_image[3] = null
	set temp_image[4] = null
endfunction

function MUModeJS_AllPickReady takes nothing returns nothing
    call QRI(bj_FORCE_ALL_PLAYERS,15.00, "每个玩家都将有60秒的时间选择一个英雄")
    call TimerStart(CreateTimer(), 5, false, function MUModeJS_AllPick)
endfunction

function MUModeJS_BanCountDown takes nothing returns nothing
	local integer handle_id = GetHandleId(GetExpiredTimer())
	local integer count = LoadInteger(LY, handle_id, 5)
	local real x = QV0 + 40
	local real y = QW0 - 70
	if count < 20 then
		call DestroyImage(LoadImageHandle(LY, handle_id, 158))
		call DestroyImage(LoadImageHandle(LY, handle_id, 159))
	endif
	if count <= 0 then
		call DestroyTimer(GetExpiredTimer())
		call SaveBoolean(LY, StringHash("全局"), StringHash("竞赛模式禁用阶段"), false)

		call DestroyImage(LoadImageHandle(LY, handle_id, 1))
		call DestroyImage(LoadImageHandle(LY, handle_id, 2))
		call DestroyImage(LoadImageHandle(LY, handle_id, 3))
		call DestroyTrigger(LoadTriggerHandle(LY, handle_id, 4))

		call FlushChildHashtable(LY, handle_id)
		if mu_mode_up then
    		call MUModeJS_AllPickReady()
    	else
		    call K72()
		endif
		return
	endif
	if count > 10 then
		call JE2(count, 255, 255, 255, 255, x, y, handle_id)
	elseif count > 5 then
		call JE2(count, 255, 255, 50, 255, x, y, handle_id)
	else
		call JE2(count, 255, 50, 50, 255, x, y, handle_id)
	endif
	call SaveInteger(LY, handle_id, 5, count - 1)
endfunction

function MUModeJS_BanHero takes nothing returns nothing
	local unit dummy = GetSoldUnit()
	local player owner = GetOwningPlayer(dummy)
	local unit hero
	if LoadBoolean(LY, GetHandleId(owner), StringHash("竞赛模式已禁用英雄")) then
		call PZI(owner, "你已经禁用过英雄了")
		set dummy = null
		set owner = null
		return
	endif
	call SaveBoolean(LY, GetHandleId(owner), StringHash("竞赛模式已禁用英雄"), true)
	set hero = GetSellingUnit()
	call UnitAddAbility(hero, 'Aloc')
	call SetUnitVertexColor(hero, 255, 255, 255, 100)
	call PauseUnit(hero, true)
	set Q90[K42(hero)] = true
	call QRI(bj_FORCE_ALL_PLAYERS, 15.00, C0[GetPlayerId(owner)] + D80[GetPlayerId(owner)] + "|r 禁用了英雄: |cffff1111" + GetUnitName(hero) + "|r")
	set dummy = null
	set owner = null
	set hero = null
endfunction

function MUModeJS_StepBan takes nothing returns nothing
	local image array temp_image
	local real x = QV0 + 40
	local real y = QW0 + 70
	local trigger trg
	local integer i
	local timer t
	call DestroyTimer(GetExpiredTimer())

	call PEI(GetLocalPlayer(),"Sound\\Interface\\Rescue.wav")
	call QRI(bj_FORCE_ALL_PLAYERS, 15.00, " ")
	call QRI(bj_FORCE_ALL_PLAYERS, 15.00, "每个玩家有20秒的时间禁用一个英雄")
	call QRI(bj_FORCE_ALL_PLAYERS, 15.00, " ")

	set temp_image[1] = XM2("Fonts\\B.blp", 90, 90, x - 40, y, 0, true, 255, 0, 0)
	set temp_image[2] = XM2("Fonts\\A.blp", 90, 90, x , y, 0, true, 255, 0, 0)
	set temp_image[3] = XM2("Fonts\\N.blp", 90, 90, x + 50, y, 0, true, 255, 0, 0)

	call SaveBoolean(LY, StringHash("全局"), StringHash("竞赛模式禁用阶段"), true)

	set trg = CreateTrigger()
	call TriggerAddCondition(trg, Condition(function MUModeJS_BanHero))
	set i = 1
	loop
		exitwhen i > 40
		call TriggerRegisterUnitEvent(trg, QA0[i], EVENT_UNIT_SELL)
		set i = i + 1
	endloop


	set t = CreateTimer()
	call SaveImageHandle(LY, GetHandleId(t), 1, temp_image[1])
	call SaveImageHandle(LY, GetHandleId(t), 2, temp_image[2])
	call SaveImageHandle(LY, GetHandleId(t), 3, temp_image[3])
	call SaveTriggerHandle(LY, GetHandleId(t), 4, trg)
	call SaveInteger(LY, GetHandleId(t), 5, 20)
	call TimerStart(t, 1, true, function MUModeJS_BanCountDown)
	set t = null

	set trg = null
	set temp_image[1] = null
	set temp_image[2] = null
	set temp_image[3] = null
endfunction

//============竞赛模式============
function MUModeJS takes nothing returns nothing
local integer i=1
local real x
local real y
local real a
local integer r
local integer TJI
local boolean K82=false
local boolean K92=false
local boolean KA2=false
local boolean KB2=false
local boolean KC2=false
local boolean KD2=false
local boolean KE2=false
local boolean KF2=false
local boolean KG2=false
local boolean array KH2
local player p
local real DJ1
local boolean KZ2=false
local real z
set QW0 = QW0 - 100 // 把选人中心位置往下挪100
set RU0=false
set U20=CreateTrigger()
call TriggerAddCondition(U20,Condition(function K52))
call PEI(GetLocalPlayer(),"Sound\\Interface\\Rescue.wav")
set p=BO[1]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[2]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[3]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[4]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[5]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[1]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[2]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[3]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[4]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[5]
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set QT0=true
set BL=180
set A3=false
set O3=false
call UnitAddAbility(EI0,'Agho')
call UnitAddAbility(E10,'Agho')
call UnitAddAbility(EO0,'Agho')
call UnitAddAbility(E20,'Agho')
call UnitAddAbility(E70,'Agho')
call UnitAddAbility(E80,'Agho')
call UnitAddAbility(E90,'Agho')
call UnitAddAbility(EA0,'Agho')
call UnitAddAbility(E30,'Agho')
call UnitAddAbility(E40,'Agho')
call UnitAddAbility(E50,'Agho')
call UnitAddAbility(E60,'Agho')
call ShowUnit(EI0,false)
call ShowUnit(E10,false)
call ShowUnit(EO0,false)
call ShowUnit(E20,false)
call ShowUnit(E70,false)
call ShowUnit(E80,false)
call ShowUnit(E90,false)
call ShowUnit(EA0,false)
call ShowUnit(E30,false)
call ShowUnit(E40,false)
call ShowUnit(E50,false)
call ShowUnit(E60,false)
set i=1
loop
    exitwhen i>40
    set TJI=RHI(true,true)
    if K82 then
        set K82=false
        set TJI=91
    elseif K92 then
        set K92=false
        set TJI=51
    elseif KA2 then
        set KA2=false
        set TJI=99
    elseif KB2 then
        set KB2=false
        if GetRandomInt(1,2)==1 then
            set TJI=104
        else
            set TJI=65
        endif
    elseif KC2 then
        set KC2=false
        set TJI=109
    elseif KD2 then
        set KD2=false
        set TJI=15
    elseif KE2 then
        set KE2=false
        set TJI=110
    elseif KF2 then
        set KF2=false
    elseif KG2 then
        set KG2=false
    endif
    if KH2[TJI]==false then
        set KH2[TJI]=true
        set Q80[i]=TJI
        set i=i+1
    endif
endloop
set Q70[1]=CreateUnit(BO[0],'n0DC',QV0,QW0,0)
set Q70[2]=CreateUnit(BO[1],'n0DC',QV0,QW0,0)
set Q70[3]=CreateUnit(BO[2],'n0DC',QV0,QW0,0)
set Q70[4]=CreateUnit(BO[3],'n0DC',QV0,QW0,0)
set Q70[5]=CreateUnit(BO[4],'n0DC',QV0,QW0,0)
set Q70[6]=CreateUnit(BO[5],'n0DC',QV0,QW0,0)
set Q70[7]=CreateUnit(CO[0],'n0DC',QX0,QY0,0)
set Q70[8]=CreateUnit(CO[1],'n0DC',QX0,QY0,0)
set Q70[9]=CreateUnit(CO[2],'n0DC',QX0,QY0,0)
set Q70[10]=CreateUnit(CO[3],'n0DC',QX0,QY0,0)
set Q70[11]=CreateUnit(CO[4],'n0DC',QX0,QY0,0)
set Q70[12]=CreateUnit(CO[5],'n0DC',QX0,QY0,0)
call PanCameraToTimedForPlayer(BO[1],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[2],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[3],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[4],QV0,QW0,0)
call PanCameraToTimedForPlayer(BO[5],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[1],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[2],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[3],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[4],QV0,QW0,0)
call PanCameraToTimedForPlayer(CO[5],QV0,QW0,0)
set QQ0=QV0
set QU0=QW0
set U00=QX0
set UI0=QY0
set QB0[1]=QV0+QK0*(-2)
set QC0[1]=QW0+QL0
set QB0[2]=QV0+QK0*(-1)
set QC0[2]=QW0+QL0
set QB0[3]=QV0+QK0*(0)
set QC0[3]=QW0+QL0
set QB0[4]=QV0+QK0*(1)
set QC0[4]=QW0+QL0
set QB0[5]=QV0+QK0*(2)
set QC0[5]=QW0+QL0
set QD0[1]=QV0+QK0*(-2)
set QE0[1]=QW0-QL0
set QD0[2]=QV0+QK0*(-1)
set QE0[2]=QW0-QL0
set QD0[3]=QV0+QK0*(0)
set QE0[3]=QW0-QL0
set QD0[4]=QV0+QK0*(1)
set QE0[4]=QW0-QL0
set QD0[5]=QV0+QK0*(2)
set QE0[5]=QW0-QL0
set QF0[1]=QX0+QK0*(-2)
set QG0[1]=QY0+QL0
set QF0[2]=QX0+QK0*(-1)
set QG0[2]=QY0+QL0
set QF0[3]=QX0+QK0*(0)
set QG0[3]=QY0+QL0
set QF0[4]=QX0+QK0*(1)
set QG0[4]=QY0+QL0
set QF0[5]=QX0+QK0*(2)
set QG0[5]=QY0+QL0
set QH0[1]=QX0+QK0*(-2)
set QZ0[1]=QY0-QL0
set QH0[2]=QX0+QK0*(-1)
set QZ0[2]=QY0-QL0
set QH0[3]=QX0+QK0*(0)
set QZ0[3]=QY0-QL0
set QH0[4]=QX0+QK0*(1)
set QZ0[4]=QY0-QL0
set QH0[5]=QX0+QK0*(2)
set QZ0[5]=QY0-QL0
set DJ1=QJ0
set i=1
loop
exitwhen i>40
if KZ2==false then
set KZ2=true
else
set KZ2=false
endif
if i > 15 then
	set a=i/I2R(25)*360.0
	set x = QV0 + (DJ1 + 75) * Cos(a * bj_DEGTORAD)
	set y = QW0 + (DJ1 + 75) * Sin(a * bj_DEGTORAD)
else
	set a=i/I2R(15)*360.0
	set x = QV0 + (DJ1 - 50) * Cos(a * bj_DEGTORAD)
	set y = QW0 + (DJ1 - 50) * Sin(a * bj_DEGTORAD)
endif
set QA0[i]=CreateUnit(BO[0],DT0[Q80[i]],x,y,UEI(x,y,QV0,QW0))
call MUDisableMove(QA0[i])
call MUShareVision(QA0[i])
call JC2(x,y)
if KZ2 then
call SetUnitColor(QA0[i],GetPlayerColor(CO[5]))
else
call SetUnitColor(QA0[i],GetPlayerColor(CO[4]))
endif
call TriggerRegisterUnitEvent(U20,QA0[i],EVENT_UNIT_SELL)
set i=i+1
endloop
call TZI()
call TimerStart(CreateTimer(), 15 - TimerGetElapsed(M), false, function MUModeJS_StepBan)
set p=null
endfunction

function MUModeUP takes nothing returns nothing
    set mu_mode_up = true
endfunction

function KV2 takes nothing returns boolean
	local unit YC2=GetSoldUnit()
	local player p=GetOwningPlayer(YC2)
	local integer i
	local real x
	local real y
	local real a
	if GetUnitTypeId(YC2)=='h06N' and IsPlayerAlly(GetOwningPlayer(YC2),GetOwningPlayer(GetSellingUnit()))then
		if K1[GetPlayerId(p)]!=null then
			call PZI(p,"你已经选择了英雄")
			call KillUnit(YC2)
			set YC2=null
			set p=null
			return false
		endif
		set x=GetUnitX(GetSellingUnit())
		set y=GetUnitY(GetSellingUnit())
		set i=RPI(GetUnitTypeId(GetSellingUnit()))
		set a=GetUnitFacing(GetSellingUnit())
		call RemoveUnit(GetSellingUnit())
		call CreateUnit(p,i,x,y,a) //todo: 没有立刻记下来,导致可能会选出2个英雄
	endif
	if GetUnitTypeId(YC2)=='h06N' then
		call KillUnit(YC2)
	endif
	if K1[GetPlayerId(BO[1])]!=null and K1[GetPlayerId(BO[2])]!=null and K1[GetPlayerId(BO[3])]!=null and K1[GetPlayerId(BO[4])]!=null and K1[GetPlayerId(BO[5])]!=null and K1[GetPlayerId(CO[1])]!=null and K1[GetPlayerId(CO[2])]!=null and K1[GetPlayerId(CO[3])]!=null and K1[GetPlayerId(CO[4])]!=null and K1[GetPlayerId(CO[5])]!=null then
		call FlushTrigger(GetTriggeringTrigger())
	endif
	set YC2=null
	set p=null
	return false
endfunction
function KW2 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer BY1
local integer BX1
local string GW1
local unit u
local real x
local real y
local integer i
local real d
local real YF2=GetRectCenterX(O4)+125
local real YG2=GetRectCenterY(O4)+75
local real YH2=GetRectCenterX(S3)+100
local real YZ2=GetRectCenterY(S3)
set TP0=true
set i=1
loop
exitwhen i>5
set x=YF2-290+(i-1)*100
set y=YG2
call CreateUnit(BO[i+1],'n00C',YF2,YG2,bj_UNIT_FACING)
set u=CreateUnit(BO[0],DT0[UH0[i+2]],x,y,270)
call MUDisableMove(u)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_SELL)
call PanCameraToTimedForPlayer(BO[i],YF2,YG2,0)
set i=i+1
endloop
set i=1
loop
exitwhen i>5
set x=YH2-290+(i-1)*100
set y=YZ2
call CreateUnit(CO[i+1],'n00C',YH2,YZ2,bj_UNIT_FACING)
set u=CreateUnit(CO[0],DT0[UZ0[i+2]],x,y,270)
call MUDisableMove(u)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_SELL)
call PanCameraToTimedForPlayer(CO[i],YH2,YZ2,0)
set i=i+1
endloop
call TriggerAddCondition(t,Condition(function KV2))
call SuspendTimeOfDay(false)
call EnableTrigger(EV0)
call EnableTrigger(DN)
set BL=90
call VU2()
set t=null
set u=null
endfunction
function KX2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
set EN=true
call FlushTrigger(t)
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_MASKED,PC0,PD0,700,false,false))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_MASKED,PC0,PD0,700,false,false))
set t=null
return false
endfunction
function KY2 takes string S,real XN2,real XS2,real XT2,real XR2,real XP2,boolean XQ2 returns nothing
set MK=CreateImage(S,XN2,XS2,0,XT2-(XN2/2),XR2-(XS2/2),XP2,0,0,0,2)
call SetImageRenderAlways(MK,true)
call ShowImage(MK,XQ2)
endfunction
function KJ2 takes string KK2,integer r,integer g,integer b,integer a,real x,real y returns image
call KY2("Fonts\\"+KK2+".blp",60,60,x-20,y,0,true)
call SetImageColor(MK,r,g,b,a)
return MK
endfunction
function KL2 takes boolean KM2,boolean KN2 returns nothing
local integer KS2
local integer KT2
local integer KR2
local integer KP2
local integer KQ2
local integer KU2
local integer L02
local integer LI2
local integer c1
local integer c2
local integer a=0
set KS2=UE0[1]
set KT2=KS2/60
set KR2=(KS2-KT2*60)/10
set KP2=KS2-KT2*60-KR2*10
set KQ2=UE0[2]
set KU2=KQ2/60
set L02=(KQ2-KU2*60)/10
set LI2=KQ2-KU2*60-L02*10
if KM2==false then
call ShowImage(UN0,false)
call DestroyImage(UN0)
call ShowImage(US0,false)
call DestroyImage(US0)
call ShowImage(UT0,false)
call DestroyImage(UT0)
call ShowImage(UR0,false)
call DestroyImage(UR0)
call ShowImage(UP0,false)
call DestroyImage(UP0)
call ShowImage(UQ0,false)
call DestroyImage(UQ0)
call ShowImage(UU0,false)
call DestroyImage(UU0)
call ShowImage(I0I,false)
call DestroyImage(I0I)
call ShowImage(III,false)
call DestroyImage(III)
call ShowImage(I1I,false)
call DestroyImage(I1I)
call ShowImage(IOI,false)
call DestroyImage(IOI)
call ShowImage(I2I,false)
call DestroyImage(I2I)
call ShowImage(I3I,false)
call DestroyImage(I3I)
call ShowImage(I4I,false)
call DestroyImage(I4I)
call ShowImage(I5I,false)
call DestroyImage(I5I)
call ShowImage(I6I,false)
call DestroyImage(I6I)
endif
if KN2==false then
set c1=255
set c2=255
if UD0==1 then
if IsPlayerAlly(BO[1],GetLocalPlayer())then
set a=255
set c1=0
endif
else
if IsPlayerAlly(CO[1],GetLocalPlayer())then
set a=255
set c2=0
endif
endif
set UN0=KJ2(I2S(KT2),255,c1,c1,255,PC0-40,PD0+300)
set US0=KJ2("58",255,c1,c1,255,PC0-0,PD0+300)
set UT0=KJ2(I2S(KR2),255,c1,c1,255,PC0+20,PD0+300)
set UR0=KJ2(I2S(KP2),255,c1,c1,255,PC0+60,PD0+300)
set UP0=KJ2(I2S(KU2),255,c2,c2,255,PC0-40,PD0-300)
set UQ0=KJ2("58",255,c2,c2,255,PC0-0,PD0-300)
set UU0=KJ2(I2S(L02),255,c2,c2,255,PC0+20,PD0-300)
set I0I=KJ2(I2S(LI2),255,c2,c2,255,PC0+60,PD0-300)
if UF0==1 or UF0==2 or UF0==3 or UF0==4 then
set III=KJ2("Y",255,0,0,a,PC0-130,PD0)
set I1I=KJ2("O",255,0,0,a,PC0-90,PD0)
set IOI=KJ2("U",255,0,0,a,PC0-50,PD0)
set I2I=KJ2("R",255,0,0,a,PC0-10,PD0)
set I3I=KJ2("B",255,0,0,a,PC0+70,PD0)
set I4I=KJ2("A",255,0,0,a,PC0+110,PD0)
set I5I=KJ2("N",255,0,0,a,PC0+150,PD0)
set I6I=KJ2("K",255,0,0,0,PC0+170,PD0)
else
set III=KJ2("Y",255,0,0,a,PC0-150,PD0)
set I1I=KJ2("O",255,0,0,a,PC0-110,PD0)
set IOI=KJ2("U",255,0,0,a,PC0-70,PD0)
set I2I=KJ2("R",255,0,0,a,PC0-30,PD0)
set I3I=KJ2("P",255,0,0,a,PC0+50,PD0)
set I4I=KJ2("I",255,0,0,a,PC0+90,PD0)
set I5I=KJ2("C",255,0,0,a,PC0+130,PD0)
set I6I=KJ2("K",255,0,0,a,PC0+170,PD0)
endif
endif
endfunction
function L12 takes nothing returns nothing
local integer i=0
loop
exitwhen i>UA0
call RemoveUnit(UB0[i])
set i=i+1
endloop
endfunction
function LO2 takes real x,real y returns nothing
set UB0[UA0]=CreateUnit(Player(0),'h06I',x,y,0)
set UA0=UA0+1
endfunction
function L22 takes integer L32,boolean L42 returns nothing
local player p
local real d
set UG0[L32]=true
set UL0[UD0]=UL0[UD0]-1
if UD0==1 then
set p=BO[1]
set UV0=UV0+1
set UH0[UV0]=U70[L32]
if UV0<3 then
call UnitAddAbility(U90[L32],'Aetl')
call UnitAddAbility(U90[L32],'Aloc')
endif
call SetUnitPosition(U90[L32],UX0[UV0],UY0[UV0])
set d=RMaxBJ(SMI(U90[L32])-0.3,0.5)
call LO2(UX0[UV0],UY0[UV0])
call SetUnitScale(U90[L32],d,d,d)
call SetUnitFacing(U90[L32],270)
if L42==false then
if UF0==1 or UF0==2 or UF0==3 or UF0==4 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"BAN掉了"+" "+GetUnitName(U90[L32]))
call FL1("Ban"+I2S(GetPlayerId(p)),DC0[U70[L32]])
else
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"选取了"+" "+GetUnitName(U90[L32]))
call FL1("Pick"+I2S(GetPlayerId(p)),DC0[U70[L32]])
endif
else
if UF0==1 or UF0==2 or UF0==3 or UF0==4 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"随机BAN掉了"+" "+GetUnitName(U90[L32]))
call FL1("Ban"+I2S(GetPlayerId(p)),DC0[U70[L32]])
else
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"随机选取了"+" "+GetUnitName(U90[L32]))
call FL1("Pick"+I2S(GetPlayerId(p)),DC0[U70[L32]])
endif
endif
else
set p=CO[1]
set UW0=UW0+1
set UZ0[UW0]=U70[L32]
if UW0<3 then
call UnitAddAbility(U90[L32],'Aetl')
call UnitAddAbility(U90[L32],'Aloc')
endif
call SetUnitPosition(U90[L32],UJ0[UW0],UK0[UW0])
set d=RMaxBJ(SMI(U90[L32])-0.3,0.5)
call LO2(UJ0[UW0],UK0[UW0])
call SetUnitScale(U90[L32],d,d,d)
call SetUnitFacing(U90[L32],90)
if L42==false then
if UF0==1 or UF0==2 or UF0==3 or UF0==4 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"BAN掉了"+" "+GetUnitName(U90[L32]))
call FL1("Ban"+I2S(GetPlayerId(p)),DC0[U70[L32]])
else
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"选取了"+" "+GetUnitName(U90[L32]))
call FL1("Pick"+I2S(GetPlayerId(p)),DC0[U70[L32]])
endif
else
if UF0==1 or UF0==2 or UF0==3 or UF0==4 then
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"随机BAN掉了"+" "+GetUnitName(U90[L32]))
call FL1("Ban"+I2S(GetPlayerId(p)),DC0[U70[L32]])
else
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,C0[GetPlayerId(p)]+(D80[GetPlayerId((p))])+"|r "+"随机选取了"+" "+GetUnitName(U90[L32]))
call FL1("Pick"+I2S(GetPlayerId(p)),DC0[U70[L32]])
endif
endif
endif
call PauseUnit(U90[L32],true)
call SetUnitOwner(U90[L32],p,true)
endfunction
function L52 takes unit SFI returns integer
local integer i=1
loop
exitwhen i>28
if U90[i]==SFI then
return i
endif
set i=i+1
endloop
return 0
endfunction
function L62 takes nothing returns nothing
local integer i
loop
set i=GetRandomInt(1,28)
exitwhen UG0[i]==false
endloop
call L22(i,true)
endfunction
function L72 takes nothing returns boolean
local unit YC2=GetSoldUnit()
local player p=GetOwningPlayer(YC2)
local integer id=GetPlayerId(p)
local player L82
if UD0==1 then
set L82=BO[1]
else
set L82=CO[1]
endif
call KillUnit(YC2)
if UM0 or UL0[UD0]<1 or p!=L82 then
call PZI(p,"没有轮到你选择")
elseif GetUnitTypeId(YC2)=='h06N' then
call L22(L52(GetSellingUnit()),false)
endif
set YC2=null
return false
endfunction
function L92 takes nothing returns boolean
local integer i=1
local trigger t
call FlushTrigger(GetTriggeringTrigger())
loop
exitwhen i>28
call RemoveUnit(U90[i])
set i=i+1
endloop
call SuspendTimeOfDay(false)
call L12()
call QM1()
call Z22(90)
call UnitApplyTimedLife(U80[1],'BTLF',2)
call UnitApplyTimedLife(U80[2],'BTLF',2)
call UnitApplyTimedLife(U80[3],'BTLF',2)
call UnitApplyTimedLife(U80[4],'BTLF',2)
call UnitApplyTimedLife(U80[5],'BTLF',2)
call UnitApplyTimedLife(U80[6],'BTLF',2)
call UnitApplyTimedLife(U80[7],'BTLF',2)
call UnitApplyTimedLife(U80[8],'BTLF',2)
call UnitApplyTimedLife(U80[9],'BTLF',2)
call UnitApplyTimedLife(U80[10],'BTLF',2)
call UnitApplyTimedLife(U80[11],'BTLF',2)
call UnitApplyTimedLife(U80[12],'BTLF',2)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,7,false)
call TriggerAddCondition(t,Condition(function KX2))
set t=null
call KW2()
return false
endfunction
function LA2 takes nothing returns boolean
local integer i
local trigger t
local force f
local string c="|c006699CC"
set UE0[UD0]=IMaxBJ(UE0[UD0]-1,0)
call KL2(false,false)
if UL0[UD0]<1 then
if UD0==1 then
call PEI(BO[1],"Sound\\Interface\\Rescue.wav")
call PEI(BO[2],"Sound\\Interface\\Rescue.wav")
call PEI(BO[3],"Sound\\Interface\\Rescue.wav")
call PEI(BO[4],"Sound\\Interface\\Rescue.wav")
call PEI(BO[5],"Sound\\Interface\\Rescue.wav")
else
call PEI(CO[1],"Sound\\Interface\\Rescue.wav")
call PEI(CO[2],"Sound\\Interface\\Rescue.wav")
call PEI(CO[3],"Sound\\Interface\\Rescue.wav")
call PEI(CO[4],"Sound\\Interface\\Rescue.wav")
call PEI(CO[5],"Sound\\Interface\\Rescue.wav")
endif
set UF0=UF0+1
if UD0==1 then
set UD0=2
set f=AO
else
set UD0=1
set f=OO
endif
set UE0[UD0]=IMaxBJ(UE0[UD0],6)
if UF0==1 or UF0==2 or UF0==3 or UF0==4 then
set UL0[UD0]=1
call QRI(f,15,c+"轮到你来BAN掉一位英雄"+"|r")
elseif UF0==5 then
set UL0[UD0]=1
call QRI(f,15,c+"轮到你来选取一位英雄"+"|r")
elseif UF0==6 or UF0==7 or UF0==8 or UF0==9 then
set UL0[UD0]=2
call QRI(f,15,c+"轮到你来选取两位英雄"+"|r")
elseif UF0==10 then
set UL0[UD0]=1
call QRI(f,15,c+"轮到你来选取一位英雄"+"|r")
else
call KL2(false,true)
call FlushTrigger(GetTriggeringTrigger())
call FlushTrigger(U60)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function L92))
set t=null
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"征召阶段结束，片刻之后就可以选择英雄了")
endif
elseif UE0[UD0]==0 then
call L62()
endif
return false
endfunction
function LB2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local force f
local string c="|c006699CC"
call FlushTrigger(t)
set UC0=GetRandomInt(1,2)
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
if UC0==1 then
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"从"+" "+C0[GetPlayerId(BO[0])]+"近卫军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
else
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"从"+" "+C0[GetPlayerId(CO[0])]+"天灾军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
endif
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
set UD0=UC0
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function LA2))
set UE0[1]=150
set UE0[2]=150
set UF0=1
set UL0[UD0]=1
call KL2(true,false)
if UD0==1 then
set f=OO
else
set f=AO
endif
call QRI(f,15,c+"轮到你来BAN掉一位英雄"+"|r")
set UM0=false
set t=null
return false
endfunction
function XH2 takes nothing returns nothing
local integer i
local player p
local boolean KZ2=false
local real a
local real x
local real y
local trigger t
local integer TJI
local boolean K82=false
local boolean K92=false
local boolean KA2=false
local boolean KB2=false
local boolean KC2=false
local boolean KD2=false
local boolean KE2=false
local boolean KF2=false
local boolean KG2=false
local integer z
local string c="|c006699CC"
local boolean array KH2
call OZ2()
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15,false)
call TriggerAddCondition(t,Condition(function LB2))
set t=null
set UD0=-1
set RU0=false
set BN=true
set A3=false
set O3=false
set TP0=false
call PEI(GetLocalPlayer(),"Sound\\Interface\\Rescue.wav")
call SuspendTimeOfDay(true)
set U60=CreateTrigger()
call UnitAddAbility(EI0,'Agho')
call UnitAddAbility(E10,'Agho')
call UnitAddAbility(EO0,'Agho')
call UnitAddAbility(E20,'Agho')
call UnitAddAbility(E70,'Agho')
call UnitAddAbility(E80,'Agho')
call UnitAddAbility(E90,'Agho')
call UnitAddAbility(EA0,'Agho')
call UnitAddAbility(E30,'Agho')
call UnitAddAbility(E40,'Agho')
call UnitAddAbility(E50,'Agho')
call UnitAddAbility(E60,'Agho')
set p=BO[1]
set U80[1]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[2]
set U80[2]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[3]
set U80[3]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[4]
set U80[4]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=BO[5]
set U80[5]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[1]
set U80[6]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[2]
set U80[7]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[3]
set U80[8]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[4]
set U80[9]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set p=CO[5]
set U80[10]=CreateUnit(p,'n0DC',PC0,PD0,0)
call PanCameraToTimedForPlayer(p,PC0,PD0,0)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
set UX0[1]=PC0+I8I*(-3.5)
set UY0[1]=PD0+I9I
set UX0[2]=PC0+I8I*(3.5)
set UY0[2]=PD0+I9I
set UX0[3]=PC0+I8I*(-2)
set UY0[3]=PD0+I9I
set UX0[4]=PC0+I8I*(-1)
set UY0[4]=PD0+I9I
set UX0[5]=PC0+I8I*(0)
set UY0[5]=PD0+I9I
set UX0[6]=PC0+I8I*(1)
set UY0[6]=PD0+I9I
set UX0[7]=PC0+I8I*(2)
set UY0[7]=PD0+I9I
set UJ0[1]=PC0+I8I*(-3.5)
set UK0[1]=PD0-I9I
set UJ0[2]=PC0+I8I*(3.5)
set UK0[2]=PD0-I9I
set UJ0[3]=PC0+I8I*(-2)
set UK0[3]=PD0-I9I
set UJ0[4]=PC0+I8I*(-1)
set UK0[4]=PD0-I9I
set UJ0[5]=PC0+I8I*(0)
set UK0[5]=PD0-I9I
set UJ0[6]=PC0+I8I*(1)
set UK0[6]=PD0-I9I
set UJ0[7]=PC0+I8I*(2)
set UK0[7]=PD0-I9I
call UPI(PC0,PD0,600)
set i=1
loop
exitwhen i>28
set TJI=RHI(true,true)
if K82 then
set K82=false
set TJI=50
elseif K92 then
set K92=false
set TJI=51
elseif KA2 then
set KA2=false
set TJI=104
elseif KB2 then
set KB2=false
set TJI=65
elseif KC2 then
set KC2=false
set TJI=49
elseif KD2 then
set KD2=false
if GetRandomInt(1,2)==1 then
set TJI=16
else
set TJI=86
endif
elseif KE2 then
set KE2=false
if GetRandomInt(1,2)==1 then
set TJI=73
else
set TJI=83
endif
elseif KF2 then
set KF2=false
elseif KG2 then
set KG2=false
endif
if KH2[TJI]==false then
set KH2[TJI]=true
set U70[i]=TJI
call FL1("Pool"+I2S(i),DC0[U70[i]])
if KZ2==false then
set KZ2=true
else
set KZ2=false
endif
set a=(i/I2R(28))*360.0
set x=PC0+I7I*Cos(a*bj_DEGTORAD)
set y=PD0+I7I*Sin(a*bj_DEGTORAD)
set U90[i]=CreateUnit(BO[0],DT0[U70[i]],x,y,UEI(x,y,PC0,PD0))
call MUDisableMove(U90[i])
call SetUnitPathing(U90[i],false)
call MUSetUnitX(U90[i],x)
call MUSetUnitY(U90[i],y)
call LO2(x,y)
if KZ2 then
call SetUnitColor(U90[i],GetPlayerColor(CO[5]))
else
call SetUnitColor(U90[i],GetPlayerColor(CO[4]))
endif
set UG0[i]=false
call TriggerRegisterUnitEvent(U60,U90[i],EVENT_UNIT_SELL)
set i=i+1
endif
endloop
call TriggerAddCondition(U60,Condition(function L72))
call TZI()
endfunction
function LC2 takes player p,integer SJI returns nothing
local integer i=1
loop
exitwhen i>5
if p!=BO[i]then
call SetPlayerTechMaxAllowed(BO[i],SJI,0)
endif
if p!=CO[i]then
call SetPlayerTechMaxAllowed(CO[i],SJI,0)
endif
set i=i+1
endloop
endfunction
function ModeSD_Chosen takes nothing returns boolean
local string DC2=GetEventPlayerChatString()
local integer a=S2I(SubString(DC2,6,StringLength(DC2)))
local integer SJI
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local location ZC1=GetRectCenter(F4)
local location ZD1=GetRectCenter(E4)
local player p=GetTriggerPlayer()
if a==1 then
set SJI=(LoadInteger(LY,(handle_id),(166)))
elseif a==2 then
set SJI=(LoadInteger(LY,(handle_id),(167)))
elseif a==3 then
set SJI=(LoadInteger(LY,(handle_id),(168)))
else
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set ZC1=null
set ZD1=null
return false
endif
if GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)>=250 then
if IsPlayerTeam1(p)then
set K1[GetPlayerId(p)]=CreateUnitAtLoc(p,DC0[SJI],ZC1,0)
else
set K1[GetPlayerId(p)]=CreateUnitAtLoc(p,DC0[SJI],ZD1,0)
endif
call A31(p)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)-250)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call PZI(p,"你没有足够的金钱选择一个新的英雄")
endif
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set ZC1=null
set ZD1=null
set t=null
set p=null
return false
endfunction
function LD2 takes integer LE2 returns integer
local integer R4O
if LE2==1 then
set R4O=GetUnitPointValueByType(DZ0[GetRandomInt(1,DV0)])
elseif LE2==2 then
set R4O=GetUnitPointValueByType(DW0[GetRandomInt(1,DX0)])
elseif LE2==3 then
set R4O=GetUnitPointValueByType(DY0[GetRandomInt(1,DJ0)])
endif
return R4O
endfunction
function LF2 takes integer LG2,integer LH2,integer LE2 returns integer
local integer RBI
local integer RCI
local integer R4O
set R4O=LD2(LE2)
if F2 and LG2!=R4O and LH2!=R4O then
return R4O
endif
loop
exitwhen R[R4O]==false and LG2!=R4O and LH2!=R4O
set R4O=LD2(LE2)
endloop
set R[R4O]=true
return R4O
endfunction
function XI2 takes nothing returns nothing
local player p
local integer i=1
local integer LZ2
local integer LV2
local integer LW2
local trigger t
local integer handle_id
set IAI=true
set BL=120
set O3=false
set A3=false
call PauseUnit(EI0,true)
call PauseUnit(E10,true)
call PauseUnit(EO0,true)
call PauseUnit(E20,true)
call PauseUnit(E30,true)
call PauseUnit(E40,true)
call PauseUnit(E50,true)
call PauseUnit(E60,true)
call PauseUnit(E70,true)
call PauseUnit(E80,true)
call PauseUnit(E90,true)
call PauseUnit(EA0,true)
loop
exitwhen i>5
set p=BO[i]
set LZ2=0
set LV2=0
set LW2=0
if T3I(p)then
//call UnitAddAbility(D30[GetPlayerId(p)],'A14F')
call UnitAddAbility(D30[GetPlayerId(p)],'A14E')
call UnitAddAbility(D30[GetPlayerId(p)],'A14H')
set LZ2=LF2(LZ2,LV2,1)
set LV2=LF2(LZ2,LV2,2)
set LW2=LF2(LZ2,LV2,3)
call AddUnitToStock(D30[GetPlayerId(p)],DC0[LZ2],1,1)
call LC2(p,DC0[LZ2])
call AddUnitToStock(D30[GetPlayerId(p)],DC0[LV2],1,1)
call LC2(p,DC0[LV2])
call AddUnitToStock(D30[GetPlayerId(p)],DC0[LW2],1,1)
call LC2(p,DC0[LW2])
call ClearSelectionForPlayer(p)
call SelectUnitAddForPlayer(D30[GetPlayerId(p)],p)
call PanCameraToTimedForPlayer(p,GetRectCenterX(O4),GetRectCenterY(O4),0)
call DisplayTimedTextToPlayer(p,0,U2,15," ")
call DisplayTimedTextToPlayer(p,0,U2,15," ")
call DisplayTimedTextToPlayer(p,0,U2,15," ")
call DisplayTimedTextToPlayer(p,0,U2,15,"|cff99ccff"+"在你的能量圈现在有三个英雄你可以选择"+"|r")
call DisplayTimedTextToPlayer(p,0,U2,15," ")
endif
set p=CO[i]
set LZ2=0
set LV2=0
set LW2=0
if T3I(p)then
//call UnitAddAbility(D30[GetPlayerId(p)],'A14F')
call UnitAddAbility(D30[GetPlayerId(p)],'A14E')
call UnitAddAbility(D30[GetPlayerId(p)],'A14H')
set LZ2=LF2(LZ2,LV2,1)
set LV2=LF2(LZ2,LV2,2)
set LW2=LF2(LZ2,LV2,3)
call AddUnitToStock(D30[GetPlayerId(p)],DC0[LZ2],1,1)
call LC2(p,DC0[LZ2])
call AddUnitToStock(D30[GetPlayerId(p)],DC0[LV2],1,1)
call LC2(p,DC0[LV2])
call AddUnitToStock(D30[GetPlayerId(p)],DC0[LW2],1,1)
call LC2(p,DC0[LW2])
call ClearSelectionForPlayer(p)
call SelectUnitAddForPlayer(D30[GetPlayerId(p)],p)
call PanCameraToTimedForPlayer(p,GetRectCenterX(S3),GetRectCenterY(S3),0)
call DisplayTimedTextToPlayer(p,0,U2,15," ")
call DisplayTimedTextToPlayer(p,0,U2,15," ")
call DisplayTimedTextToPlayer(p,0,U2,15," ")
call DisplayTimedTextToPlayer(p,0,U2,15,"|cff99ccff"+"在你的能量圈现在有三个英雄你可以选择"+"|r")
call DisplayTimedTextToPlayer(p,0,U2,15," ")
endif
set i=i+1
endloop
set p=null
set t=null
endfunction
function LX2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer O91=(LoadInteger(LY,(handle_id),(55)))
local player p
local integer TJI
local location ZC1=GetRectCenter(O4)
local location ZD1=GetRectCenter(S3)
if O91<6 then
set p=BO[O91]
elseif O91<11 then
set p=CO[O91-5]
endif
if O91>10 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if X0==false then
set A3=true
endif
elseif O91<6 then
call SaveInteger(LY,(handle_id),(55),(O91+1))
set K1[GetPlayerId(p)]=null
if T3I(p)then
loop
exitwhen K1[GetPlayerId(p)]!=null
set TJI=TYI()
if R[TJI]==false then
if not F2 then
set R[TJI]=true
endif
set K1[GetPlayerId(p)]=CreateUnitAtLoc(p,DC0[TJI],ZC1,bj_UNIT_FACING)
endif
endloop
endif
elseif O91<11 then
call SaveInteger(LY,(handle_id),(55),(O91+1))
set K1[GetPlayerId(p)]=null
if T3I(p)then
loop
exitwhen K1[GetPlayerId(p)]!=null
set TJI=TYI()
if R[TJI]==false then
if not F2 then
set R[TJI]=true
endif
set K1[GetPlayerId(p)]=CreateUnitAtLoc(p,DC0[TJI],ZD1,bj_UNIT_FACING)
endif
endloop
endif
endif
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set ZC1=null
set ZD1=null
set p=null
set t=null
return false
endfunction
function WM2 takes nothing returns nothing
local location ZC1=GetRectCenter(O4)
local location ZD1=GetRectCenter(S3)
local location LY2=GetRectCenter(O4)
local location LJ2=GetRectCenter(S3)
local integer TGI=1
local integer THI=5
local integer TJI
local trigger t
set Y0=true
set O3=false
if not F2 then
call TZI()
endif
set T0=400
call PanCameraToTimedLocForPlayer(BO[1],LY2,0)
call PanCameraToTimedLocForPlayer(BO[2],LY2,0)
call PanCameraToTimedLocForPlayer(BO[3],LY2,0)
call PanCameraToTimedLocForPlayer(BO[4],LY2,0)
call PanCameraToTimedLocForPlayer(BO[5],LY2,0)
call PanCameraToTimedLocForPlayer(CO[1],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[2],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[3],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[4],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[5],LJ2,0)
if Y2 then
loop
set TJI=TYI()
exitwhen R[TJI]==false
endloop
if IsPlayerTeam1(WO)then
set K1[GetPlayerId(WO)]=CreateUnit(WO,DC0[TJI],GetLocationX(ZC1),GetLocationY(ZC1),270)
else
set K1[GetPlayerId(WO)]=CreateUnit(WO,DC0[TJI],GetLocationX(ZD1),GetLocationY(ZD1),270)
endif
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
set ZC1=null
set ZD1=null
set LY2=null
set LJ2=null
set t=null
return
endif
set A3=false
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,.5,true)
call TriggerAddCondition(t,Condition(function LX2))
call SaveInteger(LY,(GetHandleId(t)),(55),(1))
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
set ZC1=null
set ZD1=null
set LY2=null
set LJ2=null
set t=null
endfunction
function LK2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
call FlushTrigger(t)
set I3=true
set t=null
return false
endfunction
function LL2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local trigger LM2=(LoadTriggerHandle(LY,(handle_id),(35)))
local integer i
local integer x
local integer TJI
local integer LN2=T8I(OO)
local integer LS2=T8I(AO)
local location ZC1=GetRectCenter(F4)
local location ZD1=GetRectCenter(E4)
local location LY2=GetRectCenter(O4)
local location LJ2=GetRectCenter(S3)
call FlushTrigger(LM2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set IVI=(LoadInteger(LY,(2001),(126)))
set IWI=(LoadInteger(LY,(2001),(127)))
set IXI=(LoadInteger(LY,(2001),(128)))
set i=1
loop
exitwhen i>LN2
set IZI[i]=ICI[i]
set i=i+1
endloop
set x=GetRandomInt(1,3)
if x==1 then
if LN2==1 then
set IZI[1]=ICI[1]
elseif LN2==2 then
set IZI[1]=ICI[2]
set IZI[2]=ICI[1]
elseif LN2==3 then
set IZI[1]=ICI[3]
set IZI[2]=ICI[1]
set IZI[3]=ICI[2]
elseif LN2==4 then
set IZI[1]=ICI[4]
set IZI[2]=ICI[3]
set IZI[3]=ICI[2]
set IZI[4]=ICI[1]
elseif LN2==5 then
set IZI[1]=ICI[5]
set IZI[2]=ICI[4]
set IZI[3]=ICI[1]
set IZI[4]=ICI[2]
set IZI[5]=ICI[3]
endif
elseif x==2 then
if LN2==1 then
set IZI[1]=ICI[1]
elseif LN2==2 then
set IZI[1]=ICI[2]
set IZI[2]=ICI[1]
elseif LN2==3 then
set IZI[1]=ICI[2]
set IZI[2]=ICI[3]
set IZI[3]=ICI[1]
elseif LN2==4 then
set IZI[1]=ICI[3]
set IZI[2]=ICI[1]
set IZI[3]=ICI[4]
set IZI[4]=ICI[2]
elseif LN2==5 then
set IZI[1]=ICI[4]
set IZI[2]=ICI[3]
set IZI[3]=ICI[2]
set IZI[4]=ICI[5]
set IZI[5]=ICI[1]
endif
else
if LN2==1 then
set IZI[1]=ICI[1]
elseif LN2==2 then
set IZI[1]=ICI[1]
set IZI[2]=ICI[2]
elseif LN2==3 then
set IZI[1]=ICI[3]
set IZI[2]=ICI[2]
set IZI[3]=ICI[1]
elseif LN2==4 then
set IZI[1]=ICI[2]
set IZI[2]=ICI[4]
set IZI[3]=ICI[3]
set IZI[4]=ICI[1]
elseif LN2==5 then
set IZI[1]=ICI[5]
set IZI[2]=ICI[1]
set IZI[3]=ICI[3]
set IZI[4]=ICI[4]
set IZI[5]=ICI[2]
endif
endif
set i=1
loop
exitwhen i>LN2
set ICI[i]=IZI[i]
set i=i+1
endloop
set i=1
loop
exitwhen i>LN2
set IZI[i]=IDI[i]
set i=i+1
endloop
set x=GetRandomInt(1,3)
if x==1 then
if LN2==1 then
set IZI[1]=IDI[1]
elseif LN2==2 then
set IZI[1]=IDI[2]
set IZI[2]=IDI[1]
elseif LN2==3 then
set IZI[1]=IDI[3]
set IZI[2]=IDI[1]
set IZI[3]=IDI[2]
elseif LN2==4 then
set IZI[1]=IDI[4]
set IZI[2]=IDI[3]
set IZI[3]=IDI[2]
set IZI[4]=IDI[1]
elseif LN2==5 then
set IZI[1]=IDI[5]
set IZI[2]=IDI[4]
set IZI[3]=IDI[1]
set IZI[4]=IDI[2]
set IZI[5]=IDI[3]
endif
elseif x==2 then
if LN2==1 then
set IZI[1]=IDI[1]
elseif LN2==2 then
set IZI[1]=IDI[2]
set IZI[2]=IDI[1]
elseif LN2==3 then
set IZI[1]=IDI[2]
set IZI[2]=IDI[3]
set IZI[3]=IDI[1]
elseif LN2==4 then
set IZI[1]=IDI[3]
set IZI[2]=IDI[1]
set IZI[3]=IDI[4]
set IZI[4]=IDI[2]
elseif LN2==5 then
set IZI[1]=IDI[4]
set IZI[2]=IDI[3]
set IZI[3]=IDI[2]
set IZI[4]=IDI[5]
set IZI[5]=IDI[1]
endif
else
if LN2==1 then
set IZI[1]=IDI[1]
elseif LN2==2 then
set IZI[1]=IDI[1]
set IZI[2]=IDI[2]
elseif LN2==3 then
set IZI[1]=IDI[3]
set IZI[2]=IDI[2]
set IZI[3]=IDI[1]
elseif LN2==4 then
set IZI[1]=IDI[2]
set IZI[2]=IDI[4]
set IZI[3]=IDI[3]
set IZI[4]=IDI[1]
elseif LN2==5 then
set IZI[1]=IDI[5]
set IZI[2]=IDI[1]
set IZI[3]=IDI[3]
set IZI[4]=IDI[4]
set IZI[5]=IDI[2]
endif
endif
set i=1
loop
exitwhen i>LN2
set IDI[i]=IZI[i]
set i=i+1
endloop
set i=1
loop
exitwhen i>LN2
set IZI[i]=IEI[i]
set i=i+1
endloop
set x=GetRandomInt(1,3)
if x==1 then
if LN2==1 then
set IZI[1]=IEI[1]
elseif LN2==2 then
set IZI[1]=IEI[2]
set IZI[2]=IEI[1]
elseif LN2==3 then
set IZI[1]=IEI[3]
set IZI[2]=IEI[1]
set IZI[3]=IEI[2]
elseif LN2==4 then
set IZI[1]=IEI[4]
set IZI[2]=IEI[3]
set IZI[3]=IEI[2]
set IZI[4]=IEI[1]
elseif LN2==5 then
set IZI[1]=IEI[5]
set IZI[2]=IEI[4]
set IZI[3]=IEI[1]
set IZI[4]=IEI[2]
set IZI[5]=IEI[3]
endif
elseif x==2 then
if LN2==1 then
set IZI[1]=IEI[1]
elseif LN2==2 then
set IZI[1]=IEI[2]
set IZI[2]=IEI[1]
elseif LN2==3 then
set IZI[1]=IEI[2]
set IZI[2]=IEI[3]
set IZI[3]=IEI[1]
elseif LN2==4 then
set IZI[1]=IEI[3]
set IZI[2]=IEI[1]
set IZI[3]=IEI[4]
set IZI[4]=IEI[2]
elseif LN2==5 then
set IZI[1]=IEI[4]
set IZI[2]=IEI[3]
set IZI[3]=IEI[2]
set IZI[4]=IEI[5]
set IZI[5]=IEI[1]
endif
else
if LN2==1 then
set IZI[1]=IEI[1]
elseif LN2==2 then
set IZI[1]=IEI[1]
set IZI[2]=IEI[2]
elseif LN2==3 then
set IZI[1]=IEI[3]
set IZI[2]=IEI[2]
set IZI[3]=IEI[1]
elseif LN2==4 then
set IZI[1]=IEI[2]
set IZI[2]=IEI[4]
set IZI[3]=IEI[3]
set IZI[4]=IEI[1]
elseif LN2==5 then
set IZI[1]=IEI[5]
set IZI[2]=IEI[1]
set IZI[3]=IEI[3]
set IZI[4]=IEI[4]
set IZI[5]=IEI[2]
endif
endif
set i=1
loop
exitwhen i>LN2
set IEI[i]=IZI[i]
set i=i+1
endloop
set i=1
loop
exitwhen i>LN2
set IZI[i]=IFI[i]
set i=i+1
endloop
set x=GetRandomInt(1,3)
if x==1 then
if LN2==1 then
set IZI[1]=IFI[1]
elseif LN2==2 then
set IZI[1]=IFI[2]
set IZI[2]=IFI[1]
elseif LN2==3 then
set IZI[1]=IFI[3]
set IZI[2]=IFI[1]
set IZI[3]=IFI[2]
elseif LN2==4 then
set IZI[1]=IFI[4]
set IZI[2]=IFI[3]
set IZI[3]=IFI[2]
set IZI[4]=IFI[1]
elseif LN2==5 then
set IZI[1]=IFI[5]
set IZI[2]=IFI[4]
set IZI[3]=IFI[1]
set IZI[4]=IFI[2]
set IZI[5]=IFI[3]
endif
elseif x==2 then
if LN2==1 then
set IZI[1]=IFI[1]
elseif LN2==2 then
set IZI[1]=IFI[2]
set IZI[2]=IFI[1]
elseif LN2==3 then
set IZI[1]=IFI[2]
set IZI[2]=IFI[3]
set IZI[3]=IFI[1]
elseif LN2==4 then
set IZI[1]=IFI[3]
set IZI[2]=IFI[1]
set IZI[3]=IFI[4]
set IZI[4]=IFI[2]
elseif LN2==5 then
set IZI[1]=IFI[4]
set IZI[2]=IFI[3]
set IZI[3]=IFI[2]
set IZI[4]=IFI[5]
set IZI[5]=IFI[1]
endif
else
if LN2==1 then
set IZI[1]=IFI[1]
elseif LN2==2 then
set IZI[1]=IFI[1]
set IZI[2]=IFI[2]
elseif LN2==3 then
set IZI[1]=IFI[3]
set IZI[2]=IFI[2]
set IZI[3]=IFI[1]
elseif LN2==4 then
set IZI[1]=IFI[2]
set IZI[2]=IFI[4]
set IZI[3]=IFI[3]
set IZI[4]=IFI[1]
elseif LN2==5 then
set IZI[1]=IFI[5]
set IZI[2]=IFI[1]
set IZI[3]=IFI[3]
set IZI[4]=IFI[4]
set IZI[5]=IFI[2]
endif
endif
set i=1
loop
exitwhen i>LN2
set IFI[i]=IZI[i]
set i=i+1
endloop
set i=1
loop
exitwhen i>LN2
set IZI[i]=IGI[i]
set i=i+1
endloop
set x=GetRandomInt(1,3)
if x==1 then
if LN2==1 then
set IZI[1]=IGI[1]
elseif LN2==2 then
set IZI[1]=IGI[2]
set IZI[2]=IGI[1]
elseif LN2==3 then
set IZI[1]=IGI[3]
set IZI[2]=IGI[1]
set IZI[3]=IGI[2]
elseif LN2==4 then
set IZI[1]=IGI[4]
set IZI[2]=IGI[3]
set IZI[3]=IGI[2]
set IZI[4]=IGI[1]
elseif LN2==5 then
set IZI[1]=IGI[5]
set IZI[2]=IGI[4]
set IZI[3]=IGI[1]
set IZI[4]=IGI[2]
set IZI[5]=IGI[3]
endif
elseif x==2 then
if LN2==1 then
set IZI[1]=IGI[1]
elseif LN2==2 then
set IZI[1]=IGI[2]
set IZI[2]=IGI[1]
elseif LN2==3 then
set IZI[1]=IGI[2]
set IZI[2]=IGI[3]
set IZI[3]=IGI[1]
elseif LN2==4 then
set IZI[1]=IGI[3]
set IZI[2]=IGI[1]
set IZI[3]=IGI[4]
set IZI[4]=IGI[2]
elseif LN2==5 then
set IZI[1]=IGI[4]
set IZI[2]=IGI[3]
set IZI[3]=IGI[2]
set IZI[4]=IGI[5]
set IZI[5]=IGI[1]
endif
else
if LN2==1 then
set IZI[1]=IGI[1]
elseif LN2==2 then
set IZI[1]=IGI[1]
set IZI[2]=IGI[2]
elseif LN2==3 then
set IZI[1]=IGI[3]
set IZI[2]=IGI[2]
set IZI[3]=IGI[1]
elseif LN2==4 then
set IZI[1]=IGI[2]
set IZI[2]=IGI[4]
set IZI[3]=IGI[3]
set IZI[4]=IGI[1]
elseif LN2==5 then
set IZI[1]=IGI[5]
set IZI[2]=IGI[1]
set IZI[3]=IGI[3]
set IZI[4]=IGI[4]
set IZI[5]=IGI[2]
endif
endif
set i=1
loop
exitwhen i>LN2
set IGI[i]=IZI[i]
set i=i+1
endloop
set i=1
loop
exitwhen i>LN2
set IZI[i]=IHI[i]
set i=i+1
endloop
set x=GetRandomInt(1,3)
if x==1 then
if LN2==1 then
set IZI[1]=IHI[1]
elseif LN2==2 then
set IZI[1]=IHI[2]
set IZI[2]=IHI[1]
elseif LN2==3 then
set IZI[1]=IHI[3]
set IZI[2]=IHI[1]
set IZI[3]=IHI[2]
elseif LN2==4 then
set IZI[1]=IHI[4]
set IZI[2]=IHI[3]
set IZI[3]=IHI[2]
set IZI[4]=IHI[1]
elseif LN2==5 then
set IZI[1]=IHI[5]
set IZI[2]=IHI[4]
set IZI[3]=IHI[1]
set IZI[4]=IHI[2]
set IZI[5]=IHI[3]
endif
elseif x==2 then
if LN2==1 then
set IZI[1]=IHI[1]
elseif LN2==2 then
set IZI[1]=IHI[2]
set IZI[2]=IHI[1]
elseif LN2==3 then
set IZI[1]=IHI[2]
set IZI[2]=IHI[3]
set IZI[3]=IHI[1]
elseif LN2==4 then
set IZI[1]=IHI[3]
set IZI[2]=IHI[1]
set IZI[3]=IHI[4]
set IZI[4]=IHI[2]
elseif LN2==5 then
set IZI[1]=IHI[4]
set IZI[2]=IHI[3]
set IZI[3]=IHI[2]
set IZI[4]=IHI[5]
set IZI[5]=IHI[1]
endif
else
if LN2==1 then
set IZI[1]=IHI[1]
elseif LN2==2 then
set IZI[1]=IHI[1]
set IZI[2]=IHI[2]
elseif LN2==3 then
set IZI[1]=IHI[3]
set IZI[2]=IHI[2]
set IZI[3]=IHI[1]
elseif LN2==4 then
set IZI[1]=IHI[2]
set IZI[2]=IHI[4]
set IZI[3]=IHI[3]
set IZI[4]=IHI[1]
elseif LN2==5 then
set IZI[1]=IHI[5]
set IZI[2]=IHI[1]
set IZI[3]=IHI[3]
set IZI[4]=IHI[4]
set IZI[5]=IHI[2]
endif
endif
set i=1
loop
exitwhen i>LN2
set IHI[i]=IZI[i]
set i=i+1
endloop
set TJI=GetRandomInt(1,2)
if IVI>=IWI and IVI>=IXI then
call ClearTextMessages()
call QRI(bj_FORCE_ALL_PLAYERS,45,"已有票数："+" "+IYI)
call QRI(bj_FORCE_ALL_PLAYERS,45," ")
set i=1
set x=1
loop
exitwhen i>5
if T3I(BO[i])then
if TJI==1 then
set K1[GetPlayerId(BO[i])]=CreateUnitAtLoc(BO[i],ICI[x],ZC1,bj_UNIT_FACING)
else
set K1[GetPlayerId(BO[i])]=CreateUnitAtLoc(BO[i],IDI[x],ZC1,bj_UNIT_FACING)
endif
set x=x+1
endif
set i=i+1
endloop
set i=1
set x=1
loop
exitwhen i>5
if T3I(CO[i])then
if TJI==1 then
set K1[GetPlayerId(CO[i])]=CreateUnitAtLoc(CO[i],IDI[x],ZD1,bj_UNIT_FACING)
else
set K1[GetPlayerId(CO[i])]=CreateUnitAtLoc(CO[i],ICI[x],ZD1,bj_UNIT_FACING)
endif
set x=x+1
endif
set i=i+1
endloop
elseif IWI>=IVI and IWI>=IXI then
call ClearTextMessages()
call QRI(bj_FORCE_ALL_PLAYERS,45,"已有票数："+" "+IJI)
call QRI(bj_FORCE_ALL_PLAYERS,45," ")
set i=1
set x=1
loop
exitwhen i>5
if T3I(BO[i])then
if TJI==1 then
set K1[GetPlayerId(BO[i])]=CreateUnitAtLoc(BO[i],IEI[x],ZC1,bj_UNIT_FACING)
else
set K1[GetPlayerId(BO[i])]=CreateUnitAtLoc(BO[i],IFI[x],ZC1,bj_UNIT_FACING)
endif
set x=x+1
endif
set i=i+1
endloop
set i=1
set x=1
loop
exitwhen i>5
if T3I(CO[i])then
if TJI==1 then
set K1[GetPlayerId(CO[i])]=CreateUnitAtLoc(CO[i],IFI[x],ZD1,bj_UNIT_FACING)
else
set K1[GetPlayerId(CO[i])]=CreateUnitAtLoc(CO[i],IEI[x],ZD1,bj_UNIT_FACING)
endif
set x=x+1
endif
set i=i+1
endloop
elseif IXI>=IVI and IXI>=IWI then
call ClearTextMessages()
call QRI(bj_FORCE_ALL_PLAYERS,45,"已有票数："+" "+IKI)
call QRI(bj_FORCE_ALL_PLAYERS,45," ")
set i=1
set x=1
loop
exitwhen i>5
if T3I(BO[i])then
if TJI==1 then
set K1[GetPlayerId(BO[i])]=CreateUnitAtLoc(BO[i],IGI[x],ZC1,bj_UNIT_FACING)
else
set K1[GetPlayerId(BO[i])]=CreateUnitAtLoc(BO[i],IHI[x],ZC1,bj_UNIT_FACING)
endif
set x=x+1
endif
set i=i+1
endloop
set i=1
set x=1
loop
exitwhen i>5
if T3I(CO[i])then
if TJI==1 then
set K1[GetPlayerId(CO[i])]=CreateUnitAtLoc(CO[i],IHI[x],ZD1,bj_UNIT_FACING)
else
set K1[GetPlayerId(CO[i])]=CreateUnitAtLoc(CO[i],IGI[x],ZD1,bj_UNIT_FACING)
endif
set x=x+1
endif
set i=i+1
endloop
endif
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,70,false)
call TriggerAddCondition(t,Condition(function LK2))
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
set ZC1=null
set ZD1=null
set LY2=null
set LJ2=null
set t=null
set LM2=null
return false
endfunction
function LT2 takes integer i returns integer
if i==1 then
return RQI(DY0[GetRandomInt(1,DJ0)])
elseif i==2 then
return RQI(DZ0[GetRandomInt(1,DV0)])
elseif i==3 then
return RQI(DW0[GetRandomInt(1,DX0)])
elseif i==4 then
return RQI(DM0[GetRandomInt(1,DN0)])
elseif i==5 then
return RQI(DK0[GetRandomInt(1,DL0)])
endif
return 0
endfunction
function LR2 takes integer i returns integer
local integer RBI
local integer RCI
local integer R4O
set R4O=LT2(i)
if F2 then
return R4O
endif
loop
exitwhen S2[R4O]==false
set R4O=LT2(i)
endloop
set S2[R4O]=true
return R4O
endfunction
function LP2 takes nothing returns nothing
local integer i=DE0
loop
exitwhen i>DH0
set S2[i]=false
set i=i+1
endloop
endfunction
function LQ2 takes nothing returns boolean
local integer LU2=GetPlayerId(GetTriggerPlayer())
local string M02=SubString(GetEventPlayerChatString(),8,9)
local integer MI2=0
if M02=="1"then
set MI2=1
elseif M02=="2"then
set MI2=2
elseif M02=="3"then
set MI2=3
endif
if MI2==0 then
call PYI(GetTriggerPlayer(),"无效选项，请从3个选项中作出一个选择")
return false
endif
if(LoadBoolean(LY,(2001),(950+LU2)))then
call PYI(GetTriggerPlayer(),"你已经投过票了")
return false
endif
call SaveBoolean(LY,(2001),(950+LU2),(true))
if MI2==1 then
call SaveInteger(LY,(2001),(126),(1+(LoadInteger(LY,(2001),(126)))))
elseif MI2==2 then
call SaveInteger(LY,(2001),(127),(1+(LoadInteger(LY,(2001),(127)))))
else
call SaveInteger(LY,(2001),(128),(1+(LoadInteger(LY,(2001),(128)))))
endif
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,20,"你已经选择了"+" Option "+I2S(MI2)+".")
return false
endfunction
function WN2 takes nothing returns nothing
local integer LN2=T8I(OO)
local integer LS2=T8I(AO)
local integer i
local integer x
local trigger t=CreateTrigger()
local location ZC1=GetRectCenter(F4)
local location ZD1=GetRectCenter(E4)
local location LY2=GetRectCenter(O4)
local location LJ2=GetRectCenter(S3)
local integer TJI
local trigger t2
set N2=true
set O3=false
set A3=false
call TZI()
call PanCameraToTimedLocForPlayer(BO[1],LY2,0)
call PanCameraToTimedLocForPlayer(BO[2],LY2,0)
call PanCameraToTimedLocForPlayer(BO[3],LY2,0)
call PanCameraToTimedLocForPlayer(BO[4],LY2,0)
call PanCameraToTimedLocForPlayer(BO[5],LY2,0)
call PanCameraToTimedLocForPlayer(CO[1],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[2],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[3],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[4],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[5],LJ2,0)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-Option",false)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-Option",false)
call TriggerAddCondition(t,Condition(function LQ2))
call LP2()
set i=1
loop
exitwhen i>LN2
set ICI[i]=DC0[LR2(i)]
set IYI=IYI+GetObjectName(ICI[i])
set i=i+1
if i<=LN2 then
set IYI=IYI+"|c005BFEEA-|r"
endif
endloop
set IYI=IYI+" |c00FF0000vs |r"
set i=1
loop
exitwhen i>LS2
set IDI[i]=DC0[LR2(i)]
set IYI=IYI+GetObjectName(IDI[i])
set i=i+1
if i<=LS2 then
set IYI=IYI+"|c005BFEEA-|r"
endif
endloop
call LP2()
set i=1
loop
exitwhen i>LN2
set IEI[i]=DC0[LR2(i)]
set IJI=IJI+GetObjectName(IEI[i])+" "
set i=i+1
if i<=LN2 then
set IJI=IJI+"|c005BFEEA-|r"
endif
endloop
set IJI=IJI+" |c00FF0000vs |r"
set i=1
loop
exitwhen i>LS2
set IFI[i]=DC0[LR2(i)]
set IJI=IJI+GetObjectName(IFI[i])+" "
set i=i+1
if i<=LS2 then
set IJI=IJI+"|c005BFEEA-|r"
endif
endloop
call LP2()
set i=1
loop
exitwhen i>LN2
set IGI[i]=DC0[LR2(i)]
set IKI=IKI+GetObjectName(IGI[i])+" "
set i=i+1
if i<=LN2 then
set IKI=IKI+"|c005BFEEA-|r"
endif
endloop
set IKI=IKI+" |c00FF0000vs |r"
set i=1
loop
exitwhen i>LS2
set IHI[i]=DC0[LR2(i)]
set IKI=IKI+GetObjectName(IHI[i])+" "
set i=i+1
if i<=LS2 then
set IKI=IKI+"|c005BFEEA-|r"
endif
endloop
call QRI(bj_FORCE_ALL_PLAYERS,75," ")
call QRI(bj_FORCE_ALL_PLAYERS,75,"在接下来的30秒内，你可以使用“-option 1/2/3”命令来为下面的选项进行投票")
call QRI(bj_FORCE_ALL_PLAYERS,75,"请注意，这并不意味着"+" "+"近卫军团将会拥有选项中第一套英雄阵容，它是随机的")
call QRI(bj_FORCE_ALL_PLAYERS,75," ")
call QRI(bj_FORCE_ALL_PLAYERS,75,IYI)
call QRI(bj_FORCE_ALL_PLAYERS,75," ")
call QRI(bj_FORCE_ALL_PLAYERS,75,IJI)
call QRI(bj_FORCE_ALL_PLAYERS,75," ")
call QRI(bj_FORCE_ALL_PLAYERS,75,IKI)
set t2=CreateTrigger()
call TriggerRegisterTimerEvent(t2,30,false)
call TriggerAddCondition(t2,Condition(function LL2))
call SaveTriggerHandle(LY,(GetHandleId(t2)),(35),(t))
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
set ZC1=null
set ZD1=null
set LY2=null
set LJ2=null
set t=null
set t2=null
endfunction
function M12 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer NPI=GetTriggerEvalCount(t)
local integer GW1=20-(NPI-(NPI/20)*20)
call LeaderboardSetLabel(ITI,"           "+"剩余时间："+" "+I2S(GW1))
if NPI>125 then
call DestroyLeaderboard(ITI)
call HJ2()
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function MO2 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function M12))
set ITI=CreateLeaderboard()
call LeaderboardSetStyle(ITI,true,false,false,false)
call LeaderboardDisplay(ITI,false)
call PlayerSetLeaderboard(BO[1],ITI)
call PlayerSetLeaderboard(BO[2],ITI)
call PlayerSetLeaderboard(BO[3],ITI)
call PlayerSetLeaderboard(BO[4],ITI)
call PlayerSetLeaderboard(BO[5],ITI)
call PlayerSetLeaderboard(CO[1],ITI)
call PlayerSetLeaderboard(CO[2],ITI)
call PlayerSetLeaderboard(CO[3],ITI)
call PlayerSetLeaderboard(CO[4],ITI)
call PlayerSetLeaderboard(CO[5],ITI)
set t=null
endfunction
function M22 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer KO2=(LoadInteger(LY,(handle_id),(25)))
local player p1
local player p2
local player K22
local player K32
if KO2==0 then
if ILI==1 then
set p1=BO[1]
else
set p1=CO[1]
endif
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p1)])
if GetLocalPlayer()==p1 then
call LeaderboardDisplay(ITI,true)
else
call LeaderboardDisplay(ITI,false)
endif
elseif KO2==1 then
if ILI==1 then
set p1=CO[1]
set p2=CO[2]
set K22=BO[1]
else
set p1=BO[1]
set p2=BO[2]
set K22=CO[1]
endif
call TFI(K22)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(ITI,true)
else
call LeaderboardDisplay(ITI,false)
endif
elseif KO2==2 then
if ILI==1 then
set p1=BO[2]
set p2=BO[3]
set K22=CO[1]
set K32=CO[2]
else
set p1=CO[2]
set p2=CO[3]
set K22=BO[1]
set K32=BO[2]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(ITI,true)
else
call LeaderboardDisplay(ITI,false)
endif
elseif KO2==3 then
if ILI==1 then
set p1=CO[3]
set p2=CO[4]
set K22=BO[2]
set K32=BO[3]
else
set p1=BO[3]
set p2=BO[4]
set K22=CO[2]
set K32=CO[3]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(ITI,true)
else
call LeaderboardDisplay(ITI,false)
endif
elseif KO2==4 then
if ILI==1 then
set p1=BO[4]
set p2=BO[5]
set K22=CO[3]
set K32=CO[4]
else
set p1=CO[4]
set p2=CO[5]
set K22=BO[3]
set K32=BO[4]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(ITI,true)
else
call LeaderboardDisplay(ITI,false)
endif
elseif KO2==5 then
if ILI==1 then
set p1=CO[5]
set K22=BO[4]
set K32=BO[5]
else
set p1=BO[5]
set K22=CO[4]
set K32=CO[5]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IMI[GetPlayerId(p1)])
if GetLocalPlayer()==p1 then
call LeaderboardDisplay(ITI,true)
else
call LeaderboardDisplay(ITI,false)
endif
elseif KO2==6 then
if ILI==1 then
set K22=CO[5]
else
set K22=BO[5]
endif
call TFI(K22)
call LeaderboardDisplay(ITI,false)
call SuspendTimeOfDay(false)
endif
if KO2>6 then
set ISI=true
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveInteger(LY,(handle_id),(25),(KO2+1))
endif
set t=null
set p1=null
set p2=null
set K22=null
set K32=null
return false
endfunction
function M32 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id
call FlushTrigger(t)
call SuspendTimeOfDay(true)
set ILI=GetRandomInt(1,2)
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
if ILI==1 then
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"从"+" "+C0[GetPlayerId(BO[0])]+"近卫军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
else
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"从"+" "+C0[GetPlayerId(CO[0])]+"天灾军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
endif
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,20,true)
call TriggerAddCondition(t,Condition(function M22))
call SaveInteger(LY,(handle_id),(25),(0))
call MO2()
call TriggerEvaluate(t)
set t=null
return false
endfunction
function WP2 takes nothing returns nothing
local trigger t
local integer x=1
set INI=true
set BL=180
set A3=false
set O3=false
call OZ2()
set IMI[GetPlayerId(BO[1])]=GetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(BO[2])]=GetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(BO[3])]=GetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(BO[4])]=GetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(BO[5])]=GetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(CO[1])]=GetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(CO[2])]=GetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(CO[3])]=GetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(CO[4])]=GetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD)
set IMI[GetPlayerId(CO[5])]=GetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD)
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD,0)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15-TimerGetElapsed(M),false)
call TriggerAddCondition(t,Condition(function M32))
set t=null
endfunction
function M42 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer NPI=GetTriggerEvalCount(t)
local integer GW1=20-(NPI-(NPI/20)*20)
call LeaderboardSetLabel(O0I,"           "+"剩余时间："+" "+I2S(GW1))
if NPI>125 then
call DestroyLeaderboard(O0I)
call HJ2()
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function M52 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function M42))
set O0I=CreateLeaderboard()
call LeaderboardSetStyle(O0I,true,false,false,false)
call LeaderboardDisplay(O0I,false)
call PlayerSetLeaderboard(BO[1],O0I)
call PlayerSetLeaderboard(BO[2],O0I)
call PlayerSetLeaderboard(BO[3],O0I)
call PlayerSetLeaderboard(BO[4],O0I)
call PlayerSetLeaderboard(BO[5],O0I)
call PlayerSetLeaderboard(CO[1],O0I)
call PlayerSetLeaderboard(CO[2],O0I)
call PlayerSetLeaderboard(CO[3],O0I)
call PlayerSetLeaderboard(CO[4],O0I)
call PlayerSetLeaderboard(CO[5],O0I)
set t=null
endfunction
function M62 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer KO2=(LoadInteger(LY,(handle_id),(25)))
local player p1
local player p2
local player K22
local player K32
if KO2==0 then
if IRI==1 then
set p1=BO[1]
else
set p1=CO[1]
endif
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p1)])
if GetLocalPlayer()==p1 then
call LeaderboardDisplay(O0I,true)
else
call LeaderboardDisplay(O0I,false)
endif
elseif KO2==1 then
if IRI==1 then
set p1=CO[1]
set p2=CO[2]
set K22=BO[1]
else
set p1=BO[1]
set p2=BO[2]
set K22=CO[1]
endif
call TFI(K22)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(O0I,true)
else
call LeaderboardDisplay(O0I,false)
endif
elseif KO2==2 then
if IRI==1 then
set p1=BO[2]
set p2=BO[3]
set K22=CO[1]
set K32=CO[2]
else
set p1=CO[2]
set p2=CO[3]
set K22=BO[1]
set K32=BO[2]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(O0I,true)
else
call LeaderboardDisplay(O0I,false)
endif
elseif KO2==3 then
if IRI==1 then
set p1=CO[3]
set p2=CO[4]
set K22=BO[2]
set K32=BO[3]
else
set p1=BO[3]
set p2=BO[4]
set K22=CO[2]
set K32=CO[3]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(O0I,true)
else
call LeaderboardDisplay(O0I,false)
endif
elseif KO2==4 then
if IRI==1 then
set p1=BO[4]
set p2=BO[5]
set K22=CO[3]
set K32=CO[4]
else
set p1=CO[4]
set p2=CO[5]
set K22=BO[3]
set K32=BO[4]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p2)]+(D80[GetPlayerId((p2))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p1)])
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p2)])
if GetLocalPlayer()==p1 or GetLocalPlayer()==p2 then
call LeaderboardDisplay(O0I,true)
else
call LeaderboardDisplay(O0I,false)
endif
elseif KO2==5 then
if IRI==1 then
set p1=CO[5]
set K22=BO[4]
set K32=BO[5]
else
set p1=BO[5]
set K22=CO[4]
set K32=CO[5]
endif
call TFI(K22)
call TFI(K32)
call QRI(bj_FORCE_ALL_PLAYERS,15.00,C0[GetPlayerId(p1)]+(D80[GetPlayerId((p1))])+"|r"+" "+"有20秒的时间选择一个英雄")
call SetPlayerState(p1,PLAYER_STATE_RESOURCE_GOLD,IPI[GetPlayerId(p1)])
if GetLocalPlayer()==p1 then
call LeaderboardDisplay(O0I,true)
else
call LeaderboardDisplay(O0I,false)
endif
elseif KO2==6 then
if IRI==1 then
set K22=CO[5]
else
set K22=BO[5]
endif
call TFI(K22)
call LeaderboardDisplay(O0I,false)
call SuspendTimeOfDay(false)
endif
if KO2>6 then
set IUI=true
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveInteger(LY,(handle_id),(25),(KO2+1))
endif
set t=null
set p1=null
set p2=null
set K22=null
set K32=null
return false
endfunction
function M72 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local trigger M82=(LoadTriggerHandle(LY,(handle_id),(169)))
set TP0=true
call FlushTrigger(M82)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,20,true)
call TriggerAddCondition(t,Condition(function M62))
call SaveInteger(LY,(handle_id),(25),(0))
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call EnableTrigger(EV0)
call EnableTrigger(DN)
set IRI=GetRandomInt(1,2)
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
if IRI==1 then
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"移除英雄阶段已经结束"+" "+"从"+" "+C0[GetPlayerId(BO[0])]+"近卫军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
else
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"移除英雄阶段已经结束"+" "+"从"+" "+C0[GetPlayerId(CO[0])]+"天灾军团"+"|r"+" "+"开始，双方按照1-2-2-2-2-1的顺序选择英雄")
endif
call QRI(bj_FORCE_ALL_PLAYERS,15.00," ")
call M52()
call TriggerEvaluate(t)
set t=null
set M82=null
return false
endfunction
function M92 takes nothing returns boolean
local unit SFI=GetSoldUnit()
local string MA2=C0[GetPlayerId(GetOwningPlayer(GetSoldUnit()))]+(D80[GetPlayerId((GetOwningPlayer(GetSoldUnit())))])+"|r"
call QRI(bj_FORCE_ALL_PLAYERS,20,MA2+" "+"移除了"+" "+GetUnitName(SFI)+" "+"from the available hero pool.")
call TCI(GetUnitTypeId(GetSoldUnit()))
call FL1("Ban"+I2S(GetPlayerId(GetOwningPlayer(GetSoldUnit()))),GetUnitTypeId(GetSoldUnit()))
call RemoveUnit(GetSoldUnit())
set SFI=null
return false
endfunction
function MB2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local trigger M82=CreateTrigger()
local integer handle_id
local string MC2=C0[GetPlayerId(BO[1])]+(D80[GetPlayerId((BO[1]))])+"|r"
local string MD2=C0[GetPlayerId(CO[1])]+(D80[GetPlayerId((CO[1]))])+"|r"
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call QRI(bj_FORCE_ALL_PLAYERS,20.00,MC2+" "+"将有20秒的时间来选择从酒馆内移除任意4个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,20.00,MD2+" "+"将有20秒的时间来选择从酒馆内移除任意4个英雄")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call FlushTrigger(t)
call UMI(M82,EVENT_PLAYER_UNIT_SELL)
call TriggerAddCondition(M82,Condition(function M92))
call SuspendTimeOfDay(true)
call DisableTrigger(EV0)
call DisableTrigger(DN)
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,1000)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,1000)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveTriggerHandle(LY,(handle_id),(169),(M82))
call TriggerRegisterTimerEvent(t,20,false)
call TriggerAddCondition(t,Condition(function M72))
set M82=null
set t=null
return false
endfunction
function WQ2 takes nothing returns nothing
local trigger t
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
local integer x=1
loop
exitwhen x>5
if T3I(BO[x])then
call CreateUnitAtLoc(BO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
if T3I(CO[x])then
call CreateUnitAtLoc(CO[x],'n00C',ZC1,bj_UNIT_FACING)
endif
set x=x+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set IQI=true
set BL=180
set A3=false
set O3=false
set TP0=false
call OZ2()
set IPI[GetPlayerId(BO[1])]=GetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(BO[2])]=GetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(BO[3])]=GetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(BO[4])]=GetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(BO[5])]=GetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(CO[1])]=GetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(CO[2])]=GetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(CO[3])]=GetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(CO[4])]=GetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD)
set IPI[GetPlayerId(CO[5])]=GetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD)
call SetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD,0)
call SetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD,0)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15-TimerGetElapsed(M),false)
call TriggerAddCondition(t,Condition(function MB2))
set t=null
set ZC1=null
set ZD1=null
endfunction
function ME2 takes nothing returns boolean
local player T4I
set G3=true
set T4I=BO[1]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=BO[2]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=BO[3]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=BO[4]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=BO[5]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=CO[1]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=CO[2]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=CO[3]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=CO[4]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
set T4I=CO[5]
if(GetPlayerSlotState((T4I))==PLAYER_SLOT_STATE_EMPTY)==false and C3[GetPlayerId(T4I)]==false then
call RGI(T4I)
endif
return false
endfunction
function MF2 takes nothing returns boolean
set O3=false
set A3=false
call TZI()
return false
endfunction
function WR2 takes nothing returns nothing
local integer handle_id=2000
local player array LN2
local player array LS2
local integer x=0
local integer y=0
local integer i=0
local trigger t=CreateTrigger()
set B3=true
call TriggerAddCondition(t,Condition(function ME2))
call TriggerRegisterTimerEvent(t,60-TimerGetElapsed(M),false)
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function MF2))
call TriggerRegisterTimerEvent(t,57-TimerGetElapsed(M),false)
set t=null
if T3I(BO[1])then
set x=x+1
set LN2[x]=BO[1]
endif
if T3I(BO[2])then
set x=x+1
set LN2[x]=BO[2]
endif
if T3I(BO[3])then
set x=x+1
set LN2[x]=BO[3]
endif
if T3I(BO[4])then
set x=x+1
set LN2[x]=BO[4]
endif
if T3I(BO[5])then
set x=x+1
set LN2[x]=BO[5]
endif
if T3I(CO[1])then
set y=y+1
set LS2[y]=CO[1]
endif
if T3I(CO[2])then
set y=y+1
set LS2[y]=CO[2]
endif
if T3I(CO[3])then
set y=y+1
set LS2[y]=CO[3]
endif
if T3I(CO[4])then
set y=y+1
set LS2[y]=CO[4]
endif
if T3I(CO[5])then
set y=y+1
set LS2[y]=CO[5]
endif
set i=1
loop
exitwhen i>x
call SavePlayerHandle(LY,(2000),(550+GetPlayerId(LN2[i])),(LS2[i]))
call SavePlayerHandle(LY,(2000),(550+GetPlayerId(LS2[i])),(LN2[i]))
set i=i+1
endloop
endfunction
function MH2 takes nothing returns nothing
call Q5I(GetEnumUnit())
endfunction
function MZ2 takes unit SFI returns nothing
local integer MV2=GetPlayerId(GetOwningPlayer(SFI))
set KO[MV2]=UnitItemInSlot(SFI,0)
set LO[MV2]=UnitItemInSlot(SFI,1)
set NO[MV2]=UnitItemInSlot(SFI,2)
set TO[MV2]=UnitItemInSlot(SFI,3)
set PO[MV2]=UnitItemInSlot(SFI,4)
set QO[MV2]=UnitItemInSlot(SFI,5)
endfunction
function MW2 takes player RZI,player RVI returns integer
local unit MX2=K1[GetPlayerId(RZI)]
local unit MY2=K1[GetPlayerId(RVI)]
call UnitRemoveBuffs(MX2,true,true)
call UnitRemoveBuffs(MY2,true,true)
if MX2==null and MY2==null then
call QRI(bj_FORCE_ALL_PLAYERS,15,C0[GetPlayerId(BO[0])]+(D80[GetPlayerId((RZI))])+" "+"和"+" "+(D80[GetPlayerId((RVI))])+" "+"没有选择英雄，因此将无英雄可用"+"|r")
elseif GetRandomInt(1,2)==1 then
if(MX2!=null)then
return GetUnitTypeId(MX2)
else
return GetUnitTypeId(MY2)
endif
else
if(MY2!=null)then
return GetUnitTypeId(MY2)
else
return GetUnitTypeId(MX2)
endif
endif
call QRI(bj_FORCE_ALL_PLAYERS,15,C0[GetPlayerId(BO[0])]+(D80[GetPlayerId((RZI))])+" "+"和"+" "+(D80[GetPlayerId((RVI))])+" "+"没有选择英雄，系统将随机分配一位英雄给他们！")
return TYI()
endfunction
function MJ2 takes nothing returns nothing
if(GetUnitTypeId(GetEnumUnit())=='n004')then
call RemoveUnit(GetEnumUnit())
endif
if(GetUnitTypeId(GetEnumUnit())=='o003')then
call RemoveUnit(GetEnumUnit())
endif
endfunction
function MK2 takes nothing returns boolean
local integer TGI
local group ML2=NTI()
local unit MM2
local location LY2=GetRectCenter(O4)
local location LJ2=GetRectCenter(S3)
local integer MN2=T8I(OO)
local player array MS2
local player array MT2
local integer x
local integer y
local real MR2
local real MP2
local real MQ2
local integer MU2
local group Z51=NTI()
call GroupEnumUnitsInRect(Z51,GetWorldBounds(),Condition(function N1I))
call ForGroup(Z51,function MJ2)
call NSI(Z51)
set TGI=1
set x=1
set y=1
loop
exitwhen TGI>5
if(T3I(BO[TGI]))then
call MZ2(K1[GetPlayerId(BO[TGI])])
call GroupAddUnit(ML2,K1[GetPlayerId(BO[TGI])])
set MS2[x]=BO[TGI]
set x=x+1
endif
if(T3I(CO[TGI]))then
call MZ2(K1[GetPlayerId(CO[TGI])])
call GroupAddUnit(ML2,K1[GetPlayerId(CO[TGI])])
set MT2[y]=CO[TGI]
set y=y+1
endif
set TGI=TGI+1
endloop
set x=1
loop
exitwhen x>MN2
set MU2=MW2(MS2[x],MT2[x])
if(K1[GetPlayerId(MS2[x])]==null)then
set MR2=GetLocationX(LY2)+GetRandomReal(1,40)
set MP2=GetLocationY(LY2)+GetRandomReal(1,40)
set MQ2=270
else
set MR2=GetUnitX(K1[GetPlayerId(MS2[x])])
set MP2=GetUnitY(K1[GetPlayerId(MS2[x])])
set MQ2=GetUnitFacing(K1[GetPlayerId(MS2[x])])
call SetUnitPathing(K1[GetPlayerId(MS2[x])],false)
endif
set K1[GetPlayerId(MS2[x])]=CreateUnit(MS2[x],MU2,MR2,MP2,MQ2)
call SetUnitPathing(K1[GetPlayerId(MS2[x])],false)
call SetUnitPosition(K1[GetPlayerId(MS2[x])],MR2,MP2)
call UnitAddItem(K1[GetPlayerId(MS2[x])],KO[GetPlayerId(MS2[x])])
call UnitAddItem(K1[GetPlayerId(MS2[x])],LO[GetPlayerId(MS2[x])])
call UnitAddItem(K1[GetPlayerId(MS2[x])],NO[GetPlayerId(MS2[x])])
call UnitAddItem(K1[GetPlayerId(MS2[x])],TO[GetPlayerId(MS2[x])])
call UnitAddItem(K1[GetPlayerId(MS2[x])],PO[GetPlayerId(MS2[x])])
call UnitAddItem(K1[GetPlayerId(MS2[x])],QO[GetPlayerId(MS2[x])])
call ClearSelectionForPlayer(MS2[x])
call SelectUnitAddForPlayer(K1[GetPlayerId(MS2[x])],MS2[x])
call PanCameraToTimedForPlayer(MS2[x],MR2,MP2,0)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",MR2,MP2))
if(K1[GetPlayerId(MT2[x])]==null)then
set MR2=GetLocationX(LJ2)
set MP2=GetLocationY(LJ2)
set MQ2=270
else
set MR2=GetUnitX(K1[GetPlayerId(MT2[x])])
set MP2=GetUnitY(K1[GetPlayerId(MT2[x])])
set MQ2=GetUnitFacing(K1[GetPlayerId(MT2[x])])
call SetUnitPathing(K1[GetPlayerId(MT2[x])],false)
endif
set K1[GetPlayerId(MT2[x])]=CreateUnit(MT2[x],MU2,MR2,MP2,MQ2)
call SetUnitPathing(K1[GetPlayerId(MT2[x])],false)
call SetUnitPosition(K1[GetPlayerId(MT2[x])],MR2,MP2)
call UnitAddItem(K1[GetPlayerId(MT2[x])],KO[GetPlayerId(MT2[x])])
call UnitAddItem(K1[GetPlayerId(MT2[x])],LO[GetPlayerId(MT2[x])])
call UnitAddItem(K1[GetPlayerId(MT2[x])],NO[GetPlayerId(MT2[x])])
call UnitAddItem(K1[GetPlayerId(MT2[x])],TO[GetPlayerId(MT2[x])])
call UnitAddItem(K1[GetPlayerId(MT2[x])],PO[GetPlayerId(MT2[x])])
call UnitAddItem(K1[GetPlayerId(MT2[x])],QO[GetPlayerId(MT2[x])])
call ClearSelectionForPlayer(MT2[x])
call SelectUnitAddForPlayer(K1[GetPlayerId(MT2[x])],MT2[x])
call PanCameraToTimedForPlayer(MT2[x],MR2,MP2,0)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Awaken\\Awaken.mdl",MR2,MP2))
set x=x+1
endloop
call ForGroup(ML2,function MH2)
call NSI(ML2)
set x=1
loop
exitwhen x>MN2
call SetUnitPathing(K1[GetPlayerId(MS2[x])],true)
call SetUnitPathing(K1[GetPlayerId(MT2[x])],true)
set x=x+1
endloop
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
set ML2=null
set MM2=null
set LY2=null
set LJ2=null
set Z51=null
return false
endfunction
function N02 takes nothing returns boolean
set D2=true
return false
endfunction
function NI2 takes nothing returns boolean
set A3=false
set O3=false
call TZI()
return false
endfunction
function WZ2 takes nothing returns nothing
local trigger t=CreateTrigger()
call QRI(P2,10,"你所使用的英雄可能在第60秒后被替换")
call QRI(P2,10,"在那之前，请不要买物品")
set E2=true
call TCI('H00I')
call TriggerRegisterTimerEvent(t,60-TimerGetElapsed(M),false)
call TriggerAddCondition(t,Condition(function MK2))
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function NI2))
call TriggerRegisterTimerEvent(t,57-TimerGetElapsed(M),false)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,55+60-TimerGetElapsed(M),false)
call TriggerAddCondition(t,Condition(function N02))
set t=null
endfunction
function WT2 takes nothing returns nothing
local location ZC1=GetRectCenter(F4)
local location ZD1=GetRectCenter(E4)
local location LY2=GetRectCenter(O4)
local location LJ2=GetRectCenter(S3)
local integer TGI
local integer THI
local integer TJI
if not F2 then
call TZI()
endif
set J0=true
set T0=400
set O3=false
call PanCameraToTimedLocForPlayer(BO[1],LY2,0)
call PanCameraToTimedLocForPlayer(BO[2],LY2,0)
call PanCameraToTimedLocForPlayer(BO[3],LY2,0)
call PanCameraToTimedLocForPlayer(BO[4],LY2,0)
call PanCameraToTimedLocForPlayer(BO[5],LY2,0)
call PanCameraToTimedLocForPlayer(CO[1],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[2],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[3],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[4],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[5],LJ2,0)
if Y2 then
if IsPlayerTeam1(WO)then
loop
set TJI=GetRandomInt(DE0,DF0)
exitwhen R[TJI]==false
endloop
set K1[GetPlayerId(WO)]=CreateUnit(WO,DC0[TJI],GetLocationX(ZC1),GetLocationY(ZC1),270)
else
loop
set TJI=GetRandomInt(DG0,DH0)
exitwhen R[TJI]==false
endloop
set K1[GetPlayerId(WO)]=CreateUnit(WO,DC0[TJI],GetLocationX(ZD1),GetLocationY(ZD1),270)
endif
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
return
endif
set A3=false
set TGI=1
set THI=5
loop
exitwhen TGI>THI
set K1[GetPlayerId(BO[TGI])]=null
if(T3I(BO[TGI]))then
loop
set TJI=GetRandomInt(DE0,DF0)
if(R[TJI]==false)then
if not F2 then
set R[TJI]=true
endif
set K1[GetPlayerId(BO[TGI])]=CreateUnitAtLoc(BO[TGI],DC0[TJI],ZC1,bj_UNIT_FACING)
endif
exitwhen(K1[GetPlayerId(BO[TGI])]!=null)
endloop
endif
set TGI=TGI+1
endloop
set TGI=1
set THI=5
loop
exitwhen TGI>THI
set K1[GetPlayerId(CO[TGI])]=null
if(T3I(CO[TGI]))then
loop
set TJI=GetRandomInt(DG0,DH0)
if(R[TJI]==false)then
if not F2 then
set R[TJI]=true
endif
set K1[GetPlayerId(CO[TGI])]=CreateUnitAtLoc(CO[TGI],DC0[TJI],ZD1,bj_UNIT_FACING)
endif
exitwhen(K1[GetPlayerId(CO[TGI])]!=null)
endloop
endif
set TGI=TGI+1
endloop
set A3=true
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
call RemoveLocation(LY2)
call RemoveLocation(LJ2)
endfunction
function N22 takes nothing returns nothing
set WL=true
call QRI(bj_FORCE_ALL_PLAYERS,10,"免死模式已经激活"+" "+"你不需要等待时间即可复活")
call DisableTrigger(GetTriggeringTrigger())
endfunction
function N32 takes nothing returns nothing
local integer N42=S2I(SubString(GetEventPlayerChatString(),6,StringLength(GetEventPlayerChatString())))
if N42>YL then
call PZI(WO,"数值在10-46之间有效")
elseif N42<10 then
call PZI(WO,"数值在10-46之间有效")
else
set YL=N42
call QRI(bj_FORCE_ALL_PLAYERS,10,"每个队伍在输掉比赛前，共有"+" "+I2S(YL)+" "+"条命")
call DisableTrigger(GetTriggeringTrigger())
endif
endfunction
function N52 takes nothing returns nothing
call DisableTrigger((LoadTriggerHandle(LY,(GetHandleId(GetTriggeringTrigger())),(170))))
call DisableTrigger((LoadTriggerHandle(LY,(GetHandleId(GetTriggeringTrigger())),(171))))
call DisableTrigger(GetTriggeringTrigger())
endfunction
function N62 takes nothing returns nothing
local trigger N72=CreateTrigger()
local trigger N82=CreateTrigger()
local trigger nd=CreateTrigger()
set YL=Q9I(DF0,DH0-DG0+1)
call QRI(bj_FORCE_ALL_PLAYERS,10.00," ")
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"扩展命令："+" -nd "+"和"+" -lives xx "+"在接下来15秒钟之内键入才有效")
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"目前，死亡模式的团队生命总数为"+" "+I2S(YL))
call TriggerRegisterTimerEvent(N72,15,false)
call TriggerAddAction(N72,function N52)
call SaveTriggerHandle(LY,(GetHandleId(N72)),(170),(nd))
call SaveTriggerHandle(LY,(GetHandleId(N72)),(171),(N82))
call TriggerRegisterPlayerChatEvent(nd,WO,"-nd",true)
call TriggerAddAction(nd,function N22)
call TriggerRegisterPlayerChatEvent(N82,WO,"-lives",false)
call TriggerAddAction(N82,function N32)
endfunction
function N92 takes nothing returns nothing
local integer NA2=(LoadInteger(LY,(GetHandleId(GetTriggeringTrigger())),(173)))
local integer TGI
local integer THI
local integer TJI
local integer O91
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
if Q2 then
return
endif
if IsPlayerTeam1(Player(NA2))then
set TGI=DE0
set THI=DF0
set O91=0
else
set TGI=DG0
set THI=DH0
set O91=1
endif
if K0 then
set TGI=DE0
set THI=DH0
if IsPlayerTeam1(Player(NA2))then
call CreateUnitAtLoc(Player(NA2),'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(Player(NA2),'n00C',ZD1,bj_UNIT_FACING)
else
call CreateUnitAtLoc(Player(NA2),'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(Player(NA2),'n00C',ZD1,bj_UNIT_FACING)
endif
else
set TGI=DE0
set THI=DH0
if IsPlayerTeam1(Player(NA2))then
call CreateUnitAtLoc(Player(NA2),'n00C',ZC1,bj_UNIT_FACING)
else
call CreateUnitAtLoc(Player(NA2),'n00C',ZD1,bj_UNIT_FACING)
endif
endif
if not Y0 then
loop
exitwhen TGI>THI
if R[TGI]==false then
call SetPlayerTechMaxAllowed(Player(NA2),DC0[TGI],1)
endif
set TGI=TGI+1
endloop
if(GetPlayerState(Player(NA2),PLAYER_STATE_RESOURCE_GOLD)<250)then
call SetPlayerState(Player(NA2),PLAYER_STATE_RESOURCE_GOLD,250)
endif
elseif(T1[O91]<YL)then
set K1[NA2]=null
if T3I(Player(NA2))then
loop
set TJI=TYI()
if R[TJI]==false then
set R[TJI]=true
if IsPlayerTeam1(Player(NA2))then
set K1[NA2]=CreateUnitAtLoc(Player(NA2),DC0[TJI],ZC1,bj_UNIT_FACING)
else
set K1[NA2]=CreateUnitAtLoc(Player(NA2),DC0[TJI],ZD1,bj_UNIT_FACING)
endif
endif
exitwhen K1[NA2]!=null
endloop
endif
endif
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
if not Y0 then
endif
endfunction
function WH2 takes nothing returns nothing
local location BFO
local real NB2
local trigger t
local integer NC2
local integer x
set X0=true
call TCI('H00I')
set x=1
loop
exitwhen x>5
set NC2=GetPlayerId(BO[x])
set t=CreateTrigger()
call TriggerRegisterTimerExpireEvent(t,F0[NC2])
call TriggerAddAction(t,function N92)
call SaveInteger(LY,(GetHandleId(t)),(173),(NC2))
set NC2=GetPlayerId(CO[x])
set t=CreateTrigger()
call TriggerRegisterTimerExpireEvent(t,F0[NC2])
call TriggerAddAction(t,function N92)
call SaveInteger(LY,(GetHandleId(t)),(173),(NC2))
set x=x+1
endloop
call UnitRemoveAbility(CT0,'Aawa')
call UnitRemoveAbility(CR0,'Aawa')
call UnitRemoveAbility(CP0,'Aawa')
call UnitRemoveAbility(CQ0,'Aawa')
call UnitRemoveAbility(CU0,'Aawa')
call UnitRemoveAbility(D00,'Aawa')
call UnitRemoveAbility(DI0,'Aawa')
call UnitRemoveAbility(D10,'Aawa')
call UnitRemoveAbility(DO0,'Aawa')
call UnitRemoveAbility(D20,'Aawa')
call ExecuteFunc("N62")
endfunction
function X12 takes nothing returns nothing
local integer L42=GetRandomInt(1,4)
set G2=true
if(L42==1)then
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"系统随机为你选择了随机征召")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call ExecuteFunc("X02")
endif
if(L42==2)then
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"系统随机为你选择了有限征召")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call ExecuteFunc("XI2")
endif
if(L42==3)then
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"系统随机为你选择了随机阵容投票")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call ExecuteFunc("WN2")
endif
if(L42==4)then
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"系统随机为你选择了全阵营随机/全智力")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
call ExecuteFunc("WX2")
call ExecuteFunc("WM2")
endif
endfunction
function WL2 takes nothing returns nothing
set F2=true
call TCI('H00I')
call TCI('N0MU')
endfunction
function WE2 takes nothing returns nothing
local integer ZB1=T8I(OO)
local integer ZA1=T8I(AO)
local integer QHI=ZB1+ZA1
local integer TGI
local integer NF2
local integer x
local integer y
local integer z
local player array NG2
local player array NH2
local integer w
local integer NZ2
local integer NV2
local location LY2=GetRectCenter(O4)
local location LJ2=GetRectCenter(S3)
local location ZC1=GetRectCenter(N4)
local location ZD1=GetRectCenter(S4)
set FO=true
call QK1(BO[1])
call QK1(BO[2])
call QK1(BO[3])
call QK1(BO[4])
call QK1(BO[5])
call QK1(CO[1])
call QK1(CO[2])
call QK1(CO[3])
call QK1(CO[4])
call QK1(CO[5])
set x=1
loop
exitwhen x>5
if T3I(BO[x])then
call CreateUnitAtLoc(BO[x],'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(BO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
if T3I(CO[x])then
call CreateUnitAtLoc(CO[x],'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(CO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
set x=x+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set NZ2=GetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD)
set NV2=GetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD)
set NG2[1]=null
set NG2[2]=null
set NG2[3]=null
set NG2[4]=null
set NG2[5]=null
set NG2[6]=null
set NG2[7]=null
set NG2[8]=null
set NG2[9]=null
set NG2[10]=null
set z=1
set w=1
set TGI=1
loop
exitwhen TGI>5
if(T3I(BO[TGI]))then
set NG2[w]=BO[TGI]
set w=w+1
else
set NH2[z]=BO[TGI]
set z=z+1
endif
set TGI=TGI+1
endloop
set TGI=1
loop
exitwhen TGI>5
if(T3I(CO[TGI]))then
set NG2[w]=CO[TGI]
set w=w+1
else
set NH2[z]=CO[TGI]
set z=z+1
endif
set TGI=TGI+1
endloop
set BO[1]=null
set BO[2]=null
set BO[3]=null
set BO[4]=null
set BO[5]=null
set CO[1]=null
set CO[2]=null
set CO[3]=null
set CO[4]=null
set CO[5]=null
set TGI=1
loop
exitwhen TGI>(QHI/2)
set NF2=GetRandomInt(1,QHI)
if(NG2[NF2]!=null)then
set BO[TGI]=NG2[NF2]
set NG2[NF2]=null
set TGI=TGI+1
endif
endloop
set x=TGI
set TGI=1
loop
exitwhen TGI>QHI-x+1
set NF2=GetRandomInt(1,QHI)
if(NG2[NF2]!=null)then
set CO[TGI]=NG2[NF2]
set NG2[NF2]=null
set TGI=TGI+1
endif
endloop
set z=TGI
set TGI=x
set y=1
loop
exitwhen TGI>5
set BO[TGI]=NH2[y]
set y=y+1
set TGI=TGI+1
endloop
set TGI=z
loop
exitwhen TGI>5
set CO[TGI]=NH2[y]
set y=y+1
set TGI=TGI+1
endloop
set TGI=0
loop
exitwhen TGI>5
set TGI=TGI+1
endloop
call SetPlayerTeam(BO[0],0)
call SetPlayerTeam(BO[1],0)
call SetPlayerTeam(BO[2],0)
call SetPlayerTeam(BO[3],0)
call SetPlayerTeam(BO[4],0)
call SetPlayerTeam(BO[5],0)
call SetPlayerTeam(CO[0],1)
call SetPlayerTeam(CO[1],1)
call SetPlayerTeam(CO[2],1)
call SetPlayerTeam(CO[3],1)
call SetPlayerTeam(CO[4],1)
call SetPlayerTeam(CO[5],1)
call Z11()
set x=0
set y=0
loop
exitwhen x>5
loop
exitwhen y>5
call SetPlayerAllianceStateBJ(BO[x],BO[y],3)
call SetPlayerAllianceStateBJ(CO[x],CO[y],3)
call SetPlayerAllianceStateBJ(BO[x],CO[y],0)
call SetPlayerAllianceStateBJ(CO[x],BO[y],0)
set y=y+1
endloop
set y=0
set x=x+1
endloop
call ForceClear(OO)
call ForceClear(AO)
call ForceAddPlayer(OO,BO[0])
call ForceAddPlayer(OO,BO[1])
call ForceAddPlayer(OO,BO[2])
call ForceAddPlayer(OO,BO[3])
call ForceAddPlayer(OO,BO[4])
call ForceAddPlayer(OO,BO[5])
call ForceAddPlayer(AO,CO[0])
call ForceAddPlayer(AO,CO[1])
call ForceAddPlayer(AO,CO[2])
call ForceAddPlayer(AO,CO[3])
call ForceAddPlayer(AO,CO[4])
call ForceAddPlayer(AO,CO[5])
call ExecuteFunc("ZO1")
call P7O()
set ZB1=T8I(OO)
set ZA1=T8I(AO)
set TGI=1
loop
exitwhen TGI>5
if(T3I(BO[TGI]))then
call SetPlayerStateBJ(BO[TGI],PLAYER_STATE_RESOURCE_GOLD,(4375/ZB1))
call SetPlayerStateBJ(BO[TGI],PLAYER_STATE_RESOURCE_LUMBER,0)
endif
if(T3I(CO[TGI]))then
call SetPlayerStateBJ(CO[TGI],PLAYER_STATE_RESOURCE_GOLD,(4375/ZA1))
call SetPlayerStateBJ(CO[TGI],PLAYER_STATE_RESOURCE_LUMBER,0)
endif
set TGI=TGI+1
endloop
if C2 then
set x=0
loop
exitwhen x>5
call SetPlayerAlliance(Player(0),BO[x],ConvertAllianceType(0),true)
call SetPlayerAlliance(Player(0),BO[x],ConvertAllianceType(4),true)
call SetPlayerAlliance(Player(0),CO[x],ConvertAllianceType(0),false)
call SetPlayerAlliance(Player(0),CO[x],ConvertAllianceType(4),false)
set x=x+1
endloop
endif
call ZI1()
set LY2=null
set LJ2=null
set ZC1=null
set ZD1=null
endfunction
function WF2 takes nothing returns nothing
local integer ZB1=T8I(OO)
local integer ZA1=T8I(AO)
local integer QHI=ZB1+ZA1
local integer TGI
local integer NF2
local integer x
local integer y
local integer z
local player array NG2
local player array NH2
local integer w
local integer NZ2
local integer NV2
local location LY2
local location LJ2
local location ZC1
local location ZD1
local integer NX2
set NX2=GetRandomInt(1,2)
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"双方阵营已被随机分配")
if NX2==1 then
return
endif
set OII=true
set LY2=GetRectCenter(O4)
set LJ2=GetRectCenter(S3)
set ZC1=GetRectCenter(N4)
set ZD1=GetRectCenter(S4)
call QK1(BO[1])
call QK1(BO[2])
call QK1(BO[3])
call QK1(BO[4])
call QK1(BO[5])
call QK1(CO[1])
call QK1(CO[2])
call QK1(CO[3])
call QK1(CO[4])
call QK1(CO[5])
set x=1
loop
exitwhen x>5
if T3I(BO[x])then
call CreateUnitAtLoc(BO[x],'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(BO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
if T3I(CO[x])then
call CreateUnitAtLoc(CO[x],'n00C',ZC1,bj_UNIT_FACING)
call CreateUnitAtLoc(CO[x],'n00C',ZD1,bj_UNIT_FACING)
endif
set x=x+1
endloop
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set NZ2=GetPlayerState(BO[1],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[2],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[3],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[4],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(BO[5],PLAYER_STATE_RESOURCE_GOLD)
set NV2=GetPlayerState(CO[1],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[2],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[3],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[4],PLAYER_STATE_RESOURCE_GOLD)+GetPlayerState(CO[5],PLAYER_STATE_RESOURCE_GOLD)
set NG2[1]=BO[1]
set NG2[2]=BO[2]
set NG2[3]=BO[3]
set NG2[4]=BO[4]
set NG2[5]=BO[5]
set NG2[6]=CO[1]
set NG2[7]=CO[2]
set NG2[8]=CO[3]
set NG2[9]=CO[4]
set NG2[10]=CO[5]
set BO[1]=NG2[6]
set BO[2]=NG2[7]
set BO[3]=NG2[8]
set BO[4]=NG2[9]
set BO[5]=NG2[10]
set CO[1]=NG2[1]
set CO[2]=NG2[2]
set CO[3]=NG2[3]
set CO[4]=NG2[4]
set CO[5]=NG2[5]
call SetPlayerTeam(BO[0],0)
call SetPlayerTeam(BO[1],0)
call SetPlayerTeam(BO[2],0)
call SetPlayerTeam(BO[3],0)
call SetPlayerTeam(BO[4],0)
call SetPlayerTeam(BO[5],0)
call SetPlayerTeam(CO[0],1)
call SetPlayerTeam(CO[1],1)
call SetPlayerTeam(CO[2],1)
call SetPlayerTeam(CO[3],1)
call SetPlayerTeam(CO[4],1)
call SetPlayerTeam(CO[5],1)
call Z11()
set x=0
set y=0
loop
exitwhen x>5
loop
exitwhen y>5
call SetPlayerAllianceStateBJ(BO[x],BO[y],3)
call SetPlayerAllianceStateBJ(CO[x],CO[y],3)
call SetPlayerAllianceStateBJ(BO[x],CO[y],0)
call SetPlayerAllianceStateBJ(CO[x],BO[y],0)
set y=y+1
endloop
set y=0
set x=x+1
endloop
call ForceClear(OO)
call ForceClear(AO)
call ForceAddPlayer(OO,BO[0])
call ForceAddPlayer(OO,BO[1])
call ForceAddPlayer(OO,BO[2])
call ForceAddPlayer(OO,BO[3])
call ForceAddPlayer(OO,BO[4])
call ForceAddPlayer(OO,BO[5])
call ForceAddPlayer(AO,CO[0])
call ForceAddPlayer(AO,CO[1])
call ForceAddPlayer(AO,CO[2])
call ForceAddPlayer(AO,CO[3])
call ForceAddPlayer(AO,CO[4])
call ForceAddPlayer(AO,CO[5])
call ExecuteFunc("ZO1")
set ZB1=T8I(OO)
set ZA1=T8I(AO)
set TGI=1
loop
exitwhen TGI>5
if(T3I(BO[TGI]))then
call SetPlayerStateBJ(BO[TGI],PLAYER_STATE_RESOURCE_GOLD,(4375/ZB1))
call SetPlayerStateBJ(BO[TGI],PLAYER_STATE_RESOURCE_LUMBER,0)
endif
if(T3I(CO[TGI]))then
call SetPlayerStateBJ(CO[TGI],PLAYER_STATE_RESOURCE_GOLD,(4375/ZA1))
call SetPlayerStateBJ(CO[TGI],PLAYER_STATE_RESOURCE_LUMBER,0)
endif
set TGI=TGI+1
endloop
call PanCameraToTimedLocForPlayer(BO[1],LY2,0)
call PanCameraToTimedLocForPlayer(BO[2],LY2,0)
call PanCameraToTimedLocForPlayer(BO[3],LY2,0)
call PanCameraToTimedLocForPlayer(BO[4],LY2,0)
call PanCameraToTimedLocForPlayer(BO[5],LY2,0)
call PanCameraToTimedLocForPlayer(CO[1],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[2],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[3],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[4],LJ2,0)
call PanCameraToTimedLocForPlayer(CO[5],LJ2,0)
call DestroyFogModifier(CreateFogModifierRectBJ(true,BO[1],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,BO[2],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,BO[3],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,BO[4],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,BO[5],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,CO[1],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,CO[2],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,CO[3],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,CO[4],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
call DestroyFogModifier(CreateFogModifierRectBJ(true,CO[5],FOG_OF_WAR_MASKED,bj_mapInitialPlayableArea))
if C2 then
set x=0
loop
exitwhen x>5
call SetPlayerAlliance(Player(0),BO[x],ConvertAllianceType(0),true)
call SetPlayerAlliance(Player(0),BO[x],ConvertAllianceType(4),true)
call SetPlayerAlliance(Player(0),CO[x],ConvertAllianceType(0),false)
call SetPlayerAlliance(Player(0),CO[x],ConvertAllianceType(4),false)
set x=x+1
endloop
endif
call ZI1()
call P7O()
set LY2=null
set LJ2=null
set ZC1=null
set ZD1=null
endfunction
function WW2 takes nothing returns nothing
local integer TGI
local integer THI
set H2=true
set TGI=1
set THI=DJ0
loop
exitwhen TGI>THI
call TCI(DY0[TGI])
set TGI=TGI+1
endloop
set TGI=1
set THI=DX0
loop
exitwhen TGI>THI
call TCI(DW0[TGI])
set TGI=TGI+1
endloop
endfunction
function NJ2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer SZI=(LoadInteger(LY,(handle_id),(172)))
local player T4I
local integer x=1
loop
exitwhen x>5
set T4I=BO[x]
if T3I(T4I)and T4I!=WO then
set K1[GetPlayerId(T4I)]=CreateUnit(T4I,SZI,GetRectCenterX(O4),GetRectCenterY(O4),270)
endif
set T4I=CO[x]
if T3I(T4I)and T4I!=WO then
set K1[GetPlayerId(T4I)]=CreateUnit(T4I,SZI,GetRectCenterX(S3),GetRectCenterY(S3),270)
endif
set x=x+1
endloop
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set T4I=null
return false
endfunction
function NK2 takes nothing returns nothing
local integer x=1
local player T4I
local unit SFI=GetTriggerUnit()
local integer SZI=GetUnitTypeId(SFI)
local trigger t
local integer handle_id
if(GetOwningPlayer(SFI)==WO and IsUnitType(SFI,UNIT_TYPE_HERO)==true)then
call DisableTrigger(GetTriggeringTrigger())
if S0[GetPlayerId(WO)]==false and Y0==false and J0==false then
call SetPlayerState(WO,PLAYER_STATE_RESOURCE_GOLD,250+GetPlayerState(WO,PLAYER_STATE_RESOURCE_GOLD))
endif
set D0[GetPlayerId(WO)]=true
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function NJ2))
call SaveInteger(LY,(handle_id),(172),(SZI))
endif
set T4I=null
set SFI=null
set t=null
endfunction
function WV2 takes nothing returns nothing
local integer x=1
local trigger t=CreateTrigger()
local region r=CreateRegion()
set Y2=true
call TCI('H00I')
call TCI('N0MU')
loop
exitwhen x>5
if(BO[x]!=WO)then
call TFI(BO[x])
set S0[GetPlayerId(BO[x])]=true
set D0[GetPlayerId(BO[x])]=true
endif
if(CO[x]!=WO)then
call TFI(CO[x])
set S0[GetPlayerId(CO[x])]=true
set D0[GetPlayerId(CO[x])]=true
endif
set x=x+1
endloop
call RegionAddRect(r,bj_mapInitialPlayableArea)
call TriggerRegisterEnterRegion(t,r,Condition(function N1I))
call TriggerAddAction(t,function NK2)
endfunction
function WY2 takes nothing returns nothing
local integer TGI
local integer THI
set V2=true
set TGI=1
set THI=DJ0
loop
exitwhen TGI>THI
call TCI(DY0[TGI])
set TGI=TGI+1
endloop
set TGI=1
set THI=DV0
loop
exitwhen TGI>THI
call TCI(DZ0[TGI])
set TGI=TGI+1
endloop
endfunction
function WX2 takes nothing returns nothing
local integer TGI
local integer THI
set Z2=true
set TGI=1
set THI=DV0
loop
exitwhen TGI>THI
call TCI(DZ0[TGI])
set TGI=TGI+1
endloop
set TGI=1
set THI=DX0
loop
exitwhen TGI>THI
call TCI(DW0[TGI])
set TGI=TGI+1
endloop
endfunction
function WK2 takes nothing returns nothing
local integer TGI
local integer THI
set O1I=true
set TGI=1
set THI=DL0
loop
exitwhen TGI>THI
call TCI(DK0[TGI])
set TGI=TGI+1
endloop
endfunction
function WJ2 takes nothing returns nothing
local integer TGI
local integer THI
set OOI=true
set TGI=1
set THI=DN0
loop
exitwhen TGI>THI
call TCI(DM0[TGI])
set TGI=TGI+1
endloop
endfunction
function XO2 takes nothing returns nothing
set L0=true
endfunction
function X42 takes nothing returns nothing
set R0=true
call SetPlayerTechResearched(BO[0],'R004',1)
call SetPlayerTechResearched(CO[0],'R004',1)
call SetPlayerHandicapXP(BO[1],1.5)
call SetPlayerHandicapXP(BO[2],1.5)
call SetPlayerHandicapXP(BO[3],1.5)
call SetPlayerHandicapXP(BO[4],1.5)
call SetPlayerHandicapXP(BO[5],1.5)
call SetPlayerHandicapXP(CO[1],1.5)
call SetPlayerHandicapXP(CO[2],1.5)
call SetPlayerHandicapXP(CO[3],1.5)
call SetPlayerHandicapXP(CO[4],1.5)
call SetPlayerHandicapXP(CO[5],1.5)
endfunction
function X22 takes nothing returns nothing
set P0=true
call DisableTrigger(J20)
endfunction
function X32 takes nothing returns nothing
set Q0=true
endfunction
function NQ2 takes nothing returns nothing
set O3I=false
call QRI(bj_FORCE_ALL_PLAYERS,10,"禁止刷野开启，野怪将不会出现")
call DisableTrigger(GetTriggeringTrigger())
endfunction
function NU2 takes nothing returns nothing
call DisableTrigger((LoadTriggerHandle(LY,(GetHandleId(GetTriggeringTrigger())),(174))))
call DisableTrigger(GetTriggeringTrigger())
endfunction
function S02 takes nothing returns nothing
local trigger N72=CreateTrigger()
local trigger nn=CreateTrigger()
call QRI(bj_FORCE_ALL_PLAYERS,10.00," ")
call QRI(bj_FORCE_ALL_PLAYERS,10.00,"Extra commands: -noneutrals can be entered in the following 15 seconds. ")
call TriggerRegisterTimerEvent(N72,15,false)
call TriggerAddAction(N72,function NU2)
call SaveTriggerHandle(LY,(GetHandleId(N72)),(174),(nn))
call TriggerRegisterPlayerChatEvent(nn,WO,"-noneutrals",true)
call TriggerAddAction(nn,function NQ2)
endfunction
function X52 takes nothing returns nothing
set O2I=true
call ExecuteFunc("S02")
endfunction
function X62 takes nothing returns nothing
set O4I=true
endfunction
function WG2 takes nothing returns nothing
set O5I=true
endfunction
function X82 takes nothing returns nothing
set O6I=true
endfunction
function X72 takes nothing returns nothing
set O7I=true
endfunction
function XA2 takes nothing returns nothing
set FL=true
set GL=false
endfunction
function XB2 takes nothing returns nothing
set O8I=true
endfunction
function X92 takes nothing returns nothing
set VL=true
set JL=true
endfunction
function XC2 takes nothing returns nothing
set ZL=true
endfunction
function S52 takes nothing returns nothing
local integer i=0
loop
exitwhen i>5
call SetPlayerName(BO[i],(D80[GetPlayerId((BO[i]))])+" ("+I2S(I[GetPlayerId(BO[i])])+"/"+I2S(O[GetPlayerId(BO[i])])+" | "+I2S(A[GetPlayerId(BO[i])])+"-"+I2S(B[GetPlayerId(BO[i])])+")")
call SetPlayerName(CO[i],(D80[GetPlayerId((CO[i]))])+" ("+I2S(I[GetPlayerId(CO[i])])+"/"+I2S(O[GetPlayerId(CO[i])])+" | "+I2S(A[GetPlayerId(CO[i])])+"-"+I2S(B[GetPlayerId(CO[i])])+")")
set i=i+1
endloop
endfunction
function S62 takes nothing returns boolean
if O9I==false then
if GetLocalPlayer()==D60 or GetLocalPlayer()==D70 then
call S52()
endif
endif
return false
endfunction
function XD2 takes nothing returns nothing
set O9I=true
endfunction
function S82 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
call SetUnitScale(SFI,SMI(SFI)*OAI,SMI(SFI)*OAI,SMI(SFI)*OAI)
set SFI=null
endfunction
function S92 takes nothing returns boolean
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true then
call S82()
endif
return false
endfunction
function XE2 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,bj_mapInitialPlayableArea)
call TriggerAddCondition(t,Condition(function S92))
set OBI=true
set OAI=0.5
endfunction
function XF2 takes nothing returns nothing
set OCI=true
endfunction
function XG2 takes nothing returns nothing
set HL=true
endfunction
function SB2 takes nothing returns boolean
if GetLocalPlayer()==D60 or GetLocalPlayer()==D70 then
if GetTriggerEvalCount(GetTriggeringTrigger())==1 then
call CameraSetupSetDestPosition(OEI,0,0,0.0)
else
call CameraSetupSetDestPosition(OEI,GetCameraTargetPositionX(),GetCameraTargetPositionY(),0.0)
endif
call CameraSetupApplyForPlayer(true,OEI,GetLocalPlayer(),0)
call SetTerrainFogEx(0,0.0,100000.0,0.500,0.353,0.314,0.235)
endif
return false
endfunction
function XZ2 takes nothing returns nothing
local trigger t=CreateTrigger()
set ODI=true
set OEI=CreateCameraSetup()
call CameraSetupSetField(OEI,CAMERA_FIELD_ZOFFSET,0.0,0.0)
call CameraSetupSetField(OEI,CAMERA_FIELD_ROTATION,90.0,0.0)
call CameraSetupSetField(OEI,CAMERA_FIELD_ANGLE_OF_ATTACK,304.0,0.0)
call CameraSetupSetField(OEI,CAMERA_FIELD_TARGET_DISTANCE,2500.0,0.0)
call CameraSetupSetField(OEI,CAMERA_FIELD_ROLL,0.0,0.0)
call CameraSetupSetField(OEI,CAMERA_FIELD_FIELD_OF_VIEW,70.0,0.0)
call CameraSetupSetField(OEI,CAMERA_FIELD_FARZ,16000.0,0.0)
call CameraSetupSetDestPosition(OEI,0.0,0.0,0.0)
call TriggerRegisterTimerEvent(t,180,true)
call TriggerRegisterTimerEvent(t,0.1,false)
call TriggerAddCondition(t,Condition(function SB2))
set t=null
endfunction
function SC2 takes nothing returns boolean
return IsPlayerTeam1(GetOwningPlayer(GetFilterUnit()))and RRI(GetFilterUnit())==true and GetUnitTypeId(GetFilterUnit())!='H00J'
endfunction
function SD2 takes nothing returns boolean
return IsPlayerTeam2(GetOwningPlayer(GetFilterUnit()))and RRI(GetFilterUnit())==true and GetUnitTypeId(GetFilterUnit())!='H00J'
endfunction
function SE2 takes nothing returns nothing
local unit u=GetEnumUnit()
call SetUnitState(u,UNIT_STATE_LIFE,GetUnitState(u,UNIT_STATE_LIFE)+200)
call SetUnitState(u,UNIT_STATE_MANA,GetUnitState(u,UNIT_STATE_MANA)+200)
call SetPlayerState(GetOwningPlayer(u),PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(GetOwningPlayer(u),PLAYER_STATE_RESOURCE_GOLD)+150)
call AddHeroXP(u,248,true)
set u=null
endfunction
function SF2 takes integer i,integer JF2,integer r,integer g,integer b,integer a,real x,real y,boolean SG2 returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local image SH2=(LoadImageHandle(LY,(handle_id),(476+i)))
local image SZ2=(LoadImageHandle(LY,(handle_id),(484+i)))
if SH2!=null then
call DestroyImage(SH2)
call SaveImageHandle(LY,(handle_id),(476+i),(null))
set SH2=null
endif
if SZ2!=null then
call DestroyImage(SZ2)
call SaveImageHandle(LY,(handle_id),(484+i),(null))
set SZ2=null
endif
if SG2==false or JF2<1 then
return
endif
if StringLength(I2S(JF2))>1 then
call JD2("Fonts\\"+SubString(I2S(JF2),0,1)+".blp",120,120,x-30,y,0,true)
call SetImageColor(MK,r,g,b,a)
set SH2=MK
call JD2("Fonts\\"+SubString(I2S(JF2),1,2)+".blp",120,120,x+30,y,0,true)
call SetImageColor(MK,r,g,b,a)
set SZ2=MK
else
call JD2("Fonts\\0.blp",120,120,x-30,y,0,true)
call SetImageColor(MK,r,g,b,a)
set SH2=MK
call JD2("Fonts\\"+SubString(I2S(JF2),0,1)+".blp",120,120,x+30,y,0,true)
call SetImageColor(MK,r,g,b,a)
set SZ2=MK
endif
call SaveImageHandle(LY,(handle_id),(476+i),(SH2))
call SaveImageHandle(LY,(handle_id),(484+i),(SZ2))
set SH2=null
set SZ2=null
endfunction
function SV2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group SW2=NTI()
local group SX2=NTI()
local integer SY2
local integer SJ2
local real x
local real y
local rect r
local player SK2
local player SL2
local integer i=0
local integer Q4I
local unit CP
local real Z7O
local real SOI=(TimerGetElapsed(M))
loop
exitwhen i>5
set r=(LoadRectHandle(LY,(handle_id),(460+i)))
set Q4I=(LoadInteger(LY,(handle_id),(492+i)))
set CP=(LoadUnitHandle(LY,(handle_id),(452+i)))
set SK2=GetOwningPlayer(CP)
set SL2=(LoadPlayerHandle(LY,(handle_id),(468+i)))
set x=GetRectCenterX(r)
set y=GetRectCenterY(r)
call GroupEnumUnitsInRect(SW2,r,Condition(function SC2))
call GroupEnumUnitsInRect(SX2,r,Condition(function SD2))
set SY2=CountUnitsInGroup(SW2)
set SJ2=CountUnitsInGroup(SX2)
if(SY2>0 and SJ2>0)or(SY2==0 and SJ2==0)then
if SK2==EO then
set SL2=EO
call SavePlayerHandle(LY,(handle_id),(468+i),(SL2))
endif
set Q4I=61
call SaveInteger(LY,(handle_id),(492+i),(Q4I))
elseif SY2>0 and SJ2==0 then
set SL2=BO[1]
call SavePlayerHandle(LY,(handle_id),(468+i),(SL2))
set Q4I=Q4I-SY2
call SaveInteger(LY,(handle_id),(492+i),(Q4I))
elseif SJ2>0 and SY2==0 then
set SL2=CO[1]
call SavePlayerHandle(LY,(handle_id),(468+i),(SL2))
set Q4I=Q4I-SJ2
call SaveInteger(LY,(handle_id),(492+i),(Q4I))
endif
if SL2==EO and SK2!=EO then
call SetUnitColor(CP,GetPlayerColor(SL2))
call SetUnitOwner(CP,SL2,false)
call SF2(i,Q4I,255,0,0,255,x,y,false)
elseif SL2==SK2 then
call SF2(i,Q4I,255,0,0,255,x,y,false)
set Q4I=61
call SaveInteger(LY,(handle_id),(492+i),(Q4I))
elseif SL2!=EO then
if Q4I<61 then
call SF2(i,Q4I,255,0,0,255,x,y,true)
else
call SF2(i,Q4I,255,0,0,255,x,y,false)
endif
if Q4I<1 then
call PingMinimapEx(x,y,2,255,255,255,false)
call PHI(SL2,"Sound\\Interface\\Rescue.wav")
call SetUnitOwner(CP,SL2,false)
set Q4I=61
call SaveInteger(LY,(handle_id),(492+i),(Q4I))
call SaveReal(LY,(handle_id),(500+i),((SOI)*1.0))
if IsPlayerTeam1(SL2)then
call SetUnitColor(CP,GetPlayerColor(BO[0]))
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"|c00ff0303The Sentinel now controls a Capture Point.|r")
call ForGroup(SW2,function SE2)
else
call SetUnitColor(CP,GetPlayerColor(CO[0]))
call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,"|c00ff0303The Scourge now controls a Capture Point.|r")
call ForGroup(SX2,function SE2)
endif
endif
endif
set i=i+1
endloop
call NSI(SW2)
call NSI(SX2)
set SW2=null
set SX2=null
return false
endfunction
function SM2 takes nothing returns boolean
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local fogmodifier I31
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function SV2))
call PingMinimapEx(GetRectCenterX(KB),GetRectCenterY(KB),4,255,255,255,false)
call PingMinimapEx(GetRectCenterX(MB),GetRectCenterY(MB),4,255,255,255,false)
call PingMinimapEx(GetRectCenterX(TB),GetRectCenterY(TB),4,255,255,255,false)
call PingMinimapEx(GetRectCenterX(LB),GetRectCenterY(LB),4,255,255,255,false)
call PingMinimapEx(GetRectCenterX(SB),GetRectCenterY(SB),4,255,255,255,false)
call PingMinimapEx(GetRectCenterX(RB),GetRectCenterY(RB),4,255,255,255,false)
set OGI=CreateUnit(EO,'ncp2',GetRectCenterX(KB),GetRectCenterY(KB),0)
set OHI=CreateUnit(EO,'ncp2',GetRectCenterX(MB),GetRectCenterY(MB),0)
set OZI=CreateUnit(EO,'ncp2',GetRectCenterX(TB),GetRectCenterY(TB),0)
set OVI=CreateUnit(EO,'ncp2',GetRectCenterX(LB),GetRectCenterY(LB),0)
set OWI=CreateUnit(EO,'ncp2',GetRectCenterX(SB),GetRectCenterY(SB),0)
set OXI=CreateUnit(EO,'ncp2',GetRectCenterX(RB),GetRectCenterY(RB),0)
set I31=CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(KB),GetRectCenterY(KB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(KB),GetRectCenterY(KB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(MB),GetRectCenterY(MB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(MB),GetRectCenterY(MB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(TB),GetRectCenterY(TB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(TB),GetRectCenterY(TB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(LB),GetRectCenterY(LB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(LB),GetRectCenterY(LB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(SB),GetRectCenterY(SB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(SB),GetRectCenterY(SB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(BO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(RB),GetRectCenterY(RB),600,true,true)
call FogModifierStart(I31)
set I31=CreateFogModifierRadius(CO[1],FOG_OF_WAR_VISIBLE,GetRectCenterX(RB),GetRectCenterY(RB),600,true,true)
call FogModifierStart(I31)
call UVI("Speed",OGI,255,233,12)
call UVI("Speed",OVI,255,233,12)
call UVI("Combat",OHI,255,233,12)
call UVI("Combat",OWI,255,233,12)
call UVI("Regen",OZI,255,233,12)
call UVI("Regen",OXI,255,233,12)
call UnitAddAbility(OGI,'S00O')
call UnitAddAbility(OVI,'S00R')
call UnitAddAbility(OHI,'A1PO')
call UnitAddAbility(OHI,'A1PL')
call UnitAddAbility(OWI,'A1PN')
call UnitAddAbility(OWI,'A1PJ')
call UnitAddAbility(OZI,'A1PV')
call UnitAddAbility(OZI,'A1PF')
call UnitAddAbility(OXI,'A1PD')
call UnitAddAbility(OXI,'A1PE')
set OYI=61
set OJI=61
set OKI=61
set OLI=61
set OMI=61
set ONI=61
call SaveUnitHandle(LY,(handle_id),(452),(OGI))
call SaveUnitHandle(LY,(handle_id),(453),(OHI))
call SaveUnitHandle(LY,(handle_id),(454),(OZI))
call SaveUnitHandle(LY,(handle_id),(455),(OVI))
call SaveUnitHandle(LY,(handle_id),(456),(OWI))
call SaveUnitHandle(LY,(handle_id),(457),(OXI))
call SaveReal(LY,(handle_id),(500),((-1)*1.0))
call SaveReal(LY,(handle_id),(501),((-1)*1.0))
call SaveReal(LY,(handle_id),(502),((-1)*1.0))
call SaveReal(LY,(handle_id),(503),((-1)*1.0))
call SaveReal(LY,(handle_id),(504),((-1)*1.0))
call SaveReal(LY,(handle_id),(505),((-1)*1.0))
call SaveRectHandle(LY,(handle_id),(460),(KB))
call SaveRectHandle(LY,(handle_id),(461),(MB))
call SaveRectHandle(LY,(handle_id),(462),(TB))
call SaveRectHandle(LY,(handle_id),(463),(LB))
call SaveRectHandle(LY,(handle_id),(464),(SB))
call SaveRectHandle(LY,(handle_id),(465),(RB))
call SavePlayerHandle(LY,(handle_id),(468),(EO))
call SavePlayerHandle(LY,(handle_id),(469),(EO))
call SavePlayerHandle(LY,(handle_id),(470),(EO))
call SavePlayerHandle(LY,(handle_id),(471),(EO))
call SavePlayerHandle(LY,(handle_id),(472),(EO))
call SavePlayerHandle(LY,(handle_id),(473),(EO))
call SaveInteger(LY,(handle_id),(492),(61))
call SaveInteger(LY,(handle_id),(493),(61))
call SaveInteger(LY,(handle_id),(494),(61))
call SaveInteger(LY,(handle_id),(495),(61))
call SaveInteger(LY,(handle_id),(496),(61))
call SaveInteger(LY,(handle_id),(497),(61))
call SaveImageHandle(LY,(handle_id),(476),(null))
call SaveImageHandle(LY,(handle_id),(484),(null))
call SaveImageHandle(LY,(handle_id),(477),(null))
call SaveImageHandle(LY,(handle_id),(485),(null))
call SaveImageHandle(LY,(handle_id),(478),(null))
call SaveImageHandle(LY,(handle_id),(486),(null))
call SaveImageHandle(LY,(handle_id),(479),(null))
call SaveImageHandle(LY,(handle_id),(487),(null))
call SaveImageHandle(LY,(handle_id),(480),(null))
call SaveImageHandle(LY,(handle_id),(488),(null))
call SaveImageHandle(LY,(handle_id),(481),(null))
call SaveImageHandle(LY,(handle_id),(489),(null))
call FlushTrigger(GetTriggeringTrigger())
set t=null
return false
endfunction
function O02 takes nothing returns nothing
local trigger t
if OFI then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,600,false)
call TriggerAddCondition(t,Condition(function SM2))
set t=null
endif
endfunction
function XV2 takes nothing returns nothing
set OFI=true
endfunction
function SN2 takes nothing returns nothing
local integer E81=GetItemId(GetEnumItem())
if GetWidgetLife(GetEnumItem())>0 and GetItemPlayer(GetEnumItem())==A1I and E81!=VL0 and E81!=W30 and E81!=W40 and E81!=GZ0 and E81!=GV0 then
if IsItemVisible(GetEnumItem())then
call SetItemVisible(GetEnumItem(),false)
else
call SetItemVisible(GetEnumItem(),true)
endif
endif
endfunction
function SS2 takes nothing returns nothing
local player p=A1I
local region r=CreateRegion()
local unit u=GetEnumUnit()
local integer E81
local integer i=0
local item BA1
local integer id
local real x
local real y
if IsPlayerTeam1(p)then
call RegionAddRect(r,G5)
set x=GetRectCenterX(G5)
set y=GetRectCenterY(G5)
else
call RegionAddRect(r,H5)
set x=GetRectCenterX(H5)
set y=GetRectCenterY(H5)
endif
loop
exitwhen i>5
set BA1=UnitItemInSlot(u,i)
set E81=GetItemId(BA1)
if GetItemPlayer(BA1)==A1I and E81!=VL0 and E81!=W30 and E81!=W40 and E81!=GZ0 and E81!=GV0 then
call UnitRemoveItemFromSlot(u,i)
set id=GetPlayerId(GetItemPlayer(BA1))
call SetItemPosition(BA1,x,y)
endif
set i=i+1
endloop
call RemoveRegion(r)
set u=null
set r=null
endfunction
function ST2 takes nothing returns boolean
return(GetUnitTypeId(GetFilterUnit())=='ncop' or RYI(GetFilterUnit())or(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and GetOwningPlayer(GetFilterUnit())!=A1I and GetOwningPlayer(GetFilterUnit())!=BO[0]and GetOwningPlayer(GetFilterUnit())!=CO[0]))and IsUnitAlly(GetFilterUnit(),A1I)==true
endfunction
function SR2 takes player p returns nothing
local integer i=0
local item BA1
local integer id=GetPlayerId(p)
local group g=NTI()
set A1I=p
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function ST2))
call ForGroup(g,function SS2)
call NSI(g)
endfunction
function SP2 takes player p returns nothing
set A1I=p
call EnumItemsInRectBJ(bj_mapInitialPlayableArea,function SN2)
endfunction
function SQ2 takes unit u returns nothing
local unit AD1=u
local player I6O=GetOwningPlayer(u)
local location I2O
if IsPlayerTeam2(I6O)then
set I2O=GetRectCenter(S3)
else
set I2O=GetRectCenter(O4)
endif
if Q2==false and IsUnitDead(AD1)then
call VQ1(AD1,I6O,GetLocationX(I2O),GetLocationY(I2O),true)
if I0O(AD1)==false or GetUnitAbilityLevel(AD1,'A0MW')==0 then
call ReviveHeroLoc(AD1,I2O,true)
else
call IOO(AD1,I2O)
endif
endif
call RemoveLocation(I2O)
set AD1=null
set I6O=null
set I2O=null
endfunction
function SU2 takes unit T02,unit TI2 returns nothing
local player p=GetOwningPlayer(TI2)
local integer id=GetPlayerId(p)
call SetHeroXP(TI2,GetHeroXP(T02),true)
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,(LoadInteger(LY,(GetHandleId(TI2)),(787)))+OUI[id])
set OQI[id]=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
set OUI[id]=0
endfunction
function T12 takes integer id,unit R5I returns boolean
return SGI(DC0[id])!=SEI(R5I)
endfunction
function TO2 takes unit u returns integer
return 255
endfunction
function T22 takes unit u returns integer
return 255
endfunction
function T32 takes unit u returns integer
return 255
endfunction
function T42 takes unit u,integer id,player p returns nothing
local player p1=GetOwningPlayer(u)
local player p2
local integer i
local item FH1
if IsPlayerTeam1(GetOwningPlayer(u))then
set p2=BO[0]
else
set p2=CO[0]
endif
call SaveInteger(LY,(GetHandleId(u)),(787),(GetPlayerState(GetOwningPlayer(u),PLAYER_STATE_RESOURCE_GOLD)))
call SaveBoolean(LY,(GetHandleId(u)),(140),(false))
call SaveInteger(LY,(GetHandleId((u))),((4259)),(1))
call UnitAddAbility(u,'A04R')
call BK1(u,true)
call PauseUnit(u,true)
call SetUnitVertexColor(u,TO2(u),T22(u),T32(u),150)
call SelectUnitRemoveForPlayer(u,GetOwningPlayer(u))
call SetUnitOwner(u,p2,false)
call SetUnitPathing(u,false)
call MUSetUnitX(u,GetUnitX(D30[id]))
call MUSetUnitY(u,GetUnitY(D30[id]))
set i=0
loop
exitwhen i>5
if UnitItemInSlot(u,i)==null then
set FH1=CreateItem('I02M',GetUnitX(u),GetUnitY(u))
call UnitAddItem(u,FH1)
endif
set i=i+1
endloop
set p1=null
set p2=null
endfunction
function T52 takes unit u,integer id,player p returns nothing
local integer i
set K1[id]=u
call SaveBoolean(LY,(GetHandleId(u)),(140),(false))
call SaveInteger(LY,(GetHandleId((u))),((4259)),(2))
call UnitRemoveAbility(u,'A04R')
call BK1(u,false)
call PauseUnit(u,false)
call SetUnitVertexColor(u,TO2(u),T22(u),T32(u),255)
call SelectUnitAddForPlayer(u,GetOwningPlayer(u))
call SetUnitOwner(u,p,false)
call SetUnitPathing(u,true)
if IsPlayerTeam1(Player(id))==true then
call SetUnitPosition(u,GetRectCenterX(O4),GetRectCenterY(O4))
else
call SetUnitPosition(u,GetRectCenterX(S3),GetRectCenterY(S3))
endif
set i=0
loop
exitwhen i>5
if GetItemTypeId(UnitItemInSlot(u,i))=='I02M' then
call EL1(UnitItemInSlot(u,i))
endif
set i=i+1
endloop
endfunction
function T62 takes integer id returns boolean
local region r=CreateRegion()
local boolean FB1=false
if IsPlayerTeam1(Player(id))==true then
call RegionAddRect(r,F4)
else
call RegionAddRect(r,E4)
endif
if IsUnitInRegion(r,ORI[id])and IsUnitInRegion(r,OPI[id])then
set FB1=true
endif
call RemoveRegion(r)
return FB1 or IsUnitDead(ORI[id])or IsUnitDead(OPI[id])
endfunction
function T72 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer id=(LoadInteger(LY,(handle_id),(34)))
local integer T82=GetTriggerEvalCount(t)
local player p=Player(id)
if T82==1 then
call SR2(p)
elseif T82==2 then
call SP2(p)
elseif T82==3 then
if K1[id]==ORI[id]then
call SQ2(ORI[id])
call T42(ORI[id],id,p)
call T52(OPI[id],id,p)
call SU2(ORI[id],OPI[id])
else
call SQ2(OPI[id])
call T42(OPI[id],id,p)
call T52(ORI[id],id,p)
call SU2(OPI[id],ORI[id])
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
return false
endfunction
function T92 takes nothing returns boolean
local integer id=GetPlayerId(GetTriggerPlayer())
local real SOI=(TimerGetElapsed(M))
local trigger t
local integer handle_id
if(SOI-OTI[id])<180 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"双英雄模式冷却中"+": "+I2S(R2I(180-(SOI-OTI[id]))))
elseif T62(id)==false then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10,"你的英雄必须位于泉水区域")
else
set OTI[id]=SOI
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function T72))
call SaveInteger(LY,(handle_id),(34),(id))
set t=null
endif
return false
endfunction
function TA2 takes nothing returns boolean
local integer i=1
local integer id
local integer TB2
local integer ADO
local player p
loop
exitwhen i>5
set p=BO[i]
set id=GetPlayerId(p)
set ADO=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
if OQI[id]<ADO and AII[id]==false then
set OUI[id]=OUI[id]+ADO-OQI[id]
endif
set OQI[id]=ADO
if AII[id]==true then
set AII[id]=false
endif
set p=CO[i]
set id=GetPlayerId(p)
set ADO=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
if OQI[id]<ADO and AII[id]==false then
set OUI[id]=OUI[id]+ADO-OQI[id]
endif
set OQI[id]=ADO
if AII[id]==true then
set AII[id]=false
endif
set i=i+1
endloop
return false
endfunction
function TC2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer O91=(LoadInteger(LY,(handle_id),(55)))
local player p
local integer TJI
local location ZC1=GetRectCenter(O4)
local location ZD1=GetRectCenter(S3)
local integer id
if O91<6 then
set p=BO[O91]
set id=GetPlayerId(p)
elseif O91<11 then
set p=CO[O91-5]
set id=GetPlayerId(p)
endif
if O91>10 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call TriggerRegisterTimerEvent(A0I,0.1,true)
call TriggerAddCondition(A0I,Condition(function TA2))
elseif O91<6 then
call SaveInteger(LY,(handle_id),(55),(O91+1))
set K1[GetPlayerId(p)]=null
if T3I(p)then
loop
exitwhen K1[GetPlayerId(p)]!=null
set TJI=TYI()
if R[TJI]==false then
if not F2 then
set R[TJI]=true
endif
set K1[id]=CreateUnitAtLoc(p,DC0[TJI],ZC1,bj_UNIT_FACING)
set ORI[id]=K1[id]
call T42(K1[id],id,p)
endif
endloop
endif
elseif O91<11 then
call SaveInteger(LY,(handle_id),(55),(O91+1))
set K1[GetPlayerId(p)]=null
if T3I(p)then
loop
exitwhen K1[id]!=null
set TJI=TYI()
if R[TJI]==false then
if not F2 then
set R[TJI]=true
endif
set K1[id]=CreateUnitAtLoc(p,DC0[TJI],ZD1,bj_UNIT_FACING)
set ORI[id]=K1[id]
call T42(K1[id],id,p)
endif
endloop
endif
endif
if O91<6 then
set p=BO[O91]
elseif O91<11 then
set p=CO[O91-5]
endif
if O91<6 then
call SaveInteger(LY,(handle_id),(55),(O91+1))
set K1[GetPlayerId(p)]=null
if T3I(p)then
loop
exitwhen K1[id]!=null
set TJI=TYI()
if R[TJI]==false and T12(TJI,ORI[id])then
if not F2 then
set R[TJI]=true
endif
set K1[id]=CreateUnitAtLoc(p,DC0[TJI],ZC1,bj_UNIT_FACING)
set OPI[id]=K1[id]
set OQI[id]=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
call T52(K1[id],id,p)
call SaveUnitHandle(LY,(GetHandleId(OPI[id])),(788),(ORI[id]))
call SaveUnitHandle(LY,(GetHandleId(ORI[id])),(788),(OPI[id]))
endif
endloop
endif
elseif O91<11 then
call SaveInteger(LY,(handle_id),(55),(O91+1))
set K1[id]=null
if T3I(p)then
loop
exitwhen K1[id]!=null
set TJI=TYI()
if R[TJI]==false and T12(TJI,ORI[id])then
if not F2 then
set R[TJI]=true
endif
set K1[id]=CreateUnitAtLoc(p,DC0[TJI],ZD1,bj_UNIT_FACING)
set OPI[id]=K1[id]
set OQI[id]=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
call T52(K1[id],id,p)
call SaveUnitHandle(LY,(GetHandleId(OPI[id])),(788),(ORI[id]))
call SaveUnitHandle(LY,(GetHandleId(ORI[id])),(788),(OPI[id]))
endif
endloop
endif
endif
call RemoveLocation(ZC1)
call RemoveLocation(ZD1)
set ZC1=null
set ZD1=null
set p=null
set t=null
return false
endfunction
function XW2 takes nothing returns nothing
local integer i=1
local integer id
local real SOI=(TimerGetElapsed(M))
local trigger t
set OSI=true
set A3=false
set GL=false
call TCI('H00I')
call TCI('O00P')
call TCI('H00U')
loop
exitwhen i>5
set id=GetPlayerId(BO[i])
set AII[id]=false
set OTI[id]=SOI-180
set OUI[id]=0
set id=GetPlayerId(CO[i])
set AII[id]=false
set OTI[id]=SOI-180
set OUI[id]=0
set i=i+1
endloop
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,.5,true)
call TriggerAddCondition(t,Condition(function TC2))
call SaveInteger(LY,(GetHandleId(t)),(55),(1))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-tt",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-tt",true)
call TriggerAddCondition(t,Condition(function T92))
set t=null
endfunction
function TD2 takes nothing returns nothing
set Q[1]=0
endfunction
function TF2 takes nothing returns nothing
set Q[2]=0
endfunction
function TH2 takes nothing returns nothing
set Q[3]=0
endfunction
function TV2 takes nothing returns nothing
set Q[4]=0
endfunction
function TX2 takes nothing returns nothing
set Q[5]=0
endfunction
function TJ2 takes nothing returns nothing
set Q[7]=0
endfunction
function TL2 takes nothing returns nothing
set Q[8]=0
endfunction
function TN2 takes nothing returns nothing
set Q[9]=0
endfunction
function TT2 takes nothing returns nothing
set Q[10]=0
endfunction
function TP2 takes nothing returns nothing
set Q[11]=0
endfunction
function TU2 takes nothing returns nothing
local integer i=1
local string id
local player p
loop
exitwhen i>5
set p=BO[i]
set id=I2S(GetPlayerId(p))
call StoreInteger(OS,id,"id",i)
set p=CO[i]
set id=I2S(GetPlayerId(p))
call StoreInteger(OS,id,"id",i+5)
if GetLocalPlayer()==WO then
call SyncStoredInteger(OS,I2S(GetPlayerId(BO[i])),"id")
call SyncStoredInteger(OS,I2S(GetPlayerId(CO[i])),"id")
endif
set i=i+1
endloop
endfunction
function R02 takes nothing returns boolean
if J2 then
call TVI()
call QRI(bj_FORCE_ALL_PLAYERS,20.00,C0[GetPlayerId(WO)]+(D80[GetPlayerId((WO))])+"|r"+" "+"默认选择了常规模式，在选择英雄后，系统会返还给你175金钱")
call QRI(bj_FORCE_ALL_PLAYERS,20.00," ")
set AL=true
call VU2()
call HJ2()
call P7O()
call UHO()
call UR1()
endif
call TU2()
call FlushTrigger(GetTriggeringTrigger())
return false
endfunction
function RI2 takes nothing returns boolean
set B0=true
call FlushTrigger(GetTriggeringTrigger())
return false
endfunction
function RO2 takes nothing returns nothing
set O0=true
endfunction
function R32 takes nothing returns nothing
set UO=true
endfunction
function R52 takes nothing returns nothing
set H3=true
endfunction
function R72 takes nothing returns boolean
if IsUnitIllusion(GetFilterUnit())==true and GetOwningPlayer(GetFilterUnit())!=GetOwningPlayer(GK)then
call SetUnitOwner(GetFilterUnit(),GetOwningPlayer(GK),true)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Charm\\CharmTarget.mdl",GetFilterUnit(),"origin"))
endif
return false
endfunction
function R82 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local item BA1=(LoadItemHandle(LY,(handle_id),(96)))
local group g
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
if GetTriggerEventId()==EVENT_UNIT_DROP_ITEM and GetManipulatedItem()==BA1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_DROP_ITEM then
if IsUnitDead(SFI)==false then
set g=NTI()
set GK=SFI
call GroupEnumUnitsInRange(g,x,y,1000,Condition(function R72))
call NSI(g)
set g=null
endif
endif
set t=null
set SFI=null
set BA1=null
return false
endfunction
function R92 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function R82))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveItemHandle(LY,(handle_id),(96),(GetManipulatedItem()))
set t=null
set SFI=null
endfunction
function GenuineMKB_Main takes nothing returns boolean
if GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and F01(GetManipulatedItem())==XZ0 then
call R92()
endif
return false
endfunction
function RA2 takes string s returns nothing
call QRI(bj_FORCE_ALL_PLAYERS,20.00,"|c00CC0000"+"孙悟空"+": |r|c006699CC"+s+"|r")
call StartSound(XF)
endfunction
function RB2 takes nothing returns nothing
call RA2("这是什么花招？？好吧，你赢了，给你货真价实的金箍棒")
call CreateItem(FT0[XZ0],GetUnitX(A8I),GetUnitY(A8I))
call ReviveHero(A8I,GetUnitX(A8I),GetUnitY(A8I),false)
call RemoveUnit(A8I)
endfunction
function RC2 takes nothing returns nothing
call RA2("真是逗！你可以把你的山寨金箍棒拿走了，蟠桃已经被我吃了")
call SetItemVisible(A4I,true)
call SetItemPosition(A4I,GetUnitX(A8I),GetUnitY(A8I))
call RemoveUnit(A8I)
endfunction
function RD2 takes nothing returns boolean
local item i=ES1(GetFilterUnit(),FR0[W60])
if i!=null then
call RemoveItem(i)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",GetFilterUnit(),"chest"))
endif
set i=null
return false
endfunction
function RE2 takes nothing returns boolean
if IsUnitIllusion(GetFilterUnit())==true and GetOwningPlayer(GetFilterUnit())!=GetOwningPlayer(A8I)then
call SetUnitOwner(GetFilterUnit(),GetOwningPlayer(A8I),true)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Charm\\CharmTarget.mdl",GetFilterUnit(),"origin"))
endif
return false
endfunction
function RF2 takes nothing returns nothing
local unit hero=GetEnumUnit()
local integer x=0
local item i
if IsUnitIllusion(hero)==true then
return
endif
loop
exitwhen x>5
set i=UnitItemInSlot(hero,x)
call UnitRemoveItem(hero,i)
set x=x+1
endloop
set hero=null
endfunction
function RG2 takes nothing returns nothing
local unit hero=GetEnumUnit()
local integer x=0
local unit dummy
if IsUnitIllusion(hero)==true then
return
endif
set dummy=CreateUnit(GetOwningPlayer(A8I),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A2VY')
call IssueTargetOrder(dummy,"ensnare",hero)
set hero=null
set dummy=null
endfunction
function RH2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetUnitX(A8I)
local real y=GetUnitY(A8I)
local group g
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
call RB2()
return false
elseif GetTriggerEvalCount(t)>12000 or(AOI and GetTriggerEvalCount(t)>600)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
if AOI then
call RB2()
else
call RC2()
endif
return false
endif
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,1000,Condition(function RE2))
call NSI(g)
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,1000,Condition(function RD2))
call NSI(g)
if ModuloInteger(GetTriggerEvalCount(t),200)==0 then
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,1000,Condition(function D51))
call ForGroup(g,function RF2)
call NSI(g)
endif
if ModuloInteger(GetTriggerEvalCount(t),300)==0 then
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,1000,Condition(function D51))
call ForGroup(g,function RG2)
call NSI(g)
endif
set g=null
set t=null
return false
endfunction
function RZ2 takes nothing returns boolean
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitInvulnerable(A8I,false)
call UnitRemoveAbility(A8I,'Abun')
call RA2("我给你20分钟时间，看看你能不能找到打败我的办法")
set A3I=true
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterDeathEvent(t,A8I)
call TriggerAddCondition(t,Condition(function RH2))
set t=null
return false
endfunction
function RV2 takes nothing returns nothing
local trigger t=CreateTrigger()
call RA2("聪明！")
call SetUnitInvulnerable(A8I,true)
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function RZ2))
set t=null
endfunction
function RW2 takes nothing returns nothing
call RA2("错了！你得专心点")
if AOI then
call RV2()
else
call RemoveUnit(A8I)
endif
endfunction
function RX2 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(A8I),GetUnitY(A8I),1000,Condition(function D51))
set ACI=GroupPickRandomUnit(g)
call NSI(g)
set g=null
endfunction
function RY2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x0
local real y0
local real x1
local real y1
local real x2
local real y2
local real x3
local real y3
local integer r=GetRandomInt(0,2)
if GetTriggerEvalCount(t)==1 then
call RX2()
if ACI==null then
call RemoveUnit(A8I)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endif
call RA2("你能找到我的真身吗？")
call SaveEffectHandle(LY,(GetHandleId(t)),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\InnerFire\\InnerFireTarget.mdl",ACI,"overhead")))
if r==0 then
set x0=AFI
set y0=AGI
set x1=AHI
set y1=AZI
set x2=AVI
set y2=AWI
set x3=AXI
set y3=AYI
elseif r==1 then
set x0=AVI
set y0=AWI
set x1=AFI
set y1=AGI
set x2=AHI
set y2=AZI
set x3=AXI
set y3=AYI
elseif r==2 then
set x0=AHI
set y0=AZI
set x1=AXI
set y1=AYI
set x2=AVI
set y2=AWI
set x3=AFI
set y3=AGI
endif
call ClearSelection()
call SetUnitPosition(A8I,x0,y0)
set A9I=CreateUnit(GetOwningPlayer(A8I),'H0ES',x1,y1,GetUnitFacing(A8I))
set AAI=CreateUnit(GetOwningPlayer(A8I),'H0ES',x2,y2,GetUnitFacing(A8I))
set ABI=CreateUnit(GetOwningPlayer(A8I),'H0ES',x3,y3,GetUnitFacing(A8I))
call IssueImmediateOrder(ACI,"holdposition")
call SetUnitVertexColor(A9I,220,255,255,255)
call SetUnitVertexColor(AAI,220,255,255,255)
call SetUnitVertexColor(ABI,220,255,255,255)
call TriggerRegisterUnitEvent(t,A8I,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,A9I,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,AAI,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,ABI,EVENT_UNIT_DAMAGED)
call PauseUnit(A8I,true)
call SetUnitInvulnerable(A8I,false)
call PauseUnit(A9I,true)
call PauseUnit(AAI,true)
call PauseUnit(ABI,true)
call SetHeroLevel(A9I,25,false)
call SetHeroLevel(AAI,25,false)
call SetHeroLevel(ABI,25,false)
if AOI then
call SetUnitVertexColor(A8I,0,255,255,255)
endif
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetEventDamage()>0 and GetEventDamageSource()==ACI then
call PauseUnit(A8I,false)
call PauseUnit(A9I,false)
call PauseUnit(AAI,false)
call PauseUnit(ABI,false)
call RemoveUnit(A9I)
call RemoveUnit(AAI)
call RemoveUnit(ABI)
if GetTriggerUnit()==A8I then
call RV2()
else
call RW2()
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function RJ2 takes nothing returns nothing
local trigger t=CreateTrigger()
call RA2("你耍了个花招，干得不错！")
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function RY2))
set t=null
endfunction
function RK2 takes nothing returns nothing
call RA2("太慢了！")
if AOI then
call RJ2()
else
call RemoveUnit(A8I)
endif
endfunction
function RL2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local real x0=2897
local real y0=-2814
local real x1=GetUnitX(A8I)
local real y1=GetUnitY(A8I)
local real RM2
local real RN2
local real RS2
local real RT2
local real IV1
local real IW1
local location point
local real d=QNI(ADI,AEI,2897,-2814)
local real r=d/200
local real RR2=0.1
if QNI(GetUnitX(ACI),GetUnitY(ACI),2897,-2814)<100 then
call RJ2()
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call SetUnitAnimationByIndex(A8I,0)
call SetUnitFlyHeight(A8I,GetUnitDefaultFlyHeight(A8I),0)
call SetUnitPosition(A8I,2897,-2814)
call PauseUnit(A8I,false)
call SetUnitPathing(A8I,true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endif
set RM2=UEI(x1,y1,x0,y0)
set RT2=(NPI-100)*(NPI-100)*RR2
set IV1=x1+r*Cos(RM2*bj_DEGTORAD)
set IW1=y1+r*Sin(RM2*bj_DEGTORAD)
if NPI<201 then
call SetUnitFlyHeight(A8I,10000*RR2-RT2,0)
call SetUnitPosition(A8I,IV1,IW1)
else
call SetUnitFlyHeight(A8I,GetUnitDefaultFlyHeight(A8I),0)
call PauseUnit(A8I,false)
call SetUnitPathing(A8I,true)
set point=Location(IV1,IW1)
call TerrainDeformationRippleBJ(0.2,true,point,1.00,300.00,96.00,1,64.00)
call RemoveLocation(point)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl",GetUnitX(A8I),GetUnitY(A8I)))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call SetUnitAnimationByIndex(A8I,0)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call RK2()
endif
set t=null
return false
endfunction
function RP2 takes effect RQ2,effect RU2 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy
call SetUnitPosition(A8I,ADI,AEI)
set dummy=CreateUnit(GetOwningPlayer(A8I),'e00E',GetUnitX(A8I),GetUnitY(A8I),0)
call SetUnitPosition(ACI,GetUnitX(A8I)+50,GetUnitY(A8I)+50)
call PauseUnit(A8I,false)
call PauseUnit(ACI,false)
call AddSkill(A8I,'Amrf')
call UnitRemoveAbility(A8I,'Amrf')
call AddSkill(dummy,'A2VY')
call IssueTargetOrder(dummy,"ensnare",ACI)
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function RL2))
call SaveEffectHandle(LY,(handle_id),(175),(RQ2))
call SaveEffectHandle(LY,(handle_id),(176),(RU2))
set t=null
set dummy=null
endfunction
function P02 takes nothing returns nothing
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(A8I),GetUnitY(A8I),1800,Condition(function D51))
set ACI=GroupPickRandomUnit(g)
call NSI(g)
set g=null
endfunction
function PI2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
if GetTriggerEvalCount(t)==1 then
call P02()
if ACI==null then
call RemoveUnit(A8I)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endif
call RA2("和我比赛看谁先跑到河道另一边，5秒后开始！")
call TriggerRegisterTimerEvent(t,1,true)
call SaveEffectHandle(LY,(GetHandleId(t)),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\InnerFire\\InnerFireTarget.mdl",ACI,"overhead")))
call SaveEffectHandle(LY,(GetHandleId(t)),(176),(AddSpecialEffect("Objects\\InventoryItems\\BattleStandard\\BattleStandard.mdl",2897,-2814)))
call PingMinimap(2897,-2814,5)
call SetUnitPosition(A8I,ADI,AEI)
call SetUnitPosition(ACI,GetUnitX(A8I)+50,GetUnitY(A8I)+50)
call PauseUnit(A8I,true)
call SetUnitAnimationByIndex(A8I,7)
call SetUnitPathing(A8I,false)
call PauseUnit(ACI,true)
else
call RA2(I2S(6-GetTriggerEvalCount(t)))
if GetTriggerEvalCount(t)==6 then
call RP2((LoadEffectHandle(LY,(handle_id),(175))),(LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
return false
endfunction
function P12 takes nothing returns boolean
if A3I==false then
call SetUnitState(A8I,UNIT_STATE_LIFE,GetUnitState(A8I,UNIT_STATE_MAX_LIFE))
call SetUnitState(A8I,UNIT_STATE_MANA,GetUnitState(A8I,UNIT_STATE_MAX_MANA))
endif
return false
endfunction
function PO2 takes nothing returns nothing
local trigger t
if A2I==false or AOI then
set t=CreateTrigger()
set A8I=CreateUnit(DO,'H0ES',ADI,AEI,0)
call AddSkill(A8I,'Abun')
call PauseUnit(A8I,true)
call SetUnitInvulnerable(A8I,true)
call SetHeroLevel(A8I,25,false)
call PingMinimap(ADI,AEI,4)
call SetCameraPosition(GetUnitX(A8I),GetUnitY(A8I))
call RA2("我们来玩玩游戏吧。如果让我开心了我会给你奖励的。")
call TriggerRegisterTimerEvent(t,20,false)
call TriggerAddCondition(t,Condition(function PI2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,A8I,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerAddCondition(t,Condition(function P12))
endif
set t=null
endfunction
function P22 takes nothing returns nothing
endfunction
function P32 takes nothing returns nothing
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local location l1=Location(x-450,y-450)
local location l2=Location(x+450,y+450)
local rect r=RectFromLoc(l1,l2)
call RemoveLocation(l1)
call RemoveLocation(l2)
set A6I=false
set A7I=false
call EnumItemsInRect(r,null,function P22)
if A6I and A7I then
call SetItemVisible(A4I,false)
call RemoveItem(A5I)
call PO2()
endif
set l1=null
set l2=null
set r=null
endfunction
function Torrent_Damage takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function P52 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RT2
local unit dummy
set RT2=0.6*(NPI-25)*(NPI-25)
if NPI<51 and GetTriggerEventId()!=EVENT_UNIT_DEATH then
if ModuloInteger(NPI,5)==0 then
call Damage(hero,target,1,3+3*level)
endif
if RNI(target)==false then
call SetUnitFlyHeight(target,500-RT2,0)
endif
else
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A11L')
call SetUnitAbilityLevel(dummy,'A11L',level)
call IssueTargetOrder(dummy,"slow",target)
if RNI(target)==false then
call SetUnitFlyHeight(target,GetUnitDefaultFlyHeight(target),0)
endif
if Q2==false then
call PauseUnit(target,false)
endif
call SetUnitPathing(target,true)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function P62 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GK
local unit target=GetEnumUnit()
local integer level=UJ
call PauseUnit(target,true)
call SetUnitPathing(target,false)
if RNI(target)==false then
call AddSkill(target,'Amrf')
call UnitRemoveAbility(target,'Amrf')
endif
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function P52))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveInteger(LY,(handle_id),(5),(level))
call Damage(hero,target,1,30+30*level)
set t=null
set hero=null
set target=null
endfunction
function P72 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g=NTI()
local ubersplat AR1=CreateUbersplat(x,y,"THNN",255,255,255,255,false,false)
call SetUbersplatRenderAlways(AR1,true)
call I41(GetOwningPlayer(SFI),4,x,y,400)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(178))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(179))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(180))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",x,y))
call DestroyEffect(AddSpecialEffect("effects\\TidalErruption.mdx",x,y))
set GK=SFI
set UJ=level
call GroupEnumUnitsInRange(g,x,y,225+25,Condition(function CE1))
call ForGroup(g,function P62)
call NSI(g)
set t=null
set SFI=null
return false
endfunction
function P82 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(SFI,'A136')
local string s=""
local real a
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(SFI))==true or P0I(GetLocalPlayer())then
set s="Objects\\Spawnmodels\\Other\\IllidanFootprint\\IllidanWaterSpawnFootPrint.mdl"
endif
call RemoveLocation(point)
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
set a=0
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffect(s,x+40*Cos(a/6*360*bj_DEGTORAD),y+40*Sin(a/6*360*bj_DEGTORAD))))
set a=1
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect(s,x+40*Cos(a/6*360*bj_DEGTORAD),y+40*Sin(a/6*360*bj_DEGTORAD))))
set a=2
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffect(s,x+40*Cos(a/6*360*bj_DEGTORAD),y+40*Sin(a/6*360*bj_DEGTORAD))))
set a=3
call SaveEffectHandle(LY,(handle_id),(178),(AddSpecialEffect(s,x+40*Cos(a/6*360*bj_DEGTORAD),y+40*Sin(a/6*360*bj_DEGTORAD))))
set a=4
call SaveEffectHandle(LY,(handle_id),(179),(AddSpecialEffect(s,x+40*Cos(a/6*360*bj_DEGTORAD),y+40*Sin(a/6*360*bj_DEGTORAD))))
set a=5
call SaveEffectHandle(LY,(handle_id),(180),(AddSpecialEffect(s,x+40*Cos(a/6*360*bj_DEGTORAD),y+40*Sin(a/6*360*bj_DEGTORAD))))
call TriggerRegisterTimerEvent(t,1.6,false)
call TriggerAddCondition(t,Condition(function P72))
set SFI=null
set t=null
set point=null
endfunction
function P92 takes nothing returns boolean
if GetSpellAbilityId()=='A136' then
call P82()
endif
return false
endfunction
function TG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function P92))
set t=null
endfunction
function GY2 takes nothing returns nothing
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A147',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A148',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A11U',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A149',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A147',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A148',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A11U',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A149',false)
endfunction
function PA2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and(GetEventDamage()>40 or IsUnitType(target,UNIT_TYPE_STRUCTURE)==true or GetUnitTypeId(target)=='umtw' or GetUnitTypeId(target)=='ebal')and(LoadBoolean(LY,(GetHandleId(hero)),(183)))==true then
call SaveBoolean(LY,(GetHandleId(hero)),(183),(false))
call SaveReal(LY,(GetHandleId(hero)),(184),(((TimerGetElapsed(M)))*1.0))
call UnitRemoveAbility(hero,'A11O')
call UnitRemoveAbility(hero,'A11R')
call UnitRemoveAbility(hero,'A147')
call UnitRemoveAbility(hero,'A148')
call UnitRemoveAbility(hero,'A11U')
call UnitRemoveAbility(hero,'A149')
call FlushChildHashtable(LY,(GetHandleId((LoadTriggerHandle(LY,(handle_id),(35))))))
call FlushTrigger((LoadTriggerHandle(LY,(handle_id),(35))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function PB2 takes nothing returns boolean
local trigger t
local integer handle_id
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(183),(false))
call SaveReal(LY,(GetHandleId(GetTriggerUnit())),(184),(((TimerGetElapsed(M)))*1.0))
call UnitRemoveAbility(GetTriggerUnit(),'A11O')
call UnitRemoveAbility(GetTriggerUnit(),'A11R')
call UnitRemoveAbility(GetTriggerUnit(),'A147')
call UnitRemoveAbility(GetTriggerUnit(),'A148')
call UnitRemoveAbility(GetTriggerUnit(),'A11U')
call UnitRemoveAbility(GetTriggerUnit(),'A149')
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
elseif GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(182)))then
if IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set target=GetTriggerUnit()
set hero=GetAttacker()
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function PA2))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveTriggerHandle(LY,(handle_id),(35),(GetTriggeringTrigger()))
set target=null
set hero=null
set t=null
endif
endif
return false
endfunction
function PC2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real QZI=(TimerGetElapsed(M))
local integer level=GetUnitAbilityLevel(SFI,'A13T')
local real PD2=(LoadReal(LY,(GetHandleId(SFI)),(184)))
local boolean PE2=(LoadBoolean(LY,(GetHandleId(SFI)),(183)))
if QZI-PD2>16-level*3 and PE2==false and GetUnitTypeId(SFI)=='H06S' and IsUnitDead(SFI)==false then
call SaveBoolean(LY,(GetHandleId(SFI)),(183),(true))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function PB2))
call SaveUnitHandle(LY,(handle_id),(182),(SFI))
call AddSkill(SFI,'A11O')
call SetUnitAbilityLevel(SFI,'A11O',level)
call AddSkill(SFI,'A11R')
if level==1 then
call AddSkill(SFI,'A147')
elseif level==2 then
call AddSkill(SFI,'A148')
elseif level==3 then
call AddSkill(SFI,'A11U')
elseif level==4 then
call AddSkill(SFI,'A149')
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A147',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A148',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A11U',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A149',false)
elseif PE2==false then
call UnitRemoveAbility(SFI,'A11O')
call UnitRemoveAbility(SFI,'A11R')
call UnitRemoveAbility(SFI,'A147')
call UnitRemoveAbility(SFI,'A148')
call UnitRemoveAbility(SFI,'A11U')
call UnitRemoveAbility(SFI,'A149')
endif
set t=null
set SFI=null
return false
endfunction
function PF2 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function PC2))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(181),(0))
set SFI=null
set t=null
endfunction
function PG2 takes nothing returns boolean
if GetLearnedSkill()=='A13T' and GetUnitAbilityLevel(GetTriggerUnit(),'A13T')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call PF2()
endif
return false
endfunction
function TH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function PG2))
set t=null
endfunction
function PH2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local image i=(LoadImageHandle(LY,(handle_id),(185)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A13D')then
if GetTriggerEventId()!=EVENT_UNIT_DEATH and RKI(target)==false then
if IsUnitHidden(target)then
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
else
call SetUnitPosition(target,x,y)
endif
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A13D',false)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A11N' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A11N',true)
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call ShowImage(i,false)
call DestroyImage(i)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set i=null
set hero=null
return false
endfunction
function PZ2 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real UJI=90
local image i=CreateImage("Fonts\\X.blp",UJI,UJI,0,x-UJI/2,y-UJI/2,0,0,0,0,2)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local string fx=""
local integer level=GetUnitAbilityLevel(hero,'A11N')
call SCI(target,4401,5)
call AddSkill(hero,'A13D')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A13D',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A11N',false)
call SetImageRenderAlways(i,true)
if IsUnitAlly(hero,GetOwningPlayer(target))==false or IsUnitAlly(target,GetLocalPlayer())==true or P0I(GetLocalPlayer())then
set fx="effects\\BlackTide.mdx"
call ShowImage(i,true)
else
call ShowImage(i,false)
endif
call SetImageColor(i,255,0,0,255)
call UnitApplyTimedLife(CreateUnit(GetOwningPlayer(hero),'o01Z',x,y,0),'BTLF',5)
if IsUnitAlly(target,GetOwningPlayer(hero))==true then
call TriggerRegisterTimerEvent(t,8,false)
else
call TriggerRegisterTimerEvent(t,4,false)
endif
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PH2))
call SaveImageHandle(LY,(handle_id),(185),(i))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(fx,target,"overhead")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set target=null
set i=null
set t=null
endfunction
function PV2 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A11N' and(IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))or CanResistSkill(GetSpellTargetUnit())==false)then
call PZ2()
endif
else
if GetLearnedSkill()=='A11N' then
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A13D',false)
call AddSkill(GetTriggerUnit(),'A13D')
endif
endif
return false
endfunction
function PW2 takes nothing returns boolean
if GetSpellAbilityId()=='A11N' then
if(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))and IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endif
return false
endfunction
function TZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function PV2))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function PW2))
set t=null
endfunction
function PX2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer O91=1
local player p
local real d
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer PY2=(LoadInteger(LY,(handle_id),(136)))
local integer DC1=(LoadInteger(LY,(handle_id),(188)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>DC1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
loop
exitwhen O91>PY2
set p=(LoadPlayerHandle(LY,(handle_id),(1300+O91)))
set d=(LoadReal(LY,(handle_id),(1200+O91)))
if p==null then
set O91=PY2
else
call SetUnitState(target,UNIT_STATE_LIFE,QDI(1,GetUnitState(target,UNIT_STATE_LIFE)-d/DC1))
endif
set O91=O91+1
endloop
endif
set t=null
set p=null
set target=null
return false
endfunction
function PJ2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local trigger PK2=(LoadTriggerHandle(LY,(handle_id),(135)))
local integer O91=GetTriggerEvalCount(t)
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call TriggerRegisterTimerEvent(PK2,1,true)
call TriggerAddCondition(PK2,Condition(function PX2))
call UnitRemoveAbility(target,'B09U')
else
set handle_id=GetHandleId(PK2)
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+0.5*GetEventDamage())
call SavePlayerHandle(LY,(handle_id),(1300+O91),(GetOwningPlayer(GetEventDamageSource())))
call SaveReal(LY,(handle_id),(1200+O91),((0.5*GetEventDamage())*1.0))
call SaveInteger(LY,(handle_id),(136),(O91))
endif
set t=null
set target=null
set p=null
set PK2=null
return false
endfunction
function PL2 takes nothing returns nothing
local unit hero=AKI
local unit target=GetEnumUnit()
local integer level=ALI
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer DC1=10
local trigger PK2=CreateTrigger()
call AH1(target,'A126',1,DC1)
call UnitMakeAbilityPermanent(target,true,'A126')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A126',false)
call TriggerRegisterTimerEvent(t,DC1+0.01,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function PJ2))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveTriggerHandle(LY,(handle_id),(135),(PK2))
call SaveUnitHandle(LY,(GetHandleId(PK2)),(17),(target))
call SaveInteger(LY,(GetHandleId(PK2)),(188),(DC1))
set hero=null
set target=null
set t=null
set PK2=null
endfunction
function PM2 takes nothing returns boolean
if(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitInGroup(GetFilterUnit(),AJI)==false then
call GroupAddUnit(AJI,GetFilterUnit())
return true
endif
return false
endfunction
function PN2 takes nothing returns nothing
local unit hero=AKI
local unit target=GetEnumUnit()
local integer level=ALI
call DD1(hero,target,1.4)
call Damage(hero,target,1,300+100*level)
set hero=null
set target=null
endfunction
function PS2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local unit PT2
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real QXI=GetUnitX(IG1)
local real QYI=GetUnitY(IG1)
local real QJI=(LoadReal(LY,(handle_id),(66)))
local real QKI=(LoadReal(LY,(handle_id),(67)))
local integer NPI=GetTriggerEvalCount(t)
local real IV1=PTI(QJI+13.33*NPI*Cos(RM2))
local real IW1=PUI(QKI+13.33*NPI*Sin(RM2))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
if NPI<19 then
call SetUnitVertexColor(IG1,255,255,255,5+NPI*10)
set PT2=(LoadUnitHandle(LY,(handle_id),(186)))
call SetUnitVertexColor(PT2,255,255,255,5+NPI*10)
elseif NPI<125 then
call SetUnitVertexColor(IG1,255,255,255,190)
elseif NPI<150 then
endif
set g=NTI()
set AJI=PR2
set GK=IG1
set AKI=IG1
set ALI=level
call GroupEnumUnitsInRange(g,GetUnitX(IG1),GetUnitY(IG1),425,Condition(function PM2))
call ForGroup(g,function PL2)
call NSI(g)
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
if NPI==140 then
set PT2=(LoadUnitHandle(LY,(handle_id),(186)))
call KillUnit(PT2)
elseif NPI<140 then
set PT2=(LoadUnitHandle(LY,(handle_id),(186)))
call MUSetUnitX(PT2,IV1)
call MUSetUnitY(PT2,IW1)
endif
if NPI==150 then
set g=NTI()
set GK=IG1
call GroupEnumUnitsInRange(g,IV1,IW1,425+25,Condition(function CA1))
call ForGroup(g,function PN2)
call NSI(g)
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set IG1=null
set PT2=null
set PR2=null
set g=null
return false
endfunction
function PP2 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real QXI=GetUnitX(SFI)
local real QYI=GetUnitY(SFI)
local location point=GetSpellTargetLoc()
local real x0=GetLocationX(point)
local real y0=GetLocationY(point)
local real RM2
local real x1
local real y1
local real x2
local real y2
local trigger t
local integer handle_id
local integer level
local unit IG1
local unit PT2
local string s=""
local integer PQ2='h06U'
if GetRandomInt(0,5)==0 then
set PQ2='h0DJ'
endif
if IsPlayerAlly(GetOwningPlayer(SFI),GetLocalPlayer())or P0I(GetLocalPlayer())then
set s="war3mapImported\\Whirlpool.mdx"
endif
if x0==GetUnitX(SFI)and y0==GetUnitY(SFI)then
set x0=x0+50*Cos(GetUnitFacing(SFI)*bj_DEGTORAD)
set y0=y0+50*Sin(GetUnitFacing(SFI)*bj_DEGTORAD)
endif
set RM2=Atan2(y0-QYI,x0-QXI)
set x1=QXI-1000*Cos(RM2)
set y1=QYI-1000*Sin(RM2)
set x2=QXI+1000*Cos(RM2)
set y2=QYI+1000*Sin(RM2)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set level=GetUnitAbilityLevel(SFI,'A11K')
set IG1=CreateUnit(GetOwningPlayer(SFI),PQ2,x1,y1,Atan2(y0-QYI,x0-QXI)*bj_RADTODEG)
set PT2=CreateUnit(GetOwningPlayer(SFI),'h06V',x1,y1,Atan2(y0-QYI,x0-QXI)*bj_RADTODEG)
call SetUnitVertexColor(IG1,255,255,255,0)
call SetUnitPathing(IG1,false)
call RemoveLocation(point)
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveUnitHandle(LY,(handle_id),(186),(PT2))
call SaveReal(LY,(handle_id),(66),((x1)*1.0))
call SaveReal(LY,(handle_id),(67),((y1)*1.0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call DestroyEffect(AddSpecialEffect(s,PTI(x2),PUI(y2)))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function PS2))
set SFI=null
set t=null
set IG1=null
set PT2=null
set point=null
endfunction
function PU2 takes nothing returns boolean
if GetSpellAbilityId()=='A11K' then
call PP2()
endif
return false
endfunction
function TV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PU2))
call Q1I('A11L')
set t=null
endfunction
function Q02 takes nothing returns nothing
call Damage(AMI,GetEnumUnit(),2,ATI)
call DD1(AMI,GetEnumUnit(),ASI)
endfunction
function QI2 takes unit hero,unit target,real UH1 returns nothing
local group g
local integer level=GetUnitAbilityLevel(hero,'A1NI')
local real x
local real y
set AMI=hero
set ATI=(80+70*level)*UH1/5.0
set ASI=(1+0.75*level)*UH1/5.0
set ANI=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(ANI,'A0X6')
call SetUnitAbilityLevel(ANI,'A0X6',DB1(ASI))
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),175+25,Condition(function CA1))
if GetUnitTypeId(target)!='h0BD' then
call GroupAddUnit(g,target)
endif
call ForGroup(g,function Q02)
call NSI(g)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\DemolisherFireMissile\\DemolisherFireMissile.mdl",GetUnitX(target),GetUnitY(target)))
endfunction
function Q12 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real UH1=(LoadReal(LY,(handle_id),(444)))
local real QO2=(LoadReal(LY,(handle_id),(445)))
local real RM2=UEI(GetUnitX(IG1),GetUnitY(IG1),GetUnitX(target),GetUnitY(target))
local real x=GetUnitX(IG1)+18*Cos(RM2*bj_DEGTORAD)
local real y=GetUnitY(IG1)+18*Sin(RM2*bj_DEGTORAD)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
if QNI(x,y,GetUnitX(target),GetUnitY(target))<=18 then
call KillUnit(IG1)
call QI2(hero,target,UH1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
set IG1=null
return false
endfunction
function Q22 takes unit hero,unit target,real UH1,real QO2 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0BD',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(444),((UH1)*1.0))
call SaveReal(LY,(handle_id),(445),((QO2)*1.0))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function Q12))
set t=null
set IG1=null
endfunction
function Q32 takes string UWI,unit target,unit SFI returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,0.033)
call SetTextTagPosUnit(tt,target,64)
call SetTextTagColor(tt,255,0,0,255)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,0.15)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,0.65)
if IsUnitAlly(SFI,GetLocalPlayer())or P0I(GetLocalPlayer())then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
set tt=null
endfunction
function Q42 takes real DC1 returns string
if DC1>4.5 then
return"5.0"
elseif DC1>4.0 then
return"4.5"
elseif DC1>3.5 then
return"4.0"
elseif DC1>3.0 then
return"3.5"
elseif DC1>2.5 then
return"3.0"
elseif DC1>2.0 then
return"2.5"
elseif DC1>1.5 then
return"2.0"
elseif DC1>1.0 then
return"1.5"
elseif DC1>0.5 then
return"1.0"
elseif DC1>0.0 then
return"0.5"
else
return"0.0"
endif
return" "
endfunction
function Q52 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QO2=(LoadReal(LY,(handle_id),(442)))
local real GW1=(TimerGetElapsed(M))
local real BQO=5.0-(GW1-QO2)
local real QHI=QCI(GW1-QO2,5.0)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))+1
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call QI2(hero,hero,5.0)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1NI' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NI',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NH',false)
call SetUnitVertexColor(hero,255,255,255,255)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A1NH' then
if CanResistSkill(GetSpellTargetUnit())==false then
call Q22(hero,GetSpellTargetUnit(),QHI,QO2)
endif
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1NI' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NI',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NH',false)
call SetUnitVertexColor(hero,255,255,255,255)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call SaveInteger(LY,(handle_id),(34),(NPI))
if BQO>=0 then
call Q32(Q42(BQO),hero,hero)
if ModuloInteger(NPI,2)==0 then
call SetUnitVertexColor(hero,255,125,125,255)
else
call SetUnitVertexColor(hero,255,175,175,255)
endif
else
call SetUnitVertexColor(hero,255,0,0,255)
endif
if GW1-QO2>(5.0+0.5)then
call QI2(hero,hero,5.0)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1NI' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NI',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NH',false)
call SetUnitVertexColor(hero,255,255,255,255)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set hero=null
return false
endfunction
function Q62 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local string s="war3mapImported\\UnstableConcoctionRangeDisplay3.mdx"
if GetLocalPlayer()!=GetOwningPlayer(hero)then
set s=""
endif
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M)))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(s,hero,"origin")))
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function Q52))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NI',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1NH',true)
call AddSkill(hero,'A1NH')
call UnitMakeAbilityPermanent(hero,true,'A1NH')
call TriggerEvaluate(t)
set hero=null
set t=null
endfunction
function Q72 takes nothing returns boolean
if GetSpellAbilityId()=='A1NI' then
call Q62()
endif
return false
endfunction
function NA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Q72))
call Q1I('A0X6')
set t=null
endfunction
function Q82 takes nothing returns boolean
return GetUnitAbilityLevel(GetKillingUnit(),'A0O3')>0 and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetKillingUnit()))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function Q92 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit u=(LoadUnitHandle(LY,(handle_id),(26)))
call SaveInteger(LY,(GetHandleId(u)),(27),((LoadInteger(LY,(GetHandleId(u)),(27)))-1))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set u=null
set t=null
return false
endfunction
function QA2 takes nothing returns nothing
local unit PKI=GetKillingUnit()
local unit QB2=GetTriggerUnit()
local integer handle_id=GetHandleId(PKI)
local integer QC2=(LoadInteger(LY,(handle_id),(27)))
local integer level=GetUnitAbilityLevel(PKI,'A0O3')
local integer QD2=4+8*level
local integer QE2=QC2*3
local integer QF2=Q9I(QE2+level*2+4,QD2)
local texttag tt=CreateTextTag()
local player p=GetOwningPlayer(PKI)
local trigger t=CreateTrigger()
set ARI[GetPlayerId(p)]=ARI[GetPlayerId(p)]+QF2
call TriggerRegisterTimerEvent(t,30,false)
call TriggerAddCondition(t,Condition(function Q92))
call SaveUnitHandle(LY,(GetHandleId(t)),(26),(PKI))
call SaveInteger(LY,(handle_id),(27),(QC2+1))
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,QF2+GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD))
call SetTextTagText(tt,"+"+I2S(QF2),0.025)
call SetTextTagPosUnit(tt,QB2,0)
call SetTextTagColor(tt,255,220,0,255)
call SetTextTagVelocity(tt,0,0.03)
if GetLocalPlayer()==p then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
call SetTextTagFadepoint(tt,2)
call SetTextTagLifespan(tt,3)
call SetTextTagPermanent(tt,false)
set t=null
endfunction
function QG2 takes nothing returns boolean
local integer EB2=ARI[GetPlayerId(GetTriggerPlayer())]
if(GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='N01I' or GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='N01H' or GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='N01T' or GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='N01J')and EB2>0 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"地精贪婪："+" "+I2S(EB2))
endif
return false
endfunction
function N91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function Q82))
call TriggerAddAction(t,function QA2)
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function QG2))
set t=null
endfunction
constant function AcidSpray_RawCode takes nothing returns integer
return 'A0IL'
endfunction
constant function AcidSpray_EffectCode takes nothing returns integer
return 'A0J4'
endfunction
function QH2 takes nothing returns boolean
return GetSpellAbilityId()==('A0IL')
endfunction
function QZ2 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(XO))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitTypeId(GetFilterUnit())!='n0F5'
endfunction
function QV2 takes nothing returns nothing
call Damage(XO,GetEnumUnit(),2,JO)
endfunction
function QW2 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer QX2=(LoadInteger(LY,(handle_id),(28)))
local real x=GetUnitX(dummy)
local real y=GetUnitY(dummy)
local boolexpr QL1
local group Z51
if QX2>16 then
call KillUnit(dummy)
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call DestroyTimer(t)
else
set XO=SFI
set JO=8+GetUnitAbilityLevel(SFI,('A0IL'))*4
set QL1=Condition(function QZ2)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,650,QL1)
call ForGroup(Z51,function QV2)
call NSI(Z51)
set QX2=QX2+1
call SaveInteger(LY,(handle_id),(28),(QX2))
endif
endfunction
function QY2 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location BFO=GetSpellTargetLoc()
local real x=GetLocationX(BFO)
local real y=GetLocationY(BFO)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e01E',x,y,0)
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
call RemoveLocation(BFO)
call AddSkill(dummy,('A0J4'))
call SetUnitAbilityLevel(dummy,('A0J4'),GetUnitAbilityLevel(SFI,('A0IL')))
call AddSkill(dummy,'Aloc')
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(28),(0))
call TimerStart(t,1,true,function QW2)
endfunction
function NB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddAction(t,function QY2)
call TriggerAddCondition(t,Condition(function QH2))
call Q1I(('A0J4'))
endfunction
function QJ2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real OA2=GetUnitState(SFI,UNIT_STATE_MANA)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitState(SFI,UNIT_STATE_MANA,GetUnitState(SFI,UNIT_STATE_MAX_MANA))
call SetUnitState(SFI,UNIT_STATE_MANA,OA2)
set t=null
set SFI=null
return false
endfunction
function QK2 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.1,false)
call TriggerAddCondition(t,Condition(function QJ2))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
set SFI=null
endfunction
function QL2 takes nothing returns boolean
if GetSpellAbilityId()=='ANcr' and GetUnitTypeId(GetTriggerUnit())=='N01I' then
call QK2()
endif
return false
endfunction
function Register_ChemicalRage takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QL2))
set t=null
endfunction
function QM2 takes nothing returns nothing
call Damage(AQI,GetEnumUnit(),1,API)
endfunction
function QN2 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A2WE')
local real PAI=(0.35+0.25*level)*(GetUnitState(target,UNIT_STATE_MAX_MANA)-GetUnitState(target,UNIT_STATE_MANA))
local group g=NTI()
call DD1(SFI,target,0.1*level)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl",target,"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\SpiritOfVengeanceMissile\\SpiritOfVengeanceMissile.mdl",target,"chest"))
call DestroyEffect(AddSpecialEffect("war3mapImported\\Enchantment.mdx",GetUnitX(target),GetUnitY(target)))
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),500+25,Condition(function C51))
set API=PAI
set AQI=SFI
call ForGroup(g,function QM2)
call PlaySoundOnUnitBJ(PC,100,target)
call NSI(g)
set SFI=null
set target=null
set g=null
endfunction
function QS2 takes nothing returns boolean
if GetSpellAbilityId()=='A2WE' and CanResistSkill(GetSpellTargetUnit())==false then
call QN2()
endif
return false
endfunction
function WZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QS2))
set t=null
endfunction
function QT2 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A1V6')
local real QR2=16+12*level
local real QP2=GetUnitState(target,UNIT_STATE_MANA)
local real ZCO=RMinBJ(QR2,QP2)
if ZCO>0 then
call SetUnitState(target,UNIT_STATE_MANA,QP2-ZCO)
call Damage(hero,target,2,ZCO*0.6)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Feedback\\SpellBreakerAttack.mdl",target,"origin"))
endif
endfunction
function QQ2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call QT2(hero,target)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function QU2 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,0.4,false)
call TriggerAddCondition(t,Condition(function QQ2))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function UI2 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4274))))==1)==false then
call SCI(hero,4274,0.4)
call QU2()
endif
endfunction
function U12 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A1V6')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))and RKI(GetTriggerUnit())==false then
call UI2()
endif
return false
endfunction
function UO2 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function U12))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function U22 takes nothing returns boolean
if GetLearnedSkill()=='A1V6' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A1V6')==1 then
call UO2()
endif
return false
endfunction
function WW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function U22))
set t=null
endfunction
function U32 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer NPI=GetTriggerEvalCount(t)
local integer R2O=R2I(((0.9-0.3)/0.5)/0.03)
local integer U42=R2I((175/R2O))
local integer U52=R2I((255/R2O)*1.75)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
if NPI>R2O then
call SetUnitVertexColor(dummy,255,255,255,0)
call SetUnitVertexColor(SFI,255,255,255,255)
call ShowUnit(dummy,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitVertexColor(dummy,255,255,255,175-U42*NPI)
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
call SetUnitVertexColor(SFI,255,255,255,U52*NPI)
endif
set t=null
set dummy=null
set SFI=null
return false
endfunction
function U62 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy=(LoadUnitHandle(LY,(GetHandleId(SFI)),(293)))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
call SetUnitVertexColor(SFI,255,255,255,0)
call SetUnitVertexColor(dummy,255,255,255,175)
call SetUnitTimeScale(dummy,0.5)
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function U32))
set SFI=null
set dummy=null
set t=null
endfunction
function U72 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy
local integer handle_id=GetHandleId(SFI)
local location point=GetSpellTargetLoc()
local real a=UEI(GetUnitX(SFI),GetUnitY(SFI),GetLocationX(point),GetLocationY(point))
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
call RemoveLocation(point)
call SetUnitPathing(SFI,false)
call AddSkill(SFI,'Aeth')
set dummy=CreateUnit(GetOwningPlayer(SFI),'h06K',GetUnitX(SFI),GetUnitY(SFI),a)
call ON1(dummy,5)
call SetUnitPathing(dummy,false)
call AddSkill(dummy,'Aeth')
call AddSkill(dummy,'Aloc')
call AddSkill(dummy,'A04R')
call SetUnitVertexColor(dummy,255,255,255,0)
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
call SetUnitAnimation(dummy,"Spell Throw")
call SetUnitPathing(SFI,true)
call UnitRemoveAbility(SFI,'Aeth')
call SaveUnitHandle(LY,(handle_id),(293),(dummy))
set SFI=null
set dummy=null
endfunction
function U82 takes nothing returns boolean
if GetSpellAbilityId()=='AEbl' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call U62()
else
call U72()
endif
endif
return false
endfunction
function WV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U82))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function U82))
set t=null
call A51('h06K')
endfunction
function U92 takes nothing returns boolean
return GetSpellAbilityId()=='A0O1'
endfunction
function TreeKiller takes nothing returns nothing
call KillDestructable(GetEnumDestructable())
endfunction
function UA2 takes unit PKI,real x,real y,group JAO returns nothing
local group Z51=NTI()
local unit WH1
call UPI(x,y,150)
call GroupEnumUnitsInRange(Z51,x,y,150,Condition(function N1I))
loop
set WH1=FirstOfGroup(Z51)
exitwhen WH1==null
if(IsUnitInGroup(WH1,JAO)==false and IsUnitEnemy(WH1,GetOwningPlayer(PKI)))then
if(GetUnitAbilityLevel(WH1,'A04R')!=1 and GetUnitState(WH1,UNIT_STATE_LIFE)>0 and IsUnitType(WH1,UNIT_TYPE_STRUCTURE)==false)then
call GroupAddUnit(JAO,WH1)
call Damage(PKI,WH1,2,40+GetUnitAbilityLevel(PKI,'A0O1')*30)
call AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",WH1,"overhead")
endif
endif
call GroupRemoveUnit(Z51,WH1)
endloop
call NSI(Z51)
endfunction
function UB2 takes nothing returns nothing
local integer handle_id=GetHandleId(GetExpiredTimer())
local unit UC2=(LoadUnitHandle(LY,(handle_id),(290)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real Ax=(LoadReal(LY,(handle_id),(284)))
local real Ay=(LoadReal(LY,(handle_id),(285)))
local real Cx=(LoadReal(LY,(handle_id),(286)))
local real Cy=(LoadReal(LY,(handle_id),(287)))
local real Bx=(LoadReal(LY,(handle_id),(288)))
local real By=(LoadReal(LY,(handle_id),(289)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real b=1-a
local boolean UD2=(LoadBoolean(LY,(handle_id),(291)))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local real UE2=RMaxBJ(QNI(Ax,Ay,Cx,Cy)/1300,0.4)
call MUSetUnitX(UC2,PTI(Ax*a*a+Bx*2*a*b+Cx*b*b))
call MUSetUnitY(UC2,PUI(Ay*a*a+By*2*a*b+Cy*b*b))
call UA2(SFI,GetUnitX(UC2),GetUnitY(UC2),JAO)
if(UD2)then
call SaveReal(LY,(handle_id),(137),((a-.02/UE2)*1.0))
else
call SaveReal(LY,(handle_id),(137),((a+.02/UE2)*1.0))
call SaveReal(LY,(handle_id),(284),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(285),((GetUnitY(SFI))*1.0))
endif
if(a<0 and UD2)then
call SaveBoolean(LY,(handle_id),(291),(false))
call SaveReal(LY,(handle_id),(288),((Ax+300*Cos(Atan2(Cy-Ay,Cx-Ax)+(LoadReal(LY,(handle_id),(292)))))*1.0))
call SaveReal(LY,(handle_id),(289),((Ay+300*Sin(Atan2(Cy-Ay,Cx-Ax)+(LoadReal(LY,(handle_id),(292)))))*1.0))
endif
if(a>1 and UD2==false)then
call PauseTimer(GetExpiredTimer())
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call RemoveUnit(UC2)
call DestroyTimer(GetExpiredTimer())
endif
endfunction
function UF2 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local real Ax=GetUnitX(PKI)
local real Ay=GetUnitY(PKI)
local real Cx=GetLocationX(GetSpellTargetLoc())
local real Cy=GetLocationY(GetSpellTargetLoc())
local unit UG2=CreateUnit(GetOwningPlayer(PKI),'e01T',Ax,Ay,270.0)
local unit UH2=CreateUnit(GetOwningPlayer(PKI),'e01T',Ax,Ay,270.0)
local integer UZ2
local integer UV2
local timer UW2=CreateTimer()
local timer UX2=CreateTimer()
if GetSpellTargetUnit()!=null then
set Cx=GetUnitX(GetSpellTargetUnit())
set Cy=GetUnitY(GetSpellTargetUnit())
endif
call AddSkill(UG2,'Amrf')
call UnitRemoveAbility(UG2,'Amrf')
call SetUnitFlyHeight(UG2,150,0)
call AddSkill(UH2,'Amrf')
call UnitRemoveAbility(UH2,'Amrf')
call SetUnitFlyHeight(UH2,150,0)
set UZ2=GetHandleId(UW2)
call SaveUnitHandle(LY,(UZ2),(14),(PKI))
call SaveUnitHandle(LY,(UZ2),(290),(UG2))
call SaveGroupHandle(LY,(UZ2),(133),(NTI()))
call SaveReal(LY,(UZ2),(284),((Ax)*1.0))
call SaveReal(LY,(UZ2),(285),((Ay)*1.0))
call SaveReal(LY,(UZ2),(286),((Cx)*1.0))
call SaveReal(LY,(UZ2),(287),((Cy)*1.0))
call SaveReal(LY,(UZ2),(288),((Ax+300*Cos(Atan2(Cy-Ay,Cx-Ax)+45))*1.0))
call SaveReal(LY,(UZ2),(289),((Ay+300*Sin(Atan2(Cy-Ay,Cx-Ax)+45))*1.0))
call SaveReal(LY,(UZ2),(137),((1)*1.0))
call SaveReal(LY,(UZ2),(292),((-45)*1.0))
call SaveBoolean(LY,(UZ2),(291),(true))
set UV2=GetHandleId(UX2)
call SaveUnitHandle(LY,(UV2),(14),(PKI))
call SaveUnitHandle(LY,(UV2),(290),(UH2))
call SaveGroupHandle(LY,(UV2),(133),(NTI()))
call SaveReal(LY,(UV2),(284),((Ax)*1.0))
call SaveReal(LY,(UV2),(285),((Ay)*1.0))
call SaveReal(LY,(UV2),(286),((Cx)*1.0))
call SaveReal(LY,(UV2),(287),((Cy)*1.0))
call SaveReal(LY,(UV2),(288),((Ax+300*Cos(Atan2(Cy-Ay,Cx-Ax)-45))*1.0))
call SaveReal(LY,(UV2),(289),((Ay+300*Sin(Atan2(Cy-Ay,Cx-Ax)-45))*1.0))
call SaveReal(LY,(UV2),(137),((1)*1.0))
call SaveReal(LY,(UV2),(292),((45)*1.0))
call SaveBoolean(LY,(UV2),(291),(true))
call TimerStart(UW2,.025,true,function UB2)
call TimerStart(UX2,.025,true,function UB2)
endfunction
function WY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U92))
call TriggerAddAction(t,function UF2)
endfunction
function UY2 takes nothing returns nothing
local real x=GetUnitX(GetEnumUnit())
local real y=GetUnitY(GetEnumUnit())
local real a=bj_RADTODEG*Atan2(y-BK,x-AK)
local real UJ2
local real UK2
if Sin((a-CK)*bj_DEGTORAD)<0 then
set UJ2=GetUnitX(GetEnumUnit())+15*Cos((CK-90)*bj_DEGTORAD)
set UK2=GetUnitY(GetEnumUnit())+15*Sin((CK-90)*bj_DEGTORAD)
call SetUnitPosition(GetEnumUnit(),UJ2,UK2)
call SetUnitFacingTimed(GetEnumUnit(),CK+90,0.3)
else
set UJ2=GetUnitX(GetEnumUnit())+15*Cos((CK+90)*bj_DEGTORAD)
set UK2=GetUnitY(GetEnumUnit())+15*Sin((CK+90)*bj_DEGTORAD)
call SetUnitPosition(GetEnumUnit(),UJ2,UK2)
call SetUnitFacingTimed(GetEnumUnit(),CK-90,0.3)
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",GetEnumUnit(),"origin"))
endfunction
function UL2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
if GetTriggerEvalCount(t)>20 then
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set AK=x
set BK=y
set CK=RM2
call ForGroup(g,function UY2)
endif
set t=null
set g=null
return false
endfunction
function UM2 takes nothing returns nothing
call Damage(GK,GetEnumUnit(),1,AK)
endfunction
function UN2 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A0O2')
local unit dummy
local real RM2=bj_RADTODEG*Atan2(GetUnitY(target)-GetUnitY(SFI),GetUnitX(target)-GetUnitX(SFI))
local real x
local real y
local group g=NTI()
local group g2=NTI()
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A289')
endif
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function UL2))
set x=GetUnitX(SFI)+50*Cos(RM2*bj_DEGTORAD)
set y=GetUnitY(SFI)+50*Sin(RM2*bj_DEGTORAD)
call GroupEnumUnitsInRange(g2,x,y,325,Condition(function C51))
call GroupAddGroup(g2,g)
call GroupClear(g2)
set dummy=CreateUnit(GetOwningPlayer(SFI),'o00Y',x,y,RM2)
call UnitApplyTimedLife(dummy,'BTLF',1)
call AddSkill(dummy,'A0NY')
call SetUnitAbilityLevel(dummy,'A0NY',level)
call IssueImmediateOrder(dummy,"thunderclap")
set x=GetUnitX(SFI)+250*Cos(RM2*bj_DEGTORAD)
set y=GetUnitY(SFI)+250*Sin(RM2*bj_DEGTORAD)
call GroupEnumUnitsInRange(g2,x,y,325,Condition(function C51))
call GroupAddGroup(g2,g)
call GroupClear(g2)
set dummy=CreateUnit(GetOwningPlayer(SFI),'o00Y',x,y,RM2)
call UnitApplyTimedLife(dummy,'BTLF',1)
call AddSkill(dummy,'A0NY')
call SetUnitAbilityLevel(dummy,'A0NY',level)
call IssueImmediateOrder(dummy,"thunderclap")
set x=GetUnitX(SFI)+450*Cos(RM2*bj_DEGTORAD)
set y=GetUnitY(SFI)+450*Sin(RM2*bj_DEGTORAD)
call GroupEnumUnitsInRange(g2,x,y,325,Condition(function C51))
call GroupAddGroup(g2,g)
call GroupClear(g2)
set dummy=CreateUnit(GetOwningPlayer(SFI),'o00Y',x,y,RM2)
call UnitApplyTimedLife(dummy,'BTLF',1)
call AddSkill(dummy,'A0NY')
call SetUnitAbilityLevel(dummy,'A0NY',level)
call IssueImmediateOrder(dummy,"thunderclap")
if GetUnitAbilityLevel(SFI,'A0O2')==0 then
set x=GetUnitX(SFI)+650*Cos(RM2*bj_DEGTORAD)
set y=GetUnitY(SFI)+650*Sin(RM2*bj_DEGTORAD)
call GroupEnumUnitsInRange(g2,x,y,325,Condition(function C51))
call GroupAddGroup(g2,g)
call GroupClear(g2)
set dummy=CreateUnit(GetOwningPlayer(SFI),'o00Y',x,y,RM2)
call UnitApplyTimedLife(dummy,'BTLF',1)
call AddSkill(dummy,'A0NY')
call SetUnitAbilityLevel(dummy,'A0NY',level)
call IssueImmediateOrder(dummy,"thunderclap")
endif
call NSI(g2)
call GroupRemoveUnit(g,target)
set AK=150+50*level
set GK=SFI
call ForGroup(g,function UM2)
set t=null
set SFI=null
set target=null
set dummy=null
set g=null
set g2=null
endfunction
function US2 takes nothing returns boolean
if(GetSpellAbilityId()=='A0O2' or GetSpellAbilityId()=='A289')and CanResistSkill(GetSpellTargetUnit())==false then
call UN2()
endif
return false
endfunction
function WX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function US2))
set t=null
endfunction
function UT2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'A140')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function UR2 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call AddSkill(hero,'A140')
call TriggerRegisterTimerEvent(t,5,false)
call TriggerAddCondition(t,Condition(function UT2))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function UP2 takes nothing returns boolean
if GetSpellAbilityId()=='A13Z' then
call UR2()
endif
return false
endfunction
function WK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UP2))
set t=null
endfunction
function UQ2 takes nothing returns boolean
return GetSpellAbilityId()=='A0OO' or GetSpellAbilityId()=='A2U5'
endfunction
function UU2 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit I03=(LoadUnitHandle(LY,(handle_id),(2)))
local real II3=(LoadReal(LY,(handle_id),(6)))
local real I13=(LoadReal(LY,(handle_id),(7)))
local real IO3=GetUnitX(I03)
local real I23=GetUnitY(I03)
call SaveReal(LY,(handle_id),(6),((IO3)*1.0))
call SaveReal(LY,(handle_id),(7),((I23)*1.0))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if II3==IO3 and I13==I23 then
if GetUnitAbilityLevel(I03,'A1WG')==0 then
call AddSkill(I03,'A1WG')
endif
else
if GetUnitAbilityLevel(I03,'A1WG')>0 then
call UnitRemoveAbility(I03,'A1WG')
endif
endif
endif
set t=null
set I03=null
return false
endfunction
function I33 takes nothing returns nothing
if AUI then
if(GetUnitTypeId(GetEnumUnit())=='n01Q' or GetUnitTypeId(GetEnumUnit())=='n01R')then
endif
elseif B0I then
if(GetUnitTypeId(GetEnumUnit())=='n01M' or GetUnitTypeId(GetEnumUnit())=='n01S')then
endif
endif
endfunction
function I43 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local player T4I=GetOwningPlayer(PKI)
local integer level=GetUnitAbilityLevel(PKI,'A0OO')
local real x=GetUnitX(PKI)
local real y=GetUnitY(PKI)
local group Z51=NTI()
local unit I03
local trigger t
local integer handle_id
local boolean I53=GetSpellAbilityId()=='A0OO'
local boolean I63=GetSpellAbilityId()=='A2U5'
set AUI=I53
set B0I=I63
call GroupEnumUnitsOfPlayer(Z51,T4I,Condition(function N1I))
call ForGroup(Z51,function I33)
call NSI(Z51)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",x,y))
if(I53)then
if(level==1)then
set I03=CreateUnit(T4I,'n01Q',x,y,270)
call UnitApplyTimedLife(I03,'BTLF',60)
elseif(level==2)then
set I03=CreateUnit(T4I,'n0NX',x,y,270)
call UnitApplyTimedLife(I03,'BTLF',60)
elseif(level==3)then
set I03=CreateUnit(T4I,'n0NV',x,y,270)
call UnitApplyTimedLife(I03,'BTLF',60)
elseif(level==4)then
set I03=CreateUnit(T4I,'n0NW',x,y,270)
call UnitApplyTimedLife(I03,'BTLF',60)
endif
if level==3 or level==4 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,I03,EVENT_UNIT_DEATH)
call SaveReal(LY,(handle_id),(6),((GetUnitX(I03))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(I03))*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(I03))
call TriggerAddCondition(t,Condition(function UU2))
endif
endif
if(I63)then
if(level==1)then
call UnitApplyTimedLife(CreateUnit(T4I,'n0NT',x,y,270),'BTLF',60)
elseif(level==2)then
call UnitApplyTimedLife(CreateUnit(T4I,'n01M',x,y,270),'BTLF',60)
elseif(level==3)then
call UnitApplyTimedLife(CreateUnit(T4I,'n0NS',x,y,270),'BTLF',60)
elseif(level==4)then
call UnitApplyTimedLife(CreateUnit(T4I,'n0NU',x,y,270),'BTLF',60)
endif
endif
endfunction
function I73 takes nothing returns boolean
if GetLearnedSkill()=='A0OO' and IsUnitIllusion(GetTriggerUnit())==false then
if GetUnitAbilityLevel(GetTriggerUnit(),'A0OO')==1 then
call AddSkill(GetTriggerUnit(),'A2U5')
endif
call SetUnitAbilityLevel(GetTriggerUnit(),'A2U5',GetUnitAbilityLevel(GetTriggerUnit(),'A0OO'))
endif
return false
endfunction
function WJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UQ2))
call TriggerAddAction(t,function I43)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function I73))
set t=null
endfunction
function I83 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer handle_id=GetHandleId(hero)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local texttag tt=CreateTextTag()
local integer ROI
local integer i=1
local unit u
local player p2
if level==1 then
set ROI=200
elseif level==2 then
set ROI=275
else
set ROI=350
endif
call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetTextTagText(tt,"+"+I2S(ROI),0.025)
call SetTextTagPosUnit(tt,K1[GetPlayerId(p)],100)
call SetTextTagColor(tt,255,220,0,255)
call SetTextTagVelocity(tt,0,0.03)
call SetTextTagVisibility(tt,false)
if GetLocalPlayer()==p then
call SetTextTagVisibility(tt,true)
endif
call SetTextTagFadepoint(tt,2)
call SetTextTagLifespan(tt,3)
call SetTextTagPermanent(tt,false)
set EL0[GetPlayerId(p)]=EL0[GetPlayerId(p)]+ROI
set BII=BII+ROI
if level==1 then
set ROI=50
elseif level==2 then
set ROI=100
else
set ROI=150
endif
loop
exitwhen i>5
if IsPlayerTeam1(p)then
set p2=BO[i]
else
set p2=CO[i]
endif
if p2!=p then
set u=K1[GetPlayerId(p2)]
if QLI(u,hero)<950 then
set tt=CreateTextTag()
call SetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p2,PLAYER_STATE_RESOURCE_GOLD)+ROI)
call SetTextTagText(tt,"+"+I2S(ROI),0.025)
call SetTextTagPosUnit(tt,u,100)
call SetTextTagColor(tt,255,220,0,255)
call SetTextTagVelocity(tt,0,0.03)
call SetTextTagVisibility(tt,false)
if GetLocalPlayer()==p2 then
call SetTextTagVisibility(tt,true)
endif
call SetTextTagFadepoint(tt,2)
call SetTextTagLifespan(tt,3)
call SetTextTagPermanent(tt,false)
set EL0[GetPlayerId(p2)]=EL0[GetPlayerId(p2)]+ROI
set BII=BII+ROI
endif
endif
set i=i+1
endloop
set hero=null
set p=null
set tt=null
endfunction
function I93 takes nothing returns boolean
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and(LoadReal(LY,(GetHandleId(GetTriggerUnit())),(314)))>(TimerGetElapsed(M))then
call I83()
endif
return false
endfunction
function IA3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEvalCount(t)>10 and GetUnitAbilityLevel(target,'B00L')==0)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set dummy=null
return false
endfunction
function IB3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(target),'e01V',GetUnitX(target),GetUnitY(target),0)
local string FX="war3mapImported\\TrackBuff.mdx"
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(target))and P0I(GetLocalPlayer())==false then
set FX=""
endif
call AddSkill(dummy,'A115')
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,GetSpellTargetUnit(),EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IA3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(FX,target,"overhead")))
call SaveReal(LY,(GetHandleId(GetSpellTargetUnit())),(314),(((TimerGetElapsed(M))+30)*1.0))
call SavePlayerHandle(LY,(GetHandleId(GetSpellTargetUnit())),(54),(GetOwningPlayer(GetTriggerUnit())))
call SaveInteger(LY,(GetHandleId(GetSpellTargetUnit())),(5),(GetUnitAbilityLevel(GetTriggerUnit(),'A0B4')))
set t=null
set target=null
set hero=null
set dummy=null
endfunction
function IC3 takes nothing returns boolean
if GetSpellAbilityId()=='A0B4' then
call IB3()
endif
return false
endfunction
function WT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IC3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I93))
set t=null
endfunction
function Jinada_Swap takes nothing returns nothing
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A1J4',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A1J3',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A1J5',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(XM),'A1IU',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A1J4',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A1J3',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A1J5',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(YM),'A1IU',false)
endfunction
function ID3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(target,'A1IW')
call UnitRemoveAbility(target,'B0CA')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function IE3 takes unit hero,unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,3,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ID3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(target,'A1IW')
call UnitMakeAbilityPermanent(target,true,'A1IW')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1IW',false)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\HumanBloodKnight.mdl",target,"chest"))
set t=null
endfunction
function IF3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and(GetEventDamage()>40 or IsUnitType(target,UNIT_TYPE_STRUCTURE)==true or GetUnitTypeId(target)=='umtw' or GetUnitTypeId(target)=='ebal')and(LoadBoolean(LY,(GetHandleId(hero)),(183)))==true then
call IE3(hero,target)
call SaveBoolean(LY,(GetHandleId(hero)),(183),(false))
call SaveReal(LY,(GetHandleId(hero)),(184),(((TimerGetElapsed(M)))*1.0))
call UnitRemoveAbility(hero,'A1IS')
call UnitRemoveAbility(hero,'A1J4')
call UnitRemoveAbility(hero,'A1J3')
call UnitRemoveAbility(hero,'A1J5')
call UnitRemoveAbility(hero,'A1IU')
call FlushChildHashtable(LY,(GetHandleId((LoadTriggerHandle(LY,(handle_id),(35))))))
call FlushTrigger((LoadTriggerHandle(LY,(handle_id),(35))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IG3 takes nothing returns boolean
local trigger t
local integer handle_id
local unit target
local unit hero
local integer level
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(183),(false))
call SaveReal(LY,(GetHandleId(GetTriggerUnit())),(184),(((TimerGetElapsed(M)))*1.0))
call UnitRemoveAbility(GetTriggerUnit(),'A1IS')
call UnitRemoveAbility(GetTriggerUnit(),'A1J4')
call UnitRemoveAbility(GetTriggerUnit(),'A1J3')
call UnitRemoveAbility(GetTriggerUnit(),'A1J5')
call UnitRemoveAbility(GetTriggerUnit(),'A1IU')
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
elseif GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(182)))then
if IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set target=GetTriggerUnit()
set hero=GetAttacker()
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function IF3))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveTriggerHandle(LY,(handle_id),(35),(GetTriggeringTrigger()))
set level=GetUnitAbilityLevel(GetAttacker(),'A1IQ')
if level==0 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==1 then
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==2 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==3 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==4 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
endif
set target=null
set hero=null
set t=null
endif
endif
return false
endfunction
function IH3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real QZI=(TimerGetElapsed(M))
local integer level=GetUnitAbilityLevel(SFI,'A1IQ')
local real PD2=(LoadReal(LY,(GetHandleId(SFI)),(184)))
local boolean IZ3=(LoadBoolean(LY,(GetHandleId(SFI)),(183)))
if QZI-PD2>14-level*2 and IZ3==false and GetUnitTypeId(SFI)=='Naka' and IsUnitDead(SFI)==false then
call SaveBoolean(LY,(GetHandleId(SFI)),(183),(true))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IG3))
call SaveUnitHandle(LY,(handle_id),(182),(SFI))
call AddSkill(SFI,'A1IS')
if GetUnitAbilityLevel(SFI,'B068')==0 then
if level==1 then
call AddSkill(SFI,'A1J4')
elseif level==2 then
call AddSkill(SFI,'A1J3')
elseif level==3 then
call AddSkill(SFI,'A1J5')
elseif level==4 then
call AddSkill(SFI,'A1IU')
endif
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A1J4',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A1J3',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A1J5',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A1IU',false)
elseif IZ3==false and GetUnitAbilityLevel(SFI,'B068')==0 then
call UnitRemoveAbility(SFI,'A1IS')
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1J5')
call UnitRemoveAbility(SFI,'A1IU')
endif
set t=null
set SFI=null
return false
endfunction
function IV3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function IH3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(181),(0))
set SFI=null
set t=null
endfunction
function IW3 takes nothing returns boolean
if GetLearnedSkill()=='A1IQ' and GetUnitAbilityLevel(GetTriggerUnit(),'A1IQ')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call IV3()
endif
return false
endfunction
function WR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function IW3))
set t=null
endfunction
function IX3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A07A')
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if((LoadInteger(LY,(GetHandleId((hero))),((2487))))==1)==false then
call SCI(hero,2487,0.5)
if IsUnitType(target,UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(target,GetOwningPlayer(hero))then
call Damage(hero,target,2,30*level)
call UYI(I2S(R2I(30*level)),1,hero,0.027,216,0,0,216)
endif
endif
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IY3 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2,false)
call TriggerAddCondition(t,Condition(function IX3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function IJ3 takes nothing returns boolean
local integer level
local unit SFI
if GetTriggerEventId()==EVENT_UNIT_SPELL_CAST or GetTriggerEventId()==EVENT_UNIT_DEATH then
set SFI=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))
set level=GetUnitAbilityLevel(SFI,'A1IQ')
if(LoadBoolean(LY,(GetHandleId(SFI)),(183)))then
set level=GetUnitAbilityLevel(SFI,'A1IQ')
if level==0 then
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1J5')
call UnitRemoveAbility(SFI,'A1IU')
elseif level==1 then
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1J5')
call UnitRemoveAbility(SFI,'A1IU')
elseif level==2 then
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J5')
call UnitRemoveAbility(SFI,'A1IU')
elseif level==3 then
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1IU')
elseif level==4 then
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1J5')
endif
else
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1J5')
call UnitRemoveAbility(SFI,'A1IU')
endif
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
if((LoadInteger(LY,(GetHandleId((GetAttacker()))),((2488))))==1)==false then
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
call IY3()
endif
if(LoadBoolean(LY,(GetHandleId(GetAttacker())),(183)))then
set level=GetUnitAbilityLevel(GetAttacker(),'A1IQ')
if level==0 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==1 then
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==2 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==3 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1IU')
elseif level==4 then
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
endif
else
call UnitRemoveAbility(GetAttacker(),'A1J4')
call UnitRemoveAbility(GetAttacker(),'A1J3')
call UnitRemoveAbility(GetAttacker(),'A1J5')
call UnitRemoveAbility(GetAttacker(),'A1IU')
endif
endif
else
set SFI=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))
if(LoadBoolean(LY,(GetHandleId(SFI)),(183)))==false then
call UnitRemoveAbility(SFI,'A1J4')
call UnitRemoveAbility(SFI,'A1J3')
call UnitRemoveAbility(SFI,'A1J5')
call UnitRemoveAbility(SFI,'A1IU')
endif
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function IK3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A07A')
call SCI(hero,2488,1.25-0.25*level-0.01)
call TriggerRegisterTimerEvent(t,15+5*level,false)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_CAST)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IJ3))
call SaveUnitHandle(LY,(handle_id),(14),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(hero,'A1J4')
call AddSkill(hero,'A1J3')
call AddSkill(hero,'A1J5')
call AddSkill(hero,'A1IU')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1J4',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1J3',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1J5',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1IU',false)
set t=null
set target=null
set hero=null
endfunction
function IL3 takes nothing returns boolean
if GetSpellAbilityId()=='A07A' then
call IK3()
endif
return false
endfunction
function WQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IL3))
set t=null
endfunction
function IM3 takes unit hero,unit WNO,unit IN3,integer level,boolean IS3 returns real
local unit dummy
local real IT3=QLI(WNO,IN3)
if IS3==false then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(WNO),GetUnitY(WNO),0)
call AddSkill(dummy,'A004')
call SetUnitAbilityLevel(dummy,'A004',level)
call IssueTargetOrder(dummy,"thunderbolt",IN3)
set dummy=null
endif
return IT3/1000
endfunction
function IR3 takes nothing returns boolean
if IsUnitInGroup(GetFilterUnit(),B1I)==false then
if GetUnitAbilityLevel(GetFilterUnit(),'B00L')>0 then
return true
endif
endif
return false
endfunction
function IP3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit WNO=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IN3
local real M5I
local group PR2=(LoadGroupHandle(LY,(handle_id),(22)))
local group g
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set g=NTI()
set B1I=PR2
call GroupEnumUnitsInRange(g,GetUnitX(WNO),GetUnitY(WNO),900,Condition(function IR3))
set IN3=GroupPickRandomUnit(g)
call NSI(g)
if IN3!=null then
set M5I=IM3(hero,WNO,IN3,level,false)
call GroupAddUnit(PR2,IN3)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(17),(IN3))
call SaveGroupHandle(LY,(handle_id),(22),(PR2))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function IP3))
else
call NSI(PR2)
endif
set t=null
set hero=null
set WNO=null
set IN3=null
set g=null
set PR2=null
return false
endfunction
function IQ3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit IU3=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A004')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real M5I=IM3(SFI,SFI,IU3,level,true)
local group g=NTI()
call GroupAddUnit(g,IU3)
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveUnitHandle(LY,(handle_id),(17),(IU3))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function IP3))
set SFI=null
set IU3=null
set t=null
endfunction
function O03 takes nothing returns boolean
if GetUnitAbilityLevel(GetTriggerUnit(),'A04R')==0 and GetSpellAbilityId()=='A004' and CanResistSkill(GetSpellTargetUnit())==false then
call IQ3()
endif
return false
endfunction
function WP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O03))
set t=null
endfunction
constant function Warpath_AbilityCode takes nothing returns integer
return 'A0FV'
endfunction
constant function Warpath_EffectCode takes nothing returns integer
return 'A0EF'
endfunction
constant function Warpath_SprayCode takes nothing returns integer
return 'A0GP'
endfunction
constant function Warpath_GooCode takes nothing returns integer
return 'A0FW'
endfunction
function OI3 takes nothing returns boolean
return GetSpellAbilityId()==('A0GP')or GetSpellAbilityId()==('A0FW')
endfunction
function O13 takes integer level,integer a returns integer
if a==0 then
return 1
else
if level==1 then
return a+1
elseif level==2 then
return a+6
elseif level==3 then
return a+12
endif
endif
return 1
endfunction
function OO3 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='e00X'
endfunction
function O23 takes nothing returns nothing
call RemoveUnit(GetEnumUnit())
endfunction
function O33 takes player p returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,p,Condition(function OO3))
call ForGroup(g,function O23)
call NSI(g)
set g=null
endfunction
function O43 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local unit SFI=(LoadUnitHandle(LY,(GetHandleId(t)),(14)))
local integer handle_id=GetHandleId(SFI)
local integer level=GetUnitAbilityLevel(SFI,('A0FV'))
local integer O53=(LoadInteger(LY,(handle_id),(315)))-1
local integer O63=QBI(O53,0,4+level)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(316)))
local integer O73
if level==1 then
set O73=O63*20
elseif level==2 then
set O73=O63*25
elseif level==3 then
set O73=O63*30
endif
if O53==0 then
set O73=0
endif
call G21(SFI,O73)
if GetUnitTypeId(dummy)=='e00X' then
call SetUnitAbilityLevel(dummy,('A0EF'),O13(level,O63))
call SaveInteger(LY,(handle_id),(315),(O53))
else
call O33((LoadPlayerHandle(LY,(GetHandleId(t)),(54))))
endif
call FlushChildHashtable(LY,(GetHandleId(t)))
call FlushTrigger(t)
set t=null
set SFI=null
set dummy=null
return false
endfunction
function O83 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(316)))
local integer level=GetUnitAbilityLevel(SFI,('A0FV'))
local integer O53=(LoadInteger(LY,(handle_id),(315)))+1
local integer O63=QBI(O53,0,4+level)
local integer O93=O13(level,O63)
local trigger t=CreateTrigger()
local integer O73
if level==1 then
set O73=O63*20
elseif level==2 then
set O73=O63*25
elseif level==3 then
set O73=O63*30
endif
call G21(SFI,O73)
call SetUnitAbilityLevel(dummy,('A0EF'),O93)
call SaveInteger(LY,(handle_id),(315),(O53))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
call SavePlayerHandle(LY,(GetHandleId(t)),(54),(GetOwningPlayer(SFI)))
call TriggerRegisterTimerEvent(t,14,false)
call TriggerAddCondition(t,Condition(function O43))
set t=null
endfunction
function OA3 takes nothing returns boolean
return GetLearnedSkill()==('A0FV')and GetUnitAbilityLevel(GetTriggerUnit(),('A0FV'))==1 and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function OB3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,('A0FV'))
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00X',0,0,0)
local trigger t=CreateTrigger()
call AddSkill(dummy,('A0EF'))
call SaveUnitHandle(LY,(GetHandleId(SFI)),(316),(dummy))
call SetUnitInvulnerable(dummy,true)
call AddSkill(dummy,'Aloc')
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OI3))
call TriggerAddAction(t,function O83)
endfunction
function WU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OA3))
call TriggerAddAction(t,function OB3)
call Q1I(('A0EF'))
endfunction
function OC3 takes nothing returns boolean
return GetSpellAbilityId()=='A0GP'
endfunction
function OD3 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')!=1
endfunction
function OE3 takes nothing returns nothing
local integer OF3=GetHandleId(GetEnumUnit())
local integer OG3=(LoadInteger(LY,(BOI),(OF3)))
local integer level=GetUnitAbilityLevel(XO,'A0GP')
local real PAI=QCI(JO+OG3*(28+2*level),400)
call UnitDamageTarget(XO,GetEnumUnit(),PAI,false,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
call SaveInteger(LY,(BOI),(OF3),(OG3+1))
endfunction
function OH3 takes nothing returns nothing
local integer OF3=GetHandleId(GetEnumUnit())
local integer OG3=(LoadInteger(LY,(BOI),(OF3)))
call SaveInteger(LY,(BOI),(OF3),(OG3-1))
endfunction
function OZ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit PKI=(LoadUnitHandle(LY,(handle_id),(221)))
local group Z51=(LoadGroupHandle(LY,(handle_id),(317)))
set BOI=GetHandleId(PKI)
call ForGroup(Z51,function OH3)
call NSI(Z51)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function OV3 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local group Z51=NTI()
local trigger t=CreateTrigger()
if IsUnitType(PKI,UNIT_TYPE_HERO)==false then
set PKI=K1[GetPlayerId(GetOwningPlayer(PKI))]
endif
call GroupEnumUnitsInRange(Z51,GetUnitX(PKI),GetUnitY(PKI),650,Condition(function OD3))
set XO=CreateUnit(GetOwningPlayer(PKI),'e00E',GetUnitX(PKI),GetUnitY(PKI),0)
set JO=GetUnitAbilityLevel(PKI,'A0GP')*20
set BOI=GetHandleId(PKI)
call ForGroup(Z51,function OE3)
call SaveUnitHandle(LY,(GetHandleId(t)),(221),(PKI))
call SaveGroupHandle(LY,(GetHandleId(t)),(317),(Z51))
call TriggerRegisterTimerEvent(t,14,false)
call TriggerAddCondition(t,Condition(function OZ3))
set t=null
endfunction
function X11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OC3))
call TriggerAddAction(t,function OV3)
endfunction
function OW3 takes nothing returns boolean
return GetSpellAbilityId()=='A0FW' and CanResistSkill(GetSpellTargetUnit())==false
endfunction
function Trig_Goo_Func001Func001001002 takes nothing returns boolean
return(GetUnitTypeId(GetFilterUnit())=='e02E')
endfunction
function OX3 takes nothing returns nothing
call KillUnit(GetEnumUnit())
endfunction
function OY3 takes nothing returns boolean
return(GetUnitTypeId(GetFilterUnit())=='e02E')
endfunction
function OJ3 takes nothing returns boolean
if(not(GetUnitUserData(GetEnumUnit())==4))then
return false
endif
return true
endfunction
function OK3 takes nothing returns nothing
local location BFO=GetUnitLoc(GetTriggerUnit())
call SetUnitPositionLoc(GetEnumUnit(),BFO)
if(OJ3())then
call IssueTargetOrder(GetEnumUnit(),"acidbomb",GetSpellTargetUnit())
else
call IncUnitAbilityLevel(GetEnumUnit(),'A0FZ')
call IssueTargetOrder(GetEnumUnit(),"acidbomb",GetSpellTargetUnit())
call SetUnitUserData(GetEnumUnit(),(GetUnitUserData(GetEnumUnit())+1))
endif
call RemoveLocation(BFO)
endfunction
function OL3 takes nothing returns nothing
local location BFO=GetUnitLoc(GetTriggerUnit())
local location OM3=GetUnitLoc(GetSpellTargetUnit())
local group ON3=NTI()
if(UnitHasBuffBJ(GetSpellTargetUnit(),'B02U')==true)then
call GroupEnumUnitsOfPlayer(ON3,GetOwningPlayer(GetSpellTargetUnit()),Condition(function OY3))
call ForGroupBJ(ON3,function OK3)
else
call GroupEnumUnitsOfPlayer(ON3,GetOwningPlayer(GetSpellTargetUnit()),Condition(function OY3))
call ForGroupBJ(ON3,function OX3)
call DisableTrigger(GH)
call CreateNUnitsAtLocFacingLocBJ(1,'e02E',GetOwningPlayer(GetSpellTargetUnit()),BFO,OM3)
call EnableTrigger(GH)
call UnitAddAbility(bj_lastCreatedUnit,'A0FZ')
call SetUnitAbilityLevelSwapped('A0FZ',bj_lastCreatedUnit,((GetUnitAbilityLevelSwapped('A0FW',GetTriggerUnit())*4)-3))
call IssueTargetOrder(bj_lastCreatedUnit,"acidbomb",GetSpellTargetUnit())
call SetUnitUserData(bj_lastCreatedUnit,1)
endif
call NSI(ON3)
call RemoveLocation(BFO)
call RemoveLocation(OM3)
endfunction
function X01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OW3))
call TriggerAddAction(t,function OL3)
endfunction
function OS3 takes nothing returns boolean
return GetLearnedSkill()=='A0M3' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function OT3 takes nothing returns boolean
if(IsUnitType(GetEventDamageSource(),UNIT_TYPE_STRUCTURE)==true)then
return false
endif
return true
endfunction
function OR3 takes unit SFI returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
call AddSkill(dummy,'A0GP')
call SetUnitAbilityLevel(dummy,'A0GP',GetUnitAbilityLevel(SFI,'A0GP'))
call IssueImmediateOrder(dummy,"fanofknives")
set dummy=null
endfunction
function OP3 takes unit SFI,real PAI returns nothing
local integer handle_id=GetHandleId(SFI)
local real E01=(LoadReal(LY,(handle_id),(278)))
if E01+PAI>250 then
call SaveReal(LY,(handle_id),(278),((0)*1.0))
call OR3(SFI)
else
call SaveReal(LY,(handle_id),(278),((E01+PAI)*1.0))
endif
endfunction
function OQ3 takes nothing returns nothing
local unit OU3=GetTriggerUnit()
local unit Z4O=GetEventDamageSource()
local real A03=UDI(Z4O,OU3)
local real AI3=GetUnitFacing(OU3)
local real A13
local real PAI=GetEventDamage()
local real AO3
local real RM2
if(PAI>5)and GetUnitState(OU3,UNIT_STATE_LIFE)>1 and GetUnitAbilityLevel(OU3,'BNdo')==0 then
if((AI3-A03)<(-180.00))then
set A13=(AI3-A03+360)
else
if((AI3-A03)>180.00)then
set A13=(AI3-A03-360)
else
set A13=(AI3-A03)
endif
endif
set RM2=RAbsBJ(A13)
if RM2<=70 then
set AO3=(GetUnitAbilityLevel(OU3,'A0M3')*0.08+0.08)*PAI
call OP3(OU3,PAI-AO3)
call SetUnitState(OU3,UNIT_STATE_LIFE,GetUnitState(OU3,UNIT_STATE_LIFE)+AO3)
elseif RM2<=110 then
set AO3=(GetUnitAbilityLevel(OU3,'A0M3')*0.04+0.04)*PAI
call SetUnitState(OU3,UNIT_STATE_LIFE,GetUnitState(OU3,UNIT_STATE_LIFE)+AO3)
endif
endif
set OU3=null
set Z4O=null
endfunction
function A23 takes nothing returns nothing
local trigger t
if GetUnitAbilityLevel(GetTriggerUnit(),'A0M3')==1 then
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function OT3))
call TriggerAddAction(t,function OQ3)
endif
endfunction
function XI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OS3))
call TriggerAddAction(t,function A23)
endfunction
function A33 takes nothing returns boolean
return GetUnitAbilityLevel(GetTriggerUnit(),'A00V')>0 and GetUnitAbilityLevel(GetAttacker(),'A04R')!=1 and IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))==false and GetUnitTypeId(GetAttacker())!='n0F5'
endfunction
function A43 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetAttacker()
local integer level=GetUnitAbilityLevel(hero,'A00V')
local integer A53=GetHeroStr(hero,true)
local real PAI=(14+2*level)+(0.18+0.08*level)*A53
call Damage(hero,target,2,PAI)
set hero=null
set target=null
endfunction
function X21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function A33))
call TriggerAddAction(t,function A43)
endfunction
function A63 takes nothing returns nothing
call Damage(B2I,GetEnumUnit(),1,B3I)
endfunction
function A73 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2ON')
local real A83
local group g=NTI()
set B3I=100+level*75
set B2I=hero
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),190+25,Condition(function CE1))
call ForGroup(g,function A63)
set A83=B3I
if GetUnitState(hero,UNIT_STATE_LIFE)<=A83*0.75 then
set A83=GetUnitState(hero,UNIT_STATE_LIFE)/0.75-10
endif
call Damage(hero,hero,1,A83)
call DestroyEffect(AddSpecialEffect("war3mapImported\\DoubleEdgeTarget.mdx",GetUnitX(target),GetUnitY(target)))
set hero=null
set target=null
endfunction
function A93 takes nothing returns boolean
if GetSpellAbilityId()=='A2ON' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call A73()
else
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\DoubleEdgeCaster.mdx",GetTriggerUnit(),"hand, right"))
endif
endif
return false
endfunction
function XO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function A93))
set t=null
endfunction
function AA3 takes nothing returns nothing
local integer AB3
if RKI(GetEnumUnit())==false and((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4332))))==1)==false then
call SCI(GetEnumUnit(),4332,3.75)
set AB3=B6I
call Damage(B5I,GetEnumUnit(),1,(AB3)*GetHeroStr(B4I,true))
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A2OK',false)
call AddSkill(GetEnumUnit(),'A2OK')
call AX1(GetEnumUnit(),'A2OK',1,1.5,'B0GF')
endif
endfunction
function AC3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g
if GetTriggerEvalCount(t)>=R2I(20*3.75)or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitPathing(hero,true)
call UnitRemoveAbility(hero,'A2O4')
call UnitRemoveAbility(hero,'B0GB')
else
set g=NTI()
set GK=hero
set B4I=dummy
set B5I=hero
set B6I=level
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),105+25,Condition(function CA1))
call ForGroup(g,function AA3)
call NSI(g)
endif
set t=null
set hero=null
set g=null
return false
endfunction
function AD3 takes nothing returns nothing
local unit hero=GetEnumUnit()
local integer level=GetUnitAbilityLevel(B4I,'A2O6')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitPathing(hero,false)
call AddSkill(hero,'A2O4')
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function AC3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(B4I))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\SandBreathDamageSmall.mdx",hero,"foot, left")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\SandBreathDamageSmall.mdx",hero,"foot, right")))
set hero=null
set t=null
endfunction
function AE3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=NTI()
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set B4I=hero
set GK=hero
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function CN1))
call ForGroup(g,function AD3)
call NSI(g)
set t=null
set hero=null
set g=null
return false
endfunction
function AF3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local sound PGI=CreateSound("abilities\\Spells\\Other\\Stampede\\StampedeCaster1.wav",false,false,false,10,10,"DefaultEAXON")
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call StartSound(PGI)
call KillSoundWhenDone(PGI)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function AE3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set PGI=null
endfunction
function AG3 takes nothing returns boolean
if GetSpellAbilityId()=='A2O6' then
call AF3()
endif
return false
endfunction
function X31 takes nothing returns nothing
local trigger t=CreateTrigger()
call Q1I('A2O4')
call Q1I('A0X6')
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AG3))
call CreateSound("abilities\\Spells\\Other\\Stampede\\StampedeCaster1.wav",false,false,false,10,10,"DefaultEAXON")
set t=null
endfunction
function AH3 takes nothing returns boolean
return GetSpellAbilityId()=='A0LV' or GetSpellAbilityId()=='A2MC'
endfunction
function AZ3 takes nothing returns boolean
if(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false)then
if(IsUnitAliveBJ(GetFilterUnit()))then
if RYI(GetFilterUnit())==false then
if(GetUnitTypeId(GetFilterUnit())!='ncop')then
if(GetUnitAbilityLevel(GetFilterUnit(),'Aeth')==1)then
if((GetUnitAbilityLevel(GetFilterUnit(),'A0KO')==1)or(GetUnitAbilityLevel(GetFilterUnit(),'A0KQ')==1)or(GetUnitAbilityLevel(GetFilterUnit(),'A0KR')==1)or(GetUnitAbilityLevel(GetFilterUnit(),'A0KP')==1))then
return true
endif
endif
endif
endif
endif
endif
return false
endfunction
function AV3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit AW3=(LoadUnitHandle(LY,(handle_id),(2)))
local unit u=(LoadUnitHandle(LY,(handle_id),(26)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local boolean AX3=(LoadBoolean(LY,(handle_id),(95)))
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if E31(GetSpellAbilityId())and GetSpellTargetUnit()==u then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set AW3=null
set u=null
endif
return false
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
if(LoadBoolean(LY,(GetHandleId(u)),(80)))==false and GetUnitAbilityLevel(u,'A04R')==0 then
call SCI(u,4409,1)
if AX3 then
call SetUnitPosition(u,GetUnitX(AW3),GetUnitY(AW3))
else
call SetUnitPosition(u,x,y)
endif
endif
if(LoadBoolean(LY,(GetHandleId(u)),(80)))==true then
call PZI(GetOwningPlayer(AW3),"不能传送至正在使用雷电牵引的单位")
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set AW3=null
set u=null
return false
endfunction
function AY3 takes unit u,unit AJ3,integer AK3,real x,real y,boolean AX3 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if IsUnitOwnedByPlayer(u,GetOwningPlayer(AJ3))and AX3==false then
call TriggerRegisterTimerEvent(t,0.1,false)
else
call TriggerRegisterTimerEvent(t,7-AK3,false)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
endif
call TriggerAddCondition(t,Condition(function AV3))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\Test_of_Faith_FX.mdx",u,"overhead")))
call SaveUnitHandle(LY,(handle_id),(26),(u))
call SaveUnitHandle(LY,(handle_id),(2),(AJ3))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveBoolean(LY,(handle_id),(95),(AX3))
set t=null
endfunction
function AL3 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local unit AW3=GetTriggerUnit()
local location BFO=GetUnitLoc(AW3)
local unit dummy
local integer AK3=GetUnitAbilityLevel(AW3,'A0LV')
local real DH1
local group Z51
local unit GB2
local location AM3
local effect fx
if(IsPlayerTeam1(GetOwningPlayer(AW3)))then
set AM3=GetRectCenter(O4)
else
set AM3=GetRectCenter(S3)
endif
if target==AW3 then
set Z51=NTI()
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(AW3),Condition(function AZ3))
loop
exitwhen CountUnitsInGroup(Z51)==0
set GB2=GroupPickRandomUnit(Z51)
call GroupRemoveUnit(Z51,GB2)
call AY3(GB2,AW3,AK3,GetLocationX(AM3),GetLocationY(AM3),true)
endloop
call NSI(Z51)
elseif(IsUnitAlly(target,GetOwningPlayer(AW3))==false)then
if CanResistSkill(GetSpellTargetUnit())==false then
set DH1=GetRandomInt(50*AK3,100*AK3)
call UYI(I2S(R2I(DH1)),1,target,0.023,255,255,0,216)
call UnitDamageTargetBJ(AW3,target,DH1,ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC)
set fx=AddSpecialEffectTargetUnitBJ("chest",target,"Abilities\\Spells\\Human\\HolyBolt\\HolyBoltSpecialArt.mdl")
call DestroyEffect(fx)
endif
else
if(IsUnitType(target,UNIT_TYPE_HERO)==true)then
if((LoadBoolean(LY,(GetHandleId(GetOwningPlayer(target))),(139)))==false)then
call AY3(target,AW3,AK3,GetLocationX(AM3),GetLocationY(AM3),false)
endif
elseif(IsUnitOwnedByPlayer(target,GetOwningPlayer(AW3))==true)then
call SetUnitPositionLoc(target,AM3)
endif
endif
call RemoveLocation(BFO)
call RemoveLocation(AM3)
endfunction
function AN3 takes nothing returns boolean
if GetLearnedSkill()=='A0LV' and IsUnitIllusion(GetTriggerUnit())==false then
call AddSkill(GetTriggerUnit(),'A2MC')
call SetUnitAbilityLevel(GetTriggerUnit(),'A2MC',GetUnitAbilityLevel(GetTriggerUnit(),'A0LV'))
endif
return false
endfunction
function X71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AH3))
call TriggerAddAction(t,function AL3)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function AN3))
endfunction
function AS3 takes nothing returns boolean
if(not(GetSpellAbilityId()=='A069'))then
return false
endif
return true
endfunction
function AT3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit AW3=(LoadUnitHandle(LY,(handle_id),(2)))
local integer AR3=(LoadInteger(LY,(handle_id),(157)))
local group Z51=NTI()
local unit GB2
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(AW3),Condition(function AZ3))
loop
exitwhen(CountUnitsInGroup(Z51)<=AR3)
set GB2=GroupPickRandomUnit(Z51)
call GroupRemoveUnit(Z51,GB2)
call KillUnit(GB2)
endloop
call NSI(Z51)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set AW3=null
set t=null
set Z51=null
set GB2=null
return false
endfunction
function AP3 takes nothing returns nothing
local unit AQ3=GetSpellTargetUnit()
local unit AW3=GetTriggerUnit()
local integer AK3=GetUnitAbilityLevel(AW3,'A069')
local integer AR3=1
local integer playerid=GetPlayerId(GetOwningPlayer(AW3))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call QSI(AQ3)
if(AK3==1)then
set AR3=1
call AddSkill(AQ3,'A0KO')
endif
if(AK3==2)then
set AR3=2
call AddSkill(AQ3,'A0KQ')
endif
if(AK3==3)then
set AR3=3
call AddSkill(AQ3,'A0KR')
endif
if(AK3==4)then
set AR3=4
call AddSkill(AQ3,'A0KP')
endif
call AddSkill(AQ3,'Aeth')
call AddSkill(AQ3,'A12G')
call SaveUnitHandle(LY,(handle_id),(2),(AW3))
call SaveInteger(LY,(handle_id),(157),(AR3))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function AT3))
set t=null
set AQ3=null
set AW3=null
endfunction
function AU3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
local real x
local real y
local integer level=GetUnitAbilityLevel(hero,'A28T')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2YN')
endif
if IsUnitEnemy(target,GetOwningPlayer(hero))then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A069')
call SetUnitAbilityLevel(dummy,'A069',level)
call IssueTargetOrder(dummy,"charm",target)
else
if IsPlayerTeam1(GetOwningPlayer(hero))then
set x=GetRectCenterX(O4)
set y=GetRectCenterY(O4)
else
set x=GetRectCenterX(S3)
set y=GetRectCenterY(S3)
endif
if(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(target))),(139)))==false then
call AY3(target,hero,level,x,y,false)
endif
endif
set hero=null
set target=null
set dummy=null
endfunction
function B03 takes nothing returns boolean
if(GetSpellAbilityId()=='A28T' or GetSpellAbilityId()=='A2YN')and CanResistSkill(GetSpellTargetUnit())==false then
call AU3()
endif
return false
endfunction
function BI3 takes nothing returns boolean
if GetSpellAbilityId()=='A28T' then
if IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true then
if IsUnitType(GetSpellTargetUnit(),UNIT_TYPE_HERO)==true or IsUnitIllusion(GetSpellTargetUnit())then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"非法目标")
endif
endif
endif
return false
endfunction
function X61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AS3))
call TriggerAddAction(t,function AP3)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function BI3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function B03))
set t=null
endfunction
function B13 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real BO3
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>10 then
set BO3=GetEventDamage()*(0.1+0.04*level)
call DisableTrigger(t)
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,BO3)
call EnableTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function B23 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A0KM')
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\HolyBolt\\HolyBoltSpecialArt.mdl",hero,"chest"))
call SaveInteger(LY,(handle_id),(5),(level))
call TriggerRegisterTimerEvent(t,4+level,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function B13))
set t=null
set target=null
set hero=null
endfunction
function B33 takes nothing returns boolean
if GetSpellAbilityId()=='A0KM' then
call B23()
endif
return false
endfunction
function X41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function B33))
set t=null
endfunction
function B43 takes nothing returns boolean
return GetSpellAbilityId()=='A0LT' or GetSpellAbilityId()=='A1CS'
endfunction
function B53 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1
endfunction
function B63 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local integer AK3=GetUnitAbilityLevel(PKI,'A0LT')
local group Z51=NTI()
local unit GB2
if AK3==0 then
set AK3=GetUnitAbilityLevel(PKI,'A1CS')
endif
call GroupEnumUnitsInRect(Z51,bj_mapInitialPlayableArea,Condition(function B53))
loop
set GB2=FirstOfGroup(Z51)
exitwhen GB2==null
if(IsUnitAlly(GB2,GetOwningPlayer(PKI))==true)then
call SetWidgetLife(GB2,(GetUnitStateSwap(UNIT_STATE_LIFE,GB2)+100+(100*AK3)))
call DestroyEffect(AddSpecialEffectTargetUnitBJ("chest",GB2,"Abilities\\Spells\\Human\\Resurrect\\ResurrectTarget.mdl"))
endif
call GroupRemoveUnit(Z51,GB2)
endloop
call NSI(Z51)
set Z51=NTI()
set bj_groupEnumOwningPlayer=GetOwningPlayer(PKI)
call GroupEnumUnitsInRect(Z51,GetWorldBounds(),filterGetUnitsInRectOfPlayer)
loop
set GB2=FirstOfGroup(Z51)
exitwhen GB2==null
if(IsUnitType(GB2,UNIT_TYPE_HERO)==false and GetUnitTypeId(GB2)!='n00C')then
call SetUnitLifePercentBJ(GB2,100)
call DestroyEffect(AddSpecialEffectTargetUnitBJ("chest",GB2,"Abilities\\Spells\\Human\\Resurrect\\ResurrectTarget.mdl"))
endif
call GroupRemoveUnit(Z51,GB2)
endloop
call NSI(Z51)
endfunction
function X51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function B43))
call TriggerAddAction(t,function B63)
endfunction
function B73 takes nothing returns nothing
if RYI(GetEnumUnit())==false then
call Damage(B8I,GetEnumUnit(),1,B7I)
endif
endfunction
function B83 takes unit hero,real x,real y returns nothing
local real x1
local real y1
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A0Z6')
local real PAI=40+40*level
set GK=hero
set B8I=hero
set B7I=PAI
call GroupEnumUnitsInRange(g,x,y,600,Condition(function CA1))
call ForGroup(g,function B73)
call NSI(g)
set x1=x
set y1=y
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x1,y1))
set x1=x+200
set y1=y+200
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x1,y1))
set x1=x+200
set y1=y-200
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x1,y1))
set x1=x-200
set y1=y+200
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x1,y1))
set x1=x-200
set y1=y-200
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x1,y1))
call I41(GetOwningPlayer(hero),10,x,y,600)
set g=null
endfunction
function B93 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local real IV1=PTI(QXI+30*Cos(RM2))
local real IW1=PUI(QYI+30*Sin(RM2))
local real BA3
local real BB3
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SaveReal(LY,(handle_id),(189),((IV1)*1.0))
call SaveReal(LY,(handle_id),(190),((IW1)*1.0))
if UTI(QJI,QKI,IV1,IW1)<=35 then
call KillUnit(IG1)
set SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call B83(SFI,IV1,IW1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
set IG1=null
return false
endfunction
function BC3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real QXI=PTI(GetUnitX(SFI))
local real QYI=PUI(GetUnitY(SFI))
local location AM3=GetSpellTargetLoc()
local real QJI=PTI(GetLocationX(AM3))
local real QKI=PUI(GetLocationY(AM3))
local real RM2=Atan2(QKI-QYI,QJI-QXI)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(SFI),'h03Y',QXI,QYI,RM2*bj_RADTODEG)
call RemoveLocation(AM3)
call SetUnitFacing(IG1,RM2*bj_RADTODEG)
call SetUnitPathing(IG1,false)
call AddSkill(IG1,'Aloc')
call ShowUnit(IG1,false)
call UnitRemoveAbility(IG1,'Aloc')
call ShowUnit(IG1,true)
call SaveReal(LY,(handle_id),(191),((QXI)*1.0))
call SaveReal(LY,(handle_id),(192),((QYI)*1.0))
call SaveReal(LY,(handle_id),(189),((QXI)*1.0))
call SaveReal(LY,(handle_id),(190),((QYI)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function B93))
set SFI=null
set AM3=null
set t=null
set IG1=null
endfunction
function BD3 takes nothing returns boolean
if GetSpellAbilityId()=='A0Z6' then
call BC3()
endif
return false
endfunction
function TE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BD3))
set t=null
endfunction
function BE3 takes real s,real d1,real d2,real d3 returns boolean
return s<=d1 and s<=d2 and s<=d3
endfunction
function BF3 takes unit u,real x,real y,real d returns real
local real x2=GetUnitX(u)
local real y2=GetUnitY(u)
local real BG3=QNI(x-d,y,x2,y2)
local real BH3=QNI(x+d,y,x2,y2)
local real BZ3=QNI(x,y+d,x2,y2)
local real BV3=QNI(x,y-d,x2,y2)
if BE3(BG3,BH3,BV3,BZ3)then
return 180.0
elseif BE3(BH3,BG3,BV3,BZ3)then
return 0.0
elseif BE3(BV3,BH3,BG3,BZ3)then
return 270.0
endif
return 90.0
endfunction
function BW3 takes real s,real d1,real d2,real d3,real d4,real d5,real d6,real d7 returns boolean
return s<=d1 and s<=d2 and s<=d3 and s<=d4 and s<=d5 and s<=d6 and s<=d7
endfunction
function BX3 takes unit u,integer handle_id returns unit
local real x1=GetUnitX(u)
local real y1=GetUnitY(u)
local unit BY3=(LoadUnitHandle(LY,(handle_id),(1100+1)))
local unit BJ3=(LoadUnitHandle(LY,(handle_id),(1100+2)))
local unit BK3=(LoadUnitHandle(LY,(handle_id),(1100+3)))
local unit BL3=(LoadUnitHandle(LY,(handle_id),(1100+4)))
local unit BM3=(LoadUnitHandle(LY,(handle_id),(1100+5)))
local unit BN3=(LoadUnitHandle(LY,(handle_id),(1100+6)))
local unit BS3=(LoadUnitHandle(LY,(handle_id),(1100+7)))
local unit BT3=(LoadUnitHandle(LY,(handle_id),(1100+8)))
local real d1=QNI(x1,y1,GetUnitX(BY3),GetUnitY(BY3))
local real d2=QNI(x1,y1,GetUnitX(BJ3),GetUnitY(BJ3))
local real d3=QNI(x1,y1,GetUnitX(BK3),GetUnitY(BK3))
local real d4=QNI(x1,y1,GetUnitX(BL3),GetUnitY(BL3))
local real d5=QNI(x1,y1,GetUnitX(BM3),GetUnitY(BM3))
local real d6=QNI(x1,y1,GetUnitX(BN3),GetUnitY(BN3))
local real d7=QNI(x1,y1,GetUnitX(BS3),GetUnitY(BS3))
local real d8=QNI(x1,y1,GetUnitX(BT3),GetUnitY(BT3))
if BW3(d1,d2,d3,d4,d5,d6,d7,d8)then
return BY3
elseif BW3(d2,d1,d3,d4,d5,d6,d7,d8)then
return BJ3
elseif BW3(d3,d2,d1,d4,d5,d6,d7,d8)then
return BK3
elseif BW3(d4,d2,d3,d1,d5,d6,d7,d8)then
return BL3
elseif BW3(d5,d2,d3,d4,d1,d6,d7,d8)then
return BM3
elseif BW3(d6,d2,d3,d4,d5,d1,d7,d8)then
return BN3
elseif BW3(d7,d2,d3,d4,d5,d6,d1,d8)then
return BS3
elseif BW3(d8,d2,d3,d4,d5,d6,d7,d1)then
return BT3
endif
return null
endfunction
function BR3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real RS2=12
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer BP3=40+40*level
if GetTriggerEvalCount(t)>21 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId((target))),((4260)),(2))
call Damage(hero,target,1,I2R(BP3))
call SetUnitState(target,UNIT_STATE_MANA,QDI(GetUnitState(target,UNIT_STATE_MANA)-BP3,0))
call UPI(GetUnitX(target),GetUnitY(target),100)
else
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",x,y))
call UPI(x,y,150)
if((LoadInteger(LY,(GetHandleId((target))),((4261))))==1)==false then
call SetUnitPosition(target,x+RS2*Cos(RM2*bj_DEGTORAD),y+RS2*Sin(RM2*bj_DEGTORAD))
endif
endif
set t=null
set target=null
return false
endfunction
function BQ3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetEnumUnit()
local real x=AK
local real y=BK
local real d=CK
local real RM2=BF3(target,x,y,d)
local real BU3=200
local real C03=d-QNI(GetUnitX(target),GetUnitY(target),x,y)+BU3/2
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",target,"chest"))
call SaveInteger(LY,(GetHandleId((target))),((4260)),(1))
if C03>0 then
call MUSetUnitX(target,GetUnitX(target)+C03*Cos(RM2*bj_DEGTORAD))
call MUSetUnitY(target,GetUnitY(target)+C03*Sin(RM2*bj_DEGTORAD))
endif
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveInteger(LY,(handle_id),(5),(UJ))
call SaveUnitHandle(LY,(handle_id),(2),(GK))
call TriggerRegisterTimerEvent(t,0.04,true)
call TriggerAddCondition(t,Condition(function BR3))
set t=null
set target=null
endfunction
function CI3 takes unit u,integer handle_id returns boolean
local unit C13=BX3(u,handle_id)
local boolean FB1=true
if IsUnitDead(C13)or(LoadInteger(LY,(GetHandleId(C13)),(156)))==1 then
set FB1=false
endif
call SaveInteger(LY,(GetHandleId(C13)),(156),(1))
call SetUnitVertexColor(C13,25,25,25,175)
set C13=null
return FB1
endfunction
function CO3 takes nothing returns nothing
if GetUnitState(GetEnumUnit(),UNIT_STATE_MANA)>0 and IsUnitInGroup(GetEnumUnit(),XK)==false and((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4260))))==1)==false and CI3(GetEnumUnit(),B9I)then
call SaveInteger(LY,(GetHandleId((GetEnumUnit()))),((4260)),(1))
call GroupAddUnit(YK,GetEnumUnit())
endif
endfunction
function C23 takes trigger t,unit SFI,real x,real y,real d,integer level returns nothing
local integer handle_id=GetHandleId(t)
local real BU3=200
local rect r1=Rect(x-d,y-d,x+d,y+d)
local rect r2=Rect(x-d-BU3,y-d-BU3,x+d+BU3,y+d+BU3)
local group g1=NTI()
local group g2=NTI()
local group g3=NTI()
set GK=SFI
call GroupEnumUnitsInRect(g1,r1,Condition(function CE1))
call GroupEnumUnitsInRect(g2,r2,Condition(function CE1))
set XK=g1
set YK=g3
set AK=x
set BK=y
set CK=d
set B9I=handle_id
call ForGroup(g2,function CO3)
set UJ=level
call ForGroup(g3,function BQ3)
call NSI(g1)
call NSI(g2)
call NSI(g3)
call RemoveRect(r1)
call RemoveRect(r2)
set g1=null
set g2=null
set g3=null
set r1=null
set r2=null
endfunction
function C33 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local boolean C43=(LoadBoolean(LY,(handle_id),(155)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if C43 then
call I41(p,.2,x,y,500)
endif
set t=null
set p=null
return false
endfunction
function C53 takes unit C63 returns nothing
local real x=GetUnitX(C63)
local real y=GetUnitY(C63)
local player p=GetOwningPlayer(C63)
local unit dummy=CreateUnit(p,'u00W',x,y,0)
call KillUnit(dummy)
set p=null
set dummy=null
endfunction
function C73 takes integer handle_id,real x,real y,boolean C43,player p returns nothing
local unit BY3=(LoadUnitHandle(LY,(handle_id),(1100+1)))
local unit BJ3=(LoadUnitHandle(LY,(handle_id),(1100+2)))
local unit BK3=(LoadUnitHandle(LY,(handle_id),(1100+3)))
local unit BL3=(LoadUnitHandle(LY,(handle_id),(1100+4)))
local unit BM3=(LoadUnitHandle(LY,(handle_id),(1100+5)))
local unit BN3=(LoadUnitHandle(LY,(handle_id),(1100+6)))
local unit BS3=(LoadUnitHandle(LY,(handle_id),(1100+7)))
local unit BT3=(LoadUnitHandle(LY,(handle_id),(1100+8)))
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.1,false)
call TriggerAddCondition(t,Condition(function C33))
call SaveReal(LY,(GetHandleId(t)),(6),((x)*1.0))
call SaveReal(LY,(GetHandleId(t)),(7),((y)*1.0))
call SavePlayerHandle(LY,(GetHandleId(t)),(54),(p))
call SaveBoolean(LY,(GetHandleId(t)),(155),(C43))
set BAI=true
call C53(BY3)
call RemoveUnit(BY3)
call C53(BJ3)
call RemoveUnit(BJ3)
call C53(BK3)
call RemoveUnit(BK3)
call C53(BL3)
call RemoveUnit(BL3)
call C53(BM3)
call RemoveUnit(BM3)
call C53(BN3)
call RemoveUnit(BN3)
call C53(BS3)
call RemoveUnit(BS3)
call C53(BT3)
call RemoveUnit(BT3)
set BY3=null
set BJ3=null
set BK3=null
set BL3=null
set BM3=null
set BN3=null
set BS3=null
set BT3=null
endfunction
function PowerCog_DeathBurn takes nothing returns nothing
local integer BP3=(40+40*BCI)/2
call Damage(BBI,GetEnumUnit(),1,I2R(BP3))
call SetUnitState(GetEnumUnit(),UNIT_STATE_MANA,QDI(GetUnitState(GetEnumUnit(),UNIT_STATE_MANA)-BP3,0))
endfunction
function C83 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit C63=(LoadUnitHandle(LY,(handle_id),(19)))
local group g
if BAI==false then
set g=NTI()
set GK=C63
set BBI=C63
call GroupEnumUnitsInRange(g,GetUnitX(C63),GetUnitY(C63),175+25,Condition(function CE1))
call NSI(g)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set g=null
set C63=null
return false
endfunction
function C93 takes unit C63,integer handle_id,integer MLI,player p returns nothing
local trigger t=CreateTrigger()
local integer KAO=GetHandleId(t)
call TriggerRegisterDeathEvent(t,C63)
call SaveUnitHandle(LY,(KAO),(19),(C63))
call TriggerAddCondition(t,Condition(function C83))
if IsUnitVisible(C63,p)then
call SaveBoolean(LY,(handle_id),(155),(true))
endif
call SaveUnitHandle(LY,(handle_id),(1100+MLI),(C63))
endfunction
function CA3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real DC1=(LoadReal(LY,(handle_id),(57)))
local integer NPI=GetTriggerEvalCount(t)
if NPI>R2I(DC1*100)then
call C73(handle_id,(LoadReal(LY,(handle_id),(6))),(LoadReal(LY,(handle_id),(7))),(LoadBoolean(LY,(handle_id),(155))),(LoadPlayerHandle(LY,(handle_id),(154))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call C23(t,(LoadUnitHandle(LY,(handle_id),(14))),(LoadReal(LY,(handle_id),(6))),(LoadReal(LY,(handle_id),(7))),(LoadReal(LY,(handle_id),(138))),(LoadInteger(LY,(handle_id),(5))))
endif
set t=null
return false
endfunction
function CB3 takes nothing returns nothing
call MUSetUnitX(GetEnumUnit(),GetUnitX(GK))
call MUSetUnitY(GetEnumUnit(),GetUnitY(GK))
endfunction
function CC3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=GetUnitAbilityLevel(SFI,'A0Z5')
local integer ID='u00S'
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real x2
local real y2
local real d=125
local unit C63
local real DC1=4+level
local real BufferDuration=5
local group g
local rect CD3
local player VE2
local integer HP=2
if level==4 then
set HP=3
endif
set BCI=level
set BAI=false
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set VE2=CO[0]
else
set VE2=BO[0]
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveBoolean(LY,(handle_id),(155),(false))
set x2=x1+d
set y2=y1
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,1,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1+d
set y2=y1+d
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,2,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1
set y2=y1+d
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,3,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1-d
set y2=y1+d
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,4,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1-d
set y2=y1
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,5,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1-d
set y2=y1-d
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,6,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1
set y2=y1-d
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,7,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
set x2=x1+d
set y2=y1-d
set C63=CreateUnit(GetOwningPlayer(SFI),ID,x2,y2,0)
call SetUnitPosition(C63,x2,y2)
call C93(C63,handle_id,8,VE2)
call SetUnitState(C63,UNIT_STATE_LIFE,HP)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerAddCondition(t,Condition(function CA3))
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
call SaveReal(LY,(handle_id),(6),((x1)*1.0))
call SaveReal(LY,(handle_id),(7),((y1)*1.0))
call SaveReal(LY,(handle_id),(138),((d)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(5),(level))
call SavePlayerHandle(LY,(handle_id),(154),(VE2))
set d=d+110
set g=NTI()
set CD3=Rect(x1-d,y1-d,x1+d,y1+d)
set GK=SFI
call GroupEnumUnitsInRect(g,CD3,Condition(function DO1))
call ForGroup(g,function CB3)
call NSI(g)
set t=null
set g=null
set SFI=null
set C63=null
set CD3=null
set VE2=null
return false
endfunction
function CE3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.1,false)
call TriggerAddCondition(t,Condition(function CC3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
set SFI=null
endfunction
function CF3 takes nothing returns boolean
if GetSpellAbilityId()=='A0Z5' then
call CE3()
endif
return false
endfunction
function TD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CF3))
set t=null
set BAI=false
endfunction
function CG3 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=GetUnitAbilityLevel(hero,'A0Z8')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1CV')
endif
call AddSkill(dummy,'A0Z9')
call SetUnitAbilityLevel(dummy,'A0Z9',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=null
endfunction
function CH3 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false then
call GroupAddUnit(XK,GetEnumUnit())
call CG3(GK,GetEnumUnit())
endif
endfunction
function CZ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer CV3=(LoadInteger(LY,(handle_id),(18)))
local integer NPI=GetTriggerEvalCount(t)
local unit CW3
local group CX3=(LoadGroupHandle(LY,(handle_id),(16)))
local group g
local real CY3=200
if target==null then
set CW3=(LoadUnitHandle(LY,(handle_id),(700+CV3+1-NPI)))
call RemoveUnit(CW3)
else
set CW3=(LoadUnitHandle(LY,(handle_id),(700+NPI)))
call MUSetUnitX(SFI,GetUnitX(CW3))
call MUSetUnitY(SFI,GetUnitY(CW3))
call RemoveUnit(CW3)
if NPI==CV3 then
set CY3=225
endif
set g=NTI()
set GK=SFI
set XK=CX3
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),CY3,Condition(function CD1))
call ForGroup(g,function CH3)
call NSI(g)
endif
if NPI==(CV3)then
if target!=null then
call PauseUnit(target,false)
endif
call UPI(GetUnitX(SFI),GetUnitY(SFI),100)
call NSI(CX3)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
set target=null
set CW3=null
set CX3=null
set g=null
return false
endfunction
function CJ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local integer MKO=(LoadInteger(LY,(handle_id),(12)))
local integer NPI=GetTriggerEvalCount(t)
local real x=GetUnitX(SFI)+NPI*50*Cos(RM2*bj_DEGTORAD)
local real y=GetUnitY(SFI)+NPI*50*Sin(RM2*bj_DEGTORAD)
local boolean CK3=(LoadBoolean(LY,(handle_id),(15)))
local unit CL3
local trigger CM3=(LoadTriggerHandle(LY,(handle_id),(11)))
local integer CN3=GetHandleId(CM3)
local group g=NTI()
local unit target=null
local integer ID='u00V'
local real CY3=125
if NPI==1 then
set CY3=100
endif
set GK=SFI
call GroupEnumUnitsInRange(g,x,y,CY3,Condition(function C21))
call GroupRemoveUnit(g,SFI)
set target=GroupPickRandomUnit(g)
call NSI(g)
if target!=null or NPI==MKO or NPI==(MKO-1)or NPI==(MKO-2)then
set ID='u00U'
endif
set CL3=CreateUnit(GetOwningPlayer(SFI),ID,x,y,RM2)
call SaveUnitHandle(LY,(CN3),(700+NPI),(CL3))
if target!=null then
if(IsUnitAlly(target,GetOwningPlayer(SFI))==true and CK3==false)or((LoadInteger(LY,(GetHandleId((target))),((4259))))==1)==true then
set target=null
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if target!=null and IsUnitAlly(target,GetOwningPlayer(SFI))==false then
call PauseUnit(target,true)
endif
call TriggerRegisterTimerEvent(CM3,0.5/MKO,true)
call TriggerAddCondition(CM3,Condition(function CZ3))
call SaveInteger(LY,(CN3),(18),(NPI))
call SaveUnitHandle(LY,(CN3),(17),(target))
call SaveUnitHandle(LY,(CN3),(14),(SFI))
call SaveGroupHandle(LY,(CN3),(16),(NTI()))
elseif NPI>MKO then
set target=null
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call TriggerRegisterTimerEvent(CM3,0.5/MKO,true)
call TriggerAddCondition(CM3,Condition(function CZ3))
call SaveInteger(LY,(CN3),(18),(NPI))
call SaveUnitHandle(LY,(CN3),(17),(target))
call SaveUnitHandle(LY,(CN3),(14),(SFI))
call SaveGroupHandle(LY,(CN3),(16),(NTI()))
endif
set t=null
set SFI=null
set CL3=null
set CM3=null
set g=null
set target=null
return false
endfunction
function CS3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real RM2=UEI(GetUnitX(SFI),GetUnitY(SFI),GetLocationX(point),GetLocationY(point))
local integer level=GetUnitAbilityLevel(SFI,'A0Z8')
local integer CT3
local integer MKO
local boolean CK3=true
local trigger CR3=CreateTrigger()
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A1CV')
set CK3=true
endif
set CT3=1500+500*level
set MKO=CT3/50
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveInteger(LY,(handle_id),(12),(MKO))
call SaveTriggerHandle(LY,(handle_id),(11),(CR3))
call SaveBoolean(LY,(handle_id),(15),(CK3))
call TriggerRegisterTimerEvent(t,0.5/MKO,true)
call TriggerAddCondition(t,Condition(function CJ3))
call RemoveLocation(point)
set t=null
set SFI=null
set point=null
endfunction
function CP3 takes nothing returns boolean
if GetSpellAbilityId()=='A0Z8' or GetSpellAbilityId()=='A1CV' then
call CS3()
endif
return false
endfunction
function TF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CP3))
set t=null
endfunction
function CQ3 takes unit hero returns nothing
local group g=NTI()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit target
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
local integer level=GetUnitAbilityLevel(hero,'A0Z4')
set GK=hero
call GroupEnumUnitsInRange(g,x,y,300,Condition(function CF1))
set target=GroupPickRandomUnit(g)
call NSI(g)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",hero,"origin"))
if target!=null then
call AddSkill(dummy,'A0Z7')
call SetUnitAbilityLevel(dummy,'A0Z7',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
endif
set g=null
set target=null
set dummy=null
endfunction
function CU3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if NPI>15 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call CQ3(SFI)
endif
set t=null
set SFI=null
return false
endfunction
function D03 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,.7,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function CU3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerEvaluate(t)
set t=null
set SFI=null
endfunction
function DI3 takes nothing returns boolean
if GetSpellAbilityId()=='A0Z4' then
call D03()
endif
return false
endfunction
function TC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DI3))
set t=null
endfunction
function D13 takes nothing returns nothing
call Damage(BDI,GetEnumUnit(),1,BEI)
endfunction
function DO3 takes unit hero,real x,real y,integer level returns nothing
local group g=NTI()
if level==1 then
set BEI=105
elseif level==2 then
set BEI=170
elseif level==3 then
set BEI=250
elseif level==4 then
set BEI=310
endif
set BDI=hero
set GK=hero
call GroupEnumUnitsInRange(g,x,y,300+25,Condition(function CA1))
call ForGroup(g,function D13)
call NSI(g)
set g=null
endfunction
function D23 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(GK),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
if GetUnitAbilityLevel(GK,'A03R')>0 then
call AddSkill(dummy,'A10T')
else
call AddSkill(dummy,'A2S6')
endif
call IssueTargetOrder(dummy,"slow",GetEnumUnit())
set dummy=null
endfunction
function D33 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer D43=ModuloInteger(GetTriggerEvalCount(t),4)+1
local real a
local real d
local real x
local real y
local group g=NTI()
set GK=SFI
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),860,Condition(function CA1))
call ForGroup(g,function D23)
call NSI(g)
if D43==1 then
set a=GetRandomReal(0,90)
elseif D43==2 then
set a=GetRandomReal(90,180)
elseif D43==3 then
set a=GetRandomReal(180,270)
else
set a=GetRandomReal(270,360)
endif
set d=GetRandomReal(140,860)
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST and(GetSpellAbilityId()=='A03R' or GetSpellAbilityId()=='A0AV')then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call StopSound(DC,false,true)
else
set x=GetUnitX(SFI)+d*Cos(a*bj_DEGTORAD)
set y=GetUnitY(SFI)+d*Sin(a*bj_DEGTORAD)
call DestroyEffect(AddSpecialEffect("effects\\SnowyBlizzardTarget.mdx",x,y))
call DO3(SFI,x,y,level)
endif
set t=null
set SFI=null
return false
endfunction
function D53 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level
call IO1(DC,GetUnitX(SFI),GetUnitY(SFI))
if GetSpellAbilityId()=='A03R' then
set level=GetUnitAbilityLevel(SFI,'A03R')
else
set level=GetUnitAbilityLevel(SFI,'A0AV')+1
endif
call TriggerRegisterTimerEvent(t,0.10,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function D33))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(5),(level))
set t=null
set SFI=null
endfunction
function D63 takes nothing returns boolean
if GetSpellAbilityId()=='A03R' or GetSpellAbilityId()=='A0AV' then
call D53()
endif
return false
endfunction
function XB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function D63))
call Q1I('A03X')
set t=null
endfunction
function D73 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e038',x,y,0)
local integer level=GetUnitAbilityLevel(hero,'A1E9')
call AddSkill(dummy,'A01D')
call SetUnitAbilityLevel(dummy,'A01D',level)
call IssueTargetOrder(dummy,"frostnova",dummy)
call RemoveLocation(point)
call AddSkill(dummy,'Aloc')
call UnitApplyTimedLife(dummy,'BTLF',2)
set hero=null
set dummy=null
set point=null
endfunction
function D83 takes nothing returns boolean
if GetSpellAbilityId()=='A1E9' then
call D73()
endif
return false
endfunction
function X91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function D83))
set t=null
endfunction
function D93 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'AHab')
if IsUnitDead(hero)==false then
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+(0.5+0.5*level)*0.25)
endif
set hero=null
set t=null
return false
endfunction
function DA3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function D93))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function DB3 takes nothing returns boolean
if GetLearnedSkill()=='AHab' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'AHab')==1 then
call DA3()
endif
return false
endfunction
function X81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function DB3))
set t=null
endfunction
function DC3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A04C')
local integer NPI=GetTriggerEvalCount(t)
if(IsUnitType(target,UNIT_TYPE_HERO)==true and NPI>2+level)or NPI>20 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call Damage(hero,target,1,50)
endif
set t=null
return false
endfunction
function DD3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function DC3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set hero=null
set target=null
set t=null
endfunction
function DE3 takes nothing returns boolean
if GetSpellAbilityId()=='A04C' then
call DD3()
endif
return false
endfunction
function XA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DE3))
set t=null
endfunction
function DF3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SetUnitAnimationByIndex(hero,8)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function DG3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitAnimationByIndex(hero,7)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function DF3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function DH3 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='N0M0' then
call DG3()
endif
return false
endfunction
function PF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function DH3))
set t=null
endfunction
function DZ3 takes nothing returns nothing
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\ChimaeraLightningMissile\\ChimaeraLightningMissile.mdl",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
call Damage(BFI,GetEnumUnit(),1,BGI)
endfunction
function DV3 takes nothing returns boolean
local trigger t2=GetTriggeringTrigger()
local integer KAO=GetHandleId(t2)
local trigger t1=(LoadTriggerHandle(LY,(KAO),(9)))
local integer DW3=GetHandleId(t1)
local unit DX3=(LoadUnitHandle(LY,(KAO),(8)))
local group g
local integer level=(LoadInteger(LY,(KAO),(5)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call ShowUnit(DX3,false)
call KillUnit(DX3)
call FlushChildHashtable(LY,(DW3))
call FlushTrigger(t1)
call FlushChildHashtable(LY,(KAO))
call FlushTrigger(t2)
elseif IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(DX3))==true and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetTriggerUnit(),'A04R')==0 then
set g=NTI()
set GK=DX3
set BFI=DX3
set BGI=100+40*level
call GroupEnumUnitsInRange(g,GetUnitX(DX3),GetUnitY(DX3),285,Condition(function CA1))
call ForGroup(g,function DZ3)
call NSI(g)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",GetUnitX(DX3),GetUnitY(DX3)))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",GetUnitX(DX3),GetUnitY(DX3)))
call ShowUnit(DX3,false)
call KillUnit(DX3)
call FlushChildHashtable(LY,(DW3))
call FlushTrigger(t1)
call FlushChildHashtable(LY,(KAO))
call FlushTrigger(t2)
endif
set t1=null
set t2=null
set DX3=null
set g=null
return false
endfunction
function DY3 takes nothing returns boolean
local trigger t1=GetTriggeringTrigger()
local integer DW3=GetHandleId(t1)
local trigger t2
local integer KAO
local unit DX3
local integer level
local real x=(LoadReal(LY,(DW3),(6)))
local real y=(LoadReal(LY,(DW3),(7)))
local real NB2
local integer NPI=GetTriggerEvalCount(t1)
if NPI==1 then
call DestroyEffect((LoadEffectHandle(LY,(DW3),(3))))
elseif NPI==2 then
call DestroyEffect((LoadEffectHandle(LY,(DW3),(4))))
set t2=CreateTrigger()
set KAO=GetHandleId(t2)
set level=(LoadInteger(LY,(DW3),(5)))
set NB2=(LoadReal(LY,(DW3),(1)))
set DX3=CreateUnit(GetOwningPlayer((LoadUnitHandle(LY,(DW3),(2)))),'h07F',x,y,NB2)
call SetUnitVertexColor(DX3,255,255,255,100)
call UnitApplyTimedLife(DX3,'BTLF',12)
call SaveUnitHandle(LY,(DW3),(8),(DX3))
call SaveUnitHandle(LY,(KAO),(8),(DX3))
call SaveTriggerHandle(LY,(KAO),(9),(t1))
call SaveInteger(LY,(KAO),(5),(level))
call TriggerRegisterUnitInRange(t2,DX3,235,Condition(function ULI))
call TriggerRegisterUnitEvent(t2,DX3,EVENT_UNIT_DEATH)
call TriggerAddCondition(t2,Condition(function DV3))
call DestroyEffect(AddSpecialEffectTarget("effects\\ManaFlareBoltImpact_NoSound.mdx",DX3,"origin"))
elseif NPI>2 then
set DX3=(LoadUnitHandle(LY,(DW3),(8)))
call DestroyEffect(AddSpecialEffectTarget("effects\\ManaFlareBoltImpact_NoSound.mdx",DX3,"origin"))
endif
set t1=null
set DX3=null
return false
endfunction
function DJ3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t1=CreateTrigger()
local integer DW3=GetHandleId(t1)
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
call TriggerRegisterTimerEvent(t1,0.5,true)
call TriggerAddCondition(t1,Condition(function DY3))
call SaveReal(LY,(DW3),(6),((x)*1.0))
call SaveReal(LY,(DW3),(7),((y)*1.0))
call SaveInteger(LY,(DW3),(5),(GetUnitAbilityLevel(hero,'A14P')))
call SaveUnitHandle(LY,(DW3),(2),(hero))
call SaveReal(LY,(DW3),(1),((GetUnitFacing(hero))*1.0))
call SaveEffectHandle(LY,(DW3),(3),(AddSpecialEffect("Abilities\\Spells\\Orc\\LightningShield\\LightningShieldTarget.mdl",x,y)))
call SaveEffectHandle(LY,(DW3),(4),(AddSpecialEffect("effects\\Static_Remnant_FX.mdx",x,y)))
set hero=null
set t1=null
endfunction
function DK3 takes nothing returns boolean
if GetSpellAbilityId()=='A14P' then
call DJ3()
endif
return false
endfunction
function SE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DK3))
set t=null
endfunction
function DL3 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(BHI),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call AddSkill(dummy,'A0S5')
call IssueTargetOrder(dummy,"slow",GetEnumUnit())
call Damage(BHI,GetEnumUnit(),1,BZI)
set dummy=null
endfunction
function DM3 takes unit hero,unit target returns nothing
local integer handle_id=GetHandleId(hero)
local group g=NTI()
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(200))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(201))))
call SaveInteger(LY,(GetHandleId((hero))),((4264)),(2))
set GK=hero
set BHI=hero
set BZI=GetUnitAbilityLevel(hero,'A0QW')*20+10
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),300,Condition(function CA1))
call ForGroup(g,function DL3)
call NSI(g)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Thunderclap\\ThunderClapCaster.mdl",GetUnitX(target),GetUnitY(target)))
set g=null
endfunction
function DN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local trigger DS3=(LoadTriggerHandle(LY,(handle_id),(202)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and((LoadInteger(LY,(GetHandleId((hero))),((4264))))==1)==true then
call DisableTrigger(t)
call DM3(hero,target)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call FlushChildHashtable(LY,(GetHandleId(DS3)))
call FlushTrigger(DS3)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
set DS3=null
return false
endfunction
function DT3 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function DN3))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveTriggerHandle(LY,(handle_id),(202),(GetTriggeringTrigger()))
set t=null
set target=null
set hero=null
endfunction
function DR3 takes nothing returns boolean
if GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false then
call DT3()
endif
return false
endfunction
function DP3 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit hero=GetTriggerUnit()
local integer handle_id=GetHandleId(hero)
local string fx=""
if IsUnitAlly(hero,GetLocalPlayer())or P0I(GetLocalPlayer())then
set fx="Abilities\\Weapons\\FarseerMissile\\FarseerMissile.mdl"
endif
call SaveEffectHandle(LY,(handle_id),(200),(AddSpecialEffectTarget(fx,hero,"right hand")))
call SaveEffectHandle(LY,(handle_id),(201),(AddSpecialEffectTarget(fx,hero,"left hand")))
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function DR3))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
set t=null
endfunction
function DQ3 takes nothing returns boolean
if(GetSpellAbilityId()=='A14O' or GetSpellAbilityId()=='A14P' or GetSpellAbilityId()=='A14R')and((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4264))))==1)==false then
call SaveInteger(LY,(GetHandleId((GetTriggerUnit()))),((4264)),(1))
call DP3()
endif
return false
endfunction
function DU3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DQ3))
set hero=null
set t=null
endfunction
function E03 takes nothing returns boolean
if GetLearnedSkill()=='A0QW' and GetUnitAbilityLevel(GetTriggerUnit(),'A0QW')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call DU3()
endif
return false
endfunction
function SG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function E03))
set t=null
endfunction
function EI3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real x=GetUnitX(target)-5*Cos(RM2)
local real y=GetUnitY(target)-5*Sin(RM2)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real x0=(LoadReal(LY,(handle_id),(6)))
local real y0=(LoadReal(LY,(handle_id),(7)))
if((x0-x)*(x0-x))+((y0-y)*(y0-y))<100 then
set x=x0
set y=y0
endif
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
if GetTriggerEvalCount(t)==(10+10*level)or GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function E13 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'u00X',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
local integer level=GetUnitAbilityLevel(hero,'A14R')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function EI3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(13),((Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero)))*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call AddSkill(dummy,'A14Q')
call SetUnitAbilityLevel(dummy,'A14Q',level)
call IssueTargetOrder(dummy,"magicleash",target)
call UnitApplyTimedLife(dummy,'BTLF',0.5+0.5*level)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call AddSkill(dummy,'A14S')
call IssueTargetOrder(dummy,"slow",hero)
set hero=null
set target=null
set dummy=null
set t=null
endfunction
function EO3 takes nothing returns boolean
if GetSpellAbilityId()=='A14R' and GetUnitTypeId(GetSpellTargetUnit())!='n00L' and CanResistSkill(GetSpellTargetUnit())==false then
call E13()
endif
return false
endfunction
function SF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EO3))
set t=null
endfunction
function E23 takes nothing returns nothing
if(LoadBoolean(LY,(BVI),(GetHandleId(GetEnumUnit()))))==false then
call SaveBoolean(LY,(BVI),(GetHandleId(GetEnumUnit())),(true))
call Damage(BXI,GetEnumUnit(),1,BYI*(BWI*4+4)/100)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",GetEnumUnit(),"origin"))
endif
endfunction
function E33 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit E43=(LoadUnitHandle(LY,(handle_id),(195)))
local integer BQO=(LoadInteger(LY,(handle_id),(194)))
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real IO3=GetUnitX(hero)
local real I23=GetUnitY(hero)
local real RM2=Atan2(QKI-I23,QJI-IO3)
local real IV1=IO3+(25+25*level)*Cos(RM2)
local real IW1=I23+(25+25*level)*Sin(RM2)
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(196)))
local real lx=(LoadReal(LY,(handle_id),(197)))
local real ly=(LoadReal(LY,(handle_id),(198)))
local real KWO=GetUnitState(hero,UNIT_STATE_MANA)
local real E53=(25+25*level)*(12+0.007*GetUnitState(hero,UNIT_STATE_MAX_MANA))/100
local group g=NTI()
local real E63=(LoadReal(LY,(handle_id),(199)))
set E63=E63+25+25*level
call SaveReal(LY,(handle_id),(199),((E63)*1.0))
if GetTriggerEvalCount(t)>25 then
set lx=lx+(25+25*level)*Cos(RM2)
set ly=ly+(25+25*level)*Sin(RM2)
call SaveReal(LY,(handle_id),(197),((lx)*1.0))
call SaveReal(LY,(handle_id),(198),((ly)*1.0))
endif
call SetUnitState(hero,UNIT_STATE_MANA,RMaxBJ(KWO-E53,0))
call MoveLightning(UZI,true,lx,ly,IV1,IW1)
call MUSetUnitX(hero,IV1)
call MUSetUnitY(hero,IW1)
call SetUnitPosition(dummy,IV1,IW1)
call SetUnitPosition(E43,IV1,IW1)
set GK=hero
set BXI=hero
set BVI=handle_id
set BWI=level
set BYI=E63
call GroupEnumUnitsInRange(g,IV1,IW1,75+75*level,Condition(function CA1))
call ForGroup(g,function E23)
call NSI(g)
set BQO=BQO-1
call SaveInteger(LY,(handle_id),(194),(BQO))
call SetUnitVertexColor(hero,255,255,255,0)
if BQO==0 or GetUnitState(hero,UNIT_STATE_MANA)<1 then
call DestroyLightning(UZI)
call UPI(IV1,IW1,75)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call RemoveUnit(dummy)
call RemoveUnit(E43)
call SetUnitVertexColor(hero,255,255,255,255)
call SetUnitPathing(hero,true)
call SetUnitInvulnerable(hero,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call UPI(IV1,IW1,75)
endif
set t=null
set dummy=null
set hero=null
set UZI=null
set g=null
set E43=null
return false
endfunction
function E73 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local unit dummy
local unit E43
local location point
local real x
local real y
local trigger t
local integer handle_id
local lightning UZI
local integer level=GetUnitAbilityLevel(hero,'A14O')
local real KWO=GetUnitState(hero,UNIT_STATE_MANA)
local real E53=15+0.07*GetUnitState(hero,UNIT_STATE_MAX_MANA)
call SetUnitState(hero,UNIT_STATE_MANA,RMaxBJ(KWO-E53,0))
if GetUnitState(hero,UNIT_STATE_MANA)>10 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set dummy=CreateUnit(GetOwningPlayer(hero),'o010',QXI,QYI,0)
set E43=CreateUnit(GetOwningPlayer(hero),'H07G',QXI,QYI,0)
set UZI=AddLightning("FORK",true,QXI,QYI,QXI,QYI)
if GetSpellTargetUnit()==null then
set point=GetSpellTargetLoc()
set x=GetLocationX(point)
set y=GetLocationY(point)
call RemoveLocation(point)
else
set x=GetUnitX(GetSpellTargetUnit())
set y=GetUnitY(GetSpellTargetUnit())
endif
call SetUnitVertexColor(hero,255,255,255,0)
call SetUnitVertexColor(E43,255,255,255,0)
call SetUnitPathing(hero,false)
call SetUnitPathing(dummy,false)
call SetUnitInvulnerable(hero,true)
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(195),(E43))
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(197),((QXI)*1.0))
call SaveReal(LY,(handle_id),(198),((QYI)*1.0))
call SaveReal(LY,(handle_id),(199),((0)*1.0))
call SaveInteger(LY,(handle_id),(194),(QAI(R2I(SquareRoot((x-QXI)*(x-QXI)+(y-QYI)*(y-QYI))/(25+25*level)),1)))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\Lightning_Ball_Tail_FX.mdx",E43,"origin")))
call TriggerRegisterTimerEvent(t,0.04,true)
call TriggerAddCondition(t,Condition(function E33))
call ShowUnit(hero,false)
call ShowUnit(hero,true)
call SelectUnitAddForPlayer(hero,GetOwningPlayer(hero))
endif
set hero=null
set dummy=null
set E43=null
set point=null
set t=null
set UZI=null
endfunction
function E83 takes nothing returns boolean
if GetSpellAbilityId()=='A14O' then
call E73()
endif
return false
endfunction
function E93 takes nothing returns boolean
if GetSpellAbilityId()=='A14O' then
if GetUnitState(GetTriggerUnit(),UNIT_STATE_MANA)<(15+0.07*GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_MANA))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"魔法不足")
endif
endif
return false
endfunction
function SH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function E83))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function E93))
set t=null
endfunction
function EA3 takes unit hero returns nothing
local integer level=GetUnitAbilityLevel(hero,'A2AI')
if GetUnitTypeId(hero)=='Hlgr' then
call SetUnitAbilityLevel(hero,'A0AR',level)
else
call SetUnitAbilityLevel(hero,'A0AR',level+4)
endif
endfunction
function EB3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2AI')
if level==1 then
call AddSkill(hero,'A0AR')
endif
call EA3(hero)
set hero=null
endfunction
function EC3 takes nothing returns boolean
if GetLearnedSkill()=='A2AI' and IsUnitIllusion(GetTriggerUnit())==false then
call EB3()
endif
return false
endfunction
function ED3 takes nothing returns nothing
local unit u=GetTriggerUnit()
if GetUnitTypeId(u)=='H00G' or GetUnitTypeId(u)=='H00F' or GetUnitTypeId(u)=='H00E' then
call SetUnitAnimation(u,"stand")
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Defend\\DefendCaster.mdl",u,"head"))
elseif GetUnitTypeId(u)=='Hlgr' then
call SetUnitAnimation(u,"stand defend")
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Defend\\DefendCaster.mdl",u,"origin"))
endif
set u=null
endfunction
function EE3 takes nothing returns boolean
if GetSpellAbilityId()=='A0AR' then
call ED3()
endif
return false
endfunction
function N71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EE3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function EC3))
call Q1I('A0AR')
set t=null
endfunction
constant function DragonsBlood_RawCode takes nothing returns integer
return 'A0CL'
endfunction
constant function DragonsBlood_ArmorCode takes nothing returns integer
return 'R006'
endfunction
function EF3 takes nothing returns boolean
return GetLearnedSkill()==('A0CL')and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function EG3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
call SetPlayerTechResearched(GetOwningPlayer(SFI),('R006'),GetPlayerTechCount(GetOwningPlayer(SFI),('R006'),true)+1)
endfunction
function N61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function EF3))
call TriggerAddAction(t,function EG3)
endfunction
function EH3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real GW1=(LoadReal(LY,(GetHandleId(target)),(805)))
local real AB3=0.75
local real PAI=20
if IsUnitType(target,UNIT_TYPE_HERO)==false then
set AB3=1
endif
if GetUnitState(target,UNIT_STATE_LIFE)<=PAI*AB3 then
set PAI=GetUnitState(target,UNIT_STATE_LIFE)/AB3-2
endif
call Damage(hero,target,1,PAI)
if(TimerGetElapsed(M))>=GW1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function EZ3 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local real GW1=(LoadReal(LY,(GetHandleId(target)),(805)))
if GW1>(TimerGetElapsed(M))then
call SaveReal(LY,(GetHandleId(target)),(805),(((TimerGetElapsed(M))+5)*1.0))
else
call SaveReal(LY,(GetHandleId(target)),(805),(((TimerGetElapsed(M))+5)*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function EH3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set t=null
endfunction
function EV3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call EZ3(hero,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
return false
endfunction
function EW3 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function EV3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set target=null
set hero=null
endfunction
function EX3 takes nothing returns boolean
if GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))and IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false and GetUnitAbilityLevel(GetAttacker(),'A0O4')>0 then
call EW3()
endif
return false
endfunction
function EY3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function EX3))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
set hero=null
set t=null
endfunction
function EJ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call EA3(hero)
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
set t=null
set hero=null
return false
endfunction
function EK3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call EA3(hero)
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
set t=null
set hero=null
return false
endfunction
function VT1 takes nothing returns nothing
if GetUnitAbilityLevel(GK,'A0AR')>0 then
call EA3(GK)
endif
endfunction
function EL3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function EJ3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function EK3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function EM3 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A03G' then
call EL3()
endif
else
if GetLearnedSkill()=='A03G' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A03G')==1 then
call EY3()
endif
endif
return false
endfunction
function N81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function EM3))
set t=null
endfunction
function EN3 takes nothing returns boolean
if((GetSpellAbilityId()=='A0SK'))then
return true
endif
if((GetSpellAbilityId()=='A0DL'))then
return true
endif
if((GetSpellAbilityId()=='A0DH'))then
return true
endif
if((GetSpellAbilityId()=='A1OB'))then
return true
endif
return false
endfunction
function ES3 takes nothing returns boolean
if(not(GetUnitAbilityLevelSwapped('A0DJ',GetSpellAbilityUnit())>0))then
return false
endif
if(not EN3())then
return false
endif
return true
endfunction
function ET3 takes nothing returns nothing
local location ON3=GetUnitLoc(GetTriggerUnit())
call CreateNUnitsAtLoc(1,'e00E',GetOwningPlayer(GetTriggerUnit()),ON3,bj_UNIT_FACING)
call UnitAddAbility(bj_lastCreatedUnit,'A0DI')
call SetUnitAbilityLevelSwapped('A0DI',bj_lastCreatedUnit,GetUnitAbilityLevelSwapped('A0DJ',GetSpellAbilityUnit()))
call IssueImmediateOrder(bj_lastCreatedUnit,"stomp")
call RemoveLocation(ON3)
endfunction
function XE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ES3))
call TriggerAddAction(t,function ET3)
endfunction
function ER3 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(GetEnumUnit()),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call AddSkill(dummy,'A0SJ')
call SetUnitAbilityLevel(dummy,'A0SJ',UJ)
call IssueTargetOrder(dummy,"thunderbolt",GetEnumUnit())
call Damage(GetTriggerUnit(),GetEnumUnit(),1,AK)
set dummy=null
endfunction
function EP3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local location point=GetSpellTargetLoc()
local integer i=1
local real QXI=GetUnitX(SFI)
local real QYI=GetUnitY(SFI)
local real QJI
local real QKI
local real x
local real y
local real a
local group g=NTI()
local group g2=NTI()
if target==null then
set QJI=GetLocationX(point)
set QKI=GetLocationY(point)
else
set QJI=GetUnitX(target)
set QKI=GetUnitY(target)
endif
set a=bj_DEGTORAD*UEI(QXI,QYI,QJI,QKI)
call RemoveLocation(point)
loop
exitwhen i>24
set x=PTI(QXI+i*60*Cos(a))
set y=PUI(QYI+i*60*Sin(a))
call GroupEnumUnitsInRange(g2,x,y,250,Condition(function C51))
call GroupAddGroup(g2,g)
call GroupClear(g2)
call OA1(CreateDestructable('B000',x,y,GetRandomReal(0,360),0.5,GetRandomInt(0,2)),8)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Volcano\\VolcanoDeath.mdl",x,y))
set i=i+1
endloop
set UJ=GetUnitAbilityLevel(SFI,'A0SK')
set AK=UJ*50+75
call ForGroup(g,function ER3)
call NSI(g)
call NSI(g2)
set SFI=null
set point=null
endfunction
function EQ3 takes nothing returns boolean
if GetSpellAbilityId()=='A0SK' then
call EP3()
endif
return false
endfunction
function XD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EQ3))
call Q1I('A0SJ')
set t=null
endfunction
function EU3 takes nothing returns boolean
if(not(UnitHasBuffBJ(GetAttacker(),'Broa')==true))then
return false
endif
return true
endfunction
function F03 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call UnitRemoveAbility(hero,'Broa')
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function FI3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerAddCondition(t,Condition(function F03))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function XG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function EU3))
call TriggerAddAction(t,function FI3)
endfunction
function F13 takes nothing returns boolean
if(GetItemTypeId(GetManipulatedItem())=='I00K')then
if(GetUnitTypeId(GetTriggerUnit())=='Otch')then
return true
endif
endif
return false
endfunction
function FO3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
call AddSkill(dummy,'AIrr')
call IssueImmediateOrder(dummy,"roar")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
set dummy=null
return false
endfunction
function F23 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UnitRemoveAbility(SFI,'B01P')
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function FO3))
set t=null
set SFI=null
endfunction
function XF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call TriggerAddCondition(t,Condition(function F13))
call TriggerAddAction(t,function F23)
endfunction
function F33 takes nothing returns nothing
local real x=GetUnitX(GetEnumUnit())
local real y=GetUnitY(GetEnumUnit())
local integer id=GetPlayerId(GetOwningPlayer(GetTriggerUnit()))
call MUSetUnitX(BJI[id],x)
call MUSetUnitY(BJI[id],y)
call IssueImmediateOrder(BJI[id],"fanofknives")
call Damage(GetTriggerUnit(),GetEnumUnit(),1,BLI)
endfunction
function F43 takes nothing returns nothing
local real x=GetUnitX(GetEnumUnit())
local real y=GetUnitY(GetEnumUnit())
local integer id=GetPlayerId(GetOwningPlayer(GetTriggerUnit()))
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true or IsUnitIllusion(GetEnumUnit())==true then
call MUSetUnitX(BJI[id],x)
call MUSetUnitY(BJI[id],y)
call IssueImmediateOrder(BJI[id],"fanofknives")
endif
endfunction
function F53 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))==true and IsUnitDead(GetFilterUnit())==false
endfunction
function F63 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
local integer id=GetPlayerId(GetOwningPlayer(hero))
local integer level=GetUnitAbilityLevel(hero,'A0DH')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o00Z',GetUnitX(hero),GetUnitY(hero),0)
call UnitApplyTimedLife(dummy,'BTLF',0.5)
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1OB')
endif
if level==1 then
set BLI=160
elseif level==2 then
set BLI=210
elseif level==2 then
set BLI=270
endif
set BJI[id]=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
set BKI[id]=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call SetUnitScale(BJI[id],0.25,0.25,0.25)
call AddSkill(BJI[id],'A0DM')
call AddSkill(BKI[id],'A1H0')
call SetUnitAbilityLevel(BJI[id],'A0DM',level)
call SetUnitAbilityLevel(BKI[id],'A1H0',level)
call GroupEnumUnitsInRange(g,x,y,575+25,Condition(function F53))
call ForGroup(g,function F33)
if GetUnitAbilityLevel(hero,'A1OB')>0 then
call ForGroup(g,function F43)
endif
call NSI(g)
set hero=null
set g=null
endfunction
function F73 takes nothing returns boolean
if GetSpellAbilityId()=='A0DH' or GetSpellAbilityId()=='A1OB' then
call F63()
endif
return false
endfunction
function XC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function F73))
set t=null
call Q1I('A0DM')
endfunction
constant function Untouchable_RawCode takes nothing returns integer
return 'A0DW'
endfunction
constant function Untouchable_EffectCode takes nothing returns integer
return 'A0B0'
endfunction
function F83 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
return GetUnitAbilityLevel(GetSpellTargetUnit(),('A0DW'))>0
else
return GetUnitAbilityLevel(GetTriggerUnit(),('A0DW'))>0
endif
endfunction
function F93 takes nothing returns nothing
local unit hero
local unit target
local unit dummy
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
set hero=GetSpellTargetUnit()
set target=GetTriggerUnit()
else
set hero=GetTriggerUnit()
set target=GetAttacker()
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,('A0B0'))
call SetUnitAbilityLevel(dummy,('A0B0'),GetUnitAbilityLevel(hero,('A0DW')))
call IssueTargetOrder(dummy,"acidbomb",target)
endfunction
function XW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function F83))
call TriggerAddAction(t,function F93)
endfunction
function FA3 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)!=GetUnitState(GetFilterUnit(),UNIT_STATE_MAX_LIFE)
endfunction
function FB3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer QX2=(LoadInteger(LY,(handle_id),(28)))
local group g
local unit WH1
if QX2>10 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveInteger(LY,(handle_id),(28),(QX2+1))
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),300,Condition(function FA3))
set WH1=GroupPickRandomUnit(g)
call NSI(g)
call SetUnitState(WH1,UNIT_STATE_LIFE,GetUnitState(WH1,UNIT_STATE_LIFE)+10)
endif
set t=null
set hero=null
set g=null
set WH1=null
return false
endfunction
function FC3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call AddUnitAnimationProperties(hero,"alternate",false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function FD3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer i=1
local trigger t
local integer handle_id
loop
exitwhen i>(1+2*GetUnitAbilityLevel(hero,'A01B'))
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call SaveInteger(LY,(GetHandleId(t)),(28),(0))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function FB3))
set i=i+1
endloop
if GetUnitTypeId(hero)=='E02X' then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function FC3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endif
set t=null
set hero=null
endfunction
function FE3 takes nothing returns boolean
if GetSpellAbilityId()=='A01B' then
call FD3()
endif
return false
endfunction
function XZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FE3))
set t=null
endfunction
function FF3 takes real x1,real y1,real x2,real y2 returns real
return SquareRoot(((x1-x2)*(x1-x2))+((y1-y2)*(y1-y2)))
endfunction
function FG3 takes unit u returns integer
local integer level=GetUnitAbilityLevel(u,'A0DY')
if level>0 then
return level
endif
set level=GetUnitAbilityLevel(u,'A1WB')
return level
endfunction
function FH3 takes nothing returns boolean
local real d
local real IT3
if GetUnitAbilityLevel(GetTriggerUnit(),'B03U')>0 and FG3(GetEventDamageSource())>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
call UnitRemoveAbility(GetTriggerUnit(),'B03U')
set IT3=RMinBJ(FF3(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),GetUnitX(GetEventDamageSource()),GetUnitY(GetEventDamageSource())),2500)
set d=(0.10+0.05*I2R(FG3(GetEventDamageSource())))*IT3
call UYI("+"+I2S(R2I(d)),1,GetTriggerUnit(),0.023,3,216,216,216)
call DisableTrigger(GetTriggeringTrigger())
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,d)
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function FZ3 takes nothing returns nothing
local trigger t
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
set target=GetSpellTargetUnit()
set hero=GetTriggerUnit()
else
set target=GetTriggerUnit()
set hero=GetAttacker()
endif
if IsUnitIllusion(hero)==false then
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function FH3))
endif
set t=null
set target=null
set hero=null
endfunction
function FV3 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if FG3(GetAttacker())>0 and(LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
call FZ3()
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if(GetIssuedOrderId()==OrderId("poisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(true))
elseif(GetIssuedOrderId()==OrderId("unpoisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(false))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and(GetSpellAbilityId()=='A0DY' or GetSpellAbilityId()=='A1WB')then
call FZ3()
endif
return false
endfunction
function FW3 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function FV3))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function FX3 takes nothing returns boolean
if(GetLearnedSkill()=='A0DY' or GetLearnedSkill()=='A1WB')and IsUnitIllusion(GetTriggerUnit())==false and FG3(GetTriggerUnit())==1 then
call FW3()
endif
return false
endfunction
function XV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function FX3))
set t=null
endfunction
function FY3 takes unit u returns boolean
return IsUnitType(u,UNIT_TYPE_HERO)==false and IsUnitType(u,UNIT_TYPE_ANCIENT)==false and GetUnitTypeId(u)!='n01E' and GetUnitTypeId(u)!='n019'
endfunction
function FJ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(target,'Bslo')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function FK3 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function FJ3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SetUnitOwner(target,GetOwningPlayer(hero),true)
call UnitApplyTimedLife(target,'BTLF',80)
call AddSkill(target,'Aeth')
call AddSkill(target,'A12G')
call QSI(target)
set target=null
set hero=null
endfunction
function FL3 takes nothing returns boolean
if GetSpellAbilityId()=='A0DX' and FY3(GetSpellTargetUnit())then
call FK3()
endif
return false
endfunction
function XH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FL3))
set t=null
endfunction
function FM3 takes nothing returns nothing
local real PAI=GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)*BNI
call Damage(BMI,GetEnumUnit(),7,PAI)
endfunction
function FN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g
if GetTriggerEvalCount(t)>11 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
set BMI=hero
set BNI=(2.25+0.75*GetUnitAbilityLevel(hero,'A0B1'))/100
call GroupEnumUnitsInRange(g,x,y,625,Condition(function CA1))
call ForGroup(g,function FM3)
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function FS3 takes real x,real y returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function FN3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set t=null
set hero=null
endfunction
function FT3 takes nothing returns boolean
if(not(GetSpellAbilityId()=='A0B1'))then
return false
endif
return true
endfunction
function FR3 takes nothing returns nothing
local location ON3=GetUnitLoc(GetTriggerUnit())
local location FP3=GetSpellTargetLoc()
call FS3(GetLocationX(FP3),GetLocationY(FP3))
call CreateNUnitsAtLocFacingLocBJ(1,'e00E',GetOwningPlayer(GetTriggerUnit()),FP3,FP3)
call ShowUnitHide(bj_lastCreatedUnit)
call UnitApplyTimedLifeBJ(11.00,'BTLF',bj_lastCreatedUnit)
call UnitAddAbility(bj_lastCreatedUnit,'A0B2')
call SetUnitAbilityLevelSwapped('A0B2',bj_lastCreatedUnit,GetUnitAbilityLevelSwapped('A0B1',GetTriggerUnit()))
call IssuePointOrderLoc(bj_lastCreatedUnit,"deathanddecay",FP3)
call RemoveLocation(ON3)
call RemoveLocation(FP3)
endfunction
function XJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FT3))
call TriggerAddAction(t,function FR3)
endfunction
function FQ3 takes unit hero,unit target,integer level returns nothing
local real PAI
local real FU3
if level==1 then
set PAI=25
set FU3=0.25
elseif level==2 then
set PAI=40
set FU3=0.5
elseif level==3 then
set PAI=55
set FU3=0.75
else
set PAI=70
set FU3=1
endif
call DD1(target,target,FU3)
call Damage(hero,target,1,PAI)
endfunction
function G03 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
call FQ3(hero,target,level)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function GI3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(hero,'A0I7')
call FQ3(hero,target,level)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call TriggerRegisterTimerEvent(t,2,false)
call TriggerAddCondition(t,Condition(function G03))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function G03))
set t=null
set hero=null
set target=null
endfunction
function G13 takes nothing returns boolean
if GetSpellAbilityId()=='A0I7' and CanResistSkill(GetSpellTargetUnit())==false then
call GI3()
endif
return false
endfunction
function XY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function G13))
endfunction
function DemonicConversion_Delayed takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call AddSkill(dummy,'A17Z')
call SetUnitAbilityLevel(dummy,'A17Z',level)
call IssueImmediateOrder(dummy,"slimemonster")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set dummy=null
return false
endfunction
function GO3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local integer level=GetUnitAbilityLevel(hero,'A180')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call SetUnitState(target,UNIT_STATE_LIFE,1)
call Damage(hero,target,2,20)
call Damage(hero,target,1,20)
call Damage(hero,target,3,20)
call AddSkill(dummy,'A17Z')
call SetUnitAbilityLevel(dummy,'A17Z',level)
call IssueImmediateOrder(dummy,"lavamonster")
set hero=null
set target=null
set dummy=null
endfunction
function G23 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer G33=GetUnitLevel(target)
if GetOwningPlayer(target)!=BO[0]and GetOwningPlayer(target)!=CO[0]and G33>4 then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"那个生物过于强大")
endif
set SFI=null
set target=null
endfunction
function G43 takes nothing returns boolean
if GetSpellAbilityId()=='A180' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call GO3()
else
call G23()
endif
endif
return false
endfunction
function DemonicConversion_Recolor takes nothing returns boolean
local integer id=GetUnitTypeId(GetTriggerUnit())
if id=='hwat' or id=='hwt2' or id=='hwt3' or id=='h006' then
call SetUnitVertexColor(GetSummonedUnit(),0,0,50,255)
endif
return false
endfunction
function XK1 takes nothing returns nothing
local trigger t=CreateTrigger()
local region S5O=CreateRegion()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function G43))
set t=null
endfunction
function G53 takes real x returns real
local real PRI=GetRectMinX(bj_mapInitialPlayableArea)+150
if(x<PRI)then
return PRI
endif
set PRI=GetRectMaxX(bj_mapInitialPlayableArea)-150
if(x>PRI)then
return PRI
endif
return x
endfunction
function G63 takes real y returns real
local real PRI=GetRectMinY(bj_mapInitialPlayableArea)+150
if(y<PRI)then
return PRI
endif
set PRI=GetRectMaxY(bj_mapInitialPlayableArea)-150
if(y>PRI)then
return PRI
endif
return y
endfunction
function G73 takes unit u returns boolean
local integer id=GetUnitTypeId(u)
return id=='npn3' or id=='npn6' or id=='n010' or id=='n0GZ' or id=='npn1' or id=='npn4' or id=='n011' or id=='n0H0' or id=='npn2' or id=='npn5' or id=='n012' or id=='n0H1'
endfunction
function G83 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or G73(GetFilterUnit())or CI1(GetFilterUnit())or GetUnitTypeId(GetFilterUnit())=='n00U' or GetUnitTypeId(GetFilterUnit())=='n00Y' or GetUnitTypeId(GetFilterUnit())=='n00Z' or GetUnitTypeId(GetFilterUnit())=='n0KU' or GetUnitTypeId(GetFilterUnit())=='n0KV' or GetUnitTypeId(GetFilterUnit())=='n0KW' or POI(GetUnitTypeId(GetFilterUnit())))and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer((LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(318)))))==true
endfunction
function G93 takes nothing returns nothing
local location GA3=GetUnitLoc(GetEnumUnit())
local location GB3=GetUnitLoc((LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(318))))
local location GC3=M7I(GB3,DistanceBetweenPoints(GB3,GA3)-2,AngleBetweenPoints(GB3,GA3))
call SetUnitFacing(GetEnumUnit(),AngleBetweenPoints(GB3,GA3))
call SetUnitPositionLoc(GetEnumUnit(),GC3)
call RemoveLocation(GA3)
call RemoveLocation(GB3)
call RemoveLocation(GC3)
if BSI>0 then
call Damage(BTI,GetEnumUnit(),8,GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)*(0.0225+0.0075*BSI))
endif
endfunction
function GD3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local group Z51
local integer handle_id=GetHandleId(t)
local unit GE3=(LoadUnitHandle(LY,(handle_id),(318)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy
local real x
local real y
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST and(GetSpellAbilityId()=='A1BX' or GetSpellAbilityId()=='A2TX')then
call KillUnit(GE3)
set dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(250))),'BTLF',1)
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(251))),'BTLF',1)
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(252))),'BTLF',1)
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(253))),'BTLF',1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
elseif GetTriggerEvalCount(t)>90 then
set dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(250))),'BTLF',1)
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(251))),'BTLF',1)
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(252))),'BTLF',1)
call UnitApplyTimedLife((LoadUnitHandle(LY,(handle_id),(253))),'BTLF',1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(GE3)
call KillUnit(dummy)
call PJI((LoadUnitHandle(LY,(handle_id),(2))))
else
set BSI=0
if GetTriggerEvalCount(t)==20 or GetTriggerEvalCount(t)==40 or GetTriggerEvalCount(t)==60 or GetTriggerEvalCount(t)==80 then
if GetUnitAbilityLevel(hero,'A2TX')>0 then
set BTI=hero
set BSI=GetUnitAbilityLevel(hero,'A0B1')
endif
endif
set x=GetUnitX(GE3)
set y=GetUnitY(GE3)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,425,Condition(function G83))
call ForGroup(Z51,function G93)
call NSI(Z51)
endif
set dummy=null
set GE3=null
set t=null
return false
endfunction
function GF3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
local unit GE3=CreateUnit(GetOwningPlayer(hero),'u004',x,y,0)
local integer level=GetUnitAbilityLevel(hero,'A1BX')
call RemoveLocation(point)
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2TX')
endif
call SetUnitAbilityLevel(GE3,'A0C0',level)
if IsPlayerTeam2(GetOwningPlayer(hero))then
call AddSkill(dummy,'A0X4')
else
call AddSkill(dummy,'A0X3')
endif
call IssuePointOrder(dummy,"cloudoffog",x,y)
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(250),(CreateUnit(GetOwningPlayer(hero),'h06R',x,y,0)))
call SaveUnitHandle(LY,(handle_id),(251),(CreateUnit(GetOwningPlayer(hero),'h06R',x,y,0)))
call SaveUnitHandle(LY,(handle_id),(252),(CreateUnit(GetOwningPlayer(hero),'h06R',x,y,0)))
call SaveUnitHandle(LY,(handle_id),(253),(CreateUnit(GetOwningPlayer(hero),'h06R',x,y,0)))
call SaveUnitHandle(LY,(handle_id),(318),(GE3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function GD3))
set hero=null
set GE3=null
set t=null
set point=null
endfunction
function GG3 takes nothing returns boolean
if GetSpellAbilityId()=='A1BX' or GetSpellAbilityId()=='A2TX' then
call GF3()
endif
return false
endfunction
function GH3 takes nothing returns boolean
local location point
local real x
local real y
if GetSpellAbilityId()=='A1BX' or GetSpellAbilityId()=='A2TX' then
set point=GetSpellTargetLoc()
set x=GetLocationX(point)
set y=GetLocationY(point)
call RemoveLocation(point)
set point=null
if(x!=G53(x)and y!=G63(y))or RectContainsCoords(U9,x,y)or RectContainsCoords(IA,x,y)or RectContainsCoords(OA,x,y)or RectContainsCoords(BA,x,y)or RectContainsCoords(CA,x,y)or RectContainsCoords(DA,x,y)then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"Cannot cast Blackhole here")
endif
endif
return false
endfunction
function XX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GG3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function GH3))
call Q1I('A0C0')
endfunction
function GZ3 takes nothing returns nothing
call Damage(GetTriggerUnit(),GetEnumUnit(),1,AK)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\StaffOfPurification\\PurificationTarget.mdx",GetEnumUnit(),"chest"))
endfunction
function GV3 takes nothing returns nothing
local group g=NTI()
local unit SFI=GetTriggerUnit()
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local integer level=GetUnitAbilityLevel(SFI,'A0SC')
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',x,y,0)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\StaffOfPurification\\PurificationCaster.mdx",x,y))
call AddSkill(dummy,'A0SD')
call SetUnitAbilityLevel(dummy,'A0SD',level)
call IssuePointOrder(dummy,"silence",x,y)
set AK=level*70
call GroupEnumUnitsInRange(g,x,y,425,Condition(function C61))
call ForGroup(g,function GZ3)
call NSI(g)
set dummy=null
set g=null
set SFI=null
endfunction
function GW3 takes nothing returns boolean
if GetSpellAbilityId()=='A0SC' then
call GV3()
endif
return false
endfunction
function SK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GW3))
set t=null
endfunction
function GX3 takes unit hero,unit target,integer level,integer KBO returns nothing
local unit dummy
if KBO==1 then
call DD1(hero,target,0.75+0.75*level)
call Damage(hero,target,1,level*50+50)
else
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A0SG')
call SetUnitAbilityLevel(dummy,'A0SG',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
call Damage(hero,target,1,level*50+50+100)
endif
set dummy=null
endfunction
function GY3 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A0SF')
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=null
endfunction
function GJ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer KBO=(LoadInteger(LY,(handle_id),(152)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(196)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyLightning(UZI)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call MoveLightning(UZI,false,GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
if QNI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))>600 then
call DestroyLightning(UZI)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call GX3(hero,target,level,KBO)
endif
endif
set t=null
set hero=null
set target=null
set UZI=null
return false
endfunction
function GK3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local lightning UZI=AddLightning("HWPB",false,GetUnitX(C0I),GetUnitY(C0I),GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()))
call SetLightningColor(UZI,0,.7,1,1)
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SaveUnitHandle(LY,(handle_id),(2),(C0I))
call SaveInteger(LY,(handle_id),(30),(NKI(GetEnumUnit())))
call SaveInteger(LY,(handle_id),(5),(BRI))
call SaveInteger(LY,(handle_id),(152),(BPI))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,GetEnumUnit(),EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,C0I,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function GJ3))
call Damage(GetTriggerUnit(),GetEnumUnit(),1,BQI)
call GY3(GetTriggerUnit(),GetEnumUnit())
set t=null
set UZI=null
endfunction
function GL3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00U',x,y,0)
local group g=NTI()
local integer level=GetUnitAbilityLevel(SFI,'A0S8')
local real DC1=6
local integer KBO=1
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A1QP')
set DC1=8
set KBO=2
endif
call RemoveLocation(point)
call SetUnitAnimation(dummy,"channel")
call OR1(dummy,DC1)
set C0I=dummy
set BUI=DC1
set BQI=level*50+50
set BRI=level
set BPI=KBO
set GK=SFI
call GroupEnumUnitsInRange(g,x,y,400,Condition(function CC1))
call ForGroup(g,function GK3)
call NSI(g)
set g=null
set dummy=null
set SFI=null
set point=null
endfunction
function GM3 takes nothing returns boolean
if GetSpellAbilityId()=='A0S8' or GetSpellAbilityId()=='A1QP' then
call GL3()
endif
return false
endfunction
function SM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GM3))
set t=null
endfunction
function GN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level
local integer QX2
local integer MKO
if(GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER and GetIssuedOrderId()!=String2OrderIdBJ("phaseshift"))or GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER or GetTriggerEventId()==EVENT_UNIT_DEATH then
call SetUnitInvulnerable(SFI,false)
call UnitRemoveAbility(SFI,'A04R')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set level=(LoadInteger(LY,(handle_id),(5)))
set QX2=(LoadInteger(LY,(handle_id),(28)))+1
call SaveInteger(LY,(handle_id),(28),(QX2))
set MKO=3*level
if level==4 then
set MKO=MKO+1
endif
if QX2>MKO or QNI(GetUnitX(SFI),GetUnitY(SFI),(LoadReal(LY,(handle_id),(6))),(LoadReal(LY,(handle_id),(7))))>125 then
call SetUnitInvulnerable(SFI,false)
call UnitRemoveAbility(SFI,'A04R')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set SFI=null
return false
endfunction
function GS3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitInvulnerable(SFI,true)
call AddSkill(SFI,'A04R')
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(SFI,'A0SB')))
call SaveInteger(LY,(handle_id),(28),(0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function GN3))
call SCI(SFI,4266,5.9)
set t=null
set SFI=null
endfunction
function GT3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call IssueImmediateOrder(SFI,"phaseshiftoff")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function GR3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function GT3))
set t=null
set SFI=null
endfunction
function GP3 takes nothing returns boolean
if GetIssuedOrderId()==String2OrderIdBJ("phaseshift")and IsUnitIllusion(GetTriggerUnit())==false and((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4266))))==1)==false then
call GS3()
elseif GetIssuedOrderId()==String2OrderIdBJ("phaseshifton")then
call GR3()
endif
return false
endfunction
function SL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function GP3))
set t=null
endfunction
function GQ3 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false then
call GroupAddUnit(XK,GetEnumUnit())
call Damage(GK,GetEnumUnit(),1,AK)
endif
endfunction
function GU3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local group H03
local real x
local real y
if GetTriggerEventId()==EVENT_UNIT_DEATH then
set GK=CreateUnit(GetOwningPlayer(dummy),'h06O',GetUnitX((LoadUnitHandle(LY,(handle_id),(14)))),GetUnitY((LoadUnitHandle(LY,(handle_id),(14)))),0)
call SetUnitScale(GK,2.5,2.5,2.5)
call KillUnit(GK)
call SetUnitPosition((LoadUnitHandle(LY,(handle_id),(14))),GetUnitX(dummy),GetUnitY(dummy))
call ShowUnit((LoadUnitHandle(LY,(handle_id),(14))),false)
call ShowUnit((LoadUnitHandle(LY,(handle_id),(14))),true)
call SelectUnitAddForPlayer((LoadUnitHandle(LY,(handle_id),(14))),GetOwningPlayer((LoadUnitHandle(LY,(handle_id),(14)))))
set CII[GetPlayerId(GetOwningPlayer(dummy))]=null
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)>120 then
set CII[GetPlayerId(GetOwningPlayer(dummy))]=null
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitScale(dummy,2.5,2.5,2.5)
call KillUnit(dummy)
else
set x=GetUnitX(dummy)
set y=GetUnitY(dummy)
set H03=NTI()
set XK=g
set GK=dummy
set AK=level*70
call GroupEnumUnitsInRange(H03,x,y,225+25,Condition(function CH1))
call ForGroup(H03,function GQ3)
call NSI(H03)
call MUSetUnitX(dummy,PTI(x+15*Cos(RM2*bj_DEGTORAD)))
call MUSetUnitY(dummy,PUI(y+15*Sin(RM2*bj_DEGTORAD)))
endif
set t=null
set g=null
set H03=null
set dummy=null
return false
endfunction
function HI3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real x2=GetLocationX(point)
local real y2=GetLocationY(point)
local real RM2=UEI(x1,y1,x2,y2)
local integer level=GetUnitAbilityLevel(SFI,'A0S9')
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'h06O',x1,y1,RM2)
call IO1(NC,x1,y1)
call AddSkill(GetTriggerUnit(),'A0SA')
set CII[GetPlayerId(GetOwningPlayer(SFI))]=dummy
call SetUnitScale(dummy,3.5,3.5,3.5)
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function GU3))
call RemoveLocation(point)
set t=null
set dummy=null
set g=null
set SFI=null
set point=null
endfunction
function H13 takes nothing returns nothing
local integer i=GetPlayerId(GetOwningPlayer(GetTriggerUnit()))
if CII[i]==null then
call PZI(GetOwningPlayer(GetTriggerUnit()),"未发现幻像法球")
else
call SetUnitScale(CII[i],2.5,2.5,2.5)
call KillUnit(CII[i])
endif
endfunction
function HO3 takes nothing returns boolean
if GetSpellAbilityId()=='A0S9' then
call HI3()
endif
if GetSpellAbilityId()=='A0SA' then
call H13()
endif
return false
endfunction
function IllusoryOrb_Learn takes nothing returns boolean
if GetLearnedSkill()=='A0S9' and GetUnitAbilityLevel(GetTriggerUnit(),'A0S9')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call AddSkill(GetTriggerUnit(),'A0SA')
endif
return false
endfunction
function SJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HO3))
set t=null
endfunction
function H23 takes nothing returns boolean
return GetSpellAbilityId()=='A21E'
endfunction
function H33 takes nothing returns nothing
call MUSetUnitX(GetEnumUnit(),C1I)
call MUSetUnitY(GetEnumUnit(),COI)
endfunction
function H43 takes nothing returns nothing
local destructable array dx
local integer TGI
local integer THI
local fogmodifier H53
local unit dummy=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local location AM3
local real x
local real y
local group g=NTI()
if target==null then
set AM3=GetSpellTargetLoc()
else
set AM3=GetUnitLoc(target)
endif
set x=GetLocationX(AM3)
set y=GetLocationY(AM3)
set C1I=x
set COI=y
if IsUnitAlly(dummy,GetOwningPlayer(target))==true or CanResistSkill(GetSpellTargetUnit())==false then
set GK=dummy
call GroupEnumUnitsInRange(g,x,y,150,Condition(function CA1))
call O71(CreateFogModifierRadiusLocBJ(true,GetOwningPlayer(dummy),FOG_OF_WAR_VISIBLE,AM3,1000.00),2.25+0.75*GetUnitAbilityLevel(dummy,'A21E'))
set TGI=1
set THI=8
loop
exitwhen TGI>THI
call OA1(CreateDestructableLoc('B005',M7I(AM3,150.00,(I2R(TGI)*45.00)),GetRandomReal(0,360),1,0),2.25+0.75*GetUnitAbilityLevel(dummy,'A21E'))
set TGI=TGI+1
endloop
endif
call RemoveLocation(AM3)
call ForGroup(g,function H33)
call NSI(g)
set H53=null
set dummy=null
set target=null
set AM3=null
set g=null
endfunction
function H63 takes nothing returns nothing
if GetSpellAbilityId()=='A21E' and IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endfunction
function XL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function H23))
call TriggerAddAction(t,function H43)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddAction(t,function H63)
endfunction
constant function Teleportation_AbilityCode takes nothing returns integer
return 'A01O'
endfunction
function H73 takes nothing returns boolean
return GetSpellAbilityId()==('A01O')
endfunction
function H83 takes nothing returns nothing
local location BFO=GetSpellTargetLoc()
local real x=GetLocationX(BFO)
local real y=GetLocationY(BFO)
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(GetTriggerUnit()))then
call PingMinimapEx(x,y,3,255,255,255,false)
endif
call DestroyEffect(AddSpecialEffect("war3mapImported\\FurionTeleportTarget.mdx",x,y))
call DestroyEffect(AddSpecialEffect("war3mapImported\\FurionTeleportTarget.mdx",GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit())))
call RemoveLocation(BFO)
endfunction
function XM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CHANNEL)
call TriggerAddCondition(t,Condition(function H73))
call TriggerAddAction(t,function H83)
endfunction
function H93 takes unit hero,real x,real y returns nothing
local unit HA3=CreateUnit(GetOwningPlayer(hero),'efon',x,y,0)
call UnitApplyTimedLife(HA3,'BEfn',60)
call SetUnitVertexColor(HA3,175,255,175,175)
call SetUnitFlyHeight(HA3,0,0)
set HA3=null
endfunction
function HB3 takes nothing returns nothing
if(RJI(GetEnumDestructable())or GetDestructableTypeId(GetEnumDestructable())=='B005')and C2I<=C3I and GetDestructableLife(GetEnumDestructable())>0 then
set C2I=C2I+1
call H93(GetTriggerUnit(),GetDestructableX(GetEnumDestructable()),GetDestructableY(GetEnumDestructable()))
call KillDestructable(GetEnumDestructable())
endif
endfunction
function HC3 takes nothing returns nothing
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'AEfn')
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real d=75+75*level+50
local rect r=Rect(x-d,y-d,x+d,y+d)
set C2I=0
set C3I=level
call EnumDestructablesInRect(r,Condition(function N1I),function HB3)
call RemoveRect(r)
call RemoveLocation(point)
set point=null
set r=null
endfunction
function ForceOfNature_Main takes nothing returns boolean
if GetSpellAbilityId()=='AEfn' then
call HC3()
endif
return false
endfunction
function XN1 takes nothing returns nothing
endfunction
function HD3 takes nothing returns nothing
local unit target=GetEnumUnit()
local real d=QNI(GetUnitX(target),GetUnitY(target),C6I,C7I)
if d<C5I and IsUnitVisible(target,GetOwningPlayer(C8I))==true then
set C4I=GetEnumUnit()
set C5I=d
endif
set target=null
endfunction
function HE3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A1W8')
local integer OO1='A07X'
local group g
local unit dummy
if level==0 then
set level=GetUnitAbilityLevel(GetTriggerUnit(),'A1W9')
set OO1='A0AL'
endif
if target==null then
set C4I=null
set C8I=hero
set C5I=999999
set C6I=GetSpellTargetX()
set C7I=GetSpellTargetY()
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function CA1))
call ForGroup(g,function HD3)
call NSI(g)
set target=C4I
set g=null
endif
if target!=null then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,OO1)
call SetUnitAbilityLevel(dummy,OO1,level)
call IssueTargetOrder(dummy,"chainlightning",target)
set dummy=null
endif
set hero=null
set target=null
endfunction
function HF3 takes nothing returns boolean
if GetSpellAbilityId()=='A1W8' or GetSpellAbilityId()=='A1W9' then
call HE3()
endif
return false
endfunction
function XS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HF3))
set t=null
endfunction
function HG3 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=GetUnitAbilityLevel(hero,'A0QR')
local real AB3
local real HH3=0.35
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1B3')
set HH3=0.65
endif
call AddSkill(dummy,'A0QU')
call SetUnitAbilityLevel(dummy,'A0QU',level)
call IssueTargetOrder(dummy,"slow",target)
if level==1 then
set AB3=0.35
elseif level==2 then
set AB3=0.35
else
set AB3=0.35
endif
call Damage(hero,hero,1,GetUnitState(hero,UNIT_STATE_LIFE)*AB3)
call Damage(hero,target,1,GetUnitState(target,UNIT_STATE_LIFE)*HH3)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",hero,"chest"))
call DestroyEffect(AddSpecialEffectTarget("effects\\LifeBreak.mdx",target,"chest"))
set hero=null
set target=null
set dummy=null
endfunction
function HZ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real x
local real y
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real RM2=Atan2(QKI-QYI,QJI-QXI)
if GetUnitTypeId(hero)=='E02X' then
call SetUnitAnimationByIndex(hero,1)
else
call SetUnitAnimationByIndex(hero,17)
endif
if GetTriggerEventId()==EVENT_WIDGET_DEATH or QNI(II3,I13,QJI,QKI)>1400 or BG1(hero)then
call SetUnitPathing(hero,true)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call UnitRemoveAbility(hero,'A0ST')
call SetUnitTimeScale(hero,1.0)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif QNI(QXI,QYI,QJI,QKI)<125 then
call SetUnitPathing(hero,true)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call UnitRemoveAbility(hero,'A0ST')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitTimeScale(hero,1.0)
if target!=null and IsUnitDead(target)==false then
call IssueTargetOrder(hero,"attack",target)
call HG3(hero,target)
endif
else
call SetUnitPathing(hero,false)
set II3=QJI
set I13=QKI
call SaveReal(LY,(handle_id),(23),((II3)*1.0))
call SaveReal(LY,(handle_id),(24),((I13)*1.0))
set x=QXI+15*Cos(RM2)
set y=QYI+15*Sin(RM2)
call SetUnitPosition(hero,x,y)
call SetUnitFacing(hero,RM2*bj_RADTODEG)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function HV3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.015,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function HZ3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\LifeBreakCharge.mdx",hero,"hand right alternate")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\LifeBreakCharge.mdx",hero,"hand left alternate")))
call SetUnitPathing(hero,false)
call AddSkill(hero,'A0ST')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A0ST',false)
call SetUnitAnimationByIndex(hero,17)
call SetUnitTimeScale(hero,3.0)
set hero=null
set target=null
set t=null
endfunction
function HW3 takes nothing returns boolean
if(GetSpellAbilityId()=='A0QR' or GetSpellAbilityId()=='A1B3')and CanResistSkill(GetSpellTargetUnit())==false then
call HV3()
endif
return false
endfunction
function SO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HW3))
set t=null
call Q1I('A0QU')
endfunction
function HX3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer HY3=SHI(target)
local real QZI=GetUnitState(target,UNIT_STATE_LIFE)
local real R2O=GetUnitState(target,UNIT_STATE_MAX_LIFE)
local real HJ3
if QZI/R2O>0.4 then
set HJ3=I2R(level)/4*0.2*HY3+10
else
set HJ3=0.2*level*HY3+10
endif
set HJ3=HJ3/8.0
if GetTriggerEvalCount(t)>16*8.0 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(31))))
call UnitRemoveAbility(target,'A0QO')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitState(target,UNIT_STATE_LIFE,QZI+HJ3)
endif
set target=null
set t=null
return false
endfunction
function HK3 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A0QP')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1/8.0,true)
call TriggerAddCondition(t,Condition(function HX3))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(31),(AddSpecialEffectTarget("InnerVitality.mdx",target,"chest")))
call AddSkill(target,'A0QO')
call SetUnitAbilityLevel(target,'A0QO',level)
set target=null
set hero=null
set t=null
endfunction
function HL3 takes nothing returns boolean
if GetSpellAbilityId()=='A0QP' then
call HK3()
endif
return false
endfunction
function S01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HL3))
endfunction
function HM3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer KAO
local integer HN3
local integer HS3
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEvalCount(t)>8 or IsUnitDead(target)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(31))))
call FlushChildHashtable(LY,(handle_id))
set KAO=GetHandleId(hero)
set HN3=6000+GetHandleId(target)
set HS3=(LoadInteger(LY,(KAO),(HN3)))
set HS3=HS3-1
if HS3==0 then
call SaveInteger(LY,(KAO),(HN3),(0))
else
call SaveInteger(LY,(KAO),(HN3),(HS3))
endif
call NXI(PCI)
call FlushTrigger(t)
else
call Damage(hero,target,1,5*GetUnitAbilityLevel(hero,'A0QN'))
endif
set t=null
set target=null
set hero=null
return false
endfunction
function HT3 takes unit hero,unit target returns nothing
local integer handle_id=GetHandleId(hero)
local integer KAO
local trigger t
local integer HR3=(LoadInteger(LY,(handle_id),(6000+GetHandleId(target))))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function HM3))
set KAO=GetHandleId(t)
call SaveUnitHandle(LY,(KAO),(2),(hero))
call SaveInteger(LY,(KAO),(30),(NKI(target)))
call SaveInteger(LY,(handle_id),(6000+GetHandleId(target)),(HR3+1))
call SaveEffectHandle(LY,(KAO),(31),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\BreathOfFire\\BreathOfFireDamage.mdl",target,"chest")))
set t=null
endfunction
function HP3 takes nothing returns boolean
local real d
if GetUnitAbilityLevel(GetTriggerUnit(),'B081')>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A0QN')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
call SetUnitState(GetEventDamageSource(),UNIT_STATE_LIFE,QDI(GetUnitState(GetEventDamageSource(),UNIT_STATE_LIFE)-15,1))
call UnitRemoveAbility(GetTriggerUnit(),'B081')
call HT3(GetEventDamageSource(),GetTriggerUnit())
call DisableTrigger(GetTriggeringTrigger())
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function HQ3 takes nothing returns nothing
local trigger t
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
set target=GetSpellTargetUnit()
set hero=GetTriggerUnit()
else
set target=GetTriggerUnit()
set hero=GetAttacker()
endif
if IsUnitIllusion(hero)==false then
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function HP3))
endif
set t=null
set target=null
set hero=null
endfunction
function HU3 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetUnitAbilityLevel(GetAttacker(),'A0QN')>0 and(LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
call HQ3()
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if(GetIssuedOrderId()==OrderId("poisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(true))
elseif(GetIssuedOrderId()==OrderId("unpoisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(false))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A0QN' then
call HQ3()
endif
return false
endfunction
function Z03 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function HU3))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function ZI3 takes nothing returns boolean
if GetLearnedSkill()=='A0QN' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0QN')==1 then
call Z03()
endif
return false
endfunction
function SI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function ZI3))
set t=null
endfunction
function Z13 takes unit SFI,integer ZO3 returns nothing
local integer i=0
loop
exitwhen i>24
if i!=ZO3/4 and GetUnitAbilityLevel(SFI,C9I[i])>0 then
call UnitRemoveAbility(SFI,C9I[i])
endif
set i=i+1
endloop
if GetUnitAbilityLevel(SFI,C9I[ZO3/4])==0 then
call AddSkill(SFI,C9I[ZO3/4])
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),C9I[ZO3/4],false)
endif
endfunction
function Z23 takes nothing returns boolean
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real Z33=GetUnitState(SFI,UNIT_STATE_LIFE)
local real MaxHealth=GetUnitState(SFI,UNIT_STATE_MAX_LIFE)
local integer Z43
local integer Z53
local integer level=GetUnitAbilityLevel(SFI,'A0QQ')
local boolean Z63=(LoadBoolean(LY,(handle_id),(319)))
if IsUnitType(SFI,UNIT_TYPE_HERO)==true and level>0 then
set Z43=R2I(100*GetUnitState(SFI,UNIT_STATE_LIFE)/GetUnitState(SFI,UNIT_STATE_MAX_LIFE))
set Z53=QAI(Q9I(R2I(100-Z43)/7,14),1)
if IsUnitDead(SFI)==false then
if(GetUnitAbilityLevel(SFI,'BNdo')>0)then
set Z53=0
endif
call G81(SFI,(12+level*2)*Z53)
call Z13(SFI,(3+level)*Z53)
if Z43<40 then
if Z63==false then
call SaveBoolean(LY,(handle_id),(319),(true))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\TrollBerserk\\HeadhunterWEAPONSLeft.mdl",SFI,"left weapon")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("effects\\HeadhunterWEAPONSRight_NoSound.mdx",SFI,"right weapon")))
endif
else
if Z63==true then
call SaveBoolean(LY,(handle_id),(319),(false))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
endif
endif
endif
endif
set SFI=null
return false
endfunction
function Z73 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function Z23))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
call SaveBoolean(LY,(GetHandleId(t)),(319),(false))
set t=null
endfunction
function Z83 takes nothing returns boolean
if GetLearnedSkill()=='A0QQ' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0QQ')==1 then
call Z73()
endif
return false
endfunction
function S11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function Z83))
set C9I[1]='A2PM'
set C9I[2]='A2PN'
set C9I[3]='A2PO'
set C9I[4]='A2PP'
set C9I[5]='A2PQ'
set C9I[6]='A2PJ'
set C9I[7]='A2PR'
set C9I[8]='A2PI'
set C9I[9]='A2PL'
set C9I[10]='A2PT'
set C9I[11]='A2Q1'
set C9I[12]='A2PU'
set C9I[13]='A2PH'
set C9I[14]='A2PV'
set C9I[15]='A2PW'
set C9I[16]='A2PX'
set C9I[17]='A2PY'
set C9I[18]='A2PZ'
set C9I[19]='A2Q0'
set C9I[20]='A2PK'
set C9I[21]='A2PS'
set C9I[22]='A2TA'
set C9I[23]='A2TB'
set C9I[24]='A2TC'
set t=null
endfunction
function Z93 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer id=GetPlayerId(GetOwningPlayer(hero))
local integer NPI=GetTriggerEvalCount(t)
local real IV1=x+150*NPI*Cos(a)
local real IW1=y+150*NPI*Sin(a)
local integer ZA3=6
if GetUnitAbilityLevel(hero,'A0O5')==0 then
set ZA3=11
endif
call IssuePointOrder(CAI[id],"flamestrike",IV1,IW1)
if NPI==(ZA3)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitAnimation(hero,"stand")
endif
set t=null
set hero=null
return false
endfunction
function ZB3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local integer level=GetUnitAbilityLevel(hero,'A0O5')
local integer ZC3='A0OE'
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1B1')
set ZC3='A1B2'
endif
call RemoveLocation(point)
call SetUnitAnimation(hero,"spell")
set CAI[GetPlayerId(GetOwningPlayer(hero))]=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call AddSkill(CAI[GetPlayerId(GetOwningPlayer(hero))],ZC3)
call SetUnitAbilityLevel(CAI[GetPlayerId(GetOwningPlayer(hero))],ZC3,level)
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
if ZC3=='A0OE' then
call TriggerRegisterTimerEvent(t,0.1,true)
else
call TriggerRegisterTimerEvent(t,0.05,true)
endif
call TriggerAddCondition(t,Condition(function Z93))
set t=null
set hero=null
set point=null
endfunction
function ZD3 takes nothing returns boolean
if GetSpellAbilityId()=='A0O5' or GetSpellAbilityId()=='A1B1' then
call ZB3()
endif
return false
endfunction
function WS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZD3))
call Q1I('A0OE')
set t=null
endfunction
function ZE3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEvalCount(t)>10 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A1G5')
call UnitRemoveAbility(target,'A1G3')
call UnitRemoveAbility(target,'A1G6')
call UnitRemoveAbility(target,'A1G4')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call Damage(hero,target,1,(level*4+8)/2)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function ZF3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=CCI
local unit hero=CBI
local unit target=GetEnumUnit()
if level==1 then
call AddSkill(target,'A1G5')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1G5',false)
elseif level==2 then
call AddSkill(target,'A1G3')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1G3',false)
elseif level==3 then
call AddSkill(target,'A1G6')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1G6',false)
elseif level==4 then
call AddSkill(target,'A1G4')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1G4',false)
endif
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\BreathOfFire\\BreathOfFireDamage.mdl",target,"chest")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ZE3))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Doom\\DoomDeath.mdl",GetUnitX(target),GetUnitY(target)))
set t=null
set hero=null
set target=null
endfunction
function ZG3 takes unit hero,unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A2VO')
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local group g=NTI()
local group g2=NTI()
set CCI=level
set CBI=hero
set GK=hero
call GroupEnumUnitsInRange(g,x,y,300+25,Condition(function CZ1))
call GroupEnumUnitsInRange(g2,x,y,300+25,Condition(function C41))
call GroupAddGroup(g2,g)
call ForGroup(g,function ZF3)
call NSI(g)
call NSI(g2)
set t=null
set g=null
set g2=null
endfunction
function ZH3 takes nothing returns boolean
if GetUnitAbilityLevel(GetTriggerUnit(),'B0GX')>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A2UM')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
call UnitRemoveAbility(GetTriggerUnit(),'B0GX')
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
call ZG3(GetEventDamageSource(),GetTriggerUnit())
endif
return false
endfunction
function ZZ3 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function ZH3))
set t=null
set target=null
set hero=null
endfunction
function ZV3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call IssueImmediateOrder(hero,"unpoisonarrows")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function ZW3 takes nothing returns boolean
local unit hero=GetTriggerUnit()
local trigger t
if GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if GetIssuedOrderId()==OrderId("poisonarrows")then
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function ZV3))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A2UM' then
call ZZ3()
endif
return false
endfunction
function ZX3 takes nothing returns nothing
local trigger t
if GetUnitAbilityLevel(GetTriggerUnit(),'A2VO')==1 then
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function ZW3))
set t=null
endif
if GetUnitAbilityLevel(GetTriggerUnit(),'A2UM')==0 then
call AddSkill(GetTriggerUnit(),'A2UM')
endif
call SetUnitAbilityLevel(GetTriggerUnit(),'A2UM',GetUnitAbilityLevel(GetTriggerUnit(),'A2VO'))
endfunction
function ZY3 takes nothing returns boolean
if GetLearnedSkill()=='A2VO' and IsUnitIllusion(GetTriggerUnit())==false then
call ZX3()
endif
return false
endfunction
function WM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function ZY3))
set t=null
endfunction
function ZJ3 takes nothing returns nothing
local unit hero=CEI
local unit target=GetEnumUnit()
local unit ZK3
if IsUnitInGroup(target,CDI)==false then
call GroupAddUnit(CDI,target)
call DD1(hero,target,CFI)
call Damage(hero,target,1,50)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\FreezingBreath\\FreezingBreathMissile.mdl",GetUnitX(target),GetUnitY(target)))
endif
endfunction
function ZL3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x0=(LoadReal(LY,(handle_id),(6)))
local real y0=(LoadReal(LY,(handle_id),(7)))
local real a=(LoadReal(LY,(handle_id),(137)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=GetTriggerEvalCount(t)
local real x
local real y
local group g
local integer i
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local integer level=GetUnitAbilityLevel(hero,'A0O6')
set i=0
loop
exitwhen i>10
set x=x0+100*i*Cos(a*bj_DEGTORAD)
set y=y0+100*i*Sin(a*bj_DEGTORAD)
if ModuloInteger(NPI,10)==0 then
endif
set GK=hero
set CEI=hero
set CDI=PR2
set CFI=(0.6+0.4*level)-(NPI*0.05)
set CGI=level
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,150+25,Condition(function CA1))
call ForGroup(g,function ZJ3)
call NSI(g)
set i=i+1
endloop
if NPI==20*(0.6+0.4*level)then
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set g=null
set PR2=null
return false
endfunction
function ZM3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x0=(LoadReal(LY,(handle_id),(6)))
local real y0=(LoadReal(LY,(handle_id),(7)))
local real a=(LoadReal(LY,(handle_id),(137)))
local integer NPI=GetTriggerEvalCount(t)
local real x=x0+100*NPI*Cos(a*bj_DEGTORAD)
local real y=y0+100*NPI*Sin(a*bj_DEGTORAD)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A0O6')
local ubersplat AR1
local integer i
if NPI<10 then
call SaveEffectHandle(LY,(handle_id),(609+NPI),(AddSpecialEffect("effects\\IcePath.mdx",x,y)))
set AR1=CreateUbersplat(x,y,"IPTH",255,255,255,255,false,false)
call SetUbersplatRenderAlways(AR1,true)
call SaveUbersplatHandle(LY,(handle_id),(760+NPI),(AR1))
endif
if NPI==10 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function ZL3))
call SaveReal(LY,(handle_id),(6),((x0)*1.0))
call SaveReal(LY,(handle_id),(7),((y0)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call TriggerEvaluate(t)
elseif NPI>=(0.4+0.6+0.4*level)/.05 then
set i=0
loop
exitwhen i==10
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(609+i))))
call DestroyUbersplat((LoadUbersplatHandle(LY,(handle_id),(760+i))))
set i=i+1
endloop
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function ZN3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real a=UEI(x,y,GetSpellTargetX(),GetSpellTargetY())
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function ZM3))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerEvaluate(t)
set t=null
set hero=null
endfunction
function ZS3 takes nothing returns boolean
if GetSpellAbilityId()=='A0O6' then
call ZN3()
endif
return false
endfunction
function WN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZS3))
set t=null
endfunction
function ZT3 takes real x1,real y1,real x2,real y2,real x3,real y3,real x,real y returns boolean
local real ZR3=(y-y1)*(x2-x1)-(x-x1)*(y2-y1)
local real ZP3=(y-y3)*(x1-x3)-(x-x3)*(y1-y3)
local real ZQ3=(y-y2)*(x3-x2)-(x-x2)*(y3-y2)
return(ZR3*ZP3>0)and(ZQ3*ZP3>0)
endfunction
function ZU3 takes nothing returns boolean
local real V03=AK
local real VI3=BK
local real V13=CK
local real VO3=DK
local real V23=EK
local real V33=FK
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and ZT3(V03,VI3,V13,VO3,V23,V33,GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()))
endfunction
function V43 takes real V53,real V63,real V73 returns nothing
local real V83=600
local real V93=200
local real VA3=250
local real VB3=Asin((VA3-V93)/V83)
local real x=V93/Sin(VB3)
local real y=(V83+VA3+x)*Tan(VB3)
local real V03=V63+x*Cos((V53-180)*bj_DEGTORAD)
local real VI3=V73+x*Sin((V53-180)*bj_DEGTORAD)
local real V13=(V63+(V83+VA3)*Cos(V53*bj_DEGTORAD))+y*Cos((V53-90)*bj_DEGTORAD)
local real VO3=(V73+(V83+VA3)*Sin(V53*bj_DEGTORAD))+y*Sin((V53-90)*bj_DEGTORAD)
local real V23=(V63+(V83+VA3)*Cos(V53*bj_DEGTORAD))+y*Cos((V53+90)*bj_DEGTORAD)
local real V33=(V73+(V83+VA3)*Sin(V53*bj_DEGTORAD))+y*Sin((V53+90)*bj_DEGTORAD)
set AK=V03
set BK=VI3
set CK=V13
set DK=VO3
set EK=V23
set FK=V33
endfunction
function VC3 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call AddSkill(dummy,'A2ZE')
call SetUnitAbilityLevel(dummy,'A2ZE',GetUnitAbilityLevel(GetTriggerUnit(),'A0O7'))
call IssueTargetOrder(dummy,"slow",GetEnumUnit())
set dummy=null
endfunction
function VD3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit dummy
if GetTriggerEvalCount(t)>1 then
call SetUnitAnimation(SFI,"stand")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitAnimation(SFI,"spell")
set dummy=CreateUnit(p,'e00E',x,y,0)
call AddSkill(dummy,'A0OC')
call SetUnitAbilityLevel(dummy,'A0OC',level)
call IssuePointOrder(dummy,"breathoffrost",QJI,QKI)
endif
set t=null
set p=null
set SFI=null
set dummy=null
return false
endfunction
function VE3 takes unit u,player p,integer level,location point,real x,real y returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SavePlayerHandle(LY,(handle_id),(54),(p))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(47),((GetLocationX(point))*1.0))
call SaveReal(LY,(handle_id),(48),((GetLocationY(point))*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(14),(u))
call TriggerRegisterTimerEvent(t,0.3,true)
call TriggerAddCondition(t,Condition(function VD3))
set t=null
endfunction
function VF3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A0O7')
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local location point
local unit dummy
local group g=NTI()
if GetSpellTargetUnit()==null then
set point=GetSpellTargetLoc()
else
set point=GetUnitLoc(GetSpellTargetUnit())
endif
call V43(bj_RADTODEG*Atan2(GetLocationY(point)-y,GetLocationX(point)-x),x,y)
call GroupEnumUnitsInRange(g,x,y,2000,Condition(function ZU3))
call ForGroup(g,function VC3)
call NSI(g)
set dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',x,y,0)
call AddSkill(dummy,'A0OB')
call SetUnitAbilityLevel(dummy,'A0OB',level)
call IssuePointOrder(dummy,"breathoffire",GetLocationX(point),GetLocationY(point))
call VE3(SFI,GetOwningPlayer(SFI),level,point,x+50*Cos(Atan2(GetLocationY(point)-y,GetLocationX(point)-x)),y+50*Sin(Atan2(GetLocationY(point)-y,GetLocationX(point)-x)))
call RemoveLocation(point)
set SFI=null
set point=null
set g=null
endfunction
function VG3 takes nothing returns boolean
if GetSpellAbilityId()=='A0O7' then
call VF3()
endif
return false
endfunction
function WL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VG3))
call Q1I('A0OB')
call Q1I('A0OC')
call Q1I('A2ZE')
set t=null
endfunction
function VH3 takes unit SFI,unit target returns nothing
local real a=GetRandomReal(0,360)
local real x=GetUnitX(target)+50*Cos(a*bj_DEGTORAD)
local real y=GetUnitY(target)+50*Sin(a*bj_DEGTORAD)
local real VZ3=GetRandomReal(200,225)
if((LoadInteger(LY,(GetHandleId((SFI))),((4256))))==1)==false then
call SetUnitPosition(SFI,x,y)
else
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
endif
call SetUnitFacing(SFI,bj_RADTODEG*Atan2(GetUnitY(target)-GetUnitY(SFI),GetUnitX(target)-GetUnitX(SFI)))
call SetUnitAnimation(SFI,"Attack")
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl",SFI,"chest"))
if T2I(GetOwningPlayer(target))==false and IsUnitType(target,UNIT_TYPE_ANCIENT)==false then
set VZ3=99999
endif
call Damage(SFI,target,2,VZ3)
if((LoadInteger(LY,(GetHandleId((SFI))),((4256))))==1)==false then
call IssueTargetOrder(SFI,"attack",target)
endif
endfunction
function VV3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call VH3(SFI,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
set target=null
return false
endfunction
function VW3 takes unit SFI returns nothing
local group g=NTI()
set GK=SFI
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),450,Condition(function D71))
set GK=GroupPickRandomUnit(g)
if GK!=null then
call VH3(SFI,GK)
endif
call NSI(g)
set g=null
endfunction
function VX3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer VY3=(LoadInteger(LY,(handle_id),(216)))
local integer VJ3=(LoadInteger(LY,(handle_id),(325)))
local integer QX2=(LoadInteger(LY,(handle_id),(28)))
local unit VK3
if QX2>VY3 then
call KillUnit(dummy)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A05G',true)
call SetUnitPathing(SFI,true)
call SetUnitInvulnerable(SFI,false)
call SaveInteger(LY,(GetHandleId((SFI))),((4253)),(2))
call SetUnitVertexColor(SFI,255,255,255,255)
else
call SaveInteger(LY,(handle_id),(28),(QX2+1))
call VW3(SFI)
if GK==null then
call KillUnit(dummy)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A05G',true)
call SetUnitPathing(SFI,true)
call SetUnitInvulnerable(SFI,false)
call SaveInteger(LY,(GetHandleId((SFI))),((4253)),(2))
call SetUnitVertexColor(SFI,255,255,255,255)
endif
endif
set t=null
set SFI=null
set VK3=null
set dummy=null
return false
endfunction
function VL3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A0M1')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer VJ3=GetUnitAbilityLevel(SFI,'A05G')
local player p=GetOwningPlayer(SFI)
local integer VY3=3
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'o00D',GetUnitX(SFI),GetUnitY(SFI),0)
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A1AX')
if level==1 then
set VY3=6
elseif level==2 then
set VY3=9
elseif level==3 then
set VY3=12
endif
elseif level==2 then
set VY3=6
elseif level==3 then
set VY3=9
endif
call SetPlayerAbilityAvailable(p,'A05G',false)
call SetUnitVertexColor(SFI,255,255,255,125)
call SetUnitPathing(SFI,false)
call SetUnitInvulnerable(SFI,true)
call SaveInteger(LY,(GetHandleId((SFI))),((4253)),(1))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function VV3))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(216),(VY3))
call SaveInteger(LY,(handle_id),(325),(VJ3))
call SaveInteger(LY,(handle_id),(28),(2))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Weapons\\PhoenixMissile\\Phoenix_Missile_mini.mdl",SFI,"weapon")))
call TriggerRegisterTimerEvent(t,0.4,true)
call TriggerAddCondition(t,Condition(function VX3))
set SFI=null
set target=null
set t=null
set p=null
endfunction
function VM3 takes nothing returns boolean
if GetSpellAbilityId()=='A0M1' or GetSpellAbilityId()=='A1AX' then
call VL3()
endif
return false
endfunction
function VN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitAnimationByIndex(hero,4)
set t=null
set hero=null
return false
endfunction
function VS3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function VN3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function VT3 takes nothing returns boolean
if GetSpellAbilityId()=='A0M1' or GetSpellAbilityId()=='A1AX' then
call VS3()
endif
return false
endfunction
function XR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VM3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function VT3))
set t=null
endfunction
function VR3 takes nothing returns nothing
call Damage(CHI,GetEnumUnit(),1,(60.0+20.0*CZI)*0.25)
endfunction
function VP3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=GetTriggerEvalCount(t)
local group g
if NPI==20 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set GK=hero
set CHI=hero
set CZI=GetUnitAbilityLevel(hero,'A05G')
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),275,Condition(function CA1))
call ForGroup(g,function VR3)
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function VQ3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function VP3))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call TriggerEvaluate(t)
call SCI(GetTriggerUnit(),4252,5)
endfunction
function VU3 takes nothing returns boolean
if GetSpellAbilityId()=='A05G' then
call VQ3()
endif
return false
endfunction
function XP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VU3))
set t=null
endfunction
function W03 takes nothing returns boolean
return GetUnitTypeId(GetSummonedUnit())=='o00C' or GetUnitTypeId(GetSummonedUnit())=='o01G' or GetUnitTypeId(GetSummonedUnit())=='o01H' or GetUnitTypeId(GetSummonedUnit())=='o01I'
endfunction
function WI3 takes nothing returns nothing
call SetUnitAbilityLevelSwapped('A058',GetSummonedUnit(),GetUnitAbilityLevelSwapped('A047',GetSummoningUnit()))
endfunction
function XT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function W03))
call TriggerAddAction(t,function WI3)
endfunction
function W13 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x1
local real y1
local real x2
local real y2
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetEventDamage()>2 and T2I(GetOwningPlayer(GetEventDamageSource())))then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_DAMAGED and GetTriggerEventId()!=EVENT_UNIT_DEATH then
set x1=GetUnitX(hero)
set y1=GetUnitY(hero)
set x2=GetUnitX(target)
set y2=GetUnitY(target)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportCaster.mdl",x1,y1))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTarget.mdl",x2,y2))
call SCI(target,4410,1)
call SetUnitPosition(target,GetUnitX(hero),GetUnitY(hero))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function WO3 takes nothing returns nothing
local unit target=GetEnumUnit()
local real d=QNI(GetUnitX(target),GetUnitY(target),CXI,CYI)
if d<CWI then
set CVI=GetEnumUnit()
set CWI=d
endif
set target=null
endfunction
function W23 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local trigger t
local integer handle_id
local real DC1
local group g
if target==null then
set CVI=null
set CWI=999999
set CXI=GetSpellTargetX()
set CYI=GetSpellTargetY()
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function CU1))
call GroupRemoveUnit(g,hero)
call ForGroup(g,function WO3)
call NSI(g)
set target=CVI
set g=null
endif
if GetSpellAbilityId()=='A10U' then
set DC1=5
elseif GetSpellAbilityId()=='A11Y' then
set DC1=4
elseif GetSpellAbilityId()=='A11Z' then
set DC1=3
elseif GetSpellAbilityId()=='A1N1' then
set DC1=3
endif
if target!=null then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,DC1,false)
call TriggerAddCondition(t,Condition(function W13))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTo.mdl",hero,"origin")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MassTeleport\\MassTeleportTo.mdl",target,"origin")))
endif
set target=null
set hero=null
set t=null
endfunction
function W33 takes nothing returns boolean
if GetSpellAbilityId()=='A10U' or GetSpellAbilityId()=='A11Y' or GetSpellAbilityId()=='A11Z' then
call W23()
endif
return false
endfunction
function W43 takes nothing returns boolean
if GetSpellAbilityId()=='A10U' or GetSpellAbilityId()=='A11Y' or GetSpellAbilityId()=='A11Z' then
if GetSpellTargetUnit()!=null and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endif
return false
endfunction
function YI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function W33))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function W43))
set t=null
endfunction
function W53 takes integer level returns integer
if level==1 then
return 'A10Z'
elseif level==2 then
return 'A111'
elseif level==3 then
return 'A10Y'
elseif level==4 then
return 'A110'
endif
return 0
endfunction
function W63 takes integer level returns integer
if level==1 then
return 'B09M'
elseif level==2 then
return 'B09N'
elseif level==3 then
return 'B09O'
elseif level==4 then
return 'B09L'
endif
return 0
endfunction
function W73 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real d=SquareRoot((II3-x)*(II3-x)+(I13-y)*(I13-y))
local real W83=(0.00050)*d*GetUnitState(target,UNIT_STATE_MAX_MANA)
local integer KO2=GetTriggerEvalCount(t)
local unit dummy
if RKI(target)==true then
set W83=0
endif
if d>300 then
set W83=0
endif
if W83>1 and ModuloInteger(GetTriggerEvalCount(t),3)==0 then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\WingedSerpentMissile\\WingedSerpentMissile.mdl",target,"chest"))
endif
if W83>0 then
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)-W83)
endif
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
if GetTriggerEventId()==EVENT_UNIT_DEATH or KO2==(level+4)*10 then
call UnitRemoveAbility(target,W53(level))
call UnitRemoveAbility(target,W63(level))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetUnitState(target,UNIT_STATE_MANA)<1 then
call DD1((LoadUnitHandle(LY,(handle_id),(2))),target,1+0.5*level)
set dummy=null
call UnitRemoveAbility(target,W53(level))
call UnitRemoveAbility(target,W63(level))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function W93 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A10X')
call AddSkill(target,W53(level))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\BasicWaterFlash.mdx",target,"chest")))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function W73))
set hero=null
set target=null
set t=null
endfunction
function WA3 takes nothing returns boolean
if GetSpellAbilityId()=='A10X' and CanResistSkill(GetSpellTargetUnit())==false then
call W93()
endif
return false
endfunction
function XQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function WA3))
set t=null
endfunction
function WB3 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false then
call GroupAddUnit(XK,GetEnumUnit())
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)+AK)
endif
endfunction
function WC3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local group H03
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer NPI=GetTriggerEvalCount(t)
local real DX1=1050*0.1
if NPI>19 then
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set x=x+NPI*DX1*Cos(RM2*bj_DEGTORAD)
set y=y+NPI*DX1*Sin(RM2*bj_DEGTORAD)
set H03=NTI()
set XK=g
set GK=hero
set AK=(50*level)*0.75
call GroupEnumUnitsInRange(H03,x,y,350+25,Condition(function CT1))
call ForGroup(H03,function WB3)
call NSI(H03)
endif
set t=null
set g=null
set H03=null
return false
endfunction
function WD3 takes unit hero,real x0,real y0,real x1,real y1,integer T82 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local real RM2=UEI(x0,y0,x1,y1)
call SaveInteger(LY,(handle_id),(5),(T82))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x0)*1.0))
call SaveReal(LY,(handle_id),(7),((y0)*1.0))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function WC3))
set t=null
set g=null
endfunction
function WE3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit WF3=(LoadUnitHandle(LY,(handle_id),(19)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local integer T82=(LoadInteger(LY,(handle_id),(34)))
local real WG3=GetUnitX(WF3)-50*Cos(RM2)
local real WH3=GetUnitY(WF3)-50*Sin(RM2)
local unit dummy=CreateUnit(GetOwningPlayer(WF3),'e00E',WG3,WH3,0)
local real x=GetUnitX(dummy)+50*Cos(RM2)
local real y=GetUnitY(dummy)+50*Sin(RM2)
local real x2=x+(300+50*T82)*Cos(RM2)
local real y2=y+(300+50*T82)*Sin(RM2)
local unit hero=K1[GetPlayerId(GetOwningPlayer(dummy))]
call AddSkill(dummy,'A087')
call SetUnitAbilityLevel(dummy,'A087',T82)
call IssuePointOrder(dummy,"breathoffire",x,y)
call KillUnit(WF3)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if hero!=null and PLI()and ES1(hero,FR0[JF0])!=null then
call WD3(hero,WG3,WH3,x,y,T82)
endif
set dummy=null
set t=null
return false
endfunction
function WZ3 takes unit WF3,integer T82,real RM2 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function WE3))
call SaveUnitHandle(LY,(handle_id),(19),(WF3))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveInteger(LY,(handle_id),(34),(T82))
set t=null
endfunction
function WV3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer T82=NPI-1
local real RM2=(LoadReal(LY,(handle_id),(13)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer WW3=2+level*2
local boolean WX3=(LoadBoolean(LY,(handle_id),(240)))
local unit ZK3
if GetTriggerEventId()!=EVENT_UNIT_SPELL_ENDCAST then
call SaveInteger(LY,(handle_id),(34),(NPI+1))
endif
call SetUnitScale(dummy,I2R(100+20*T82)/100,I2R(100+20*T82)/100,I2R(100+20*T82)/100)
if(GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST and WX3==false)or(GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST and GetSpellAbilityId()=='A121')or T82==WW3 then
if WX3 then
set ZK3=(LoadUnitHandle(LY,(handle_id),(239)))
call ShowUnit(ZK3,false)
call UnitApplyTimedLife(ZK3,'BTLF',1)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if(LoadInteger(LY,(GetHandleId(SFI)),(704)))==0 or(LoadInteger(LY,(GetHandleId(SFI)),(704)))=='A085' then
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A085',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A121',false)
call UnitRemoveAbility(SFI,'A121')
call WZ3(dummy,T82,RM2)
endif
set dummy=CreateUnit(GetOwningPlayer(dummy),'h06M',GetUnitX(dummy)+150*(T82)*Cos(RM2),GetUnitY(dummy)+150*(T82)*Sin(RM2),0)
call UnitApplyTimedLife(dummy,'BTLF',7)
set t=null
set dummy=null
set SFI=null
set ZK3=null
return false
endfunction
function WY3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call IssueImmediateOrder(SFI,"stop")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function WJ3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real RM2=Atan2(GetLocationY(point)-GetUnitY(SFI),GetLocationX(point)-GetUnitX(SFI))
local real x
local real y
local unit dummy
local unit ZK3
local boolean WX3=false
if GetLocationY(point)==GetUnitY(SFI)and GetLocationX(point)==GetUnitX(SFI)then
set RM2=GetUnitFacing(SFI)*bj_DEGTORAD
endif
set x=GetUnitX(SFI)+150*Cos(RM2)
set y=GetUnitY(SFI)+150*Sin(RM2)
set dummy=CreateUnit(GetOwningPlayer(SFI),'u00J',x,y,RM2*bj_RADTODEG)
call RemoveLocation(point)
if GetUnitTypeId(SFI)=='H06X' or GetUnitTypeId(SFI)=='H06Y' or GetUnitTypeId(SFI)=='H06W' then
set WX3=true
endif
call SaveBoolean(LY,(handle_id),(240),(WX3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(34),(1))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(SFI,'A085')))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function WV3))
if WX3 then
set ZK3=CreateUnit(GetOwningPlayer(SFI),'h06Z',GetUnitX(SFI),GetUnitY(SFI),RM2*bj_RADTODEG)
call MUSetUnitX(ZK3,GetUnitX(SFI))
call MUSetUnitY(ZK3,GetUnitY(SFI))
call SetUnitAnimation(ZK3,"spell")
call QueueUnitAnimation(ZK3,"spell")
call QueueUnitAnimation(ZK3,"spell")
call SetUnitVertexColor(ZK3,255,255,255,75)
call SaveUnitHandle(LY,(handle_id),(239),(ZK3))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function WY3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A085',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A121',true)
call AH1(SFI,'A121',1,6)
set t=null
set SFI=null
set dummy=null
set ZK3=null
set point=null
endfunction
function WK3 takes nothing returns boolean
if GetSpellAbilityId()=='A085' then
call WJ3()
endif
return false
endfunction
function Y01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function WK3))
set t=null
endfunction
function WL3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer DC1=(LoadInteger(LY,(handle_id),(188)))
local integer NPI=GetTriggerEvalCount(t)
if NPI==DC1 or GetUnitTypeId(hero)=='Hblm' then
if(LoadReal(LY,(GetHandleId(hero)),(241)))<=(TimerGetElapsed(M))or GetUnitTypeId(hero)=='Hblm' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A11T',true)
else
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function WM3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A11T')
local integer DC1=40
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A11T',false)
call SaveReal(LY,(GetHandleId(hero)),(241),(((TimerGetElapsed(M))+DC1)*1.0))
call SaveInteger(LY,(handle_id),(188),(DC1))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function WL3))
set t=null
set hero=null
endfunction
function Ignis_Main takes nothing returns boolean
if GetSpellAbilityId()=='A11T' and GetUnitTypeId(GetTriggerUnit())=='Hblm' then
call WM3()
endif
return false
endfunction
function YO1 takes nothing returns nothing
endfunction
function WN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real OA2=(LoadReal(LY,(handle_id),(242)))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)+OA2)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIim\\AIimTarget.mdl",target,"origin"))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set target=null
set t=null
return false
endfunction
function WS3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(242),((75*GetUnitAbilityLevel(SFI,'A112'))*1.0))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function WN3))
set t=null
set SFI=null
set target=null
endfunction
function WT3 takes nothing returns boolean
if GetSpellAbilityId()=='A112' then
call WS3()
endif
return false
endfunction
function XU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function WT3))
set t=null
endfunction
function WR3 takes nothing returns nothing
local unit target=GetEnumUnit()
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real a=Atan2(y-CLI,x-CKI)
set x=PTI(x+25*Cos(a))
set y=PUI(y+25*Sin(a))
call UPI(x,y,150)
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
set target=null
endfunction
function WP3 takes nothing returns nothing
local unit target=GetEnumUnit()
local unit dummy=CreateUnit(JK,'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A10W')
call SetUnitAbilityLevel(dummy,'A10W',CJI)
call IssueTargetOrder(dummy,"drunkenhaze",target)
set target=null
set dummy=null
endfunction
function WQ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local integer NPI=GetTriggerEvalCount(t)
set CKI=QXI
set CLI=QYI
call ForGroup(g,function WR3)
if NPI==16 then
if AF1=='A11X' then
set CJI=1
elseif AF1=='A11V' then
set CJI=2
else
set CJI=3
endif
set JK=p
call ForGroup(g,function WP3)
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set p=null
set g=null
return false
endfunction
function WU3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function WQ3))
call SavePlayerHandle(LY,(handle_id),(54),(p))
call SaveReal(LY,(handle_id),(189),((QXI)*1.0))
call SaveReal(LY,(handle_id),(190),((QYI)*1.0))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveInteger(LY,(handle_id),(59),(AF1))
set t=null
set p=null
set g=null
return false
endfunction
function X03 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
call KillUnit(CreateUnit(GetOwningPlayer(hero),'h06P',x,y,0))
set GK=hero
call GroupEnumUnitsInRange(g,x,y,700,Condition(function CE1))
call TriggerRegisterTimerEvent(t,0.4,false)
call TriggerAddCondition(t,Condition(function WU3))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(GetTriggerUnit())))
call SaveReal(LY,(handle_id),(189),((x)*1.0))
call SaveReal(LY,(handle_id),(190),((y)*1.0))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveInteger(LY,(handle_id),(59),(GetSpellAbilityId()))
set t=null
set g=null
set hero=null
endfunction
function XI3 takes nothing returns boolean
if GetSpellAbilityId()=='A11X' or GetSpellAbilityId()=='A11V' or GetSpellAbilityId()=='A11W' then
call X03()
endif
return false
endfunction
function Y11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XI3))
set t=null
endfunction
function X13 takes nothing returns boolean
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit XO3=(LoadUnitHandle(LY,(handle_id),(305)))
if hero==null or IsUnitDead(hero)or PLI()==false or ES1(hero,FR0[JF0])==null then
call ShowUnit(XO3,false)
else
call ShowUnit(XO3,true)
call MUSetUnitX(XO3,GetUnitX(hero))
call MUSetUnitY(XO3,GetUnitY(hero))
endif
if GetOwningPlayer(XO3)!=GetOwningPlayer(hero)then
call SetUnitOwner(XO3,GetOwningPlayer(hero),true)
endif
return false
endfunction
function X23 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2XR')
local trigger t
local integer handle_id
call UnitRemoveAbility(hero,'B0AA')
call UnitRemoveAbility(hero,'A11T')
if GetUnitAbilityLevel(hero,'A2KM')==0 then
call AddSkill(hero,'A2KM')
endif
if level==1 then
call UnitAddAbility(hero,'A2X4')
call UnitRemoveAbility(hero,'A2X4')
elseif level==2 then
call SetUnitAbilityLevel(hero,'A2KM',level)
call UnitAddAbility(hero,'A2X3')
call UnitRemoveAbility(hero,'A2X3')
call UnitRemoveAbility(hero,'A11X')
call UnitRemoveAbility(hero,'A10U')
call AddSkill(hero,'A11V')
call AddSkill(hero,'A11Y')
elseif level==3 then
call SetUnitAbilityLevel(hero,'A2KM',level)
call UnitAddAbility(hero,'A2X5')
call UnitRemoveAbility(hero,'A2X5')
call UnitRemoveAbility(hero,'A11X')
call UnitRemoveAbility(hero,'A10U')
call UnitRemoveAbility(hero,'A11V')
call UnitRemoveAbility(hero,'A11Y')
call AddSkill(hero,'A11W')
call AddSkill(hero,'A11Z')
endif
if level>0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function X13))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(305),(CreateUnit(GetOwningPlayer(GetTriggerUnit()),'o01A',GetUnitX(hero),GetUnitY(hero),0)))
set t=null
endif
set hero=null
endfunction
function X33 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2XQ')
local trigger t
local integer handle_id
if level==1 then
call AddSkill(hero,'A11T')
elseif level==2 then
call SetUnitAbilityLevel(hero,'A11T',level)
elseif level==3 then
call SetUnitAbilityLevel(hero,'A11T',level)
endif
set hero=null
endfunction
function X43 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_HERO_SKILL then
if GetLearnedSkill()=='A2XR' and IsUnitIllusion(GetTriggerUnit())==false then
call X23()
endif
if GetLearnedSkill()=='A2XQ' and IsUnitIllusion(GetTriggerUnit())==false then
call X33()
endif
else
if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM and GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and F01(GetManipulatedItem())==JF0 then
call X23()
endif
endif
return false
endfunction
function Y21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call TriggerAddCondition(t,Condition(function X43))
set t=null
endfunction
function X53 takes unit SFI,integer level returns integer
local integer X63
local integer X73
if level==1 then
set X73='B0B1'
set X63='A18Z'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0B0'
set X63='A19J'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0AY'
set X63='A19J'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
return 'A18Y'
elseif level==2 then
set X73='B0B8'
set X63='A19H'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0B7'
set X63='A19G'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0B2'
set X63='A19G'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
return 'A19I'
elseif level==3 then
set X73='B0B3'
set X63='A19E'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0B9'
set X63='A19D'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0B6'
set X63='A19D'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
return 'A19K'
elseif level==4 then
set X73='B0B5'
set X63='A196'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0B4'
set X63='A195'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
set X73='B0BA'
set X63='A195'
if GetUnitAbilityLevel(SFI,X73)>0 then
call UnitRemoveAbility(SFI,X73)
return X63
endif
return 'A19L'
endif
return 0
endfunction
function X83 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A18X')
local integer X93=X53(SFI,level)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
call AddSkill(dummy,X93)
call IssueTargetOrder(dummy,"bloodlust",SFI)
set SFI=null
set dummy=null
endfunction
function XA3 takes nothing returns boolean
if GetSpellAbilityId()=='A01F' or GetSpellAbilityId()=='A027' or GetSpellAbilityId()=='A01P' or GetSpellAbilityId()=='A09Z' then
call X83()
endif
return false
endfunction
function XB3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XA3))
set t=null
set SFI=null
endfunction
function XC3 takes nothing returns boolean
if GetLearnedSkill()=='A18X' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A18X')==1 then
call XB3()
endif
return false
endfunction
function TK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function XC3))
set t=null
endfunction
function XD3 takes nothing returns nothing
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A09Z')
local real PAI
if level==1 then
set PAI=450
elseif level==2 then
set PAI=675
elseif level==3 then
set PAI=950
endif
call Damage(GetTriggerUnit(),GetSpellTargetUnit(),7,PAI)
endfunction
function XE3 takes nothing returns boolean
if(GetSpellAbilityId()=='A09Z')and CanResistSkill(GetSpellTargetUnit())==false then
call XD3()
endif
return false
endfunction
function XF3 takes nothing returns boolean
if(GetSpellAbilityId()=='A01P')and RKI(GetSpellTargetUnit())then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"目标免疫魔法")
endif
return false
endfunction
function TL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function XF3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XE3))
set t=null
endfunction
function XG3 takes nothing returns boolean
if GetLearnedSkill()=='A041' then
if GetUnitAbilityLevel(GetTriggerUnit(),'A041')==4 then
call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()),'Remg',6)
else
call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()),'Remg',GetUnitAbilityLevel(GetTriggerUnit(),'A041'))
endif
elseif GetLearnedSkill()=='A062' then
call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()),'R00I',1)
endif
return false
endfunction
function Y41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function XG3))
set t=null
endfunction
function XH3 takes nothing returns boolean
if(GetUnitTypeId((GetFilterUnit()))=='u009')or(RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))then
if(LoadInteger(LY,(CMI),(GetHandleId(GetFilterUnit()))))<UJ then
return true
endif
endif
return false
endfunction
function XZ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer XV3=(LoadInteger(LY,(handle_id),(217)))
local integer VY3=(LoadInteger(LY,(handle_id),(216)))
local integer XW3=(LoadInteger(LY,(handle_id),(218)))
local group g=NTI()
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local unit target
local real r1=GetRandomInt(200,350)
local real r2=GetRandomInt(200,350)
if GetRandomInt(1,2)==1 then
set r1=-1*r1
set r2=-1*r2
endif
set GK=SFI
set UJ=XW3
set CMI=GetHandleId(t)
call GroupEnumUnitsInRange(g,x,y,700,Condition(function XH3))
set target=GroupPickRandomUnit(g)
call NSI(g)
if IsUnitDead(SFI)==false and target!=null and(GetUnitTypeId((target))=='u009')==false then
call SaveInteger(LY,(CMI),(GetHandleId(target)),((LoadInteger(LY,(CMI),(GetHandleId(target))))+1))
call U5I("effects\\Eclipse.mdx",target,"origin",3)
call Damage(SFI,target,1,XV3*75)
elseif IsUnitDead(SFI)==false then
set x=x+GetRandomInt(-350,350)
set y=y+GetRandomInt(-350,350)
call U7I("effects\\Eclipse.mdx",x,y,1.5)
endif
if(GetTriggerEvalCount(t)+1)==VY3 or IsUnitDead(SFI)==true then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
set g=null
set target=null
return false
endfunction
function XX3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer VY3
local integer XV3=GetUnitAbilityLevel(SFI,'A042')
local integer XW3
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
if XV3==0 and GetUnitTypeId(SFI)!='E005' then
set XV3=4
endif
call AddSkill(dummy,'A1T6')
if GetSpellAbilityId()=='A054' then
set VY3=2+3*GetUnitAbilityLevel(SFI,'A054')
set XW3=4
else
set VY3=2+4*GetUnitAbilityLevel(SFI,'A00U')
set XW3=60
endif
call SaveInteger(LY,(handle_id),(217),(XV3))
call SaveInteger(LY,(handle_id),(216),(VY3))
call SaveInteger(LY,(handle_id),(218),(XW3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.6,true)
call TriggerAddCondition(t,Condition(function XZ3))
call TriggerEvaluate(t)
call IssueImmediateOrderById(dummy,852621)
set t=null
set SFI=null
set dummy=null
endfunction
function XY3 takes nothing returns boolean
if GetSpellAbilityId()=='A054' or GetSpellAbilityId()=='A00U' then
call XX3()
endif
return false
endfunction
function Y31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XY3))
set t=null
endfunction
function XJ3 takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Starfall\\StarfallTarget.mdl",GetEnumUnit(),"origin"))
endfunction
function XK3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call Damage(SFI,target,1,0.75*GetUnitAbilityLevel(SFI,'A0KV')*75)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
set target=null
return false
endfunction
function XL3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local group g
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if IsUnitDead(target)then
set g=NTI()
set GK=SFI
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),175+25,Condition(function C81))
set target=GroupPickRandomUnit(g)
call NSI(g)
set g=null
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Starfall\\StarfallTarget.mdl",target,"origin"))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,0.5,false)
call TriggerAddCondition(t,Condition(function XK3))
set t=null
set SFI=null
set target=null
return false
endfunction
function XM3 takes nothing returns nothing
call Damage(CSI,GetEnumUnit(),1,CNI)
endfunction
function XN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
set CNI=GetUnitAbilityLevel(SFI,'A0KV')*75
set CSI=SFI
call ForGroup(g,function XM3)
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
set g=null
return false
endfunction
function XS3 takes nothing returns nothing
local real QWI=QLI(GetTriggerUnit(),GetEnumUnit())
if QWI>650 then
else
call GroupAddUnit(XK,GetEnumUnit())
endif
endfunction
function XT3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local group g=NTI()
local unit target
set GK=SFI
set CSI=SFI
set XK=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),900,Condition(function C81))
call ForGroup(g,function XS3)
call NSI(g)
set g=XK
call ForGroup(g,function XJ3)
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.5,false)
call TriggerAddCondition(t,Condition(function XN3))
set CSI=SFI
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),175+25,Condition(function C81))
set target=GroupPickRandomUnit(g)
call NSI(g)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Starfall\\StarfallCaster.mdl",SFI,"origin")))
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function XL3))
set t=null
set g=null
set SFI=null
set target=null
endfunction
function XR3 takes nothing returns boolean
if GetSpellAbilityId()=='A0KV' then
call XT3()
endif
return false
endfunction
function NH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XR3))
set t=null
endfunction
constant function MoonlightShadow_RawCode takes nothing returns integer
return 'A0KU'
endfunction
constant function MoonlightShadow_InvisibilityAbility takes nothing returns integer
return 'A0KT'
endfunction
function XP3 takes nothing returns boolean
return GetSpellAbilityId()==('A0KU')
endfunction
function XQ3 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
endfunction
function XU3 takes nothing returns nothing
call AddSkill(GetEnumUnit(),('A0KT'))
call SetUnitAbilityLevel(GetEnumUnit(),('A0KT'),YO)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Invisibility\\InvisibilityTarget.mdl",GetEnumUnit(),"chest"))
endfunction
function Y03 takes nothing returns nothing
call UnitRemoveAbility(GetEnumUnit(),('A0KT'))
endfunction
function YI3 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local group Z51=(LoadGroupHandle(LY,(handle_id),(220)))
call ForGroup(Z51,function Y03)
call NSI(Z51)
call UBI(t)
endfunction
function Y13 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local group Z51=NTI()
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(SFI,('A0KU'))
local real DC1=15
set YO=level
call GroupEnumUnitsInRange(Z51,0,0,9999,Condition(function XQ3))
call ForGroup(Z51,function XU3)
call SaveGroupHandle(LY,(handle_id),(220),(Z51))
call TimerStart(t,DC1,false,function YI3)
endfunction
function NG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XP3))
call TriggerAddAction(t,function Y13)
endfunction
constant function Leap_RawCode takes nothing returns integer
return 'A0LN'
endfunction
constant function Leap_BonusCode takes nothing returns integer
return 'A0LO'
endfunction
function YO3 takes nothing returns boolean
return GetSpellAbilityId()==('A0LN')
endfunction
function Y23 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(XO))
endfunction
function Y33 takes nothing returns nothing
local unit SFI=GetEnumUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e01R',0,0,0)
call AddSkill(dummy,('A0LO'))
call SetUnitAbilityLevel(dummy,('A0LO'),GetUnitAbilityLevel(XO,('A0LN')))
call UnitApplyTimedLife(dummy,'BTLF',10)
endfunction
function Y43 takes unit SFI returns nothing
local group Z51=NTI()
set XO=SFI
call GroupEnumUnitsInRange(Z51,GetUnitX(SFI),GetUnitY(SFI),800,Condition(function Y23))
call ForGroup(Z51,function Y33)
call NSI(Z51)
endfunction
function Y53 takes unit SFI returns nothing
local integer handle_id=GetHandleId(SFI)
local string Y63=(LoadStr(LY,(handle_id),(206)))
local string Y73=OrderId2String((LoadInteger(LY,(handle_id),(211))))
local real QJI
local real QKI
local unit target
local trigger t=(LoadTriggerHandle(LY,(handle_id),(204)))
local boolean Y83=not(LoadBoolean(LY,(handle_id),(207)))
local boolean Y93=(LoadBoolean(LY,(handle_id),(208)))
call DisableTrigger(t)
call IssueImmediateOrder(SFI,"stop")
if Y63=="Target"and(Y83 or Y93)then
set target=(LoadUnitHandle(LY,(handle_id),(215)))
call IssueTargetOrder(SFI,Y73,target)
elseif Y63=="Point"and(Y83 or Y93)then
set QJI=(LoadReal(LY,(handle_id),(209)))
set QKI=(LoadReal(LY,(handle_id),(210)))
call IssuePointOrder(SFI,Y73,QJI,QKI)
elseif(Y83 or Y93)then
call IssueImmediateOrder(SFI,"OrderString")
endif
call SaveBoolean(LY,(handle_id),(208),(false))
call EnableTrigger(t)
endfunction
function YA3 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real YB3=(LoadReal(LY,(handle_id),(212)))
local real YC3=(LoadReal(LY,(handle_id),(213)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real IV1=GetUnitX(SFI)+40*Cos(RM2*bj_DEGTORAD)
local real IW1=GetUnitY(SFI)+40*Sin(RM2*bj_DEGTORAD)
local real YD3=200
local real YE3=(1-YB3/YC3)*YD3*2
if YE3>YD3 then
set YE3=YD3*2-YE3
endif
call SetUnitFlyHeight(SFI,QDI(YE3,0),0)
call MUSetUnitX(SFI,PTI(IV1))
call MUSetUnitY(SFI,PUI(IW1))
call SetUnitFacing(SFI,RM2)
call SaveReal(LY,(handle_id),(212),((YB3-40)*1.0))
if YE3<1 and YB3-YC3!=0 then
call SaveBoolean(LY,(GetHandleId(SFI)),(214),(false))
call SetUnitFacing(SFI,RM2)
call SetUnitAnimation(SFI,"stand")
call SetUnitPathing(SFI,true)
call Y53(SFI)
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call DestroyTimer(t)
endif
endfunction
function YF3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,('A0LN'))
local real QWI=500+100*level
local real RM2=GetUnitFacing(SFI)
local real QXI=GetUnitX(SFI)
local real QYI=GetUnitY(SFI)
local real QJI=PTI(QXI+QWI*Cos(RM2*bj_DEGTORAD))
local real QKI=PUI(QYI+QWI*Sin(RM2*bj_DEGTORAD))
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
local trigger YG3=(LoadTriggerHandle(LY,(GetHandleId(SFI)),(204)))
set QWI=SquareRoot((QXI-QJI)*(QXI-QJI)+(QYI-QKI)*(QYI-QKI))
call Y43(SFI)
if QWI>100 then
call AddSkill(SFI,'Amrf')
call UnitRemoveAbility(SFI,'Amrf')
call SetUnitPathing(SFI,false)
call SetUnitAnimationByIndex(SFI,6)
call DisableTrigger(YG3)
call IssueImmediateOrder(SFI,"stop")
call EnableTrigger(YG3)
call SaveReal(LY,(handle_id),(212),((QWI)*1.0))
call SaveReal(LY,(handle_id),(213),((QWI)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TimerStart(t,0.025,true,function YA3)
call SaveBoolean(LY,(GetHandleId(SFI)),(214),(true))
call SaveBoolean(LY,(GetHandleId(SFI)),(208),(false))
endif
endfunction
function YH3 takes nothing returns boolean
return OrderId2String(GetIssuedOrderId())!="windwalk"
endfunction
function YZ3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local boolean YV3=(LoadBoolean(LY,(handle_id),(214)))
call SaveInteger(LY,(handle_id),(211),(GetIssuedOrderId()))
call SaveBoolean(LY,(handle_id),(207),(false))
if GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER then
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER then
if YV3 or UCI(GetUnitX(SFI),GetUnitY(SFI),GetOrderPointX(),GetOrderPointY())>800 then
call SaveStr(LY,(handle_id),(206),("Point"))
call SaveReal(LY,(handle_id),(209),((GetOrderPointX())*1.0))
call SaveReal(LY,(handle_id),(210),((GetOrderPointY())*1.0))
else
call SaveBoolean(LY,(handle_id),(207),(true))
endif
else
call SaveStr(LY,(handle_id),(206),("Instant"))
endif
if YV3 then
call SaveBoolean(LY,(handle_id),(208),(true))
endif
endfunction
function YW3 takes nothing returns nothing
local unit SFI=(LoadUnitHandle(LY,(GetHandleId(GetExpiredTimer())),(14)))
local integer handle_id=GetHandleId(SFI)
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local string Y63=(LoadStr(LY,(handle_id),(206)))
if Y63=="Point"and UCI(GetUnitX(SFI),GetUnitY(SFI),(LoadReal(LY,(handle_id),(209))),(LoadReal(LY,(handle_id),(210))))<100 then
call SaveBoolean(LY,(handle_id),(207),(true))
endif
endfunction
function YX3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local timer t2
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_ORDER)
call TriggerAddAction(t,function YZ3)
call TriggerAddCondition(t,Condition(function YH3))
call SaveTriggerHandle(LY,(GetHandleId(SFI)),(204),(t))
set t2=CreateTimer()
call SaveUnitHandle(LY,(GetHandleId(t2)),(14),(SFI))
call TimerStart(t2,0.3,true,function YW3)
call SaveTimerHandle(LY,(GetHandleId(SFI)),(205),(t2))
endfunction
function YY3 takes nothing returns nothing
if GetUnitAbilityLevel(GetTriggerUnit(),('A0LN'))==1 then
call YX3()
endif
endfunction
function NV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YO3))
call TriggerAddAction(t,function YF3)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddAction(t,function YY3)
endfunction
constant function ElunesArrow_RawCode takes nothing returns integer
return 'A0L8'
endfunction
constant function ElunesArrow_ArrowUnit takes nothing returns integer
return 'h005'
endfunction
constant function ElunesArrow_StunCode takes nothing returns integer
return 'A0L7'
endfunction
function YJ3 takes nothing returns boolean
return GetSpellAbilityId()==('A0L8')
endfunction
function YK3 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A1RB')==0 and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(XO))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false
endfunction
function YL3 takes real BA3,real BB3,real QXI,real QYI returns integer
local real QWI=SquareRoot((QXI-BA3)*(QXI-BA3)+(QYI-BB3)*(QYI-BB3))
return Q9I(R2I(QWI/150),11)
endfunction
function YM3 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real QXI=GetUnitX(IG1)
local real QYI=GetUnitY(IG1)
local real IV1=PTI(GetUnitX(IG1)+30*Cos(RM2))
local real IW1=PUI(GetUnitY(IG1)+30*Sin(RM2))
local boolexpr QL1=Condition(function YK3)
local group Z51=NTI()
local unit dummy
local unit target
local real BA3
local real BB3
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
set XO=SFI
call GroupEnumUnitsInRange(Z51,IV1,IW1,140,QL1)
set target=FirstOfGroup(Z51)
call NSI(Z51)
if target!=null then
if IsUnitType(target,UNIT_TYPE_HERO)==true then
set CTI[GetPlayerId(GetOwningPlayer(SFI))]=CTI[GetPlayerId(GetOwningPlayer(SFI))]+1
call FL1("AA_Hits"+I2S(GetPlayerId(GetOwningPlayer(SFI))),CTI[GetPlayerId(GetOwningPlayer(SFI))])
endif
set BA3=(LoadReal(LY,(handle_id),(191)))
set BB3=(LoadReal(LY,(handle_id),(192)))
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',QXI,QYI,0)
call AddSkill(dummy,('A0L7'))
call SetUnitAbilityLevel(dummy,('A0L7'),YL3(BA3,BB3,QXI,QYI))
if IssueTargetOrder(dummy,"thunderbolt",target)then
endif
call UnitDamageTarget(SFI,target,90*GetUnitAbilityLevel(SFI,('A0L8'))-40+(YL3(BA3,BB3,QXI,QYI)-1)*14,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
call KillUnit(IG1)
call UBI(t)
elseif(IV1-QJI)*(IV1-QJI)+(IW1-QKI)*(IW1-QKI)<1600 then
call KillUnit(IG1)
call UBI(t)
endif
endfunction
function YN3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real QXI=PTI(GetUnitX(SFI))
local real QYI=PUI(GetUnitY(SFI))
local location AM3=GetSpellTargetLoc()
local real QJI=GetLocationX(AM3)
local real QKI=GetLocationY(AM3)
local real RM2=Atan2(QKI-QYI,QJI-QXI)
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(SFI),('h005'),QXI,QYI,RM2*bj_RADTODEG)
set CRI[GetPlayerId(GetOwningPlayer(SFI))]=CRI[GetPlayerId(GetOwningPlayer(SFI))]+1
call FL1("AA_Total"+I2S(GetPlayerId(GetOwningPlayer(SFI))),CRI[GetPlayerId(GetOwningPlayer(SFI))])
call RemoveLocation(AM3)
call SetUnitFacing(IG1,RM2*bj_RADTODEG)
call SetUnitPathing(IG1,false)
set QJI=PTI(QXI+3000*Cos(RM2))
set QKI=PUI(QYI+3000*Sin(RM2))
call SaveReal(LY,(handle_id),(191),((QXI)*1.0))
call SaveReal(LY,(handle_id),(192),((QYI)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call TimerStart(t,0.035,true,function YM3)
endfunction
function YS3 takes nothing returns boolean
local integer YT3=CTI[GetPlayerId(GetTriggerPlayer())]
local integer QHI=CRI[GetPlayerId(GetTriggerPlayer())]
if GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='N01V' and QHI>0 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"箭矢准确率："+" "+R2S(I2R(YT3)/I2R(QHI)*100)+"% ("+I2S(YT3)+"/"+I2S(QHI)+")")
endif
return false
endfunction
function NZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YJ3))
call TriggerAddAction(t,function YN3)
call Q1I(('A0L7'))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function YS3))
set t=null
endfunction
function YR3 takes nothing returns boolean
return GetSpellAbilityId()=='A0FN'
endfunction
function YP3 takes nothing returns boolean
local unit YQ3=GetFilterUnit()
if IsUnitInGroup(YQ3,B2)then
return false
endif
if IsUnitEnemy(YQ3,GetOwningPlayer(XO))and GetUnitAbilityLevel(YQ3,'A04R')!=1 and GetUnitState(YQ3,UNIT_STATE_LIFE)>0 and IsUnitType(YQ3,UNIT_TYPE_STRUCTURE)==false then
return true
endif
return false
endfunction
function YU3 takes nothing returns nothing
call UnitDamageTarget(XO,GetEnumUnit(),JO,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
endfunction
function J03 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit PKI=(LoadUnitHandle(LY,(handle_id),(221)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local integer BQO=(LoadInteger(LY,(handle_id),(194)))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local real IO3=GetUnitX(PKI)
local real I23=GetUnitY(PKI)
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real IV1=II3+1000*0.05*Cos(RM2)
local real IW1=I13+1000*0.05*Sin(RM2)
local group Z51
local unit ZK3=(LoadUnitHandle(LY,(handle_id),(239)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A0GC' or GetSpellAbilityId()==0 then
call RemoveUnit(ZK3)
call SetUnitVertexColor(PKI,255,255,255,255)
call SaveBoolean(LY,(GetHandleId(PKI)),(225),(false))
call SetUnitInvulnerable(PKI,false)
call SetUnitPathing(PKI,true)
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
return false
endif
set Z51=NTI()
call SaveReal(LY,(handle_id),(23),((IV1)*1.0))
call SaveReal(LY,(handle_id),(24),((IW1)*1.0))
set XO=PKI
set JO=GetUnitAbilityLevel(PKI,'A0FN')*75+25
set B2=JAO
call GroupEnumUnitsInRange(Z51,IO3,I23,200+25,Condition(function YP3))
call ForGroup(Z51,function YU3)
call GroupAddGroup(Z51,JAO)
call NSI(Z51)
set BQO=BQO-1
call SaveInteger(LY,(handle_id),(194),(BQO))
call MUSetUnitX(PKI,PTI(IV1))
call MUSetUnitY(PKI,PUI(IW1))
call MUSetUnitX(ZK3,GetUnitX(PKI))
call MUSetUnitY(ZK3,GetUnitY(PKI))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",IO3,I23))
if BQO==0 then
call RemoveUnit(ZK3)
call SetUnitVertexColor(PKI,255,255,255,255)
call SaveBoolean(LY,(GetHandleId(PKI)),(225),(false))
call SetUnitInvulnerable(PKI,false)
call SetUnitPathing(PKI,true)
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set PKI=null
set JAO=null
set Z51=null
set t=null
return false
endfunction
function JI3 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local real QXI=GetUnitX(PKI)
local real QYI=GetUnitY(PKI)
local location AM3=GetSpellTargetLoc()
local real QJI=GetLocationX(AM3)
local real QKI=GetLocationY(AM3)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group JAO=NTI()
local integer pid=GetPlayerId(GetOwningPlayer(PKI))
local unit ZK3=CreateUnit(GetOwningPlayer(PKI),'e00E',QXI,QYI,0)
call RemoveLocation(AM3)
if GetSpellTargetUnit()!=null then
set QJI=GetUnitX(GetSpellTargetUnit())
set QKI=GetUnitY(GetSpellTargetUnit())
endif
call SetUnitVertexColor(PKI,255,255,255,0)
call SaveBoolean(LY,(GetHandleId(PKI)),(225),(true))
call SetUnitInvulnerable(PKI,true)
call SetUnitPathing(PKI,false)
call SaveUnitHandle(LY,(handle_id),(221),(PKI))
call SaveReal(LY,(handle_id),(23),((QXI)*1.0))
call SaveReal(LY,(handle_id),(24),((QYI)*1.0))
call SaveGroupHandle(LY,(handle_id),(133),(JAO))
call SaveReal(LY,(handle_id),(13),((Atan2(QKI-QYI,QJI-QXI))*1.0))
call SaveInteger(LY,(handle_id),(194),(QAI(R2I(SquareRoot((QJI-QXI)*(QJI-QXI)+(QKI-QYI)*(QKI-QYI))/50),1)))
call SaveUnitHandle(LY,(handle_id),(239),(ZK3))
call TriggerRegisterTimerEvent(t,0.04,true)
call TriggerRegisterUnitEvent(t,PKI,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function J03))
call ShowUnit(PKI,false)
call ShowUnit(PKI,true)
call SelectUnitAddForPlayer(PKI,GetOwningPlayer(PKI))
set t=null
endfunction
function Y61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YR3))
call TriggerAddAction(t,function JI3)
endfunction
constant function ReplicateAbilityId takes nothing returns integer
return 'A0G8'
endfunction
constant function ReplicateMorphAbilityId takes nothing returns integer
return 'A0GC'
endfunction
constant function ReplicateMorphBuffId takes nothing returns integer
return 'B030'
endfunction
function J13 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))-1
local texttag tt
call SaveInteger(LY,(handle_id),(34),(NPI))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set tt=CreateTextTag()
call SetTextTagText(tt,I2S(NPI),0.03)
call SetTextTagPosUnit(tt,hero,0)
call SetTextTagColorBJ(tt,0,29,255,15)
call SetTextTagVelocity(tt,0,0.035)
call SetTextTagFadepoint(tt,3)
call SetTextTagLifespan(tt,0.9)
call SetTextTagPermanent(tt,false)
call SetTextTagVisibility(tt,false)
if GetOwningPlayer(hero)==GetLocalPlayer()then
call SetTextTagVisibility(tt,true)
endif
set tt=CreateTextTag()
call SetTextTagText(tt,I2S(NPI),0.03)
call SetTextTagPosUnit(tt,target,0)
call SetTextTagColorBJ(tt,0,29,255,15)
call SetTextTagVelocity(tt,0,0.035)
call SetTextTagFadepoint(tt,3)
call SetTextTagLifespan(tt,0.9)
call SetTextTagPermanent(tt,false)
call SetTextTagVisibility(tt,false)
if GetOwningPlayer(hero)==GetLocalPlayer()then
call SetTextTagVisibility(tt,true)
endif
endif
set t=null
set tt=null
set hero=null
set target=null
return false
endfunction
function JO3 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local unit SFI=(LoadUnitHandle(LY,(GetHandleId(t)),(14)))
local unit J23=(LoadUnitHandle(LY,(GetHandleId(SFI)),(229)))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",GetUnitX(J23),GetUnitY(J23)))
call RemoveUnit(J23)
call UnitRemoveAbility(SFI,('A0GC'))
if(LoadInteger(LY,(GetHandleId(SFI)),(704)))==0 or(LoadInteger(LY,(GetHandleId(SFI)),(704)))==('A0G8')then
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),('A0G8'),true)
endif
call FlushChildHashtable(LY,(GetHandleId(t)))
call FlushTrigger((t))
set SFI=null
set J23=null
endfunction
function J33 takes nothing returns boolean
if GetSpellAbilityId()==('A0GC')then
return true
endif
return false
endfunction
function J43 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local unit J23=(LoadUnitHandle(LY,(handle_id),(229)))
local real x=GetUnitX(J23)
local real y=GetUnitY(J23)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",GetUnitX(SFI),GetUnitY(SFI)))
call KillUnit(J23)
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
call PanCameraToTimedForPlayer(GetOwningPlayer(SFI),x,y,0)
call IssueImmediateOrder(SFI,"stop")
set SFI=null
set J23=null
endfunction
function J53 takes nothing returns boolean
return GetUnitAbilityLevel(GetSummonedUnit(),('B030'))>0 and GetUnitState(GetSummonedUnit(),UNIT_STATE_LIFE)>0
endfunction
function J63 takes nothing returns nothing
local unit SFI=GetSummoningUnit()
local integer handle_id=GetHandleId(SFI)
local unit target=(LoadUnitHandle(LY,(handle_id),(228)))
local unit J23=GetSummonedUnit()
local trigger t
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),('A0G8'),false)
call AddSkill(SFI,('A0GC'))
call SetUnitColor(J23,GetPlayerColor(GetOwningPlayer(target)))
call SaveUnitHandle(LY,(handle_id),(229),(J23))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,J23,EVENT_UNIT_DEATH)
call TriggerAddAction(t,function JO3)
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,J23,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J13))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(SFI))
call SaveUnitHandle(LY,(GetHandleId(t)),(17),(J23))
call SaveInteger(LY,(GetHandleId(t)),(34),(GetUnitAbilityLevel(SFI,('A0G8'))*15+15-1))
set SFI=null
set target=null
set J23=null
set t=null
endfunction
function J73 takes nothing returns boolean
return GetSpellAbilityId()==('A0G8')
endfunction
function J83 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
call SaveUnitHandle(LY,(GetHandleId(SFI)),(228),(target))
set SFI=null
set target=null
endfunction
function J93 takes nothing returns boolean
if GetSpellAbilityId()==('A0G8')then
if GetOwningPlayer(GetSpellTargetUnit())==GetOwningPlayer(GetTriggerUnit())then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"不能以自己的单位为目标")
endif
endif
return false
endfunction
function Y91 takes nothing returns nothing
local trigger t
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function J73))
call TriggerAddAction(t,function J83)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function J53))
call TriggerAddAction(t,function J63)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function J33))
call TriggerAddAction(t,function J43)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function J93))
set t=null
endfunction
function JA3 takes unit SFI,integer JB3,real JC3 returns nothing
local integer JD3=GetHeroAgi(SFI,false)
local integer JE3=GetHeroStr(SFI,false)
local real KWO=GetUnitState(SFI,UNIT_STATE_MANA)
if JB3==0 then
if KWO>=JC3 and JD3>2 and IsUnitDead(SFI)==false then
call SetUnitState(SFI,UNIT_STATE_MANA,KWO-JC3)
call SetHeroAgi(SFI,JD3-2,true)
call SetHeroStr(SFI,JE3+2,true)
endif
elseif JB3==1 then
if KWO>=JC3 and JE3>2 and IsUnitDead(SFI)==false then
call SetUnitState(SFI,UNIT_STATE_MANA,KWO-JC3)
call SetHeroAgi(SFI,JD3+2,true)
call SetHeroStr(SFI,JE3-2,true)
endif
endif
endfunction
function JF3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=GetUnitAbilityLevel(SFI,'A0KX')
call JA3(SFI,1,30.0/level)
set t=null
set SFI=null
return false
endfunction
function JG3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=GetUnitAbilityLevel(SFI,'A0KX')
call JA3(SFI,0,30.0/level)
set t=null
set SFI=null
return false
endfunction
function JH3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local trigger JZ3=(LoadTriggerHandle(LY,(handle_id),(226)))
local integer level=GetUnitAbilityLevel(SFI,'A0KX')
local integer L=(LoadInteger(LY,(handle_id),(227)))
local real JV3=1.0/level
if level==4 then
set JV3=0.2
endif
if GetIssuedOrderId()==852549 then
if JZ3!=null then
call FlushChildHashtable(LY,(GetHandleId(JZ3)))
call FlushTrigger(JZ3)
endif
set JZ3=CreateTrigger()
call TriggerRegisterTimerEvent(JZ3,JV3,true)
call TriggerAddCondition(JZ3,Condition(function JF3))
call SaveUnitHandle(LY,(GetHandleId(JZ3)),(14),(SFI))
call SaveTriggerHandle(LY,(handle_id),(226),(JZ3))
call SaveInteger(LY,(handle_id),(227),(GetIssuedOrderId()))
call UnitAddAbility(SFI,'A22L')
call UnitRemoveAbility(SFI,'A22T')
elseif GetIssuedOrderId()==852546 then
if JZ3!=null then
call FlushChildHashtable(LY,(GetHandleId(JZ3)))
call FlushTrigger(JZ3)
endif
set JZ3=CreateTrigger()
call TriggerRegisterTimerEvent(JZ3,JV3,true)
call TriggerAddCondition(JZ3,Condition(function JG3))
call SaveUnitHandle(LY,(GetHandleId(JZ3)),(14),(SFI))
call SaveTriggerHandle(LY,(handle_id),(226),(JZ3))
call SaveInteger(LY,(handle_id),(227),(GetIssuedOrderId()))
call UnitAddAbility(SFI,'A22T')
call UnitRemoveAbility(SFI,'A22L')
elseif GetIssuedOrderId()==852550 then
if JZ3!=null then
call FlushChildHashtable(LY,(GetHandleId(JZ3)))
call FlushTrigger(JZ3)
endif
call SaveTriggerHandle(LY,(handle_id),(226),(null))
call SaveInteger(LY,(handle_id),(227),(GetIssuedOrderId()))
call UnitRemoveAbility(SFI,'A22L')
call UnitRemoveAbility(SFI,'A22T')
elseif GetIssuedOrderId()==852547 then
if JZ3!=null then
call FlushChildHashtable(LY,(GetHandleId(JZ3)))
call FlushTrigger(JZ3)
endif
call SaveTriggerHandle(LY,(handle_id),(226),(null))
call SaveInteger(LY,(handle_id),(227),(GetIssuedOrderId()))
call UnitRemoveAbility(SFI,'A22L')
call UnitRemoveAbility(SFI,'A22T')
elseif GetIssuedOrderId()==852548 and L!=852546 and L!=852546 then
call JA3(SFI,1,30*JV3)
elseif GetIssuedOrderId()==852545 and L!=852546 and L!=852546 then
call JA3(SFI,0,30*JV3)
endif
set t=null
set SFI=null
set JZ3=null
return false
endfunction
function JW3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A0KX')
if level==1 then
call SetHeroAgi(SFI,GetHeroAgi(SFI,false)+3,true)
call SetHeroStr(SFI,GetHeroStr(SFI,false)+3,true)
else
call SetHeroAgi(SFI,GetHeroAgi(SFI,false)+1,true)
call SetHeroStr(SFI,GetHeroStr(SFI,false)+1,true)
endif
if level==1 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call AddSkill(SFI,'A0KW')
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function JH3))
call SaveTriggerHandle(LY,(handle_id),(226),(null))
else
call SetUnitAbilityLevel(SFI,'A0KW',level)
endif
set t=null
endfunction
function JX3 takes nothing returns boolean
if GetLearnedSkill()=='A0KX' and IsUnitIllusion(GetTriggerUnit())==false then
call JW3()
endif
return false
endfunction
function Y71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function JX3))
set t=null
endfunction
function JY3 takes nothing returns nothing
local unit PKI=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(326)))
local real r
local real g
local real b
local integer JJ3
local integer JK3
local real JL3
local real JM3
if GetUnitTypeId(PKI)!='O00P' then
call DisableTrigger(GetTriggeringTrigger())
elseif IsUnitDead(PKI)==false and(LoadBoolean(LY,(GetHandleId(PKI)),(225)))==false then
set JJ3=GetHeroAgi(PKI,true)
set JK3=GetHeroStr(PKI,true)
set JL3=RMaxBJ(75+2*(JJ3-JK3),35)
set r=JL3
set g=JL3
set b=JL3
call SetUnitVertexColorBJ(PKI,r,g,b,GetRandomReal(0.00,10.00))
endif
endfunction
function JN3 takes nothing returns boolean
return GetUnitTypeId(GetTriggerUnit())=='O00P' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function JS3 takes nothing returns nothing
local trigger t
if((LoadBoolean(LY,(GetHandleId(GetTriggerUnit())),(327)))==false)then
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(326),(GetTriggerUnit()))
call SaveTriggerHandle(LY,(GetHandleId(GetTriggerUnit())),(328),(t))
call TriggerAddAction(t,function JY3)
call TriggerRegisterTimerEvent(t,1.0,true)
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(327),(true))
call UnitAddItem(GetTriggerUnit(),CreateItem('I00E',GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit())))
endif
endfunction
function Y51 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,bj_mapInitialPlayableArea)
call TriggerAddCondition(t,Condition(function JN3))
call TriggerAddAction(t,function JS3)
endfunction
function JT3 takes nothing returns boolean
return GetSpellAbilityId()=='A0G6' and GetUnitTypeId(GetSpellTargetUnit())!='n00L' and CanResistSkill(GetSpellTargetUnit())==false
endfunction
function JR3 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(PKI,'A0G6')
local unit dummy
local location JP3
local real RM2
local integer JJ3=GetHeroAgi(PKI,true)
local integer JK3=GetHeroStr(PKI,true)
local real JL3=I2R(JJ3)/I2R(JK3)
local real JM3=I2R(JK3)/I2R(JJ3)
local real JQ3
local real JU3
local real K03
local real IT3
local real KI3
local real K13
local integer i1
local integer i2
local integer i3
local string s1
local string s2
local string s3
local real KO3=0.25+level
if JL3<0.5 then
set JQ3=0.25
set JU3=20*level
elseif JL3>1.5 then
set JQ3=0.5*level
set JU3=20*level
else
set JQ3=0.25+(JL3-0.5)*(0.5*level-0.25)
set JU3=20*level
endif
if JM3<0.5 then
set K03=0.25
set IT3=100
elseif JM3>1.5 then
set K03=KO3
set IT3=300
else
set IT3=100+(JM3-0.5)*200
set K03=0.25+(JM3-0.5)*(KO3-0.25)
endif
set KI3=JU3+JQ3*JJ3
set K13=K03
set i1=R2I(K13)
set i2=R2I(10*K13-i1*10)
set i3=R2I(100*K13-i2*10-i1*100)
set s1=I2S(i1)
set s2=I2S(i2)
set s3=I2S(i3)
set RM2=Atan2(GetUnitY(target)-GetUnitY(PKI),GetUnitX(target)-GetUnitX(PKI))
set JP3=Location(GetUnitX(target)+IT3*Cos(RM2),GetUnitY(target)+IT3*Sin(RM2))
call SetUnitPositionLoc(target,JP3)
call UPI(GetLocationX(JP3),GetLocationY(JP3),200)
call RemoveLocation(JP3)
call UYI("|c001ce6b9+"+I2S(R2I(KI3))+"|r |c00ff0303+"+s1+"."+s2+s3+"|r",1,target,0.023,255,255,255,216)
call Damage(PKI,target,1,KI3)
call DD1(PKI,target,K13)
set PKI=null
set target=null
set dummy=null
set JP3=null
endfunction
function Y81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function JT3))
call TriggerAddAction(t,function JR3)
call Q1I('A0X6')
endfunction
function K23 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),D0I)==false then
call GroupAddUnit(DII,GetEnumUnit())
call UnitRemoveAbility(GetEnumUnit(),'B02J')
call UnitRemoveAbility(GetEnumUnit(),'BUsp')
call UnitRemoveAbility(GetEnumUnit(),'Bust')
endif
endfunction
function K33 takes nothing returns nothing
call UnitRemoveAbility(GetEnumUnit(),'B02J')
call UnitRemoveAbility(GetEnumUnit(),'BUsp')
call UnitRemoveAbility(GetEnumUnit(),'Bust')
endfunction
function K43 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),CUI)==false then
call GroupAddUnit(CUI,GetEnumUnit())
call SetUnitOwner(CQI,GetOwningPlayer(GetEnumUnit()),false)
call IssueTargetOrder(CQI,"sleep",GetEnumUnit())
endif
endfunction
function K53 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group g
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
if GetTriggerEvalCount(t)==10 then
call AddSkill(hero,'A24E')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A07U',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A24E',true)
endif
if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetTriggerEvalCount(t)>140 or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A24E')then
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A07U' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A07U',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A24E',false)
call ForGroup(PR2,function K33)
call NSI(PR2)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
set CPI=hero
set CQI=dummy
set CUI=PR2
call GroupEnumUnitsInRange(g,x,y,1250+25,Condition(function C31))
call ForGroup(g,function K43)
set D0I=g
set DII=NTI()
call ForGroup(PR2,function K23)
call GroupRemoveGroup(DII,PR2)
call NSI(g)
call NSI(DII)
endif
set t=null
set g=null
set hero=null
set PR2=null
set dummy=null
return false
endfunction
function K63 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call UnitAddAbility(dummy,'A07T')
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function K53))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\SongOfTheSiren_2.mdx",hero,"origin")))
set t=null
set hero=null
endfunction
function K73 takes nothing returns boolean
if GetSpellAbilityId()=='A07U' then
call K63()
endif
return false
endfunction
function YA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function K73))
set t=null
endfunction
function K83 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A2KU')
local integer id='A244'
call Damage(hero,target,1,100+30*level)
if level==2 then
set id='A245'
elseif level==3 then
set id='A246'
elseif level==4 then
set id='A247'
endif
if BJ1(target)==false then
call AH1(target,id,1,8)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(target),id,false)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\CrushingWave\\CrushingWaveDamage.mdl",target,"chest"))
set hero=null
set target=null
endfunction
function K93 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),DOI)==false and RKI(GetEnumUnit())==false then
call GroupAddUnit(DOI,GetEnumUnit())
call K83(D1I,GetEnumUnit())
endif
endfunction
function KA3 takes nothing returns nothing
local unit hero=GetEnumUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
call DestroyEffect(AddSpecialEffect("war3mapImported\\RipTide09.mdx",x,y))
set GK=hero
call GroupEnumUnitsInRange(g,x,y,320+25,Condition(function CA1))
call ForGroup(g,function K93)
call NSI(g)
set t=null
set g=null
endfunction
function KB3 takes nothing returns boolean
return IsUnitIllusion(GetFilterUnit())and IsUnitDead(GetFilterUnit())==false
endfunction
function KC3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
local integer i=0
set DOI=NTI()
set D1I=hero
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(hero),Condition(function KB3))
call GroupAddUnit(g,hero)
call ForGroup(g,function KA3)
call NSI(g)
call NSI(DOI)
set hero=null
set g=null
endfunction
function KD3 takes nothing returns boolean
if GetSpellAbilityId()=='A2KU' then
call KC3()
endif
return false
endfunction
function YB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function KD3))
set t=null
endfunction
function KE3 takes unit hero,unit target,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(dummy,'A0BA')
call SetUnitAbilityLevel(dummy,'A0BA',level)
call IssueTargetOrder(dummy,"ensnare",target)
set dummy=null
endfunction
function KF3 takes nothing returns boolean
if IsUnitIllusion(GetFilterUnit())==true and GetUnitTypeId(GetFilterUnit())=='HC49' and GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GetTriggerUnit())then
call KE3(GetFilterUnit(),D3I,GetUnitAbilityLevel(GetTriggerUnit(),'A24D'))
endif
return false
endfunction
function KG3 takes nothing returns boolean
if IsUnitIllusion(GetFilterUnit())==true and GetUnitTypeId(GetFilterUnit())=='HC49' and GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GetTriggerUnit())then
call SetUnitFacing(GetFilterUnit(),AK)
call SetUnitAnimation(GetFilterUnit(),"spell")
endif
return false
endfunction
function KH3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local group g=NTI()
set AK=UEI(GetUnitX(SFI),GetUnitY(SFI),GetUnitX(D3I),GetUnitY(D3I))
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),700,Condition(function KG3))
call NSI(g)
set SFI=null
set g=null
endfunction
function KZ3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=D3I
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),700,Condition(function KF3))
call NSI(g)
set SFI=null
set g=null
endfunction
function KV3 takes nothing returns boolean
if GetSpellAbilityId()=='A24D' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if CanResistSkill(GetSpellTargetUnit())==false then
set D2I=0
set D3I=GetSpellTargetUnit()
call KE3(GetTriggerUnit(),D3I,GetUnitAbilityLevel(GetTriggerUnit(),'A24D'))
call KZ3()
endif
else
call KH3()
endif
endif
return false
endfunction
function YC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function KV3))
set t=null
endfunction
function KW3 takes unit SWI returns integer
local real r=GetRandomReal(0,100)
local integer level=GetUnitAbilityLevel(SWI,'A088')
local boolean CK3=ES1(SWI,FR0[JJ0])!=null
local integer KX3=0
local integer id=GetPlayerId(GetOwningPlayer(SWI))
set CK3=false
if level==1 then
set D8I[id]=D8I[id]+1
if CK3 then
if r<30 then
set D5I[id]=D5I[id]+1
set KX3=3
elseif r<60 then
set D4I[id]=D4I[id]+1
set KX3=2
endif
else
if r<40 then
set KX3=2
set D4I[id]=D4I[id]+1
endif
endif
elseif level==2 then
set D8I[id]=D8I[id]+1
if CK3 then
if r<17.5 then
set KX3=4
set D6I[id]=D6I[id]+1
elseif r<35 then
set KX3=3
set D5I[id]=D5I[id]+1
elseif r<70 then
set KX3=2
set D4I[id]=D4I[id]+1
endif
else
if r<20 then
set KX3=3
set D5I[id]=D5I[id]+1
elseif r<50 then
set KX3=2
set D4I[id]=D4I[id]+1
endif
endif
elseif level==3 then
set D8I[id]=D8I[id]+1
if CK3 then
if r<10 then
set KX3=5
set D7I[id]=D7I[id]+1
elseif r<20 then
set KX3=4
set D6I[id]=D6I[id]+1
elseif r<40 then
set KX3=3
set D5I[id]=D5I[id]+1
elseif r<80 then
set KX3=2
set D4I[id]=D4I[id]+1
endif
else
if r<12.5 then
set KX3=4
set D6I[id]=D6I[id]+1
elseif r<25 then
set KX3=3
set D5I[id]=D5I[id]+1
elseif r<60 then
set KX3=2
set D4I[id]=D4I[id]+1
endif
endif
endif
return KX3
endfunction
function KY3 takes nothing returns boolean
return(RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),'B03J')==0 and GetFilterUnit()!=D9I
endfunction
function KJ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer KK3=(LoadInteger(LY,(handle_id),(300)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer KL3=(LoadInteger(LY,(handle_id),(299)))
local unit dummy
local group g=NTI()
set GK=hero
set D9I=target
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1425,Condition(function KY3))
set target=GroupPickRandomUnit(g)
if target==null then
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1425,Condition(function CF1))
set target=GroupPickRandomUnit(g)
endif
call NSI(g)
call SaveUnitHandle(LY,(handle_id),(17),(target))
if GetTriggerEvalCount(t)>KK3 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
if KL3=='A2KQ' then
set KL3='A2KR'
endif
call AddSkill(dummy,KL3)
call SetUnitAbilityLevel(dummy,KL3,level)
call IssueTargetOrder(dummy,"acidbomb",target)
endif
set t=null
set target=null
set hero=null
set dummy=null
set g=null
return false
endfunction
function KM3 takes integer r returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer KL3=GetSpellAbilityId()
local integer level=GetUnitAbilityLevel(hero,KL3)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if r==2 then
call UYI("|c00FFFF002x 多重施法！！|r",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==3 then
call UYI("|cffff80003x 多重施法！！！|r",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==4 then
call UYI("4x 多重施法！！！！",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==5 then
call UYI("5x 多重施法！！！！！",5,GetTriggerUnit(),0.03,255,0,0,255)
endif
set r=r-1
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(300),(r))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(299),(KL3))
call TriggerRegisterTimerEvent(t,0.4,true)
call TriggerAddCondition(t,Condition(function KJ3))
set t=null
set target=null
set hero=null
endfunction
function KN3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A2KR')
call IssueTargetOrder(dummy,"thunderbolt",target)
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)*0.4)
set hero=null
set target=null
set dummy=null
endfunction
function FVO takes nothing returns nothing
local unit hero=GK
call AddSkill(hero,'A2KQ')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2KQ',true)
set hero=null
endfunction
function FWO takes nothing returns nothing
local unit hero=GK
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2KQ',false)
set hero=null
endfunction
function KS3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer KK3=(LoadInteger(LY,(handle_id),(300)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer KL3=(LoadInteger(LY,(handle_id),(299)))
local unit dummy
if GetTriggerEvalCount(t)>KK3 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
if KL3=='A2KQ' then
set KL3='A2KR'
endif
call AddSkill(dummy,KL3)
call SetUnitAbilityLevel(dummy,KL3,level)
call IssueTargetOrder(dummy,"thunderbolt",target)
endif
set t=null
set target=null
set hero=null
set dummy=null
return false
endfunction
function KT3 takes integer r returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer KL3=GetSpellAbilityId()
local integer level=GetUnitAbilityLevel(hero,KL3)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if r==2 then
call UYI("|c00FFFF002x 多重施法！！|r",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==3 then
call UYI("|cffff80003x 多重施法！！！|r",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==4 then
call UYI("4x 多重施法！！！！",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==5 then
call UYI("5x 多重施法！！！！！",5,GetTriggerUnit(),0.03,255,0,0,255)
endif
set r=r-1
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(300),(r))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(299),(KL3))
call TriggerRegisterTimerEvent(t,0.4,true)
call TriggerAddCondition(t,Condition(function KS3))
set t=null
set target=null
set hero=null
endfunction
function KR3 takes nothing returns boolean
local integer r
if GetUnitAbilityLevel(GetTriggerUnit(),'A088')>0 and CanResistSkill(GetSpellTargetUnit())==false then
if GetSpellAbilityId()=='A04W' or GetSpellAbilityId()=='A08D' or GetSpellAbilityId()=='A08A' or GetSpellAbilityId()=='A089' or GetSpellAbilityId()=='A2KQ' then
set r=KW3(GetTriggerUnit())
if r>1 and((LoadInteger(LY,(GetHandleId((GetSpellTargetUnit()))),((4322))))==1)==false then
call KT3(r)
endif
elseif GetSpellAbilityId()=='A011' or GetSpellAbilityId()=='A007' or GetSpellAbilityId()=='A17W' or GetSpellAbilityId()=='A01T' or GetSpellAbilityId()=='A17X' or GetSpellAbilityId()=='A00F' or GetSpellAbilityId()=='A17Y' or GetSpellAbilityId()=='A17V' then
set r=KW3(GetTriggerUnit())
if r>1 and((LoadInteger(LY,(GetHandleId((GetSpellTargetUnit()))),((4322))))==1)==false then
call KM3(r)
endif
endif
endif
if CanResistSkill(GetSpellTargetUnit())==false and GetSpellAbilityId()=='A2KQ' then
call KN3()
endif
return false
endfunction
function KP3 takes nothing returns boolean
local integer id=GetPlayerId(GetTriggerPlayer())
local string s1
local string s2
local string s3
local string s4
local string s5
local string s6
if D8I[id]>0 then
set s1="尝试次数："+" "+I2S(D8I[id])
set s2="成功次数："+" "+I2S(D4I[id]+D5I[id]+D6I[id]+D7I[id])+" ("+I2S((D4I[id]+D5I[id]+D6I[id]+D7I[id])*100/D8I[id])+"%)"
set s3="2x 施法："+" "+I2S(D4I[id])+" ("+I2S(100*D4I[id]/D8I[id])+"%)"
set s4="3x 施法："+" "+I2S(D5I[id])+" ("+I2S(100*D5I[id]/D8I[id])+"%)"
set s5="4x 施法："+" "+I2S(D6I[id])+" ("+I2S(100*D6I[id]/D8I[id])+"%)"
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,s1)
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,s2)
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,s3)
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,s4)
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,s5)
endif
return false
endfunction
function YD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function KR3))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function KP3))
set t=null
endfunction
function KQ3 takes nothing returns boolean
local unit YQ3=GetFilterUnit()
local unit PKI=GetTriggerUnit()
if IsUnitAlly(YQ3,GetOwningPlayer(PKI))and GetUnitState(YQ3,UNIT_STATE_LIFE)>0 and GetUnitAbilityLevel(YQ3,'Bblo')==0 then
if(GetOwningPlayer(YQ3)==BO[0]or GetOwningPlayer(YQ3)==CO[0])then
if(GetUnitTypeId(YQ3)=='ugho' or GetUnitTypeId(YQ3)=='u001' or GetUnitTypeId(YQ3)=='unec' or GetUnitTypeId(YQ3)=='u002')then
return true
endif
if(GetUnitTypeId(YQ3)=='esen' or GetUnitTypeId(YQ3)=='e00V' or GetUnitTypeId(YQ3)=='edry' or GetUnitTypeId(YQ3)=='e00W')then
return true
endif
return false
elseif IsUnitType(YQ3,UNIT_TYPE_HERO)==true then
return true
elseif GetOwningPlayer(YQ3)==GetOwningPlayer(PKI)then
return true
endif
endif
return false
endfunction
function KU3 takes integer r returns nothing
local unit PKI=GetTriggerUnit()
local integer level=r
local group Z51=NTI()
local unit dummy
local unit WH1
local integer TPI=GetSpellAbilityId()
local integer TGI=1
if r==2 then
call UYI("|c00FFFF002x 多重施法！！|r",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==3 then
call UYI("|cffff80003x 多重施法！！！|r",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==4 then
call UYI("4x 多重施法！！！！",5,GetTriggerUnit(),0.03,255,0,0,255)
elseif r==5 then
call UYI("5x 多重施法！！！！！",5,GetTriggerUnit(),0.03,255,0,0,255)
endif
set r=r-1
call GroupEnumUnitsInRange(Z51,GetUnitX(PKI),GetUnitY(PKI),600,Condition(function KQ3))
if PKI!=GetSpellTargetUnit()then
call GroupAddUnit(Z51,PKI)
endif
loop
exitwhen TGI>level
set TGI=TGI+1
set dummy=CreateUnit(GetOwningPlayer(PKI),'e00C',GetUnitX(PKI),GetUnitY(PKI),270)
call AddSkill(dummy,TPI)
call SetUnitAbilityLevel(dummy,TPI,GetUnitAbilityLevel(PKI,TPI))
call UnitApplyTimedLife(dummy,'BTLF',1.0)
set WH1=GroupPickRandomUnit(Z51)
call IssueTargetOrder(dummy,"bloodlust",WH1)
call SetUnitPathing(dummy,false)
call SetUnitInvulnerable(dummy,true)
call AddSkill(dummy,'Aloc')
call GroupRemoveUnit(Z51,WH1)
endloop
call NSI(Z51)
endfunction
function L03 takes nothing returns boolean
local integer r
if GetUnitAbilityLevel(GetTriggerUnit(),'A088')>0 and(GetSpellAbilityId()=='A083' or GetSpellAbilityId()=='A08I' or GetSpellAbilityId()=='A08G' or GetSpellAbilityId()=='A08F')then
set r=KW3(GetTriggerUnit())
if r>1 then
call KU3(r)
endif
endif
return false
endfunction
function YE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function L03))
set t=null
endfunction
constant function Purification_RawCode takes nothing returns integer
return 'A08N'
endfunction
function LI3 takes nothing returns boolean
return GetSpellAbilityId()==('A08N')
endfunction
function L13 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')!=1 and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
endfunction
function LO3 takes nothing returns nothing
call Damage(GetTriggerUnit(),GetEnumUnit(),3,JO)
endfunction
function L23 takes nothing returns nothing
local boolexpr QL1=Condition(function L13)
local group Z51=NTI()
local real x=GetUnitX(GetSpellTargetUnit())
local real y=GetUnitY(GetSpellTargetUnit())
set JO=90*GetUnitAbilityLevel(GetTriggerUnit(),('A08N'))
if GetUnitState(GetSpellTargetUnit(),UNIT_STATE_LIFE)>1 then
call SetUnitState(GetSpellTargetUnit(),UNIT_STATE_LIFE,GetUnitState(GetSpellTargetUnit(),UNIT_STATE_LIFE)+JO)
endif
call GroupEnumUnitsInRange(Z51,x,y,260+25,QL1)
call ForGroup(Z51,function LO3)
call NSI(Z51)
endfunction
function YF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function LI3))
call TriggerAddAction(t,function L23)
endfunction
function L33 takes nothing returns boolean
local unit IYO=GetSummonedUnit()
local unit dummy
local unit target
if GetUnitAbilityLevel(IYO,'B098')>0 then
set dummy=GetSummoningUnit()
set target=(LoadUnitHandle(LY,(GetHandleId(dummy)),(303)))
call MUSetUnitX(IYO,GetUnitX(target))
call MUSetUnitY(IYO,GetUnitY(target))
call IssueTargetOrder(IYO,"attack",target)
endif
set IYO=null
set dummy=null
set target=null
return false
endfunction
function L43 takes player p,unit target,integer level returns nothing
local unit dummy=CreateUnit(p,'e00E',GetUnitX(target),GetUnitY(target),0)
local integer IB1
call SaveUnitHandle(LY,(GetHandleId(dummy)),(303),(target))
if level==1 then
set IB1='A10H'
elseif level==2 then
set IB1='A10G'
elseif level==3 then
set IB1='A10I'
else
set IB1='A10F'
endif
call AddSkill(dummy,IB1)
call IssueTargetOrderById(dummy,852274,K1[GetPlayerId(p)])
set dummy=null
endfunction
function L53 takes player p,unit target,integer level,boolean L63,boolean L73 returns nothing
local real PAI=50+50*level
local unit dummy
local integer IB1
if L73 then
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A10C')
call SetUnitAbilityLevel(dummy,'A10C',level)
call IssueTargetOrder(dummy,"cripple",target)
call Damage(K1[GetPlayerId(p)],target,1,PAI)
if L63 then
call L43(p,target,level)
endif
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\IllidanMissile\\IllidanMissile.mdl",target,"origin"))
set dummy=null
endfunction
function L83 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local boolean DH1=(LoadBoolean(LY,(handle_id),(302)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real IH1=1000*0.035
local real IZ1=UEI(x,y,QJI,QKI)
local real IV1=x+IH1*Cos(IZ1*bj_DEGTORAD)
local real IW1=y+IH1*Sin(IZ1*bj_DEGTORAD)
local boolean ZXO=(LoadBoolean(LY,(handle_id),(249)))
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SetUnitFacing(IG1,IZ1)
if((LoadInteger(LY,(GetHandleId((target))),((4422))))==1)==true then
set ZXO=false
call SaveBoolean(LY,(handle_id),(249),(ZXO))
endif
if UTI(QJI,QKI,IV1,IW1)<=IH1 then
if ZXO then
call L53(p,target,level,true,DH1)
endif
call KillUnit(IG1)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set IG1=null
return false
endfunction
function L93 takes unit hero,integer level,unit target,boolean DH1 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h06L',GetUnitX(hero),GetUnitY(hero),UEI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target)))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveBoolean(LY,(handle_id),(302),(DH1))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveBoolean(LY,(handle_id),(249),(true))
call TriggerRegisterTimerEvent(t,0.035,true)
call TriggerAddCondition(t,Condition(function L83))
set t=null
endfunction
function LA3 takes nothing returns boolean
if IsUnitIllusion(GetFilterUnit())==true and GetUnitTypeId(GetFilterUnit())=='Ogrh' and GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GetTriggerUnit())then
call L93(GetFilterUnit(),GetUnitAbilityLevel(GetTriggerUnit(),'A10D'),GetSpellTargetUnit(),false)
endif
return false
endfunction
function LB3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A10D')
local unit target=GetSpellTargetUnit()
local group g=NTI()
local boolean LC3=CanResistSkill(GetSpellTargetUnit())
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),700,Condition(function LA3))
if LC3 then
call L93(SFI,level,target,false)
else
call L93(SFI,level,target,true)
endif
call NSI(g)
set SFI=null
set target=null
set g=null
endfunction
function LD3 takes nothing returns boolean
if IsUnitIllusion(GetFilterUnit())==true and GetUnitTypeId(GetFilterUnit())=='Ogrh' and GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GetTriggerUnit())then
call SetUnitFacing(GetFilterUnit(),AK)
call SetUnitAnimation(GetFilterUnit(),"spell")
endif
return false
endfunction
function LE3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local group g=NTI()
set AK=UEI(GetUnitX(SFI),GetUnitY(SFI),GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit()))
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),700,Condition(function LD3))
call NSI(g)
set SFI=null
set g=null
endfunction
function LF3 takes nothing returns boolean
if GetSpellAbilityId()=='A10D' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call LB3()
else
call LE3()
endif
endif
return false
endfunction
function YH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function LF3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function LF3))
call Q1I('A10C')
call Q1I('A10H')
call Q1I('A10G')
call Q1I('A10I')
call Q1I('A10F')
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function L33))
set t=null
endfunction
function LG3 takes nothing returns boolean
if GetUnitAbilityLevel(GetFilterUnit(),'B03B')>0 and IsUnitIllusion(GetFilterUnit())==true then
set UJ=UJ+1
endif
return false
endfunction
function LH3 takes nothing returns nothing
local unit LZ3=GetAttacker()
local group g=NTI()
local integer TJI=GetRandomInt(1,100)
local integer LV3=GetUnitAbilityLevel(LZ3,'A0DB')
local unit dummy
local integer LW3=4+2*LV3
local integer LX3=35+5*LV3
local integer LY3=8
set UJ=0
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(LZ3),Condition(function LG3))
call NSI(g)
if UJ<LW3 and GetUnitAbilityLevel(LZ3,'BNdo')==0 then
if IsUnitIllusion(LZ3)==false and TJI<=LX3 then
set dummy=CreateUnit(GetOwningPlayer(LZ3),'e00E',GetUnitX(LZ3),GetUnitY(LZ3),0)
call AddSkill(dummy,'A0DD')
call IssueTargetOrderById(dummy,852274,LZ3)
endif
if IsUnitIllusion(LZ3)==true and TJI<=LY3 then
set dummy=CreateUnit(GetOwningPlayer(LZ3),'e00E',GetUnitX(LZ3),GetUnitY(LZ3),0)
call AddSkill(dummy,'A30B')
call IssueTargetOrderById(dummy,852274,LZ3)
endif
endif
set LZ3=null
set g=null
set dummy=null
endfunction
function LJ3 takes nothing returns boolean
if(GetUnitAbilityLevel(GetAttacker(),'B03B')>0)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))==true then
call LH3()
endif
return false
endfunction
function YG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function LJ3))
set t=null
endfunction
function LK3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real QWI=QLI(hero,target)
local real II3=(LoadReal(LY,(handle_id),(6)))
local real I13=(LoadReal(LY,(handle_id),(7)))
local real x
local real y
local real a=UDI(hero,target)
if IsUnitDead(hero)or IsUnitDead(target)or QWI<175 or GetTriggerEvalCount(t)>250 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set x=PTI(II3+800*0.02*Cos(a*bj_DEGTORAD))
set y=PUI(I13+800*0.02*Sin(a*bj_DEGTORAD))
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
call SetUnitFacing(hero,a)
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function LL3 takes unit hero,unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call IssueTargetOrder(hero,"attack",target)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function LK3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
set t=null
set hero=null
set target=null
endfunction
function LM3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(GetHandleId(hero)),(831)))
local integer level=GetUnitAbilityLevel(hero,'A0YK')
local real PD2=(LoadReal(LY,(GetHandleId(hero)),(832)))
local boolean LN3=(TimerGetElapsed(M))>(PD2+20-4*level)
local integer LS3=500+100*level
local integer LT3=300
local real QWI
if IsUnitIllusion(hero)==true and IsUnitDead(hero)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif target==null or IsUnitDead(target)==true then
call SaveUnitHandle(LY,(GetHandleId(hero)),(831),(null))
call RemoveSavedHandle(LY,(GetHandleId(hero)),(831))
elseif LN3 then
set QWI=QLI(hero,target)
if QWI>LT3 and QWI<LS3 then
call SaveReal(LY,(GetHandleId(hero)),(832),(((TimerGetElapsed(M)))*1.0))
call SaveUnitHandle(LY,(GetHandleId(hero)),(831),(null))
call RemoveSavedHandle(LY,(GetHandleId(hero)),(831))
call LL3(hero,target)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function LR3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function LM3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function LP3 takes nothing returns boolean
if GetUnitAbilityLevel(GetTriggerUnit(),'A0YK')>0 then
if GetIssuedOrderId()==851971 and GetOrderTargetUnit()!=null and IsPlayerAlly(GetOwningPlayer(GetTriggerUnit()),GetOwningPlayer(GetOrderTargetUnit()))==false then
call SaveUnitHandle(LY,(GetHandleId(GetTriggerUnit())),(831),(GetOrderTargetUnit()))
elseif GetIssuedOrderId()==851983 and GetOrderTargetUnit()!=null and IsPlayerAlly(GetOwningPlayer(GetTriggerUnit()),GetOwningPlayer(GetOrderTargetUnit()))==false then
call SaveUnitHandle(LY,(GetHandleId(GetTriggerUnit())),(831),(GetOrderTargetUnit()))
else
call SaveUnitHandle(LY,(GetHandleId(GetTriggerUnit())),(831),(null))
call RemoveSavedHandle(LY,(GetHandleId(GetTriggerUnit())),(831))
endif
endif
return false
endfunction
function LQ3 takes nothing returns boolean
if GetUnitAbilityLevel(GetTriggerUnit(),'A0YK')==1 then
call LR3()
endif
return false
endfunction
function YZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_ORDER)
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER)
call TriggerAddCondition(t,Condition(function LP3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function LQ3))
set t=null
endfunction
function LU3 takes nothing returns nothing
call MUSetUnitX(GetEnumUnit(),DBI+GetRandomInt(0,500)-250)
call MUSetUnitY(GetEnumUnit(),DCI+GetRandomInt(0,500)-250)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\DG_Reappear.mdx",GetEnumUnit(),"chest"))
endfunction
function M03 takes nothing returns boolean
return GetOwningPlayer(DAI)==GetOwningPlayer(GetFilterUnit())and IsUnitIllusion(GetFilterUnit())==true
endfunction
function MI3 takes nothing returns nothing
call SetUnitInvulnerable(GetEnumUnit(),false)
call PauseUnit(GetEnumUnit(),false)
call ShowUnit(GetEnumUnit(),true)
call MUSetUnitX(GetEnumUnit(),DBI+GetRandomInt(0,250))
call MUSetUnitY(GetEnumUnit(),DCI+GetRandomInt(0,250))
endfunction
function M13 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy
call I41(GetOwningPlayer(hero),1,x,y,925)
call UPI(x,y,225)
set DBI=x
set DCI=y
call ForGroup(g,function MI3)
call GroupAddUnit(g,hero)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call AddSkill(dummy,'A30E')
call IssueTargetOrderById(dummy,852274,hero)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call AddSkill(dummy,'A30D')
call IssueTargetOrderById(dummy,852274,hero)
call NSI(g)
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,925,Condition(function M03))
call GroupAddUnit(g,hero)
call ForGroup(g,function LU3)
call NSI(g)
call ClearSelectionForPlayer(GetOwningPlayer(hero))
call SelectUnitAddForPlayer(hero,GetOwningPlayer(hero))
set t=null
set hero=null
set g=null
set dummy=null
return false
endfunction
function MO3 takes nothing returns nothing
call SelectUnitRemoveForPlayer(GetEnumUnit(),GetOwningPlayer(GetEnumUnit()))
call SetUnitInvulnerable(GetEnumUnit(),true)
call PauseUnit(GetEnumUnit(),true)
call ShowUnit(GetEnumUnit(),false)
call DestroyEffect(AddSpecialEffect("war3mapImported\\DG_Disappear.mdx",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
endfunction
function M23 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ForGroup(g,function MO3)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function M13))
set t=null
set hero=null
set g=null
set dummy=null
return false
endfunction
function M33 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
set DAI=hero
call GroupEnumUnitsInRange(g,x,y,925,Condition(function M03))
call GroupAddUnit(g,hero)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call TriggerRegisterTimerEvent(t,.01,false)
call TriggerAddCondition(t,Condition(function M23))
set t=null
set hero=null
set g=null
endfunction
function M43 takes nothing returns boolean
if GetSpellAbilityId()=='A30C' then
call M33()
endif
return false
endfunction
function YV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function M43))
set t=null
endfunction
function M53 takes nothing returns boolean
return GetSpellAbilityId()=='A07Z'
endfunction
function M63 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>0
endfunction
function M73 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(PKI),'e022',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),270)
call AddSkill(dummy,'A06T')
call SetUnitAbilityLevel(dummy,'A06T',GetUnitAbilityLevel(PKI,'A07Z'))
call IssueTargetOrder(dummy,"entanglingroots",GetEnumUnit())
endfunction
function M83 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local group Z51=NTI()
local boolexpr QL1=Condition(function M63)
call GroupEnumUnitsInRange(Z51,GetUnitX(PKI),GetUnitY(PKI),700,QL1)
call ForGroup(Z51,function M73)
call NSI(Z51)
endfunction
function YW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function M53))
call TriggerAddAction(t,function M83)
endfunction
function M93 takes unit hero,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A1GB')
call SetUnitAbilityLevel(dummy,'A1GB',level)
call IssueTargetOrder(dummy,"invisibility",hero)
call AddSkill(hero,'A23O')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A23O',false)
set dummy=null
endfunction
function MA3 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='h0BT'
endfunction
function MB3 takes unit SFI returns boolean
local group g=NTI()
local boolean FB1=false
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),375,Condition(function MA3))
if FirstOfGroup(g)!=null then
set FB1=true
endif
call NSI(g)
set g=null
return FB1
endfunction
function MC3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit SFI=NYI(PCI)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real Z7O=(LoadReal(LY,(handle_id),(442)))
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and(LoadBoolean(LY,(handle_id),(329)))and GetAttacker()==SFI then
call UnitRemoveAbility(SFI,'B021')
call UnitRemoveAbility(SFI,'A1GA')
call UnitRemoveAbility(SFI,'A23O')
call UnitRemoveAbility(SFI,'B0E9')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_ATTACKED and GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A01Z' and GetTriggerUnit()==SFI then
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+1.0)*1.0))
call DisableTrigger(GetTriggeringTrigger())
call M93(SFI,level)
call EnableTrigger(GetTriggeringTrigger())
call SaveInteger(LY,(handle_id),(34),(0))
endif
if I61(GetUnitX(SFI),GetUnitY(SFI),375)==false and MB3(SFI)==false then
if Z7O<(TimerGetElapsed(M))or GetTriggerEvalCount(t)==1 then
call UnitRemoveAbility(SFI,'B021')
call UnitRemoveAbility(SFI,'A1GA')
call UnitRemoveAbility(SFI,'A23O')
call UnitRemoveAbility(SFI,'B0E9')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif(LoadBoolean(LY,(handle_id),(329)))and NPI>(150*level)then
call UnitRemoveAbility(SFI,'B021')
call UnitRemoveAbility(SFI,'A1GA')
call UnitRemoveAbility(SFI,'A23O')
call UnitRemoveAbility(SFI,'B0E9')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif(LoadBoolean(LY,(handle_id),(329)))and GetUnitAbilityLevel(SFI,'B021')==0 and GetUnitAbilityLevel(SFI,'A1GA')>0 then
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+1.0)*1.0))
call DisableTrigger(GetTriggeringTrigger())
call M93(SFI,level)
call EnableTrigger(GetTriggeringTrigger())
elseif GetUnitAbilityLevel(SFI,'B021')==0 then
call UnitRemoveAbility(SFI,'B021')
call UnitRemoveAbility(SFI,'A1GA')
call UnitRemoveAbility(SFI,'A23O')
call UnitRemoveAbility(SFI,'B0E9')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+1.0)*1.0))
endif
endif
set t=null
set SFI=null
return false
endfunction
function MD3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()!=EVENT_WIDGET_DEATH then
if GetUnitAbilityLevel(hero,'B021')>0 then
call AddSkill(hero,'A1GA')
endif
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function ME3 takes nothing returns nothing
local trigger t
local integer handle_id
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(30),(NKI(GetSpellTargetUnit())))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(GetTriggerUnit(),'A01Z')))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+1.0)*1.0))
call TriggerAddCondition(t,Condition(function MC3))
call TriggerRegisterTimerEvent(t,0.1,true)
call AddSkill(GetSpellTargetUnit(),'A23O')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetSpellTargetUnit()),'A23O',false)
if GetTriggerUnit()==GetSpellTargetUnit()then
call SaveBoolean(LY,(handle_id),(329),(true))
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call TriggerAddCondition(t,Condition(function MD3))
call TriggerRegisterTimerEvent(t,2,false)
call TriggerRegisterDeathEvent(t,GetTriggerUnit())
endif
set t=null
endfunction
function MF3 takes nothing returns boolean
if GetSpellAbilityId()=='A01Z' then
call ME3()
endif
return false
endfunction
function YX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MF3))
set t=null
endfunction
function MG3 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(DDI),'e022',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),270)
call AddSkill(dummy,'A316')
call SetUnitAbilityLevel(dummy,'A316',GetUnitAbilityLevel(DDI,'A07Z'))
call IssueTargetOrder(dummy,"entanglingroots",GetEnumUnit())
set dummy=null
endfunction
function MH3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local destructable d=(LoadDestructableHandle(LY,(handle_id),(834)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g
if GetDestructableLife(d)<=0 then
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A07Z' then
set DDI=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(dummy),GetUnitY(dummy),825,Condition(function M63))
call ForGroup(g,function MG3)
call NSI(g)
endif
set t=null
set d=null
set g=null
set dummy=null
set hero=null
return false
endfunction
function MZ3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local destructable d=GetSpellTargetDestructable()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o02E',GetDestructableX(d),GetDestructableY(d),0)
call SaveDestructableHandle(LY,(handle_id),(834),(d))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MH3))
set t=null
set hero=null
set d=null
set dummy=null
endfunction
function MV3 takes nothing returns boolean
if GetSpellAbilityId()=='A01V' then
call MZ3()
endif
return false
endfunction
function YL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MV3))
set t=null
endfunction
function XBO takes nothing returns nothing
call AddSkill(GK,'A01V')
endfunction
function MW3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(686)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or LVO<(TimerGetElapsed(M))or RKI(target)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveReal(LY,(GetHandleId(target)),(686),((0)*1.0))
call UnitRemoveAbility(target,'A24P')
call UnitRemoveAbility(target,'A24P')
call UnitRemoveAbility(target,'A24P')
call UnitRemoveAbility(target,'A24P')
call UnitRemoveAbility(target,'B0EG')
else
call Damage(hero,target,1,15+15*level)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function MX3 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local real LVO=(LoadReal(LY,(GetHandleId(target)),(686)))
local integer level=GetUnitAbilityLevel(hero,'A1G7')
if LVO>(TimerGetElapsed(M))then
call SaveReal(LY,(GetHandleId(target)),(686),(((TimerGetElapsed(M))+4)*1.0))
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveReal(LY,(GetHandleId(target)),(686),(((TimerGetElapsed(M))+4)*1.0))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function MW3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\AcidBomb\\BottleImpact.mdl",target,"overhead")))
if level==1 then
call AddSkill(target,'A24P')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24P',false)
elseif level==2 then
call AddSkill(target,'A24P')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24P',false)
elseif level==3 then
call AddSkill(target,'A24P')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24P',false)
elseif level==4 then
call AddSkill(target,'A24P')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24P',false)
endif
endif
set t=null
endfunction
function Sentinel_FindClosest takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(DFI)and(GetUnitTypeId(GetFilterUnit())=='h0BT' or GetUnitTypeId(GetFilterUnit())=='h0BU')then
if QNI(GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()),DGI,DHI)<DZI then
set DEI=GetFilterUnit()
set DZI=QNI(GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()),DGI,DHI)
endif
endif
return false
endfunction
function MY3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target
local group g
local real GW1=(LoadReal(LY,(handle_id),(442)))
local real x
local real y
local integer RII
local real hp
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_DEATH then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_DEATH then
if GetTriggerUnit()==dummy then
call UnitRemoveAbility(dummy,'Apiv')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif GetUnitTypeId(dummy)=='h0BT' then
set GK=dummy
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(dummy),GetUnitY(dummy),110,Condition(function CA1))
set target=AU1(g,GetUnitX(dummy),GetUnitY(dummy))
call NSI(g)
if target!=null then
call MX3(hero,target)
set x=GetUnitX(dummy)
set y=GetUnitY(dummy)
set hp=GetUnitState(dummy,UNIT_STATE_LIFE)
call ShowUnit(dummy,false)
call DisableTrigger(t)
call KillUnit(dummy)
call EnableTrigger(t)
set dummy=CreateUnit(GetOwningPlayer(hero),'h0BU',x,y,0)
call SetUnitState(dummy,UNIT_STATE_LIFE,hp)
call UnitApplyTimedLife(dummy,'BTLF',480-((TimerGetElapsed(M))-GW1))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(411),(((TimerGetElapsed(M))+4)*1.0))
endif
elseif GetUnitTypeId(dummy)=='h0BU' and(LoadReal(LY,(handle_id),(411)))<(TimerGetElapsed(M))then
set x=GetUnitX(dummy)
set y=GetUnitY(dummy)
set hp=GetUnitState(dummy,UNIT_STATE_LIFE)
call ShowUnit(dummy,false)
call DisableTrigger(t)
call KillUnit(dummy)
call EnableTrigger(t)
set dummy=CreateUnit(GetOwningPlayer(hero),'h0BT',x,y,0)
call SetUnitState(dummy,UNIT_STATE_LIFE,hp)
call UnitApplyTimedLife(dummy,'BTLF',480-((TimerGetElapsed(M))-GW1))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
endif
set t=null
set hero=null
set target=null
set dummy=null
set g=null
return false
endfunction
function MJ3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A1G7')
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h0BT',x,y,0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UnitApplyTimedLife(dummy,'BTLF',480)
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function MY3))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M)))*1.0))
call SaveInteger(LY,(handle_id),(34),(0))
set t=null
set hero=null
set dummy=null
endfunction
function MK3 takes nothing returns boolean
if GetSpellAbilityId()=='A1G7' then
call MJ3()
endif
return false
endfunction
function YJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MK3))
set t=null
endfunction
function ML3 takes nothing returns nothing
local unit target=GetEnumUnit()
local real d=QNI(GetUnitX(target),GetUnitY(target),DXI,DYI)
if d<DWI and IsUnitVisible(target,GetOwningPlayer(DJI))==true and(IsUnitType(target,UNIT_TYPE_HERO)==true or(IsUnitType(target,UNIT_TYPE_STRUCTURE)==true and BQ1(target)))then
set DVI=GetEnumUnit()
set DWI=d
endif
set target=null
endfunction
function MM3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=GetUnitAbilityLevel(hero,'A2ML')
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>5 then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call QGI(target,RMinBJ(GetEventDamage(),20*GetUnitAbilityLevel(hero,'A2ML')))
endif
endif
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or NPI>(level+3-1)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A2MX')
call UnitRemoveAbility(target,'A2MY')
call UnitRemoveAbility(target,'A2MW')
call UnitRemoveAbility(target,'A2MV')
call UnitRemoveAbility(target,'B0G5')
endif
set t=null
set target=null
return false
endfunction
function MN3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer OO1='A2MX'
local integer level=GetUnitAbilityLevel(hero,'A2ML')
local group g
if target==null then
set DVI=null
set DJI=hero
set DWI=999999
set DXI=GetSpellTargetX()
set DYI=GetSpellTargetY()
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function CW1))
call ForGroup(g,function ML3)
call NSI(g)
set target=DVI
set g=null
endif
if level==2 then
set OO1='A2MY'
elseif level==3 then
set OO1='A2MW'
elseif level==4 then
set OO1='A2MV'
endif
call AddSkill(target,OO1)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),OO1,false)
call TriggerRegisterTimerEvent(t,15,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function MM3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(34),(0))
set t=null
set hero=null
endfunction
function MS3 takes nothing returns boolean
if GetSpellAbilityId()=='A2ML' then
call MN3()
endif
return false
endfunction
function YY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MS3))
set t=null
endfunction
function MT3 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real MR3=(LoadReal(LY,(handle_id),(21)))
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+MR3)
set hero=null
set target=null
endfunction
function MP3 takes nothing returns nothing
local trigger t=IJ1(DKI,GetEnumUnit(),'h0D8',"MT3",400,false)
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(21),((DLI)*1.0))
set t=null
endfunction
function MQ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A273')
call UnitRemoveAbility(target,'B0EL')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI>5 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A273')
call UnitRemoveAbility(target,'B0EL')
endif
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\NightElf\\EntBirthTarget\\EntBirthTarget.mdl",target,"origin"))
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),525,Condition(function CT1))
set DKI=target
set DLI=15*level
call ForGroup(g,function MP3)
call NSI(g)
call Damage(hero,target,1,DLI)
endif
set t=null
set hero=null
set target=null
set g=null
return false
endfunction
function MU3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A26N')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(target,'A273')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A273',false)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerRegisterTimerEvent(t,4.5,false)
call TriggerAddCondition(t,Condition(function MQ3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M)))*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
set t=null
set hero=null
endfunction
function LeechSeed takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
call IJ1(hero,target,'h0D9',"MU3",600,false)
set hero=null
set target=null
endfunction
function N03 takes nothing returns boolean
if GetSpellAbilityId()=='A26N' and CanResistSkill(GetSpellTargetUnit())==false then
call MU3()
endif
return false
endfunction
function YK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function N03))
set t=null
endfunction
function NI3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2NT')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call Damage(hero,target,1,100+50*level)
set t=null
set hero=null
set target=null
return false
endfunction
function N13 takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
	local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
	local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
	local integer level=GetUnitAbilityLevel(hero,'A2NT')
	local boolean NO3=(LoadBoolean(LY,(handle_id),(95)))
	call FlushChildHashtable(LY,(handle_id))
	call FlushTrigger(t)
	call AddSkill(dummy,'A0LS')
	call SetUnitAbilityLevel(dummy,'A0LS',level)
	call IssueTargetOrder(dummy,"soulburn",target)
	set t=CreateTrigger()
	set handle_id=GetHandleId(t)
	call TriggerAddCondition(t,Condition(function NI3))
	call TriggerRegisterTimerEvent(t,0.01,false)
	call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
	call SaveUnitHandle(LY,(GetHandleId(t)),(17),(target))
	call SaveInteger(LY,(GetHandleId(t)),(5),(level))
	if NO3 then
		call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\LastWordDamageSpell.mdx",target,"overhead"))
	endif
	set t=null
	set hero=null
	set target=null
	set dummy=null
	return false
endfunction
function N23 takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
	local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
	local unit dummy
	local integer level=GetUnitAbilityLevel(hero,'A2NT')
	if GetTriggerEventId()==EVENT_WIDGET_DEATH then
		call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
		call UnitRemoveAbility(target,'A2NU')
		call UnitRemoveAbility(target,'B05V')
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
	elseif GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT then
		call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
		call UnitRemoveAbility(target,'A2NU')
		call UnitRemoveAbility(target,'B05V')
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
		set t=CreateTrigger()
		set handle_id=GetHandleId(t)
		call TriggerAddCondition(t,Condition(function N13))
		call TriggerRegisterTimerEvent(t,0.01,false)
		call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
		call SaveUnitHandle(LY,(GetHandleId(t)),(17),(target))
		call SaveInteger(LY,(GetHandleId(t)),(5),(level))
		call SaveBoolean(LY,(handle_id),(95),(false))
		set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
		call AddSkill(dummy,'A2NW')
		call SetUnitAbilityLevel(dummy,'A2NW',level)
		call IssueTargetOrder(dummy,"drunkenhaze",target)
		call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\LastWordDamageDuration.mdx",target,"overhead"))
		set dummy=null
	elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and V61(GetSpellAbilityId())==false and V81(GetSpellAbilityId())==false and GetSpellAbilityId()!='AIbk' and GetSpellAbilityId()!='A05Z' and GetSpellAbilityId()!='A0FP' and GetSpellAbilityId()!='A0QY' and GetSpellAbilityId()!='A06X' and GetSpellAbilityId()!='A0AQ' and GetSpellAbilityId()!='A21X' and GetSpellAbilityId()!='A21W' and GetSpellAbilityId()!='A21V' and GetSpellAbilityId()!='A12W' and GetSpellAbilityId()!='A06K' and GetSpellAbilityId()!='Aeat' and GetSpellAbilityId()!='A0JY' and GetSpellAbilityId()!='A0FO' and GetSpellAbilityId()!='A1NI' and GetSpellAbilityId()!='A1MI' and GetSpellAbilityId()!='A2QE' and GetSpellAbilityId()!='A1Q8' and GetSpellAbilityId()!='A1RA' and GetSpellAbilityId()!='A1QV' and GetSpellAbilityId()!='A21Y' and GetSpellAbilityId()!='A1GU' and GetSpellAbilityId()!='A1YY' and BZ1(GetSpellAbilityId())==false then
		call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
		call UnitRemoveAbility(target,'A2NU')
		call UnitRemoveAbility(target,'B05V')
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
		set t=CreateTrigger()
		set handle_id=GetHandleId(t)
		if GetSpellAbilityId()=='A0RV' or GetSpellAbilityId()=='A0LN' or GetUnitAbilityLevel(target, GetSpellAbilityId()) == 0 then
			call TriggerRegisterTimerEvent(t,0.01,false)
		else
			call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_SPELL_ENDCAST)
		endif
		call TriggerAddCondition(t,Condition(function N13))
		call SaveUnitHandle(LY,(handle_id),(2),(hero))
		call SaveUnitHandle(LY,(handle_id),(17),(target))
		call SaveBoolean(LY,(handle_id),(95),(true))
	endif
	set target=null
	set hero=null
	set t=null
	return false
endfunction
function N33 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetUnitAbilityLevel(target,'A2NU')==0 or GetTriggerEvalCount(t)>250 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
else
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
endif
set t=null
set dummy=null
set target=null
return false
endfunction
function N43 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o019',GetUnitX(target),GetUnitY(target),0)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterTimerEvent(t,5,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function N23))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(target,'A2NU')
call UnitMakeAbilityPermanent(target,true,'A2NV')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2NU',false)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\LastWordDebuff_6.mdx",target,"overhead")))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function N33))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set hero=null
set target=null
set t=null
endfunction
// 最后遗言
function N53 takes nothing returns boolean
if GetSpellAbilityId()=='A2NT' and CanResistSkill(GetSpellTargetUnit())==false then
call N43()
endif
return false
endfunction
function LastWord_Process takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
call SetHeroInt(hero,GetHeroInt(hero,false)+1,true)
call UYI("+1 "+"智力",3,hero,0.023,0,255,0,230)
set hero=null
endfunction
function N63 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
call SetHeroInt(hero,GetHeroInt(hero,false)+2,true)
call UYI("+2 "+"智力",3,hero,0.023,0,255,0,230)
set hero=null
endfunction
function N73 takes unit hero,unit IFO returns nothing
if IsUnitType(IFO,UNIT_TYPE_HERO)==true and V51(GetUnitTypeId(IFO))==false and IsUnitIllusion(IFO)==false and(IsUnitInRange(hero,IFO,900)or GetOwningPlayer(hero)==GetOwningPlayer(GetKillingUnit()))and IsUnitDead(hero)==false and IsUnitAlly(hero,GetOwningPlayer(IFO))==false then
if GetUnitTypeId(hero)=='N01A' then
set DMI[GetPlayerId(GetOwningPlayer(hero))]=DMI[GetPlayerId(GetOwningPlayer(hero))]+2
call UYI("-2 "+"智力",3,IFO,0.023,255,0,0,230)
call SetHeroInt(IFO,GetHeroInt(IFO,false)-2,true)
call IJ1(IFO,hero,'h0CP',"N63",450,false)
endif
endif
endfunction
function N83 takes nothing returns nothing
call N73(GetEnumUnit(),GetTriggerUnit())
endfunction
function N93 takes nothing returns boolean
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),1000,Condition(function D51))
call GroupAddUnit(g,K1[GetPlayerId(GetOwningPlayer(GetKillingUnit()))])
call ForGroup(g,function N83)
call NSI(g)
set g=null
return false
endfunction
function NA3 takes nothing returns boolean
local integer QHI=DMI[GetPlayerId(GetTriggerPlayer())]
if GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='N01A' and QHI>0 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"已偷取的智力总量："+" "+I2S(QHI))
endif
return false
endfunction
function YS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function N53))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function N93))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function NA3))
set t=null
endfunction
function NB3 takes nothing returns boolean
local real d
if GetUnitAbilityLevel(GetTriggerUnit(),'B05X')>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A0LZ')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
call UnitRemoveAbility(GetTriggerUnit(),'B05X')
set d=(0.1+0.2*I2R(GetUnitAbilityLevel(GetEventDamageSource(),'A0LZ')))*GetHeroInt(GetEventDamageSource(),true)
call UYI("+"+I2S(R2I(d)),1,GetTriggerUnit(),0.023,3,216,216,216)
call DisableTrigger(GetTriggeringTrigger())
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,d)
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function NC3 takes nothing returns nothing
local trigger t
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
set target=GetSpellTargetUnit()
set hero=GetTriggerUnit()
else
set target=GetTriggerUnit()
set hero=GetAttacker()
endif
if IsUnitIllusion(hero)==false then
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function NB3))
endif
set t=null
set target=null
set hero=null
endfunction
function ND3 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetUnitAbilityLevel(GetAttacker(),'A0LZ')>0 and(LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
call NC3()
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if(GetIssuedOrderId()==OrderId("poisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(true))
elseif(GetIssuedOrderId()==OrderId("unpoisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(false))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A0LZ' then
call NC3()
endif
return false
endfunction
function NE3 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function ND3))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function NF3 takes nothing returns boolean
if GetLearnedSkill()=='A0LZ' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0LZ')==1 then
call NE3()
endif
return false
endfunction
function YN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function NF3))
set t=null
endfunction
function NG3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()!=EVENT_UNIT_DEATH and GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT and NPI<(6)then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)-8*level)
call Damage(hero,target,1,5+15*level)
elseif NPI>=(6)or GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()!='A12W' and GetSpellAbilityId()!='A0FO' and GetSpellAbilityId()!='A1MO' and GetSpellAbilityId()!='A1C0' and GetSpellAbilityId()!='A1ZI' and GetSpellAbilityId()!='A28Y' and V81(GetSpellAbilityId())==false and(TRI(GetSpellAbilityId())or GetSpellAbilityId()=='A06K'))then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A1PS')
call UnitRemoveAbility(target,'B0CQ')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function NH3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local integer level=GetUnitAbilityLevel(hero,'A14L')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(target,'A1PS')
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function NG3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareTarget.mdl",target,"overhead")))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
set hero=null
set target=null
set t=null
endfunction
function NZ3 takes nothing returns nothing
local group g
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A14L')
if level>0 then
set g=NTI()
set GK=GetTriggerUnit()
set DNI=GetTriggerUnit()
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function DI1))
call ForGroup(g,function NH3)
call NSI(g)
endif
set g=null
endfunction
function NV3 takes nothing returns nothing
local group g=NTI()
local location point=GetSpellTargetLoc()
set GK=GetTriggerUnit()
set DNI=GetTriggerUnit()
call GroupEnumUnitsInRange(g,GetLocationX(point),GetLocationY(point),375,Condition(function DI1))
call ForGroup(g,function NH3)
call U7I("war3mapImported\\CotS.mdx",GetLocationX(point),GetLocationY(point),5)
call NSI(g)
call RemoveLocation(point)
set g=null
set point=null
endfunction
function NW3 takes nothing returns boolean
if GetSpellAbilityId()=='A14L' then
call NV3()
endif
return false
endfunction
function YM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NW3))
set t=null
endfunction
function NX3 takes nothing returns boolean
return GetSpellAbilityId()=='A0L3' or GetSpellAbilityId()=='A2QC'
endfunction
function NY3 takes nothing returns boolean
call FlushTrigger(GetTriggeringTrigger())
call VolumeGroupReset()
return false
endfunction
function NJ3 takes nothing returns nothing
local location BFO=GetUnitLoc(GetTriggerUnit())
local trigger t=CreateTrigger()
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A0L3')
if level==0 then
set level=GetUnitAbilityLevel(GetTriggerUnit(),'A2QC')
call NZ3()
endif
call TriggerRegisterTimerEvent(t,level+2,false)
call TriggerAddCondition(t,Condition(function NY3))
call CreateNUnitsAtLoc(1,'e00E',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call ShowUnitHide(bj_lastCreatedUnit)
call UnitApplyTimedLifeBJ(5.00,'BTLF',bj_lastCreatedUnit)
call UnitAddAbility(bj_lastCreatedUnit,'A0L2')
call SetUnitAbilityLevelSwapped('A0L2',bj_lastCreatedUnit,level)
call IssuePointOrderLoc(bj_lastCreatedUnit,"silence",BFO)
call VolumeGroupSetVolume(SOUND_VOLUMEGROUP_UNITSOUNDS,.0)
call VolumeGroupSetVolume(SOUND_VOLUMEGROUP_COMBAT,.0)
call VolumeGroupSetVolume(SOUND_VOLUMEGROUP_SPELLS,.0)
call VolumeGroupSetVolume(SOUND_VOLUMEGROUP_MUSIC,.0)
call RemoveLocation(BFO)
set t=null
set BFO=null
endfunction
function GS takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NX3))
call TriggerAddAction(t,function NJ3)
endfunction
function NK3 takes nothing returns boolean
return GetLearnedSkill()=='A03U'
endfunction
function NL3 takes nothing returns nothing
call SetPlayerTechResearchedSwap('R005',GetUnitAbilityLevelSwapped('A03U',GetTriggerUnit()),GetOwningPlayer(GetLearningUnit()))
endfunction
function YQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function NK3))
call TriggerAddAction(t,function NL3)
endfunction
function NM3 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==false then
if(LoadInteger(LY,(GetHandleId(GetEnumUnit())),(836)))==DQI or(TimerGetElapsed(M))>(1.1+(LoadReal(LY,(GetHandleId(GetEnumUnit())),(837))))then
call SaveInteger(LY,(GetHandleId(GetEnumUnit())),(836),(DQI))
call SaveReal(LY,(GetHandleId(GetEnumUnit())),(837),(((TimerGetElapsed(M)))*1.0))
call Damage(DTI,GetEnumUnit(),1,DPI)
call IssueTargetOrder(DRI,"slow",GetEnumUnit())
endif
endif
endfunction
function NN3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g=NTI()
local real d
local real a
local real x2
local real y2
set DQI=handle_id
set GK=hero
call GroupEnumUnitsInRange(g,x,y,450+25,Condition(function CZ1))
set DTI=hero
set DPI=level*12
set DRI=dummy
call ForGroup(g,function NM3)
call NSI(g)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(309))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(178))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(179))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(180))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(330))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(331))))
if GetTriggerEvalCount(t)==10 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set d=0
set a=0
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(309),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=150
set a=45
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=275
set a=90
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=150
set a=135
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=275
set a=180
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(178),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=150
set a=225
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(179),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=275
set a=270
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(180),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=150
set a=305
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(330),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
set d=275
set a=360
set x2=x+d*Cos(a*bj_DEGTORAD)
set y2=y+d*Sin(a*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(331),(AddSpecialEffect("Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl",x2,y2)))
endif
set t=null
set hero=null
set dummy=null
set g=null
return false
endfunction
function NS3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A2ZO')
local real x1=(LoadReal(LY,(handle_id),(6)))
local real y1=(LoadReal(LY,(handle_id),(7)))
local unit dummy=CreateUnit(Player(15),'e00E',x1,y1,0) // 马甲刷给中立以免破林肯
local real x2
local real y2
local real d
local real a
local integer i
call AddSkill(dummy,'A19F')
call SetUnitAbilityLevel(dummy,'A19F',level)
if GetTriggerEvalCount(t)==1 then
	set i=1
	loop
		exitwhen i>10
		set d=GetRandomReal(0,450)
		set a=GetRandomReal(0,360)
		set x2=x1+d*Cos(a*bj_DEGTORAD)
		set y2=y1+d*Sin(a*bj_DEGTORAD)
		set dummy=CreateUnit(GetOwningPlayer(hero),'e00J',GetUnitX(hero),GetUnitY(hero),90)
		call IssuePointOrder(dummy,"attackground",x2,y2)
		call UnitApplyTimedLife(dummy,'BTLF',0.5)
		set i=i+1
	endloop
else
	call FlushChildHashtable(LY,(handle_id))
	call FlushTrigger(t)
	set t=CreateTrigger()
	set handle_id=GetHandleId(t)
	call SaveUnitHandle(LY,(handle_id),(2),(hero))
	call SaveUnitHandle(LY,(handle_id),(19),(dummy))
	call SaveReal(LY,(handle_id),(6),((x1)*1.0))
	call SaveReal(LY,(handle_id),(7),((y1)*1.0))
	call SaveInteger(LY,(handle_id),(5),(level))
	call TriggerRegisterTimerEvent(t,1,true)
	call TriggerAddCondition(t,Condition(function NN3))
	call TriggerEvaluate(t)
endif
set hero=null
set dummy=null
set t=null
return false
endfunction
function NT3 takes nothing returns nothing
local trigger t
local integer handle_id
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(829)))
if JGO>0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call I41(GetOwningPlayer(hero),9.4,x,y,360)
call TriggerRegisterTimerEvent(t,0.4,true)
call TriggerAddCondition(t,Condition(function NS3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call UnitRemoveAbility(hero,DSI[JGO])
set JGO=JGO-1
call SaveInteger(LY,(GetHandleId(hero)),(829),(JGO))
call AddSkill(hero,DSI[JGO])
else
call PZI(GetOwningPlayer(GetTriggerUnit()),"无可用次数")
endif
call RemoveLocation(point)
set t=null
set hero=null
set point=null
endfunction
// 火枪 hero
function NR3 takes nothing returns boolean
if GetSpellAbilityId()=='A2ZR' or GetSpellAbilityId()=='A2ZQ' or GetSpellAbilityId()=='A064' or GetSpellAbilityId()=='A2ZP' then
call NT3()
endif
return false
endfunction
function NP3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(829)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer NQ3=3
if JGO<NQ3 then
set NPI=NPI-1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==0 then
call UnitRemoveAbility(hero,DSI[JGO])
set NPI=40
call SaveInteger(LY,(handle_id),(34),(NPI))
set JGO=JGO+1
call SaveInteger(LY,(GetHandleId(hero)),(829),(JGO))
call AddSkill(hero,DSI[JGO])
endif
endif
set t=null
set hero=null
return false
endfunction
function NU3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(hero)),(829),(3))
call AddSkill(hero,DSI[3])
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function NP3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(40))
set hero=null
set t=null
endfunction
function S03 takes nothing returns boolean
if GetLearnedSkill()=='A2ZO' and IsUnitIllusion(GetTriggerUnit())==false then
if GetUnitAbilityLevel(GetTriggerUnit(),'A2ZO')==1 then
call NU3()
endif
endif
return false
endfunction
function YT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NR3))
call Q1I('A19F')
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function S03))
set t=null
set DSI[0]='A2ZR'
set DSI[1]='A2ZQ'
set DSI[2]='A064'
set DSI[3]='A2ZP'
endfunction
function SI3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local effect FX=(LoadEffectHandle(LY,(handle_id),(32)))
local player p=GetOwningPlayer(SFI)
call UnitShareVision(target,p,false)
call DestroyEffect(FX)
call RemoveUnit(dummy)
call UnitRemoveAbility(target,'B06H')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
set dummy=null
set target=null
set FX=null
set p=null
return false
endfunction
function S13 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local player p=GetOwningPlayer(SFI)
local unit dummy
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local string s="effects\\Snipe Target.mdx"
if IsPlayerAlly(GetLocalPlayer(),p)==false and P0I(GetLocalPlayer())==false then
set s=""
endif
call UnitShareVision(target,p,true)
set dummy=CreateUnit(GetOwningPlayer(target),'e01R',0,0,0)
call AddSkill(dummy,'A0NI')
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(s,target,"overhead")))
call TriggerRegisterTimerEvent(t,4,false)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function SI3))
set t=null
set SFI=null
set target=null
set dummy=null
set p=null
endfunction
function SO3 takes nothing returns boolean
if GetSpellAbilityId()=='A04P' or GetSpellAbilityId()=='A1AU' then
call S13()
endif
return false
endfunction
function YR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CHANNEL)
call TriggerAddCondition(t,Condition(function SO3))
set t=null
endfunction
function S23 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(827)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or Z7O<(TimerGetElapsed(M))then
call UnitRemoveAbility(hero,'A2YK')
call UnitRemoveAbility(hero,'B0HD')
call UnitRemoveAbility(hero,'A2YM')
call SaveReal(LY,(GetHandleId(hero)),(827),((0)*1.0))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function S33 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local real Z7O=(LoadReal(LY,(GetHandleId(hero)),(827)))
local integer level=GetUnitAbilityLevel(hero,'A03S')
call SaveReal(LY,(GetHandleId(hero)),(827),(((TimerGetElapsed(M))+0.5)*1.0))
call Damage(hero,target,2,25*level-10)
if BJ1(target)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5+0.01,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function S23))
call SaveUnitHandle(LY,(handle_id),(2),(target))
call AddSkill(target,'A2YK')
call AddSkill(target,'A2YM')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2YK',false)
endif
set t=null
endfunction
function S43 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetEventDamageSource()==hero and GetEventDamage()>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call S33(hero,target)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function S53 takes nothing returns boolean
local unit hero=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))
local unit target=GetTriggerUnit()
local trigger t
local integer handle_id
if GetAttacker()==hero and((LoadInteger(LY,(GetHandleId((hero))),((4347))))==1)==false and IsUnitType(target,UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(target,'A04R')==0 then
if GetRandomReal(0,100)<40 then
call SCI(hero,4347,0.1)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerAddCondition(t,Condition(function S43))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
endif
set hero=null
set target=null
return false
endfunction
function S63 takes nothing returns boolean
local trigger t
local integer handle_id
if GetLearnedSkill()=='A03S' and GetUnitAbilityLevel(GetTriggerUnit(),'A03S')==1 and IsUnitIllusion(GetTriggerUnit())==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function S53))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
set t=null
endif
return false
endfunction
function YP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function S63))
set t=null
endfunction
function S73 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e003',x,y,0)
local integer level=GetUnitAbilityLevel(SFI,'A0RG')
local real S83=(83+17*level)*0.01
call SetUnitVertexColor(dummy,255,255,255,150)
call UnitApplyTimedLife(dummy,'BTLF',6)
call SetUnitScale(dummy,S83,S83,S83)
if IsPlayerTeam2(GetOwningPlayer(SFI))then
call AddSkill(dummy,'A019')
call SetUnitAbilityLevel(dummy,'A019',level)
else
call AddSkill(dummy,'A0E7')
call SetUnitAbilityLevel(dummy,'A0E7',level)
endif
call IssuePointOrder(dummy,"cloudoffog",x,y)
call RemoveLocation(point)
set SFI=null
set point=null
set dummy=null
endfunction
function S93 takes nothing returns boolean
if GetSpellAbilityId()=='A0RG' then
call P32()
call S73()
endif
return false
endfunction
function JI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function S93))
endfunction
function SA3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local player p
local integer level=GetUnitAbilityLevel(hero,'A00J')
local real HJ3=(level+3)/4
if(TimerGetElapsed(M))>(10-2*level)+E0I then
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+HJ3)
endif
set p=null
set t=null
set hero=null
return false
endfunction
function SB3 takes nothing returns boolean
local unit hero=GetAttacker()
local integer level=GetUnitAbilityLevel(hero,'A00J')
if level>0 then
set E0I=(TimerGetElapsed(M))
call UnitRemoveAbility(hero,DUI[level])
call UnitRemoveAbility(hero,'A00J')
call AddSkill(hero,DUI[level])
call AddSkill(hero,'A00J')
call SetUnitAbilityLevel(hero,'A00J',level)
endif
set hero=null
return false
endfunction
function SC3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A00J')
local trigger t
local integer handle_id
if level==1 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function SA3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endif
if GetUnitAbilityLevel(hero,'A0MB')==0 then
call AddSkill(hero,'A0MB')
endif
if level==2 then
call UnitRemoveAbility(hero,DUI[1])
elseif level==3 then
call UnitRemoveAbility(hero,DUI[1])
call UnitRemoveAbility(hero,DUI[2])
elseif level==4 then
call UnitRemoveAbility(hero,DUI[1])
call UnitRemoveAbility(hero,DUI[2])
call UnitRemoveAbility(hero,DUI[3])
endif
call SetUnitAbilityLevel(hero,'A0MB',level)
call AddSkill(hero,DUI[level])
set hero=null
endfunction
function SD3 takes nothing returns boolean
if GetLearnedSkill()=='A00J' and IsUnitIllusion(GetTriggerUnit())==false then
call SC3()
endif
return false
endfunction
function YU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function SD3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function SB3))
set DUI[1]='A2UR'
set DUI[2]='A2US'
set DUI[3]='A2UT'
set DUI[4]='A2YU'
set t=null
endfunction
function SE3 takes integer id returns boolean
return id=='A2YZ' or id=='A2YW' or id=='A2YV' or id=='A2YY' or id=='A2YX' or id=='A2Z0' or id=='A2ZL'
endfunction
function SF3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real PAI=10+30*GetUnitAbilityLevel(hero,'A0K9')
local trigger t
local integer handle_id
local real x=GetUnitX(target)-75*Cos(GetUnitFacing(target)*bj_DEGTORAD)
local real y=GetUnitY(target)-75*Sin(GetUnitFacing(target)*bj_DEGTORAD)
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(828)))
if JGO>0 then
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
call SetUnitFacing(hero,GetUnitFacing(target))
call DestroyEffect(AddSpecialEffect("war3mapImported\\BlinkStrike.mdx",x,y))
if IsUnitEnemy(target,GetOwningPlayer(hero))then
call Damage(hero,target,1,PAI)
call SaveBoolean(LY,(GetHandleId(hero)),(332),(true))
call IssueTargetOrder(hero,"attack",target)
endif
call UnitRemoveAbility(hero,EII[JGO])
set JGO=JGO-1
call SaveInteger(LY,(GetHandleId(hero)),(828),(JGO))
call AddSkill(hero,EII[JGO])
else
call PZI(GetOwningPlayer(GetTriggerUnit()),"无可用次数")
endif
set hero=null
set target=null
set t=null
endfunction
function SG3 takes nothing returns boolean
if SE3(GetSpellAbilityId())then
call SF3()
endif
return false
endfunction
function SH3 takes nothing returns boolean
if SE3(GetSpellAbilityId())then
call DestroyEffect(AddSpecialEffect("war3mapImported\\BlinkStrike.mdx",GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit())))
endif
return false
endfunction
function SZ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(828)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer NQ3=3+GetUnitAbilityLevel(hero,'A0K9')
if JGO<NQ3 then
set NPI=NPI-1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==0 then
call UnitRemoveAbility(hero,EII[JGO])
set NPI=35
call SaveInteger(LY,(handle_id),(34),(NPI))
set JGO=JGO+1
call SaveInteger(LY,(GetHandleId(hero)),(828),(JGO))
call AddSkill(hero,EII[JGO])
endif
endif
set t=null
set hero=null
return false
endfunction
function SV3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(hero)),(828),(4))
call AddSkill(hero,EII[4])
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function SZ3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(35))
set hero=null
set t=null
endfunction
function SW3 takes nothing returns boolean
if GetLearnedSkill()=='A0K9' and IsUnitIllusion(GetTriggerUnit())==false then
if GetUnitAbilityLevel(GetTriggerUnit(),'A0K9')==1 then
call SV3()
endif
endif
return false
endfunction
function J11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SG3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function SH3))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function SW3))
set t=null
set EII[0]='A2YZ'
set EII[1]='A2YW'
set EII[2]='A2YV'
set EII[3]='A2YY'
set EII[4]='A2YX'
set EII[5]='A2Z0'
set EII[6]='A2ZL'
endfunction
function SX3 takes nothing returns nothing
local unit hero=GetAttacker()
local unit target=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A0DZ')
local boolean SY3=(LoadBoolean(LY,(GetHandleId(hero)),(332)))
local real d=RAbsBJ(GetUnitFacing(target)-GetUnitFacing(hero))
if d>180 then
set d=360-d
endif
if d<=105 or SY3 then
call SaveBoolean(LY,(GetHandleId(hero)),(332),(false))
if GetUnitAbilityLevel(target,'A04R')==0 then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",target,"chest"))
call Damage(hero,target,2,GetHeroAgi(hero,true)*(0.25*level+0.25))
endif
endif
set hero=null
set target=null
endfunction
function SJ3 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A0DZ')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false then
if IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))==false or(IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==false and GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)/GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_LIFE)<0.5)then
call SX3()
endif
endif
return false
endfunction
function J01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function SJ3))
set t=null
endfunction
function SK3 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
call AX1(GetEnumUnit(),E1I,1,8,'B0BV')
call UnitMakeAbilityPermanent(GetEnumUnit(),true,E1I)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),E1I,false)
endfunction
function SL3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2IS')
local group g=NTI()
if level==1 then
set E1I='A1F6'
elseif level==2 then
set E1I='A1F7'
elseif level==3 then
set E1I='A1F3'
elseif level==4 then
set E1I='A1F5'
endif
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),925,Condition(function CK1))
call ForGroup(g,function SK3)
call NSI(g)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\BattleRoar\\RoarCaster.mdl",hero,"overhead"))
set hero=null
set g=null
endfunction
function SM3 takes nothing returns boolean
if GetSpellAbilityId()=='A2IS' then
call SL3()
endif
return false
endfunction
function SU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SM3))
set t=null
endfunction
function SN3 takes unit SWI returns boolean
if ES1(SWI,FR0[L50])!=null then
return true
endif
return false
endfunction
function SS3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local boolean CK3=SN3(SFI)
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if(GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT and NPI>1)or(GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and E31(GetSpellAbilityId())and GetSpellTargetUnit()==SFI)then
if(GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT and NPI>1)then
if IsUnitDead(SFI)==false then
call UnitRemoveAbility(SFI,'A2Z7')
call UnitRemoveAbility(SFI,'A2Z9')
call UnitRemoveAbility(SFI,'A2Z8')
call UnitRemoveAbility(SFI,'A0WO')
call UnitRemoveAbility(SFI,'A31E')
call UnitRemoveAbility(SFI,'B009')
call UnitRemoveAbility(SFI,'B0DP')
call UnitRemoveAbility(SFI,'B0HN')
call UnitRemoveAbility(SFI,'B0HO')
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT then
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\BattleCryCaster.mdx",SFI,"overhead"))
if CK3 then
if level==1 then
call AddSkill(SFI,'A2Z7')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2Z7',false)
call AddSkill(SFI,'A31V')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A31V',false)
endif
if level==2 then
call AddSkill(SFI,'A2Z9')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2Z9',false)
call AddSkill(SFI,'A31U')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A31U',false)
endif
if level==3 then
call AddSkill(SFI,'A2Z8')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2Z8',false)
call AddSkill(SFI,'A31W')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A31W',false)
endif
else
call AddSkill(SFI,'A0WO')
call SetUnitAbilityLevel(SFI,'A0WO',level)
call UnitMakeAbilityPermanent(SFI,true,'A0WO')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A0WO',false)
endif
endif
set t=null
set SFI=null
return false
endfunction
function ST3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit dummy
local integer level=GetUnitAbilityLevel(SFI,'A1WH')
call TriggerRegisterTimerEvent(t,25,false)
call TriggerRegisterTimerEvent(t,0.31,false)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SS3))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveInteger(LY,(handle_id),(5),(level))
set t=null
set SFI=null
endfunction
function SR3 takes nothing returns boolean
if GetSpellAbilityId()=='A1WH' and GetUnitTypeId(GetTriggerUnit())=='H001' then
call ST3()
endif
return false
endfunction
function T01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SR3))
set t=null
endfunction
function SP3 takes nothing returns nothing
call DD1(EOI,GetEnumUnit(),2)
call Damage(EOI,GetEnumUnit(),1,E2I*75+25)
endfunction
function SQ3 takes player p,unit target,integer level returns nothing
local unit dummy=CreateUnit(p,'e00E',GetUnitX(target),GetUnitY(target),0)
local integer IB1
local group g=NTI()
set E2I=level
set GK=K1[GetPlayerId(p)]
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),280,Condition(function CA1))
call GroupAddUnit(g,target)
set EOI=dummy
call ForGroup(g,function SP3)
call NSI(g)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\StormBolt\\StormBoltMissile.mdl",target,"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\StormBolt\\StormBoltMissile.mdl",target,"origin"))
set dummy=null
set g=null
endfunction
function SU3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real IH1=1000*0.035
local real IZ1=UEI(x,y,QJI,QKI)
local real IV1=x+IH1*Cos(IZ1*bj_DEGTORAD)
local real IW1=y+IH1*Sin(IZ1*bj_DEGTORAD)
local boolean ZXO=(LoadBoolean(LY,(handle_id),(249)))
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SetUnitFacing(IG1,IZ1)
if((LoadInteger(LY,(GetHandleId((target))),((4422))))==1)==true then
set ZXO=false
call SaveBoolean(LY,(handle_id),(249),(ZXO))
endif
if UTI(QJI,QKI,IV1,IW1)<=IH1 then
if ZXO then
call SQ3(p,target,level)
endif
call KillUnit(IG1)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set IG1=null
return false
endfunction
function T03 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A190')
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h07Q',GetUnitX(hero),GetUnitY(hero),UEI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target)))
local boolean ZXO=CanResistSkill(GetSpellTargetUnit())==false
call SaveBoolean(LY,(handle_id),(249),(ZXO))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveInteger(LY,(handle_id),(5),(level))
call TriggerRegisterTimerEvent(t,0.035,true)
call TriggerAddCondition(t,Condition(function SU3))
set t=null
set hero=null
set target=null
set IG1=null
endfunction
function TI3 takes nothing returns boolean
if GetSpellAbilityId()=='A190' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",GetTriggerUnit(),"weapon"))
else
call T03()
endif
endif
return false
endfunction
function SQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function TI3))
set t=null
endfunction
function T13 takes nothing returns boolean
if((GetUnitTypeId(GetFilterUnit())=='n01G'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n01C'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n018'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n004'))then
return true
endif
return false
endfunction
function TO3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit ZOO
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
local integer level=GetUnitAbilityLevel(hero,GetSpellAbilityId())
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(hero),Condition(function T13))
set ZOO=FirstOfGroup(g)
call NSI(g)
if GetSpellAbilityId()=='A1EF' then
call AddSkill(dummy,'A0AA')
call SetUnitAbilityLevel(dummy,'A0AA',level)
elseif GetSpellAbilityId()=='A1EE' then
call AddSkill(dummy,'A0AB')
call SetUnitAbilityLevel(dummy,'A0AB',level)
elseif GetSpellAbilityId()=='A1EH' then
call AddSkill(dummy,'A0AC')
call SetUnitAbilityLevel(dummy,'A0AC',level)
elseif GetSpellAbilityId()=='A1EI' then
call AddSkill(dummy,'A0AD')
call SetUnitAbilityLevel(dummy,'A0AD',level)
elseif GetSpellAbilityId()=='A1EG' then
call AddSkill(dummy,'A0AE')
call SetUnitAbilityLevel(dummy,'A0AE',level)
endif
call IssueTargetOrder(dummy,"bloodlust",hero)
if ZOO!=null and IsUnitDead(ZOO)==false then
call IssueTargetOrder(dummy,"bloodlust",ZOO)
endif
set g=null
set hero=null
set ZOO=null
set dummy=null
endfunction
function T23 takes nothing returns boolean
if GetSpellAbilityId()=='A1EF' or GetSpellAbilityId()=='A1EE' or GetSpellAbilityId()=='A1EH' or GetSpellAbilityId()=='A1EI' or GetSpellAbilityId()=='A1EG' then
call TO3()
endif
return false
endfunction
function JO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function T23))
set t=null
endfunction
function T33 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit ZOO=(LoadUnitHandle(LY,(handle_id),(2)))
local real T43
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>2 and GetEventDamageSource()!=GetTriggerUnit()and T2I(GetOwningPlayer(GetEventDamageSource()))then
call SaveReal(LY,(handle_id),(714),(((TimerGetElapsed(M)))*1.0))
endif
endif
set T43=(LoadReal(LY,(handle_id),(714)))
if T43+3<(TimerGetElapsed(M))then
if(LoadInteger(LY,(handle_id),(34)))==2 then
call SaveInteger(LY,(handle_id),(34),(1))
call SaveInteger(LY,(GetHandleId((ZOO))),((4327)),(2))
call SetPlayerAbilityAvailable(GetOwningPlayer(ZOO),'A0A7',true)
endif
else
if(LoadInteger(LY,(handle_id),(34)))==1 then
call SaveInteger(LY,(handle_id),(34),(2))
call SaveInteger(LY,(GetHandleId((ZOO))),((4327)),(1))
call SetPlayerAbilityAvailable(GetOwningPlayer(ZOO),'A0A7',false)
endif
endif
set t=null
set ZOO=null
return false
endfunction
function T53 takes unit ZOO returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerRegisterUnitEvent(t,ZOO,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,ZOO,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function T33))
call SaveUnitHandle(LY,(handle_id),(2),(ZOO))
call SaveReal(LY,(handle_id),(714),((0)*1.0))
call SaveInteger(LY,(handle_id),(34),(1))
call SetPlayerAbilityAvailable(GetOwningPlayer(ZOO),'A0A7',true)
set t=null
endfunction
function T63 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),'B0C1')>0
endfunction
function T73 takes nothing returns nothing
call Damage(E3I,GetEnumUnit(),2,30)
endfunction
function T83 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit ZOO=(LoadUnitHandle(LY,(handle_id),(53)))
local group g=NTI()
set GK=ZOO
set E3I=ZOO
call GroupEnumUnitsInRange(g,GetUnitX(ZOO),GetUnitY(ZOO),2000,Condition(function T63))
call ForGroup(g,function T73)
call NSI(g)
set t=null
set g=null
set ZOO=null
return false
endfunction
function T93 takes nothing returns nothing
local unit ZOO=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function T83))
call SaveUnitHandle(LY,(handle_id),(53),(ZOO))
set ZOO=null
set t=null
endfunction
function TA3 takes nothing returns boolean
return GetLearnedSkill()=='A0A5' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function TB3 takes nothing returns boolean
if IsUnitDead(GetFilterUnit())then
return false
endif
if((GetUnitTypeId(GetFilterUnit())=='n01C'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n018'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n004'))then
return true
endif
return false
endfunction
function TC3 takes nothing returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(GetTriggerUnit()))
local unit TD3=(LoadUnitHandle(LY,(handle_id),(334)))
local unit ZOO=(LoadUnitHandle(LY,(handle_id),(333)))
if TD3!=null and X0==false then
call UnitAddItem(ZOO,UnitRemoveItemFromSlot(TD3,0))
call UnitAddItem(ZOO,UnitRemoveItemFromSlot(TD3,1))
call UnitAddItem(ZOO,UnitRemoveItemFromSlot(TD3,2))
call UnitAddItem(ZOO,UnitRemoveItemFromSlot(TD3,3))
call UnitAddItem(ZOO,UnitRemoveItemFromSlot(TD3,4))
call UnitAddItem(ZOO,UnitRemoveItemFromSlot(TD3,5))
endif
endfunction
function TE3 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local player T4I=GetOwningPlayer(PKI)
local location BFO=GetUnitLoc(PKI)
local boolexpr QL1=Condition(function TB3)
local group Z51=NTI()
local integer level=GetUnitAbilityLevel(PKI,'A0A5')
local integer handle_id=GetHandleId(T4I)
local integer TF3
local unit ZOO
local real Z43
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(PKI),QL1)
call DestroyBoolExpr(QL1)
if(level==1)then
call T93()
endif
set TF3=CountUnitsInGroup(Z51)
if(TF3==1)then
set ZOO=FirstOfGroup(Z51)
set Z43=GetUnitLifePercent(ZOO)
set BFO=GetUnitLoc(ZOO)
call ShowUnit(ZOO,false)
call KillUnit(ZOO)
if(level==2)then
call CreateNUnitsAtLoc(1,'n018',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
elseif(level==3)then
call CreateNUnitsAtLoc(1,'n01C',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
elseif(level==4)then
call CreateNUnitsAtLoc(1,'n01G',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
endif
call SetUnitLifePercentBJ(bj_lastCreatedUnit,Z43)
call SaveUnitHandle(LY,(handle_id),(333),(bj_lastCreatedUnit))
call TC3()
endif
call NSI(Z51)
endfunction
function J51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function TA3))
call TriggerAddAction(t,function TE3)
endfunction
function TG3 takes nothing returns boolean
return GetLearnedSkill()=='A0A8' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function TH3 takes nothing returns nothing
call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()),'R000',GetPlayerTechCount(GetOwningPlayer(GetTriggerUnit()),'R000',true)+1)
call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()),'R001',GetPlayerTechCount(GetOwningPlayer(GetTriggerUnit()),'R001',true)+1)
endfunction
function J61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function TG3))
call TriggerAddAction(t,function TH3)
endfunction
function TZ3 takes nothing returns boolean
return GetSpellAbilityId()=='A0A5'
endfunction
function TV3 takes nothing returns boolean
if IsUnitDead(GetFilterUnit())then
return false
endif
if((GetUnitTypeId(GetFilterUnit())=='n01G'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n01C'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n018'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n004'))then
return true
endif
return false
endfunction
function TW3 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local player T4I=GetOwningPlayer(PKI)
local location BFO=GetUnitLoc(PKI)
local boolexpr QL1=Condition(function TV3)
local group Z51=NTI()
local integer level=GetUnitAbilityLevel(PKI,'A0A5')
local integer handle_id=GetHandleId(T4I)
local boolean TX3
local unit ZOO
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(PKI),QL1)
set TX3=CountUnitsInGroup(Z51)==0
if(level==1 and TX3)then
call CreateNUnitsAtLoc(1,'n004',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call SaveUnitHandle(LY,(handle_id),(333),(bj_lastCreatedUnit))
call TC3()
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
elseif(level==2 and TX3)then
call CreateNUnitsAtLoc(1,'n018',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call SaveUnitHandle(LY,(handle_id),(333),(bj_lastCreatedUnit))
call TC3()
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
elseif(level==3 and TX3)then
call CreateNUnitsAtLoc(1,'n01C',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call SaveUnitHandle(LY,(handle_id),(333),(bj_lastCreatedUnit))
call TC3()
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
elseif(level==4 and TX3)then
call CreateNUnitsAtLoc(1,'n01G',GetOwningPlayer(GetTriggerUnit()),BFO,bj_UNIT_FACING)
call SaveUnitHandle(LY,(handle_id),(333),(bj_lastCreatedUnit))
call TC3()
call AddSpecialEffectTargetUnitBJ("chest",bj_lastCreatedUnit,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call T53(bj_lastCreatedUnit)
elseif TX3==false then
set ZOO=FirstOfGroup(Z51)
call AddSpecialEffectTargetUnitBJ("chest",ZOO,"Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl")
call SetUnitState(ZOO,UNIT_STATE_LIFE,GetUnitState(ZOO,UNIT_STATE_MAX_LIFE))
call SetUnitPosition(ZOO,GetUnitX(PKI),GetUnitY(PKI))
set ZOO=null
endif
call SetUnitAbilityLevel(bj_lastCreatedUnit,'A09Y',level)
call NSI(Z51)
call RemoveLocation(BFO)
set PKI=null
set T4I=null
set BFO=null
set Z51=null
endfunction
function TY3 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local player T4I=GetOwningPlayer(PKI)
local location BFO=GetUnitLoc(PKI)
local boolexpr QL1=Condition(function TV3)
local group Z51=NTI()
local integer level=GetUnitAbilityLevel(PKI,'A0A5')
local integer handle_id=GetHandleId(T4I)
local boolean TX3
local unit ZOO
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(PKI),QL1)
if CountUnitsInGroup(Z51)!=0 then
set ZOO=FirstOfGroup(Z51)
if ZOO!=null and((LoadInteger(LY,(GetHandleId((ZOO))),((4327))))==1)==true then
call PJI(PKI)
call PZI(T4I,"熊灵受到伤害时无法重新召唤")
endif
endif
call NSI(Z51)
call RemoveLocation(BFO)
endfunction
function J31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TZ3))
call TriggerAddAction(t,function TW3)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function TZ3))
call TriggerAddAction(t,function TY3)
endfunction
function TJ3 takes nothing returns boolean
return GetSpellAbilityId()=='A0A7'
endfunction
function TK3 takes nothing returns nothing
local unit ZOO=GetTriggerUnit()
local unit Z2O=K1[GetPlayerId(GetOwningPlayer(ZOO))]
call MUSetUnitX(ZOO,GetUnitX(Z2O)+GetRandomReal(25,50)*Cos(GetRandomReal(0,360)))
call MUSetUnitY(ZOO,GetUnitY(Z2O)+GetRandomReal(25,50)*Sin(GetRandomReal(0,360)))
endfunction
function J41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TJ3))
call TriggerAddAction(t,function TK3)
endfunction
function TL3 takes nothing returns boolean
return(GetUnitTypeId(GetTriggerUnit())=='N013' or GetUnitTypeId(GetTriggerUnit())=='N01O' or GetUnitTypeId(GetTriggerUnit())=='N015' or GetUnitTypeId(GetTriggerUnit())=='N014')and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function TM3 takes nothing returns nothing
local unit ZOO=(LoadUnitHandle(LY,(GetHandleId(GetOwningPlayer(GetTriggerUnit()))),(333)))
call KillUnit(ZOO)
endfunction
function J81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function TL3))
call TriggerAddAction(t,function TM3)
endfunction
function TN3 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call SCI(hero,4343,5)
call UnitAddAbility(dummy,'A1GZ')
call IssueTargetOrder(dummy,"ensnare",target)
set dummy=null
endfunction
function TS3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call TN3(hero,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function TT3 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function TS3))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function TR3 takes nothing returns nothing
local unit hero=GetAttacker()
if GetUnitTypeId(hero)!='n01G' and GetUnitTypeId(hero)!='n01C' then
return
endif
if((LoadInteger(LY,(GetHandleId((hero))),((4342))))==1)==false and((LoadInteger(LY,(GetHandleId((hero))),((4343))))==1)==false and GetRandomInt(0,100)<20 then
call SCI(hero,4342,.3)
call TT3()
endif
return
endfunction
function TP3 takes nothing returns boolean
return GetUnitTypeId(GetAttacker())=='n01G' or GetUnitTypeId(GetAttacker())=='n01C' or GetUnitTypeId(GetAttacker())=='n018' or GetUnitTypeId(GetAttacker())=='n004'
endfunction
function TQ3 takes nothing returns nothing
local unit ZOO=GetAttacker()
local unit Z2O=K1[GetPlayerId(GetOwningPlayer(ZOO))]
if((GetUnitX(Z2O)-GetUnitX(ZOO))*(GetUnitX(Z2O)-GetUnitX(ZOO))+(GetUnitY(Z2O)-GetUnitY(ZOO))*(GetUnitY(Z2O)-GetUnitY(ZOO))>=(1100*1100))then
call IssueImmediateOrder(ZOO,"stop")
else
call TR3()
endif
endfunction
function J21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function TP3))
call TriggerAddAction(t,function TQ3)
endfunction
function TU3 takes nothing returns boolean
return(GetUnitTypeId(GetTriggerUnit())=='n01G' or GetUnitTypeId(GetTriggerUnit())=='n01C' or GetUnitTypeId(GetTriggerUnit())=='n018' or GetUnitTypeId(GetTriggerUnit())=='n004')and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function R03 takes nothing returns nothing
local location I2O
if IsPlayerTeam1(GetOwningPlayer(GetTriggerUnit()))then
set I2O=GetRectCenter(O4)
else
set I2O=GetRectCenter(S3)
endif
if F41(GetEnumItem())==false then
call SetItemPositionLoc(GetEnumItem(),I2O)
endif
call RemoveLocation(I2O)
set I2O=null
endfunction
function RI3 takes nothing returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(GetTriggerUnit()))
local unit TD3=(LoadUnitHandle(LY,(handle_id),(334)))
local unit ZOO=(LoadUnitHandle(LY,(handle_id),(333)))
local integer x
local integer y
if TD3==null then
if IsPlayerTeam1(GetOwningPlayer(ZOO))then
set x=-6390
set y=-5615
else
set x=5875
set y=5000
endif
set TD3=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'e01F',x,y,0)
call SaveUnitHandle(LY,(handle_id),(334),(TD3))
endif
if F41(GetEnumItem())==false then
call UnitAddItem(TD3,GetEnumItem())
endif
call ShowUnit(TD3,true)
endfunction
function R13 takes nothing returns nothing
local integer E81=GetItemId(GetEnumItem())
if GetWidgetLife(GetEnumItem())>0 and E81!=VL0 then
if X0==true then
call R03()
else
call RI3()
endif
else
endif
endfunction
function RO3 takes nothing returns nothing
local location BFO=GetUnitLoc(GetTriggerUnit())
local rect R23=RectFromCenterSizeBJ(BFO,400.00,400.00)
local unit Z2O=K1[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]
call SetHeroXP(Z2O,(GetHeroXP(Z2O)-(GetHeroXP(Z2O)/(125-(25*GetUnitAbilityLevel(Z2O,'A0A5'))))),false)
call Damage(GetKillingUnit(),Z2O,3,0.1*GetUnitState(Z2O,UNIT_STATE_MAX_LIFE))
call EnumItemsInRectBJ(R23,function R13)
call RemoveLocation(BFO)
call RemoveRect(R23)
endfunction
function J71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function TU3))
call TriggerAddAction(t,function RO3)
endfunction
function R33 takes nothing returns boolean
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if T2I(GetOwningPlayer(GetEventDamageSource()))and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))==true and EWI==false then
if EXI==false then
call UnitRemoveAbility(GetTriggerUnit(),'B0BM')
call FlushTrigger(GetTriggeringTrigger())
endif
endif
if EXI==true then
set EXI=false
endif
if EWI==true then
set EWI=false
endif
else
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function R43 takes nothing returns nothing
local unit target=GetEnumUnit()
local trigger t=CreateTrigger()
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function R33))
set target=null
set t=null
endfunction
function R53 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'B0BM')>0 and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0
endfunction
function R63 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g=NTI()
call GroupEnumUnitsInRange(g,x,y,1000,Condition(function R53))
call ForGroup(g,function R43)
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set g=null
return false
endfunction
function R73 takes nothing returns nothing
if E4I==1 or E4I==2 then
call Damage(GetTriggerUnit(),GetEnumUnit(),2,70+10*E5I)
endif
if E4I==1 or E4I==3 then
call Damage(GetTriggerUnit(),GetEnumUnit(),1,70+10*E5I)
endif
endfunction
function R83 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h07Z',x,y,0)
local group g=NTI()
local unit u
set E5I=GetUnitAbilityLevel(hero,'A1AA')
if((LoadInteger(LY,(GetHandleId((hero))),((4270))))==1)==false then
call SetUnitTimeScale(dummy,2.5)
call UnitApplyTimedLife(dummy,'BTLF',2)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call AddSkill(dummy,'A1A9')
call SetUnitAbilityLevel(dummy,'A1A9',GetUnitAbilityLevel(hero,'A1AA'))
call IssueImmediateOrder(dummy,"stomp")
call GroupEnumUnitsInRange(g,x,y,500,Condition(function C51))
set E4I=1
call ForGroup(g,function R73)
call NSI(g)
call TriggerRegisterTimerEvent(t,0.65,false)
call TriggerAddCondition(t,Condition(function R63))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
else
call SetUnitTimeScale(dummy,2.5)
call UnitApplyTimedLife(dummy,'BTLF',2)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call AddSkill(dummy,'A1A9')
call SetUnitAbilityLevel(dummy,'A1A9',GetUnitAbilityLevel(hero,'A1AA'))
call IssueImmediateOrder(dummy,"stomp")
call GroupEnumUnitsInRange(g,x,y,500,Condition(function C51))
set E4I=2
call ForGroup(g,function R73)
call TriggerRegisterTimerEvent(t,0.65,false)
call TriggerAddCondition(t,Condition(function R63))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set u=(EVI[GetPlayerId(GetOwningPlayer((hero)))])
call IssueImmediateOrder(u,"stop")
set x=GetUnitX(u)
set y=GetUnitY(u)
set dummy=CreateUnit(GetOwningPlayer(hero),'h07Z',x,y,0)
call SetUnitTimeScale(dummy,2.5)
call UnitApplyTimedLife(dummy,'BTLF',2)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call AddSkill(dummy,'A1A9')
call SetUnitAbilityLevel(dummy,'A1A9',GetUnitAbilityLevel(hero,'A1AA'))
call IssueImmediateOrder(dummy,"stomp")
call GroupEnumUnitsInRange(g,x,y,500,Condition(function C51))
set E4I=3
call ForGroup(g,function R73)
call NSI(g)
call TriggerRegisterTimerEvent(t,0.65,false)
call TriggerAddCondition(t,Condition(function R63))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SetUnitAnimationByIndex(u,3)
endif
set t=null
set hero=null
set dummy=null
set g=null
endfunction
function R93 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IYO=(LoadUnitHandle(LY,(handle_id),(335)))
local boolean RA3=(LoadBoolean(LY,(handle_id),(336)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
call SaveInteger(LY,(GetHandleId((hero))),((4269)),(2))
call SaveBoolean(LY,(GetHandleId(IYO)),(337),(true))
if RA3 then
call ShowUnit(IYO,false)
call KillUnit(IYO)
else
call ShowUnit(IYO,false)
call UnitRemoveAbility(IYO,'Aloc')
call ShowUnit(IYO,true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if RA3 then
call SetUnitFacing(IYO,GetUnitFacing(hero))
endif
endif
set t=null
set IYO=null
return false
endfunction
function RB3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit IYO
local boolean KillImage
call SaveBoolean(LY,(handle_id),(336),(false))
if((LoadInteger(LY,(GetHandleId((hero))),((4270))))==1)==false then
call SaveBoolean(LY,(handle_id),(336),(true))
set IYO=CreateUnit(GetOwningPlayer(hero),'h07U',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call AddSkill(IYO,'Aloc')
call AddSkill(IYO,'Aetl')
call SetUnitPosition(IYO,GetUnitX(hero),GetUnitY(hero))
call SetUnitScale(IYO,1.4,1.4,1.4)
else
set IYO=(EVI[GetPlayerId(GetOwningPlayer((hero)))])
call UnitAddAbility(IYO,'Aloc')
endif
call IssueImmediateOrder(IYO,"stop")
call SaveInteger(LY,(GetHandleId((hero))),((4269)),(1))
call SetUnitAnimation(IYO,"spell slam")
call QueueUnitAnimation(IYO,"spell slam")
call SaveUnitHandle(LY,(handle_id),(335),(IYO))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function R93))
call SaveUnitHandle(LY,(handle_id),(335),(IYO))
set t=null
set hero=null
set IYO=null
endfunction
function RC3 takes nothing returns boolean
local integer CCO
if GetSpellAbilityId()=='A1AA' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_FINISH then
call R83()
else
call RB3()
endif
endif
return false
endfunction
function TU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_FINISH)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function RC3))
set t=null
endfunction
function RD3 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A1CA')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A1CA')
call UnitRemoveAbility(GetEnumUnit(),'B0BP')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A1C9')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A1C9')
call UnitRemoveAbility(GetEnumUnit(),'B0BP')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A1CB')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A1CB')
call UnitRemoveAbility(GetEnumUnit(),'B0BP')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A1CC')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A1CC')
call UnitRemoveAbility(GetEnumUnit(),'B0BP')
endif
call GA1(GetEnumUnit(),0)
endfunction
function RE3 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if E6I==1 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1CA')==0 then
call AddSkill(GetEnumUnit(),'A1CA')
endif
elseif E6I==2 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1C9')==0 then
call AddSkill(GetEnumUnit(),'A1C9')
endif
elseif E6I==3 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1CB')==0 then
call AddSkill(GetEnumUnit(),'A1CB')
endif
elseif E6I==4 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1CC')==0 then
call AddSkill(GetEnumUnit(),'A1CC')
endif
endif
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
call GA1(GetEnumUnit(),R2I((I2R(GetHeroAgi(GetEnumUnit(),true))/7)*I2R(E6I)/4))
endif
endfunction
function RF3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group RG3=(LoadGroupHandle(LY,(handle_id),(340)))
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
local group g2
if hero==null or GetUnitTypeId(hero)!='O015' then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call NSI(RG3)
call NSI(g)
return false
endif
set GK=hero
set E6I=GetUnitAbilityLevel(hero,'A1CD')
call GroupEnumUnitsInRange(g,x,y,300,Condition(function CA1))
if((LoadInteger(LY,(GetHandleId((hero))),((4270))))==1)==true then
set g2=NTI()
call GroupEnumUnitsInRange(g2,GetUnitX((EVI[GetPlayerId(GetOwningPlayer((hero)))])),GetUnitY((EVI[GetPlayerId(GetOwningPlayer((hero)))])),300,Condition(function CA1))
call GroupAddGroup(g2,g)
call NSI(g2)
set g2=null
endif
call GroupRemoveGroup(g,RG3)
call ForGroup(RG3,function RD3)
if IsUnitDead(hero)==false then
call ForGroup(g,function RE3)
endif
call SaveGroupHandle(LY,(handle_id),(340),(g))
call NSI(RG3)
set t=null
set hero=null
set RG3=null
return false
endfunction
function RH3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local integer i
local player p
call AddSkill(hero,'A1CQ')
call TriggerRegisterTimerEvent(t,0.3,true)
call TriggerAddCondition(t,Condition(function RF3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(340),(NTI()))
call SaveTriggerHandle(LY,(GetHandleId(hero)),(338),(t))
call SaveBoolean(LY,(GetHandleId(hero)),(339),(true))
set i=0
loop
exitwhen i>5
set p=BO[i]
call SetPlayerAbilityAvailable(p,'A1CA',false)
call SetPlayerAbilityAvailable(p,'A1C9',false)
call SetPlayerAbilityAvailable(p,'A1CB',false)
call SetPlayerAbilityAvailable(p,'A1CC',false)
set p=CO[i]
call SetPlayerAbilityAvailable(p,'A1CA',false)
call SetPlayerAbilityAvailable(p,'A1C9',false)
call SetPlayerAbilityAvailable(p,'A1CB',false)
call SetPlayerAbilityAvailable(p,'A1CC',false)
set i=i+1
endloop
set t=null
set hero=null
endfunction
function RZ3 takes nothing returns boolean
if GetLearnedSkill()=='A1CD' and GetUnitAbilityLevel(GetTriggerUnit(),'A1CD')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call RH3()
endif
return false
endfunction
function TQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function RZ3))
set t=null
endfunction
function RV3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call BP1(target)
set t=null
set hero=null
set target=null
return false
endfunction
function RW3 takes nothing returns nothing
local real x1=E9I
local real y1=EAI
local real x2=EBI
local real y2=ECI
local real x3=GetUnitX(GetEnumUnit())
local real y3=GetUnitY(GetEnumUnit())
local real u=((x3-x1)*(x2-x1)+(y3-y1)*(y2-y1))/((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2))
local real x4=x1+u*(x2-x1)
local real y4=y1+u*(y2-y1)
local real VZ3=GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)*0.35/2
local trigger t
local integer handle_id
local integer RX3=GetUnitAbilityLevel(E8I,'A2ZH')
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
call SetUnitPosition(GetEnumUnit(),x4,y4)
else
call MUSetUnitX(GetEnumUnit(),x4)
call MUSetUnitY(GetEnumUnit(),y4)
endif
if RX3>0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call BT1(GetEnumUnit())
call TriggerRegisterTimerEvent(t,RX3+3,false)
call TriggerRegisterDeathEvent(t,GetEnumUnit())
call TriggerAddCondition(t,Condition(function RV3))
call SaveUnitHandle(LY,(handle_id),(2),(E8I))
call SaveUnitHandle(LY,(handle_id),(17),(GetEnumUnit()))
set t=null
endif
call IssueTargetOrder(E7I,"slow",GetEnumUnit())
call Damage(E8I,GetEnumUnit(),1,VZ3)
call Damage(E8I,GetEnumUnit(),2,VZ3)
endfunction
function RY3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x0=(LoadReal(LY,(handle_id),(282)))
local real y0=(LoadReal(LY,(handle_id),(283)))
local real a0=(LoadReal(LY,(handle_id),(341)))
local integer i=0
local real x
local real y
local group g=NTI()
local group PR2=NTI()
local integer level=GetUnitAbilityLevel(hero,'A1A1')
local integer MKO=(LoadInteger(LY,(handle_id),(34)))
local integer RJ3='A1CE'
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2ZH')
set RJ3='A2ZI'
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set GK=hero
set E8I=hero
set E7I=CreateUnit(GetOwningPlayer(hero),'e00E',x0,y0,0)
call AddSkill(E7I,RJ3)
call SetUnitAbilityLevel(E7I,RJ3,level)
loop
exitwhen i>MKO
set x=x0+i*200*Cos(a0)
set y=y0+i*200*Sin(a0)
call U7I("Abilities\\Spells\\Orc\\EarthQuake\\EarthQuakeTarget.mdl",x,y,1.6)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",x,y-250))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",x,y))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",x+250,y))
call UPI(x,y,300)
call GroupEnumUnitsInRange(g,x,y,325,Condition(function CA1))
call GroupAddGroup(g,PR2)
call GroupClear(g)
set i=i+1
endloop
set E9I=x0
set EAI=y0
set EBI=x
set ECI=y
call ForGroup(PR2,function RW3)
call NSI(PR2)
call NSI(g)
set t=null
set hero=null
return false
endfunction
function RK3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real x0=(LoadReal(LY,(handle_id),(282)))
local real y0=(LoadReal(LY,(handle_id),(283)))
local real a0
local real RL3
local real RM3
local real RN3
local real RS3
local real RT3
local real RR3
local real RP3
local real RQ3
local real RU3
local real P03
local real PI3
local real P13
local real x
local real y
local ubersplat AR1
local integer NPI=GetTriggerEvalCount(t)
local integer MKO=(LoadInteger(LY,(handle_id),(34)))
set x=x0+200*NPI*Cos(a)
set y=y0+200*NPI*Sin(a)
set AR1=CreateUbersplat(x,y,"THNE",255,255,255,255,false,false)
call SetUbersplatRenderAlways(AR1,true)
set RL3=x+250*Cos(bj_DEGTORAD*(a*bj_RADTODEG-45))
set RM3=y+250*Sin(bj_DEGTORAD*(a*bj_RADTODEG-45))
set RN3=x+250*Cos(bj_DEGTORAD*(a*bj_RADTODEG+45))
set RS3=y+250*Sin(bj_DEGTORAD*(a*bj_RADTODEG+45))
set RT3=x-125*Cos(bj_DEGTORAD*(a*bj_RADTODEG-45))
set RR3=y-125*Sin(bj_DEGTORAD*(a*bj_RADTODEG-45))
set RP3=x-125*Cos(bj_DEGTORAD*(a*bj_RADTODEG+45))
set RQ3=y-125*Sin(bj_DEGTORAD*(a*bj_RADTODEG+45))
set RU3=x
set P03=y
set PI3=x
set P13=y
call I41(GetOwningPlayer(hero),4,x,y,500)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",RL3,RM3))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",RN3,RS3))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",RT3,RR3))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",RP3,RQ3))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",RU3,P03))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",PI3,P13))
if GetTriggerEvalCount(t)>MKO then
set x0=(LoadReal(LY,(handle_id),(282)))
set y0=(LoadReal(LY,(handle_id),(283)))
set a0=(LoadReal(LY,(handle_id),(341)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,false)
call TriggerAddCondition(t,Condition(function RY3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(282),((x0)*1.0))
call SaveReal(LY,(handle_id),(283),((y0)*1.0))
call SaveReal(LY,(handle_id),(341),((a0)*1.0))
call SaveInteger(LY,(handle_id),(34),(MKO))
endif
set t=null
set hero=null
return false
endfunction
function PO3 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local real d=QNI(x,y,GetUnitX(hero),GetUnitY(hero))
local integer MKO=11
call TriggerRegisterTimerEvent(t,0.22,true)
call TriggerAddCondition(t,Condition(function RK3))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(282),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(283),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(341),((a)*1.0))
call SaveInteger(LY,(handle_id),(34),(MKO))
set t=null
set hero=null
endfunction
function P23 takes nothing returns boolean
if GetSpellAbilityId()=='A1A1' or GetSpellAbilityId()=='A2ZH' then
call PO3()
endif
return false
endfunction
function TR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function P23))
set t=null
endfunction
function P33 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'A2NI')
call UnitAddAbility(hero,'A2NI')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function P43 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function P33))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endfunction
function P53 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call G21(hero,0)
set t=null
set hero=null
return false
endfunction
function P63 takes unit hero,unit IYO,unit P73,integer P83,integer P93 returns nothing
local trigger t
local integer handle_id
local unit dummy
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",IYO,"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",hero,"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",hero,"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",hero,"hand,left"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",hero,"hand,right"))
call ShowUnit(IYO,false)
call KillUnit(IYO)
call KillUnit(P73)
call SaveInteger(LY,(GetHandleId((hero))),((4270)),(2))
if P93>0 or P83>0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,9.1,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function P53))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A1G9')
call SetUnitAbilityLevel(dummy,'A1G9',P93)
call IssueTargetOrder(dummy,"bloodlust",hero)
call G21(hero,P83)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\RadianceHands.mdx",hero,"weapon")))
endif
set t=null
set dummy=null
endfunction
function PA3 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),EDI)==false then
if IsUnitIllusion(GetEnumUnit())==false then
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
set EHI=EHI+(EGI*10)
set EZI=EZI+5
else
set EHI=EHI+(EGI*3)
set EZI=EZI+1
endif
endif
call GroupAddUnit(EDI,GetEnumUnit())
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",GetEnumUnit(),"chest"))
set EWI=true
set EXI=true
call Damage(EEI,GetEnumUnit(),1,EFI)
set EWI=false
set EXI=false
endif
endfunction
function PB3 takes real PC3,real PD3,real PE3,real PF3,real PG3,real PH3 returns real
local real PZ3
local real PV3
local real PW3
local real PX3
local real PY3
local real PJ3
local real PK3
local real REFLECTED_SCALED_V_X
local real REFLECTED_SCALED_V_Y
local real PL3
local real PM3
local real PN3
local real PS3
local real PT3
local real PR3
local real PP3
local real PQ3
set PN3=PE3-PG3
set PS3=PF3-PH3
set PT3=-1*PS3
set PR3=PN3
set PP3=SquareRoot(PT3*PT3+PR3*PR3)
set PT3=PT3/PP3
set PR3=PR3/PP3
set PZ3=PC3-PE3
set PV3=PD3-PF3
set PW3=SquareRoot(PZ3*PZ3+PV3*PV3)
set PX3=PZ3/PW3
set PY3=PV3/PW3
set PQ3=PZ3*PT3+PV3*PR3
set PJ3=-1*PC3+2*PE3+2*PT3*PQ3
set PK3=-1*PD3+2*PF3+2*PR3*PQ3
set PL3=PG3+PE3-PJ3
set PM3=PH3+PF3-PK3
return PL3
endfunction
function PU3 takes real PC3,real PD3,real PE3,real PF3,real PG3,real PH3 returns real
local real PZ3
local real PV3
local real PW3
local real PX3
local real PY3
local real PJ3
local real PK3
local real REFLECTED_SCALED_V_X
local real REFLECTED_SCALED_V_Y
local real PL3
local real PM3
local real PN3
local real PS3
local real PT3
local real PR3
local real PP3
local real PQ3
set PN3=PE3-PG3
set PS3=PF3-PH3
set PT3=-1*PS3
set PR3=PN3
set PP3=SquareRoot(PT3*PT3+PR3*PR3)
set PT3=PT3/PP3
set PR3=PR3/PP3
set PZ3=PC3-PE3
set PV3=PD3-PF3
set PW3=SquareRoot(PZ3*PZ3+PV3*PV3)
set PX3=PZ3/PW3
set PY3=PV3/PW3
set PQ3=PZ3*PT3+PV3*PR3
set PJ3=-1*PC3+2*PE3+2*PT3*PQ3
set PK3=-1*PD3+2*PF3+2*PR3*PQ3
set PL3=PG3+PE3-PJ3
set PM3=PH3+PF3-PK3
return PM3
endfunction
function Q03 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IYO=(LoadUnitHandle(LY,(handle_id),(335)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real x0=(LoadReal(LY,(handle_id),(282)))
local real y0=(LoadReal(LY,(handle_id),(283)))
local real x1=GetUnitX(hero)
local real y1=GetUnitY(hero)
local real x2=GetUnitX(IYO)
local real y2=GetUnitY(IYO)
local real x3
local real y3
local real a
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
local real d
local integer level=GetUnitAbilityLevel(hero,'A1A8')
local real QI3=(LoadReal(LY,(handle_id),(342)))
local real GW1=(TimerGetElapsed(M))
call MUSetUnitX(dummy,GetUnitX(IYO))
call MUSetUnitY(dummy,GetUnitY(IYO))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(IYO,false)
call KillUnit(IYO)
call KillUnit(dummy)
call SaveInteger(LY,(GetHandleId((hero))),((4270)),(2))
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1A8' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1A8',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2NI',false)
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2NI' then
call IssueImmediateOrder(IYO,"stop")
call SaveBoolean(LY,(handle_id),(249),(true))
call SetUnitAnimationByIndex(IYO,3)
call P43(GetTriggerUnit())
elseif GetSpellAbilityId()=='A2LK' then
if IssueImmediateOrder(hero,"charm")then
call UnitRemoveAbility(IYO,'A2LK')
endif
endif
elseif QNI(x1,y1,x2,y2)<100 then
call P63(hero,IYO,dummy,(LoadInteger(LY,(handle_id),(344))),(LoadInteger(LY,(handle_id),(345))))
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1A8' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1A8',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2NI',false)
elseif GetTriggerEvalCount(t)>400 or(LoadBoolean(LY,(handle_id),(249)))==true then
call AddSkill(IYO,'Aloc')
if GetTriggerEvalCount(t)==401 and(LoadBoolean(LY,(handle_id),(249)))==false then
call IssueImmediateOrder(IYO,"stop")
call SetUnitAnimationByIndex(IYO,3)
endif
set g=NTI()
set EGI=level
set EHI=(LoadInteger(LY,(handle_id),(344)))
set EZI=(LoadInteger(LY,(handle_id),(345)))
set EFI=30+30*level
set EEI=hero
set GK=hero
set EDI=PR2
call GroupEnumUnitsInRange(g,GetUnitX(IYO),GetUnitY(IYO),300,Condition(function CA1))
call ForGroup(g,function PA3)
call NSI(g)
set g=null
call SaveInteger(LY,(handle_id),(344),(EHI))
call SaveInteger(LY,(handle_id),(345),(EZI))
if((LoadInteger(LY,(GetHandleId((hero))),((4269))))==1)==false then
set a=Atan2(y1-y2,x1-x2)
call SetUnitFacing(IYO,a*bj_RADTODEG)
set x3=GetUnitX(IYO)+12*Cos(a)
set y3=GetUnitY(IYO)+12*Sin(a)
call MUSetUnitX(IYO,PTI(x3))
call MUSetUnitY(IYO,PUI(y3))
call SaveReal(LY,(handle_id),(282),((x1)*1.0))
call SaveReal(LY,(handle_id),(283),((y1)*1.0))
endif
else
call SetUnitMoveSpeed(IYO,GetUnitMoveSpeed(hero))
call UnitRemoveAbility(IYO,'Aloc')
set g=NTI()
set EGI=level
set EHI=(LoadInteger(LY,(handle_id),(344)))
set EZI=(LoadInteger(LY,(handle_id),(345)))
set EFI=30+30*level
set EEI=hero
set GK=hero
set EDI=PR2
call GroupEnumUnitsInRange(g,GetUnitX(IYO),GetUnitY(IYO),300,Condition(function CA1))
call ForGroup(g,function PA3)
call NSI(g)
set g=null
call SaveInteger(LY,(handle_id),(344),(EHI))
call SaveInteger(LY,(handle_id),(345),(EZI))
if x0!=x1 or y0!=y1 then
set QI3=GW1
call SaveReal(LY,(handle_id),(342),((QI3)*1.0))
endif
if((LoadInteger(LY,(GetHandleId((hero))),((4269))))==1)==false then
if QI3==GW1 then
set x3=PB3(x0,y0,x1,y1,x2,y2)
set y3=PU3(x0,y0,x1,y1,x2,y2)
set a=Atan2(y3-y2,x3-x2)*bj_RADTODEG
call SaveReal(LY,(handle_id),(282),((x1)*1.0))
call SaveReal(LY,(handle_id),(283),((y1)*1.0))
endif
if(QI3+0.3)<GW1 then
call SaveInteger(LY,(handle_id),(343),(1))
elseif(QI3+0.3)>GW1 and(LoadInteger(LY,(handle_id),(343)))==1 then
call SaveInteger(LY,(handle_id),(343),(2))
elseif(LoadInteger(LY,(handle_id),(343)))==3 then
call SaveInteger(LY,(handle_id),(343),(1))
endif
else
call SaveInteger(LY,(handle_id),(343),(3))
endif
endif
set t=null
set hero=null
set IYO=null
set PR2=null
set dummy=null
return false
endfunction
function Q13 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x0=GetUnitX(hero)
local real y0=GetUnitY(hero)
local location point=GetSpellTargetLoc()
local real lx=GetLocationX(point)
local real ly=GetLocationY(point)
local real a=Atan2(ly-y0,lx-x0)
local real d=QDI(QNI(x0,y0,lx,ly),300)
local real x1=PTI(x0+d*Cos(a))
local real y1=PUI(y0+d*Sin(a))
local unit IYO=CreateUnit(GetOwningPlayer(hero),'h07U',x1,y1,(a*bj_RADTODEG)-180)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o02D',x1,y1,(a*bj_RADTODEG)-180)
call SetUnitMoveSpeed(IYO,GetUnitMoveSpeed(hero))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",IYO,"chest"))
if GetUnitAbilityLevel(hero,'A1CD')>0 then
call AddSkill(IYO,'A1CQ')
endif
if GetUnitAbilityLevel(hero,'A1AA')==0 then
call UnitRemoveAbility(IYO,'A2LK')
endif
call UnitAddAbility(hero,'A2NI')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1A8',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2NI',true)
call RemoveLocation(point)
set EVI[GetPlayerId(GetOwningPlayer(hero))]=IYO
call SaveInteger(LY,(GetHandleId((hero))),((4270)),(1))
call AddSkill(IYO,'Avul')
call AddSkill(IYO,'Aetl')
if(LoadBoolean(LY,(GetHandleId(hero)),(339)))==true then
call TriggerEvaluate((LoadTriggerHandle(LY,(handle_id),(338))))
endif
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,IYO,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Q03))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(335),(IYO))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(282),((x0)*1.0))
call SaveReal(LY,(handle_id),(283),((y0)*1.0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveInteger(LY,(handle_id),(343),(2))
call SaveReal(LY,(handle_id),(342),(((TimerGetElapsed(M))-5)*1.0))
call SaveBoolean(LY,(handle_id),(249),(false))
set t=null
set hero=null
set IYO=null
set dummy=null
endfunction
function QO3 takes nothing returns boolean
if GetSpellAbilityId()=='A1A8' then
call Q13()
endif
return false
endfunction
function TP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QO3))
call Q1I('A1G9')
set t=null
endfunction
function Q23 takes nothing returns nothing
local unit target=GetOrderTargetUnit()
local real x
local real y
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER then
set x=GetUnitX(GetOrderTargetUnit())
set y=GetUnitY(GetOrderTargetUnit())
else
set x=GetOrderPointX()
set y=GetOrderPointY()
endif
if QNI(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),x,y)<700 then
call IO1(ZE,x,y)
endif
endfunction
function Q33 takes nothing returns boolean
if GetIssuedOrderId()==852040 then
call Q23()
endif
return false
endfunction
function Q43 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(t,GetOwningPlayer(GetTriggerUnit()),EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER,Condition(function ULI))
call TriggerRegisterPlayerUnitEvent(t,GetOwningPlayer(GetTriggerUnit()),EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER,Condition(function ULI))
call TriggerAddCondition(t,Condition(function Q33))
set t=null
endfunction
function Q53 takes nothing returns boolean
if GetLearnedSkill()=='A06B' and GetUnitAbilityLevel(GetTriggerUnit(),'A06B')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call Q43()
endif
return false
endfunction
function JC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function Q53))
set t=null
endfunction
function Q63 takes nothing returns boolean
return(GetLearnedSkill()=='A0AK' or GetLearnedSkill()=='A1FY')and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function Q73 takes nothing returns nothing
if(GetUnitAbilityLevel(GetTriggerUnit(),'A0AK')==1 or GetUnitAbilityLevel(GetTriggerUnit(),'A1FY')==1)then
call AddSkill(GetTriggerUnit(),'A1WF')
endif
endfunction
function J91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function Q63))
call TriggerAddAction(t,function Q73)
endfunction
function Q83 takes nothing returns boolean
if(GetSpellAbilityId()=='A0AM' or GetSpellAbilityId()=='A0A3' or GetSpellAbilityId()=='A0A4' or GetSpellAbilityId()=='A02T' or GetSpellAbilityId()=='A1FZ' or GetSpellAbilityId()=='A1WF')then
return true
elseif GetSpellAbilityId()=='A0AK' or GetSpellAbilityId()=='A1FY' then
if GetUnitAbilityLevel(GetTriggerUnit(),'A1WF')==0 then
call AddSkill(GetTriggerUnit(),'A1WF')
endif
endif
return false
endfunction
function Q93 takes nothing returns boolean
if(IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))==true)then
if(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false)then
if(GetUnitAbilityLevelSwapped('A04R',GetFilterUnit())==0)then
return true
endif
endif
endif
return false
endfunction
function QA3 takes nothing returns nothing
call IssueImmediateOrder(GetEnumUnit(),"locustswarm")
endfunction
function QB3 takes nothing returns nothing
call UnitDamageTargetBJ(GetTriggerUnit(),GetEnumUnit(),300.00,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_FIRE)
endfunction
function QC3 takes nothing returns nothing
call UnitDamageTargetBJ(GetTriggerUnit(),GetEnumUnit(),450.00,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_FIRE)
endfunction
function QD3 takes nothing returns nothing
call UnitDamageTargetBJ(GetTriggerUnit(),GetEnumUnit(),600.00,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_FIRE)
endfunction
function QE3 takes nothing returns nothing
call UnitDamageTargetBJ(GetTriggerUnit(),GetEnumUnit(),750.00,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_FIRE)
endfunction
function QF3 takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())==EKI and GetUnitTypeId(GetFilterUnit())==EJI and IsUnitDead(GetFilterUnit())==false
endfunction
function QG3 takes player p,integer RII,real x,real y returns nothing
local group g=NTI()
set EKI=p
set EJI=RII
call GroupEnumUnitsInRange(g,x,y,716,Condition(function QF3))
call ForGroup(g,function QA3)
call NSI(g)
set g=null
endfunction
function QH3 takes nothing returns nothing
local real x=GetUnitX(GetTriggerUnit())
local real y=GetUnitY(GetTriggerUnit())
local group Z51
call DisableTrigger(EYI)
set VN=true
if(GetSpellAbilityId()=='A0AM')then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
call I41(GetOwningPlayer(GetTriggerUnit()),3,x,y,500)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QB3)
call RemoveUnit(GetTriggerUnit())
call NSI(Z51)
endif
if(GetSpellAbilityId()=='A0A3')then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
call I41(GetOwningPlayer(GetTriggerUnit()),3,x,y,500)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QC3)
call RemoveUnit(GetTriggerUnit())
call NSI(Z51)
endif
if(GetSpellAbilityId()=='A0A4')then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
call I41(GetOwningPlayer(GetTriggerUnit()),3,x,y,500)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QD3)
call RemoveUnit(GetTriggerUnit())
call NSI(Z51)
endif
if(GetSpellAbilityId()=='A1FZ')then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
call I41(GetOwningPlayer(GetTriggerUnit()),3,x,y,500)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QE3)
call RemoveUnit(GetTriggerUnit())
call NSI(Z51)
endif
if(GetSpellAbilityId()=='A02T')then
set Z51=NTI()
set bj_groupEnumTypeId='o018'
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(GetTriggerUnit()),filterGetUnitsOfPlayerAndTypeId)
call ForGroup(Z51,function QA3)
call NSI(Z51)
set Z51=NTI()
set bj_groupEnumTypeId='o002'
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(GetTriggerUnit()),filterGetUnitsOfPlayerAndTypeId)
call ForGroup(Z51,function QA3)
call NSI(Z51)
set Z51=NTI()
set bj_groupEnumTypeId='o00B'
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(GetTriggerUnit()),filterGetUnitsOfPlayerAndTypeId)
call ForGroup(Z51,function QA3)
call NSI(Z51)
set Z51=NTI()
set bj_groupEnumTypeId='o01B'
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(GetTriggerUnit()),filterGetUnitsOfPlayerAndTypeId)
call ForGroup(Z51,function QA3)
call NSI(Z51)
endif
if(GetSpellAbilityId()=='A1WF')then
set x=GetSpellTargetX()
set y=GetSpellTargetY()
call QG3(GetOwningPlayer(GetTriggerUnit()),'o018',x,y)
call QG3(GetOwningPlayer(GetTriggerUnit()),'o002',x,y)
call QG3(GetOwningPlayer(GetTriggerUnit()),'o00B',x,y)
call QG3(GetOwningPlayer(GetTriggerUnit()),'o01B',x,y)
endif
set VN=false
call EnableTrigger(EYI)
endfunction
function QZ3 takes nothing returns nothing
local integer id=GetUnitTypeId(GetTriggerUnit())
local real x=GetUnitX(GetTriggerUnit())
local real y=GetUnitY(GetTriggerUnit())
local group Z51
if id=='o018' then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QB3)
call NSI(Z51)
endif
if id=='o002' then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QC3)
call NSI(Z51)
endif
if id=='o00B' then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QD3)
call NSI(Z51)
endif
if id=='o01B' then
call U7I("Abilities\\Spells\\Human\\FlameStrike\\FlameStrike1.mdl",x,y,5)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,450,Condition(function Q93))
call ForGroup(Z51,function QE3)
call NSI(Z51)
endif
endfunction
function QV3 takes nothing returns boolean
local integer id=GetUnitTypeId(GetTriggerUnit())
if id=='o018' or id=='o002' or id=='o00B' or id=='o01B' then
call QZ3()
endif
return false
endfunction
function JA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddAction(t,function QH3)
call TriggerAddCondition(t,Condition(function Q83))
call AM1("Units\\Creeps\\GoblinSapper\\GoblinSapperYesAttack1.wav")
set EYI=CreateTrigger()
call UMI(EYI,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(EYI,Condition(function QV3))
endfunction
function QW3 takes nothing returns nothing
local real QWI=QLI(EMI,GetEnumUnit())
local real PAI=ENI
local real QX3=225
if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==true then
set QX3=440
endif
if QWI>QX3 then
set PAI=PAI/2
endif
call Damage(EMI,GetEnumUnit(),2,PAI)
endfunction
function QY3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit QJ3=(LoadUnitHandle(LY,(handle_id),(347)))
local group g=NTI()
local integer level=(LoadInteger(LY,(handle_id),(5)))
set GK=QJ3
set EMI=QJ3
set ENI=225+75*level
call GroupEnumUnitsInRange(g,GetUnitX(QJ3),GetUnitY(QJ3),500+25,Condition(function CV1))
call ForGroup(g,function QW3)
call NSI(g)
set t=null
set QJ3=null
set g=null
return false
endfunction
function QK3 takes nothing returns boolean
if GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>0.5 and(GetUnitTypeId(GetFilterUnit())=='n00O' or GetUnitTypeId(GetFilterUnit())=='n00P' or GetUnitTypeId(GetFilterUnit())=='n00Q' or GetUnitTypeId(GetFilterUnit())=='n00N')then
set ELI=ELI+1
endif
return false
endfunction
function QL3 takes nothing returns boolean
local group g=NTI()
set ELI=0
call GroupEnumUnitsOfPlayer(g,GetTriggerPlayer(),Condition(function QK3))
if ELI>0 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"埋雷数"+": "+I2S(ELI))
endif
call NSI(g)
set g=null
return false
endfunction
function QM3 takes nothing returns boolean
if((GetUnitTypeId(GetTriggerUnit())=='n00O'))then
return true
endif
if((GetUnitTypeId(GetTriggerUnit())=='n00P'))then
return true
endif
if((GetUnitTypeId(GetTriggerUnit())=='n00Q'))then
return true
endif
if((GetUnitTypeId(GetTriggerUnit())=='n00N'))then
return true
endif
if GetUnitTypeId(GetTriggerUnit())=='o018' or GetUnitTypeId(GetTriggerUnit())=='o002' or GetUnitTypeId(GetTriggerUnit())=='o00B' or GetUnitTypeId(GetTriggerUnit())=='o01B' then
if RW0[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]then
endif
endif
return false
endfunction
function QN3 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GetTriggerUnit())then
if((GetUnitTypeId(GetFilterUnit())=='n00O'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n00P'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n00Q'))then
return true
endif
if((GetUnitTypeId(GetFilterUnit())=='n00N'))then
return true
endif
endif
return false
endfunction
function QS3 takes nothing returns boolean
return(GetUnitTypeId(GetFilterUnit())=='H00E' or GetUnitTypeId(GetFilterUnit())=='H00G' or GetUnitTypeId(GetFilterUnit())=='H00F' or GetUnitTypeId(GetFilterUnit())=='E00P' or GetUnitTypeId(GetFilterUnit())=='N00B' or GetUnitTypeId(GetFilterUnit())=='UC60' or GetUnitTypeId(GetFilterUnit())=='EC77' or GetUnitTypeId(GetFilterUnit())=='U00P' or GetUnitTypeId(GetFilterUnit())=='E02N' or GetUnitTypeId(GetFilterUnit())=='E02O' or GetUnitTypeId(GetFilterUnit())=='O016' or GetUnitTypeId(GetFilterUnit())=='O017' or GetUnitTypeId(GetFilterUnit())=='E02F' or GetUnitTypeId(GetFilterUnit())=='H0DO' or GetUnitTypeId(GetFilterUnit())=='N0M7' or GetUnitTypeId(GetFilterUnit())=='N0MB' or GetUnitTypeId(GetFilterUnit())=='N0MC' or GetUnitTypeId(GetFilterUnit())=='N0MO' or GetUnitTypeId(GetFilterUnit())=='N0MA' or GetUnitTypeId(GetFilterUnit())=='N0MW')and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GK))
endfunction
function QT3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit QJ3=(LoadUnitHandle(LY,(handle_id),(347)))
local group g
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyEffect(AddSpecialEffect("war3mapImported\\NewGroundEX.mdx",GetUnitX(QJ3),GetUnitY(QJ3)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=QJ3
call GroupEnumUnitsInRange(g,GetUnitX(QJ3),GetUnitY(QJ3),200,Condition(function QS3))
if FirstOfGroup(g)!=null then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitExploded(QJ3,true)
call KillUnit(QJ3)
endif
call NSI(g)
endif
set t=null
set QJ3=null
set g=null
return false
endfunction
function QR3 takes nothing returns nothing
local integer handle_id=GetHandleId(GetOwningPlayer(GetTriggerUnit()))
local group Z51=NTI()
local integer QP3=(LoadInteger(LY,(handle_id),(346)))
local integer QQ3=0
local unit QU3
local integer UI3
local unit WH1
local integer U13
local integer TGI
local integer THI
local trigger t=CreateTrigger()
local unit SFI=K1[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]
local integer level=GetUnitAbilityLevel(SFI,'A05J')
call GroupEnumUnitsInRect(Z51,bj_mapInitialPlayableArea,Condition(function QN3))
call TriggerRegisterTimerEvent(t,0.4,true)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function QT3))
call SaveUnitHandle(LY,(GetHandleId(t)),(347),(GetTriggerUnit()))
set QP3=(QP3+1)
call StartTimerBJ((LoadTimerHandle(LY,(handle_id),(1500+QP3))),false,15000.00)
call SaveUnitHandle(LY,(handle_id),(1600+QP3),(GetTriggerUnit()))
set QQ3=CountUnitsInGroup(Z51)
if(QQ3>20)then
set UI3=99999
set TGI=1
set THI=QP3
loop
exitwhen TGI>THI
set WH1=(LoadUnitHandle(LY,(handle_id),(1600+TGI)))
set U13=R2I(TimerGetRemaining((LoadTimerHandle(LY,(handle_id),(1500+TGI)))))
if(GetUnitState(WH1,UNIT_STATE_LIFE)>0 and U13<UI3)then
set QU3=WH1
set UI3=U13
endif
set TGI=TGI+1
endloop
call ExplodeUnitBJ(QU3)
endif
call SaveInteger(LY,(handle_id),(346),(QP3))
call NSI(Z51)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function QY3))
call SaveUnitHandle(LY,(handle_id),(347),(GetTriggerUnit()))
call SaveInteger(LY,(handle_id),(5),(level))
endfunction
function JB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function QL3))
set t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,GetWorldBounds())
call TriggerAddCondition(t,Condition(function QM3))
call TriggerAddAction(t,function QR3)
set t=null
endfunction
function UO3 takes nothing returns nothing
local real QWI=QLI(ESI,GetEnumUnit())
local real PAI=ETI
if QWI>225 then
set PAI=ERI
endif
call Damage(ESI,GetEnumUnit(),2,PAI)
endfunction
function U23 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A06B')
local real U33
local real U43
local group g=NTI()
if level==1 then
set U33=500
set U43=260
elseif level==2 then
set U33=650
set U43=300
elseif level==3 then
set U33=850
set U43=340
elseif level==4 then
set U33=1150
set U43=380
endif
set ETI=U33
set ERI=U43
set GK=hero
set ESI=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),525,Condition(function CA1))
call ForGroup(g,function UO3)
call NSI(g)
set g=null
set hero=null
endfunction
function U53 takes nothing returns boolean
if GetSpellAbilityId()=='A06B' then
call U23()
endif
return false
endfunction
function JD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U53))
set t=null
endfunction
function U63 takes nothing returns boolean
return GetSpellAbilityId()=='A065'
endfunction
function U73 takes nothing returns nothing
local integer i=0
local unit SFI=GetTriggerUnit()
local item HLO
local integer E81
loop
exitwhen i>5
set HLO=UnitItemInSlot(SFI,i)
set E81=F01(HLO)
if E81==GK0 then
call MUDisableItemTrigger()
set JK=GetItemPlayer(HLO)
call RemoveItem(HLO)
set VK=FD1(SFI,FR0[GJ0],i)
call SetItemPlayer(VK,JK,false)
call SetItemUserData(VK,1)
call MUEnableItemTrigger()
endif
set i=i+1
endloop
set SFI=null
set HLO=null
endfunction
function U83 takes nothing returns nothing
local integer TGI=0
local integer THI=5
local integer array U93
local player array UA3
local integer E81
local item FH1
call SaveReal(LY,(GetHandleId(GetTriggerUnit())),(785),((0)*1.0))
call U73()
set U93[0]=0
set U93[1]=0
set U93[2]=0
set U93[3]=0
set U93[4]=0
set U93[5]=0
call MUDisableItemTrigger()
loop
exitwhen TGI>THI
set E81=F01(UnitItemInSlot(GetTriggerUnit(),TGI))
if E81==VZ0 or E81==VV0 or E81==VW0 or E81==VX0 or E81==VY0 or E81==VJ0 or E81==V80 or E81==W00 or E81==WI0 or E81==W10 or E81==ZS0 or E81==WH0 or E81==WX0 or E81==X90 then
set U93[TGI]=GetItemTypeId(UnitItemInSlot(GetTriggerUnit(),TGI))
set UA3[TGI]=GetItemPlayer(UnitItemInSlot(GetTriggerUnit(),TGI))
call RemoveItem(UnitItemInSlot(GetTriggerUnit(),TGI))
endif
set TGI=TGI+1
endloop
call UnitResetCooldown(GetTriggerUnit())
set TGI=0
set THI=5
loop
exitwhen TGI>THI
if U93[TGI]>0 then
set FH1=CreateItem(U93[TGI],0,0)
call SetItemPlayer(FH1,UA3[TGI],false)
call SetItemUserData(FH1,1)
call UnitAddItem(GetTriggerUnit(),FH1)
endif
set TGI=TGI+1
endloop
call MUEnableItemTrigger()
set FH1=null
endfunction
function JH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_FINISH)
call TriggerAddCondition(t,Condition(function U63))
call TriggerAddAction(t,function U83)
endfunction
function UB3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local integer i=0
local real a=0
local real r=0
local integer level=GetUnitAbilityLevel(SFI,'A0BQ')
call AddSkill(dummy,'A05F')
call SetUnitAbilityLevel(dummy,'A05F',level)
loop
exitwhen i>40
exitwhen IssuePointOrder(dummy,"stampede",x+r*Cos(a),y+r*Sin(a))
set i=i+1
set a=a+0.4
set r=r+10
endloop
call RemoveLocation(point)
set SFI=null
set dummy=null
set point=null
endfunction
function UC3 takes nothing returns boolean
if GetSpellAbilityId()=='A0BQ' then
call UB3()
endif
return false
endfunction
function JF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UC3))
set t=null
endfunction
function UD3 takes nothing returns boolean
return(GetSpellAbilityId()=='A049' or GetSpellAbilityId()=='A2WB')and CanResistSkill(GetSpellTargetUnit())==false
endfunction
function UE3 takes nothing returns nothing
call UnitDamageTarget(GetTriggerUnit(),GetSpellTargetUnit(),GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId())*80,true,false,ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
endfunction
function JG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UD3))
call TriggerAddAction(t,function UE3)
endfunction
function UF3 takes nothing returns boolean
return(RKI(GetFilterUnit())==false and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsHeroUnitId(GetUnitTypeId(GetFilterUnit()))
endfunction
function UG3 takes nothing returns nothing
local unit hero=GK
local unit target=HK
local integer level=GetUnitAbilityLevel(hero,'A05E')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2WA')
endif
call Damage(hero,target,1,50+75*level)
set hero=null
set target=null
endfunction
function UH3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=null
local group g=NTI()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local integer NPI=2
if GetUnitAbilityLevel(hero,'A05E')==0 then
set NPI=4
endif
set GK=hero
call GroupEnumUnitsInRange(g,x,y,2500+25,Condition(function UF3))
loop
exitwhen FirstOfGroup(g)==null or NPI==0
set target=AU1(g,x,y)
set NPI=NPI-1
call GroupRemoveUnit(g,target)
call IJ1(hero,target,'h0ET',"UG3",1000,false)
endloop
call NSI(g)
set g=null
set target=null
set hero=null
endfunction
function UZ3 takes nothing returns boolean
if GetSpellAbilityId()=='A05E' or GetSpellAbilityId()=='A2WA' then
call UH3()
endif
return false
endfunction
function JE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UZ3))
set t=null
endfunction
function UV3 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==true then
call Damage(EPI,GetEnumUnit(),1,EQI/3)
else
call Damage(EPI,GetEnumUnit(),1,EQI)
endif
endfunction
function UW3 takes unit hero,real x,real y,real r,real d returns nothing
local group g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,x,y,r,Condition(function CZ1))
set EPI=hero
set EQI=d
call ForGroup(g,function UV3)
call NSI(g)
set g=null
endfunction
function UX3 takes nothing returns boolean
if((GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit())))and RYI(GetFilterUnit())==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))then
return true
endif
return false
endfunction
function UY3 takes unit SFI returns unit
local unit hero=null
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),275,Condition(function UX3))
call GroupRemoveUnit(g,SFI)
set hero=GroupPickRandomUnit(g)
call NSI(g)
set GK=hero
set hero=null
set g=null
return GK
endfunction
function UJ3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x0=(LoadReal(LY,(handle_id),(282)))
local real y0=(LoadReal(LY,(handle_id),(283)))
local real x1=GetUnitX(hero)
local real y1=GetUnitY(hero)
local real x2=0
local real y2=0
local real RM2
local real RN2
local real RS2
local real RT2
local real IV1
local real IW1
local location point
if target!=null then
set x2=GetUnitX(target)
set y2=GetUnitY(target)
endif
if target==null or QNI(x0,y0,x2,y2)>1000 then
set x2=x0
set y2=y0
endif
set RM2=UEI(x1,y1,x2,y2)
set RN2=QNI(x1,y1,x2,y2)
set RS2=RN2/IMaxBJ((65-NPI),1)
set RT2=(NPI-33)*(NPI-33)
set IV1=x1+RS2*Cos(RM2*bj_DEGTORAD)
set IW1=y1+RS2*Sin(RM2*bj_DEGTORAD)
if NPI<65 then
if RNI(hero)==false then
call SetUnitFlyHeight(hero,775-RT2,0)
endif
call SetUnitPosition(hero,IV1,IW1)
else
if RNI(hero)==false then
call SetUnitFlyHeight(hero,GetUnitDefaultFlyHeight(hero),0)
endif
call PauseUnit(hero,false)
call SetUnitPathing(hero,true)
call SetUnitPosition(hero,x2,y2)
call SaveInteger(LY,(GetHandleId((hero))),((4268)),(2))
set point=Location(x2,y2)
call TerrainDeformationRippleBJ(0.2,true,point,1.00,300.00,96.00,1,64.00)
call RemoveLocation(point)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl",GetUnitX(hero),GetUnitY(hero)))
if IsUnitAlly(hero,GetOwningPlayer(SFI))then
else
if(ES1((SFI),FR0[KJ0])!=null)then
call Damage(SFI,hero,1,(0.2+0.15*(GetUnitAbilityLevel(SFI,'A0CY')+1))*75*GetUnitAbilityLevel(SFI,'A0BZ'))
else
call Damage(SFI,hero,1,(0.2+0.15*GetUnitAbilityLevel(SFI,'A0CY'))*75*GetUnitAbilityLevel(SFI,'A0BZ'))
endif
endif
call UPI(x2,y2,300)
call UW3(SFI,x2,y2,300,75*GetUnitAbilityLevel(SFI,'A0BZ'))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
set hero=null
set target=null
set point=null
return false
endfunction
function UK3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit hero=EUI
local unit target
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x
local real y
call SetUnitAnimationByIndex(SFI,4)
call PauseUnit(hero,true)
call SetUnitPathing(hero,false)
if RNI(hero)==false then
call AddSkill(hero,'Amrf')
call UnitRemoveAbility(hero,'Amrf')
endif
call SaveInteger(LY,(GetHandleId((hero))),((4268)),(1))
if GetSpellTargetItem()==null then
set target=GetSpellTargetUnit()
set x=GetUnitX(target)
set y=GetUnitY(target)
else
set x=GetItemX(GetSpellTargetItem())
set y=GetItemY(GetSpellTargetItem())
set target=null
endif
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",hero,"origin")))
call SaveReal(LY,(handle_id),(282),((x)*1.0))
call SaveReal(LY,(handle_id),(283),((y)*1.0))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function UJ3))
set SFI=null
set hero=null
set target=null
set t=null
endfunction
function UL3 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit hero=UY3(SFI)
local unit target=GetSpellTargetUnit()
if GetSpellTargetItem()!=null and C8O(GetItemTypeId(GetSpellTargetItem()))==false then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"必须以神符为目标")
endif
set EUI=hero
if hero==null then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"没有可以投掷的单位")
elseif GetOwningPlayer(target)==GetOwningPlayer(SFI)then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"不能投掷你自己的单位")
endif
set SFI=null
set hero=null
set target=null
endfunction
function UM3 takes nothing returns boolean
if GetSpellAbilityId()=='A0BZ' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call UL3()
else
call UK3()
endif
endif
return false
endfunction
function JW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UM3))
set t=null
endfunction
function UN3 takes nothing returns nothing
local unit hero=GetTriggerUnit()
call BI1('A2KK')
endfunction
function US3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer UT3=(LoadInteger(LY,(handle_id),(375)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and GetEventDamage()>20 then
set NPI=(LoadInteger(LY,(GetHandleId(hero)),(674)))
if((LoadInteger(LY,(GetHandleId((hero))),((4297))))==1)==false then
call SCI(hero,4297,0.1)
call SaveInteger(LY,(GetHandleId(hero)),(674),(NPI+1))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function UR3 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local trigger t2
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(GetHandleId(hero)),(674)))
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and NPI<6 then
if GetAttacker()==hero and((LoadInteger(LY,(GetHandleId((hero))),((4297))))==1)==false then
set t2=CreateTrigger()
call TriggerRegisterUnitEvent(t2,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t2,1,false)
call TriggerAddCondition(t2,Condition(function US3))
call SaveUnitHandle(LY,(GetHandleId(t2)),(2),(hero))
endif
endif
if NPI>5 then
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(674),(0))
call UnitRemoveAbility(hero,'A1W1')
if(LoadInteger(LY,(handle_id),(34)))==1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_ATTACKED then
call SaveInteger(LY,(handle_id),(34),(1))
if NPI>5 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call UnitRemoveAbility(hero,'A1VG')
if(ES1((hero),FR0[KJ0])!=null)then
call AddSkill(hero,'A1VH')
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1VH',true)
endif
set t=null
set hero=null
return false
endfunction
function WarClub_Animation takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEvalCount(t)==1 then
call SetUnitTimeScalePercent(hero,250)
else
call SetUnitTimeScalePercent(hero,100)
call SetUnitAnimationByIndex(hero,12)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function UP3 takes nothing returns boolean
local trigger t
if GetSpellAbilityId()=='A1VH' then
call SCI(GetTriggerUnit(),4296,29.9)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1VH',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1VG',true)
call AddSkill(GetTriggerUnit(),'A1VG')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1W1',false)
call AddSkill(GetTriggerUnit(),'A1W1')
call IssueTargetOrder(GetTriggerUnit(),"grabtree",GetSpellTargetDestructable())
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,30,false)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function UR3))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(GetTriggerUnit()))
call SaveInteger(LY,(GetHandleId(t)),(34),(0))
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(674),(0))
set t=null
elseif GetSpellAbilityId()=='A2KA' then
call RemoveDestructable(GetSpellTargetDestructable())
call ShowUnit(GetTriggerUnit(),false)
call ShowUnit(GetTriggerUnit(),true)
call UnitRemoveAbility(GetTriggerUnit(),'Aloc')
call UnitAddAbility(GetTriggerUnit(),'A2KB')
call UnitRemoveAbility(GetTriggerUnit(),'A2KB')
call UnitAddAbility(GetTriggerUnit(),'A2KC')
call UnitRemoveAbility(GetTriggerUnit(),'A2KC')
call AddUnitAnimationProperties(GetTriggerUnit(),"upgrade",false)
endif
return false
endfunction
function WarClub_Scan takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if(ES1((hero),FR0[KJ0])!=null)then
if((LoadInteger(LY,(GetHandleId((hero))),((4296))))==1)==false then
if GetUnitAbilityLevel(hero,'A1VH')==0 and GetUnitAbilityLevel(hero,'A1VG')==0 then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1VH',true)
call AddSkill(hero,'A1VH')
endif
endif
else
call UnitRemoveAbility(hero,'A1VH')
call UnitRemoveAbility(hero,'A1VG')
endif
set t=null
return false
endfunction
function GX2 takes nothing returns nothing
local unit hero=XM
local unit target=YM
local unit dummy=(LoadUnitHandle(LY,(GetHandleId(hero)),(297)))
call SaveUnitHandle(LY,(GetHandleId(target)),(297),(dummy))
call SetUnitOwner(dummy,GetOwningPlayer(target),true)
set hero=null
set target=null
set dummy=null
endfunction
function AVO takes nothing returns nothing
local unit SFI=NK
local unit dummy=(LoadUnitHandle(LY,(GetHandleId(SFI)),(297)))
if dummy!=null and GetUnitTypeId(dummy)=='e01V' then
call RemoveUnit(dummy)
endif
endfunction
function UQ3 takes nothing returns boolean
return GetLearnedSkill()=='A0CY' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function UU3 takes nothing returns nothing
local unit I04=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(298)))
local integer level=GetUnitAbilityLevel(I04,'A0CY')
if GetUnitState(I04,UNIT_STATE_LIFE)>1 then
call SetUnitScale(I04,0.5+0.25*level,0.5+0.25*level,0.5+0.25*level)
endif
endfunction
function II4 takes nothing returns boolean
local integer level
if IsUnitIllusion(GetTriggerUnit())and(GetUnitTypeId(GetTriggerUnit())=='Ucrl' or GetUnitTypeId(GetTriggerUnit())=='U01X')then
set level=GetUnitAbilityLevel((LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(298))),'A0CY')
call SetUnitScale(GetTriggerUnit(),0.5+0.25*level,0.5+0.25*level,0.5+0.25*level)
endif
return false
endfunction
function I14 takes nothing returns nothing
local trigger t
local unit I04=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(I04,'A0CY')
local unit dummy
local unit SFI=GetTriggerUnit()
local region S5O
if level==1 then
set dummy=CreateUnit(GetOwningPlayer(SFI),'e01V',0,0,0)
call AddSkill(dummy,'A10B')
call SaveUnitHandle(LY,(GetHandleId(SFI)),(297),(dummy))
else
set dummy=(LoadUnitHandle(LY,(GetHandleId(SFI)),(297)))
endif
if level==2 then
call UnitRemoveAbility(dummy,'A10B')
call AddSkill(dummy,'A10A')
elseif level==3 then
call UnitRemoveAbility(dummy,'A10B')
call UnitRemoveAbility(dummy,'A10A')
call AddSkill(dummy,'A0ZS')
endif
call SetPlayerTechResearched(GetOwningPlayer(I04),'R00E',level)
if level==1 then
set t=CreateTrigger()
call TriggerAddAction(t,function UU3)
call TriggerRegisterTimerEvent(t,2.00,true)
call SaveUnitHandle(LY,(GetHandleId(t)),(298),(I04))
call SetUnitScale(I04,0.5+0.25*level,0.5+0.25*level,0.5+0.25*level)
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,GetWorldBounds())
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function II4))
call SaveUnitHandle(LY,(GetHandleId(t)),(298),(I04))
set t=null
set S5O=null
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(I04))
call TriggerRegisterTimerEvent(t,0.5,true)
set t=null
endif
set SFI=null
set dummy=null
endfunction
function JZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function UQ3))
call TriggerAddAction(t,function I14)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UP3))
call UN3()
set t=null
endfunction
function IO4 takes nothing returns boolean
local unit hero=GetTriggerUnit()
local unit target=GetAttacker()
local integer level=GetUnitAbilityLevel(hero,'A19Q')
local unit dummy
if GetRandomInt(1,100)<=(5+level*5)and QLI(hero,target)<325 then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A0BV')
call SetUnitAbilityLevel(dummy,'A0BV',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=null
endif
set hero=null
set target=null
return false
endfunction
function I24 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit hero=GetTriggerUnit()
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function IO4))
set t=null
set hero=null
endfunction
function I34 takes nothing returns boolean
if GetLearnedSkill()=='A19Q' and GetUnitAbilityLevel(GetTriggerUnit(),'A19Q')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call I24()
endif
return false
endfunction
function JX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function I34))
set t=null
endfunction
function I44 takes nothing returns boolean
if((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4268))))==1)and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(F0I))==true then
call Damage(F0I,GetFilterUnit(),1,FII)
endif
return false
endfunction
function I54 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',x,y,0)
local integer level=GetUnitAbilityLevel(SFI,'A0LL')
local group g=NTI()
call AddSkill(dummy,'A10J')
call SetUnitAbilityLevel(dummy,'A10J',level)
set F0I=SFI
if level==1 then
set FII=25
elseif level==2 then
set FII=45
elseif level==3 then
set FII=65
elseif level==4 then
set FII=75
endif
call GroupEnumUnitsInRange(g,x,y,275+24,Condition(function I44))
call NSI(g)
if GetTriggerEvalCount(t)>6 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
set dummy=null
set g=null
return false
endfunction
function I64 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local location point=GetSpellTargetLoc()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
local integer level=GetUnitAbilityLevel(SFI,'A0LL')
call AddSkill(dummy,'A10M')
call SetUnitAbilityLevel(dummy,'A10M',level)
call IssuePointOrder(dummy,"clusterrockets",GetLocationX(point),GetLocationY(point))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function I54))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((GetLocationX(point))*1.0))
call SaveReal(LY,(handle_id),(7),((GetLocationY(point))*1.0))
call TriggerEvaluate(t)
call RemoveLocation(point)
set SFI=null
set point=null
set t=null
set dummy=null
endfunction
function I74 takes nothing returns boolean
if GetSpellAbilityId()=='A0LL' then
call I64()
endif
return false
endfunction
function JV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function I74))
set t=null
endfunction
function I84 takes nothing returns nothing
if GetEnumUnit()==GetTriggerUnit()then
call AX1(GetEnumUnit(),'A0XE',FOI,F1I,'B00B')
else
call AX1(GetEnumUnit(),'A0XE',FOI,F1I,'B00B')
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A0XE',false)
endfunction
function I94 takes nothing returns nothing
local group g=NTI()
set FOI=GetUnitAbilityLevel(GetTriggerUnit(),'A1EJ')
set F1I=7
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function CQ1))
call ForGroup(g,function I84)
call NSI(g)
set g=null
endfunction
function IA4 takes nothing returns boolean
if GetSpellAbilityId()=='A1EJ' then
call I94()
endif
return false
endfunction
function KO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IA4))
set t=null
endfunction
function IB4 takes nothing returns boolean
return GetSpellAbilityId()=='A0BE'
endfunction
function IC4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitAbilityLevel(hero,'A09E',GetUnitAbilityLevel(hero,'A0BE'))
call UnitRemoveAbility(hero,'B09Y')
set t=null
set hero=null
return false
endfunction
function ID4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function IC4))
set t=null
set hero=null
endfunction
function JU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_FINISH)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IB4))
call TriggerAddAction(t,function ID4)
endfunction
function IE4 takes nothing returns boolean
return GetLearnedSkill()=='A0BE' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function IF4 takes nothing returns nothing
call SetUnitAbilityLevel(GetTriggerUnit(),'A09E',GetUnitAbilityLevel(GetTriggerUnit(),'A0BE'))
endfunction
function K01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function IE4))
call TriggerAddAction(t,function IF4)
endfunction
constant function BeastRage_AbilityCode takes nothing returns integer
return 'A0O0'
endfunction
constant function BeastRage_EffectCode takes nothing returns integer
return 'A0NZ'
endfunction
function IG4 takes nothing returns boolean
return GetUnitAbilityLevel(GetAttacker(),('A0O0'))>0 and((LoadInteger(LY,(GetHandleId((GetAttacker()))),((4271))))==1)==false
endfunction
function IH4 takes nothing returns nothing
local unit Z4O=GetAttacker()
local unit target=GetTriggerUnit()
local integer handle_id=GetHandleId(Z4O)
local integer IZ4=(LoadInteger(LY,(handle_id),(237)))
local unit IV4=NYI(IZ4)
local integer QX2=QAI((LoadInteger(LY,(handle_id),(236))),0)
local integer level=GetUnitAbilityLevel(Z4O,('A0O0'))
local integer IW4=1
if IV4!=target then
set QX2=1
else
set QX2=Q9I(QX2+1,1+4)
endif
if QX2>1 then
set IW4=QX2+4*(level-1)
endif
call Q6I(Z4O,('A0NZ'),IW4)
call SaveInteger(LY,(handle_id),(236),(QX2))
if IV4!=target then
call NXI(IZ4)
set IZ4=NKI(target)
call SaveInteger(LY,(handle_id),(237),(IZ4))
endif
call SCI(Z4O,4271,0.4)
endfunction
function KI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function IG4))
call TriggerAddAction(t,function IH4)
call Q1I(('A0NZ'))
endfunction
function IX4 takes unit hero,unit target,unit dummy,integer level returns nothing
call SetUnitOwner(dummy,GetOwningPlayer(target),false)
call SetUnitAbilityLevel(dummy,'A21O',level)
call IssueTargetOrder(dummy,"curse",target)
call Damage(hero,target,1,25+50*level)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",target,"overhead"))
endfunction
function IY4 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),F5I)==false then
call GroupAddUnit(F5I,GetEnumUnit())
call IX4(F2I,GetEnumUnit(),F3I,F6I)
endif
endfunction
function IJ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit IK4=(LoadUnitHandle(LY,(handle_id),(675)))
local unit IL4=(LoadUnitHandle(LY,(handle_id),(676)))
local real a=(LoadReal(LY,(handle_id),(13)))
local real d=(LoadReal(LY,(handle_id),(433)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g=NTI()
if GetTriggerEvalCount(t)<=50 then
set a=a+20
set d=d+7
call SaveReal(LY,(handle_id),(13),((a)*1.0))
call SaveReal(LY,(handle_id),(433),((d)*1.0))
elseif GetTriggerEvalCount(t)<=100 then
set a=a+20
set d=d-7
call SaveReal(LY,(handle_id),(13),((a)*1.0))
call SaveReal(LY,(handle_id),(433),((d)*1.0))
endif
call MUSetUnitX(IK4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IK4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set a=a+180
call MUSetUnitX(IL4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IL4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set GK=hero
set F2I=hero
set F3I=dummy
set F5I=PR2
set F6I=level
call GroupEnumUnitsInRange(g,GetUnitX(IK4),GetUnitY(IK4),125,Condition(function CA1))
call ForGroup(g,function IY4)
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(IL4),GetUnitY(IL4),125,Condition(function CA1))
call ForGroup(g,function IY4)
call NSI(g)
if GetTriggerEvalCount(t)>100 then
call KillUnit(IK4)
call KillUnit(IL4)
call KillUnit(dummy)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set IK4=null
set IL4=null
set dummy=null
return false
endfunction
function IM4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit IK4=CreateUnit(GetOwningPlayer(hero),'e02Y',x,y,0)
local unit IL4=CreateUnit(GetOwningPlayer(hero),'e02Y',x,y,0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call UnitAddAbility(dummy,'A21O')
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(675),(IK4))
call SaveUnitHandle(LY,(handle_id),(676),(IL4))
call SaveReal(LY,(handle_id),(13),((0)*1.0))
call SaveReal(LY,(handle_id),(433),((0)*1.0))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(hero,'A21N')))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function IJ4))
set hero=null
set IK4=null
set IL4=null
set t=null
set dummy=null
endfunction
function IN4 takes unit hero,unit target,unit dummy,integer level returns nothing
call SetUnitOwner(dummy,GetOwningPlayer(target),false)
call SetUnitAbilityLevel(dummy,'A21P',level)
call IssueTargetOrder(dummy,"slow",target)
call Damage(hero,target,1,75)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",target,"overhead"))
endfunction
function IS4 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),F5I)==false and F4I!=null and IsUnitDead(F4I)==false then
call GroupAddUnit(F5I,GetEnumUnit())
call IN4(F2I,GetEnumUnit(),F3I,F6I)
endif
endfunction
function IT4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit IK4=(LoadUnitHandle(LY,(handle_id),(393)))
local unit IL4=(LoadUnitHandle(LY,(handle_id),(394)))
local unit IR4=(LoadUnitHandle(LY,(handle_id),(395)))
local unit IP4=(LoadUnitHandle(LY,(handle_id),(396)))
local unit IQ4=(LoadUnitHandle(LY,(handle_id),(397)))
local real a=(LoadReal(LY,(handle_id),(13)))-12.5
local real d=(LoadReal(LY,(handle_id),(433)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit UC2
local group g
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
set d=d+900/20.0
call SaveReal(LY,(handle_id),(433),((d)*1.0))
call MUSetUnitX(IK4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IK4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set a=a+6.25
call MUSetUnitX(IL4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IL4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set a=a+6.25
call MUSetUnitX(IR4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IR4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set a=a+6.25
call MUSetUnitX(IP4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IP4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set a=a+6.25
call MUSetUnitX(IQ4,PTI(x+d*Cos(a*bj_DEGTORAD)))
call MUSetUnitY(IQ4,PUI(y+d*Sin(a*bj_DEGTORAD)))
set F2I=hero
set F3I=dummy
set F5I=PR2
set F6I=level
set UC2=IK4
if UC2!=null and IsUnitDead(UC2)==false then
set x=GetUnitX(UC2)
set y=GetUnitY(UC2)
set F4I=UC2
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,125,Condition(function CA1))
call ForGroup(g,function IS4)
call NSI(g)
endif
set UC2=IL4
if UC2!=null and IsUnitDead(UC2)==false then
set x=GetUnitX(UC2)
set y=GetUnitY(UC2)
set F4I=UC2
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,125,Condition(function CA1))
call ForGroup(g,function IS4)
call NSI(g)
endif
set UC2=IR4
if UC2!=null and IsUnitDead(UC2)==false then
set x=GetUnitX(UC2)
set y=GetUnitY(UC2)
set F4I=UC2
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,125,Condition(function CA1))
call ForGroup(g,function IS4)
call NSI(g)
endif
set UC2=IP4
if UC2!=null and IsUnitDead(UC2)==false then
set x=GetUnitX(UC2)
set y=GetUnitY(UC2)
set F4I=UC2
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,125,Condition(function CA1))
call ForGroup(g,function IS4)
call NSI(g)
endif
set UC2=IQ4
if UC2!=null and IsUnitDead(UC2)==false then
set x=GetUnitX(UC2)
set y=GetUnitY(UC2)
set F4I=UC2
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,125,Condition(function CA1))
call ForGroup(g,function IS4)
call NSI(g)
endif
if GetTriggerEvalCount(t)>20 then
call KillUnit(IK4)
call KillUnit(IL4)
call KillUnit(IR4)
call KillUnit(IP4)
call KillUnit(IQ4)
call KillUnit(dummy)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set IK4=null
set IL4=null
set IR4=null
set IP4=null
set IQ4=null
set dummy=null
return false
endfunction
function IU4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x0=GetUnitX(hero)
local real y0=GetUnitY(hero)
local real x1=GetSpellTargetX()
local real y1=GetSpellTargetY()
local real a=UEI(x0,y0,x1,y1)
local unit IK4=CreateUnit(GetOwningPlayer(hero),'e02Z',x0,y0,a-12.5)
local unit IL4=CreateUnit(GetOwningPlayer(hero),'e02Z',x0,y0,a-6.25)
local unit IR4=CreateUnit(GetOwningPlayer(hero),'e02Z',x0,y0,a)
local unit IP4=CreateUnit(GetOwningPlayer(hero),'e02Z',x0,y0,a+6.25)
local unit IQ4=CreateUnit(GetOwningPlayer(hero),'e02Z',x0,y0,a+12.5)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x0,y0,0)
call UnitAddAbility(dummy,'A21P')
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(393),(IK4))
call SaveUnitHandle(LY,(handle_id),(394),(IL4))
call SaveUnitHandle(LY,(handle_id),(395),(IR4))
call SaveUnitHandle(LY,(handle_id),(396),(IP4))
call SaveUnitHandle(LY,(handle_id),(397),(IQ4))
call SaveReal(LY,(handle_id),(6),((x0)*1.0))
call SaveReal(LY,(handle_id),(7),((y0)*1.0))
call SaveReal(LY,(handle_id),(433),((0)*1.0))
call SaveReal(LY,(handle_id),(13),((a)*1.0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(hero,'A21M')))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function IT4))
set hero=null
set IK4=null
set IL4=null
set IR4=null
set IP4=null
set IQ4=null
set t=null
set dummy=null
endfunction
function O04 takes nothing returns boolean
if GetSpellAbilityId()=='A21M' then
call IU4()
elseif GetSpellAbilityId()=='A21N' then
call IM4()
endif
return false
endfunction
function OI4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A21L')
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
if GetUnitTypeId(hero)=='N017' or GetUnitTypeId(hero)=='N02B' then
if((LoadInteger(LY,(GetHandleId((hero))),((4416))))==1)==false or p!=GetOwningPlayer(hero)then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21N',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21M',false)
call SaveInteger(LY,(GetHandleId((hero))),((4416)),(1))
call SaveInteger(LY,(GetHandleId((hero))),((4417)),(2))
if p!=GetOwningPlayer(hero)then
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
endif
endif
if GetUnitAbilityLevel(hero,'A21N')!=level then
call SetUnitAbilityLevel(hero,'A21N',level)
endif
elseif GetUnitTypeId(hero)=='N016' then
if((LoadInteger(LY,(GetHandleId((hero))),((4417))))==1)==false or p!=GetOwningPlayer(hero)then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21N',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21M',true)
call SaveInteger(LY,(GetHandleId((hero))),((4417)),(1))
call SaveInteger(LY,(GetHandleId((hero))),((4416)),(2))
if p!=GetOwningPlayer(hero)then
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
endif
endif
if GetUnitAbilityLevel(hero,'A21M')!=level then
call SetUnitAbilityLevel(hero,'A21M',level)
endif
endif
set t=null
set hero=null
return false
endfunction
function O14 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call AddSkill(hero,'A21N')
call AddSkill(hero,'A21M')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21N',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21M',false)
call SaveInteger(LY,(GetHandleId((hero))),((4416)),(2))
call SaveInteger(LY,(GetHandleId((hero))),((4417)),(2))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function OI4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
set t=null
set hero=null
endfunction
function OO4 takes nothing returns boolean
if GetLearnedSkill()=='A21L' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A21L')==1 then
call O14()
endif
return false
endfunction
function K11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OO4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O04))
set t=null
endfunction
function O24 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer MKO=2+level
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(hero,'A1N3')
call UnitRemoveAbility(hero,'A1N6')
call UnitRemoveAbility(hero,'A1N7')
call UnitRemoveAbility(hero,'B0CH')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==hero then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI>=MKO then
call UnitRemoveAbility(hero,'A1N3')
call UnitRemoveAbility(hero,'A1N6')
call UnitRemoveAbility(hero,'A1N7')
call UnitRemoveAbility(hero,'B0CH')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if GetTriggerUnit()==hero and GetSpellAbilityId()=='A1P9' and(TimerGetElapsed(M))>(LoadReal(LY,(handle_id),(442)))then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif E31(GetSpellAbilityId())and hero==GetSpellTargetUnit()then
call UnitRemoveAbility(hero,'A1N3')
call UnitRemoveAbility(hero,'A1N6')
call UnitRemoveAbility(hero,'A1N7')
call UnitRemoveAbility(hero,'B0CH')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call UnitRemoveAbility(hero,'A1N3')
call UnitRemoveAbility(hero,'A1N6')
call UnitRemoveAbility(hero,'A1N7')
call UnitRemoveAbility(hero,'B0CH')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function O34 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A1P9')
call AddSkill(hero,'A1N3')
call AddSkill(hero,'A1N6')
call AddSkill(hero,'A1N7')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1N6',false)
call TriggerRegisterTimerEvent(t,15,false)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O24))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+1)*1.0))
set t=null
set hero=null
endfunction
function O44 takes nothing returns boolean
if GetSpellAbilityId()=='A1P9' then
call O34()
endif
return false
endfunction
function JY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O44))
call Q1I('A1N3')
set t=null
endfunction
function O54 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A0LC')
local integer EB2
local integer O64
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetUnitAbilityLevel(hero,'B02H')==0 or(GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and hero==GetSpellTargetUnit()and E31(GetSpellAbilityId()))then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'B02H')
call G21(hero,0)
else
set EB2=R2I(GetUnitState(hero,UNIT_STATE_LIFE)*(0.04+0.01*level))
set O64=(LoadInteger(LY,(handle_id),(238)))
if EB2!=O64 then
call SaveInteger(LY,(handle_id),(238),(EB2))
call G21(hero,EB2)
endif
endif
set t=null
set hero=null
return false
endfunction
function O74 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DEATH)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O54))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveInteger(LY,(handle_id),(238),(0))
set t=null
endfunction
function O84 takes nothing returns boolean
if GetSpellAbilityId()=='A0LC' then
call O74()
endif
return false
endfunction
function O94 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'B02H')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))==false and GetUnitAbilityLevel(GetTriggerUnit(),'A04R')==0 then
endif
return false
endfunction
function JJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O84))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function O94))
set t=null
endfunction
function OA4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call G41(hero,0)
set hero=null
return false
endfunction
function OB4 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer OC4=(LoadInteger(LY,(GetHandleId(target)),(824)))
local real OD4=(LoadReal(LY,(GetHandleId(target)),(825)))
local integer level=GetUnitAbilityLevel(hero,'A2X2')
if GetTriggerEventId()==EVENT_WIDGET_DEATH or OD4<(TimerGetElapsed(M))then
call SaveInteger(LY,(GetHandleId(target)),(824),(0))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_ATTACKED then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.31,true)
call TriggerAddCondition(t,Condition(function OA4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call G41(hero,IMinBJ((10+5*level)*OC4,500))
endif
set t=null
set hero=null
set target=null
endfunction
function OE4 takes nothing returns boolean
if GetTriggerEventId()!=EVENT_UNIT_ATTACKED then
call OB4()
endif
if GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))then
call OB4()
endif
return false
endfunction
function OF4 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local integer OC4=(LoadInteger(LY,(GetHandleId(target)),(824)))
local integer level=GetUnitAbilityLevel(hero,'A2X2')
call SaveInteger(LY,(GetHandleId(target)),(824),(OC4+1))
call SaveReal(LY,(GetHandleId(target)),(825),(((TimerGetElapsed(M))+15)*1.0))
if OC4==0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\BattleRoar\\RoarTarget.mdl",target,"overhead")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_ATTACKED)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function OE4))
call SaveInteger(LY,(GetHandleId(target)),(824),(2))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.31,true)
call TriggerAddCondition(t,Condition(function OA4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call G41(hero,IMinBJ((10+5*level),500))
endif
set t=null
endfunction
function OG4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call OF4(hero,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function OH4 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function OG4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set target=null
set hero=null
set t=null
endfunction
function OZ4 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4274))))==1)==false then
call SCI(hero,4274,0.2)
call OH4()
endif
endfunction
function OV4 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A2X2')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call OZ4()
endif
return false
endfunction
function OW4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function OV4))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function OX4 takes nothing returns boolean
if GetLearnedSkill()=='A2X2' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A2X2')==1 then
call OW4()
endif
return false
endfunction
function JK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OX4))
set t=null
endfunction
function OY4 takes unit dummy,real x,real y,integer level returns nothing
call SetUnitPosition(dummy,x,y)
call IssueImmediateOrder(dummy,"howlofterror")
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\HowlOfTerror\\HowlCaster.mdl",x,y))
set dummy=null
endfunction
function OJ4 takes nothing returns boolean
if(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitInGroup(GetFilterUnit(),F7I)==false then
call GroupAddUnit(F7I,GetFilterUnit())
call Damage(F8I,GetFilterUnit(),7,F9I)
endif
return false
endfunction
function OK4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local group g
if GetTriggerEvalCount(t)>10 then
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set F7I=JAO
set F8I=hero
set F9I=level*20+10
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,325,Condition(function OJ4))
call NSI(g)
set g=null
call OY4(dummy,x,y,level)
if ModuloInteger(GetTriggerEvalCount(t),2)==0 then
call KillUnit(CreateUnit(GetOwningPlayer(hero),'e02A',x,y,0))
endif
set x=PTI(x+200*Cos(RM2*bj_DEGTORAD))
set y=PUI(y+200*Sin(RM2*bj_DEGTORAD))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
endif
set t=null
set hero=null
set dummy=null
set JAO=null
return false
endfunction
function OL4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x1=GetUnitX(hero)
local real y1=GetUnitY(hero)
local real x2=GetLocationX(point)
local real y2=GetLocationY(point)
local real RM2=UEI(x1,y1,x2,y2)
local integer level=GetUnitAbilityLevel(hero,'A17O')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x1,y1,0)
call AddSkill(dummy,'A0AP')
call SetUnitAbilityLevel(dummy,'A0AP',level)
call RemoveLocation(point)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(6),((x1)*1.0))
call SaveReal(LY,(handle_id),(7),((y1)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveGroupHandle(LY,(handle_id),(133),(NTI()))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function OK4))
set t=null
set hero=null
set point=null
set dummy=null
endfunction
function OM4 takes nothing returns boolean
if GetSpellAbilityId()=='A17O' then
call OL4()
endif
return false
endfunction
function JM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OM4))
set t=null
endfunction
function ON4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x1=(LoadReal(LY,(handle_id),(64)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y1=(LoadReal(LY,(handle_id),(65)))
local real y2=(LoadReal(LY,(handle_id),(67)))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathPact\\DeathPactTarget.mdl",hero,"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathPact\\DeathPactTarget.mdl",target,"origin"))
call SetUnitPosition(hero,x2,y2)
call SCI(target,4407,1)
call SetUnitPosition(target,x1,y1)
if IsUnitInRegion(MN,target)then
call B41(target)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function OS4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real x1=GetUnitX(hero)
local real y1=GetUnitY(hero)
local real x2=GetUnitX(target)
local real y2=GetUnitY(target)
local trigger t
local integer handle_id
if IsUnitAlly(hero,GetOwningPlayer(target))==true or CanResistSkill(GetSpellTargetUnit())==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(64),((x1)*1.0))
call SaveReal(LY,(handle_id),(66),((x2)*1.0))
call SaveReal(LY,(handle_id),(65),((y1)*1.0))
call SaveReal(LY,(handle_id),(67),((y2)*1.0))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function ON4))
call UGI("SPLK",x1,y1,x2,y2,0.5,0,1,1,0.3)
call UPI(x1,y1,300)
call UPI(x2,y2,300)
endif
set hero=null
set target=null
set t=null
endfunction
function OT4 takes nothing returns boolean
if GetSpellAbilityId()=='A0IN' or GetSpellAbilityId()=='A1AW' then
call OS4()
endif
return false
endfunction
function OR4 takes nothing returns nothing
if(IsTerrainPathable(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),PATHING_TYPE_WALKABILITY))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"不能在这里使用移形换位")
endif
endfunction
function OP4 takes nothing returns boolean
if GetSpellAbilityId()=='A0IN' or GetSpellAbilityId()=='A1AW' then
call OR4()
endif
return false
endfunction
function JN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OT4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function OP4))
set t=null
endfunction
function MagicMissle takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareMissile.mdl",GetTriggerUnit(),"weapon"))
endfunction
function OQ4 takes nothing returns boolean
if GetSpellAbilityId()=='A02A' then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareMissile.mdl",GetTriggerUnit(),"weapon"))
endif
return false
endfunction
function JL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerAddCondition(t,Condition(function OQ4))
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
set t=null
endfunction
function OU4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if IsUnitDead(hero)==false or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call UnitRemoveAbility(target,'A2WV')
call UnitRemoveAbility(target,'A2WY')
call UnitRemoveAbility(target,'A2WW')
call UnitRemoveAbility(target,'A2WX')
endif
set t=null
set hero=null
set target=null
return false
endfunction
function A04 takes nothing returns boolean
local trigger t
local integer handle_id
local unit hero=GetTriggerUnit()
local unit target=GetKillingUnit()
local integer level=GetUnitAbilityLevel(hero,'ACac')
set target=ZMO(target)
if IsUnitType(target,UNIT_TYPE_HERO)==true then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function OU4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
if level==1 then
call AddSkill(target,'A2WV')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2WV',false)
elseif level==2 then
call AddSkill(target,'A2WY')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2WY',false)
elseif level==3 then
call AddSkill(target,'A2WW')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2WW',false)
elseif level==4 then
call AddSkill(target,'A2WX')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2WX',false)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AI4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function A04))
set hero=null
set t=null
endfunction
function A14 takes nothing returns boolean
if GetLearnedSkill()=='ACac' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'ACac')==1 then
call AI4()
endif
return false
endfunction
function JS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerAddCondition(t,Condition(function A14))
call UMI(t,EVENT_PLAYER_HERO_SKILL)
set t=null
endfunction
function AO4 takes unit u returns nothing
local unit SFI=K1[GetPlayerId(GetOwningPlayer(u))]
local integer handle_id=GetHandleId(SFI)
local integer A24
local integer i
local integer x
local integer A34
local unit A44
if GetUnitTypeId(SFI)!='E01Y' then
return
endif
set A24=(LoadInteger(LY,(handle_id),(348)))
set i=1
loop
exitwhen i>A24
set A34=(LoadInteger(LY,(handle_id),(7000+i)))
set A44=NYI(A34)
if A44==u then
set x=i
loop
exitwhen x==A24
call SaveInteger(LY,(handle_id),(7000+x),((LoadInteger(LY,(handle_id),(7000+x+1)))))
set x=x+1
endloop
set i=A24
endif
set i=i+1
endloop
call SaveInteger(LY,(handle_id),(348),(A24-1))
set A44=null
set SFI=null
endfunction
function A54 takes unit u returns nothing
local unit SFI=K1[GetPlayerId(GetOwningPlayer(u))]
local integer handle_id=GetHandleId(SFI)
local integer A24=(LoadInteger(LY,(handle_id),(348)))
call SaveReal(LY,(GetHandleId(u)),(786),(((TimerGetElapsed(M)))*1.0))
set A24=A24+1
call SaveInteger(LY,(handle_id),(7000+A24),(NKI(u)))
call SaveInteger(LY,(handle_id),(348),(A24))
if RW0[GetPlayerId(GetOwningPlayer(SFI))]then
call SelectUnitAddForPlayer(u,GetOwningPlayer(SFI))
endif
set SFI=null
endfunction
function WardenTrap_DeathMain takes nothing returns nothing
call AO4(GetTriggerUnit())
endfunction
function A64 takes unit u returns nothing
local integer A74=GetUnitAbilityLevel(u,'A0RP')*3+2
local integer handle_id=GetHandleId(u)
local integer A24=(LoadInteger(LY,(handle_id),(348)))
local integer A34=(LoadInteger(LY,(handle_id),(7000+1)))
local unit A44=NYI(A34)
if A24>=A74 then
call AO4(A44)
call RemoveUnit(A44)
endif
set A44=null
endfunction
function A84 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call AddSkill(dummy,'A0RU')
call SetUnitAbilityLevel(dummy,'A0RU',FAI)
call IssueTargetOrder(dummy,"slow",GetEnumUnit())
call AddSkill(dummy,'A0S7')
set dummy=null
endfunction
function A94 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
local real GW1=(LoadReal(LY,(GetHandleId(hero)),(786)))
local real TB2=(TimerGetElapsed(M))-GW1
local integer level=1
if TB2>4 then
set level=5
elseif TB2>3 then
set level=4
elseif TB2>2 then
set level=3
elseif TB2>1 then
set level=2
endif
set FAI=level
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\TomeOfRetraining\\TomeOfRetrainingCaster.mdl",x,y))
call GroupEnumUnitsInRange(g,x,y,400,Condition(function C51))
call ForGroup(g,function A84)
call NSI(g)
call AO4(hero)
call RemoveUnit(hero)
set g=null
set hero=null
endfunction
function AA4 takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())==JK and GetUnitTypeId(GetFilterUnit())=='e020'
endfunction
function AB4 takes nothing returns nothing
local real AC4=UTI(GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),AK,BK)
local real AD4=UTI(GetUnitX(GK),GetUnitY(GK),AK,BK)
if AC4<AD4 then
set GK=GetEnumUnit()
endif
endfunction
function AE4 takes nothing returns nothing
local group g=NTI()
set JK=GetOwningPlayer(GetTriggerUnit())
call GroupEnumUnitsInRange(g,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),9000,Condition(function AA4))
set GK=FirstOfGroup(g)
set AK=GetUnitX(GetTriggerUnit())
set BK=GetUnitY(GetTriggerUnit())
call ForGroup(g,function AB4)
call IssueImmediateOrder((GK),"locustswarm")
call NSI(g)
set g=null
endfunction
function WardenTrap_LearnMain takes nothing returns nothing
call AddSkill(GetTriggerUnit(),'A2XJ')
endfunction
function AF4 takes nothing returns nothing
local location point=GetSpellTargetLoc()
call AddSkill(GetTriggerUnit(),'A2XJ')
call A64(GetTriggerUnit())
call A54(CreateUnit(GetOwningPlayer(GetTriggerUnit()),'e020',GetLocationX(point),GetLocationY(point),0))
call RemoveLocation(point)
set point=null
endfunction
function AG4 takes nothing returns boolean
if GetSpellAbilityId()=='A0RP' then
call AF4()
endif
if GetSpellAbilityId()=='A2XJ' then
call AE4()
endif
return false
endfunction
function AH4 takes nothing returns boolean
if GetSpellAbilityId()=='A0RQ' then
call A94()
endif
return false
endfunction
function AZ4 takes nothing returns boolean
if GetLearnedSkill()=='A0RP' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0RP')==1 then
call AddSkill(GetTriggerUnit(),'A2XJ')
endif
return false
endfunction
function AV4 takes nothing returns boolean
if GetUnitTypeId(GetDyingUnit())=='e020' then
call AO4(GetTriggerUnit())
endif
return false
endfunction
function SY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AG4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function AV4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AH4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function AZ4))
set t=null
endfunction
function AW4 takes unit u,real AX4,real AY4,real AJ4,real AK4,real AL4 returns boolean
local real AM4=AJ4-AX4
local real AN4=AK4-AY4
local real AS4=GetUnitX(u)-AX4
local real AT4=GetUnitY(u)-AY4
return AL4>=RAbsBJ(AM4*AT4-AN4*AS4)/RAbsBJ(Pow(Pow(AM4,2)+Pow(AN4,2),0.5))
endfunction
function AR4 takes unit hero,unit target,real PAI,real InitX,real InitY returns nothing
local integer level=GetUnitAbilityLevel(hero,'A0RO')
local real AP4=(300+20*level)*2
local real AQ4=80+25
local unit AU4
local real dx
local real dy
local real B04
local real x
local real y
local group g=NTI()
local boolean BI4
local boolean B14
set dx=GetUnitX(target)-GetUnitX(hero)
set dy=GetUnitY(target)-GetUnitY(hero)
set B04=Pow(Pow(dx,2)+Pow(dy,2),0.5)
set x=GetUnitX(target)+(AP4/2-25)*(dx/B04)
set y=GetUnitY(target)+(AP4/2-25)*(dy/B04)
set GK=hero
set AK=PAI
call GroupEnumUnitsInRange(g,x,y,Pow(Pow(AP4/2,2)+Pow(AQ4/2,2),0.5),Condition(function CA1))
call GroupRemoveUnit(g,target)
set AU4=FirstOfGroup(g)
loop
exitwhen AU4==null
set BI4=AW4(AU4,GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target),AQ4/2)
set B14=AW4(AU4,x,y,x-100,y+100*x*Pow(y,-1),0.01+AP4/2)
if BI4 and B14 then
call Damage(hero,AU4,3,PAI)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\PriestMissile\\PriestMissile.mdl",AU4,"chest"))
endif
call GroupRemoveUnit(g,AU4)
set AU4=FirstOfGroup(g)
endloop
call NSI(g)
set AU4=null
set g=null
endfunction
function BO4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and GetEventDamage()>1 and IsUnitIllusion(target)==false then
call DisableTrigger(t)
call AR4(hero,target,GetEventDamage(),(LoadReal(LY,(handle_id),(349))),(LoadReal(LY,(handle_id),(350))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function B24 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.0,false)
call TriggerAddCondition(t,Condition(function BO4))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(349),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(350),((GetUnitY(hero))*1.0))
set target=null
set hero=null
set t=null
endfunction
function B34 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4272))))==1)==false then
call SCI(hero,4272,0.4)
call B24()
endif
endfunction
function B44 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A0RO')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
call B34()
endif
return false
endfunction
function B54 takes nothing returns nothing
local trigger t
if GetUnitAbilityLevel(GetTriggerUnit(),'A0RO')==1 then
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function B44))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
endif
call SetPlayerTechResearched(GetOwningPlayer(GetTriggerUnit()),'Repb',GetUnitAbilityLevel(GetTriggerUnit(),'A0RO'))
set t=null
endfunction
function B64 takes nothing returns boolean
if GetLearnedSkill()=='A0RO' and IsUnitIllusion(GetTriggerUnit())==false then
call B54()
endif
return false
endfunction
function SX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function B64))
set t=null
endfunction
function B74 takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local integer BQO=(LoadInteger(LY,(handle_id),(352)))
if BQO>0 and GetTriggerEventId()!=EVENT_UNIT_DEATH then
if GetEventDamage()>5 then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\PriestMissile\\PriestMissile.mdl",SFI,"right hand"))
call QGI(SFI,GetEventDamage())
call SaveInteger(LY,(handle_id),(352),(BQO-1))
endif
else
call UnitRemoveAbility(SFI,'A0RN')
call UnitRemoveAbility(SFI,'B08J')
call SaveInteger(LY,(handle_id),(352),(0))
endif
set SFI=null
return false
endfunction
function B84 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local unit SFI=(LoadUnitHandle(LY,(GetHandleId(t)),(14)))
local integer handle_id=GetHandleId(SFI)
local integer BQO=(LoadInteger(LY,(handle_id),(351)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and GetAttacker()==SFI and IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false)then
if GetTriggerEventId()!=EVENT_UNIT_DEATH and BQO>0 and GetEventDamage()>0 then
call SaveInteger(LY,(handle_id),(351),(BQO-1))
else
call UnitRemoveAbility(SFI,'A0RF')
call UnitRemoveAbility(SFI,'A0RM')
call UnitRemoveAbility(SFI,'B08I')
call SaveInteger(LY,(handle_id),(351),(0))
endif
endif
set t=null
set SFI=null
return false
endfunction
function B94 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local unit SFI=(LoadUnitHandle(LY,(GetHandleId(t)),(14)))
local integer handle_id=GetHandleId(SFI)
call SaveInteger(LY,(handle_id),(352),(0))
call SaveInteger(LY,(handle_id),(351),(0))
call UnitRemoveAbility(SFI,'A0RF')
call UnitRemoveAbility(SFI,'A0RM')
call UnitRemoveAbility(SFI,'A0RN')
call FlushChildHashtable(LY,(GetHandleId(t)))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function BA4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,17,false)
call TriggerAddCondition(t,Condition(function B94))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
call IO1(FE,GetUnitX(SFI),GetUnitY(SFI))
call AddSkill(SFI,'A0RN')
call SaveInteger(LY,(handle_id),(352),(GetUnitAbilityLevel(SFI,'A1EA')+2))
call AddSkill(SFI,'A0RF')
call SetUnitAbilityLevel(SFI,'A0RF',GetUnitAbilityLevel(SFI,'A1EA'))
call AddSkill(SFI,'A0RM')
call SaveInteger(LY,(handle_id),(351),(GetUnitAbilityLevel(SFI,'A1EA')+2))
set SFI=null
endfunction
function BB4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function B74))
call SaveInteger(LY,(GetHandleId(SFI)),(352),(0))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function B84))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
call SaveInteger(LY,(GetHandleId(SFI)),(351),(0))
set t=null
set SFI=null
endfunction
function BC4 takes nothing returns boolean
if GetLearnedSkill()=='A1EA' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A1EA')==1 then
call BB4()
endif
return false
endfunction
function BD4 takes nothing returns boolean
if GetSpellAbilityId()=='A1EA' then
call BA4()
endif
return false
endfunction
function SW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BD4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function BC4))
set t=null
endfunction
function BE4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
call UnitRemoveAbility((LoadUnitHandle(LY,(GetHandleId(t)),(14))),'A0RC')
call FlushChildHashtable(LY,(GetHandleId(t)))
call FlushTrigger(t)
set t=null
return false
endfunction
function BF4 takes unit hero,unit target returns nothing
local trigger t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(target))
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function BE4))
call AddSkill(target,'A0RC')
call SetUnitAbilityLevel(target,'A0RC',GetUnitAbilityLevel(hero,'A0RV'))
call Damage(hero,target,2,50*GetUnitAbilityLevel(hero,'A0RV'))
call UYI(I2S(50*GetUnitAbilityLevel(hero,'A0RV')),1,target,0.03,255,0,0,255)
call UnitRemoveAbility(hero,'B08K')
set t=null
endfunction
function BG4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local trigger BH4=(LoadTriggerHandle(LY,(handle_id),(353)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call FlushChildHashtable(LY,(GetHandleId(BH4)))
call FlushTrigger(BH4)
call BF4(hero,target)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
set BH4=null
return false
endfunction
function BZ4 takes unit hero,unit target,trigger BH4 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.0,false)
call TriggerAddCondition(t,Condition(function BG4))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveTriggerHandle(LY,(handle_id),(353),(BH4))
set t=null
endfunction
function BV4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEventId()==EVENT_UNIT_SPELL_CAST or(GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and GetAttacker()==SFI and IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(SFI))==false)then
if GetTriggerEventId()!=EVENT_UNIT_DEATH and GetTriggerEventId()!=EVENT_UNIT_SPELL_CAST and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false then
call BZ4(SFI,GetTriggerUnit(),t)
call UnitRemoveAbility(SFI,'B08K')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEventId()==EVENT_UNIT_SPELL_CAST then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif GetTriggerEventId()!=EVENT_PLAYER_UNIT_ATTACKED then
if x!=GetUnitX(SFI)or y!=GetUnitY(SFI)then
call UnitRemoveAbility(SFI,'B08K')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set SFI=null
return false
endfunction
function BW4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect(AddSpecialEffectTarget("effects\\PurpleAura.mdx",SFI,"origin"))
call IO1(UC,GetUnitX(SFI),GetUnitY(SFI))
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_CAST)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function BV4))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
call IssueImmediateOrder(SFI,"holdposition")
set t=null
set SFI=null
endfunction
function BX4 takes nothing returns boolean
if GetSpellAbilityId()=='A0RV' then
call BW4()
endif
return false
endfunction
function SV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BX4))
set t=null
endfunction
function BY4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer BJ4=(LoadInteger(LY,(handle_id),(247)))
call DestroyEffect(AddSpecialEffect("effects\\Tornado.mdx",GetUnitX(hero),GetUnitY(hero)))
if GetTriggerEvalCount(t)>10*(2+1*level)or GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(hero,BJ4)
call UnitRemoveAbility(hero,'B09W')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function BK4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A14I')
local integer BJ4
if level==1 then
set BJ4='A135'
elseif level==2 then
set BJ4='A12O'
elseif level==3 then
set BJ4='A134'
elseif level==4 then
set BJ4='A139'
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),BJ4,false)
call AH1(hero,BJ4,1,2+level)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function BY4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(247),(BJ4))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("effects\\Tornado.mdx",hero,"hand,left")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("effects\\Tornado.mdx",hero,"hand,right")))
set hero=null
set t=null
endfunction
function BL4 takes nothing returns boolean
if GetSpellAbilityId()=='A14I' then
call BK4()
endif
return false
endfunction
function TX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BL4))
set t=null
endfunction
function BM4 takes nothing returns nothing
local destructable target=GetEnumDestructable()
local real a=Atan2(GetDestructableY(target)-GetUnitY(GK),GetDestructableX(target)-GetUnitX(GK))
local real VOO=RAbsBJ((AK-a)*bj_RADTODEG)
if(RJI(target)or GetDestructableTypeId(target)=='B005')and GetDestructableLife(target)>1 and VOO<FDI and VOO<(FEI-5)then
set FDI=VOO
set FBI=target
endif
set target=null
endfunction
function BN4 takes unit IG1,unit hero,real RM2 returns destructable
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local rect r=Rect(x-FGI,y-FGI,x+FGI,y+FGI)
set FDI=9999
set GK=IG1
set FBI=null
call EnumDestructablesInRect(r,Condition(function N1I),function BM4)
call RemoveRect(r)
set r=null
return FBI
endfunction
function BS4 takes nothing returns nothing
local unit target=GetEnumUnit()
local real a=Atan2(GetUnitY(target)-GetUnitY(GK),GetUnitX(target)-GetUnitX(GK))
local real VOO=RAbsBJ((AK-a)*bj_RADTODEG)
if VOO<FDI and VOO<FEI and target!=HK then
set FDI=VOO
set FCI=target
endif
set target=null
endfunction
function BT4 takes unit IG1,unit hero,real RM2 returns unit
local group g=NTI()
set FCI=null
set FDI=9999
set GK=IG1
set AK=Atan2(GetUnitY(hero)-FZI,GetUnitX(hero)-FHI)
set HK=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),FFI,Condition(function CE1))
call ForGroup(g,function BS4)
call NSI(g)
set g=null
return FCI
endfunction
function BR4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
if(LoadLightningHandle(LY,(handle_id),(196)))!=null then
call DestroyLightning((LoadLightningHandle(LY,(handle_id),(196))))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function BP4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real BQ4=(LoadReal(LY,(handle_id),(248)))
local real RM2=Atan2(GetUnitY(target)-GetUnitY(IG1),GetUnitX(target)-GetUnitX(IG1))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real x=GetUnitX(IG1)+50*Cos(RM2)
local real y=GetUnitY(IG1)+50*Sin(RM2)
local unit BU4
local destructable d
local lightning UZI
local unit dummy
local boolean ZXO=(LoadBoolean(LY,(handle_id),(249)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(IG1)
else
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
call SetUnitFacing(IG1,RM2*bj_RADTODEG)
if QNI(x,y,GetUnitX(target),GetUnitY(target))<45 then
set FHI=(LoadReal(LY,(handle_id),(6)))
set FZI=(LoadReal(LY,(handle_id),(7)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetUnitTypeId(target)!='n00L' and ZXO then
set BU4=BT4(IG1,target,BQ4)
set d=BN4(IG1,target,BQ4)
if BU4!=null then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A12I')
call SetUnitAbilityLevel(dummy,'A12I',level+1)
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(BU4),GetUnitY(BU4),0)
call AddSkill(dummy,'A12I')
call SetUnitAbilityLevel(dummy,'A12I',level+1)
call IssueTargetOrder(dummy,"thunderbolt",BU4)
call TriggerRegisterTimerEvent(t,0.25+level*0.75,false)
call TriggerAddCondition(t,Condition(function BR4))
set UZI=AddLightning("MFPB",true,GetUnitX(target),GetUnitY(target),GetUnitX(BU4),GetUnitY(BU4))
call SetLightningColor(UZI,0.5,0.5,1,1)
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
elseif d!=null then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A12I')
call SetUnitAbilityLevel(dummy,'A12I',level+1)
call IssueTargetOrder(dummy,"thunderbolt",target)
call TriggerRegisterTimerEvent(t,0.25+level*0.75,false)
call TriggerAddCondition(t,Condition(function BR4))
set UZI=AddLightning("MFPB",true,GetUnitX(target),GetUnitY(target),GetDestructableX(d),GetDestructableY(d))
call SetLightningColor(UZI,0.5,0.5,1,1)
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SetDestructableAnimation(d,"stand hit")
else
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A12I')
call SetUnitAbilityLevel(dummy,'A12I',1)
call IssueTargetOrder(dummy,"thunderbolt",target)
endif
endif
call KillUnit(IG1)
endif
endif
set t=null
set IG1=null
set target=null
set UZI=null
set BU4=null
set d=null
set dummy=null
return false
endfunction
function C04 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real RM2=Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h077',GetUnitX(hero),GetUnitY(hero),RM2*bj_RADTODEG)
local integer level=GetUnitAbilityLevel(hero,'A12J')
local boolean ZXO=CanResistSkill(GetSpellTargetUnit())==false
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(248),((RM2)*1.0))
call SaveBoolean(LY,(handle_id),(249),(ZXO))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call TriggerRegisterTimerEvent(t,0.033,true)
call TriggerAddCondition(t,Condition(function BP4))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
set hero=null
set target=null
set t=null
endfunction
function CI4 takes nothing returns boolean
if GetSpellAbilityId()=='A12J' then
call C04()
endif
return false
endfunction
function TW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CI4))
set t=null
endfunction
function C14 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),FVI)==false and GetUnitAbilityLevel(GetEnumUnit(),'Bcyc')==0 then
call Damage((FWI),(GetEnumUnit()),1,(((FXI)*1.0))*Pow(0.9,(FJI))*Pow(0.99,(FYI)))
call GroupAddUnit(FVI,GetEnumUnit())
set FJI=FJI+1
endif
endfunction
function CO4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local integer C24=(LoadInteger(LY,(handle_id),(354)))
local integer C34=(LoadInteger(LY,(handle_id),(355)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local real x=PTI(GetUnitX(IG1)+(60*Pow(0.9,C34)*Pow(0.99,C24))*Cos(RM2))
local real y=PUI(GetUnitY(IG1)+(60*Pow(0.9,C34)*Pow(0.99,C24))*Sin(RM2))
local group g=NTI()
local real d
if GetTriggerEvalCount(t)>2 then
set d=150
else
set d=75
endif
call DestroyEffect(AddSpecialEffect("effects\\Tornado.mdx",x,y))
set C24=C24+UPI(x,y,75)
call SaveInteger(LY,(handle_id),(354),(C24))
set FVI=PR2
set FWI=IG1
set FXI=PAI
set FYI=C24
set FJI=C34
set GK=IG1
call GroupEnumUnitsInRange(g,x,y,d,Condition(function CA1))
call ForGroup(g,function C14)
call NSI(g)
call SaveInteger(LY,(handle_id),(355),(FJI))
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
if GetTriggerEvalCount(t)>42 then
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set IG1=null
set PR2=null
set g=null
return false
endfunction
function C44 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x2=(LoadReal(LY,(GetHandleId(hero)),(356)))
local real y2=(LoadReal(LY,(GetHandleId(hero)),(357)))
local real C54=QCI((TimerGetElapsed(M))-(LoadReal(LY,(GetHandleId(hero)),(358))),1.0)
local real RM2=Atan2(y2-GetUnitY(hero),x2-GetUnitX(hero))
local trigger t
local integer handle_id
local unit IG1
local integer level=GetUnitAbilityLevel(hero,'A12K')
local real PAI=(40+80*level)*(C54)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set IG1=CreateUnit(GetOwningPlayer(hero),'h078',GetUnitX(hero),GetUnitY(hero),RM2*bj_RADTODEG)
set x2=GetUnitX(hero)+2475*Cos(RM2)
set y2=GetUnitY(hero)+2475*Sin(RM2)
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(47),((x2)*1.0))
call SaveReal(LY,(handle_id),(48),((y2)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveInteger(LY,(handle_id),(354),(0))
call SaveInteger(LY,(handle_id),(355),(0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function CO4))
set hero=null
set t=null
set IG1=null
endfunction
function C64 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call SetUnitTimeScale(SFI,1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function C74 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call SetUnitAnimation(SFI,"attack")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function C84 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
call RemoveLocation(point)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.,false)
call TriggerAddCondition(t,Condition(function C74))
call SaveReal(LY,(GetHandleId(SFI)),(356),((x)*1.0))
call SaveReal(LY,(GetHandleId(SFI)),(357),((y)*1.0))
call SaveReal(LY,(GetHandleId(SFI)),(358),(((TimerGetElapsed(M)))*1.0))
call SetUnitTimeScale(SFI,1)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,1,false)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function C64))
set t=null
set SFI=null
endfunction
function C94 takes nothing returns boolean
if GetSpellAbilityId()=='A12K' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CHANNEL then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(360),(false))
call C84()
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(360),(true))
elseif(LoadBoolean(LY,(GetHandleId(GetTriggerUnit())),(360)))==true then
call C44()
endif
endif
return false
endfunction
function TY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_ENDCAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CHANNEL)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function C94))
set t=null
endfunction
function CA4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local real RS2=(LoadReal(LY,(handle_id),(193)))
local boolean CK3=(LoadBoolean(LY,(handle_id),(15)))
local integer level
if GetTriggerEvalCount(t)==1 then
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
endif
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==hero and GetTriggerUnit()==target then
call DestroyEffect(AddSpecialEffectTarget("effects\\Tornado.mdx",hero,"hand,left"))
call DestroyEffect(AddSpecialEffectTarget("effects\\Tornado.mdx",hero,"hand,right"))
if GetUnitAbilityLevel(hero,'A12R')==0 then
call AddSkill(hero,'A12R')
set level=GetUnitAbilityLevel(hero,'A1D6')
endif
elseif GetAttacker()==hero and GetTriggerUnit()!=target then
call UnitRemoveAbility(hero,'A12R')
call UnitRemoveAbility(hero,'B09X')
call UnitRemoveAbility(hero,'A1FK')
call UnitRemoveAbility(hero,'A1FL')
call UnitRemoveAbility(hero,'A1FJ')
endif
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+(RS2)*GetEventDamage())
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A12P' or GetSpellAbilityId()=='A1D6' then
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call UnitRemoveAbility(hero,'A12R')
call UnitRemoveAbility(hero,'B09X')
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A1FK')
call UnitRemoveAbility(hero,'A1FL')
call UnitRemoveAbility(hero,'A1FJ')
endif
set t=null
set hero=null
set target=null
return false
endfunction
function CB4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A12P')
local real RS2=0.6-level*0.1
local boolean CK3=false
call UnitRemoveAbility(hero,'A12R')
call UnitRemoveAbility(hero,'B09X')
if level==0 then
set CK3=true
set level=GetUnitAbilityLevel(hero,'A1D6')
set RS2=0.45-level*0.15
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A12R',false)
call AddSkill(hero,'A12R')
call IssueTargetOrder(hero,"attack",target)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveBoolean(LY,(handle_id),(15),(CK3))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveReal(LY,(handle_id),(193),((RS2)*1.0))
call SaveInteger(LY,(handle_id),(361),(0))
call TriggerRegisterTimerEvent(t,20,false)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function CA4))
set hero=null
set target=null
set t=null
endfunction
function CC4 takes nothing returns boolean
if(GetSpellAbilityId()=='A12P' or GetSpellAbilityId()=='A1D6')and CanResistSkill(GetSpellTargetUnit())==false then
call CB4()
endif
return false
endfunction
function TJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CC4))
set t=null
endfunction
function CD4 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and V51(GetUnitTypeId(GetFilterUnit()))==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(FKI))==true
endfunction
function CE4 takes nothing returns nothing
local real x=GetUnitX(GetEnumUnit())
local real y=GetUnitY(GetEnumUnit())
local unit RMI=CreateUnit(GetOwningPlayer(FKI),'e039',x,y,0)
call UnitAddAbility(RMI,'A05S')
call SetUnitAbilityLevel(RMI,'A05S',FLI)
call IssueTargetOrder(RMI,"chainlightning",GetEnumUnit())
call UnitApplyTimedLife(RMI,'BTLF',3)
call UnitAddAbility(RMI,'Aloc')
set RMI=null
endfunction
function CF4 takes nothing returns nothing
local group g=NTI()
set FKI=GetTriggerUnit()
if GetSpellAbilityId()=='A29G' then
set FLI=GetUnitAbilityLevel(GetTriggerUnit(),'A29G')+4
else
set FLI=GetUnitAbilityLevel(GetTriggerUnit(),'A29H')+7
endif
call GroupEnumUnitsInRect(g,bj_mapInitialPlayableArea,Condition(function CD4))
call ForGroup(g,function CE4)
call NSI(g)
set g=null
endfunction
function CG4 takes nothing returns boolean
if GetSpellAbilityId()=='A29G' or GetSpellAbilityId()=='A29H' then
call CF4()
endif
return false
endfunction
function JR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CG4))
set t=null
endfunction
constant function StaticField_RawCode takes nothing returns integer
return 'A0N5'
endfunction
constant function StaticField_LightningCode takes nothing returns integer
return 'A2WQ'
endfunction
constant function StaticField_ArcLightningCode takes nothing returns integer
return 'A020'
endfunction
constant function StaticField_WrathOfGodCode takes nothing returns integer
return 'A29G'
endfunction
constant function StaticField_WrathOfGod2Code takes nothing returns integer
return 'A29H'
endfunction
function CH4 takes nothing returns boolean
return(GetSpellAbilityId()==('A2WQ')or GetSpellAbilityId()==('A020')or GetSpellAbilityId()==('A29G')or GetSpellAbilityId()==('A29H'))and GetUnitAbilityLevel(GetTriggerUnit(),('A0N5'))>0
endfunction
function CZ4 takes nothing returns nothing
local real CV4=GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)
local real CW4=0.03+0.02*GetUnitAbilityLevel(GetTriggerUnit(),('A0N5'))
local real PAI=CV4*CW4
call UnitDamageTarget(GetTriggerUnit(),GetEnumUnit(),PAI,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\ForkedLightning\\ForkedLightningTarget.mdl",GetEnumUnit(),"overhead"))
endfunction
function CX4 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false
endfunction
function CY4 takes nothing returns nothing
local location BFO=GetUnitLoc(GetTriggerUnit())
local group Z51=NTI()
local real x=GetLocationX(BFO)
local real y=GetLocationY(BFO)
local boolexpr QL1=Condition(function CX4)
call GroupEnumUnitsInRange(Z51,x,y,1225,QL1)
call ForGroup(Z51,function CZ4)
call RemoveLocation(BFO)
call NSI(Z51)
endfunction
function JT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CH4))
call TriggerAddAction(t,function CY4)
endfunction
function CJ4 takes nothing returns boolean
return(RKI(GetFilterUnit())==false and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsHeroUnitId(GetUnitTypeId(GetFilterUnit()))
endfunction
function CK4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
local integer level=GetUnitAbilityLevel(hero,'A2WQ')
local real PAI=25+level*75
local group g
local real x
local real y
if level>=3 then
set PAI=PAI+25
endif
if target==null then
set g=NTI()
set x=GetSpellTargetX()
set y=GetSpellTargetY()
set GK=hero
call GroupEnumUnitsInRange(g,x,y,325+25,Condition(function CJ4))
set target=AU1(g,x,y)
call NSI(g)
set g=null
endif
if target!=null then
set x=GetUnitX(target)
set y=GetUnitY(target)
call UUI(hero,target)
call PDI(hero,target,1,PAI,0.25)
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e000',x,y,0)
call AddSkill(dummy,'A05S')
call UnitApplyTimedLife(dummy,'BTLF',4.5)
call SetUnitPathing(dummy,false)
call AddSkill(dummy,'Aloc')
if target==null or IssueTargetOrder(dummy,"chainlightning",target)==false then
set target=CreateUnit(GetOwningPlayer(hero),'e00C',x,y,0)
call UnitApplyTimedLife(target,'BTLF',0.2)
call IssueTargetOrder(dummy,"chainlightning",target)
endif
set hero=null
set target=null
set dummy=null
endfunction
function CL4 takes nothing returns boolean
if GetSpellAbilityId()=='A2WQ' and(GetSpellTargetUnit()==null or CanResistSkill(GetSpellTargetUnit())==false)then
call CK4()
endif
return false
endfunction
function JP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CL4))
set t=null
endfunction
function CM4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
if GetTriggerEvalCount(t)>80 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set dummy=null
return false
endfunction
function CN4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e02C',GetUnitX(hero),GetUnitY(hero),0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(dummy,'A1FM')
call SetUnitAbilityLevel(dummy,'A1FM',GetUnitAbilityLevel(hero,'A020'))
call IssueTargetOrder(dummy,"chainlightning",target)
call UnitApplyTimedLife(dummy,'BTLF',10)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function CM4))
set hero=null
set target=null
set dummy=null
set t=null
endfunction
function CS4 takes nothing returns boolean
if GetSpellAbilityId()=='A020' and CanResistSkill(GetSpellTargetUnit())==false then
call CN4()
endif
return false
endfunction
function JQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerAddCondition(t,Condition(function CS4))
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
set t=null
endfunction
constant function DeathCoil_AbilityCode takes nothing returns integer
return 'A0I3'
endfunction
function CT4 takes nothing returns boolean
return GetSpellAbilityId()==('A0I3')and(IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))or CanResistSkill(GetSpellTargetUnit())==false)
endfunction
function CR4 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
call UnitDamageTarget(SFI,SFI,PAI,false,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
call FlushChildHashtable(LY,(handle_id))
call PauseTimer(t)
call DestroyTimer(t)
endfunction
function CP4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real PAI=50+50*GetUnitAbilityLevel(SFI,('A0I3'))
local real CQ4=50+25*GetUnitAbilityLevel(SFI,('A0I3'))
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl",target,"origin"))
if IsUnitAlly(target,GetOwningPlayer(SFI))and GetUnitState(target,UNIT_STATE_LIFE)>1.00 then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+PAI)
else
call UnitDamageTarget(SFI,target,PAI,false,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
endif
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(20),((CQ4)*1.0))
call TimerStart(t,0,false,function CR4)
endfunction
function ML1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CT4))
call TriggerAddAction(t,function CP4)
endfunction
function CU4 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(FMI),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call AddSkill(dummy,'A0MJ')
call SetUnitAbilityLevel(dummy,'A0MJ',FNI)
call IssueTargetOrder(dummy,"forkedlightning",GetEnumUnit())
set dummy=null
endfunction
function D04 takes unit hero,unit target,integer level returns nothing
local group g=NTI()
set GK=hero
set FNI=level
set FMI=hero
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),700,Condition(function C81))
call ForGroup(g,function CU4)
call NSI(g)
set g=null
endfunction
function DI4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real D14=(LoadReal(LY,(handle_id),(362)))
local unit hero
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer level
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4250))))==1)==false then
if D14<GetEventDamage()then
set hero=(LoadUnitHandle(LY,(handle_id),(2)))
set level=(LoadInteger(LY,(handle_id),(5)))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call SaveBoolean(LY,(GetHandleId(target)),(363),(false))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call QGI(GetTriggerUnit(),D14)
call D04(hero,GetTriggerUnit(),level)
elseif GetEventDamage()>0 then
call QGI(GetTriggerUnit(),GetEventDamage())
call SaveReal(LY,(handle_id),(362),((D14-GetEventDamage())*1.0))
endif
endif
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if E31(GetSpellAbilityId())==true and GetSpellTargetUnit()==target then
set hero=(LoadUnitHandle(LY,(handle_id),(2)))
set level=(LoadInteger(LY,(handle_id),(5)))
call SaveBoolean(LY,(GetHandleId(target)),(363),(false))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call D04(hero,target,level)
endif
else
set hero=(LoadUnitHandle(LY,(handle_id),(2)))
set level=(LoadInteger(LY,(handle_id),(5)))
call SaveBoolean(LY,(GetHandleId(target)),(363),(false))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call D04(hero,target,level)
endif
set t=null
return false
endfunction
function DO4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A0MF')
local integer KAO=GetHandleId(target)
local real D14
if(LoadBoolean(LY,(KAO),(363)))==true then
call TriggerEvaluate((LoadTriggerHandle(LY,(KAO),(364))))
endif
call UnitRemoveBuffs(target,false,true)
call DU1(target,0,0)
if level==1 then
set D14=110
elseif level==2 then
set D14=140
elseif level==3 then
set D14=170
else
set D14=200
endif
call SaveReal(LY,(handle_id),(362),((D14)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\Defensive Barrier big.mdx",target,"chest")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerRegisterTimerEvent(t,15,false)
call TriggerAddCondition(t,Condition(function DI4))
call SaveTriggerHandle(LY,(KAO),(364),(t))
call SaveBoolean(LY,(KAO),(363),(true))
set t=null
set target=null
set hero=null
endfunction
function D24 takes nothing returns boolean
if GetSpellAbilityId()=='A0MF' then
call DO4()
endif
return false
endfunction
function D34 takes nothing returns nothing
if GetUnitAbilityLevel(GetSpellTargetUnit(),'BNdo')>0 then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"不能在被末日诅咒的单位上施放无光之盾")
endif
endfunction
function D44 takes nothing returns boolean
if GetSpellAbilityId()=='A0MF' then
call D34()
endif
return false
endfunction
function MN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function D44))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function D24))
set t=null
endfunction
function D54 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local trigger bt=(LoadTriggerHandle(LY,(handle_id),(35)))
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)then
call TriggerRegisterUnitEvent(bt,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
endif
set t=null
set bt=null
return false
endfunction
function D64 takes nothing returns nothing
call TriggerRegisterUnitEvent(FTI,GetEnumUnit(),EVENT_UNIT_DAMAGED)
endfunction
function D74 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or IssueImmediateOrder(SFI,"windwalk")then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
return false
endfunction
function D84 takes unit SFI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function D74))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
endfunction
function D94 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A0NS')
local integer DC1=3+level
local real OA2
local boolean DA4=false
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1DA')
set DC1=4+1*level
set DA4=true
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED and((LoadInteger(LY,(GetHandleId((hero))),((4250))))==1)then
if SFI==hero then
call QGI(SFI,GetEventDamage())
call QGI(SFI,GetEventDamage())
elseif DA4 and QLI(SFI,hero)<900 and IsUnitAlly(SFI,GetOwningPlayer(hero))then
call QGI(SFI,GetEventDamage()*0.35)
call QGI(hero,GetEventDamage()*0.35)
endif
elseif SFI==hero and((GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and(GetSpellAbilityId()=='A0NS' or GetSpellAbilityId()=='A1DA'))or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and((LoadInteger(LY,(GetHandleId((SFI))),((4251))))==1)==false and GetUnitState(SFI,UNIT_STATE_LIFE)<400 and GetUnitAbilityLevel(SFI,'BNdo')==0))then
call TimerStart(EJ0[GetPlayerId(GetOwningPlayer(SFI))],70-10*level,false,null)
call SCI(SFI,4250,DC1)
call SCI(SFI,4251,70-10*level)
call UnitRemoveBuffs(SFI,false,true)
call DU1(SFI,0,0)
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
call DisableTrigger(t)
set FSI=true
if IssueImmediateOrder(SFI,"windwalk")==false then
call D84(SFI)
endif
set FSI=false
call EnableTrigger(t)
endif
call U5I("Abilities\\Spells\\Undead\\Unsummon\\UnsummonTarget.mdl",SFI,"origin",DC1)
endif
set t=null
set SFI=null
set hero=null
return false
endfunction
function DB4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local group g
local region r
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function D94))
set FTI=t
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,999999,Condition(function D61))
call ForGroup(g,function D64)
call NSI(g)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveTriggerHandle(LY,(handle_id),(35),(FTI))
set r=CreateRegion()
call RegionAddRect(r,GetWorldBounds())
call TriggerRegisterEnterRegion(t,r,Condition(function N1I))
call TriggerAddCondition(t,Condition(function D54))
set t=null
set hero=null
set g=null
set r=null
endfunction
function DC4 takes nothing returns boolean
if(GetLearnedSkill()=='A0NS' or GetLearnedSkill()=='A1DA')and IsUnitIllusion(GetTriggerUnit())==false and(GetUnitAbilityLevel(GetTriggerUnit(),'A0NS')==1 or GetUnitAbilityLevel(GetTriggerUnit(),'A1DA')==1)then
call DB4()
endif
return false
endfunction
function MS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function DC4))
set t=null
endfunction
constant function MarkOfTheAbyss_AttackBuff takes nothing returns integer
return 'B066'
endfunction
constant function MarkOfTheAbyss_EffectCode takes nothing returns integer
return 'A0MH'
endfunction
constant function MarkOfTheAbyss_FrostmourneCode takes nothing returns integer
return 'A0MG'
endfunction
function DD4 takes nothing returns boolean
return GetUnitAbilityLevel(GetTriggerUnit(),('B066'))>0 or GetUnitAbilityLevel(GetAttacker(),('A0MG'))>0
endfunction
function DE4 takes nothing returns nothing
local unit Z4O=GetAttacker()
local unit target=GetTriggerUnit()
local unit SourceHero
local integer level=GetUnitAbilityLevel(Z4O,('A0MG'))
local unit dummy=CreateUnit(GetOwningPlayer(Z4O),'e00E',GetUnitX(Z4O),GetUnitY(Z4O),0)
if level>0 then
call SaveInteger(LY,(GetHandleId(target)),(203),(level))
else
set level=(LoadInteger(LY,(GetHandleId(target)),(203)))
endif
if IsUnitEnemy(target,GetOwningPlayer(Z4O))==true then
call AddSkill(dummy,('A0MH'))
call SetUnitAbilityLevel(dummy,('A0MH'),level)
call IssueTargetOrder(dummy,"bloodlust",Z4O)
endif
endfunction
function MM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function DD4))
call TriggerAddAction(t,function DE4)
endfunction
function DF4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real PAI
local integer DC1
local unit IWO
if level==1 then
set PAI=16
set DC1=10
elseif level==2 then
set PAI=24
set DC1=10
elseif level==3 then
set PAI=32
set DC1=10
elseif level==4 then
set PAI=40
set DC1=10
endif
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetTriggerEvalCount(t)>1 and GetSpellAbilityId()=='A0S1' and CanResistSkill(GetSpellTargetUnit())==false and target==GetSpellTargetUnit()then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_DEATH then
set IWO=GetKillingUnit()
if RLI(IWO)then
set IWO=(K1[GetPlayerId(GetOwningPlayer((IWO)))])
endif
if GetTriggerUnit()==target or IWO==target then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A1W3')
call UnitRemoveAbility(target,'B0DO')
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==DC1 or GetUnitAbilityLevel(target,'B0DO')==0 or RKI(target)==true then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A1W3')
call UnitRemoveAbility(target,'B0DO')
endif
call Damage(hero,target,1,PAI)
endif
set t=null
set hero=null
set target=null
set IWO=null
return false
endfunction
function DG4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A0S1')
local real PAI
local real DC1
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Demon\\ReviveDemon\\ReviveDemon.mdl",target,"overhead"))
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1W3',false)
call AddSkill(target,'A1W3')
call UnitMakeAbilityPermanent(target,true,'A1W2')
call TriggerRegisterTimerEvent(t,1,true)
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DF4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\SoulBurn\\SoulBurnbuff.mdl",target,"overhead")))
set hero=null
set target=null
set t=null
endfunction
function DH4 takes nothing returns nothing
if GetUnitAbilityLevel(GetEnumUnit(),'B0DO')>0 then
set FRI=FRI+1
endif
endfunction
function DZ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=NTI()
set GK=hero
set FRI=0
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function CA1))
call ForGroup(g,function DH4)
call NSI(g)
if FRI==0 then
if GetUnitAbilityLevel(hero,'B0EZ')>0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
endif
elseif FRI==1 then
if GetUnitAbilityLevel(hero,'A2AR')==0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
call UnitAddAbility(hero,'A2AR')
endif
elseif FRI==2 then
if GetUnitAbilityLevel(hero,'A2AS')==0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
call UnitAddAbility(hero,'A2AS')
endif
elseif FRI==3 then
if GetUnitAbilityLevel(hero,'A2AU')==0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
call UnitAddAbility(hero,'A2AU')
endif
elseif FRI==4 then
if GetUnitAbilityLevel(hero,'A2AT')==0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
call UnitAddAbility(hero,'A2AT')
endif
elseif FRI==5 then
if GetUnitAbilityLevel(hero,'A2AQ')==0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
call UnitAddAbility(hero,'A2AQ')
endif
elseif FRI>=6 then
if GetUnitAbilityLevel(hero,'A2AP')==0 then
call UnitRemoveAbility(hero,'A2AR')
call UnitRemoveAbility(hero,'A2AS')
call UnitRemoveAbility(hero,'A2AU')
call UnitRemoveAbility(hero,'A2AT')
call UnitRemoveAbility(hero,'A2AQ')
call UnitRemoveAbility(hero,'A2AP')
call UnitRemoveAbility(hero,'B0EZ')
call UnitAddAbility(hero,'A2AP')
endif
endif
set t=null
set hero=null
return false
endfunction
function DV4 takes nothing returns boolean
if GetSpellAbilityId()=='A0S1' and CanResistSkill(GetSpellTargetUnit())==false then
call DG4()
endif
return false
endfunction
function DW4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function DZ4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AR',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AS',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AU',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AT',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AQ',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AP',false)
set t=null
endfunction
function DX4 takes nothing returns boolean
if GetLearnedSkill()=='A0S1' and GetUnitAbilityLevel(GetTriggerUnit(),'A0S1')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call DW4()
endif
return false
endfunction
function K21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DV4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function DX4))
set t=null
endfunction
function DY4 takes nothing returns boolean
return(IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),'B008')==0 and GetUnitAbilityLevel(GetFilterUnit(),'Bcyc')==0 and GetUnitAbilityLevel(GetFilterUnit(),'Bcy2')==0
endfunction
function DJ4 takes integer handle_id,integer DK4 returns nothing
local integer i=1
loop
exitwhen i>DK4
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(2700+i))))
set i=i+1
endloop
endfunction
function DL4 takes nothing returns nothing
call UnitWakeUp(GetEnumUnit())
call IssueTargetOrder(GetEnumUnit(),"attack",FPI)
endfunction
function DM4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(220)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer DK4=(LoadInteger(LY,(handle_id),(365)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER and GetTriggerEventId()!=EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER and GetTriggerEventId()!=EVENT_PLAYER_UNIT_ISSUED_ORDER then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==(8+2*level)or IsUnitDead(SFI)then
call UnitRemoveAbility(SFI,'A0I5')
call NSI(g)
call DJ4(handle_id,DK4)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call DisableTrigger(t)
set FPI=SFI
call ForGroup(g,function DL4)
call EnableTrigger(t)
endif
else
if IsUnitInGroup(GetTriggerUnit(),g)==true and UnitIsSleeping(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'B008')==0 and GetIssuedOrderId()!=851973 and FSI==false then
call DisableTrigger(t)
call IssueTargetOrder(GetTriggerUnit(),"attack",SFI)
call EnableTrigger(t)
endif
endif
set t=null
set g=null
set SFI=null
return false
endfunction
function DN4 takes nothing returns nothing
set UJ=UJ+1
call SaveEffectHandle(LY,(SK),(2700+UJ),(AddSpecialEffectTarget("Abilities\\Weapons\\LavaSpawnMissile\\LavaSpawnBirthMissile.mdl",GetEnumUnit(),"chest")))
endfunction
function DS4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A0I6')
local group g=NTI()
call AddSkill(SFI,'A0I5')
call SetUnitAbilityLevel(SFI,'A0I5',level)
set GK=SFI
set FPI=SFI
set UJ=0
set SK=handle_id
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),325,Condition(function DY4))
call ForGroup(g,function DN4)
call ForGroup(g,function DL4)
call SaveInteger(LY,(handle_id),(365),(UJ))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveGroupHandle(LY,(handle_id),(220),(g))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
call TriggerRegisterTimerEvent(t,0.2,true)
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER)
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function DM4))
set t=null
set g=null
set SFI=null
endfunction
function DT4 takes nothing returns boolean
if GetSpellAbilityId()=='A0I6' then
call DS4()
endif
return false
endfunction
function K41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DT4))
set t=null
endfunction
function DR4 takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",GetEnumUnit(),"origin"))
call Damage(GetTriggerUnit(),GetEnumUnit(),2,GetUnitAbilityLevel(GetTriggerUnit(),'A0C6')*35+65)
endfunction
function DP4 takes nothing returns nothing
local group g
local unit SFI=GetTriggerUnit()
local integer NPI=(LoadInteger(LY,(GetHandleId(SFI)),(823)))
if GetRandomReal(0,100)<(NPI+1)*5.570 then
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),300,Condition(function C71))
call ForGroup(g,function DR4)
call SetUnitAnimation(SFI,"spin")
call OE1(SFI,0.6)
call SCI(SFI,4267,0.5-0.05*GetUnitAbilityLevel(GetTriggerUnit(),'A0C6'))
call SaveInteger(LY,(GetHandleId(SFI)),(823),(0))
call NSI(g)
else
call SaveInteger(LY,(GetHandleId(SFI)),(823),(NPI+1))
endif
set g=null
set SFI=null
endfunction
function DQ4 takes nothing returns boolean
if GetUnitAbilityLevel(GetTriggerUnit(),'B03P')>0 and IsUnitType(GetAttacker(),UNIT_TYPE_STRUCTURE)==false and IsUnitType(GetAttacker(),UNIT_TYPE_MECHANICAL)==false and GetUnitAbilityLevel(GetAttacker(),'A04R')==0 and IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false and((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4267))))==1)==false then
call DP4()
endif
return false
endfunction
function K31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function DQ4))
set t=null
endfunction
function DU4 takes nothing returns nothing
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A2IC',false)
call AX1(GetEnumUnit(),'A2IC',1,FQI,'B0FV')
endfunction
constant function CullingBlade_RawCode takes nothing returns integer
return 'A0E2'
endfunction
function E04 takes nothing returns boolean
return CanResistSkill(GetSpellTargetUnit())==false and(GetSpellAbilityId()==('A0E2')or GetSpellAbilityId()=='A1MR')
endfunction
function EI4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real D14=GetUnitState(target,UNIT_STATE_LIFE)
local integer level=GetUnitAbilityLevel(SFI,('A0E2'))
local unit dummy
local boolean E14=false
local group g
local integer EO4=250
local integer E24=325
local integer E34=400
set FQI=6
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A1MR')
set E14=true
set EO4=300
set E24=425
set E34=550
set FQI=10
endif
if(D14<=EO4 and level==1)or(D14<=E24 and level==2)or(D14<=E34 and level==3)then
if IsUnitType(target,UNIT_TYPE_HERO)then
if E14 then
call UnitRemoveAbility(SFI,'A1MR')
call UnitAddAbility(SFI,'A1MR')
call SetUnitAbilityLevel(SFI,'A1MR',level)
else
call UnitRemoveAbility(SFI,'A0E2')
call UnitAddAbility(SFI,'A0E2')
call SetUnitAbilityLevel(SFI,'A0E2',level)
endif
endif
call PlaySoundOnUnitBJ(FC,100,target)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\PhoenixMissile\\Phoenix_Missile.mdl",target,"overhead"))
set dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',0,0,0)
call UnitRemoveBuffs(target,true,true)
call UnitRemoveAbility(target,'Aetl')
call UnitDamageTarget(dummy,target,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\AxeUltiMSFX_01.mdx",SFI,"origin"))
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),925,Condition(function CR1))
call ForGroup(g,function DU4)
call NSI(g)
set g=null
endif
endfunction
function K51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function E04))
call TriggerAddAction(t,function EI4)
endfunction
function E44 takes nothing returns boolean
return GetSpellAbilityId()=='A0GK' and CanResistSkill(GetSpellTargetUnit())==false
endfunction
function E54 takes nothing returns nothing
call UnitDamageTargetBJ(GetTriggerUnit(),GetSpellTargetUnit(),20+70*GetUnitAbilityLevel(GetTriggerUnit(),'A0GK'),ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC)
if GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)>1 then
call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+20+70*GetUnitAbilityLevel(GetTriggerUnit(),'A0GK'))
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIil\\AIilTarget.mdl",GetSpellTargetUnit(),"origin"))
endfunction
function E64 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit dummy
if GetUnitAbilityLevel(target,'B02F')==0 then
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A04Y',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2O9',false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and GetTriggerUnit()==target then
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A04Y',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2O9',false)
call UnitRemoveAbility(target,'B02F')
set dummy=CreateUnit(p,'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A04Y')
call SetUnitAbilityLevel(dummy,'A04Y',level)
call IssueTargetOrder(dummy,"sleep",GetAttacker())
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_PLAYER_UNIT_ATTACKED then
if GetUnitState(target,UNIT_STATE_LIFE)>21 then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)-20)
else
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A04Y',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2O9',false)
call UnitRemoveAbility(target,'B02F')
call Damage(hero,target,1,50)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set p=null
set dummy=null
set target=null
set hero=null
return false
endfunction
function E74 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
set handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(hero)))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(hero,'A04Y')))
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function E64))
if GetUnitAbilityLevel(target,'A04Y')>0 then
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A04Y',false)
call AddSkill(target,'A2O9')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2O9',true)
endif
set NY0=true
call Damage(hero,target,2,0)
set NY0=false
set hero=null
set target=null
set t=null
endfunction
function E84 takes nothing returns boolean
if GetSpellAbilityId()=='A04Y' and RYI(GetSpellTargetUnit())==false then
call E74()
endif
return false
endfunction
function E94 takes nothing returns boolean
if GetSpellAbilityId()=='A04Y' and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true then
if GetOwningPlayer(GetTriggerUnit())!=GetOwningPlayer(GetSpellTargetUnit())and IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endif
return false
endfunction
function EA4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'B02F')
call UnitRemoveAbility(hero,'A2O9')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A04Y',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2O9',false)
set t=null
set hero=null
return false
endfunction
function EB4 takes nothing returns boolean
local trigger t
if GetIssuedOrderId()==String2OrderIdBJ("manashieldon")and GetUnitAbilityLevel(GetTriggerUnit(),'A2O9')>0 then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function EA4))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(GetTriggerUnit()))
endif
return false
endfunction
function K61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function E84))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function E94))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function EB4))
set t=null
endfunction
function EC4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real OA2
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer MKO=6
local unit dummy
local integer level
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
if GetUnitAbilityLevel(hero,'A1D9')>0 then
set MKO=8
endif
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveBoolean(LY,(GetHandleId(hero)),(4344),(false))
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if(LoadBoolean(LY,(GetHandleId(GetTriggerUnit())),(4344)))then
set level=GetUnitAbilityLevel(hero,'A04Y')
if level>0 and GetUnitAbilityLevel(hero,'A1D9')>0 then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(GetAttacker()),GetUnitY(GetAttacker()),0)
call AddSkill(dummy,'A04Y')
call SetUnitAbilityLevel(dummy,'A04Y',level)
call IssueTargetOrder(dummy,"sleep",GetAttacker())
endif
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI>MKO then
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call PJI(hero)
else
set OA2=RMinBJ(0.05*GetUnitState(target,UNIT_STATE_MAX_MANA),GetUnitState(target,UNIT_STATE_MANA))
if GetUnitAbilityLevel(hero,'A1D9')>0 then
set OA2=RMinBJ(0.1*GetUnitState(target,UNIT_STATE_MAX_MANA),GetUnitState(target,UNIT_STATE_MANA))
endif
if OA2>0 then
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+OA2)
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)-OA2)
endif
endif
endif
set t=null
set hero=null
set target=null
set I31=null
return false
endfunction
function ED4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local fogmodifier I31=CreateFogModifierRadius(GetOwningPlayer(hero),FOG_OF_WAR_VISIBLE,GetUnitX(target),GetUnitY(target),350,true,true)
call FogModifierStart(I31)
call UnitRemoveAbility(target,'B02F')
call UnitRemoveAbility(target,'BUsp')
call UnitRemoveAbility(target,'Bust')
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function EC4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveFogModifierHandle(LY,(handle_id),(42),(I31))
call SaveBoolean(LY,(GetHandleId(hero)),(4344),(true))
set hero=null
set target=null
set t=null
set I31=null
endfunction
function EE4 takes nothing returns boolean
if GetSpellAbilityId()=='A02Q' or GetSpellAbilityId()=='A1D9' then
call ED4()
endif
return false
endfunction
function K71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EE4))
set t=null
endfunction
function EF4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(789)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()==EVENT_WIDGET_DEATH or LVO<(TimerGetElapsed(M))then
call UnitRemoveAbility(target,'A2OG')
call UnitRemoveAbility(target,'A2OA')
call UnitRemoveAbility(target,'A2OF')
call UnitRemoveAbility(target,'A2OH')
call UnitRemoveAbility(target,'B0GE')
endif
set t=null
set target=null
return false
endfunction
function EG4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2OI')
if level==1 then
call UnitRemoveAbility(target,'B0GE')
call UnitRemoveAbility(target,'A2OA')
call UnitRemoveAbility(target,'A2OF')
call UnitRemoveAbility(target,'A2OH')
call AddSkill(target,'A2OG')
call UnitMakeAbilityPermanent(target,true,'A2OD')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2OG',false)
elseif level==2 then
call UnitRemoveAbility(target,'B0GE')
call UnitRemoveAbility(target,'A2OG')
call UnitRemoveAbility(target,'A2OF')
call UnitRemoveAbility(target,'A2OH')
call AddSkill(target,'A2OA')
call UnitMakeAbilityPermanent(target,true,'A2OE')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2OA',false)
elseif level==3 then
call UnitRemoveAbility(target,'B0GE')
call UnitRemoveAbility(target,'A2OG')
call UnitRemoveAbility(target,'A2OA')
call UnitRemoveAbility(target,'A2OH')
call AddSkill(target,'A2OF')
call UnitMakeAbilityPermanent(target,true,'A2OC')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2OF',false)
elseif level==4 then
call UnitRemoveAbility(target,'B0GE')
call UnitRemoveAbility(target,'A2OG')
call UnitRemoveAbility(target,'A2OA')
call UnitRemoveAbility(target,'A2OF')
call AddSkill(target,'A2OH')
call UnitMakeAbilityPermanent(target,true,'A2OB')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2OH',false)
endif
call TriggerRegisterTimerEvent(t,20,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function EF4))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(GetHandleId(target)),(789),((19.9+(TimerGetElapsed(M)))*1.0))
set t=null
set hero=null
set target=null
endfunction
function EH4 takes nothing returns boolean
if GetSpellAbilityId()=='A2OI' and CanResistSkill(GetSpellTargetUnit())==false then
call EG4()
endif
return false
endfunction
function K81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EH4))
set t=null
endfunction
// 粘性燃油额外伤害
function EZ4 takes nothing returns boolean
	local trigger t=GetTriggeringTrigger()
	local integer handle_id=GetHandleId(t)
	local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
	local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
	local integer NPI=(LoadInteger(LY,(GetHandleId(target)),(281)))
	local boolean EV4=(LoadBoolean(LY,(handle_id),(280)))
	local real DH1
	if GetTriggerEventId()==EVENT_UNIT_DEATH then
		call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target))
		call SaveInteger(LY,(GetHandleId(target)),(281),(0))
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
		call DU1(target,0,0)
	elseif NPI==0 then
		call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target))
		call SaveInteger(LY,(GetHandleId(target)),(281),(0))
		call FlushChildHashtable(LY,(handle_id))
		call FlushTrigger(t)
	elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED and EV4==false and mu_damage_dot == false then
		if NPI>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A1EL')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
			call SaveBoolean(LY,(handle_id),(280),(true))
			if G8I then
				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\LordofFlameMissile\\LordofFlameMissile.mdl",target,"chest"))
				set DH1=0.5*(5+5*GetUnitAbilityLevel(hero,'A1EL'))*NPI
			elseif MZ0==false and GetEventDamage()>12 then
				call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\LordofFlameMissile\\LordofFlameMissile.mdl",target,"chest"))
				set DH1=(5+5*GetUnitAbilityLevel(hero,'A1EL'))*NPI
			endif
			if IsUnitType(target,UNIT_TYPE_HERO)==false then
				set DH1=DH1*0.5
			endif
			if G8I then
				call Damage(hero,target,1,DH1)
			elseif MZ0==false and GetEventDamage()>12 then
				call Damage(hero,target,1,DH1)
			endif
			call SaveBoolean(LY,(handle_id),(280),(false))
		endif
	else
		call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target)*0.3)
	endif
	set t=null
	set hero=null
	set target=null
	return false
endfunction
function EW4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real Z7O=(LoadReal(LY,(GetHandleId(target)),(675)))
local integer StickyCount=(LoadInteger(LY,(GetHandleId(target)),(281)))
if(TimerGetElapsed(M))-Z7O>=8 then
call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target))
call SaveInteger(LY,(GetHandleId(target)),(281),(0))
call DU1(target,0,0)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function EX4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(hero,'A1EL')
local integer NPI=IMinBJ((LoadInteger(LY,(GetHandleId(target)),(281)))+1,10)
if RKI(target)then
set hero=null
set target=null
return
endif
call DU1(target,level,NPI)
call SaveInteger(LY,(GetHandleId(target)),(281),(NPI))
call SaveReal(LY,(GetHandleId(target)),(675),(((TimerGetElapsed(M)))*1.0))
call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target)*0.3)
if IsUnitType(target,UNIT_TYPE_HERO)==true then
call UKI(GetOwningPlayer(hero),I2S(NPI)+"!",2,target,0.026,50,0,255,216)
endif
if NPI==1 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveBoolean(LY,(handle_id),(280),(false))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function EZ4))
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,8,false)
call TriggerAddCondition(t,Condition(function EW4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function EY4 takes nothing returns nothing
local group g=NTI()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local unit hero=GetTriggerUnit()
call GroupEnumUnitsInRange(g,x,y,400,Condition(function C51))
call ForGroup(g,function EX4)
call I41(GetOwningPlayer(hero),2,x,y,500)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x,y))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x,y+130))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x,y-130))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x+130,y))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x+130,y+130))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x+130,y-130))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x-130,y))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x-130,y+130))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGargoyle.mdl",x-130,y-130))
call RemoveLocation(point)
call NSI(g)
set g=null
set point=null
set hero=null
endfunction
function EJ4 takes nothing returns boolean
if GetSpellAbilityId()=='A1EL' then
call EY4()
endif
return false
endfunction
function TM1 takes nothing returns nothing
local integer i
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EJ4))
set FUI[1]='A1XC'
set FUI[2]='A1XB'
set FUI[3]='A1X4'
set FUI[4]='A1X5'
set FUI[5]='A1X6'
set FUI[6]='A1X7'
set FUI[7]='A1XA'
set FUI[8]='A1X8'
set FUI[9]='A1X9'
set FUI[10]='A1XD'
set G0I[1]='A1XM'
set G0I[2]='A1XE'
set G0I[3]='A1XF'
set G0I[4]='A1XG'
set G0I[5]='A1XH'
set G0I[6]='A1XI'
set G0I[7]='A1XJ'
set G0I[8]='A1XK'
set G0I[9]='A1XN'
set G0I[10]='A1XL'
set GII[1]='A1XO'
set GII[2]='A1XV'
set GII[3]='A1XW'
set GII[4]='A1XQ'
set GII[5]='A1XR'
set GII[6]='A1XS'
set GII[7]='A1XX'
set GII[8]='A1XT'
set GII[9]='A1XU'
set GII[10]='A1XP'
set G1I[1]='A1XY'
set G1I[2]='A1XZ'
set G1I[3]='A1Y5'
set G1I[4]='A1Y6'
set G1I[5]='A1Y7'
set G1I[6]='A1Y1'
set G1I[7]='A1Y2'
set G1I[8]='A1Y3'
set G1I[9]='A1Y4'
set G1I[10]='A1Y0'
set i=1
loop
exitwhen i>10
call Q1I(FUI[i])
set i=i+1
endloop
set i=1
loop
exitwhen i>10
call Q1I(G0I[i])
set i=i+1
endloop
set i=1
loop
exitwhen i>10
call Q1I(GII[i])
set i=i+1
endloop
set i=1
loop
exitwhen i>10
call Q1I(G1I[i])
set i=i+1
endloop
set t=null
endfunction
function EK4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real d=(LoadReal(LY,(handle_id),(138)))
local real x1=(LoadReal(LY,(handle_id),(6)))
local real y1=(LoadReal(LY,(handle_id),(7)))
local real x2
local real y2
local real x
local real y
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>10 then
call UPI(GetUnitX(target),GetUnitY(target),200)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set x2=x1+d*Cos(a)
set y2=y1+d*Sin(a)
if(IsPointInRegion(LN,((x2)*1.0),((y2)*1.0)))==false then
call SaveReal(LY,(handle_id),(6),((x2)*1.0))
call SaveReal(LY,(handle_id),(7),((y2)*1.0))
set x=x2
set y=y2
else
set x=x1
set y=y1
endif
if IsUnitType(target,UNIT_TYPE_HERO)==true then
call SetUnitPosition(target,x,y)
else
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
endif
endif
set t=null
set target=null
return false
endfunction
function EL4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local integer level=GetUnitAbilityLevel(hero,'A19V')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function EK4))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(137),((Atan2(GetUnitY(target)-G5I,GetUnitX(target)-G4I))*1.0))
call SaveReal(LY,(handle_id),(138),((QDI((400-QNI(G4I,G5I,GetUnitX(target),GetUnitY(target))),10)/10)*1.0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(target))*1.0))
set hero=null
set target=null
set t=null
call Damage(GOI,GetEnumUnit(),1,G3I*75)
endfunction
function EM4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real a=(LoadReal(LY,(handle_id),(137)))
local group g=NTI()
local unit target
local real x=GetUnitX(dummy)
local real y=GetUnitY(dummy)
local real EN4=(LoadReal(LY,(handle_id),(6)))
local real ES4=(LoadReal(LY,(handle_id),(7)))
set x=PTI(x+36*Cos(a))
set y=PUI(y+36*Sin(a))
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
set GK=dummy
call GroupEnumUnitsInRange(g,x,y,125,Condition(function CE1))
set target=FirstOfGroup(g)
call NSI(g)
if QNI(x,y,EN4,ES4)<40 or GetTriggerEvalCount(t)>100 then
set target=null
set x=EN4
set y=ES4
set GOI=hero
set G3I=(LoadInteger(LY,(handle_id),(5)))
set G2I=target
if target==null then
set G4I=x
set G5I=y
else
set G4I=GetUnitX(target)
set G5I=GetUnitY(target)
endif
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,400,Condition(function CE1))
if target!=null then
call GroupRemoveUnit(g,target)
call DD1(hero,target,0.3)
call Damage(GOI,target,1,G3I*75)
endif
call ForGroup(g,function EL4)
call KillUnit(dummy)
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set dummy=null
set hero=null
set g=null
return false
endfunction
function ET4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A19V')
local unit dummy
call RemoveLocation(point)
set dummy=CreateUnit(GetOwningPlayer(hero),'h0ED',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call TriggerRegisterTimerEvent(t,0.04,true)
call TriggerAddCondition(t,Condition(function EM4))
set hero=null
set dummy=null
set point=null
set t=null
endfunction
function ER4 takes nothing returns boolean
if GetSpellAbilityId()=='A19V' then
call ET4()
endif
return false
endfunction
function TN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ER4))
set t=null
endfunction
function EP4 takes nothing returns nothing
local unit hero=G6I
local unit JMO=GetEnumUnit()
local unit target
local group g
if GetUnitCurrentOrder(JMO)==0 then
set g=NTI()
set GK=JMO
call GroupEnumUnitsInRange(g,GetUnitX(JMO),GetUnitY(JMO),825,Condition(function CA1))
set target=FirstOfGroup(g)
if target!=null then
call GroupRemoveUnit(g,target)
endif
if FirstOfGroup(g)==null and target==hero then
call IssueTargetOrder(JMO,"attack",target)
endif
call NSI(g)
set target=null
set g=null
endif
set hero=null
set JMO=null
endfunction
function EQ4 takes unit hero returns nothing
local group g=NTI()
set GK=hero
set G6I=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1000,Condition(function DA1))
call ForGroup(g,function EP4)
call NSI(g)
set g=null
endfunction
function EU4 takes nothing returns nothing
call Damage(G6I,GetEnumUnit(),1,G9I*10)
endfunction
function F04 takes unit hero,integer handle_id,integer NPI returns nothing
local group g1=NTI()
local group g2=NTI()
local integer i=0
set GK=hero
loop
exitwhen i>NPI
call GroupEnumUnitsInRange(g2,(LoadReal(LY,(handle_id),(2300+i))),(LoadReal(LY,(handle_id),(2500+i))),225,Condition(function CA1))
call GroupAddGroup(g2,g1)
call GroupClear(g2)
set i=i+1
endloop
call NSI(g2)
if FirstOfGroup(g1)!=null then
set G6I=hero
set G9I=GetUnitAbilityLevel(hero,'A19Z')
set G7I=CreateUnit(GetOwningPlayer(hero),'e00E',0,0,0)
call AddSkill(G7I,'A19U')
call SetUnitAbilityLevel(G7I,'A19U',G9I)
call ForGroup(g1,function EU4)
endif
call NSI(g1)
set g1=null
set g2=null
endfunction
function FI4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer i
local real x
local real y
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>360 then
set i=0
loop
exitwhen i>NPI
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(2700+i))))
set i=i+1
endloop
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set x=GetUnitX(hero)
set y=GetUnitY(hero)
if C2==true then
call EQ4(hero)
endif
if QNI(x,y,II3,I13)>125 then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
call SaveEffectHandle(LY,(handle_id),(2700+NPI),(AddSpecialEffect("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",x,y)))
call SaveReal(LY,(handle_id),(2300+NPI),((x)*1.0))
call SaveReal(LY,(handle_id),(2500+NPI),((y)*1.0))
endif
if ModuloInteger(GetTriggerEvalCount(t),10)==0 then
set G8I=true
call F04(hero,handle_id,NPI)
set G8I=false
endif
call UPI(GetUnitX(hero),GetUnitY(hero),100)
endif
return false
endfunction
function F14 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function FI4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveEffectHandle(LY,(handle_id),(2700),(AddSpecialEffect("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",GetUnitX(hero),GetUnitY(hero))))
call SaveReal(LY,(handle_id),(23),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(2300),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(2500),((GetUnitY(hero))*1.0))
set hero=null
set t=null
endfunction
function FO4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if IsUnitDead(hero)then
return false
endif
if GetUnitTypeId(hero)=='O016' then
call SetUnitFlyHeight(hero,170,0)
elseif GetUnitTypeId(hero)=='O017' then
call SetUnitFlyHeight(hero,220,0)
endif
set t=null
set hero=null
return false
endfunction
function F24 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,2,true)
call TriggerAddCondition(t,Condition(function FO4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function F34 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
call SetTerrainPathable(x,y,PATHING_TYPE_WALKABILITY,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function F44 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
call SetTerrainPathable(x,y,PATHING_TYPE_WALKABILITY,true)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function F34))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set hero=null
set t=null
endfunction
function F54 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A19Z' then
if GetUnitTypeId(GetTriggerUnit())=='O016' then
call F14()
elseif IsTerrainPathable(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),PATHING_TYPE_WALKABILITY)then
call F44()
endif
endif
else
if GetLearnedSkill()=='A19Z' and GetUnitAbilityLevel(GetTriggerUnit(),'A19Z')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call F24()
endif
endif
return false
endfunction
function TS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function F54))
set t=null
endfunction
function F64 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real d=QNI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
local real a
local real DC1=(LoadReal(LY,(handle_id),(57)))
local real x0=(LoadReal(LY,(handle_id),(282)))
local real y0=(LoadReal(LY,(handle_id),(283)))
local real x1
local real y1
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>R2I(20*DC1)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
call SetUnitPathing(target,true)
call BP1(hero)
call UPI(GetUnitX(target),GetUnitY(target),175)
else
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
if QNI(x0,y0,GetUnitX(hero),GetUnitY(hero))>400 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
call SetUnitPathing(target,true)
call BP1(hero)
call UPI(GetUnitX(target),GetUnitY(target),175)
else
call SaveReal(LY,(handle_id),(282),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(283),((GetUnitY(hero))*1.0))
if d>300 then
set a=Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero))
set x1=GetUnitX(hero)+300*Cos(a)
set y1=GetUnitY(hero)+300*Sin(a)
if(IsPointInRegion(LN,((x1)*1.0),((y1)*1.0)))==false then
call MUSetUnitX(target,x1)
call MUSetUnitY(target,y1)
endif
endif
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function F74 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'u00Y',GetUnitX(hero),GetUnitY(hero),0)
local integer level=GetUnitAbilityLevel(hero,'A19O')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1MV')+2
endif
call AddSkill(dummy,'A19N')
call SetUnitAbilityLevel(dummy,'A19N',GetUnitAbilityLevel(hero,'A19O'))
call IssueTargetOrder(dummy,"magicleash",target)
call SetUnitPathing(dummy,false)
call SetUnitPathing(target,false)
call BT1(hero)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function F64))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(57),((2.5+level*0.5)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\AerialShackles\\AerialShacklesTarget.mdl",target,"chest")))
call SaveReal(LY,(handle_id),(282),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(283),((GetUnitY(hero))*1.0))
set t=null
set hero=null
set target=null
set dummy=null
endfunction
function F84 takes nothing returns boolean
if(GetSpellAbilityId()=='A19O' or GetSpellAbilityId()=='A1MV')and CanResistSkill(GetSpellTargetUnit())==false and GetUnitTypeId(GetSpellTargetUnit())!='n00L' then
call F74()
endif
return false
endfunction
function TT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function F84))
set t=null
endfunction
function F94 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real d=SquareRoot((II3-x)*(II3-x)+(I13-y)*(I13-y))
local real VZ3=0.2*level*d
local integer KO2=(LoadInteger(LY,(handle_id),(25)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call UnitRemoveAbility(target,'A0IH')
call UnitRemoveAbility(target,'B08L')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endif
if d>1300 then
set VZ3=0
endif
if VZ3>5 then
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",target,"origin"))
endif
if((LoadInteger(LY,(GetHandleId((target))),((2485))))==1)and VZ3>=GetUnitState(target,UNIT_STATE_LIFE)-2 then
set VZ3=GetUnitState(target,UNIT_STATE_LIFE)-2
endif
if RYI(target)then
set VZ3=0
endif
if VZ3>0 and IsUnitDead(target)==false and BL1(target)==false then
call Damage(hero,target,6,VZ3)
endif
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
call SaveInteger(LY,(handle_id),(25),(KO2+1))
if IsUnitDead(target)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif KO2>4*(12)then
call UnitRemoveAbility(target,'A0IH')
call UnitRemoveAbility(target,'B08L')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function FA4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A0LH')
local real PAI=50+100*level
call AddSkill(target,'A0IH')
call SetUnitAbilityLevel(target,'A0IH',level)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",target,"chest"))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call SaveInteger(LY,(handle_id),(25),(0))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function F94))
call TriggerRegisterDeathEvent(t,target)
set hero=null
set target=null
set t=null
endfunction
function FB4 takes nothing returns boolean
if GetSpellAbilityId()=='A0LH' and CanResistSkill(GetSpellTargetUnit())==false then
call FA4()
endif
return false
endfunction
function KC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FB4))
set t=null
endfunction
function FC4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real H71=(LoadReal(LY,(handle_id),(6)))
local real H81=(LoadReal(LY,(handle_id),(7)))
call H61(hero,H71,H81,H21(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
set t=null
set hero=null
return false
endfunction
function FD4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer i=0
local player p
loop
exitwhen i>5
set p=BO[i]
if GGI[GetPlayerId(p)]==null or IsPlayerAlly(GetOwningPlayer(hero),p)==true or BM1(GGI[GetPlayerId(p)])then
call MUSetUnitX(GFI[GetPlayerId(p)],P4I(hero))
call MUSetUnitY(GFI[GetPlayerId(p)],P5I(hero))
else
if IsUnitVisible(GGI[GetPlayerId(p)],GetOwningPlayer(hero))==false then
call KillUnit(CreateUnit(GetOwningPlayer(hero),'o02C',GetUnitX(GGI[GetPlayerId(p)]),GetUnitY(GGI[GetPlayerId(p)]),0))
endif
call MUSetUnitX(GFI[GetPlayerId(p)],GetUnitX(GGI[GetPlayerId(p)]))
call MUSetUnitY(GFI[GetPlayerId(p)],GetUnitY(GGI[GetPlayerId(p)]))
endif
set p=CO[i]
if GGI[GetPlayerId(p)]==null or IsPlayerAlly(GetOwningPlayer(hero),p)==true or BM1(GGI[GetPlayerId(p)])then
call MUSetUnitX(GFI[GetPlayerId(p)],P4I(hero))
call MUSetUnitY(GFI[GetPlayerId(p)],P5I(hero))
else
if IsUnitVisible(GGI[GetPlayerId(p)],GetOwningPlayer(hero))==false then
call KillUnit(CreateUnit(GetOwningPlayer(hero),'o02C',GetUnitX(GGI[GetPlayerId(p)]),GetUnitY(GGI[GetPlayerId(p)]),0))
endif
call MUSetUnitX(GFI[GetPlayerId(p)],GetUnitX(GGI[GetPlayerId(p)]))
call MUSetUnitY(GFI[GetPlayerId(p)],GetUnitY(GGI[GetPlayerId(p)]))
endif
set i=i+1
endloop
set p=null
set t=null
set hero=null
return false
endfunction
function FE4 takes unit target,player p,boolean ZXO returns nothing
if ZXO then
set GGI[GetPlayerId(GetOwningPlayer(target))]=target
else
set GGI[GetPlayerId(GetOwningPlayer(target))]=null
endif
endfunction
function FF4 takes nothing returns nothing
local unit dummy
if BU1(GetEnumUnit())==false then
call UnitRemoveAbility(GetEnumUnit(),'Bdet')
call FE4(GetEnumUnit(),GetOwningPlayer(GDI),true)
else
call FE4(GetEnumUnit(),GetOwningPlayer(GDI),true)
if GetUnitAbilityLevel(GetEnumUnit(),'Bdet')==0 and GetUnitAbilityLevel(GetEnumUnit(),'B00T')==0 and GetUnitAbilityLevel(GetEnumUnit(),'B00L')==0 then
set dummy=CreateUnit(GetOwningPlayer(GDI),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call UnitAddAbility(dummy,'A2VW')
call IssueImmediateOrderById(dummy,852625)
set dummy=null
endif
endif
endfunction
function FG4 takes nothing returns nothing
local real JC3=0.3
if IsUnitDead(GDI)==true or IsUnitInGroup(GetEnumUnit(),GCI)==false or GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)/GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)>JC3 or(GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)/GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)>JC3/2 and BU1(GetEnumUnit())==true)then
call GroupRemoveUnit(GBI,GetEnumUnit())
call FE4(GetEnumUnit(),GetOwningPlayer(GDI),false)
call UnitRemoveAbility(GetEnumUnit(),'Bdet')
endif
endfunction
function FH4 takes nothing returns nothing
local real JC3
if IsUnitDead(GDI)==false and IsUnitInGroup(GetEnumUnit(),GBI)==false and IsUnitIllusion(GetEnumUnit())==false then
set JC3=0.3
if GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)/GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)<JC3 then
call GroupAddUnit(GBI,GetEnumUnit())
endif
endif
endfunction
function FZ4 takes nothing returns nothing
local real JC3
if IsUnitDead(GDI)==false and IsUnitIllusion(GetEnumUnit())==false then
set GZI=GZI+1
set GHI=GHI+(GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)/GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE))
endif
endfunction
function FV4 takes unit hero,integer E01 returns nothing
local integer i=1
if E01==0 then
call UnitRemoveAbility(hero,'B05R')
call G21(hero,0)
else
call G21(hero,E01*5)
endif
set i=1
loop
exitwhen i>20
if i!=E01 then
call UnitRemoveAbility(hero,GAI[i])
elseif GetUnitAbilityLevel(hero,GAI[i])==0 then
call UnitRemoveAbility(hero,'B05R')
call UnitAddAbility(hero,GAI[i])
endif
set i=i+1
endloop
endfunction
function FW4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group FX4=(LoadGroupHandle(LY,(handle_id),(22)))
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A0I8')
local integer E01=0
local real FY4
local real FJ4=0
set GK=hero
set GDI=hero
set GBI=FX4
set GEI=level
set GHI=0
set GZI=0
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),25+25000,Condition(function DO1))
call ForGroup(g,function FZ4)
call NSI(g)
if GZI>0 then
set FY4=GZI-GHI
set FJ4=(FY4*level*10)
set E01=IMinBJ(R2I(FJ4/5),20)
endif
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),25+25000,Condition(function DO1))
call ForGroup(g,function FH4)
set GCI=g
call ForGroup(GBI,function FG4)
call ForGroup(GBI,function FF4)
if E01==0 then
call FV4(hero,E01)
call SaveInteger(LY,(GetHandleId(hero)),(814),(0))
else
call FV4(hero,E01)
call SaveInteger(LY,(GetHandleId(hero)),(814),(E01))
endif
if E01<5 then
call UnitRemoveAbility(hero,'A214')
else
call AddSkill(hero,'A214')
endif
call NSI(g)
set t=null
set hero=null
set g=null
set FX4=null
return false
endfunction
function FK4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local player p
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function FW4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.04,true)
call TriggerAddCondition(t,Condition(function FD4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.005,true)
call TriggerAddCondition(t,Condition(function FC4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
set p=BO[1]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=BO[2]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=BO[3]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=BO[4]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=BO[5]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=CO[1]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=CO[2]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=CO[3]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=CO[4]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set p=CO[5]
set GFI[GetPlayerId(p)]=CreateUnit(GetOwningPlayer(hero),'o02B',P4I(hero),P5I(hero),0)
set GGI[GetPlayerId(p)]=null
set t=null
set hero=null
endfunction
function FL4 takes nothing returns boolean
if GetLearnedSkill()=='A0I8' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0I8')==1 then
call FK4()
endif
return false
endfunction
function KA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function FL4))
set GAI[1]='A2U8'
set GAI[2]='A20W'
set GAI[3]='A2U9'
set GAI[4]='A2U6'
set GAI[5]='A2U7'
set GAI[6]='A2UC'
set GAI[7]='A2UD'
set GAI[8]='A2UA'
set GAI[9]='A2UB'
set GAI[10]='A20Z'
set GAI[11]='A2UF'
set GAI[12]='A2UE'
set GAI[13]='A2UG'
set GAI[14]='A2UH'
set GAI[15]='A20X'
set GAI[16]='A2UL'
set GAI[17]='A2UL'
set GAI[18]='A20Y'
set GAI[19]='A2UJ'
set GAI[20]='A2UI'
set t=null
endfunction
function FM4 takes nothing returns nothing
call Damage(GVI,GetEnumUnit(),1,80+40*GWI)
endfunction
function FN4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A2X9')
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
local group g=NTI()
call AddSkill(dummy,'A30A')
call SetUnitAbilityLevel(dummy,'A30A',level)
call IssuePointOrder(dummy,"silence",x,y)
set GK=hero
set GVI=hero
set GWI=level
call GroupEnumUnitsInRange(g,x,y,600+25,Condition(function CA1))
call ForGroup(g,function FM4)
call IO1(OG,x,y)
call NSI(g)
call DestroyEffect(AddSpecialEffect(GXI,x,y))
call DestroyEffect(AddSpecialEffect(GXI,x+200,y))
call DestroyEffect(AddSpecialEffect(GXI,x+200,y-200))
call DestroyEffect(AddSpecialEffect(GXI,x+200,y+200))
call DestroyEffect(AddSpecialEffect(GXI,x-200,y-200))
call DestroyEffect(AddSpecialEffect(GXI,x,y+200))
call DestroyEffect(AddSpecialEffect(GXI,x-200,y+200))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function FS4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call I41(GetOwningPlayer(hero),3,x,y,600)
call TriggerRegisterTimerEvent(t,3,false)
call TriggerAddCondition(t,Condition(function FN4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call DestroyEffect(AddSpecialEffect("war3mapImported\\Bloodrite.mdx",x,y))
call IO1(IG,x,y)
set t=null
set hero=null
endfunction
function FT4 takes nothing returns boolean
if GetSpellAbilityId()=='A2X9' then
call FS4()
endif
return false
endfunction
function K91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FT4))
set t=null
endfunction
function FR4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A311')
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GYI and(target==GetEventDamageSource()or target==GetTriggerUnit())then
set GYI=false
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,GetEventDamage()*(20+5*level)/100)
set GYI=true
endif
elseif GetTriggerEventId()==EVENT_UNIT_DEATH then
if GetKillingUnit()==target or GetTriggerUnit()==target then
call SetUnitState(GetKillingUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_LIFE)*0.25+GetUnitState(GetKillingUnit(),UNIT_STATE_LIFE))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\VampiricAura\\VampiricAuraTarget.mdl",GetKillingUnit(),"origin"))
elseif GetOwningPlayer(GetKillingUnit())==GetOwningPlayer(target)and GetUnitAbilityLevel(GetKillingUnit(),'A04R')>0 then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_MAX_LIFE)*0.25+GetUnitState(target,UNIT_STATE_LIFE))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\VampiricAura\\VampiricAuraTarget.mdl",target,"origin"))
endif
if GetTriggerUnit()==target then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function FP4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A311')
local unit u
call TriggerRegisterTimerEvent(t,8+level,false)
call TriggerAddCondition(t,Condition(function FR4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\TrollBerserk\\HeadhunterWEAPONSLeft.mdl",target,"hand,right")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\TrollBerserk\\HeadhunterWEAPONSLeft.mdl",target,"hand,left")))
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function CO1))
loop
set u=FirstOfGroup(g)
exitwhen u==null
call GroupRemoveUnit(g,u)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_DEATH)
endloop
call NSI(g)
set u=null
set t=null
set hero=null
set target=null
set g=null
endfunction
function FQ4 takes nothing returns boolean
if GetSpellAbilityId()=='A311' and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true then
if IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==false or CanResistSkill(GetSpellTargetUnit())==false then
call FP4()
endif
endif
return false
endfunction
function FU4 takes nothing returns boolean
if GetSpellAbilityId()=='A311' and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and GetSpellTargetUnit()!=GetTriggerUnit()and IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
return false
endfunction
function KB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function FU4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FQ4))
set t=null
endfunction
function G04 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit GI4
local integer handle_id=GetHandleId(hero)
local integer level=GetUnitAbilityLevel(hero,'A2ZS')
local integer G14=(LoadInteger(LY,(handle_id),(279)))
local unit GO4=(LoadUnitHandle(LY,(handle_id),(1400+1)))
local integer x=1
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(830)))
if JGO>0 then
set GI4=CreateUnit(GetOwningPlayer(hero),'o003',GetSpellTargetX(),GetSpellTargetY(),GetRandomReal(0,360))
set G14=G14+1
call SaveUnitHandle(LY,(handle_id),(1400+G14),(GI4))
call SetUnitAbilityLevel(GI4,'A0BF',level)
if(G14>level*2)then
call KillUnit(GO4)
loop
exitwhen x==G14
call SaveUnitHandle(LY,(handle_id),(1400+x),((LoadUnitHandle(LY,(handle_id),(1400+x+1)))))
set x=x+1
endloop
set G14=G14-1
endif
call SaveInteger(LY,(handle_id),(279),(G14))
call UnitRemoveAbility(hero,GJI[JGO])
set JGO=JGO-1
call SaveInteger(LY,(GetHandleId(hero)),(830),(JGO))
call AddSkill(hero,GJI[JGO])
else
call PZI(GetOwningPlayer(GetTriggerUnit()),"无可用次数")
endif
set hero=null
set GI4=null
set GO4=null
endfunction
function G24 takes nothing returns boolean
if GetSpellAbilityId()=='A2ZU' or GetSpellAbilityId()=='A2ZX' or GetSpellAbilityId()=='A2ZW' or GetSpellAbilityId()=='A2ZT' or GetSpellAbilityId()=='A2ZV' then
call G04()
endif
return false
endfunction
function G34 takes unit G44 returns nothing
local integer handle_id=GetHandleId(G44)
local integer level=GetUnitAbilityLevel(G44,'A2ZS')
local integer G14=(LoadInteger(LY,(handle_id),(279)))
local integer x=1
local unit GV2
loop
exitwhen x>G14
set GV2=(LoadUnitHandle(LY,(handle_id),(1400+x)))
call SetUnitAbilityLevel(GV2,'A0BF',level)
set x=x+1
endloop
endfunction
function G54 takes nothing returns boolean
return GetLearnedSkill()=='A2ZS' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function G64 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit G44=(LoadUnitHandle(LY,(handle_id),(366)))
local integer G74=GetHandleId(K1[GetPlayerId(GetOwningPlayer(G44))])
local integer G14=(LoadInteger(LY,(G74),(279)))
local integer x=1
local boolean G84=false
local player G94
local boolean GA4=false
local integer level=GetUnitAbilityLevel(K1[GetPlayerId(GetOwningPlayer(G44))],'A2ZS')
local integer GB4='A304'
if level==2 then
set GB4='A305'
elseif level==3 then
set GB4='A303'
elseif level==4 then
set GB4='A302'
endif
if G44==null then
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
else
if(LoadReal(LY,(GetHandleId(G44)),(785)))+6>(TimerGetElapsed(M))then
set GA4=true
endif
loop
exitwhen x>G14 or G84==true
set G84=IsUnitInRange(G44,(LoadUnitHandle(LY,(G74),(1400+x))),900)
set x=x+1
endloop
if G84==false then
call UnitRemoveAbility(G44,'B01C')
endif
if IsUnitType(G44,UNIT_TYPE_HERO)==true then
if GetUnitAbilityLevel(G44,'B01C')>0 then
call AddSkill(G44,'A021')
if IsPlayerTeam1(GetOwningPlayer(G44))then
set G94=CO[0]
else
set G94=BO[0]
endif
if GA4==false then
call AddSkill(G44,'Aeth')
call AddSkill(G44,GB4)
call SetPlayerAbilityAvailable(GetOwningPlayer(G44),GB4,false)
call SetUnitPathing(G44,false)
if PQI(GetUnitX(G44))!=GetUnitX(G44)or QII(GetUnitY(G44))!=GetUnitY(G44)then
call MUSetUnitX(G44,PQI(GetUnitX(G44)))
call MUSetUnitY(G44,QII(GetUnitY(G44)))
endif
else
call UnitRemoveAbility(G44,'Aeth')
call UnitRemoveAbility(G44,'A304')
call UnitRemoveAbility(G44,'A305')
call UnitRemoveAbility(G44,'A303')
call UnitRemoveAbility(G44,'A302')
call UnitRemoveAbility(G44,'B0HI')
call SetUnitPathing(G44,true)
call UPI(GetUnitX(G44),GetUnitY(G44),50)
endif
set G94=null
else
call UnitRemoveAbility(G44,'A021')
call UnitRemoveAbility(G44,'Aeth')
call SetUnitPathing(G44,true)
call UnitRemoveAbility(G44,'A304')
call UnitRemoveAbility(G44,'A305')
call UnitRemoveAbility(G44,'A303')
call UnitRemoveAbility(G44,'A302')
call UnitRemoveAbility(G44,'B0HI')
call UPI(GetUnitX(G44),GetUnitY(G44),50)
endif
else
if GetUnitAbilityLevel(G44,'B01C')>0 then
call AddSkill(G44,'A29C')
if GA4==false then
call AddSkill(G44,'Aeth')
call AddSkill(G44,GB4)
call SetPlayerAbilityAvailable(GetOwningPlayer(G44),GB4,false)
call SetUnitPathing(G44,false)
if PQI(GetUnitX(G44))!=GetUnitX(G44)or QII(GetUnitY(G44))!=GetUnitY(G44)then
call MUSetUnitX(G44,PQI(GetUnitX(G44)))
call MUSetUnitY(G44,QII(GetUnitY(G44)))
endif
else
call UnitRemoveAbility(G44,'Aeth')
call UnitRemoveAbility(G44,'A304')
call UnitRemoveAbility(G44,'A305')
call UnitRemoveAbility(G44,'A303')
call UnitRemoveAbility(G44,'A302')
call UnitRemoveAbility(G44,'B0HI')
call SetUnitPathing(G44,true)
endif
else
call UnitRemoveAbility(G44,'A29C')
call UnitRemoveAbility(G44,'Aeth')
call UnitRemoveAbility(G44,'A304')
call UnitRemoveAbility(G44,'A305')
call UnitRemoveAbility(G44,'A303')
call UnitRemoveAbility(G44,'A302')
call UnitRemoveAbility(G44,'B0HI')
call SetUnitPathing(G44,true)
endif
endif
endif
set G44=null
endfunction
function GC4 takes unit G44 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddAction(t,function G64)
call SaveUnitHandle(LY,(handle_id),(366),(G44))
set t=null
endfunction
function GD4 takes nothing returns boolean
if GetUnitTypeId(GetSummonedUnit())=='n01E' or GetUnitTypeId(GetSummonedUnit())=='n019' then
call GC4(GetSummonedUnit())
endif
return false
endfunction
function GE4 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local trigger t
if(GetUnitAbilityLevel(PKI,'A2ZS')==1)then
call GC4(PKI)
else
call G34(PKI)
endif
set PKI=null
endfunction
function GF4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(830)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer NQ3=GetUnitAbilityLevel(hero,'A2ZS')
if JGO<NQ3 then
set NPI=NPI-1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==0 then
call UnitRemoveAbility(hero,GJI[JGO])
set NPI=40
call SaveInteger(LY,(handle_id),(34),(NPI))
set JGO=JGO+1
call SaveInteger(LY,(GetHandleId(hero)),(830),(JGO))
call AddSkill(hero,GJI[JGO])
endif
endif
set t=null
set hero=null
return false
endfunction
function GG4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(hero)),(830),(1))
call AddSkill(hero,GJI[1])
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function GF4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(40))
set hero=null
set t=null
endfunction
function GH4 takes nothing returns boolean
if GetLearnedSkill()=='A2ZS' and IsUnitIllusion(GetTriggerUnit())==false then
if GetUnitAbilityLevel(GetTriggerUnit(),'A2ZS')==1 then
call GG4()
endif
endif
return false
endfunction
function KD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function G54))
call TriggerAddAction(t,function GE4)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function GD4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function G24))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function GH4))
set GJI[0]='A2ZU'
set GJI[1]='A2ZX'
set GJI[2]='A2ZW'
set GJI[3]='A2ZT'
set GJI[4]='A2ZV'
endfunction
function GZ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT or(GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and E31(GetSpellAbilityId())and GetSpellTargetUnit()==SFI)then
if IsUnitDead(SFI)==false then
call UnitRemoveAbility(SFI,'A0WR')
call UnitRemoveAbility(SFI,'B01E')
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
return false
endfunction
function GV4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,14,false)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GZ4))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Items\\VampiricPotion\\VampPotionCaster.mdl",SFI,"origin")))
call AddSkill(SFI,'A0WR')
call SetUnitAbilityLevel(SFI,'A0WR',GetUnitAbilityLevel(SFI,'A0WQ'))
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A0WR',false)
endfunction
function GW4 takes nothing returns boolean
if GetSpellAbilityId()=='A0WQ' then
call GV4()
endif
return false
endfunction
function KE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GW4))
set t=null
endfunction
function GX4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEvalCount(t)>300 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetUnitAbilityLevel(target,'B0E7')>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call Damage(hero,target,1,GetUnitAbilityLevel(hero,'A0BH')*75)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function GY4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerAddCondition(t,Condition(function GX4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function GJ4 takes nothing returns boolean
if GetSpellAbilityId()=='A0BH' then
call GY4()
endif
return false
endfunction
function KF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GJ4))
set t=null
endfunction
function GK4 takes nothing returns boolean
return GetSpellAbilityId()=='A055'
endfunction
function GL4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local integer DC1=(LoadInteger(LY,(handle_id),(188)))
local texttag tt
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetEventDamageSource()==dummy then
set tt=CreateTextTag()
call UYI(I2S(DC1),DC1,target,0.03,127,127,255,255)
call SetTextTagText(tt,"+"+I2S(R2I(PAI)),0.025)
call SetTextTagPosUnit(tt,target,10)
call SetTextTagColor(tt,255,0,0,255)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,2)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,2)
if IsUnitVisible(target,GetLocalPlayer())or P0I(GetLocalPlayer())then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
call Damage(hero,target,1,PAI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
set tt=null
return false
endfunction
function GM4 takes nothing returns nothing
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A055')
local integer GN4
local unit PKI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local location BFO=GetUnitLoc(PKI)
local real PAI
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(PKI),'e00E',GetUnitX(PKI),GetUnitY(PKI),0)
if level==1 then
set GN4=GetRandomInt(1,2)
if GN4==1 then
set PAI=GetRandomReal(100,200)
elseif GN4==2 then
set PAI=GetRandomReal(1,100)
endif
elseif level==2 then
set GN4=GetRandomInt(1,3)
if GN4==1 then
set PAI=GetRandomReal(170,225)
elseif GN4==2 then
set PAI=GetRandomReal(110,170)
elseif GN4==3 then
set PAI=GetRandomReal(50,110)
endif
elseif level==3 then
set GN4=GetRandomInt(1,4)
if GN4==1 then
set PAI=GetRandomReal(195,250)
elseif GN4==2 then
set PAI=GetRandomReal(155,195)
elseif GN4==3 then
set PAI=GetRandomReal(115,155)
elseif GN4==4 then
set PAI=GetRandomReal(75,115)
endif
elseif level==4 then
set GN4=GetRandomInt(2,4)
if GN4==2 then
set PAI=GetRandomReal(225,275)
elseif GN4==3 then
set PAI=GetRandomReal(175,225)
elseif GN4==4 then
set PAI=GetRandomReal(100,175)
endif
endif
call TriggerRegisterTimerEvent(t,10,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function GL4))
call SaveUnitHandle(LY,(handle_id),(2),(PKI))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
if(level==4)then
endif
call SaveInteger(LY,(handle_id),(188),(GN4))
call AddSkill(dummy,'A04U')
call SetUnitAbilityLevel(dummy,'A04U',GN4)
call IssueTargetOrder(dummy,"thunderbolt",target)
set t=null
endfunction
function KZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GK4))
call TriggerAddAction(t,function GM4)
endfunction
function GS4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call G21(hero,0)
set t=null
set hero=null
return false
endfunction
function GT4 takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())==GetUnitTypeId(GNI)and GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GNI)and IsUnitIllusion(GetFilterUnit())==true then
call MUSetUnitX(GetFilterUnit(),GLI)
call MUSetUnitY(GetFilterUnit(),GMI)
call IssueTargetOrder(GetFilterUnit(),"attack",GSI)
endif
return false
endfunction
function GR4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real RM2=UEI(QXI,QYI,QJI,QKI)
local real QWI=QNI(QXI,QYI,QJI,QKI)
local real d=GetRandomReal(QWI*0.3,QWI*0.8)
local integer level=GetUnitAbilityLevel(hero,'A0RW')
local real IV1=QXI+d*Cos(RM2*bj_DEGTORAD)
local real IW1=QYI+d*Sin(RM2*bj_DEGTORAD)
local unit u=CreateUnit(GetOwningPlayer(hero),GKI,IV1,IW1,0)
local unit u2
local group g
local trigger t
local integer handle_id
call MUSetUnitX(hero,IV1)
call MUSetUnitY(hero,IW1)
call SetUnitFacing(hero,-RM2)
call PlaySoundOnUnitBJ(CC,100,target)
if IsUnitEnemy(target,GetOwningPlayer(hero))and GetUnitTypeId(target)!='n00L' then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1.2,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function GS4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
call G21(hero,40+20*level)
set IV1=QXI+(d-25)*Cos(RM2*bj_DEGTORAD)
set IW1=QYI+(d-25)*Sin(RM2*bj_DEGTORAD)
call SCI(target,4405,1)
call MUSetUnitX(target,IV1)
call MUSetUnitY(target,IW1)
call SetUnitFacing(target,RM2)
call IssueTargetOrder(hero,"attack",target)
set g=NTI()
set GLI=IV1
set GMI=IW1
set GNI=hero
set GSI=target
call GroupEnumUnitsInRange(g,QXI,QYI,1400,Condition(function GT4))
call NSI(g)
set u2=CreateUnit(GetOwningPlayer(hero),GKI,IV1,IW1,0)
call KillUnit(u2)
endif
call KillUnit(u)
set hero=null
set target=null
set u=null
set u2=null
set g=null
endfunction
function GP4 takes nothing returns boolean
if GetSpellAbilityId()=='A0RW' then
call GR4()
endif
return false
endfunction
function GQ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit u=CreateUnit(GetOwningPlayer(SFI),GKI,GetUnitX(SFI),GetUnitY(SFI),0)
call PlaySoundOnUnitBJ(CC,100,SFI)
call KillUnit(u)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set u=null
set t=null
set SFI=null
return false
endfunction
function GU4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerAddCondition(t,Condition(function GQ4))
call TriggerRegisterTimerEvent(t,0.3,false)
call SaveUnitHandle(LY,(handle_id),(14),(GetTriggerUnit()))
set t=null
endfunction
function H04 takes nothing returns boolean
if GetSpellAbilityId()=='A0RW' then
call GU4()
endif
return false
endfunction
function KG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GP4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function H04))
set t=null
endfunction
function HI4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call AddSkill(dummy,'A2X7')
call IssueTargetOrderById(dummy,852274,hero)
set t=null
set hero=null
return false
endfunction
function H14 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t
local integer handle_id
if GetRandomInt(0,1)==0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.65,false)
call TriggerAddCondition(t,Condition(function HI4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
set t=null
set hero=null
endfunction
function HO4 takes nothing returns boolean
if GetSpellAbilityId()=='A03O' then
call H14()
endif
return false
endfunction
function KH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HO4))
set t=null
endfunction
function H24 takes nothing returns nothing
local unit hero=GetTriggerUnit()
if GetUnitAbilityLevel(hero,'AHfa')==0 then
call AddSkill(hero,'AHfa')
if GetUnitAbilityLevel(hero,'BOwk')>0 then
call UnitRemoveAbility(hero,'BOwk')
endif
endif
call SetUnitAbilityLevel(hero,'AHfa',GetUnitAbilityLevel(hero,'A2UO'))
set hero=null
endfunction
function H34 takes nothing returns boolean
if GetLearnedSkill()=='A2UO' and IsUnitIllusion(GetTriggerUnit())==false then
call H24()
endif
return false
endfunction
function MJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function H34))
set t=null
endfunction
function H44 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real H54=GetUnitState(hero,UNIT_STATE_LIFE)
call UnitRemoveAbility(hero,'A1R0')
call UnitRemoveAbility(hero,'B0D5')
call G21(hero,0)
call G61(hero,0)
call SetUnitState(hero,UNIT_STATE_LIFE,H54)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function H64 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A04Q')
local real H74=GetUnitState(target,UNIT_STATE_LIFE)
local real H54=GetUnitState(hero,UNIT_STATE_LIFE)
local integer H84=R2I((0.035+0.015*level)*H74)
local integer H94=R2I((0.35+0.15*level)*H74)
call G21(hero,H84)
call G61(hero,H94)
call AddSkill(hero,'A1R0')
call SetUnitState(target,UNIT_STATE_LIFE,1)
call Damage(hero,target,2,20)
call Damage(hero,target,1,20)
call Damage(hero,target,3,20)
call SetUnitState(hero,UNIT_STATE_LIFE,H54+H94)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",target,"chest"))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,35,false)
call TriggerAddCondition(t,Condition(function H44))
set hero=null
set target=null
set t=null
endfunction
function HA4 takes nothing returns boolean
if GetSpellAbilityId()=='A04Q' and GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)>0.5 and RYI(GetSpellTargetUnit())==false then
call H64()
endif
return false
endfunction
function MK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HA4))
set t=null
endfunction
function HB4 takes integer x returns boolean
return x=='A06X' or x=='A0AQ' or x=='A14O' or x=='A0NE' or x=='A14O' or x=='A1C0' or x=='A0SB'
endfunction
function HC4 takes nothing returns boolean
return(GetLearnedSkill()=='A0IF')and(IsUnitIllusion(GetTriggerUnit())==false)
endfunction
function HD4 takes nothing returns boolean
return GetUnitAbilityLevel(GetTriggerUnit(),'B06X')>0 and(TQI(GetSpellAbilityId())or GetSpellAbilityId()=='A0OI')and HB4(GetSpellAbilityId())==false and V81(GetSpellAbilityId())==false
endfunction
function HE4 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit PKI=GetTriggerUnit()
local unit HF4=(LoadUnitHandle(LY,(handle_id),(254)))
local integer AK3=GetUnitAbilityLevel(HF4,'A0IF')
if GetRandomInt(1,100)<=40 and QVI(PKI,HF4,1400)then
call SetUnitState(PKI,UNIT_STATE_MANA,GetUnitState(PKI,UNIT_STATE_MANA)+(0.05+0.05*AK3)*GetUnitState(PKI,UNIT_STATE_MAX_MANA))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\ReplenishManaCasterOverhead.mdl",PKI,"overhead"))
endif
endfunction
function HG4 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local integer AK3=GetUnitAbilityLevel(PKI,'A0IF')
local trigger t
if(AK3==1)then
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HD4))
call TriggerAddAction(t,function HE4)
call SaveUnitHandle(LY,(GetHandleId(t)),(254),(PKI))
endif
if(AK3==1)then
call AddSkill(PKI,'A0OL')
elseif(AK3==2)then
call AddSkill(PKI,'A0OM')
elseif(AK3==3)then
call AddSkill(PKI,'A0ON')
elseif(AK3==4)then
call AddSkill(PKI,'A0OH')
endif
endfunction
function N21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function HC4))
call TriggerAddAction(t,function HG4)
endfunction
function HH4 takes nothing returns boolean
local real d
if GetUnitAbilityLevel(GetTriggerUnit(),'B06Y')>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A0OI')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
call UnitRemoveAbility(GetTriggerUnit(),'B06Y')
set d=0.01*(5+GetUnitAbilityLevel(GetEventDamageSource(),'A0OI'))*(GetUnitState(GetEventDamageSource(),UNIT_STATE_MANA)+100)
if(IsUnitType(GetTriggerUnit(),UNIT_TYPE_SUMMONED)==true or IsUnitIllusion(GetTriggerUnit()))and GetUnitTypeId(GetTriggerUnit())!='n004' and GetUnitTypeId(GetTriggerUnit())!='n018' and GetUnitTypeId(GetTriggerUnit())!='n01C' and GetUnitTypeId(GetTriggerUnit())!='n01G' and GetUnitTypeId(GetTriggerUnit())!='n00U' and GetUnitTypeId(GetTriggerUnit())!='n00Y' and GetUnitTypeId(GetTriggerUnit())!='n00Z' then
set d=d+100*GetUnitAbilityLevel(GetEventDamageSource(),'A0OI')
endif
call UYI("+"+I2S(R2I(d)),1,GetTriggerUnit(),0.023,191,64,255,216)
if(GetRandomInt(1,100)<=GetUnitAbilityLevel(GetEventDamageSource(),'A0IF')*10)and((LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(264)))==false)then
call SetUnitState(GetEventDamageSource(),UNIT_STATE_MANA,GetUnitState(GetEventDamageSource(),UNIT_STATE_MANA)+0.25*GetUnitState(GetEventDamageSource(),UNIT_STATE_MAX_MANA))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\ReplenishManaCasterOverhead.mdl",GetEventDamageSource(),"overhead"))
endif
call DisableTrigger(GetTriggeringTrigger())
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,d)
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function HZ4 takes nothing returns nothing
local trigger t
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
set target=GetSpellTargetUnit()
set hero=GetTriggerUnit()
else
set target=GetTriggerUnit()
set hero=GetAttacker()
endif
if IsUnitIllusion(hero)==false then
set t=CreateTrigger()
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
call SaveBoolean(LY,(GetHandleId(t)),(264),(true))
else
call SaveBoolean(LY,(GetHandleId(t)),(264),(false))
endif
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function HH4))
endif
set t=null
set target=null
set hero=null
endfunction
function HV4 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetUnitAbilityLevel(GetAttacker(),'A0OI')>0 and(LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
call HZ4()
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if(GetIssuedOrderId()==OrderId("poisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(true))
elseif(GetIssuedOrderId()==OrderId("unpoisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(false))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A0OI' then
call HZ4()
endif
return false
endfunction
function HW4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function HV4))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function HX4 takes nothing returns boolean
if GetLearnedSkill()=='A0OI' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0OI')==1 then
call HW4()
endif
return false
endfunction
function N31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function HX4))
set t=null
endfunction
function HY4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer HJ4=(LoadInteger(LY,(handle_id),(262)))
call SetHeroInt(target,GetHeroInt(target,false)+HJ4,true)
call SetHeroInt(hero,GetHeroInt(hero,false)-HJ4,true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function HK4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call SaveInteger(LY,(GetHandleId((target))),((4303)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call SetUnitInvulnerable(target,false)
call PauseUnit(target,false)
call ShowUnit(target,true)
call ClearSelectionForPlayer(GetOwningPlayer(target))
call SelectUnitAddForPlayer(target,GetOwningPlayer(target))
call RemoveSavedHandle(LY,(GetHandleId(hero)),(748))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function HL4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A0OJ')
local integer HJ4=Q9I(GetHeroInt(target,false),1+level*3)
local trigger t
local integer handle_id
local unit dummy=CreateUnit(GetOwningPlayer(target),'o019',GetUnitX(target),GetUnitY(target),0)
call UnitApplyTimedLife(dummy,'BTLF',(level+1))
if(IsUnitEnemy(target,GetOwningPlayer(hero)))==false or CanResistSkill(GetSpellTargetUnit())==false then
call SaveInteger(LY,(GetHandleId((target))),((4303)),(1))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SelectUnitRemoveForPlayer(target,GetOwningPlayer(target))
call SetUnitInvulnerable(target,true)
call PauseUnit(target,true)
call ShowUnit(target,false)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("Abilities\\Spells\\Demon\\DarkConversion\\ZombifyTarget.mdl",GetUnitX(target),GetUnitY(target))))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,level,false)
call TriggerAddCondition(t,Condition(function HK4))
if(IsUnitEnemy(target,GetOwningPlayer(hero)))==true then
call SaveUnitHandle(LY,(GetHandleId(hero)),(748),(target))
call SetHeroInt(target,GetHeroInt(target,false)-HJ4,true)
call SetHeroInt(hero,GetHeroInt(hero,false)+HJ4,true)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(262),(HJ4))
call TriggerRegisterTimerEvent(t,50,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function HY4))
endif
endif
set hero=null
set target=null
set t=null
endfunction
function HM4 takes nothing returns boolean
if GetSpellAbilityId()=='A0OJ' then
call HL4()
endif
return false
endfunction
function HN4 takes nothing returns nothing
if IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))and GetSpellTargetUnit()!=GetTriggerUnit()then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endfunction
function HS4 takes nothing returns boolean
if GetSpellAbilityId()=='A0OJ' then
call HN4()
endif
return false
endfunction
function N41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HM4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function HS4))
set t=null
endfunction
function HT4 takes nothing returns boolean
return GetSpellAbilityId()=='A0OK' or GetSpellAbilityId()=='A1VW'
endfunction
function HR4 takes nothing returns nothing
local unit target=GetEnumUnit()
local unit HF4=GetTriggerUnit()
local integer HP4=GetHeroInt(HF4,true)-GetHeroInt(target,true)
local integer array HQ4
local integer level=GetUnitAbilityLevel(HF4,'A0OK')
local integer HU4=7+1*level
if level==0 then
set level=GetUnitAbilityLevel(HF4,'A1VW')
set HU4=7+1*level+1
endif
set HQ4[1]=10
set HQ4[2]=30
set HQ4[3]=50
if(HP4>0)then
call UnitDamageTarget(HF4,target,HP4*HU4,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
call UYI(I2S(R2I(HP4*HU4)),3,target,0.023,216,30,30,216)
if(HP4<HQ4[level]or GetUnitAbilityLevel(HF4,'A1VW')>0)then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Feedback\\SpellBreakerAttack.mdl",target,"overhead"))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)*.25)
endif
endif
endfunction
function Z04 takes nothing returns boolean
if(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true)then
if(IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit())))then
return true
endif
endif
return false
endfunction
function ZI4 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local integer AK3=GetUnitAbilityLevel(PKI,'A0OK')
local real x=GetLocationX(GetSpellTargetLoc())
local real y=GetLocationY(GetSpellTargetLoc())
local group Z51=NTI()
local integer DJ1=0
local unit Z14=(LoadUnitHandle(LY,(GetHandleId(PKI)),(748)))
if AK3==0 then
set AK3=GetUnitAbilityLevel(PKI,'A1VW')
endif
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosTarget.mdl",x,y))
loop
exitwhen DJ1>=360
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosTarget.mdl",x+(200+AK3*50)*Cos(DJ1*bj_DEGTORAD),y+(200+AK3*50)*Sin(DJ1*bj_DEGTORAD)))
set DJ1=DJ1+45
endloop
call GroupEnumUnitsInRange(Z51,x,y,300+AK3*100,Condition(function Z04))
if Z14!=null and QNI(x,y,GetUnitX(Z14),GetUnitY(Z14))<(300+AK3*100)then
call SetUnitInvulnerable(Z14,false)
call GroupAddUnit(Z51,Z14)
endif
call ForGroup(Z51,function HR4)
if Z14!=null and IsUnitDead(Z14)==false then
call SetUnitInvulnerable(Z14,true)
endif
call NSI(Z51)
endfunction
function N51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HT4))
call TriggerAddAction(t,function ZI4)
endfunction
function ZO4 takes nothing returns nothing
call Damage(GTI,GetEnumUnit(),1,GRI)
endfunction
function Z24 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEvalCount(t)>200 or GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEvalCount(t)>1 and GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A0QG' and GetSpellTargetUnit()==target)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(31))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
set g=NTI()
set GK=hero
set GTI=hero
set GRI=1.0+2.0*GetUnitAbilityLevel(hero,'A0QG')
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),275,Condition(function CA1))
call GroupRemoveUnit(g,target)
call ForGroup(g,function ZO4)
call NSI(g)
set target=null
endif
set t=null
set hero=null
set g=null
return false
endfunction
function Z34 takes nothing returns nothing
local trigger t=CreateTrigger()
local effect fx=AddSpecialEffectTarget("war3mapImported\\NewSoulArmor.mdx",GetSpellTargetUnit(),"chest")
local integer handle_id=GetHandleId(t)
call IO1(TC,GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit()))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(17),(GetSpellTargetUnit()))
call SaveEffectHandle(LY,(handle_id),(31),(fx))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,GetSpellTargetUnit(),EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Z24))
set t=null
set fx=null
endfunction
function Z44 takes nothing returns boolean
if GetSpellAbilityId()=='A0QG' then
call Z34()
endif
return false
endfunction
function NP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Z44))
set t=null
endfunction
function Z54 takes unit u returns boolean
return GetUnitAbilityLevel(u,'B02J')>0 or GetUnitAbilityLevel(u,'BUsp')>0 or GetUnitAbilityLevel(u,'Bust')>0 or PII(u)
endfunction
function Z64 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer level
local unit hero
local unit target
local real x1
local real y1
local real d
local real a
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set target=(LoadUnitHandle(LY,(handle_id),(17)))
set d=(LoadReal(LY,(handle_id),(138)))
set x=(LoadReal(LY,(handle_id),(6)))
set y=(LoadReal(LY,(handle_id),(7)))
set a=(LoadReal(LY,(handle_id),(137)))
set x1=GetUnitX(target)+d/12*Cos(a)
set y1=GetUnitY(target)+d/12*Sin(a)
if IsUnitType(target,UNIT_TYPE_HERO)==true then
call SetUnitPosition(target,x1,y1)
else
call MUSetUnitX(target,x1)
call MUSetUnitY(target,y1)
endif
if GetTriggerEvalCount(t)>19 then
set hero=(LoadUnitHandle(LY,(handle_id),(2)))
set level=(LoadInteger(LY,(handle_id),(5)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call Damage(hero,target,1,level*40)
set hero=null
endif
set target=null
endif
set t=null
return false
endfunction
function Z74 takes nothing returns nothing
local trigger t
local integer handle_id
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
if Z54(target)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function Z64))
call SaveReal(LY,(handle_id),(6),((GPI)*1.0))
call SaveReal(LY,(handle_id),(7),((GQI)*1.0))
call SaveReal(LY,(handle_id),(138),((QNI(GPI,GQI,GetUnitX(target),GetUnitY(target)))*1.0))
call SaveReal(LY,(handle_id),(137),((Atan2(GQI-GetUnitY(target),GPI-GetUnitX(target)))*1.0))
call SaveInteger(LY,(handle_id),(5),(GUI))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set t=null
set hero=null
set target=null
endfunction
function Z84 takes nothing returns nothing
local group g=NTI()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A0QE')
local real r=150+100*level+25
set GK=GetTriggerUnit()
call IO1(FE,x,y)
call DestroyEffect(AddSpecialEffect("war3mapImported\\Star Aura.mdx",x,y))
call GroupEnumUnitsInRange(g,x,y,r,Condition(function CE1))
set GPI=x
set GQI=y
set GUI=level
call ForGroup(g,function Z74)
call UPI(x,y,200)
call RemoveLocation(point)
call NSI(g)
set point=null
set g=null
endfunction
function Z94 takes nothing returns boolean
if GetSpellAbilityId()=='A0QE' then
call Z84()
endif
return false
endfunction
function ZA4 takes nothing returns nothing
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
if UQI(x,y)==false or(IsPointInRegion(LN,((x)*1.0),((y)*1.0)))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"不能在这里使用真空")
endif
call RemoveLocation(point)
set point=null
endfunction
function ZB4 takes nothing returns boolean
if GetSpellAbilityId()=='A0QE' then
call ZA4()
endif
return false
endfunction
function NR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Z94))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function ZB4))
set t=null
endfunction
function ZC4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(target,'B07W')
call UnitRemoveAbility(target,'Bblo')
call UnitRemoveAbility(target,'B062')
call UnitRemoveAbility(target,'B065')
call UnitRemoveAbility(target,'Bcrs')
call UnitRemoveAbility(target,'B016')
call UnitRemoveAbility(target,'B05R')
return false
endfunction
function ZD4 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,GetUnitAbilityLevel(GetTriggerUnit(),'A0R7')*1.5+1.5,false)
call TriggerAddCondition(t,Condition(function ZC4))
call SaveUnitHandle(LY,(GetHandleId(t)),(17),(GetSpellTargetUnit()))
call IO1(UD,GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit()))
call DestroyEffect(AddSpecialEffectTarget("effects\\Surge.mdx",GetSpellTargetUnit(),"origin"))
endfunction
function ZE4 takes nothing returns boolean
if GetSpellAbilityId()=='A0R7' then
call ZD4()
endif
return false
endfunction
function NQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZE4))
set t=null
endfunction
function ZF4 takes boolean CK3 returns boolean
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit ZG4=(LoadUnitHandle(LY,(handle_id),(259)))
local unit target=GetTriggerUnit()
local unit ZH4=CreateUnit(GetOwningPlayer(ZG4),'e01S',GetUnitX(target),GetUnitY(target),0)
local unit SFI=K1[GetPlayerId(GetOwningPlayer(ZG4))]
local integer level=GetUnitAbilityLevel(SFI,'A0QK')
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A21Q')
endif
call SetUnitAbilityLevel(ZG4,'A0QL',level)
set H0I=GetUnitX(target)
set HII=GetUnitY(target)
set H1I=target
if CK3 then
call SetUnitAbilityLevel(ZG4,'A0QL',3+level)
call IssueTargetOrderById(ZG4,852274,target)
call Damage(ZG4,target,1,150)
else
call IssueTargetOrderById(ZG4,852274,target)
call Damage(ZG4,target,1,150)
endif
call UnitApplyTimedLife(ZH4,'BTLF',0.5)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageCaster.mdl",GetUnitX(target),GetUnitY(target)))
set ZG4=null
set target=null
return false
endfunction
function ZZ4 takes nothing returns boolean
local group g
if IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer((LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(259)))))and V51(GetUnitTypeId(GetFilterUnit()))==false then
set g=(LoadGroupHandle(LY,(GetHandleId(GetTriggeringTrigger())),(257)))
if IsUnitInGroup(GetFilterUnit(),g)==false then
call GroupAddUnit(g,GetFilterUnit())
call ZF4(false)
endif
endif
set g=null
return false
endfunction
function ZV4 takes nothing returns boolean
local group g
if IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer((LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(259)))))and V51(GetUnitTypeId(GetFilterUnit()))==false then
set g=(LoadGroupHandle(LY,(GetHandleId(GetTriggeringTrigger())),(257)))
if IsUnitInGroup(GetFilterUnit(),g)==false then
call GroupAddUnit(g,GetFilterUnit())
call ZF4(true)
endif
endif
set g=null
return false
endfunction
function WallOfReplica_FindSource takes nothing returns nothing
if GetPlayerId(GetOwningPlayer(GetEnumUnit()))==UJ then
call GroupAddUnit(XK,GetEnumUnit())
endif
endfunction
function ZW4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call GroupRemoveUnit((LoadGroupHandle(LY,(handle_id),(257))),(LoadUnitHandle(LY,(handle_id),(261))))
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageCaster.mdl",GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit())))
call FlushChildHashtable(LY,(handle_id))
call DisableTrigger(t)
set t=null
return false
endfunction
function ZX4 takes nothing returns boolean
local unit ZG4=GetSummoningUnit()
local unit IYO=GetSummonedUnit()
local integer handle_id=GetHandleId(ZG4)
local integer ZY4=(LoadInteger(LY,(handle_id),(260)))
local trigger t=CreateTrigger()
call SetUnitVertexColor(IYO,255,255,255,100)
call TriggerRegisterUnitEvent(t,IYO,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ZW4))
call SaveGroupHandle(LY,(GetHandleId(t)),(257),((LoadGroupHandle(LY,(handle_id),(257)))))
call SaveUnitHandle(LY,(GetHandleId(t)),(261),(H1I))
set ZY4=ZY4+1
call SaveInteger(LY,(handle_id),(260),(ZY4))
call SaveInteger(LY,(handle_id),(2800+ZY4),(NKI(IYO)))
call SaveTriggerHandle(LY,(handle_id),(2900+ZY4),(t))
call MUSetUnitX(IYO,H0I)
call MUSetUnitY(IYO,HII)
set ZG4=null
set IYO=null
return false
endfunction
function ZJ4 takes nothing returns nothing
call RemoveUnit(GetEnumUnit())
endfunction
function ZK4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer DW3=GetHandleId(t)
local trigger ZL4=(LoadTriggerHandle(LY,(DW3),(255)))
local integer KAO=GetHandleId(ZL4)
local trigger ZM4=(LoadTriggerHandle(LY,(KAO),(256)))
local group ZN4=(LoadGroupHandle(LY,(KAO),(257)))
local group ZS4=(LoadGroupHandle(LY,(KAO),(258)))
local unit ZG4=(LoadUnitHandle(LY,(KAO),(259)))
local integer ZT4=GetHandleId(ZG4)
local integer ZY4=(LoadInteger(LY,(ZT4),(260)))
local integer ZR4
local integer i
local unit u
call ForGroup(ZS4,function ZJ4)
set i=1
loop
exitwhen i>ZY4
set ZR4=(LoadInteger(LY,(ZT4),(2800+i)))
set u=NYI(ZR4)
call FlushChildHashtable(LY,(GetHandleId((LoadTriggerHandle(LY,(ZT4),(2900+i))))))
call FlushTrigger((LoadTriggerHandle(LY,(ZT4),(2900+i))))
if IsUnitIllusion(u)then
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImageCaster.mdl",GetUnitX(u),GetUnitY(u)))
call RemoveUnit(u)
call NXI(ZR4)
endif
set i=i+1
endloop
call FlushChildHashtable(LY,(DW3))
call FlushChildHashtable(LY,(KAO))
call FlushChildHashtable(LY,(ZT4))
call RemoveUnit(ZG4)
call NSI(ZN4)
call NSI(ZS4)
call FlushTrigger(ZL4)
call FlushTrigger(ZM4)
call FlushTrigger(t)
set t=null
set ZL4=null
set ZM4=null
set ZN4=null
set ZS4=null
set ZG4=null
set u=null
return false
endfunction
function ZP4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real ZQ4=GetUnitFacing(SFI)-45
local unit ZG4=CreateUnit(GetOwningPlayer(SFI),'h00O',x,y,ZQ4)
local unit u
local real UJ2
local real UK2
local integer i
local real DJ1
local trigger t=CreateTrigger()
local group g1=NTI()
local integer handle_id=GetHandleId(t)
local group g2=NTI()
local trigger ZL4=t
local integer level=GetUnitAbilityLevel(SFI,'A0QK')
local boolean CK3=false
if level==0 then
set CK3=true
set level=GetUnitAbilityLevel(SFI,'A21Q')
endif
call SetUnitAbilityLevel(ZG4,'A0QL',level)
call IO1(GE,x,y)
call SaveGroupHandle(LY,(handle_id),(257),(g1))
call SaveGroupHandle(LY,(GetHandleId(ZG4)),(257),(g1))
call SaveGroupHandle(LY,(handle_id),(258),(g2))
call SaveUnitHandle(LY,(handle_id),(259),(ZG4))
call SaveInteger(LY,(GetHandleId(ZG4)),(260),(0))
set i=0
loop
exitwhen i>39
set UJ2=x+(500-25*i)*Cos((ZQ4-45)*bj_DEGTORAD)
set UK2=y+(500-25*i)*Sin((ZQ4-45)*bj_DEGTORAD)
set u=CreateUnit(GetOwningPlayer(SFI),'h00P',UJ2,UK2,ZQ4)
call SetUnitPathing(u,false)
call MUSetUnitX(u,UJ2)
call MUSetUnitY(u,UK2)
call GroupAddUnit(g2,u)
call TriggerRegisterUnitInRange(t,u,17,Condition(function N1I))
set i=i+1
endloop
if CK3 then
call TriggerAddCondition(t,Condition(function ZV4))
else
call TriggerAddCondition(t,Condition(function ZZ4))
endif
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,ZG4,EVENT_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function ZX4))
call SaveTriggerHandle(LY,(handle_id),(256),(t))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15*level,false)
call TriggerAddCondition(t,Condition(function ZK4))
call SaveTriggerHandle(LY,(GetHandleId(t)),(255),(ZL4))
call RemoveLocation(point)
set SFI=null
set point=null
set u=null
set t=null
set ZL4=null
set g1=null
set g2=null
set ZG4=null
endfunction
function ZU4 takes nothing returns boolean
if GetSpellAbilityId()=='A0QK' or GetSpellAbilityId()=='A21Q' then
call ZP4()
endif
return false
endfunction
function NU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZU4))
set t=null
endfunction
function V04 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer VI4=(LoadInteger(LY,(handle_id),(29)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
if(LoadBoolean(LY,(handle_id),(276)))==false and GetTriggerUnit()==(LoadUnitHandle(LY,(handle_id),(2)))then
call SaveBoolean(LY,(handle_id),(276),(true))
call SetHeroStr((LoadUnitHandle(LY,(handle_id),(2))),GetHeroStr((LoadUnitHandle(LY,(handle_id),(2))),false)-VI4,true)
elseif(LoadBoolean(LY,(handle_id),(277)))==false and GetTriggerUnit()==(LoadUnitHandle(LY,(handle_id),(17)))then
call SaveBoolean(LY,(handle_id),(277),(true))
call SetHeroStr((LoadUnitHandle(LY,(handle_id),(17))),GetHeroStr((LoadUnitHandle(LY,(handle_id),(17))),false)+VI4,true)
endif
else
if(LoadBoolean(LY,(handle_id),(276)))==false then
call SaveBoolean(LY,(handle_id),(276),(true))
call SetHeroStr((LoadUnitHandle(LY,(handle_id),(2))),GetHeroStr((LoadUnitHandle(LY,(handle_id),(2))),false)-VI4,true)
endif
if(LoadBoolean(LY,(handle_id),(277)))==false then
call SaveBoolean(LY,(handle_id),(277),(true))
call SetHeroStr((LoadUnitHandle(LY,(handle_id),(17))),GetHeroStr((LoadUnitHandle(LY,(handle_id),(17))),false)+VI4,true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
return false
endfunction
function V14 takes nothing returns nothing
local unit hero=HOI
local unit target=GetEnumUnit()
local integer VI4
local integer level=H2I
local trigger t
local integer handle_id
if IsUnitType(target,UNIT_TYPE_HERO)==true and V51(GetUnitTypeId(target))==false then
set VI4=IMinBJ(GetHeroStr(target,false)-1,4)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SetHeroStr(hero,GetHeroStr(hero,false)+VI4,true)
call SetHeroStr(target,GetHeroStr(target,false)-VI4,true)
call TriggerRegisterTimerEvent(t,40,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function V04))
call SaveBoolean(LY,(handle_id),(276),(false))
call SaveBoolean(LY,(handle_id),(277),(false))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(29),(VI4))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.mdl",hero,"origin"))
endif
call Damage(hero,target,1,40*level-20)
set hero=null
set target=null
set t=null
endfunction
function VO4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local group g=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A15S')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h07J',x,y,0)
call DestroyEffect(AddSpecialEffect("effects\\DecayGreen_Groundonly_1.mdx",x,y))
call RemoveLocation(point)
set GK=hero
set HOI=hero
set H2I=level
call GroupEnumUnitsInRange(g,x,y,325+25,Condition(function CE1))
call ForGroup(g,function V14)
call NSI(g)
call KillUnit(dummy)
set hero=null
set point=null
set g=null
set t=null
set dummy=null
endfunction
function V24 takes nothing returns boolean
if GetSpellAbilityId()=='A15S' then
call VO4()
endif
return false
endfunction
function SA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function V24))
set t=null
endfunction
function V34 takes nothing returns nothing
if H6I<=H7I then
set H6I=H6I+1
call GroupAddUnit(H3I,GetEnumUnit())
endif
endfunction
function V44 takes unit hero,unit target returns nothing
call UGI("SPLK",GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target),0.1,0.6,0.44,.9,0.6)
endfunction
function V54 takes nothing returns nothing
local integer PAI=14+4*GetUnitAbilityLevel(H4I,'A0R5')
call SetUnitState(H5I,UNIT_STATE_LIFE,GetUnitState(H5I,UNIT_STATE_LIFE)+PAI)
if GetUnitTypeId(GetEnumUnit())!='n0F5' then
call A41(GetEnumUnit(),PAI)
endif
call V44(GetEnumUnit(),H5I)
endfunction
function V64 takes nothing returns nothing
local integer PAI=14+4*GetUnitAbilityLevel(H4I,'A0R5')
call Damage(H4I,H5I,1,PAI)
if GetUnitTypeId(GetEnumUnit())!='n0F5' then
call A41(GetEnumUnit(),PAI)
endif
call V44(GetEnumUnit(),H5I)
endfunction
function V74 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local group g=NTI()
local integer V84=GetUnitAbilityLevel(SFI,'A0R5')*2+8
set H3I=NTI()
set H6I=0
set H7I=V84
set GK=SFI
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),1300+25,Condition(function D81))
call GroupRemoveUnit(g,SFI)
call GroupRemoveUnit(g,GetSpellTargetUnit())
call ForGroup(g,function V34)
call NSI(g)
set g=H3I
set H5I=GetSpellTargetUnit()
set H4I=SFI
if IsUnitAlly(H5I,GetOwningPlayer(SFI))then
call ForGroup(g,function V54)
else
call ForGroup(g,function V64)
endif
call NSI(g)
set SFI=null
set g=null
endfunction
function V94 takes nothing returns boolean
if GetSpellAbilityId()=='A0R5' and(IsUnitType(GetSpellTargetUnit(),UNIT_TYPE_STRUCTURE)==false or GetOwningPlayer(GetSpellTargetUnit())==GetOwningPlayer(GetTriggerUnit()))then
call V74()
endif
return false
endfunction
function SC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function V94))
set t=null
endfunction
function VA4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit VB4=(LoadUnitHandle(LY,(handle_id),(269)))
local real CV4=GetUnitState(target,UNIT_STATE_LIFE)
local real VC4=GetUnitState(target,UNIT_STATE_MAX_LIFE)
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()==target then
call KillUnit(VB4)
endif
elseif Q2==true then
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call PauseUnit(VB4,true)
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER then
call DisableTrigger(t)
call IssueTargetOrder(VB4,"attack",target)
call EnableTrigger(t)
elseif(CV4<(100*H9I)or CV4/VC4<(0.15+0.05*H9I))and GetUnitAbilityLevel(VB4,'B0AN')==0 then
call IssueTargetOrder(HAI[GetPlayerId(GetOwningPlayer(VB4))],"bloodlust",VB4)
elseif IsUnitVisible(target,GetOwningPlayer(VB4))==false then
if(LoadBoolean(LY,(handle_id),(270)))==true then
if(LoadBoolean(LY,(handle_id),(271)))==true then
if(LoadBoolean(LY,(handle_id),(272)))==true then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(VB4)
else
call SaveBoolean(LY,(handle_id),(272),(true))
endif
else
call SaveBoolean(LY,(handle_id),(271),(true))
endif
else
call SaveBoolean(LY,(handle_id),(270),(true))
endif
else
call SaveBoolean(LY,(handle_id),(270),(false))
call SaveBoolean(LY,(handle_id),(271),(false))
call SaveBoolean(LY,(handle_id),(272),(false))
endif
set t=null
set target=null
set VB4=null
return false
endfunction
function VD4 takes nothing returns boolean
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetEnumUnit()
local unit VB4=CreateUnit(H8I,'n0F5',GetUnitX(target),GetUnitY(target),0)
call IssueTargetOrder(VB4,"attack",target)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,VB4,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,VB4,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,VB4,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,VB4,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function VA4))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(269),(VB4))
call SaveInteger(LY,(handle_id),(5),(H9I))
set t=null
set target=null
set VB4=null
return false
endfunction
function VE4 takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())=='n0F5' and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1 then
call KillUnit(GetFilterUnit())
endif
return false
endfunction
function VF4 takes player p returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,p,Condition(function VE4))
call NSI(g)
set g=null
endfunction
function VG4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit VH4=(LoadUnitHandle(LY,(handle_id),(266)))
local unit VZ4=(LoadUnitHandle(LY,(handle_id),(267)))
local unit VV4=(LoadUnitHandle(LY,(handle_id),(268)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g
local player VE2
if IsPlayerTeam1(GetOwningPlayer(hero))then
set VE2=CO[0]
else
set VE2=BO[0]
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH then
if(LoadBoolean(LY,(handle_id),(265)))then
call I41(VE2,.4,GetUnitX(hero),GetUnitY(hero),600)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(hero,false)
call RemoveUnit(VH4)
call RemoveUnit(VZ4)
call RemoveUnit(VV4)
call VF4(GetOwningPlayer(hero))
else
if IsUnitVisible(hero,VE2)then
call SaveBoolean(LY,(handle_id),(265),(true))
endif
set g=NTI()
set GK=hero
set H8I=GetOwningPlayer(hero)
set H9I=level
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),25+400+200*level,Condition(function C81))
if Q2==false then
call ForGroup(g,function VD4)
endif
call NSI(g)
set g=null
endif
set t=null
set hero=null
set VH4=null
set VZ4=null
set VV4=null
return false
endfunction
function VW4 takes nothing returns nothing
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local unit hero
local real UJ2
local real UK2
local real VX4
local unit VH4
local unit VZ4
local unit VV4
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A15V')
local integer id
if level==1 then
set hero=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'n0FJ',x,y,0)
elseif level==2 then
set hero=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'n0FI',x,y,0)
elseif level==3 then
set hero=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'n0F6',x,y,0)
else
set hero=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'n0FH',x,y,0)
endif
call IO1(TF,x,y)
set id=GetPlayerId(GetOwningPlayer(hero))
if HAI[id]==null then
set HAI[id]=CreateUnit(GetOwningPlayer(hero),'e01V',x,y,0)
call AddSkill(HAI[id],'A176')
endif
call SetUnitPosition(hero,PTI(x),PUI(y))
call UnitApplyTimedLife(hero,'BTLF',10+5*level)
call RemoveLocation(point)
call UPI(x,y,300)
set UJ2=x+200*Cos(0*bj_DEGTORAD)
set UK2=y+200*Sin(0*bj_DEGTORAD)
set VX4=UEI(UJ2,UK2,x,y)
set VH4=CreateUnit(GetOwningPlayer(hero),'h07H',UJ2,UK2,VX4)
call SetUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
call QueueUnitAnimation(VH4,"Stand Work Gold")
set UJ2=x+200*Cos(120*bj_DEGTORAD)
set UK2=y+200*Sin(120*bj_DEGTORAD)
set VX4=UEI(UJ2,UK2,x,y)
set VZ4=CreateUnit(GetOwningPlayer(hero),'h07H',UJ2,UK2,VX4)
call SetUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
call QueueUnitAnimation(VZ4,"Stand Work Gold")
set UJ2=x+200*Cos(240*bj_DEGTORAD)
set UK2=y+200*Sin(240*bj_DEGTORAD)
set VX4=UEI(UJ2,UK2,x,y)
set VV4=CreateUnit(GetOwningPlayer(hero),'h07H',UJ2,UK2,VX4)
call SetUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call QueueUnitAnimation(VV4,"Stand Work Gold")
call SetUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call QueueUnitAnimation(hero,"Stand Work")
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,3,true)
call TriggerAddCondition(t,Condition(function VG4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(266),(VH4))
call SaveUnitHandle(LY,(handle_id),(267),(VZ4))
call SaveUnitHandle(LY,(handle_id),(268),(VV4))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveBoolean(LY,(handle_id),(265),(false))
call TriggerEvaluate(t)
set hero=null
set VH4=null
set VZ4=null
set VV4=null
set point=null
endfunction
function VY4 takes nothing returns boolean
if GetSpellAbilityId()=='A15V' then
call VW4()
endif
return false
endfunction
function SB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VY4))
set t=null
endfunction
function VJ4 takes unit SWI returns boolean
if ES1(SWI,FR0[JL0])!=null then
return true
endif
return false
endfunction
function FleshGolem_ValidCorpse takes nothing returns boolean
if GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==true then
set HBI=HBI+1
endif
return false
endfunction
function VK4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A15J')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A17A',false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function VL4 takes nothing returns nothing
if IsUnitType(GK,UNIT_TYPE_HERO)==true then
if VJ4(HK)then
call SetUnitState(HK,UNIT_STATE_LIFE,GetUnitState(HK,UNIT_STATE_LIFE)+GetUnitState(HK,UNIT_STATE_MAX_LIFE)*0.10)
else
call SetUnitState(HK,UNIT_STATE_LIFE,GetUnitState(HK,UNIT_STATE_LIFE)+GetUnitState(HK,UNIT_STATE_MAX_LIFE)*0.06)
endif
else
if VJ4(HK)then
call SetUnitState(HK,UNIT_STATE_LIFE,GetUnitState(HK,UNIT_STATE_LIFE)+GetUnitState(HK,UNIT_STATE_MAX_LIFE)*0.03)
else
call SetUnitState(HK,UNIT_STATE_LIFE,GetUnitState(HK,UNIT_STATE_LIFE)+GetUnitState(HK,UNIT_STATE_MAX_LIFE)*0.02)
endif
endif
endfunction
function VM4 takes nothing returns boolean
local trigger t2=GetTriggeringTrigger()
local integer KAO=GetHandleId(t2)
local trigger t1=(LoadTriggerHandle(LY,(KAO),(274)))
local integer DW3=GetHandleId(t1)
local unit hero=(LoadUnitHandle(LY,(KAO),(2)))
local unit target
local real d
local real a
local boolean VN4=(LoadBoolean(LY,(KAO),(273)))
if(GetTriggerEventId()==EVENT_UNIT_DEATH and GetTriggerUnit()==hero)or(GetTriggerEventId()!=EVENT_UNIT_DAMAGED and GetTriggerEventId()!=EVENT_UNIT_DEATH)then
call FlushChildHashtable(LY,(DW3))
call FlushChildHashtable(LY,(KAO))
call FlushTrigger(t1)
call FlushTrigger(t2)
elseif GetTriggerEventId()==EVENT_UNIT_DEATH then
if IsUnitIllusion(GetDyingUnit())==false then
call IJ1(GetDyingUnit(),hero,'h07Y',"VL4",600,false)
endif
elseif VN4==false then
set target=GetTriggerUnit()
set d=QLI(hero,target)
if d<775 and GetEventDamage()>4 then
if VJ4(hero)then
set a=25+5*HCI
else
set a=15+5*HCI
endif
if d>200 then
set a=a-15*((d-150)/(775-150))
endif
call SaveBoolean(LY,(KAO),(273),(true))
call Damage(GetEventDamageSource(),GetTriggerUnit(),7,GetEventDamage()*a/100)
call SaveBoolean(LY,(KAO),(273),(false))
endif
endif
set t2=null
set t1=null
set hero=null
set target=null
return false
endfunction
function VS4 takes nothing returns boolean
local trigger t1=GetTriggeringTrigger()
local integer DW3=GetHandleId(t1)
local trigger t2=(LoadTriggerHandle(LY,(DW3),(275)))
local integer KAO=GetHandleId(t2)
local unit target=GetTriggerUnit()
local unit hero=(LoadUnitHandle(LY,(DW3),(2)))
if IsUnitEnemy(hero,GetOwningPlayer(target))==true and IsUnitType(target,UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(target,'A04R')==0 then
if(LoadBoolean(LY,(KAO),(GetHandleId(target))))==false then
call TriggerRegisterUnitEvent(t2,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t2,target,EVENT_UNIT_DEATH)
call SaveBoolean(LY,(KAO),(GetHandleId(target)),(true))
endif
endif
set t1=null
set t2=null
set target=null
set hero=null
return false
endfunction
function VT4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t1=CreateTrigger()
local integer DW3=GetHandleId(t1)
local trigger t2=CreateTrigger()
local integer KAO=GetHandleId(t2)
local trigger t3=CreateTrigger()
local integer ZT4=GetHandleId(t3)
local integer level=GetUnitAbilityLevel(hero,'A15J')
set HCI=level
call TriggerRegisterUnitInRange(t1,hero,750,Condition(function N1I))
call TriggerAddCondition(t1,Condition(function VS4))
call SaveTriggerHandle(LY,(DW3),(275),(t2))
call SaveUnitHandle(LY,(DW3),(2),(hero))
call TriggerRegisterTimerEvent(t2,30,false)
call TriggerRegisterUnitEvent(t2,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t2,Condition(function VM4))
call SaveTriggerHandle(LY,(KAO),(274),(t1))
call SaveUnitHandle(LY,(KAO),(2),(hero))
call SaveBoolean(LY,(KAO),(273),(false))
call TriggerRegisterTimerEvent(t3,0.01,false)
call TriggerAddCondition(t3,Condition(function VK4))
call SaveUnitHandle(LY,(ZT4),(2),(hero))
set hero=null
set t1=null
set t2=null
set t3=null
endfunction
function VR4 takes nothing returns boolean
if GetSpellAbilityId()=='A15J' and GetUnitTypeId(GetTriggerUnit())=='H00R' then
call VT4()
endif
return false
endfunction
function SD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VR4))
call Q1I('A17A')
set t=null
endfunction
function VP4 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),HEI)==false and RKI(GetEnumUnit())==false then
call GroupAddUnit(HEI,GetEnumUnit())
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),HFI,false)
call AX1(GetEnumUnit(),HFI,1,3,'B05Q')
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\SpellShieldAmulet\\SpellShieldCaster.mdl",GetEnumUnit(),"overhead"))
endif
endfunction
function VQ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y2=(LoadReal(LY,(handle_id),(67)))
local real a=(LoadReal(LY,(handle_id),(137)))
local integer NPI=GetTriggerEvalCount(t)
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group g=NTI()
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local integer level=GetUnitAbilityLevel(SFI,'A0LK')
if QNI(x,y,x2,y2)<=HDI then
set x=x2
set y=y2
else
set x=PTI(II3+65*Cos(a*bj_DEGTORAD))
set y=PUI(I13+65*Sin(a*bj_DEGTORAD))
endif
if level==1 then
set HFI='A29A'
elseif level==2 then
set HFI='A299'
elseif level==3 then
set HFI='A29B'
elseif level==4 then
set HFI='A298'
endif
set GK=SFI
set HEI=PR2
call GroupEnumUnitsInRange(g,x,y,325,Condition(function CA1))
call ForGroup(g,function VP4)
call NSI(g)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
call SetUnitPosition(SFI,x,y)
if(x==x2 and y==y2)or NPI>40 then
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
call IssueImmediateOrder(dummy,"thunderclap")
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitAnimation(SFI,"stand")
call SetUnitPathing(SFI,true)
call SetUnitInvulnerable(SFI,false)
if GetUnitTypeId(SFI)=='E02X' then
call SetUnitVertexColor(SFI,255,255,255,255)
else
call SetUnitVertexColor(SFI,0,255,150,255)
endif
call SaveInteger(LY,(GetHandleId((SFI))),((4261)),(2))
endif
set t=null
set SFI=null
set dummy=null
return false
endfunction
function VU4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real x2
local real y2
local real a
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',x1,y1,0)
if GetSpellTargetUnit()==null then
set point=GetSpellTargetLoc()
else
set point=GetUnitLoc(GetSpellTargetUnit())
endif
set x2=GetLocationX(point)
set y2=GetLocationY(point)
set a=UEI(x1,y1,x2,y2)
call RemoveLocation(point)
call SetUnitAnimationByIndex(SFI,0)
call SetUnitPathing(SFI,false)
call SetUnitInvulnerable(SFI,true)
call SetUnitVertexColor(SFI,0,0,0,255)
call SaveInteger(LY,(GetHandleId((SFI))),((4261)),(1))
call SaveReal(LY,(handle_id),(66),((PTI(x2))*1.0))
call SaveReal(LY,(handle_id),(67),((PUI(y2))*1.0))
call SaveReal(LY,(handle_id),(23),((x1)*1.0))
call SaveReal(LY,(handle_id),(24),((y1)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call AddSkill(dummy,'A0LA')
call SetUnitAbilityLevel(dummy,'A0LA',GetUnitAbilityLevel(SFI,'A0LK'))
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function VQ4))
set SFI=null
set point=null
set t=null
set dummy=null
endfunction
function W04 takes nothing returns boolean
if GetSpellAbilityId()=='A0LK' then
call VU4()
endif
return false
endfunction
function KV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function W04))
set t=null
endfunction
function WI4 takes nothing returns boolean
return GetLearnedSkill()=='A0CZ' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function W14 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local real PAI=GetEventDamage()
if(PAI>0)and GetUnitState(PKI,UNIT_STATE_LIFE)>1 and GetUnitAbilityLevel(PKI,'BNdo')==0 then
if(GetRandomInt(1,100)<=(5+(5*GetUnitAbilityLevel(PKI,'A0CZ'))))then
call SetUnitState(PKI,UNIT_STATE_LIFE,GetUnitState(PKI,UNIT_STATE_LIFE)+PAI)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\WingedSerpentMissile\\WingedSerpentMissile.mdl",PKI,"hand,left"))
endif
endif
endfunction
function WO4 takes nothing returns nothing
local trigger t
if GetUnitAbilityLevel(GetTriggerUnit(),'A0CZ')==1 then
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerAddAction(t,function W14)
endif
endfunction
function KX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function WI4))
call TriggerAddAction(t,function WO4)
endfunction
constant function Chronosphere_RawCode takes nothing returns integer
return 'A0J1'
endfunction
constant function Chronosphere_SphereCode takes nothing returns integer
return 'u00L'
endfunction
function W24 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit W34=(LoadUnitHandle(LY,(handle_id),(19)))
local real H71=(LoadReal(LY,(handle_id),(6)))
local real H81=(LoadReal(LY,(handle_id),(7)))
if W34==null or hero==null then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if QLI(hero,W34)<450 then
call SaveInteger(LY,(GetHandleId((hero))),((4423)),(1))
call H61(hero,H71,H81,1000.)
else
call SaveInteger(LY,(GetHandleId((hero))),((4423)),(2))
endif
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
endif
set t=null
set hero=null
set W34=null
return false
endfunction
function W44 takes unit hero,unit W34 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(W34))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call TriggerRegisterTimerEvent(t,0.005,true)
call TriggerAddCondition(t,Condition(function W24))
set t=null
endfunction
function W54 takes nothing returns boolean
if GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(HHI)and GetUnitTypeId(GetFilterUnit())==GetUnitTypeId(HHI)then
call W44(GetFilterUnit(),HGI)
endif
return false
endfunction
function W64 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit W34=(LoadUnitHandle(LY,(handle_id),(19)))
local unit u=GetTriggerUnit()
if W34==null then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set hero=null
set u=null
return false
endif
if GetOwningPlayer(u)==GetOwningPlayer(hero)and GetUnitTypeId(u)==GetUnitTypeId(hero)then
call W44(u,W34)
endif
set hero=null
set W34=null
set u=null
return false
endfunction
function W74 takes nothing returns boolean
return GetSpellAbilityId()==('A0J1')or GetSpellAbilityId()=='A1D7'
endfunction
function W84 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit W34=(LoadUnitHandle(LY,(handle_id),(19)))
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call DestroyTimer(t)
endfunction
function W94 takes unit SWI returns boolean
local integer ID=GetUnitTypeId(SWI)
return ID=='o000' or ID=='o001' or ID=='o00A' or ID=='o00X' or ID=='osp4' or ID=='o008' or ID=='o009' or ID=='ebal' or ID=='e026' or ID=='umtw' or ID=='u00R' or ID=='EC45'
endfunction
function WA4 takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())!=GetOwningPlayer(XO)and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 or W94(GetFilterUnit()))
endfunction
function WB4 takes nothing returns nothing
if GetUnitTypeId(GetEnumUnit())!='EC45' then
call PauseUnit(GetEnumUnit(),true)
call SetUnitTimeScale(GetEnumUnit(),0)
call UnitRemoveAbility(GetEnumUnit(),'BUsl')
call UnitRemoveAbility(GetEnumUnit(),'BUsp')
call UnitRemoveAbility(GetEnumUnit(),'BUst')
call SaveInteger(LY,(GetHandleId((GetEnumUnit()))),((4306)),(1))
endif
endfunction
function WC4 takes nothing returns nothing
if GetUnitTypeId(GetEnumUnit())!='EC45' then
call SaveInteger(LY,(GetHandleId((GetEnumUnit()))),((4306)),(2))
call PauseUnit(GetEnumUnit(),false)
call SetUnitTimeScale(GetEnumUnit(),1)
endif
endfunction
function WD4 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit W34=(LoadUnitHandle(LY,(handle_id),(19)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group WE4=(LoadGroupHandle(LY,(handle_id),(220)))
local integer QX2=(LoadInteger(LY,(handle_id),(28)))
local real QJI=GetUnitX(W34)
local real QKI=GetUnitY(W34)
local boolexpr QL1=Condition(function WA4)
local group H03=NTI()
local integer DC1=35+level*5
if GetUnitAbilityLevel(SFI,'A1D7')>0 then
set DC1=30+level*10
endif
call ForGroup(WE4,function WC4)
set XO=SFI
call GroupEnumUnitsInRange(H03,QJI,QKI,450,QL1)
call GroupClear(WE4)
call GroupAddGroup(H03,WE4)
call ForGroup(H03,function WB4)
call NSI(H03)
set QX2=QX2+1
call SaveInteger(LY,(handle_id),(28),(QX2))
if QX2>DC1 then
if Q2==false then
call ForGroup(WE4,function WC4)
endif
call RemoveUnit(W34)
call NSI(WE4)
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call DestroyTimer(t)
endif
endfunction
function WF4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,('A0J1'))
local location target=GetSpellTargetLoc()
local real QJI=GetLocationX(target)
local real QKI=GetLocationY(target)
local unit W34=CreateUnit(GetOwningPlayer(SFI),('u00L'),QJI,QKI,0)
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
local group WE4=NTI()
local group g
local trigger WG4
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A1D7')
endif
call SaveUnitHandle(LY,(GetHandleId(t)),(19),(W34))
call TimerStart(t,0.8,false,function W84)
set t=CreateTimer()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(19),(W34))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveGroupHandle(LY,(handle_id),(220),(WE4))
call SaveInteger(LY,(handle_id),(28),(0))
call SaveInteger(LY,(handle_id),(5),(level))
call TimerStart(t,0.1,true,function WD4)
call RemoveLocation(target)
set HGI=W34
set HHI=SFI
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,25000,Condition(function W54))
call NSI(g)
set WG4=CreateTrigger()
set handle_id=GetHandleId(WG4)
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(W34))
call TriggerRegisterEnterRectSimple(WG4,GetWorldBounds())
call TriggerAddCondition(WG4,Condition(function W64))
set g=null
set WG4=null
endfunction
function KY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function W74))
call TriggerAddAction(t,function WF4)
endfunction
function WH4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetUnitAbilityLevel(hero,'B0C2')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitTimeScale(hero,1)
call SaveInteger(LY,(GetHandleId((hero))),((4280)),(2))
else
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",hero,"origin"))
endif
set t=null
set hero=null
return false
endfunction
function WZ4 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitTimeScale(hero,0)
call SaveInteger(LY,(GetHandleId((hero))),((4280)),(1))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function WH4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
if((LoadInteger(LY,(GetHandleId((hero))),((4306))))==1)==true then
call Damage(HZI,hero,1,30+10*GetUnitAbilityLevel(HZI,'A081'))
endif
set t=null
endfunction
function WV4 takes nothing returns boolean
if GetUnitAbilityLevel(GetFilterUnit(),'B0C2')>0 and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4280))))==1)==false then
call WZ4(GetFilterUnit())
endif
return false
endfunction
function WW4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=NTI()
set HZI=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),450,Condition(function WV4))
call NSI(g)
set t=null
set hero=null
set g=null
return false
endfunction
function WX4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function WW4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function WY4 takes nothing returns boolean
if GetLearnedSkill()=='A081' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A081')==1 then
call WX4()
endif
return false
endfunction
function KW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function WY4))
set t=null
endfunction
function WJ4 takes unit u,real WK4 returns nothing
local integer d=R2I(WK4)
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
local real VOO
set HWI[0]='A23H'
set HWI[1]='A23K'
set HWI[2]='A23L'
set HWI[3]='A23J'
set HWI[4]='A23I'
set HWI[5]='A23M'
if d<1 then
call UnitRemoveAbility(u,HWI[0])
call UnitRemoveAbility(u,HWI[1])
call UnitRemoveAbility(u,HWI[2])
call UnitRemoveAbility(u,HWI[3])
call UnitRemoveAbility(u,HWI[4])
call UnitRemoveAbility(u,HWI[5])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=5
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call AddSkill(u,HWI[i])
call SetPlayerAbilityAvailable(GetOwningPlayer(u),HWI[i],false)
else
call UnitRemoveAbility(u,HWI[i])
endif
set i=i+1
endloop
endfunction
function WL4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A23G')
local real Z7O=(LoadReal(LY,(GetHandleId(target)),(682)))
local integer NPI=(LoadInteger(LY,(GetHandleId(target)),(683)))-1
call WJ4(target,NPI*level)
call SaveInteger(LY,(GetHandleId(target)),(683),(NPI))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function WM4 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A23G')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=(LoadInteger(LY,(GetHandleId(target)),(683)))+1
call WJ4(target,NPI*level)
call SaveInteger(LY,(GetHandleId(target)),(683),(NPI))
call SaveReal(LY,(GetHandleId(target)),(682),(((TimerGetElapsed(M))+HVI-0.01)*1.0))
call TriggerRegisterTimerEvent(t,HVI,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function WL4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AbsorbMana\\AbsorbManaBirthMissile.mdl",target,"origin"))
set t=null
endfunction
function WN4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
if GetUnitAbilityLevel(target,'A04R')==0 then
call WM4(hero,target)
endif
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function WS4 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function WN4))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function WT4 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4307))))==1)==false then
call SCI(hero,4307,0.3)
call WS4()
endif
endfunction
function WR4 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A23G')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call WT4()
endif
return false
endfunction
function WP4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function WR4))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function WQ4 takes nothing returns boolean
if GetLearnedSkill()=='A23G' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A23G')==1 then
call WP4()
endif
return false
endfunction
function KJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function WQ4))
set t=null
endfunction
function WU4 takes nothing returns nothing
local real X04=QDI(QCI(GetUnitState(GetEnumUnit(),UNIT_STATE_MANA),HJI),0)
local real XI4=X04*0.5
if RKI(GetEnumUnit())==false and X04>0 and PII(GetEnumUnit())==false then
if GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)>(XI4+0.5)then
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)-XI4)
else
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,1)
call Damage(HKI,GetEnumUnit(),1,XI4)
endif
call SetUnitState(GetEnumUnit(),UNIT_STATE_MANA,GetUnitState(GetEnumUnit(),UNIT_STATE_MANA)-X04)
if(IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO))then
call SetUnitState(HKI,UNIT_STATE_MANA,GetUnitState(HKI,UNIT_STATE_MANA)+X04*0.5)
endif
endif
endfunction
function X14 takes unit hero,unit dummy,integer XO4,integer X24 returns nothing
local group g=NTI()
set HKI=hero
set GK=hero
set HJI=XO4*75+25
call GroupEnumUnitsInRange(g,GetUnitX(dummy),GetUnitY(dummy),700,Condition(function CA1))
call ForGroup(g,function WU4)
call NSI(g)
set g=null
endfunction
function X34 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit X44
local real X54=2.9
local real X64=HXI+(HYI-HXI)*NPI/(X54/0.05)
call SetUnitScale(dummy,X64,X64,X64)
if NPI>(X54/0.05)then
call X14(hero,dummy,(LoadInteger(LY,(handle_id),(3000))),(LoadInteger(LY,(handle_id),(3002))))
set X44=CreateUnit(GetOwningPlayer(dummy),'e01O',GetUnitX(dummy),GetUnitY(dummy),0)
call SetUnitTimeScale(X44,0.3)
call RemoveUnit(dummy)
call KillUnit(X44)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set dummy=null
set X44=null
return false
endfunction
function X74 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local location point=GetSpellTargetLoc()
local unit hero=GetTriggerUnit()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e01M',x,y,a*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function X34))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(3000),((LoadInteger(LY,(GetHandleId(hero)),(3000)))))
call SaveInteger(LY,(handle_id),(3001),((LoadInteger(LY,(GetHandleId(hero)),(3001)))))
call SaveInteger(LY,(handle_id),(3002),((LoadInteger(LY,(GetHandleId(hero)),(3002)))))
call RemoveLocation(point)
set t=null
set point=null
set hero=null
endfunction
function X84 takes nothing returns boolean
if GetSpellAbilityId()=='A0VS' then
call X74()
endif
return false
endfunction
function X94 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function X84))
set t=null
endfunction
function XA4 takes unit hero,unit target,integer XO4,integer XB4 returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local unit XC4=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local real XD4=0.5+0.3*XB4
if XB4==7 then
set XD4=2.5
endif
call AddSkill(dummy,'A0XK')
call SetUnitAbilityLevel(dummy,'A0XK',XB4)
call IssueTargetOrder(dummy,"cyclone",target)
call PDI(XC4,target,1,70+(XO4+XO4+XO4)*15.0,XD4)
set dummy=null
set XC4=null
endfunction
function XE4 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false then
call GroupAddUnit(XK,GetEnumUnit())
call XA4(GK,GetEnumUnit(),UJ,IK)
endif
endfunction
function XF4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y2=(LoadReal(LY,(handle_id),(67)))
local real a=(LoadReal(LY,(handle_id),(137)))
local integer XO4=(LoadInteger(LY,(handle_id),(3000)))
local integer XB4=(LoadInteger(LY,(handle_id),(3001)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local real x=GetUnitX(dummy)+25*Cos(a)
local real y=GetUnitY(dummy)+25*Sin(a)
local group XG4=NTI()
local real QWI=QNI(x,y,x2,y2)
if QWI<=30 then
set x=x2
set y=y2
endif
call MUSetUnitX(dummy,PTI(x))
call MUSetUnitY(dummy,PTI(y))
set GK=dummy
set XK=g
set UJ=XO4
set IK=XB4
call GroupEnumUnitsInRange(XG4,x,y,200+25,Condition(function CA1))
call ForGroup(XG4,function XE4)
call NSI(XG4)
if QWI<=30 or GetTriggerEvalCount(t)>125 then
call NSI(g)
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set dummy=null
set g=null
set XG4=null
return false
endfunction
function XH4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local location point=GetSpellTargetLoc()
local unit hero=GetTriggerUnit()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local unit dummy
set x=GetUnitX(hero)
set y=GetUnitY(hero)
set dummy=CreateUnit(GetOwningPlayer(hero),'n01U',x,y,a*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function XF4))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(66),((x+(400+400.0*(LoadInteger(LY,(GetHandleId((hero))),(3000))))*Cos(a))*1.0))
call SaveReal(LY,(handle_id),(67),((y+(400+400.0*(LoadInteger(LY,(GetHandleId((hero))),(3000))))*Sin(a))*1.0))
call SaveInteger(LY,(handle_id),(3000),((LoadInteger(LY,(GetHandleId(hero)),(3000)))))
call SaveInteger(LY,(handle_id),(3001),((LoadInteger(LY,(GetHandleId(hero)),(3001)))))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
call RemoveLocation(point)
set t=null
set point=null
set hero=null
endfunction
function XZ4 takes nothing returns boolean
if GetSpellAbilityId()=='A0VK' then
call XH4()
endif
return false
endfunction
function XV4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XZ4))
call Q3I('A0XK',GetRandomReal(1,25))
set t=null
endfunction
function XW4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(target,'A0VJ')
call UnitRemoveAbility(target,'A109')
if GetUnitAbilityLevel(target,'A0VJ')==0 or GetUnitAbilityLevel(target,'A109')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function XX4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A0VJ')
call UnitRemoveAbility(target,'A109')
if GetUnitAbilityLevel(target,'A0VJ')>0 or GetUnitAbilityLevel(target,'A109')>0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function XW4))
endif
set t=null
set target=null
return false
endfunction
function XY4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer XO4=(LoadInteger(LY,(GetHandleId(SFI)),(3000)))
local integer X24=(LoadInteger(LY,(GetHandleId(SFI)),(3002)))
call AddSkill(target,'A0VJ')
call SetUnitAbilityLevel(target,'A0VJ',XO4)
call AddSkill(target,'A109')
call SetUnitAbilityLevel(target,'A109',X24)
call TriggerRegisterTimerEvent(t,9,false)
call TriggerAddCondition(t,Condition(function XX4))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIsp\\SpeedTarget.mdl",target,"origin")))
set t=null
set SFI=null
set target=null
endfunction
function XJ4 takes nothing returns boolean
if GetSpellAbilityId()=='A0VQ' then
call XY4()
endif
return false
endfunction
function XK4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XJ4))
call Q3I('A0VJ',GetRandomReal(1,25))
call Q3I('A109',GetRandomReal(1,25))
set t=null
endfunction
function XL4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetUnitAbilityLevel(SFI,'B08X')==0 then
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitAbilityLevel(dummy,'A0VH',(LoadInteger(LY,(GetHandleId(SFI)),(3001))))
call MUSetUnitX(dummy,GetUnitX(SFI))
call MUSetUnitY(dummy,GetUnitY(SFI))
endif
set t=null
set dummy=null
set SFI=null
return false
endfunction
function XM4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e01V',GetUnitX(SFI),GetUnitY(SFI),0)
call AddSkill(dummy,'A0VH')
call SetUnitAbilityLevel(dummy,'A0VH',(LoadInteger(LY,(GetHandleId(SFI)),(3001))))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function XL4))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
set SFI=null
endfunction
function XN4 takes nothing returns boolean
if GetSpellAbilityId()=='A0XL' then
call XM4()
endif
return false
endfunction
function XS4 takes unit SFI returns nothing
if GetUnitAbilityLevel(SFI,'A0XL')>0 then
call SetUnitAbilityLevel(SFI,'A0XL',(LoadInteger(LY,(GetHandleId(SFI)),(3000))))
endif
endfunction
function XT4 takes nothing returns boolean
if IsUnitIllusion(GetTriggerUnit())==false then
call XS4(GetTriggerUnit())
endif
return false
endfunction
function XR4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XN4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function XT4))
call Q3I('A0VH',GetRandomReal(1,25))
set t=null
endfunction
function XP4 takes unit hero,unit target,integer XO4 returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A0VT')
call SetUnitAbilityLevel(dummy,'A0VT',XO4)
call IssueTargetOrder(dummy,"drunkenhaze",target)
set dummy=null
endfunction
function XQ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real RS2=(LoadReal(LY,(handle_id),(193)))
local integer XO4=(LoadInteger(LY,(handle_id),(3000)))
local integer XB4=(LoadInteger(LY,(handle_id),(3001)))
local integer MKO=XB4*25/3
local real x
local real y
local integer NPI=GetTriggerEvalCount(t)
if NPI>MKO/3 then
call SaveReal(LY,(handle_id),(193),((RS2*0.98)*1.0))
endif
if NPI>MKO or GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()!=EVENT_UNIT_DEATH then
call XP4(hero,target,XO4)
endif
else
set x=PTI(GetUnitX(target)+RS2*Cos(RM2))
set y=PUI(GetUnitY(target)+RS2*Sin(RM2))
call UPI(x,y,150)
call SetUnitPosition(target,x,y)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function XU4 takes unit hero,unit target,integer XO4,integer XB4,integer X24 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real RM2=Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero))
call Damage(hero,target,1,X24*40)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(193),((6)*1.0))
call SaveInteger(LY,(handle_id),(3000),(XO4))
call SaveInteger(LY,(handle_id),(3001),(XB4))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function XQ4))
set t=null
endfunction
function Y04 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false and RKI(GetEnumUnit())==false then
call GroupAddUnit(XK,GetEnumUnit())
call XU4(GK,GetEnumUnit(),UJ,IK,OK)
endif
endfunction
function YI4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y2=(LoadReal(LY,(handle_id),(67)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local integer XO4=(LoadInteger(LY,(handle_id),(3000)))
local integer XB4=(LoadInteger(LY,(handle_id),(3001)))
local integer X24=(LoadInteger(LY,(handle_id),(3002)))
local real x=GetUnitX(dummy)
local real y=GetUnitY(dummy)
local group g2
if QNI(x,y,x2,y2)<100 then
set x=x2
set y=y2
else
set x=x+33*Cos(a)
set y=y+33*Sin(a)
endif
call MUSetUnitX(dummy,PTI(x))
call MUSetUnitY(dummy,PUI(y))
set g2=NTI()
set GK=dummy
set XK=g
set UJ=XO4
set IK=XB4
set OK=X24
call GroupEnumUnitsInRange(g2,x,y,200,Condition(function CA1))
call ForGroup(g2,function Y04)
call NSI(g2)
if(x==x2 and y==y2)or GetTriggerEvalCount(t)>35 then
set g2=NTI()
set GK=dummy
set XK=g
set UJ=XO4
set IK=XB4
set OK=X24
call GroupEnumUnitsInRange(g2,x,y,250,Condition(function CA1))
call ForGroup(g2,function Y04)
call NSI(g2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
call NSI(g)
endif
set t=null
set dummy=null
set g=null
set g2=null
return false
endfunction
function Y14 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local location point=GetSpellTargetLoc()
local unit hero=GetTriggerUnit()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'n01X',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function YI4))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(66),((GetUnitX(hero)+1000*Cos(a))*1.0))
call SaveReal(LY,(handle_id),(67),((GetUnitY(hero)+1000*Sin(a))*1.0))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
call SaveInteger(LY,(handle_id),(3000),((LoadInteger(LY,(GetHandleId(hero)),(3000)))))
call SaveInteger(LY,(handle_id),(3001),((LoadInteger(LY,(GetHandleId(hero)),(3001)))))
call SaveInteger(LY,(handle_id),(3002),((LoadInteger(LY,(GetHandleId(hero)),(3002)))))
call RemoveLocation(point)
set t=null
set point=null
set hero=null
endfunction
function YO4 takes nothing returns boolean
if GetSpellAbilityId()=='A0VM' then
call Y14()
endif
return false
endfunction
function Y24 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YO4))
call Q3I('A0VT',GetRandomReal(1,25))
set t=null
endfunction
function Y34 takes unit SFI returns real
local integer X24=(LoadInteger(LY,(GetHandleId(SFI)),(3002)))
return(80+X24*35.0)/2
endfunction
function Y44 takes unit SFI returns real
local integer XO4=(LoadInteger(LY,(GetHandleId(SFI)),(3000)))
local integer XB4=(LoadInteger(LY,(GetHandleId(SFI)),(3001)))
local integer X24=(LoadInteger(LY,(GetHandleId(SFI)),(3002)))
return 325+XO4*175.0
endfunction
function Y54 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local real PAI=(LoadReal(LY,(handle_id),(20)))
local effect FX=(LoadEffectHandle(LY,(handle_id),(32)))
local integer NPI=GetTriggerEvalCount(t)
call Damage(hero,target,1,PAI)
if NPI==3 then
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DestroyEffect(FX)
endif
set t=null
set hero=null
set target=null
set FX=null
return false
endfunction
function Y64 takes unit hero,unit target,real PAI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Environment\\SmallBuildingFire\\SmallBuildingFire2.mdl",target,"chest")))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function Y54))
set t=null
endfunction
function Y74 takes nothing returns nothing
call Y64(GK,GetEnumUnit(),AK/5)
call Damage(GK,GetEnumUnit(),1,AK)
endfunction
function Y84 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real a=(LoadReal(LY,(handle_id),(137)))
local integer NPI=GetTriggerEvalCount(t)-26
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real IV1
local real IW1
local unit dummy
local group g
if NPI==1 then
set dummy=CreateUnit(GetOwningPlayer(hero),'e01L',x,y,a*bj_RADTODEG)
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
elseif NPI>1 then
set dummy=(LoadUnitHandle(LY,(handle_id),(19)))
endif
if NPI>0 then
set IV1=PTI(GetUnitX(dummy)+15*Cos(a))
set IW1=PUI(GetUnitY(dummy)+15*Sin(a))
call MUSetUnitX(dummy,IV1)
call MUSetUnitY(dummy,IW1)
if(NPI>1 and ModuloInteger(NPI,10)==0)or NPI==1 then
set g=NTI()
set GK=hero
set AK=Y34(hero)
call GroupEnumUnitsInRange(g,IV1,IW1,300,Condition(function CA1))
call ForGroup(g,function Y74)
call NSI(g)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\NeutralBuildingExplosion\\NeutralBuildingExplosion.mdl",IV1,IW1))
endif
if NPI>Y44(hero)/16.6 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
endif
endif
set t=null
set g=null
set dummy=null
set hero=null
return false
endfunction
function Y94 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local location point=GetSpellTargetLoc()
local unit hero=GetTriggerUnit()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local unit YA4=CreateUnit(GetOwningPlayer(hero),'e01K',x,y,a*bj_RADTODEG)
call SetUnitTimeScale(YA4,0.58)
call UnitApplyTimedLife(YA4,'BTLF',1.75)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function Y84))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call RemoveLocation(point)
set t=null
set point=null
set hero=null
endfunction
function YB4 takes nothing returns boolean
if GetSpellAbilityId()=='A0VN' then
call Y94()
endif
return false
endfunction
function YC4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YB4))
set t=null
endfunction
function YD4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local real Z7O=(LoadReal(LY,(GetHandleId(target)),(3007)))
if Z7O+5<=(TimerGetElapsed(M))then
call UnitRemoveAbility(target,'A0VW')
endif
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function YE4 takes unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(target,'A0VW')
if level==0 then
call AddSkill(target,'A0VW')
endif
call SetUnitAbilityLevel(target,'A0VW',level+1)
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveReal(LY,(GetHandleId(target)),(3007),(((TimerGetElapsed(M)))*1.0))
call TriggerRegisterTimerEvent(t,5,false)
call TriggerAddCondition(t,Condition(function YD4))
set t=null
endfunction
function YF4 takes nothing returns boolean
local real d
if GetUnitAbilityLevel(GetTriggerUnit(),'B091')>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A0VV')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
call UnitRemoveAbility(GetTriggerUnit(),'B091')
call DisableTrigger(GetTriggeringTrigger())
call YE4(GetTriggerUnit())
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function YG4 takes nothing returns nothing
local trigger t
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
set target=GetSpellTargetUnit()
set hero=GetTriggerUnit()
else
set target=GetTriggerUnit()
set hero=GetAttacker()
endif
if IsUnitIllusion(hero)==false then
set t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function YF4))
endif
set t=null
set target=null
set hero=null
endfunction
function YH4 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetUnitAbilityLevel(GetAttacker(),'A0VV')>0 and(LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(3008)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))then
call YG4()
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if(GetIssuedOrderId()==OrderId("poisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(3008),(true))
elseif(GetIssuedOrderId()==OrderId("unpoisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(3008),(false))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A0VV' then
call YG4()
endif
return false
endfunction
function YZ4 takes unit hero returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function YH4))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call SaveBoolean(LY,(GetHandleId(t)),(3008),(true))
set t=null
endfunction
function YV4 takes nothing returns nothing
call KillUnit(GetEnumUnit())
endfunction
function YW4 takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())=='n027' then
return true
endif
return false
endfunction
function YX4 takes player p returns nothing
local group g=NTI()
call GroupEnumUnitsOfPlayer(g,p,Condition(function YW4))
call ForGroup(g,function YV4)
call NSI(g)
set g=null
endfunction
function YY4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit dummy
local integer XB4=(LoadInteger(LY,(GetHandleId(hero)),(3001)))
local integer X24=(LoadInteger(LY,(GetHandleId(hero)),(3002)))
call YX4(GetOwningPlayer(hero))
set dummy=CreateUnit(GetOwningPlayer(hero),'n027',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call SetUnitColor(dummy,GetPlayerColor(BO[0]))
call AddSpecialEffectTarget("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",dummy,"chest")
call UnitApplyTimedLife(dummy,'BTLF',10+10*XB4)
call SetUnitAbilityLevel(dummy,'A0VV',X24)
call YZ4(dummy)
if RW0[GetPlayerId(GetOwningPlayer(hero))]then
call SelectUnitAddForPlayer(dummy,GetOwningPlayer(hero))
endif
if XB4>3 and X24>3 then
set dummy=CreateUnit(GetOwningPlayer(hero),'n027',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call SetUnitColor(dummy,GetPlayerColor(BO[0]))
call AddSpecialEffectTarget("Abilities\\Spells\\Orc\\FeralSpirit\\feralspiritdone.mdl",dummy,"chest")
call UnitApplyTimedLife(dummy,'BTLF',10+10*XB4)
call SetUnitAbilityLevel(dummy,'A0VV',X24)
call YZ4(dummy)
if RW0[GetPlayerId(GetOwningPlayer(hero))]then
call SelectUnitAddForPlayer(dummy,GetOwningPlayer(hero))
endif
endif
call SetPlayerTechResearched(GetOwningPlayer(hero),'R00G',X24)
call SetPlayerTechResearched(GetOwningPlayer(hero),'R00H',XB4)
set hero=null
set dummy=null
endfunction
function YJ4 takes nothing returns boolean
if GetSpellAbilityId()=='A0VO' then
call YY4()
endif
return false
endfunction
function YK4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YJ4))
call Q3I('A0VV',GetRandomReal(1,25))
call Q3I('A0VW',GetRandomReal(1,25))
set t=null
endfunction
function YL4 takes unit hero returns integer
local integer level=(LoadInteger(LY,(GetHandleId(hero)),(3001)))
if level==1 then
return 'A230'
elseif level==2 then
return 'A22Z'
elseif level==3 then
return 'A22Y'
elseif level==4 then
return 'A22U'
elseif level==5 then
return 'A22V'
elseif level==6 then
return 'A22W'
elseif level==7 then
return 'A22X'
endif
return 'A230'
endfunction
function YM4 takes unit target returns nothing
call UnitRemoveAbility(target,'A230')
call UnitRemoveAbility(target,'A22Z')
call UnitRemoveAbility(target,'A22Y')
call UnitRemoveAbility(target,'A22U')
call UnitRemoveAbility(target,'A22V')
call UnitRemoveAbility(target,'A22W')
call UnitRemoveAbility(target,'A22X')
call UnitRemoveAbility(target,'B08Z')
endfunction
function YN4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(681)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()==EVENT_WIDGET_DEATH or LVO<(TimerGetElapsed(M))then
call YM4(target)
endif
set t=null
set target=null
return false
endfunction
function YS4 takes nothing returns nothing
local unit hero=GK
local unit target=GetEnumUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real LVO=(LoadReal(LY,(GetHandleId(target)),(681)))
if LVO<(TimerGetElapsed(M))then
call AddSkill(target,YL4(hero))
endif
call SaveReal(LY,(GetHandleId(target)),(681),(((TimerGetElapsed(M))+2)*1.0))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,2.01,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function YN4))
set t=null
set hero=null
endfunction
function YT4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QXI=(LoadReal(LY,(handle_id),(6)))
local real QYI=(LoadReal(LY,(handle_id),(7)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real DC1=(LoadReal(LY,(handle_id),(57)))
local real x
local real y
local integer i=1
local integer NPI=GetTriggerEvalCount(t)
local group g
if NPI*0.1>DC1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
loop
exitwhen i>7
set x=QXI+80*i*Cos((a+90)*bj_DEGTORAD)
set y=QYI+80*i*Sin((a+90)*bj_DEGTORAD)
call GroupEnumUnitsInRange(g,x,y,105,Condition(function CE1))
call ForGroup(g,function YS4)
set x=QXI+80*i*Cos((a-90)*bj_DEGTORAD)
set y=QYI+80*i*Sin((a-90)*bj_DEGTORAD)
call GroupEnumUnitsInRange(g,x,y,105,Condition(function CE1))
call ForGroup(g,function YS4)
set i=i+1
endloop
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function YR4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real a=GetUnitFacing(hero)
local integer i=1
local unit dummy
local real x
local real y
local real QXI=GetUnitX(hero)+225*Cos(a*bj_DEGTORAD)
local real QYI=GetUnitY(hero)+225*Sin(a*bj_DEGTORAD)
local integer XB4=(LoadInteger(LY,(GetHandleId(hero)),(3001)))
local integer X24=(LoadInteger(LY,(GetHandleId(hero)),(3002)))
local real DC1=1.5+1.5*XB4
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
loop
exitwhen i>7
set x=QXI+80*i*Cos((a+90)*bj_DEGTORAD)
set y=QYI+80*i*Sin((a+90)*bj_DEGTORAD)
set dummy=CreateUnit(GetOwningPlayer(hero),'u00O',x,y,GetRandomReal(0,360))
call SetUnitAbilityLevel(dummy,'S00H',XB4)
call SetUnitAbilityLevel(dummy,'A0XN',X24)
call SetUnitAnimation(dummy,"birth")
call QueueUnitAnimation(dummy,"stand")
call UnitApplyTimedLife(dummy,'BTLF',DC1)
set x=QXI+80*i*Cos((a-90)*bj_DEGTORAD)
set y=QYI+80*i*Sin((a-90)*bj_DEGTORAD)
set dummy=CreateUnit(GetOwningPlayer(hero),'u00O',x,y,GetRandomReal(0,360))
call SetUnitAbilityLevel(dummy,'S00H',XB4)
call SetUnitAbilityLevel(dummy,'A0XN',X24)
call SetUnitAnimation(dummy,"birth")
call QueueUnitAnimation(dummy,"stand")
call UnitApplyTimedLife(dummy,'BTLF',DC1)
set i=i+1
endloop
call TriggerAddCondition(t,Condition(function YT4))
call TriggerRegisterTimerEvent(t,0.1,true)
call SaveReal(LY,(handle_id),(6),((QXI)*1.0))
call SaveReal(LY,(handle_id),(7),((QYI)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
set dummy=null
set hero=null
set t=null
endfunction
function YP4 takes nothing returns boolean
if GetSpellAbilityId()=='A0VP' then
call YR4()
endif
return false
endfunction
function YQ4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YP4))
call Q3I('S00H',GetRandomReal(1,25))
call Q3I('A0XN',GetRandomReal(1,25))
set t=null
endfunction
function YU4 takes nothing returns nothing
if RYI(GetEnumUnit())==false then
call Damage(GK,GetEnumUnit(),3,AK)
endif
endfunction
function J04 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g=NTI()
local integer NPI
set GK=SFI
call GroupEnumUnitsInRange(g,x,y,200,Condition(function CA1))
set NPI=CountUnitsInGroup(g)
if NPI<1 then
set NPI=1
endif
set AK=PAI/NPI
call ForGroup(g,function YU4)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Other\\Doom\\DoomDeath.mdl",x,y))
call NSI(g)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
set g=null
return false
endfunction
function JI4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real PAI=(LoadInteger(LY,(GetHandleId(SFI)),(3002)))*62.5+12.5+25
local string s=""
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(SFI))==true or(C2 and(GetLocalPlayer()==D60 or GetLocalPlayer()==D70))then
set s="Abilities\\Spells\\Items\\VampiricPotion\\VampPotionCaster.mdl"
endif
call I41(GetOwningPlayer(SFI),5.7,x,y,400)
call TriggerRegisterTimerEvent(t,1.7,false)
call TriggerAddCondition(t,Condition(function J04))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect(s,x,y)))
call RemoveLocation(point)
set t=null
set SFI=null
set point=null
endfunction
function J14 takes nothing returns boolean
if GetSpellAbilityId()=='A0VG' then
call JI4()
endif
return false
endfunction
function JO4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function J14))
set t=null
endfunction
function J24 takes unit hero,unit target,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A0VI')
call IssueTargetOrder(dummy,"thunderbolt",target)
if RKI(target)==false then
call Damage(hero,target,1,level*7)
endif
set dummy=null
endfunction
function J34 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>10 and((LoadInteger(LY,(GetHandleId((t))),((4263))))==1)==false and GetOwningPlayer(GetEventDamageSource())!=GetOwningPlayer(GetTriggerUnit())then
call DisableTrigger(t)
call J24(hero,target,level)
call EnableTrigger(t)
call S6I(t,4263,0.8-level*0.0285)
endif
else
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
return false
endfunction
function J44 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=(LoadInteger(LY,(GetHandleId(SFI)),(3001)))
call TriggerRegisterTimerEvent(t,2.5+level*0.5,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function J34))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Weapons\\SpiritOfVengeanceMissile\\SpiritOfVengeanceMissile.mdl",target,"overhead")))
call J24(SFI,target,level)
set t=null
set SFI=null
set target=null
endfunction
function J54 takes nothing returns boolean
if GetSpellAbilityId()=='A0VZ' then
call J44()
endif
return false
endfunction
function J64 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function J54))
call Q3I('A0VI',GetRandomReal(1,25))
set t=null
endfunction
function J74 takes unit SFI returns nothing
local integer handle_id=GetHandleId(SFI)
local boolean J84=(LoadBoolean(LY,(handle_id),(3003)))
local trigger t
if J84 then
call SaveBoolean(LY,(handle_id),(3003),(false))
set t=(LoadTriggerHandle(LY,(handle_id),(3006)))
call FlushChildHashtable(LY,(GetHandleId(t)))
call FlushTrigger(t)
endif
set t=null
endfunction
function J94 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
call SetUnitState(SFI,UNIT_STATE_LIFE,GetUnitState(SFI,UNIT_STATE_LIFE)+level*1)
return false
endfunction
function JA4 takes unit SFI,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(SFI)
call SaveBoolean(LY,(handle_id),(3003),(true))
call SaveTriggerHandle(LY,(handle_id),(3006),(t))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(SFI))
call SaveInteger(LY,(GetHandleId(t)),(5),(level))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function J94))
set t=null
endfunction
function JB4 takes nothing returns nothing
local integer JC4=0
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local integer JD4=(LoadInteger(LY,(handle_id),(3013)))
local integer JE4=(LoadInteger(LY,(handle_id),(3014)))
local integer JF4=(LoadInteger(LY,(handle_id),(3015)))
local integer JG4=(LoadInteger(LY,(handle_id),(3016)))
local integer JH4=(LoadInteger(LY,(handle_id),(3017)))
if JD4==3 and JE4==0 and JF4==0 then
set JC4=1
elseif JD4==2 and JE4==1 and JF4==0 then
set JC4=2
elseif JD4==2 and JE4==0 and JF4==1 then
set JC4=3
elseif JD4==1 and JE4==2 and JF4==0 then
set JC4=4
elseif JD4==1 and JE4==1 and JF4==1 then
set JC4=5
elseif JD4==1 and JE4==0 and JF4==2 then
set JC4=6
elseif JD4==0 and JE4==1 and JF4==2 then
set JC4=7
elseif JD4==0 and JE4==2 and JF4==1 then
set JC4=8
elseif JD4==0 and JE4==0 and JF4==3 then
set JC4=9
elseif JD4==0 and JE4==3 and JF4==0 then
set JC4=10
endif
if HLI[JC4]==JH4 then
return
endif
if JG4!=0 and JH4!=0 then
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JG4,false)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JH4,false)
set JG4=JH4
set JH4=HLI[JC4]
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JG4,true)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JH4,true)
elseif JG4==0 and JH4!=0 then
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JH4,false)
set JG4=JH4
set JH4=HLI[JC4]
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JG4,true)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JH4,true)
else
set JH4=HLI[JC4]
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),JH4,true)
endif
call SaveInteger(LY,(handle_id),(3016),(JG4))
call SaveInteger(LY,(handle_id),(3017),(JH4))
call XS4(SFI)
set SFI=null
endfunction
function JZ4 takes unit SFI returns nothing
local integer handle_id=GetHandleId(SFI)
local integer JD4=(LoadInteger(LY,(handle_id),(3013)))
local integer JE4=(LoadInteger(LY,(handle_id),(3014)))
local integer JF4=(LoadInteger(LY,(handle_id),(3015)))
local integer XO4=GetUnitAbilityLevel(SFI,'A21X')
local integer XB4=GetUnitAbilityLevel(SFI,'A21W')
local integer X24=GetUnitAbilityLevel(SFI,'A21V')
call UnitRemoveAbility(SFI,'A0WD')
call UnitRemoveAbility(SFI,'A0VE')
call J74(SFI)
call UnitRemoveAbility(SFI,'A0V7')
if JD4>0 then
call AddSkill(SFI,'A0WD')
call AddSkill(SFI,'A0VE')
call SetUnitAbilityLevel(SFI,'A0WD',JD4*XO4)
call SetUnitAbilityLevel(SFI,'A0VE',JD4*XO4)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A0WD',false)
endif
if JE4>0 then
call JA4(SFI,JE4*XB4)
endif
if JF4>0 then
call AddSkill(SFI,'A0V7')
call SetUnitAbilityLevel(SFI,'A0V7',JF4*X24)
endif
endfunction
function JV4 takes unit SFI,integer JD4,integer JE4,integer JF4 returns nothing
local integer Orb1=0
local integer Orb2=0
local integer Orb3=0
local integer JW4
local integer JX4
local integer JY4
local integer JJ4
local integer JK4
local integer JL4
local integer JM4
local integer JN4
local integer JS4
call UnitRemoveAbility(SFI,'A0DN')
call UnitRemoveAbility(SFI,'A0DG')
call UnitRemoveAbility(SFI,'A0IX')
call UnitRemoveAbility(SFI,'A0I1')
call UnitRemoveAbility(SFI,'A0I0')
call UnitRemoveAbility(SFI,'A0HZ')
call UnitRemoveAbility(SFI,'A0IC')
call UnitRemoveAbility(SFI,'A0IB')
call UnitRemoveAbility(SFI,'A0ID')
call UnitRemoveAbility(SFI,'A22C')
call UnitRemoveAbility(SFI,'A22D')
call UnitRemoveAbility(SFI,'A22E')
call UnitRemoveAbility(SFI,'A22F')
call UnitRemoveAbility(SFI,'A22G')
call UnitRemoveAbility(SFI,'A22H')
call UnitRemoveAbility(SFI,'A22I')
call UnitRemoveAbility(SFI,'A22J')
call UnitRemoveAbility(SFI,'A22K')
if EP1(SFI,K70)==null then
set JW4='A0DN'
set JX4='A0DG'
set JY4='A0IX'
set JJ4='A0I1'
set JK4='A0I0'
set JL4='A0HZ'
set JM4='A0IC'
set JN4='A0IB'
set JS4='A0ID'
else
set JW4='A22C'
set JX4='A22D'
set JY4='A22E'
set JJ4='A22F'
set JK4='A22G'
set JL4='A22H'
set JM4='A22I'
set JN4='A22J'
set JS4='A22K'
endif
if JD4==1 and JE4==0 and JF4==0 then
call AddSkill(SFI,JW4)
elseif JD4==0 and JE4==1 and JF4==0 then
call AddSkill(SFI,JJ4)
elseif JD4==0 and JE4==0 and JF4==1 then
call AddSkill(SFI,JM4)
elseif JD4==2 and JE4==0 and JF4==0 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JX4)
elseif JD4==1 and JE4==1 and JF4==0 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JK4)
elseif JD4==1 and JE4==0 and JF4==1 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JN4)
elseif JD4==0 and JE4==2 and JF4==0 then
call AddSkill(SFI,JJ4)
call AddSkill(SFI,JK4)
elseif JD4==0 and JE4==1 and JF4==1 then
call AddSkill(SFI,JJ4)
call AddSkill(SFI,JN4)
elseif JD4==0 and JE4==0 and JF4==2 then
call AddSkill(SFI,JM4)
call AddSkill(SFI,JN4)
elseif JD4==3 and JE4==0 and JF4==0 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JX4)
call AddSkill(SFI,JY4)
elseif JD4==2 and JE4==1 and JF4==0 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JX4)
call AddSkill(SFI,JL4)
elseif JD4==2 and JE4==0 and JF4==1 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JX4)
call AddSkill(SFI,JS4)
elseif JD4==1 and JE4==2 and JF4==0 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JK4)
call AddSkill(SFI,JL4)
elseif JD4==1 and JE4==1 and JF4==1 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JK4)
call AddSkill(SFI,JS4)
elseif JD4==1 and JE4==0 and JF4==2 then
call AddSkill(SFI,JW4)
call AddSkill(SFI,JN4)
call AddSkill(SFI,JS4)
elseif JD4==0 and JE4==1 and JF4==2 then
call AddSkill(SFI,JM4)
call AddSkill(SFI,JN4)
call AddSkill(SFI,JL4)
elseif JD4==0 and JE4==2 and JF4==1 then
call AddSkill(SFI,JJ4)
call AddSkill(SFI,JK4)
call AddSkill(SFI,JS4)
elseif JD4==0 and JE4==0 and JF4==3 then
call AddSkill(SFI,JM4)
call AddSkill(SFI,JN4)
call AddSkill(SFI,JS4)
elseif JD4==0 and JE4==3 and JF4==0 then
call AddSkill(SFI,JJ4)
call AddSkill(SFI,JK4)
call AddSkill(SFI,JL4)
endif
endfunction
function JT4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer handle_id=GetHandleId(SFI)
local integer JR4=GetSpellAbilityId()
local integer JP4=(LoadInteger(LY,(handle_id),(3010)))
local integer JQ4=(LoadInteger(LY,(handle_id),(3011)))
local integer JU4=(LoadInteger(LY,(handle_id),(3012)))
local integer JD4=0
local integer JE4=0
local integer JF4=0
set JP4=JQ4
set JQ4=JU4
set JU4=JR4
if JP4=='A21X' then
set JD4=JD4+1
elseif JP4=='A21W' then
set JE4=JE4+1
elseif JP4=='A21V' then
set JF4=JF4+1
endif
if JQ4=='A21X' then
set JD4=JD4+1
elseif JQ4=='A21W' then
set JE4=JE4+1
elseif JQ4=='A21V' then
set JF4=JF4+1
endif
if JU4=='A21X' then
set JD4=JD4+1
elseif JU4=='A21W' then
set JE4=JE4+1
elseif JU4=='A21V' then
set JF4=JF4+1
endif
call SaveInteger(LY,(handle_id),(3010),(JP4))
call SaveInteger(LY,(handle_id),(3011),(JQ4))
call SaveInteger(LY,(handle_id),(3012),(JU4))
call SaveInteger(LY,(handle_id),(3013),(JD4))
call SaveInteger(LY,(handle_id),(3014),(JE4))
call SaveInteger(LY,(handle_id),(3015),(JF4))
call JV4(SFI,JD4,JE4,JF4)
call JZ4(SFI)
call XS4(SFI)
endfunction
function FZO takes nothing returns nothing
local unit SFI=GK
local integer handle_id=GetHandleId(SFI)
local integer JP4=(LoadInteger(LY,(handle_id),(3010)))
local integer JQ4=(LoadInteger(LY,(handle_id),(3011)))
local integer JU4=(LoadInteger(LY,(handle_id),(3012)))
local integer JD4=0
local integer JE4=0
local integer JF4=0
if JP4=='A21X' then
set JD4=JD4+1
elseif JP4=='A21W' then
set JE4=JE4+1
elseif JP4=='A21V' then
set JF4=JF4+1
endif
if JQ4=='A21X' then
set JD4=JD4+1
elseif JQ4=='A21W' then
set JE4=JE4+1
elseif JQ4=='A21V' then
set JF4=JF4+1
endif
if JU4=='A21X' then
set JD4=JD4+1
elseif JU4=='A21W' then
set JE4=JE4+1
elseif JU4=='A21V' then
set JF4=JF4+1
endif
call JV4(SFI,JD4,JE4,JF4)
set SFI=null
endfunction
function K04 takes nothing returns boolean
if IsUnitIllusion(GetTriggerUnit())==false and(GetLearnedSkill()=='A21X' or GetLearnedSkill()=='A21W' or GetLearnedSkill()=='A21V')then
call JZ4(GetTriggerUnit())
if GetLearnedSkill()=='A21X' then
call SetHeroAgi(GetTriggerUnit(),GetHeroAgi(GetTriggerUnit(),false)+2,true)
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(3000),(GetUnitAbilityLevel(GetTriggerUnit(),'A21X')))
endif
if GetLearnedSkill()=='A21W' then
call SetHeroStr(GetTriggerUnit(),GetHeroStr(GetTriggerUnit(),false)+2,true)
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(3001),(GetUnitAbilityLevel(GetTriggerUnit(),'A21W')))
endif
if GetLearnedSkill()=='A21V' then
call SetHeroInt(GetTriggerUnit(),GetHeroInt(GetTriggerUnit(),false)+2,true)
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(3002),(GetUnitAbilityLevel(GetTriggerUnit(),'A21V')))
endif
endif
return false
endfunction
function KI4 takes nothing returns boolean
if GetSpellAbilityId()=='A21X' or GetSpellAbilityId()=='A21W' or GetSpellAbilityId()=='A21V' then
call JT4()
elseif GetSpellAbilityId()=='A21Y' or GetSpellAbilityId()=='A1GU' then
call JB4()
endif
return false
endfunction
function QU1 takes nothing returns nothing
local unit SFI=GK
local integer i=1
local integer OO1
if GetUnitTypeId(SFI)!='H00U' then
return
endif
loop
exitwhen i>11
set OO1=HLI[i]
call AddSkill(SFI,OO1)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),OO1,false)
set i=i+1
endloop
set SFI=null
endfunction
function K14 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='H00U' and IsUnitIllusion(GetTriggerUnit())==false then
set GK=GetTriggerUnit()
call QU1()
elseif(GetUnitTypeId(GetTriggerUnit())=='Ubal' or GetUnitTypeId(GetTriggerUnit())=='E02X')and IsUnitIllusion(GetTriggerUnit())==false then
set GK=GetTriggerUnit()
call ExecuteFunc("KO4")
elseif GetUnitTypeId(GetTriggerUnit())=='H00I' and IsUnitIllusion(GetTriggerUnit())==false then
set GK=GetTriggerUnit()
call ExecuteFunc("K24")
endif
return false
endfunction
function SP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call Q1I((HLI[1]))
call Q1I((HLI[2]))
call Q1I((HLI[3]))
call Q1I((HLI[4]))
call Q1I((HLI[5]))
call Q1I((HLI[6]))
call Q1I((HLI[7]))
call Q1I((HLI[8]))
call Q1I((HLI[9]))
call Q1I((HLI[10]))
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function KI4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function K04))
set t=null
call QRI(bj_FORCE_ALL_PLAYERS,15.00,"预读祈求者的技能，将造成短暂的延迟")
call Q3I('A0XO',GetRandomReal(1,25))
call Q3I('A0WD',GetRandomReal(1,25))
call Q3I('A0VE',GetRandomReal(1,25))
call Q3I('A0V7',GetRandomReal(1,25))
call Q3I('A21V',GetRandomReal(1,25))
call Q3I('A21X',GetRandomReal(1,25))
call Q3I('A21W',GetRandomReal(1,25))
call X94()
call XV4()
call XK4()
call XR4()
call Y24()
call YC4()
call YK4()
call YQ4()
call JO4()
call J64()
endfunction
function K34 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real PAI
if level==1 then
set PAI=15
elseif level==2 then
set PAI=30
elseif level==3 then
set PAI=40
elseif level==4 then
set PAI=50
endif
if GetTriggerEvalCount(t)==3 or GetTriggerEvalCount(t)==4 then
call Damage(hero,target,1,PAI)
endif
if GetTriggerEvalCount(t)==4 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A1VS')
call UnitRemoveAbility(target,'B0DN')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function K44 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'AHtb')
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetEventDamageSource()==hero and GetEventDamage()==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function K34))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",target,"chest")))
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1VS',false)
call AddSkill(target,'A1VS')
endif
set t=null
set hero=null
set target=null
return false
endfunction
function K54 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real d=QLI(hero,target)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function K44))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function K64 takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIfb\\AIfbSpecialArt.mdl",GetTriggerUnit(),"weapon"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIfb\\AIfbSpecialArt.mdl",GetTriggerUnit(),"hand"))
endfunction
function K74 takes nothing returns boolean
if GetSpellAbilityId()=='AHtb' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call K64()
elseif CanResistSkill(GetSpellTargetUnit())==false then
call K54()
endif
endif
return false
endfunction
function T81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function K74))
set t=null
endfunction
function K84 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SelectUnitForPlayerSingle(hero,GetOwningPlayer(hero))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function K94 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A01Y')
local real DC1=360-100*level
local unit dummy
if level==3 then
endif
if TimerGetRemaining(EJ0[GetPlayerId(GetOwningPlayer(hero))])==0 and GetUnitState(hero,UNIT_STATE_MANA)>=140 then
// 如果能触发复活,则立即解除隐藏,否则无法触发复活
call ShowUnit(hero, true)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(dummy,'A274')
call IssueImmediateOrder(dummy,"thunderclap")
call TimerStart(EJ0[GetPlayerId(GetOwningPlayer(hero))],DC1,false,null)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,3+0.01,false)
call TriggerAddCondition(t,Condition(function K84))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
set t=null
set hero=null
set dummy=null
return false
endfunction
function KA4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function K94))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
// 骷髅王 重生
function KB4 takes nothing returns boolean
if GetLearnedSkill()=='A01Y' and GetUnitAbilityLevel(GetTriggerUnit(),'A01Y')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call KA4()
endif
return false
endfunction
function TA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function KB4))
set t=null
endfunction
function KC4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2S0')
local real KD4=(LoadReal(LY,(handle_id),(797)))
local real KE4=(LoadReal(LY,(handle_id),(798)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call SaveInteger(LY,(GetHandleId((hero))),((4338)),(2))
call AddSkill(hero,'A2RZ')
call SetUnitAbilityLevel(hero,'A2RZ',level)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif KD4>0 then
call SaveInteger(LY,(GetHandleId((hero))),((4338)),(2))
if GetUnitTypeId(hero)=='NC00' then
call AddSkill(hero,'A2RZ')
call SetUnitAbilityLevel(hero,'A2RZ',level)
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if IsUnitDead(hero)==false then
call SetUnitState(hero,UNIT_STATE_LIFE,QDI(1,GetUnitState(hero,UNIT_STATE_LIFE)-KD4))
endif
if IsUnitDead(target)==false then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+KD4)
endif
else
set KD4=GetUnitState(target,UNIT_STATE_MAX_LIFE)*0.2
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+KD4)
call SetUnitState(target,UNIT_STATE_LIFE,QDI(1,GetUnitState(target,UNIT_STATE_LIFE)-KD4))
call SaveReal(LY,(handle_id),(797),((KD4)*1.0))
call SaveReal(LY,(handle_id),(798),((KE4)*1.0))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function KF4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerRegisterTimerEvent(t,7,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function KC4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(797),((0)*1.0))
call SaveReal(LY,(handle_id),(798),((0)*1.0))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\MortalStrikeCaster.mdx",hero,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\MortalStrikeTarget.mdx",target,"overhead")))
call SaveInteger(LY,(GetHandleId((hero))),((4338)),(1))
call UnitRemoveAbility(hero,'A2RZ')
set t=null
set hero=null
set target=null
endfunction
function KG4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A2S0')
if level==1 then
call AddSkill(hero,'A2RZ')
elseif((LoadInteger(LY,(GetHandleId((hero))),((4338))))==1)==false then
call SetUnitAbilityLevel(hero,'A2RZ',level)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2RZ',false)
set hero=null
endfunction
function KH4 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_HERO_SKILL then
if GetLearnedSkill()=='A2S0' and IsUnitIllusion(GetTriggerUnit())==false then
call KG4()
endif
else
if GetSpellAbilityId()=='A2S0' then
if CanResistSkill(GetSpellTargetUnit())==false then
call KF4()
endif
endif
endif
return false
endfunction
function T91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function KH4))
set t=null
endfunction
function KZ4 takes unit u returns boolean
return GetUnitTypeId(u)=='E005' or GetUnitTypeId(u)=='H00E' or GetUnitTypeId(u)=='H00G' or GetUnitTypeId(u)=='H08D' or GetUnitTypeId(u)=='H08C' or GetUnitTypeId(u)=='H084' or GetUnitTypeId(u)=='H08B' or GetUnitTypeId(u)=='E02O'
endfunction
function KV4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and GetEventDamage()>0 then
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+GetEventDamage()*(0.1+0.05*level))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\VampiricAura\\VampiricAuraTarget.mdl",hero,"origin"))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
return false
endfunction
function KW4 takes unit hero,unit target,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function KV4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
set t=null
endfunction
function KX4 takes nothing returns boolean
if(KZ4(GetAttacker())==true or IsUnitIllusion(GetAttacker())==true)and GetUnitAbilityLevel(GetAttacker(),'B0GY')>0 and((LoadInteger(LY,(GetHandleId((GetAttacker()))),((4419))))==1)==false and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call KW4(GetAttacker(),GetTriggerUnit(),(LoadInteger(LY,(GetHandleId(GetAttacker())),(819))))
call SCI(GetAttacker(),4419,0.25)
endif
return false
endfunction
function KY4 takes nothing returns nothing
if HTI or(IsUnitDead(GetEnumUnit())or IsUnitInRangeXY(GetEnumUnit(),GetUnitX(HNI),GetUnitY(HNI),900)==false or IsUnitType(GetEnumUnit(),UNIT_TYPE_RANGED_ATTACKER)==false)then
call GroupRemoveUnit(HMI,GetEnumUnit())
call UnitRemoveAbility(GetEnumUnit(),'A2VL')
if IsUnitType(GetEnumUnit(),UNIT_TYPE_RANGED_ATTACKER)==false then
call UnitRemoveAbility(GetEnumUnit(),'B0GY')
call UnitRemoveAbility(GetEnumUnit(),'B0H4')
endif
endif
endfunction
function KJ4 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_RANGED_ATTACKER)and IsUnitInGroup(GetEnumUnit(),HMI)==false then
call GroupAddUnit(HMI,GetEnumUnit())
endif
endfunction
function KK4 takes unit SWI,integer U9I returns boolean
local item BA1
local boolean F81=false
local boolean F91=true
set BA1=CreateItem(U9I,GetUnitX(SWI),GetUnitY(SWI))
if GetUnitAbilityLevel(SWI,'AInv')==0 then
set F81=true
call AddSkill(SWI,'AInv')
endif
if UnitAddItem(SWI,BA1)==false then
call RemoveItem(BA1)
set F91=false
elseif GetWidgetLife(BA1)>0 then
call RemoveItem(BA1)
set F91=false
else
call RemoveItem(BA1)
endif
if F81 then
call UnitRemoveAbility(SWI,'AInv')
endif
set BA1=null
return F91
endfunction
function KL4 takes nothing returns nothing
local unit target=GetEnumUnit()
if KZ4(target)or IsUnitIllusion(target)==true then
call UnitRemoveAbility(target,'B0H4')
call AddSkill(target,'A2VL')
call SaveInteger(LY,(GetHandleId(target)),(819),(HSI))
else
call UnitRemoveAbility(target,'A2VL')
call UnitRemoveAbility(target,'B0GY')
call MUDisableItemTrigger()
call KK4(target,HRI[HSI])
call MUEnableItemTrigger()
endif
set target=null
endfunction
function KM4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group FX4=(LoadGroupHandle(LY,(handle_id),(22)))
local group g
if GetTriggerEventId()==EVENT_WIDGET_DEATH or hero==null then
set HTI=true
call ForGroup(FX4,function KY4)
call NSI(FX4)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set HMI=FX4
set HSI=GetUnitAbilityLevel(hero,'AUav')
set HTI=false
set HNI=hero
set GK=hero
call ForGroup(FX4,function KY4)
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),900+25,Condition(function CT1))
call ForGroup(g,function KJ4)
call NSI(g)
set g=null
call ForGroup(FX4,function KL4)
endif
set t=null
set hero=null
set FX4=null
return false
endfunction
function KN4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
if IsUnitIllusion(hero)then
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterTimerEvent(t,1,true)
else
call TriggerRegisterTimerEvent(t,0.2,true)
endif
call TriggerAddCondition(t,Condition(function KM4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
set t=null
set hero=null
endfunction
function KS4 takes nothing returns boolean
if GetLearnedSkill()=='AUav' and GetUnitAbilityLevel(GetTriggerUnit(),'AUav')==1 then
call KN4()
endif
return false
endfunction
function TB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function KS4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function KX4))
set HRI[1]='I0QA'
set HRI[2]='I0QB'
set HRI[3]='I0QC'
set HRI[4]='I0QD'
set t=null
endfunction
constant function Poof_RawCode takes nothing returns integer
return 'A0N8'
endfunction
constant function Poof_PrimaryUnitCode takes nothing returns integer
return 'H00I'
endfunction
constant function Poof_SecondaryUnitCode takes nothing returns integer
return 'H00J'
endfunction
function KT4 takes unit SWI returns boolean
return(GetUnitTypeId(SWI)==('H00I')or GetUnitTypeId(SWI)==('H00J')or GetUnitTypeId(SWI)==GetUnitTypeId(GetTriggerUnit()))and GetUnitState(SWI,UNIT_STATE_LIFE)>0.5 and GetOwningPlayer(SWI)==GetOwningPlayer(GetTriggerUnit())
endfunction
function KR4 takes nothing returns boolean
return GetSpellAbilityId()==('A0N8')
endfunction
function KP4 takes nothing returns boolean
return KT4(GetFilterUnit())
endfunction
function KQ4 takes nothing returns nothing
local unit HO2=GetEnumUnit()
local real KU4=QMI(HO2,X3)
if KU4<JO then
set JO=KU4
set XO=HO2
endif
endfunction
function L04 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0
endfunction
function LI4 takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Feedback\\ArcaneTowerAttack.mdl",GetEnumUnit(),"origin"))
call UnitDamageTarget(GetTriggerUnit(),GetEnumUnit(),JO,true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_FIRE,WEAPON_TYPE_WHOKNOWS)
endfunction
function L14 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local location AM3
local real x
local real y
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local group Z51
local boolexpr QL1
local boolean LO4=false
if target!=null and KT4(target)then
set x=GetUnitX(target)
set y=GetUnitY(target)
set LO4=true
else
set QL1=Condition(function KP4)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,0,0,999999,QL1)
if target!=null then
set AM3=GetUnitLoc(target)
else
set AM3=GetSpellTargetLoc()
endif
set XO=FirstOfGroup(Z51)
if XO!=null then
set LO4=true
call GroupRemoveUnit(Z51,XO)
set JO=QMI(XO,AM3)
set X3=AM3
call ForGroup(Z51,function KQ4)
set target=XO
set x=GetUnitX(target)
set y=GetUnitY(target)
endif
call NSI(Z51)
call RemoveLocation(AM3)
endif
if LO4 then
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\ToonBoom\\ToonBoom.mdl",QXI,QYI))
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\ToonBoom\\ToonBoom.mdl",x,y))
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
set JO=60+GetUnitAbilityLevel(GetTriggerUnit(),('A0N8'))*20
set QL1=Condition(function L04)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,QXI,QYI,400,QL1)
call ForGroup(Z51,function LI4)
call NSI(Z51)
set Z51=NTI()
call GroupEnumUnitsInRange(Z51,x,y,400,QL1)
call ForGroup(Z51,function LI4)
call NSI(Z51)
endif
endfunction
function L24 takes nothing returns boolean
return GetSpellAbilityId()==('A0N8')
endfunction
function L34 takes nothing returns nothing
call SetUnitAnimationByIndex((LoadUnitHandle(LY,(GetHandleId(GetExpiredTimer())),(221))),2)
endfunction
function L44 takes nothing returns nothing
local timer t=CreateTimer()
call SetUnitAnimationByIndex(GetTriggerUnit(),2)
call SaveUnitHandle(LY,(GetHandleId(t)),(221),(GetTriggerUnit()))
call TimerStart(t,1,false,function L34)
endfunction
function NW1 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer i=1
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CHANNEL)
call TriggerAddCondition(t,Condition(function L24))
call TriggerAddAction(t,function L44)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function KR4))
call TriggerAddAction(t,function L14)
loop
exitwhen i>5
call SetPlayerAbilityAvailable(BO[i],'A2QA',false)
call SetPlayerAbilityAvailable(CO[i],'A2QA',false)
set i=i+1
endloop
endfunction
constant function Trap_CastCode takes nothing returns integer
return 'A0NB'
endfunction
constant function Trap_EffectCode takes nothing returns integer
return 'A0NC'
endfunction
constant function Trap_Projectile takes nothing returns integer
return 'h00C'
endfunction
constant function Trap_DummyNet takes nothing returns integer
return 'h009'
endfunction
constant function Trap_Radius takes nothing returns integer
return 245
endfunction
function L54 takes nothing returns boolean
return GetSpellAbilityId()==('A0NB')
endfunction
function L64 takes nothing returns boolean
return RKI(GetFilterUnit())==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(XO))and(BU1(GetFilterUnit())==false or IsUnitVisible(GetFilterUnit(),GetOwningPlayer(XO))==true)and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>0.5 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitTypeId(GetFilterUnit())!='n00L'
endfunction
function L74 takes nothing returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(GetEnumUnit()),'e00E',JO,Y3,0)
call AddSkill(dummy,('A0NC'))
call IssueTargetOrder(dummy,"ensnare",GetEnumUnit())
endfunction
function L84 takes unit IG1,real x,real y returns nothing
local boolexpr QL1=Condition(function L64)
local group Z51=NTI()
set XO=IG1
call GroupEnumUnitsInRange(Z51,x,y,(245),QL1)
set JO=x
set Y3=y
call ForGroup(Z51,function L74)
call NSI(Z51)
endfunction
function L94 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real QXI=GetUnitX(IG1)
local real QYI=GetUnitY(IG1)
local real IV1=GetUnitX(IG1)+30*Cos(RM2)
local real IW1=GetUnitY(IG1)+30*Sin(RM2)
if(IV1-QJI)*(IV1-QJI)+(IW1-QKI)*(IW1-QKI)<1200 then
call MUSetUnitX(IG1,QJI)
call MUSetUnitY(IG1,QKI)
call L84(IG1,QJI,QKI)
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call KillUnit(IG1)
call DestroyTimer(t)
else
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
endif
endfunction
function LA4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location AM3=GetSpellTargetLoc()
local real QJI=PTI(GetLocationX(AM3))
local real QKI=PUI(GetLocationY(AM3))
local real QXI=PTI(GetUnitX(SFI))
local real QYI=PUI(GetUnitY(SFI))
local unit IG1=CreateUnit(GetOwningPlayer(SFI),('h00C'),QXI,QYI,0)
local real RM2=Atan2(QKI-QYI,QJI-QXI)
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
call SetUnitScale(IG1,2,2,2)
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call TimerStart(t,0.035,true,function L94)
call RemoveLocation(AM3)
endfunction
function NX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddAction(t,function LA4)
call TriggerAddCondition(t,Condition(function L54))
endfunction
function LB4 takes unit u returns boolean
return GetUnitTypeId(u)=='H00I' or GetUnitTypeId(u)=='H00J'
endfunction
constant function DoubleTrouble_RawCode takes nothing returns integer
return 'A0MW'
endfunction
constant function DoubleTrouble_PrimaryUnitCode takes nothing returns integer
return 'H00I'
endfunction
constant function DoubleTrouble_SecondaryUnitCode takes nothing returns integer
return 'H00J'
endfunction
constant function DoubleTrouble_Ability1 takes nothing returns integer
return 'A0N8'
endfunction
constant function DoubleTrouble_Ability2 takes nothing returns integer
return 'A0NB'
endfunction
constant function DoubleTrouble_Ability3 takes nothing returns integer
return 'A0N7'
endfunction
constant function DoubleTrouble_Item9 takes nothing returns integer
return FR0[ZI0]
endfunction
constant function DoubleTrouble_Item8 takes nothing returns integer
return FR0[Z00]
endfunction
constant function DoubleTrouble_Item7 takes nothing returns integer
return FR0[X90]
endfunction
constant function DoubleTrouble_Item6 takes nothing returns integer
return FR0[XI0]
endfunction
constant function DoubleTrouble_Item5 takes nothing returns integer
return FR0[ZL0]
endfunction
constant function DoubleTrouble_Item4 takes nothing returns integer
return FR0[ZM0]
endfunction
constant function DoubleTrouble_Item3 takes nothing returns integer
return FR0[ZN0]
endfunction
constant function DoubleTrouble_Item2 takes nothing returns integer
return FR0[ZK0]
endfunction
constant function DoubleTrouble_Item1 takes nothing returns integer
return FR0[G40]
endfunction
function LC4 takes unit SWI returns boolean
return GetUnitTypeId(SWI)==('H00I')or GetUnitTypeId(SWI)==('H00J')
endfunction
function DoubleTrouble_IsKoboldCondition takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(XO)and GetFilterUnit()!=XO and(GetUnitTypeId(GetFilterUnit())==('H00I')or GetUnitTypeId(GetFilterUnit())==('H00J'))
endfunction
function DoubleTrouble_UnshareXPCondition takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(XO))==true and LC4(GetFilterUnit())==false
endfunction
function DoubleTrouble_UnshareXPGive takes nothing returns nothing
call AddHeroXP(GetEnumUnit(),YO,true)
endfunction
function LD4 takes nothing returns nothing
local integer LE4=GetHandleId(GetTriggeringTrigger())
local player T4I=(LoadPlayerHandle(LY,(LE4),(370)))
local integer LF4=GetHandleId(T4I)
local unit W41=(LoadUnitHandle(LY,(LF4),(699)))
local unit W51=(LoadUnitHandle(LY,(LF4),(700)))
local unit W61=(LoadUnitHandle(LY,(LF4),(701)))
local unit W71=(LoadUnitHandle(LY,(LF4),(702)))
local unit W81=(LoadUnitHandle(LY,(LF4),(703)))
local integer LG4=GetUnitAbilityLevel(W41,'Aamk')*2
local integer JJ3=GetHeroAgi(W41,false)
local integer LH4=GetHeroAgi(W41,true)-JJ3-LG4
local integer JK3=GetHeroStr(W41,false)
local integer LZ4=GetHeroStr(W41,true)-JK3-LG4
local integer LV4=GetHeroInt(W41,false)
local integer LW4=GetHeroInt(W41,true)-LV4-LG4
local real LX4=0
local integer LY4
local integer LJ4
local integer LK4
if Z0I then
set LX4=1.0
endif
set LY4=R2I(JJ3+LH4*LX4)
set LJ4=R2I(JK3+LZ4*LX4)
set LK4=R2I(LV4+LW4*LX4)
if GetUnitState(W41,UNIT_STATE_LIFE)>1 then
if W51!=null then
call SetHeroAgi(W51,LY4,false)
call SetHeroStr(W51,LJ4,false)
call SetHeroInt(W51,LK4,false)
endif
if W61!=null then
call SetHeroAgi(W61,LY4,false)
call SetHeroStr(W61,LJ4,false)
call SetHeroInt(W61,LK4,false)
endif
if W71!=null then
call SetHeroAgi(W71,LY4,false)
call SetHeroStr(W71,LJ4,false)
call SetHeroInt(W71,LK4,false)
endif
if W81!=null then
call SetHeroAgi(W81,LY4,false)
call SetHeroStr(W81,LJ4,false)
call SetHeroInt(W81,LK4,false)
endif
endif
endfunction
function LL4 takes nothing returns nothing
local integer LE4=GetHandleId(GetTriggeringTrigger())
local player T4I=(LoadPlayerHandle(LY,(LE4),(370)))
local integer LF4=GetHandleId(T4I)
local unit W41=(LoadUnitHandle(LY,(LF4),(699)))
local unit W51=(LoadUnitHandle(LY,(LF4),(700)))
local unit W61=(LoadUnitHandle(LY,(LF4),(701)))
local unit W71=(LoadUnitHandle(LY,(LF4),(702)))
local unit W81=(LoadUnitHandle(LY,(LF4),(703)))
local integer LM4=GetHandleId(W41)
local integer LN4=GetHandleId(W51)
local integer LS4=GetHandleId(W61)
local integer LT4=GetHandleId(W71)
local integer LR4=GetHandleId(W81)
local integer LP4=(LoadInteger(LY,(LM4),(367)))
local integer LQ4=(LoadInteger(LY,(LM4),(368)))
local integer LU4=(LoadInteger(LY,(LN4),(367)))
local integer M04=(LoadInteger(LY,(LN4),(368)))
local integer MI4=(LoadInteger(LY,(LS4),(367)))
local integer M14=(LoadInteger(LY,(LS4),(368)))
local integer MO4=(LoadInteger(LY,(LT4),(367)))
local integer M24=(LoadInteger(LY,(LT4),(368)))
local integer M34=(LoadInteger(LY,(LR4),(367)))
local integer M44=(LoadInteger(LY,(LR4),(368)))
local integer M54=GetHeroXP(W41)
local integer M64=GetHeroXP(W51)
local integer M74=GetHeroXP(W61)
local integer M84=GetHeroXP(W71)
local integer M94=GetHeroXP(W81)
local integer MA4=M54-LP4-LQ4
local integer MB4=M64-LU4-M04
local integer MC4=M74-MI4-M14
local integer MD4=M84-MO4-M24
local integer ME4=M94-M34-M44
if GetUnitState(W41,UNIT_STATE_LIFE)>1 then
set LP4=LP4+MA4
set LU4=LU4+MB4
set MI4=MI4+MC4
set MO4=MO4+MD4
set M34=M34+ME4
if W41!=null then
call AddHeroXP(W51,MA4,false)
if GetHeroXP(W51)!=M64 then
set M04=M04+MA4
endif
call AddHeroXP(W61,MA4,false)
if GetHeroXP(W61)!=M74 then
set M14=M14+MA4
endif
call AddHeroXP(W71,MA4,false)
if GetHeroXP(W71)!=M84 then
set M24=M24+MA4
endif
call AddHeroXP(W81,MA4,false)
if GetHeroXP(W81)!=M94 then
set M44=M44+MA4
endif
endif
if W51!=null then
call AddHeroXP(W41,MB4,false)
if GetHeroXP(W41)!=M54 then
set LQ4=LQ4+MB4
endif
call AddHeroXP(W61,MB4,false)
if GetHeroXP(W61)!=M74 then
set M14=M14+MB4
endif
call AddHeroXP(W71,MB4,false)
if GetHeroXP(W71)!=M84 then
set M24=M24+MB4
endif
call AddHeroXP(W81,MB4,false)
if GetHeroXP(W81)!=M94 then
set M44=M44+MB4
endif
endif
if W61!=null then
call AddHeroXP(W51,MC4,false)
if GetHeroXP(W51)!=M64 then
set M04=M04+MC4
endif
call AddHeroXP(W41,MC4,false)
if GetHeroXP(W41)!=M54 then
set LQ4=LQ4+MC4
endif
call AddHeroXP(W71,MC4,false)
if GetHeroXP(W71)!=M84 then
set M24=M24+MC4
endif
call AddHeroXP(W81,MC4,false)
if GetHeroXP(W81)!=M94 then
set M44=M44+MC4
endif
endif
if W71!=null then
call AddHeroXP(W51,MD4,false)
if GetHeroXP(W51)!=M64 then
set M04=M04+MD4
endif
call AddHeroXP(W61,MD4,false)
if GetHeroXP(W61)!=M74 then
set M14=M14+MD4
endif
call AddHeroXP(W41,MD4,false)
if GetHeroXP(W41)!=M54 then
set LQ4=LQ4+MD4
endif
call AddHeroXP(W81,MD4,false)
if GetHeroXP(W81)!=M94 then
set M44=M44+MD4
endif
endif
if W81!=null then
call AddHeroXP(W51,ME4,false)
if GetHeroXP(W51)!=M64 then
set M04=M04+ME4
endif
call AddHeroXP(W61,ME4,false)
if GetHeroXP(W61)!=M74 then
set M14=M14+ME4
endif
call AddHeroXP(W41,ME4,false)
if GetHeroXP(W41)!=M54 then
set LQ4=LQ4+ME4
endif
call AddHeroXP(W71,ME4,false)
if GetHeroXP(W71)!=M84 then
set M24=M24+ME4
endif
endif
call SaveInteger(LY,(LM4),(367),(LP4))
call SaveInteger(LY,(LM4),(368),(LQ4))
call SaveInteger(LY,(LN4),(367),(LU4))
call SaveInteger(LY,(LN4),(368),(M04))
call SaveInteger(LY,(LS4),(367),(MI4))
call SaveInteger(LY,(LS4),(368),(M14))
call SaveInteger(LY,(LT4),(367),(MO4))
call SaveInteger(LY,(LT4),(368),(M24))
call SaveInteger(LY,(LR4),(367),(M34))
call SaveInteger(LY,(LR4),(368),(M44))
endif
endfunction
function MF4 takes nothing returns boolean
return LC4(GetTriggerUnit())and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function MG4 takes nothing returns nothing
local unit AD1=GetTriggerUnit()
local integer handle_id=GetHandleId(GetOwningPlayer(AD1))
local unit W41=(LoadUnitHandle(LY,(handle_id),(699)))
local unit W51=(LoadUnitHandle(LY,(handle_id),(700)))
local unit W61=(LoadUnitHandle(LY,(handle_id),(701)))
local unit W71=(LoadUnitHandle(LY,(handle_id),(702)))
local unit W81=(LoadUnitHandle(LY,(handle_id),(703)))
local boolean I4O=false
call DisableTrigger(EG)
if W41!=null and W41!=AD1 then
call KillUnit(W41)
endif
if W51!=null and W51!=AD1 then
call KillUnit(W51)
endif
if W61!=null and W61!=AD1 then
call KillUnit(W61)
endif
if W71!=null and W71!=AD1 then
call KillUnit(W71)
endif
if W81!=null and W81!=AD1 then
call KillUnit(W81)
endif
call EnableTrigger(EG)
endfunction
function MH4 takes nothing returns boolean
return LC4(GetTriggerUnit())and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function MZ4 takes unit MV4,unit SFI returns nothing
local trigger t=(LoadTriggerHandle(LY,(GetHandleId(GetOwningPlayer(SFI))),(369)))
local integer i=0
local boolean MW4=false
local boolean MX4=false
local boolean MY4=false
local boolean MJ4=false
local boolean MK4=false
local boolean ML4=false
local boolean MM4=false
local boolean MN4=false
local boolean MS4=false
call DisableTrigger(t)
call MUDisableItemTrigger()
loop
exitwhen i>5
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[G40])then
set MW4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[ZK0])then
set MX4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[ZN0])then
set MY4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[ZM0])then
set MJ4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[ZL0])then
set MK4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[XI0])then
set ML4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[X90])then
set MM4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[Z00])then
set MN4=true
endif
if GetItemTypeId(UnitItemInSlot(SFI,i))==(FR0[ZI0])then
set MS4=true
endif
set i=i+1
endloop
if MS4 then
call UnitAddItem(MV4,CreateItem((FR0[ZI0]),0,0))
elseif MN4 then
call UnitAddItem(MV4,CreateItem((FR0[Z00]),0,0))
elseif MM4 then
call UnitAddItem(MV4,CreateItem((FR0[X90]),0,0))
elseif ML4 then
call UnitAddItem(MV4,CreateItem((FR0[XI0]),0,0))
elseif MK4 then
call UnitAddItem(MV4,CreateItem((FR0[ZL0]),0,0))
elseif MJ4 then
call UnitAddItem(MV4,CreateItem((FR0[ZM0]),0,0))
elseif MY4 then
call UnitAddItem(MV4,CreateItem((FR0[ZN0]),0,0))
elseif MX4 then
call UnitAddItem(MV4,CreateItem((FR0[ZK0]),0,0))
elseif MW4 then
call UnitAddItem(MV4,CreateItem((FR0[G40]),0,0))
endif
call EnableTrigger(t)
call MUEnableItemTrigger()
endfunction
function MT4 takes nothing returns nothing
local unit W91=GetTriggerUnit()
local integer i=0
local boolean MW4=false
local boolean MX4=false
local boolean MY4=false
local boolean MJ4=false
local boolean MK4=false
local boolean ML4=false
local boolean MM4=false
local boolean MN4=false
local boolean MS4=false
local integer LF4=GetHandleId(GetOwningPlayer(W91))
local unit W41=(LoadUnitHandle(LY,(LF4),(699)))
local unit W51=(LoadUnitHandle(LY,(LF4),(700)))
local unit W61=(LoadUnitHandle(LY,(LF4),(701)))
local unit W71=(LoadUnitHandle(LY,(LF4),(702)))
local unit W81=(LoadUnitHandle(LY,(LF4),(703)))
local integer FH1
local boolean MR4=false
local integer MP4=0
local integer MQ4=0
local integer MU4=0
local integer N04=0
local integer NI4=0
local integer N14=0
local integer NO4=0
local integer N24=0
local integer N34=0
call DisableTrigger(GetTriggeringTrigger())
if GetUnitTypeId(W91)==('H00J')then
	// 修正给米波分身上林肯导致分身鞋子掉落的BUG
	if UnitItemInSlot(W91, 0) == GetManipulatedItem() then
		call UnitRemoveItemFromSlot(W91,0)
	endif
	call EnableTrigger(GetTriggeringTrigger())
	return
endif
if not(GetItemTypeId(GetManipulatedItem())==(FR0[G40])or GetItemTypeId(GetManipulatedItem())==(FR0[ZK0])or GetItemTypeId(GetManipulatedItem())==(FR0[ZN0])or GetItemTypeId(GetManipulatedItem())==(FR0[ZM0])or GetItemTypeId(GetManipulatedItem())==(FR0[ZL0])or GetItemTypeId(GetManipulatedItem())==(FR0[XI0])or GetItemTypeId(GetManipulatedItem())==(FR0[X90])or GetItemTypeId(GetManipulatedItem())==(FR0[Z00])or GetItemTypeId(GetManipulatedItem())==(FR0[ZI0]))then
call EnableTrigger(GetTriggeringTrigger())
return
endif
call MUDisableItemTrigger()
if GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM then
set MR4=true
endif
loop
exitwhen i>5
set FH1=GetItemTypeId(UnitItemInSlot(W91,i))
if FH1==(FR0[G40])then
set MP4=MP4+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(MP4>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MW4=true
endif
endif
if FH1==(FR0[ZK0])then
set MQ4=MQ4+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(MQ4>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MX4=true
endif
endif
if FH1==(FR0[ZN0])then
set MU4=MU4+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(MU4>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MY4=true
endif
endif
if FH1==(FR0[ZM0])then
set N04=N04+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(N04>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MJ4=true
endif
endif
if FH1==(FR0[ZL0])then
set NI4=NI4+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(NI4>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MK4=true
endif
endif
if FH1==(FR0[XI0])then
set N14=N14+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(N14>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set ML4=true
endif
endif
if FH1==(FR0[X90])then
set NO4=NO4+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(NO4>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MM4=true
endif
endif
if FH1==(FR0[Z00])then
set N24=N24+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(N24>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MN4=true
endif
endif
if FH1==(FR0[ZI0])then
set N34=N34+1
if(not(MR4 and FH1==GetItemTypeId(GetManipulatedItem())))or(N24>1 and FH1==GetItemTypeId(GetManipulatedItem()))then
set MS4=true
endif
endif
set i=i+1
endloop
call RemoveItem(UnitRemoveItemFromSlot(W51,0))
if W61!=null then
call RemoveItem(UnitRemoveItemFromSlot(W61,0))
endif
if W71!=null then
call RemoveItem(UnitRemoveItemFromSlot(W71,0))
endif
if W81!=null then
call RemoveItem(UnitRemoveItemFromSlot(W81,0))
endif
if MS4 then
call UnitAddItem(W51,CreateItem((FR0[ZI0]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[ZI0]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[ZI0]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[ZI0]),0,0))
endif
elseif MN4 then
call UnitAddItem(W51,CreateItem((FR0[Z00]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[Z00]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[Z00]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[Z00]),0,0))
endif
elseif MM4 then
call UnitAddItem(W51,CreateItem((FR0[X90]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[X90]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[X90]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[X90]),0,0))
endif
elseif ML4 then
call UnitAddItem(W51,CreateItem((FR0[XI0]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[XI0]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[XI0]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[XI0]),0,0))
endif
elseif MK4 then
call UnitAddItem(W51,CreateItem((FR0[ZL0]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[ZL0]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[ZL0]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[ZL0]),0,0))
endif
elseif MJ4 then
call UnitAddItem(W51,CreateItem((FR0[ZM0]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[ZM0]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[ZM0]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[ZM0]),0,0))
endif
elseif MY4 then
call UnitAddItem(W51,CreateItem((FR0[ZN0]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[ZN0]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[ZN0]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[ZN0]),0,0))
endif
elseif MX4 then
call UnitAddItem(W51,CreateItem((FR0[ZK0]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[ZK0]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[ZK0]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[ZK0]),0,0))
endif
elseif MW4 then
call UnitAddItem(W51,CreateItem((FR0[G40]),0,0))
if W61!=null then
call UnitAddItem(W61,CreateItem((FR0[G40]),0,0))
endif
if W71!=null then
call UnitAddItem(W71,CreateItem((FR0[G40]),0,0))
endif
if W81!=null then
call UnitAddItem(W81,CreateItem((FR0[G40]),0,0))
endif
endif
call EnableTrigger(GetTriggeringTrigger())
call MUEnableItemTrigger()
endfunction
function N44 takes unit N54,integer N64 returns nothing
local integer LF4=GetHandleId(GetOwningPlayer(N54))
local unit W41=(LoadUnitHandle(LY,(LF4),(699)))
local unit W51=(LoadUnitHandle(LY,(LF4),(700)))
local unit W61=(LoadUnitHandle(LY,(LF4),(701)))
local unit W71=(LoadUnitHandle(LY,(LF4),(702)))
local unit W81=(LoadUnitHandle(LY,(LF4),(703)))
if W41!=null and W41!=N54 then
call SelectHeroSkill(W41,N64)
endif
if W51!=null and W51!=N54 then
call SelectHeroSkill(W51,N64)
endif
if W61!=null and W61!=N54 then
call SelectHeroSkill(W61,N64)
endif
if W71!=null and W71!=N54 then
call SelectHeroSkill(W71,N64)
endif
if W81!=null and W81!=N54 then
call SelectHeroSkill(W81,N64)
endif
endfunction
function N74 takes integer IB1,unit H02,unit HI2 returns nothing
local integer TGI=1
local integer THI=GetUnitAbilityLevel(H02,IB1)
loop
exitwhen TGI>THI
call SelectHeroSkill(HI2,IB1)
set TGI=TGI+1
endloop
endfunction
function N84 takes unit MV4,unit N94 returns nothing
call AddHeroXP(MV4,GetHeroXP(N94),false)
call SaveInteger(LY,(GetHandleId(MV4)),(368),(GetHeroXP(N94)))
call SaveInteger(LY,(GetHandleId(MV4)),(367),(0))
call N74(('A0N8'),N94,MV4)
call N74(('A0NB'),N94,MV4)
call N74(('A0N7'),N94,MV4)
call N74('Aamk',N94,MV4)
call N74(('A0MW'),N94,MV4)
call N74('A27C',N94,MV4)
endfunction
function NA4 takes unit W51,unit W61,integer N64,integer MP4,integer MQ4 returns nothing
if MP4>MQ4 then
call SelectHeroSkill(W61,N64)
elseif MQ4>MP4 then
call SelectHeroSkill(W51,N64)
endif
endfunction
function NB4 takes unit W51,unit W61 returns nothing
local integer M64=GetHeroXP(W51)
local integer M74=GetHeroXP(W61)
local integer LN4=GetHandleId(W51)
local integer LS4=GetHandleId(W61)
local integer M04=(LoadInteger(LY,(LN4),(368)))
local integer M14=(LoadInteger(LY,(LS4),(368)))
local integer GV2
if M64>M74 then
set GV2=M64-M74
call AddHeroXP(W61,GV2,true)
if M74!=GetHeroXP(W61)then
call SaveInteger(LY,(LS4),(368),(M14+GV2))
endif
elseif M64<M74 then
set GV2=M74-M64
call AddHeroXP(W51,GV2,true)
if M64!=GetHeroXP(W51)then
call SaveInteger(LY,(LN4),(368),(M04+GV2))
endif
endif
endfunction
function NC4 takes unit W51,unit W61 returns nothing
local integer ND4=GetUnitAbilityLevel(W51,('A0N8'))
local integer NE4=GetUnitAbilityLevel(W51,('A0NB'))
local integer NF4=GetUnitAbilityLevel(W51,('A0N7'))
local integer NG4=GetUnitAbilityLevel(W51,('A0MW'))
local integer NH4=GetUnitAbilityLevel(W51,'Aamk')
local integer NZ4=GetUnitAbilityLevel(W51,'A27C')
local integer NV4=GetUnitAbilityLevel(W61,('A0N8'))
local integer NW4=GetUnitAbilityLevel(W61,('A0NB'))
local integer NX4=GetUnitAbilityLevel(W61,('A0N7'))
local integer NY4=GetUnitAbilityLevel(W61,('A0MW'))
local integer NJ4=GetUnitAbilityLevel(W61,'Aamk')
local integer NK4=GetUnitAbilityLevel(W61,'A27C')
call NB4(W51,W61)
call NA4(W51,W61,('A0N8'),ND4,NV4)
call NA4(W51,W61,('A0NB'),NE4,NW4)
call NA4(W51,W61,('A0N7'),NF4,NX4)
call NA4(W51,W61,('A0MW'),NG4,NY4)
call NA4(W51,W61,'A27C',NZ4,NK4)
call NA4(W51,W61,'Aamk',NH4,NJ4)
endfunction
function NL4 takes unit W51,unit W61 returns nothing
if W51!=null and W61!=null then
call NC4(W51,W61)
endif
endfunction
function NM4 takes nothing returns nothing
local integer LF4=GetHandleId((LoadPlayerHandle(LY,(GetHandleId(GetTriggeringTrigger())),(370))))
local unit W41=(LoadUnitHandle(LY,(LF4),(699)))
local unit W51=(LoadUnitHandle(LY,(LF4),(700)))
local unit W61=(LoadUnitHandle(LY,(LF4),(701)))
local unit W71=(LoadUnitHandle(LY,(LF4),(702)))
local unit W81=(LoadUnitHandle(LY,(LF4),(703)))
call DisableTrigger(HQI)
call NL4(W41,W51)
call NL4(W41,W61)
call NL4(W41,W71)
call NL4(W41,W81)
call NL4(W51,W61)
call NL4(W51,W71)
call NL4(W51,W81)
call NL4(W61,W71)
call NL4(W61,W81)
call NL4(W71,W81)
call EnableTrigger(HQI)
endfunction
function NN4 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddAction(t,function NM4)
call SavePlayerHandle(LY,(GetHandleId(t)),(370),(GetOwningPlayer(GetTriggerUnit())))
endfunction
function NS4 takes unit hero returns nothing
local trigger t
call SaveUnitHandle(LY,(GetHandleId(GetOwningPlayer(hero))),(699),(hero))
call SaveInteger(LY,(GetHandleId(hero)),(367),(GetHeroXP(hero)))
call SaveInteger(LY,(GetHandleId(hero)),(368),(0))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddAction(t,function LL4)
call SavePlayerHandle(LY,(GetHandleId(t)),(370),(GetOwningPlayer(hero)))
call SaveTriggerHandle(LY,(GetHandleId(GetOwningPlayer(hero))),(371),(t))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.3,true)
call TriggerAddAction(t,function LD4)
call SavePlayerHandle(LY,(GetHandleId(t)),(370),(GetOwningPlayer(hero)))
call SaveTriggerHandle(LY,(GetHandleId(GetOwningPlayer(hero))),(372),(t))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddAction(t,function MG4)
call TriggerAddCondition(t,Condition(function MF4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call TriggerAddAction(t,function MT4)
call TriggerAddCondition(t,Condition(function MH4))
call SaveTriggerHandle(LY,(GetHandleId(GetOwningPlayer(hero))),(369),(t))
call ExecuteFunc("NN4")
endfunction
function NT4 takes unit hero,boolean G4O returns nothing
local player T4I=GetOwningPlayer(hero)
local integer handle_id=GetHandleId(T4I)
local unit MV4
set HUI=HUI+1
if HUI==1 then
call NS4(hero)
endif
call TriggerExecute((LoadTriggerHandle(LY,(GetHandleId(GetOwningPlayer(hero))),(371))))
call TriggerExecute((LoadTriggerHandle(LY,(GetHandleId(GetOwningPlayer(hero))),(372))))
if G4O==false then
call N44(hero,'A0MW')
call N44(hero,'A27C')
endif
set MV4=CreateUnit(GetOwningPlayer(hero),'H00J',GetUnitX(hero),GetUnitY(hero),0)
call N84(MV4,hero)
call MZ4(MV4,hero)
call SaveUnitHandle(LY,(handle_id),(699+HUI),(MV4))
endfunction
function X9O takes nothing returns nothing
if Z0I==false then
set Z0I=true
call DisableTrigger(HQI)
call NT4(GK,true)
call EnableTrigger(HQI)
endif
endfunction
function NR4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if IsUnitIllusion(GetTriggerUnit())==false and GetOwningPlayer(GetTriggerUnit())==GetOwningPlayer(hero)and LB4(GetTriggerUnit())then
if GetLearnedSkill()=='A0MW' or GetLearnedSkill()=='A27C' then
call DisableTrigger(GetTriggeringTrigger())
call NT4(GetTriggerUnit(),false)
call EnableTrigger(GetTriggeringTrigger())
elseif GetLearnedSkill()=='Aamk' or GetLearnedSkill()=='A0N8' or GetLearnedSkill()=='A0NB' or GetLearnedSkill()=='A0N7' then
call TriggerExecute((LoadTriggerHandle(LY,(GetHandleId(GetOwningPlayer(GetTriggerUnit()))),(371))))
call TriggerExecute((LoadTriggerHandle(LY,(GetHandleId(GetOwningPlayer(GetTriggerUnit()))),(372))))
call DisableTrigger(GetTriggeringTrigger())
call N44(GetTriggerUnit(),GetLearnedSkill())
call EnableTrigger(GetTriggeringTrigger())
endif
endif
return false
endfunction
function K24 takes nothing returns nothing
local unit hero=GK
local integer handle_id
set HPI=CreateTrigger()
set HQI=HPI
set handle_id=GetHandleId(HPI)
call UMI(HPI,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(HPI,Condition(function NR4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
endfunction
function NP4 takes nothing returns nothing
local location point=GetSpellTargetLoc()
call U7I("Abilities\\Spells\\Orc\\EarthQuake\\EarthQuakeTarget.mdl",GetLocationX(point),GetLocationY(point),2)
call TerrainDeformationRippleBJ(0.3,false,point,0,300,100,0.4,20)
call RemoveLocation(point)
set point=null
endfunction
function NQ4 takes nothing returns boolean
if GetSpellAbilityId()=='A06W' then
call NP4()
endif
return false
endfunction
function KK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NQ4))
endfunction
function GenericCondition_BasicsAndStructureNoInvul takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false and BL1(GetFilterUnit())==false
endfunction
function NU4 takes nothing returns boolean
return IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false and BL1(GetFilterUnit())==false)
endfunction
function S04 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g
local unit u
local real d
local real a
local real UJ2
local real UK2
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real PAI
if GetTriggerEvalCount(t)>40 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=SFI
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),500,Condition(function NU4))
set u=GroupPickRandomUnit(g)
if u==null then
set d=GetRandomReal(175,400)
set a=GetRandomReal(0,6)
set UJ2=GetUnitX(SFI)+d*Cos(a)
set UK2=GetUnitY(SFI)+d*Sin(a)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\SteamTank\\SteamTankImpact.mdl",UJ2,UK2))
else
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\SteamTank\\SteamTankImpact.mdl",u,"origin"))
set PAI=9*level
if IsUnitType(u,UNIT_TYPE_STRUCTURE)==true then
set PAI=PAI*1.4
endif
call Damage(dummy,u,2,PAI)
endif
call NSI(g)
endif
set u=null
set g=null
set t=null
set SFI=null
return false
endfunction
function SI4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\RocketMissile\\RocketMissile.mdl",SFI,"hand right"))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(SFI,'A20T')))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function S04))
set t=null
set SFI=null
endfunction
function S14 takes nothing returns boolean
if GetSpellAbilityId()=='A20T' then
call SI4()
endif
return false
endfunction
function KL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function S14))
endfunction
function SO4 takes unit hero,unit target returns nothing
call AX1(target,'A2WZ',1,0.75,'B0H6')
endfunction
function S24 takes nothing returns nothing
local real d
if IsUnitInGroup(GetEnumUnit(),ZOI)==false then
set d=QLI(GetEnumUnit(),Z1I)
if d<Z2I then
set Z2I=d
set ZII=GetEnumUnit()
endif
endif
endfunction
function S34 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A06V')
call GroupAddUnit(PR2,target)
call SO4(hero,target)
set GK=hero
set ZII=null
set Z1I=target
set ZOI=PR2
set Z2I=999999
call GroupEnumUnitsInRange(g,x,y,650+25,Condition(function CF1))
call ForGroup(g,function S24)
call NSI(g)
if ZII==null or GetTriggerEvalCount(t)>3+level then
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set target=ZII
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set g=null
set t=null
set hero=null
set target=null
set PR2=null
return false
endfunction
function S44 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group PR2=NTI()
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveGroupHandle(LY,(handle_id),(187),(PR2))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function S34))
set hero=null
set target=null
set t=null
endfunction
function S54 takes nothing returns boolean
if GetSpellAbilityId()=='A06V' and CanResistSkill(GetSpellTargetUnit())==false then
call S44()
endif
return false
endfunction
function KM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function S54))
set t=null
endfunction
function S64 takes nothing returns nothing
local unit hero=Z3I
local unit target=GetEnumUnit()
call Damage(hero,target,1,Z4I)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Doom\\DoomDeath.mdl",target,"origin"))
set hero=null
set target=null
endfunction
function S74 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A21F')
local group g
if level!=0 then
if level==1 then
set Z4I=100
elseif level==2 then
set Z4I=130
else
set Z4I=160
endif
else
set level=GetUnitAbilityLevel(hero,'A21G')
if level==1 then
set Z4I=160
elseif level==2 then
set Z4I=190
else
set Z4I=220
endif
endif
if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetUnitState(hero,UNIT_STATE_MANA)<20*level or(LoadInteger(LY,(GetHandleId(hero)),(704)))==-1 or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and(GetSpellAbilityId()=='A21H' or GetSpellAbilityId()=='A27H'))then
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A21F' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21F',true)
endif
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A21G' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21G',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21H',false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT then
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)-20*level)
set GK=hero
set Z3I=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),475,Condition(function CA1))
call ForGroup(g,function S64)
call NSI(g)
set g=null
endif
set t=null
return false
endfunction
function S84 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Doom\\DoomDeath.mdl",hero,"origin"))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21F',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21G',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A21H',true)
call UnitAddAbility(hero,'A21H')
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function S74))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerEvaluate(t)
set hero=null
set t=null
endfunction
function S94 takes nothing returns boolean
if GetSpellAbilityId()=='A21F' or GetSpellAbilityId()=='A21G' then
call S84()
endif
return false
endfunction
function KN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function S94))
set t=null
endfunction
function SA4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(813)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()==EVENT_WIDGET_DEATH or LVO<(TimerGetElapsed(M))then
call UnitRemoveAbility(target,'A2U1')
call UnitRemoveAbility(target,'B0GV')
call UnitRemoveAbility(target,'A2U2')
call UnitRemoveAbility(target,'B0GW')
call UnitRemoveAbility(target,'A2U4')
endif
set t=null
set target=null
return false
endfunction
function SB4 takes unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real DC1=3.0
local integer SC4='A2U2'
local integer SD4='B0GW'
if IsUnitType(target,UNIT_TYPE_HERO)then
set DC1=2.0
endif
set SC4='A2U1'
set SD4='B0GV'
call AddSkill(target,SC4)
call AddSkill(target,SD4)
call AddSkill(target,'A2U4')
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,DC1,false)
call TriggerAddCondition(t,Condition(function SA4))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(GetHandleId(target)),(813),(((TimerGetElapsed(M))+DC1-0.1)*1.0))
set t=null
endfunction
function SE4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(812)))
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetTriggerUnit()==target then
call SB4(GetAttacker())
endif
elseif(TimerGetElapsed(M))>LVO then
call UnitRemoveAbility(target,'A2U0')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function SF4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t
local integer handle_id
local integer DC1=40
local integer level=GetUnitAbilityLevel(hero,'A08R')
local real LVO=(LoadReal(LY,(GetHandleId(target)),(812)))
call SaveReal(LY,(GetHandleId(target)),(812),(((TimerGetElapsed(M))+DC1)*1.0))
call AddSkill(target,'A2U0')
call SetUnitAbilityLevel(target,'A2U0',level)
if LVO<(TimerGetElapsed(M))then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function SE4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set hero=null
set target=null
set t=null
endfunction
function SG4 takes nothing returns boolean
if GetSpellAbilityId()=='A08R' then
call SF4()
endif
return false
endfunction
function KS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SG4))
set t=null
endfunction
function SH4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit WF3=(LoadUnitHandle(LY,(handle_id),(374)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer SZ4=(LoadInteger(LY,(handle_id),(233)))
local integer MKO=(LoadInteger(LY,(handle_id),(12)))
local unit dummy
local group g
local real a
local real x
local real y
local integer DT1=(LoadInteger(LY,(handle_id),(720)))
if DT1>0 then
set DT1=DT1-1
call SaveInteger(LY,(handle_id),(720),(DT1))
return false
endif
if QNI(GetUnitX(WF3),GetUnitY(WF3),GetUnitX(target),GetUnitY(target))>20 then
set a=UEI(GetUnitX(WF3),GetUnitY(WF3),GetUnitX(target),GetUnitY(target))
call SetUnitFacing(WF3,a)
set x=GetUnitX(WF3)+13.5*Cos(a*bj_DEGTORAD)
set y=GetUnitY(WF3)+13.5*Sin(a*bj_DEGTORAD)
call MUSetUnitX(WF3,x)
call MUSetUnitY(WF3,y)
else
if IsUnitDead(target)==false then
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A091')
call SetUnitAbilityLevel(dummy,'A091',level)
call IssueTargetOrder(dummy,"frostnova",target)
endif
if SZ4>MKO then
call RemoveUnit(WF3)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),600,Condition(function C81))
call GroupRemoveUnit(g,target)
set target=GroupPickRandomUnit(g)
call NSI(g)
if target==null then
call RemoveUnit(WF3)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveInteger(LY,(handle_id),(720),(10))
call SaveInteger(LY,(handle_id),(233),(SZ4+1))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
endif
endif
set t=null
set hero=null
set target=null
set WF3=null
set dummy=null
set g=null
return false
endfunction
function SV4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A05T')
local integer MKO=10
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit WF3
if GetSpellAbilityId()=='A08H' then
set level=GetUnitAbilityLevel(hero,'A08H')+1
set MKO=100000
endif
set WF3=CreateUnit(GetOwningPlayer(hero),'e009',GetUnitX(hero),GetUnitY(hero),0)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(374),(WF3))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(233),(1))
call SaveInteger(LY,(handle_id),(12),(MKO))
call SaveInteger(LY,(handle_id),(720),(0))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function SH4))
set hero=null
set target=null
set WF3=null
set t=null
endfunction
function SW4 takes nothing returns boolean
if GetSpellAbilityId()=='A05T' or GetSpellAbilityId()=='A08H' then
call SV4()
endif
return false
endfunction
function KT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SW4))
set t=null
endfunction
function SX4 takes nothing returns nothing
if B81(GetUnitTypeId(GetEnumUnit()))==false then
set Z5I=Z5I+1
endif
endfunction
function SY4 takes nothing returns nothing
if B81(GetUnitTypeId(GetFilterUnit()))==false then
call AddHeroXP(GetEnumUnit(),Z6I,true)
endif
endfunction
function SJ4 takes unit target returns nothing
local group g=NTI()
local integer SK4=ALO(target)
set Z5I=0
set GK=target
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),1300+25,Condition(function DO1))
call ForGroup(g,function SX4)
if Z5I>0 then
set Z6I=SK4/Z5I
call ForGroup(g,function SY4)
endif
call NSI(g)
set Z5I=0
set GK=target
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),1300+25,Condition(function CU1))
call ForGroup(g,function SX4)
if Z5I>0 then
set Z6I=SK4/Z5I
call ForGroup(g,function SY4)
endif
call NSI(g)
set g=null
endfunction
function SL4 takes unit u,integer d returns nothing
local texttag t=CreateTextTag()
call SetTextTagText(t,"+"+I2S(d)+" "+"法力",0.03)
call SetTextTagPosUnit(t,u,0)
call SetTextTagColorBJ(t,50,75,255,15)
call SetTextTagVelocity(t,0,0.035)
call SetTextTagFadepoint(t,3)
call SetTextTagLifespan(t,2.5)
call SetTextTagPermanent(t,false)
call SetTextTagVisibility(t,false)
call SetTextTagVisibility(t,true)
if IsUnitVisible(u,GetLocalPlayer())or P0I(GetLocalPlayer())then
call SetTextTagVisibility(t,true)
else
call SetTextTagVisibility(t,false)
endif
set t=null
endfunction
function SM4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A053')
local real OA2=GetUnitState(target,UNIT_STATE_LIFE)*(level*0.15+0.1)
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+OA2)
call SL4(target,R2I(OA2))
call SJ4(target)
call KillUnit(target)
set hero=null
set target=null
endfunction
function SN4 takes nothing returns boolean
if GetSpellAbilityId()=='A053' and RYI(GetSpellTargetUnit())==false then
call SM4()
endif
return false
endfunction
function KR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SN4))
set t=null
endfunction
function SS4 takes nothing returns nothing
local location point
local unit SFI=GetTriggerUnit()
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real a
local real x2
local real y2
local integer level=GetUnitAbilityLevel(SFI,'A0X5')
local real PAI
local real DC1
local unit DT1=null
if GetSpellTargetUnit()!=null then
set point=GetUnitLoc(GetSpellTargetUnit())
else
set point=GetSpellTargetLoc()
endif
set x2=GetLocationX(point)
set y2=GetLocationY(point)
set a=Atan2(y2-y1,x2-x1)
set x2=x1+700*Cos(a)
set y2=y1+700*Sin(a)
if level==1 then
set PAI=80
set DC1=0.5
elseif level==2 then
set PAI=140
set DC1=1
elseif level==3 then
set PAI=200
set DC1=1.5
elseif level==4 then
set PAI=260
set DC1=2
endif
if GetSpellTargetUnit()!=null and CanResistSkill(GetSpellTargetUnit())then
set DT1=GetSpellTargetUnit()
endif
call DS1(SFI,DT1,PAI,DC1,0.52,x1,y1,x2,y2,150,null,true,1600)
call RemoveLocation(point)
set point=null
set SFI=null
endfunction
function ST4 takes nothing returns boolean
if GetSpellAbilityId()=='A0X5' then
call SS4()
endif
return false
endfunction
function TI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ST4))
call Q1I('A0X6')
set t=null
endfunction
function SR4 takes nothing returns boolean
if(GetSpellAbilityId()=='A095' or GetSpellAbilityId()=='A09W')and RKI(GetSpellTargetUnit())then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"目标免疫魔法")
endif
return false
endfunction
function T11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function SR4))
set t=null
endfunction
function SP4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosDone.mdl",SFI,"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\FeralSpirit\\feralspirittarget.mdl",SFI,"origin"))
set t=null
set SFI=null
return false
endfunction
function SQ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call KillUnit(dummy)
endif
call UnitRemoveAbility(SFI,'A0ZC')
call UnitRemoveAbility(SFI,'B00V')
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerRegisterDeathEvent(t,SFI)
call TriggerAddCondition(t,Condition(function SP4))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
set t=null
set SFI=null
set dummy=null
return false
endfunction
function SU4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real H71=(LoadReal(LY,(handle_id),(6)))
local real H81=(LoadReal(LY,(handle_id),(7)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call H61(SFI,H71,H81,650)
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
endif
set t=null
set SFI=null
return false
endfunction
function T04 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosDone.mdl",SFI,"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\FeralSpirit\\feralspirittarget.mdl",SFI,"origin"))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,18-0.1,false)
call TriggerRegisterDeathEvent(t,SFI)
call TriggerAddCondition(t,Condition(function SQ4))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.005,true)
call TriggerRegisterDeathEvent(t,dummy)
call TriggerAddCondition(t,Condition(function SU4))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
set t=null
set SFI=null
set dummy=null
return false
endfunction
function TI4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e01V',0,0,0)
local real DC1=18
call AddSkill(dummy,'A0ZC')
call UnitApplyTimedLife(dummy,'BTLF',DC1)
call A91(SFI,DC1,175)
call TriggerRegisterTimerEvent(t,0.1,false)
call TriggerAddCondition(t,Condition(function T04))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
set t=null
set SFI=null
endfunction
function T14 takes nothing returns boolean
if GetSpellAbilityId()=='A093' and GetUnitTypeId(GetTriggerUnit())=='U008' then
call TI4()
endif
return false
endfunction
function T51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function T14))
set t=null
endfunction
function GW2 takes nothing returns nothing
local unit hero=XM
local unit target=YM
local unit dummy=(LoadUnitHandle(LY,(GetHandleId(hero)),(219)))
call SaveUnitHandle(LY,(GetHandleId(hero)),(219),(dummy))
call SetUnitOwner(dummy,GetOwningPlayer(target),true)
set hero=null
set target=null
set dummy=null
endfunction
function AZO takes nothing returns nothing
local unit SFI=NK
local unit dummy=(LoadUnitHandle(LY,(GetHandleId(SFI)),(219)))
if dummy!=null and GetUnitTypeId(dummy)=='e01V' then
call RemoveUnit(dummy)
endif
endfunction
function TO4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if dummy!=null and GetUnitTypeId(dummy)=='e01V' then
if IsUnitDead(hero)==false then
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
endif
endif
set t=null
set dummy=null
set hero=null
return false
endfunction
function T24 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A03E')
local unit dummy
local trigger t
local integer handle_id
if level==1 then
set dummy=CreateUnit(GetOwningPlayer(SFI),'e01V',0,0,0)
call AddSkill(dummy,'A0ZJ')
call SaveUnitHandle(LY,(GetHandleId(SFI)),(219),(dummy))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerAddCondition(t,Condition(function TO4))
call TriggerRegisterTimerEvent(t,0.2,true)
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
else
set dummy=(LoadUnitHandle(LY,(GetHandleId(SFI)),(219)))
endif
if level==2 then
call UnitRemoveAbility(dummy,'A0ZJ')
call AddSkill(dummy,'A0ZI')
elseif level==3 then
call UnitRemoveAbility(dummy,'A0ZJ')
call UnitRemoveAbility(dummy,'A0ZI')
call AddSkill(dummy,'A0ZH')
elseif level==4 then
call UnitRemoveAbility(dummy,'A0ZJ')
call UnitRemoveAbility(dummy,'A0ZI')
call UnitRemoveAbility(dummy,'A0ZH')
call AddSkill(dummy,'A0ZG')
endif
set SFI=null
set dummy=null
endfunction
function T34 takes nothing returns boolean
if GetLearnedSkill()=='A03E' and IsUnitIllusion(GetTriggerUnit())==false then
call T24()
endif
return false
endfunction
function T61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function T34))
set t=null
endfunction
function T44 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy
local integer i=1
local boolean RZI=IsPlayerTeam1(GetOwningPlayer(SFI))
local player p
local integer T54
local integer T64
local integer level=GetUnitAbilityLevel(SFI,'A0ZF')
if level==1 then
set T54='A104'
set T64='A107'
elseif level==2 then
set T54='A101'
set T64='A106'
elseif level==3 then
set T54='A102'
set T64='A105'
elseif level==4 then
set T54='A103'
set T64='A108'
endif
loop
exitwhen i>5
if RZI then
set p=BO[i]
else
set p=CO[i]
endif
set dummy=CreateUnit(p,'e01V',0,0,0)
call AddSkill(dummy,T54)
call AddSkill(dummy,T64)
call UnitApplyTimedLife(dummy,'BTLF',10)
set i=i+1
endloop
set SFI=null
set dummy=null
set p=null
endfunction
function T74 takes nothing returns boolean
if GetSpellAbilityId()=='A0ZF' then
call T44()
endif
return false
endfunction
function T71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function T74))
set t=null
endfunction
function T84 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A094')
local integer T94=GetHeroLevel(target)
local real PAI=GetUnitState(target,UNIT_STATE_MAX_LIFE)*0.2
if ModuloInteger(T94,7-level)==0 or T94==25 then
call Damage(hero,target,1,PAI)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Demon\\DemonBoltImpact\\DemonBoltImpact.mdl",target,"chest"))
endif
set hero=null
set target=null
endfunction
function TA4 takes nothing returns boolean
if GetSpellAbilityId()=='A094' then
call T84()
endif
return false
endfunction
function KP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TA4))
set t=null
endfunction
function TB4 takes unit hero returns nothing
call UnitRemoveAbility(hero,'A1OQ')
call UnitRemoveAbility(hero,'A1OR')
call UnitRemoveAbility(hero,'A1OS')
call UnitRemoveAbility(hero,'A1OT')
call UnitRemoveAbility(hero,'A1OU')
call UnitRemoveAbility(hero,'A1OV')
call UnitRemoveAbility(hero,'A1OW')
call UnitRemoveAbility(hero,'A1OX')
call UnitRemoveAbility(hero,'A1OY')
call UnitRemoveAbility(hero,'S00M')
call UnitRemoveAbility(hero,'A1OZ')
call UnitRemoveAbility(hero,'S00N')
call UnitRemoveAbility(hero,'A1P0')
call UnitRemoveAbility(hero,'A1P1')
call UnitRemoveAbility(hero,'A1P7')
call UnitRemoveAbility(hero,'A1PA')
call UnitRemoveAbility(hero,'A1P3')
call UnitRemoveAbility(hero,'A1P4')
call UnitRemoveAbility(hero,'A1P5')
call UnitRemoveAbility(hero,'A1P6')
call UnitRemoveAbility(hero,'A2AG')
endfunction
function TC4 takes unit hero,unit target returns nothing
local integer TD4=GetUnitTypeId(target)
local integer TE4=0
local integer TF4=0
if TD4=='n0HX' then
set TE4='A1OQ'
elseif TD4=='nomg' then
set TE4='A1OR'
elseif TD4=='nfpu' then
set TE4='A1OS'
set TF4='S00N'
elseif TD4=='nstl' then
set TE4='A1OT'
elseif TD4=='nsat' then
set TE4='A1OU'
elseif TD4=='nsth' then
set TE4='A1OV'
set TF4='A1OW'
elseif TD4=='n00S' then
set TE4='A1OX'
set TF4='A1OY'
elseif TD4=='nkol' then
set TE4='S00M'
elseif TD4=='nfsh' then
set TE4='A1OZ'
set TF4='A2AG'
elseif TD4=='ncnk' then
set TE4='A1P0'
elseif TD4=='ngns' then
set TE4='A1P1'
elseif TD4=='ngh1' then
set TE4='A1P7'
set TF4='A1PA'
elseif TD4=='nowe' then
set TE4='A1P3'
set TF4='A1P4'
elseif TD4=='ndtw' then
set TE4='A1P5'
set TF4='A1P6'
elseif TD4=='nwlg' then
set TE4='A1OY'
endif
if TE4!=0 then
call TB4(hero)
call AddSkill(hero,TE4)
endif
if TF4!=0 then
call AddSkill(hero,TF4)
endif
endfunction
function TG4 takes real TH4 returns string
local string c1="|c00ff0303"
local string c="||"
local string p=" "
local string s=c1+c+"|r"
local string FB1
if TH4>85 then
set FB1=s+p+s+p+s+p+s+p+s+p+s+p+s
elseif TH4>70 then
set FB1=s+p+s+p+s+p+s+p+s+p+s+p+c
elseif TH4>55 then
set FB1=s+p+s+p+s+p+s+p+s+p+c+p+c
elseif TH4>40 then
set FB1=s+p+s+p+s+p+s+p+c+p+c+p+c
elseif TH4>25 then
set FB1=s+p+s+p+s+p+c+p+c+p+c+p+c
elseif TH4>10 then
set FB1=s+p+s+p+c+p+c+p+c+p+c+p+c
elseif TH4>0 then
set FB1=s+p+c+p+c+p+c+p+c+p+c+p+c
else
set FB1=c+p+c+p+c+p+c+p+c+p+c+p+c
endif
return FB1
endfunction
function TZ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer TV4=(LoadInteger(LY,(handle_id),(230)))
local real HP=(LoadReal(LY,(handle_id),(232)))
local texttag tt=(LoadTextTagHandle(LY,(handle_id),(231)))
local integer NPI=GetTriggerEvalCount(t)
local real TW4=QDI(HP-NPI,0)
local boolean TX4=true
call SetTextTagText(tt,TG4(100*TW4/HP),0.018)
call SetTextTagPosUnit(tt,SFI,0)
if IsUnitVisible(SFI,GetLocalPlayer())==false and P0I(GetLocalPlayer())==false then
set TX4=false
endif
call SetTextTagVisibility(tt,TX4)
if TW4==0 then
call OL1(GetOwningPlayer(SFI),SFI,25*level)
endif
if TW4==0 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A10R',true)
call UnitRemoveAbility(SFI,'A10S')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DestroyTextTag(tt)
endif
set t=null
set SFI=null
return false
endfunction
function TY4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A10R')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real HP=GetUnitState(target,UNIT_STATE_LIFE)
local integer G33=GetUnitLevel(target)
local integer TV4=GetUnitTypeId(target)
local texttag tt=CreateTextTag()
local boolean TX4=true
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',0,0,0)
call UGI("SPLK",GetUnitX(SFI),GetUnitY(SFI),GetUnitX(target),GetUnitY(target),0.1,0.1,0.2,.9,0.5)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\Devour\\DevourEffectArt.mdl",GetUnitX(target),GetUnitY(target)))
if IsUnitVisible(SFI,GetLocalPlayer())==false then
set TX4=false
endif
call TC4(SFI,target)
call SetTextTagText(tt,TG4(100),0.018)
call SetTextTagPosUnit(tt,SFI,0)
call SetTextTagVisibility(tt,TX4)
call SetTextTagPermanent(tt,true)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A10R',false)
call AddSkill(SFI,'A10S')
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveTextTagHandle(LY,(handle_id),(231),(tt))
call SaveInteger(LY,(handle_id),(230),(TV4))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(232),((HP)*1.0))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function TZ4))
call ShowUnit(target,false)
call UnitRemoveBuffs(target,true,true)
call UnitRemoveAbility(target,'Aetl')
call UnitDamageTarget(dummy,target,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
set t=null
set SFI=null
set target=null
endfunction
function TJ4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A10R')
local integer G33=GetUnitLevel(target)
if(GetOwningPlayer(target)!=BO[0]and GetOwningPlayer(target)!=CO[0])and((level==1 and G33>2)or(level==2 and G33>4)or(level==3 and G33>5)or(level==4 and G33>6))then
endif
set SFI=null
set target=null
endfunction
function TK4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer id=(LoadInteger(LY,(handle_id),(34)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function TL4 takes nothing returns nothing
local integer id=GetSpellAbilityId()
local trigger t
local integer handle_id
if id=='A1OQ' or id=='A1OR' or id=='A1OS' or id=='A1OT' or id=='A1OU' or id=='A1OV' or id=='A1OW' or id=='A1OX' or id=='A1OY' or id=='S00M' or id=='A1OZ' or id=='S00N' or id=='A1P0' or id=='A1P1' or id=='A1P2' or id=='A1P3' or id=='A1P4' or id=='A1P5' or id=='A1P6' then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function TK4))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveInteger(LY,(handle_id),(34),(id))
set t=null
endif
endfunction
function TM4 takes nothing returns boolean
if GetSpellAbilityId()=='A10R' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call TJ4()
else
call TY4()
endif
elseif GetUnitTypeId(GetTriggerUnit())=='UC42' then
call TL4()
endif
return false
endfunction
function KQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function TM4))
set t=null
endfunction
function TN4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'A1OL')
call UnitRemoveAbility(hero,'A1ON')
call UnitRemoveAbility(hero,'A1OO')
call UnitRemoveAbility(hero,'A1OM')
call UnitRemoveAbility(hero,'B04J')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function TS4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1OP')
if level==1 then
call AddSkill(hero,'A1OL')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1OL',false)
elseif level==2 then
call AddSkill(hero,'A1ON')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1ON',false)
elseif level==3 then
call AddSkill(hero,'A1OO')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1OO',false)
elseif level==4 then
call AddSkill(hero,'A1OM')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1OM',false)
endif
call TriggerRegisterTimerEvent(t,8+2*level,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function TN4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function TT4 takes nothing returns boolean
if GetSpellAbilityId()=='A1OP' then
call TS4()
endif
return false
endfunction
function KU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TT4))
set t=null
endfunction
function TR4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if QLI(hero,target)>900 or IsUnitDead(hero)==true then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if NPI>16*10 then
call UnitRemoveAbility(target,'BNdo')
call UnitRemoveAbility(target,'B0HM')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetUnitAbilityLevel(target,'BNdo')==0 and GetUnitAbilityLevel(target,'B0HM')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function TP4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A0MU')
local real PAI=5+15*level
if level==0 then
set level=GetUnitAbilityLevel(hero,'A0A2')
set PAI=20+20*level
endif
if GetUnitAbilityLevel(target,'BNdo')==0 and GetUnitAbilityLevel(target,'B0HM')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call Damage(hero,target,7,PAI)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function TQ4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function TP4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
if GetSpellAbilityId()=='A0A2' then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UnitRemoveBuffs(target,true,false)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function TR4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(34),(0))
endif
set hero=null
set target=null
set t=null
endfunction
function TU4 takes nothing returns boolean
if GetSpellAbilityId()=='A0MU' or GetSpellAbilityId()=='A0A2' then
if CanResistSkill(GetSpellTargetUnit())==false then
call TQ4()
endif
endif
return false
endfunction
function L01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TU4))
set t=null
endfunction
function R04 takes nothing returns boolean
local real x
local real y
if(IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))then
set x=Z7I+GetRandomReal(20,70)*Cos(GetUnitFacing(GetTriggerUnit())*bj_DEGTORAD)
set y=Z8I+GetRandomReal(20,70)*Sin(GetUnitFacing(GetTriggerUnit())*bj_DEGTORAD)
call SetUnitPosition(GetFilterUnit(),x,y)
endif
return false
endfunction
function RI4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local group g=NTI()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',x,y,0)
local integer level=GetUnitAbilityLevel(SFI,'A29L')
set Z7I=GetUnitX(SFI)+100*Cos(GetUnitFacing(SFI)*bj_DEGTORAD)
set Z8I=GetUnitY(SFI)+100*Sin(GetUnitFacing(SFI)*bj_DEGTORAD)
call GroupEnumUnitsInRange(g,x,y,410+24,Condition(function R04))
call NSI(g)
call AddSkill(dummy,'A06F')
call SetUnitAbilityLevel(dummy,'A06F',level)
call IssueImmediateOrder(dummy,"stomp")
set SFI=null
set g=null
endfunction
function R14 takes nothing returns boolean
if GetSpellAbilityId()=='A29L' then
call RI4()
endif
return false
endfunction
function LI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function R14))
set t=null
endfunction
function RO4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetUnitAbilityLevel(target,'B00U')==0 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(target,'A1Q0')
call UnitRemoveAbility(target,'A1Q1')
call UnitRemoveAbility(target,'A1Q2')
call UnitRemoveAbility(target,'A1Q3')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function R24 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A037')
local integer OO1
if level==1 then
set OO1='A1Q0'
elseif level==2 then
set OO1='A1Q1'
elseif level==3 then
set OO1='A1Q2'
elseif level==4 then
set OO1='A1Q3'
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(target),OO1,false)
call AddSkill(target,OO1)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function RO4))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function R34 takes nothing returns boolean
if GetSpellAbilityId()=='A037' then
call R24()
endif
return false
endfunction
function L11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function R34))
set t=null
endfunction
function R44 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitRemoveAbility(target,'A1Q6')
call UnitRemoveAbility(target,'B0CX')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function R54 takes unit hero,unit target,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitPathing(target,true)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function R44))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(target,'A1Q6')
call UnitMakeAbilityPermanent(target,true,'A1Q6')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A1Q6',false)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\HumanBloodKnight.mdl",target,"chest"))
call Damage(hero,target,1,70*level)
set t=null
endfunction
function R64 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit R74=(LoadUnitHandle(LY,(handle_id),(393)))
local unit R84=(LoadUnitHandle(LY,(handle_id),(394)))
local unit R94=(LoadUnitHandle(LY,(handle_id),(395)))
local unit RA4=(LoadUnitHandle(LY,(handle_id),(396)))
local unit RB4=(LoadUnitHandle(LY,(handle_id),(397)))
local unit RC4=(LoadUnitHandle(LY,(handle_id),(398)))
local unit RD4=(LoadUnitHandle(LY,(handle_id),(399)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real IO3=(LoadReal(LY,(handle_id),(6)))
local real I23=(LoadReal(LY,(handle_id),(7)))
local real IV1=PPI(IO3+19*Cos(RM2))
local real IW1=Q0I(I23+19*Sin(RM2))
local group g
local integer RE4=(LoadInteger(LY,(handle_id),(12)))
local location point
call SetUnitPosition(hero,IV1,IW1)
call SetUnitFacing(hero,RM2*bj_RADTODEG)
call SaveReal(LY,(handle_id),(6),((IV1)*1.0))
call SaveReal(LY,(handle_id),(7),((IW1)*1.0))
if ModuloInteger(GetTriggerEvalCount(t),4)==0 then
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\AncientProtectorMissile\\AncientProtectorMissile.mdl",IV1,IW1))
endif
if GetTriggerEvalCount(t)==2 then
call SetUnitAnimationByIndex(hero,3)
endif
if R74==null or R84==null or R94==null or RA4==null or RB4==null or RC4==null or RD4==null then
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,IV1,IW1,125+25,Condition(function D21))
if FirstOfGroup(g)!=null then
if R74!=null then
call GroupRemoveUnit(g,R74)
endif
if R84!=null then
call GroupRemoveUnit(g,R84)
endif
if R94!=null then
call GroupRemoveUnit(g,R94)
endif
if RA4!=null then
call GroupRemoveUnit(g,RA4)
endif
if RB4!=null then
call GroupRemoveUnit(g,RB4)
endif
if RC4!=null then
call GroupRemoveUnit(g,RC4)
endif
if RD4!=null then
call GroupRemoveUnit(g,RD4)
endif
if FirstOfGroup(g)!=null then
if R74==null then
set R74=FirstOfGroup(g)
call SetUnitPathing(R74,false)
call SCI(R74,4404,5)
elseif R84==null then
set R84=FirstOfGroup(g)
call SetUnitPathing(R84,false)
call SCI(R84,4404,5)
elseif R94==null then
set R94=FirstOfGroup(g)
call SetUnitPathing(R94,false)
call SCI(R94,4404,5)
elseif RA4==null then
set RA4=FirstOfGroup(g)
call SetUnitPathing(RA4,false)
call SCI(RA4,4404,5)
elseif RB4==null then
set RB4=FirstOfGroup(g)
call SetUnitPathing(RB4,false)
call SCI(RB4,4404,5)
elseif RC4==null then
set RC4=FirstOfGroup(g)
call SetUnitPathing(RC4,false)
call SCI(RC4,4404,5)
elseif RD4==null then
set RD4=FirstOfGroup(g)
call SetUnitPathing(RD4,false)
call SCI(RD4,4404,5)
endif
endif
endif
call NSI(g)
set g=null
endif
call SaveUnitHandle(LY,(handle_id),(393),(R74))
call SaveUnitHandle(LY,(handle_id),(394),(R84))
call SaveUnitHandle(LY,(handle_id),(395),(R94))
call SaveUnitHandle(LY,(handle_id),(396),(RA4))
call SaveUnitHandle(LY,(handle_id),(397),(RB4))
call SaveUnitHandle(LY,(handle_id),(398),(RC4))
call SaveUnitHandle(LY,(handle_id),(399),(RD4))
if R74!=null then
call SetUnitPosition(R74,IV1,IW1)
endif
if R84!=null then
call SetUnitPosition(R84,IV1,IW1)
endif
if R94!=null then
call SetUnitPosition(R94,IV1,IW1)
endif
if RA4!=null then
call SetUnitPosition(RA4,IV1,IW1)
endif
if RB4!=null then
call SetUnitPosition(RB4,IV1,IW1)
endif
if RC4!=null then
call SetUnitPosition(RC4,IV1,IW1)
endif
if RD4!=null then
call SetUnitPosition(RD4,IV1,IW1)
endif
if ModuloInteger(GetTriggerEvalCount(t),3)==0 then
call UPI(IV1,IW1,200)
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>RE4 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call SetUnitAnimationByIndex(hero,0)
call SetUnitTimeScale(hero,1.0)
call SetUnitPathing(hero,true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if R74!=null then
if IsPointInRegion(LN,GetUnitX(R74),GetUnitY(R74))==true then
set point=BN1(GetUnitX(R74),GetUnitY(R74))
call MUSetUnitX(R74,PPI(GetLocationX(point)))
call MUSetUnitY(R74,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,R74,level)
call UPI(GetUnitX(R74),GetUnitY(R74),300)
endif
if R84!=null then
if IsPointInRegion(LN,GetUnitX(R84),GetUnitY(R84))==true then
set point=BN1(GetUnitX(R84),GetUnitY(R84))
call MUSetUnitX(R84,PPI(GetLocationX(point)))
call MUSetUnitY(R84,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,R84,level)
call UPI(GetUnitX(R84),GetUnitY(R84),300)
endif
if R94!=null then
if IsPointInRegion(LN,GetUnitX(R94),GetUnitY(R94))==true then
set point=BN1(GetUnitX(R94),GetUnitY(R94))
call MUSetUnitX(R94,PPI(GetLocationX(point)))
call MUSetUnitY(R94,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,R94,level)
call UPI(GetUnitX(R94),GetUnitY(R94),300)
endif
if RA4!=null then
if IsPointInRegion(LN,GetUnitX(RA4),GetUnitY(RA4))==true then
set point=BN1(GetUnitX(RA4),GetUnitY(RA4))
call MUSetUnitX(RA4,PPI(GetLocationX(point)))
call MUSetUnitY(RA4,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,RA4,level)
call UPI(GetUnitX(RA4),GetUnitY(RA4),300)
endif
if RB4!=null then
if IsPointInRegion(LN,GetUnitX(RB4),GetUnitY(RB4))==true then
set point=BN1(GetUnitX(RB4),GetUnitY(RB4))
call MUSetUnitX(RB4,PPI(GetLocationX(point)))
call MUSetUnitY(RB4,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,RB4,level)
call UPI(GetUnitX(RB4),GetUnitY(RB4),300)
endif
if RC4!=null then
if IsPointInRegion(LN,GetUnitX(RC4),GetUnitY(RC4))==true then
set point=BN1(GetUnitX(RC4),GetUnitY(RC4))
call MUSetUnitX(RC4,PPI(GetLocationX(point)))
call MUSetUnitY(RC4,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,RC4,level)
call UPI(GetUnitX(RC4),GetUnitY(RC4),300)
endif
if RD4!=null then
if IsPointInRegion(LN,GetUnitX(RD4),GetUnitY(RD4))==true then
set point=BN1(GetUnitX(RD4),GetUnitY(RD4))
call MUSetUnitX(RD4,PPI(GetLocationX(point)))
call MUSetUnitY(RD4,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
call R54(hero,RD4,level)
call UPI(GetUnitX(RD4),GetUnitY(RD4),300)
endif
if R74!=null and IsUnitDead(R74)==false then
call IssueTargetOrder(hero,"attack",R74)
elseif R84!=null and IsUnitDead(R84)==false then
call IssueTargetOrder(hero,"attack",R84)
elseif R94!=null and IsUnitDead(R94)==false then
call IssueTargetOrder(hero,"attack",R94)
elseif RA4!=null and IsUnitDead(RA4)==false then
call IssueTargetOrder(hero,"attack",RA4)
elseif RB4!=null and IsUnitDead(RB4)==false then
call IssueTargetOrder(hero,"attack",RB4)
elseif RC4!=null and IsUnitDead(RC4)==false then
call IssueTargetOrder(hero,"attack",RC4)
elseif RD4!=null and IsUnitDead(RD4)==false then
call IssueTargetOrder(hero,"attack",RD4)
endif
call UPI(IV1,IW1,375)
if IsPointInRegion(LN,GetUnitX(hero),GetUnitY(hero))==true then
set point=BN1(GetUnitX(hero),GetUnitY(hero))
call MUSetUnitX(hero,PPI(GetLocationX(point)))
call MUSetUnitY(hero,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
endif
set t=null
set hero=null
return false
endfunction
function RF4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QJI=PPI(GetSpellTargetX())
local real QKI=Q0I(GetSpellTargetY())
local unit hero=GetTriggerUnit()
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local integer level=GetUnitAbilityLevel(hero,'A1RD')
local real a=UEI(QXI,QYI,QJI,QKI)*bj_DEGTORAD
local real QWI=600+150*level+25
if QNI(QXI,QYI,QJI,QKI)>QWI then
set QJI=PPI(QXI+QWI*Cos(a))
set QKI=Q0I(QYI+QWI*Sin(a))
endif
call SetUnitPathing(hero,false)
call SetUnitAnimationByIndex(hero,3)
call SetUnitTimeScale(hero,1.5)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function R64))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(393),(null))
call SaveUnitHandle(LY,(handle_id),(394),(null))
call SaveUnitHandle(LY,(handle_id),(395),(null))
call SaveUnitHandle(LY,(handle_id),(396),(null))
call SaveUnitHandle(LY,(handle_id),(397),(null))
call SaveUnitHandle(LY,(handle_id),(398),(null))
call SaveUnitHandle(LY,(handle_id),(399),(null))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(6),((QXI)*1.0))
call SaveReal(LY,(handle_id),(7),((QYI)*1.0))
call SaveReal(LY,(handle_id),(13),((Atan2(QKI-QYI,QJI-QXI))*1.0))
call SaveInteger(LY,(handle_id),(12),(R2I(QNI(QXI,QYI,QJI,QKI)/19.0)))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\SkewerTuskGlow_1.mdx",hero,"head")))
set t=null
set hero=null
endfunction
function RG4 takes nothing returns boolean
if GetSpellAbilityId()=='A1RD' then
call RF4()
endif
return false
endfunction
function RH4 takes nothing returns boolean
if GetSpellAbilityId()=='A1RD' then
call SetUnitAnimationByIndex(GetTriggerUnit(),7)
endif
return false
endfunction
function LO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function RG4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function RH4))
set t=null
endfunction
function MysticSnake_DoNothing takes nothing returns nothing
endfunction
function RZ4 takes nothing returns boolean
local real d
if IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(ZAI))==true and IsUnitInGroup(GetFilterUnit(),ZCI)==false and C01(GetFilterUnit(),GetOwningPlayer(ZBI))==true then
set d=QNI(GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()),GetUnitX(ZAI),GetUnitY(ZAI))
if d<ZDI then
set Z9I=GetFilterUnit()
set ZDI=d
endif
endif
return false
endfunction
function RV4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local real RW4=(LoadReal(LY,(handle_id),(222)))
local real RX4=(LoadReal(LY,(handle_id),(223)))
local real RY4=(LoadReal(LY,(handle_id),(224)))
local real OA2
local group g
local real a
local real x
local real y
local integer RJ4=GetUnitAbilityLevel(hero,'A1AT')
set a=Atan2(GetUnitY(target)-GetUnitY(dummy),GetUnitX(target)-GetUnitX(dummy))
if hero==target then
set x=GetUnitX(dummy)+24*Cos(a)
set y=GetUnitY(dummy)+24*Sin(a)
else
set x=GetUnitX(dummy)+24*Cos(a)
set y=GetUnitY(dummy)+24*Sin(a)
endif
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
if QNI(x,y,GetUnitX(target),GetUnitY(target))<60 then
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
if hero==target then
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+RW4)
call KillUnit(dummy)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if BU1(target)==false or IsUnitVisible(target,GetOwningPlayer(dummy))==true then
if(GetUnitAbilityLevel(target,'A2TL')>0)then
call Damage(hero,target,3,((40+40*level)+0.25*RY4*(40+40*level))/(1.2+0.1*RJ4))
else
call Damage(hero,target,1,(40+40*level)+0.25*RY4*(40+40*level))
endif
set RY4=RY4+1
if GetUnitState(target,UNIT_STATE_MANA)>0 then
set OA2=RMinBJ(GetUnitState(target,UNIT_STATE_MANA),(5+15*level)+0.25*RX4*(10+10*level))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)-OA2)
call IO1(RE,GetUnitX(target),GetUnitY(target))
set RW4=RW4+OA2
set RX4=RX4+1
endif
endif
call SaveReal(LY,(handle_id),(222),((RW4)*1.0))
call SaveReal(LY,(handle_id),(224),((RY4)*1.0))
call SaveReal(LY,(handle_id),(223),((RX4)*1.0))
set g=NTI()
set Z9I=null
set ZAI=target
set ZCI=PR2
set ZDI=99999
set ZBI=hero
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),500,Condition(function RZ4))
call NSI(g)
if Z9I==null or RY4==(2+level)then
call SaveInteger(LY,(handle_id),(30),(NKI(hero)))
else
call SaveInteger(LY,(handle_id),(30),(NKI(Z9I)))
call GroupAddUnit(PR2,Z9I)
endif
endif
call NXI(PCI)
endif
set t=null
set hero=null
set target=null
set g=null
return false
endfunction
function RK4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A0G2')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local real RY4=0
local real RX4=0
local real OA2=0
local real RW4=0
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h090',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call IO1(TE,GetUnitX(hero),GetUnitY(hero))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function RV4))
call SaveGroupHandle(LY,(handle_id),(187),(g))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveReal(LY,(handle_id),(222),((RW4)*1.0))
call SaveReal(LY,(handle_id),(224),((RY4)*1.0))
call SaveReal(LY,(handle_id),(223),((RX4)*1.0))
call GroupAddUnit(g,target)
set hero=null
set target=null
set t=null
set g=null
endfunction
function RL4 takes nothing returns boolean
if GetSpellAbilityId()=='A0G2' then
call RK4()
endif
return false
endfunction
function L31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function RL4))
set t=null
endfunction
function RM4 takes nothing returns nothing
local unit target=GetEnumUnit()
call SaveReal(LY,(GetHandleId(target)),(799),((0)*1.0))
set target=null
endfunction
function RN4 takes nothing returns nothing
local unit target=GetEnumUnit()
call UnitRemoveAbility(target,'A2S3')
call UnitRemoveAbility(target,'A2TM')
call UnitRemoveAbility(target,'B0BQ')
call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target))
set target=null
endfunction
function RS4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A1AT')
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
call DisableTrigger(t)
call Damage(GetEventDamageSource(),target,7,GetEventDamage()*(0.2+0.1*level))
call EnableTrigger(t)
if IsUnitDead(target)==true then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A2S1')
call UnitRemoveAbility(target,'A2TL')
endif
else
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A2S1')
call UnitRemoveAbility(target,'A2TL')
endif
set t=null
set hero=null
set target=null
return false
endfunction
function RT4 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local unit dummy
if IsUnitIllusion(target)==true then
call KillUnit(target)
return
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2S4')
call IssueTargetOrder(dummy,"thunderbolt",target)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,3,false)
call TriggerAddCondition(t,Condition(function RS4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\EtherealForm\\SpiritWalkerChange.mdl",target,"chest")))
call AddSkill(target,'A2S1')
call AddSkill(target,'A2TL')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2S1',false)
set t=null
endfunction
function RR4 takes nothing returns nothing
local unit target=GetEnumUnit()
call SaveReal(LY,(GetHandleId(target)),(799),(((LoadReal(LY,(GetHandleId(target)),(799)))+0.02)*1.0))
if GetUnitAbilityLevel(target,'A2S3')==0 then
call AddSkill(target,'A2S3')
call AddSkill(target,'A2TM')
call SetUnitTurnSpeed(target,GetUnitDefaultTurnSpeed(target)*0.5)
endif
if(LoadReal(LY,(GetHandleId(target)),(799)))==2.0 then
call RT4(ZEI,target)
endif
set target=null
endfunction
function RP4 takes unit hero,unit target returns boolean
local real a=UDI(target,hero)
local real V53=GetUnitFacing(target)
local real c1
local real c2
local real d1=-1.0
local real d2=-1.0
local real e1
local real e2
local real f1=-1.0
local real f2=-1.0
set c1=RMaxBJ(V53-85,0)
set c2=V53
if V53-85<=0 then
set d1=360-(85-(c2-c1))
set d2=360
endif
set e1=V53
set e2=RMinBJ(V53+85,360)
if V53+85>=360 then
set f1=0
set f2=0+(85-(e2-e1))
endif
if a<0 then
set a=a+360
elseif a>360 then
set a=a-360
endif
if(a>c1 and a<c2)or(d1!=-1 and a>d1 and a<d2)or(a>e1 and a<e2)or(f1!=-1 and a>f1 and a<f2)then
return true
endif
return false
endfunction
function RQ4 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and RP4(GK,GetFilterUnit())
endfunction
function RU4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A1AT')
local group g1=NTI()
local group g2=NTI()
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
set ZFI=PR2
set ZEI=hero
set GK=hero
call GroupEnumUnitsInRange(g1,GetUnitX(hero),GetUnitY(hero),1025,Condition(function RQ4))
call ForGroup(g1,function RR4)
call GroupAddGroup(g1,PR2)
call GroupAddGroup(PR2,g2)
call GroupRemoveGroup(g1,g2)
call NSI(g1)
call NSI(g2)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
if GetTriggerEvalCount(t)>R2I(ZGI/0.02)then
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
call ForGroup(PR2,function RN4)
call ForGroup(PR2,function RM4)
call NSI(PR2)
else
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\EtherealForm\\SpiritWalkerChange.mdl",hero,"chest")))
endif
set hero=null
set g1=null
set g2=null
set PR2=null
set t=null
return false
endfunction
function P04 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function RU4))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\EtherealForm\\SpiritWalkerChange.mdl",GetTriggerUnit(),"chest")))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call TriggerEvaluate(t)
set t=null
endfunction
function PI4 takes nothing returns boolean
if GetSpellAbilityId()=='A1AT' then
call P04()
endif
return false
endfunction
function L41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PI4))
set t=null
endfunction
function P14 takes nothing returns boolean
if GetSpellAbilityId()=='A1C0' then
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1ET',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1ES',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1EQ',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1ER',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A2WL',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A23F',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A2WK',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A2WJ',false)
endif
return false
endfunction
function L21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function P14))
set t=null
endfunction
function PO4 takes integer NPI,unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
if NPI==0 then
call IssueTargetOrder(hero,"attack",target)
elseif NPI==1 then
call AddSkill(dummy,'A0TH')
call SetUnitAbilityLevel(dummy,'A0TH',1)
call IssueTargetOrder(dummy,"slow",target)
elseif NPI==2 then
call AddSkill(dummy,'A0TH')
call SetUnitAbilityLevel(dummy,'A0TH',1)
call IssueTargetOrder(dummy,"slow",target)
elseif NPI==3 then
call AddSkill(dummy,'A0TH')
call SetUnitAbilityLevel(dummy,'A0TH',2)
call IssueTargetOrder(dummy,"slow",target)
elseif NPI==4 then
call AddSkill(dummy,'A0TH')
call SetUnitAbilityLevel(dummy,'A0TH',3)
call IssueTargetOrder(dummy,"slow",target)
elseif NPI==5 then
call AddSkill(dummy,'A0TH')
call SetUnitAbilityLevel(dummy,'A0TH',4)
call IssueTargetOrder(dummy,"slow",target)
elseif NPI==6 then
call AddSkill(dummy,'A0TH')
call SetUnitAbilityLevel(dummy,'A0TH',5)
call IssueTargetOrder(dummy,"slow",target)
endif
set dummy=null
endfunction
function P24 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local real AB3=(10.0+level*5.0)/100.0
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
set NPI=NPI+1
call PO4(NPI,hero,target)
if NPI==9 then
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
elseif RSI(GetEventDamage())and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetEventDamageSource()))and IsUnitType(GetEventDamageSource(),UNIT_TYPE_STRUCTURE)==false then
if IsUnitType(GetEventDamageSource(),UNIT_TYPE_HERO)or GetUnitAbilityLevel(GetEventDamageSource(),'A04R')==0 then
call SetUnitState(GetEventDamageSource(),UNIT_STATE_LIFE,GetUnitState(GetEventDamageSource(),UNIT_STATE_LIFE)+GetEventDamage()*AB3)
else
call SetUnitState(K1[GetPlayerId(GetOwningPlayer(GetEventDamageSource()))],UNIT_STATE_LIFE,GetUnitState(K1[GetPlayerId(GetOwningPlayer(GetEventDamageSource()))],UNIT_STATE_LIFE)+GetEventDamage()*AB3)
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\VampiricAura\\VampiricAuraTarget.mdl",GetEventDamageSource(),"origin"))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function P34 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call PO4(0,hero,target)
call SaveInteger(LY,(handle_id),(375),(0))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(hero,'A194')))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function P24))
set t=null
set hero=null
set target=null
endfunction
function P44 takes nothing returns boolean
if GetSpellAbilityId()=='A194' and CanResistSkill(GetSpellTargetUnit())==false then
call P34()
endif
return false
endfunction
function SR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function P44))
set t=null
call Q1I('A0TH')
endfunction
function Snatch_Damage takes nothing returns nothing
call Damage(ZHI,GetEnumUnit(),1,ZZI*125+25)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Naga\\NagaBlood\\NagaBloodWindserpent.mdl",GetEnumUnit(),"overhead"))
endfunction
function Snatch_Process takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
call Damage(hero,target,1,PAI)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Naga\\NagaBlood\\NagaBloodWindserpent.mdl",target,"overhead"))
set hero=null
set target=null
endfunction
function P54 takes nothing returns nothing
local unit hero=ZHI
local unit target=GetEnumUnit()
local integer level=ZZI
local trigger t=IJ1(hero,target,'h0DF',"P64",600,false)
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(20),((level*125+25)*1.0))
set hero=null
set target=null
endfunction
function P74 takes unit hero,unit target,integer level returns nothing
local group g=NTI()
set GK=hero
set ZHI=hero
set ZZI=level
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),700+25,Condition(function CA1))
call ForGroup(g,function P54)
call NSI(g)
set g=null
endfunction
function P84 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call UnitShareVision(target,GetOwningPlayer(SFI),false)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Human\\HumanLargeDeathExplode\\HumanLargeDeathExplode.mdl",GetUnitX(target),GetUnitY(target)))
call SetUnitPosition(SFI,GetUnitX(target),GetUnitY(target))
call PauseUnit(SFI,false)
call ShowUnit(SFI,true)
call SetUnitPathing(SFI,true)
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitForPlayerSingle(SFI,GetOwningPlayer(SFI))
call SetUnitInvulnerable(SFI,false)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call RemoveUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call P74(SFI,target,level)
call SaveInteger(LY,(GetHandleId((SFI))),((4310)),(2))
elseif IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitEnemy(target,GetOwningPlayer(SFI))==true then
call UnitShareVision(target,GetOwningPlayer(SFI),false)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Human\\HumanLargeDeathExplode\\HumanLargeDeathExplode.mdl",GetUnitX(target),GetUnitY(target)))
call SetUnitPosition(SFI,GetUnitX(target),GetUnitY(target))
call PauseUnit(SFI,false)
call ShowUnit(SFI,true)
call SetUnitPathing(SFI,true)
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitForPlayerSingle(SFI,GetOwningPlayer(SFI))
call SetUnitInvulnerable(SFI,false)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call RemoveUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call P74(SFI,target,level)
call SaveInteger(LY,(GetHandleId((SFI))),((4310)),(2))
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A0SX' then
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Human\\HumanLargeDeathExplode\\HumanLargeDeathExplode.mdl",GetUnitX(target),GetUnitY(target)))
if IsUnitType(target,UNIT_TYPE_HERO)==false then
call SetUnitState(SFI,UNIT_STATE_LIFE,GetUnitState(SFI,UNIT_STATE_LIFE)+GetUnitState(target,UNIT_STATE_LIFE))
endif
call UnitShareVision(target,GetOwningPlayer(SFI),false)
call SetUnitPosition(SFI,GetUnitX(target),GetUnitY(target))
call PauseUnit(SFI,false)
call ShowUnit(SFI,true)
call SetUnitPathing(SFI,true)
call SetUnitAnimation(SFI,"Stand Victory")
call OE1(SFI,1.5)
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitForPlayerSingle(SFI,GetOwningPlayer(SFI))
call SetUnitInvulnerable(SFI,false)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call RemoveUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call P74(SFI,target,level)
if IsUnitType(target,UNIT_TYPE_HERO)==false then
if IsPlayerTeam1(GetOwningPlayer(SFI))then
set dummy=CreateUnit(CO[0],'e00E',GetUnitX(target),GetUnitY(target),0)
call SetUnitOwner(target,CO[0],false)
else
set dummy=CreateUnit(BO[0],'e00E',GetUnitX(target),GetUnitY(target),0)
call SetUnitOwner(target,BO[0],false)
endif
call UnitAddAbility(dummy,'A313')
call IssueTargetOrder(dummy,"charm",target)
call UnitRemoveBuffs(target,true,true)
call DU1(target,0,0)
call Damage(SFI,target,1,100000)
call Damage(SFI,target,2,100000)
call Damage(SFI,target,3,100000)
endif
call SaveInteger(LY,(GetHandleId((SFI))),((4310)),(2))
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SELECTED then
if IsUnitType(target,UNIT_TYPE_HERO)==true or IsUnitIllusion(target)==true then
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitAddForPlayer(dummy,GetOwningPlayer(SFI))
endif
else
call SetUnitPosition(SFI,GetUnitX(target),GetUnitY(target))
endif
set t=null
set target=null
set SFI=null
return false
endfunction
function P94 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e010',7260,-7732,0)
local string PA4="Objects\\Spawnmodels\\Naga\\NagaBlood\\NagaBloodWindserpent.mdl"
local string PB4="Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBase.mdl"
local string PC4="Abilities\\Spells\\Other\\Aneu\\AneuTarget.mdl"
if IsPlayerEnemy(GetLocalPlayer(),GetOwningPlayer(SFI))and P0I(GetLocalPlayer())==false then
set PA4=""
set PB4=""
set PC4=""
endif
call UnitRemoveBuffs(SFI,true,true)
call DU1(SFI,0,0)
call SetUnitInvulnerable(dummy,true)
call AddSkill(dummy,'A0SX')
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitForPlayerSingle(dummy,GetOwningPlayer(SFI))
call UnitShareVision(target,GetOwningPlayer(SFI),true)
call SetUnitInvulnerable(SFI,true)
call ShowUnit(SFI,false)
call PauseUnit(SFI,true)
call SetUnitPathing(SFI,false)
call DestroyEffect(AddSpecialEffectTarget(PA4,target,"overhead"))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(PB4,target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffectTarget(PC4,target,"overhead")))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(SFI,'A0SW')))
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterPlayerUnitEvent(t,GetOwningPlayer(SFI),EVENT_PLAYER_UNIT_SELECTED,Condition(function N1I))
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function P84))
call SaveInteger(LY,(GetHandleId((SFI))),((4310)),(1))
if IsUnitType(target,UNIT_TYPE_HERO)==false and IsUnitIllusion(target)==false then
call AddSkill(target,'A0SX')
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_SPELL_EFFECT)
set dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A313')
call IssueTargetOrder(dummy,"charm",target)
call ClearSelectionForPlayer(GetOwningPlayer(SFI))
call SelectUnitForPlayerSingle(target,GetOwningPlayer(SFI))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MAX_MANA))
endif
set t=null
set SFI=null
set target=null
endfunction
function PD4 takes nothing returns boolean
if GetSpellAbilityId()=='A0SW' then
call P94()
endif
return false
endfunction
function PE4 takes nothing returns boolean
if GetSpellAbilityId()=='A0SW' and IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))and(IsUnitType(GetSpellTargetUnit(),UNIT_TYPE_HERO)==true or IsUnitIllusion(GetSpellTargetUnit()))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"无法指定敌方英雄")
endif
return false
endfunction
function ST1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PD4))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function PE4))
set t=null
endfunction
function PF4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetUnitTypeId(SFI)=='E02X' then
call SetUnitVertexColor(SFI,255,255,255,255)
else
call SetUnitVertexColor(SFI,100,100,100,255)
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call UnitRemoveAbility(SFI,'A0SR')
call UnitRemoveAbility(SFI,'A0ST')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function PG4 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A2TT')
call SetUnitVertexColor(SFI,0,0,0,255)
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A0ST',false)
call AddSkill(SFI,'A0ST')
call AddSkill(SFI,'A0SR')
call SetUnitAbilityLevel(SFI,'A0SR',level)
call DU1(SFI,0,0)
call UnitRemoveAbility(SFI,'BHtc')
call UnitRemoveAbility(SFI,'B02U')
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\Bloodlust\\BloodlustTarget.mdl",SFI,"right hand")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\Bloodlust\\BloodlustTarget.mdl",SFI,"left hand")))
call TriggerRegisterTimerEvent(t,2+level,false)
call TriggerAddCondition(t,Condition(function PF4))
set SFI=null
set t=null
endfunction
function PH4 takes nothing returns boolean
if GetSpellAbilityId()=='A2TT' then
call PG4()
endif
return false
endfunction
function SS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PH4))
set t=null
endfunction
function PZ4 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A0SS')
local real PAI=(0.03+0.01*level)*GetUnitState(target,UNIT_STATE_LIFE)
if GetUnitAbilityLevel(target,'A04R')==0 and GetUnitAbilityLevel(hero,'BNdo')==0 then
call Damage(hero,target,2,PAI)
call SetUnitState(hero,UNIT_STATE_LIFE,PAI+GetUnitState(hero,UNIT_STATE_LIFE))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\VampiricAura\\VampiricAuraTarget.mdl",hero,"origin"))
endif
endfunction
function PV4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call PZ4(hero,target)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function PW4 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function PV4))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function PX4 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4274))))==1)==false then
call SCI(hero,4274,0.4)
call PW4()
endif
endfunction
function PY4 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A0SS')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call PX4()
endif
return false
endfunction
function PJ4 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function PY4))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function PK4 takes nothing returns boolean
if GetLearnedSkill()=='A0SS' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0SS')==1 then
call PJ4()
endif
return false
endfunction
function SN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function PK4))
set t=null
endfunction
function PL4 takes nothing returns nothing
local unit target=GetEnumUnit()
local unit hero=ZVI
local real KMO=GetUnitState(target,UNIT_STATE_LIFE)
local real PM4=GetUnitState(target,UNIT_STATE_MAX_LIFE)
local real PN4=((0.003+0.003*ZWI)*PM4)/2
if KMO<PN4 then
call SetUnitState(target,UNIT_STATE_LIFE,1)
call Damage(hero,target,3,100)
call Damage(hero,target,1,100)
call Damage(hero,target,2,100)
else
call SetUnitState(target,UNIT_STATE_LIFE,QDI(GetUnitState(target,UNIT_STATE_LIFE)-PN4,1))
endif
set target=null
set hero=null
endfunction
function PS4 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),'B084')>0
endfunction
function PT4 takes nothing returns boolean
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g
if IsUnitDead(hero)==false then
set g=NTI()
set GK=hero
set ZVI=hero
set ZWI=GetUnitAbilityLevel(hero,'A01N')
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1225,Condition(function PS4))
call ForGroup(g,function PL4)
call NSI(g)
endif
set g=null
set hero=null
return false
endfunction
function PR4 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function PT4))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(GetTriggerUnit()))
set t=null
endfunction
function PP4 takes nothing returns boolean
if GetLearnedSkill()=='A01N' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A01N')==1 then
call PR4()
endif
return false
endfunction
function L81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function PP4))
set t=null
endfunction
function PQ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A060')
local real PU4=2*level
local real Q04=level
local integer AB3=(LoadInteger(LY,(handle_id),(34)))
if level==4 then
set PU4=10
endif
set Q04=Q04*AB3
set PU4=PU4*AB3
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+PU4)
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+Q04)
if GetTriggerEvalCount(t)>5 or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function QI4 takes unit hero returns nothing
local integer level=GetUnitAbilityLevel(hero,'A060')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",hero,"origin"))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function PQ4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true then
call SaveInteger(LY,(handle_id),(34),(10))
else
call SaveInteger(LY,(handle_id),(34),(1))
endif
set t=null
endfunction
function Q14 takes nothing returns boolean
if GetUnitAbilityLevel(GetKillingUnit(),'B02R')>0 then
call QI4(GetKillingUnit())
elseif((LoadInteger(LY,(GetHandleId((GetTriggerUnit()))),((4333))))==1)then
call QI4(ZJI)
endif
return false
endfunction
function L51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function Q14))
set t=null
endfunction
function P64 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
local real MR3=(LoadReal(LY,(handle_id),(21)))
if IsUnitAlly(target,GetOwningPlayer(hero))then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+MR3)
else
call Damage(hero,target,1,PAI)
endif
set hero=null
set target=null
endfunction
function QO4 takes nothing returns nothing
local trigger t=IJ1(GK,GetEnumUnit(),'h00W',"P64",400,false)
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(20),((AK)*1.0))
call SaveReal(LY,(handle_id),(21),((BK)*1.0))
set t=null
endfunction
function Q24 takes nothing returns nothing
call QO4()
endfunction
function Q34 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local group g=NTI()
local integer level=GetUnitAbilityLevel(SFI,ZXI)
local real r
local real PAI
local real MR3
if level==1 then
set PAI=75
set MR3=70
set r=500
elseif level==2 then
set PAI=125
set MR3=90
set r=500
elseif level==3 then
set PAI=200
set MR3=110
set r=500
elseif level==4 then
set PAI=275
set MR3=130
set r=500
endif
set GK=SFI
set AK=PAI
set BK=MR3
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),r,Condition(function D41))
call GroupRemoveUnit(g,SFI)
call ForGroup(g,function Q24)
call NSI(g)
call SetUnitState(SFI,UNIT_STATE_LIFE,GetUnitState(SFI,UNIT_STATE_LIFE)+MR3)
set SFI=null
set g=null
endfunction
function Q44 takes nothing returns boolean
if GetSpellAbilityId()==ZXI then
call Q34()
endif
return false
endfunction
function L61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Q44))
set t=null
endfunction
function Q54 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real AB3=(LoadReal(LY,(handle_id),(680)))
local integer Q64=GetUnitAbilityLevel(hero,'A08P')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl",target,"origin"))
if Q64>0 then
set ZYI=true
call Damage(hero,target,1,AB3*(GetUnitState(target,UNIT_STATE_MAX_LIFE)-GetUnitState(target,UNIT_STATE_LIFE)))
set ZYI=false
else
call Damage(hero,target,1,AB3*(GetUnitState(target,UNIT_STATE_MAX_LIFE)-GetUnitState(target,UNIT_STATE_LIFE)))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function Q74 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer Q84=GetUnitAbilityLevel(hero,'A067')
local integer Q94=GetUnitAbilityLevel(hero,'A08P')
local real AB3
if Q84==1 then
set AB3=0.4
elseif Q84==2 or Q94==1 then
set AB3=0.6
elseif Q84==3 or Q94==2 then
set AB3=0.9
elseif Q94==3 then
set AB3=1.2
endif
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(680),((AB3)*1.0))
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerAddCondition(t,Condition(function Q54))
call SCI(target,4333,1.5)
if Q94>0 then
call SCI(target,4418,1.51)
endif
set ZJI=hero
set t=null
set hero=null
set target=null
endfunction
function QA4 takes nothing returns boolean
if(GetSpellAbilityId()=='A067' or GetSpellAbilityId()=='A08P')and CanResistSkill(GetSpellTargetUnit())==false then
call Q74()
endif
return false
endfunction
function L71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QA4))
set t=null
endfunction
function QB4 takes nothing returns nothing
local location point
local unit SFI=GetTriggerUnit()
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real a
local real x2
local real y2
local integer level=GetUnitAbilityLevel(SFI,'A0X7')
local real PAI
local real DC1
local unit DT1=null
if GetSpellTargetUnit()!=null then
set point=GetUnitLoc(GetSpellTargetUnit())
else
set point=GetSpellTargetLoc()
endif
set x2=GetLocationX(point)
set y2=GetLocationY(point)
set a=Atan2(y2-y1,x2-x1)
set x2=x1+700*Cos(a)
set y2=y1+700*Sin(a)
if level==1 then
set PAI=80
set DC1=0.75
elseif level==2 then
set PAI=140
set DC1=1.25
elseif level==3 then
set PAI=200
set DC1=1.75
elseif level==4 then
set PAI=260
set DC1=2.25
endif
if GetSpellTargetUnit()!=null and CanResistSkill(GetSpellTargetUnit())then
set DT1=GetSpellTargetUnit()
endif
call DS1(SFI,DT1,PAI,DC1,0.52,x1,y1,x2,y2,150,null,true,1600)
call RemoveLocation(point)
set point=null
set SFI=null
endfunction
function QC4 takes nothing returns boolean
if GetSpellAbilityId()=='A0X7' then
call QB4()
endif
return false
endfunction
function TO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QC4))
call Q1I('A0X6')
set t=null
endfunction
function QD4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A1H5')
local real r=GetHeroInt(target,true)*(3+0.5*level)
local integer ZCO=IMinBJ(R2I(r),R2I(GetUnitState(target,UNIT_STATE_MANA)))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)-ZCO)
call Damage(hero,target,1,ZCO)
call AL1("MBUR",hero,target,1,1,1,1,0.5)
call UYI("-"+I2S(ZCO),3,target,0.023,82,82,255,255)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\ManaBurn\\ManaBurnTarget.mdl",target,"chest"))
set hero=null
set target=null
endfunction
function QE4 takes nothing returns boolean
if GetSpellAbilityId()=='A1H5' and CanResistSkill(GetSpellTargetUnit())==false then
call QD4()
endif
return false
endfunction
function T21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QE4))
set t=null
endfunction
function QF4 takes nothing returns nothing
call IssueTargetOrder(ZKI,"soulburn",GetEnumUnit())
endfunction
function QG4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
local group g=NTI()
set ZKI=dummy
call AddSkill(dummy,'A1GG')
call GroupEnumUnitsInRange(g,x,y,325,Condition(function C51))
call ForGroup(g,function QF4)
call NSI(g)
call KillUnit(hero)
call SetUnitAnimation(hero,"death")
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Undead\\UndeadLargeDeathExplode\\UndeadLargeDeathExplode.mdl",x,y))
set hero=null
set dummy=null
set g=null
endfunction
function QH4 takes nothing returns boolean
if GetSpellAbilityId()=='A1HH' then
call QG4()
endif
return false
endfunction
function T31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QH4))
call Q1I('A1GG')
set t=null
endfunction
function QZ4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target
local integer level=GetUnitAbilityLevel(hero,'A2KO')
local group PR2=(LoadGroupHandle(LY,(handle_id),(22)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>0 and IsPlayerEnemy(GetOwningPlayer(GetEventDamageSource()),GetOwningPlayer(hero))==true then
if T2I(GetOwningPlayer(GetEventDamageSource()))and RSI(GetEventDamage())then
set target=GetEventDamageSource()
if GetUnitAbilityLevel(target,'A04R')>0 then
set target=K1[GetPlayerId(GetOwningPlayer(target))]
endif
if IsUnitInGroup(target,PR2)==false then
call GroupAddUnit(PR2,target)
call QGI(hero,GetEventDamage())
if IsUnitDead(target)==false then
call DD1(hero,target,0.6*level)
call Damage(hero,target,3,GetEventDamage())
endif
endif
endif
endif
else
call UnitRemoveAbility(hero,'A2KP')
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function QV4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,2.25,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function QZ4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
call AddSkill(hero,'A2KP')
set hero=null
set t=null
endfunction
function QW4 takes nothing returns boolean
if GetSpellAbilityId()=='A2KO' then
call QV4()
endif
return false
endfunction
function T41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QW4))
set t=null
endfunction
constant function Shadowraze_RawCode1 takes nothing returns integer
return 'A0EY'
endfunction
constant function Shadowraze_RawCode2 takes nothing returns integer
return 'A0FH'
endfunction
constant function Shadowraze_RawCode3 takes nothing returns integer
return 'A0F0'
endfunction
constant function Shadowraze_Area takes nothing returns integer
return 275
endfunction
function QX4 takes nothing returns boolean
return GetSpellAbilityId()==('A0EY')or GetSpellAbilityId()==('A0FH')or GetSpellAbilityId()==('A0F0')
endfunction
function QY4 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')!=1
endfunction
function QJ4 takes nothing returns nothing
call UnitDamageTarget(GetTriggerUnit(),GetEnumUnit(),25+75*GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId()),true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_DEATH,WEAPON_TYPE_WHOKNOWS)
endfunction
function QK4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy
local group Z51=NTI()
local boolexpr QL1=Condition(function QY4)
local real MAI=GetUnitFacing(SFI)
local real x
local real y
if GetSpellAbilityId()==('A0EY')then
set x=GetUnitX(SFI)+200*Cos(MAI*bj_DEGTORAD)
set y=GetUnitY(SFI)+200*Sin(MAI*bj_DEGTORAD)
set dummy=CreateUnit(GetOwningPlayer(SFI),'e006',x,y,0)
call UnitApplyTimedLife(dummy,'BTLF',2)
call GroupEnumUnitsInRange(Z51,x,y,(275),QL1)
call ForGroup(Z51,function QJ4)
call GroupClear(Z51)
endif
if GetSpellAbilityId()==('A0FH')then
set x=GetUnitX(SFI)+450*Cos(MAI*bj_DEGTORAD)
set y=GetUnitY(SFI)+450*Sin(MAI*bj_DEGTORAD)
set dummy=CreateUnit(GetOwningPlayer(SFI),'e006',x,y,0)
call UnitApplyTimedLife(dummy,'BTLF',2)
call GroupEnumUnitsInRange(Z51,x,y,(275),QL1)
call ForGroup(Z51,function QJ4)
call GroupClear(Z51)
endif
if GetSpellAbilityId()==('A0F0')then
set x=GetUnitX(SFI)+700*Cos(MAI*bj_DEGTORAD)
set y=GetUnitY(SFI)+700*Sin(MAI*bj_DEGTORAD)
set dummy=CreateUnit(GetOwningPlayer(SFI),'e006',x,y,0)
call UnitApplyTimedLife(dummy,'BTLF',2)
call GroupEnumUnitsInRange(Z51,x,y,(275),QL1)
call ForGroup(Z51,function QJ4)
call GroupClear(Z51)
endif
call NSI(Z51)
endfunction
function LA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddAction(t,function QK4)
call TriggerAddCondition(t,Condition(function QX4))
endfunction
function QL4 takes nothing returns nothing
if(GetLearnedSkill()=='A0EY')then
if(GetUnitAbilityLevelSwapped('A0EY',GetTriggerUnit())==1)then
call UnitAddAbility(GetTriggerUnit(),'A0F0')
call UnitAddAbility(GetTriggerUnit(),'A0FH')
else
call SetUnitAbilityLevelSwapped('A0F0',GetTriggerUnit(),GetUnitAbilityLevelSwapped('A0EY',GetTriggerUnit()))
call SetUnitAbilityLevelSwapped('A0FH',GetTriggerUnit(),GetUnitAbilityLevelSwapped('A0EY',GetTriggerUnit()))
endif
endif
if(GetLearnedSkill()=='A0BR')then
if(GetUnitAbilityLevelSwapped('A0BR',GetTriggerUnit())==1)then
call UnitAddAbility(GetTriggerUnit(),'A0CQ')
endif
endif
endfunction
function NL takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddAction(t,function QL4)
endfunction
function QM4 takes nothing returns boolean
return GetSpellAbilityId()=='A29J' or GetSpellAbilityId()=='A1MP'
endfunction
function QN4 takes unit PKI,integer QS4 returns nothing
local integer QT4=QS4
local integer QR4
local integer THI
local location BFO=GetUnitLoc(GetTriggerUnit())
local location OM3
local integer level=GetUnitAbilityLevelSwapped('A29J',GetTriggerUnit())
if level==0 then
return
endif
set QT4=QT4/2
set QR4=1
set THI=QT4
loop
exitwhen QR4>THI
set OM3=M7I(BFO,50.00,(I2R(QR4)*(360/QT4)))
call CreateNUnitsAtLoc(1,'e00C',GetOwningPlayer(PKI),BFO,bj_UNIT_FACING)
call UnitAddAbility(bj_lastCreatedUnit,'A0HG')
call SetUnitAbilityLevelSwapped('A0HG',bj_lastCreatedUnit,level)
call UnitApplyTimedLifeBJ(2.00,'BTLF',bj_lastCreatedUnit)
call IssuePointOrderLoc(bj_lastCreatedUnit,"carrionswarm",OM3)
call SetUnitPathing(bj_lastCreatedUnit,false)
call SetUnitInvulnerable(bj_lastCreatedUnit,true)
call UnitAddAbility(bj_lastCreatedUnit,'Aloc')
call RemoveLocation(OM3)
set QR4=QR4+1
endloop
call RemoveLocation(BFO)
endfunction
function QP4 takes nothing returns nothing
local integer QT4=(LoadInteger(LY,(GetHandleId(GetTriggerUnit())),(710)))
local unit PKI=GetTriggerUnit()
call QN4(PKI,QT4)
set PKI=null
endfunction
function LB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QM4))
call TriggerAddAction(t,function QP4)
endfunction
function QQ4 takes nothing returns boolean
return GetSpellAbilityId()=='A29J' or GetSpellAbilityId()=='A1MP'
endfunction
function QU4 takes nothing returns boolean
if(IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true)then
return false
endif
if(GetUnitAbilityLevelSwapped('A04R',GetFilterUnit())==1)then
return false
endif
if(IsUnitAliveBJ(GetFilterUnit())==false)then
return false
endif
if(GetUnitTypeId(GetFilterUnit())=='o003')then
return false
endif
if(IsUnitEnemy(GetFilterUnit(),GetTriggerPlayer())==false)then
return false
endif
if(GetTriggerUnit()==GetFilterUnit())then
return false
endif
if(IsUnitVisible(GetFilterUnit(),GetTriggerPlayer())==false)then
return false
endif
return true
endfunction
function UI4 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local location BFO=GetUnitLoc(PKI)
local integer level=GetUnitAbilityLevelSwapped('A29J',GetTriggerUnit())
if level==0 then
set level=GetUnitAbilityLevelSwapped('A1MP',GetTriggerUnit())
endif
call CreateNUnitsAtLoc(1,'e00C',GetOwningPlayer(GetEnumUnit()),BFO,bj_UNIT_FACING)
call UnitAddAbility(bj_lastCreatedUnit,'A0HH')
call SetUnitAbilityLevelSwapped('A0HH',bj_lastCreatedUnit,level)
call UnitApplyTimedLifeBJ(2.00,'BTLF',bj_lastCreatedUnit)
call IssueTargetOrder(bj_lastCreatedUnit,"cripple",GetEnumUnit())
call SetUnitPathing(bj_lastCreatedUnit,false)
call SetUnitInvulnerable(bj_lastCreatedUnit,true)
call UnitAddAbility(bj_lastCreatedUnit,'Aloc')
call RemoveLocation(BFO)
endfunction
function U14 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local location BFO=GetUnitLoc(PKI)
local integer level=GetUnitAbilityLevelSwapped('A29J',GetTriggerUnit())
if level==0 then
set level=GetUnitAbilityLevelSwapped('A1MP',GetTriggerUnit())
endif
call CreateNUnitsAtLoc(1,'e00C',GetOwningPlayer(GetEnumUnit()),BFO,bj_UNIT_FACING)
call UnitAddAbility(bj_lastCreatedUnit,'A0HH')
call SetUnitAbilityLevelSwapped('A0HH',bj_lastCreatedUnit,level)
call UnitApplyTimedLifeBJ(2.00,'BTLF',bj_lastCreatedUnit)
call IssueTargetOrder(bj_lastCreatedUnit,"cripple",GetEnumUnit())
call SetUnitPathing(bj_lastCreatedUnit,false)
call SetUnitInvulnerable(bj_lastCreatedUnit,true)
call UnitAddAbility(bj_lastCreatedUnit,'Aloc')
call RemoveLocation(BFO)
endfunction
function UO4 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local location BFO=GetUnitLoc(PKI)
local integer level=GetUnitAbilityLevelSwapped('A29J',GetTriggerUnit())
if level==0 then
set level=GetUnitAbilityLevelSwapped('A1MP',GetTriggerUnit())
endif
call CreateNUnitsAtLoc(1,'e00C',GetOwningPlayer(GetEnumUnit()),BFO,bj_UNIT_FACING)
call UnitAddAbility(bj_lastCreatedUnit,'A0HH')
call SetUnitAbilityLevelSwapped('A0HH',bj_lastCreatedUnit,level)
call UnitApplyTimedLifeBJ(2.00,'BTLF',bj_lastCreatedUnit)
call IssueTargetOrder(bj_lastCreatedUnit,"cripple",GetEnumUnit())
call SetUnitPathing(bj_lastCreatedUnit,false)
call SetUnitInvulnerable(bj_lastCreatedUnit,true)
call UnitAddAbility(bj_lastCreatedUnit,'Aloc')
call RemoveLocation(BFO)
endfunction
function U24 takes nothing returns nothing
local location BFO=GetUnitLoc(GetTriggerUnit())
local unit PKI=GetTriggerUnit()
local group Z51
set Z51=NTI()
call GroupEnumUnitsInRangeOfLoc(Z51,BFO,700,Condition(function QU4))
call ForGroup(Z51,function UI4)
call NSI(Z51)
set Z51=NTI()
call GroupEnumUnitsInRangeOfLoc(Z51,BFO,400,Condition(function QU4))
call ForGroup(Z51,function U14)
call NSI(Z51)
set Z51=NTI()
call GroupEnumUnitsInRangeOfLoc(Z51,BFO,200,Condition(function QU4))
call ForGroup(Z51,function UO4)
call NSI(Z51)
call RemoveLocation(BFO)
endfunction
function LC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QQ4))
call TriggerAddAction(t,function U24)
endfunction
function U34 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=HK
local unit target=GK
local integer QT4=GetUnitAbilityLevel(hero,'A0CQ')
local integer U44
local integer level=GetUnitAbilityLevel(hero,'A0BR')
if level==1 then
set U44=15
elseif level==2 then
set U44=22
elseif level==3 then
set U44=29
else
set U44=36
endif
set U44=U44+1
if IsUnitType(target,UNIT_TYPE_HERO)==false then
set QT4=QT4+1
else
set QT4=QT4+12
endif
set QT4=IMinBJ(U44,QT4)
call SetUnitAbilityLevel(hero,'A0CQ',QT4)
call SaveInteger(LY,(GetHandleId(hero)),(710),(QT4))
set hero=null
endfunction
function U54 takes nothing returns nothing
local integer QT4
local integer level
local integer U44
local trigger t
local integer handle_id
local unit hero=GetKillingUnit()
if GetUnitTypeId(hero)=='e00C' then
set hero=K1[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]
endif
set QT4=GetUnitAbilityLevel(hero,'A0CQ')
set level=GetUnitAbilityLevel(hero,'A0BR')
if level==1 then
set U44=15
elseif level==2 then
set U44=22
elseif level==3 then
set U44=29
else
set U44=36
endif
if QT4<=U44 then
set t=IJ1(GetTriggerUnit(),hero,'h0CR',"U34",500,false)
set handle_id=GetHandleId(t)
set t=null
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\ZigguratMissile\\ZigguratMissile.mdl",GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit())))
endif
endfunction
function U64 takes nothing returns nothing
local integer U74=(LoadInteger(LY,(GetHandleId(GetTriggerUnit())),(710)))
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(710),(R2I(GetUnitAbilityLevel(GetTriggerUnit(),'A0CQ')*0.5)+1))
call SetUnitAbilityLevel(GetTriggerUnit(),'A0CQ',R2I(GetUnitAbilityLevel(GetTriggerUnit(),'A0CQ')*0.5)+1)
call QN4(GetTriggerUnit(),U74-(LoadInteger(LY,(GetHandleId(GetTriggerUnit())),(710))))
endfunction
function U84 takes nothing returns boolean
if GetUnitAbilityLevel(GetKillingUnit(),'A0BR')>0 and IsUnitIllusion(GetTriggerUnit())==false then
call U54()
elseif GetUnitAbilityLevel(K1[GetPlayerId(GetOwningPlayer(GetKillingUnit()))],'A0BR')>0 and GetUnitTypeId(GetKillingUnit())=='e00C' then
call U54()
endif
if GetUnitAbilityLevel(GetTriggerUnit(),'A0BR')>0 and IsUnitIllusion(GetTriggerUnit())==false then
call U64()
endif
return false
endfunction
function U94 takes nothing returns boolean
local unit SFI=K1[GetPlayerId(GetTriggerPlayer())]
local integer UA4=GetUnitAbilityLevel(SFI,'A0CQ')-1
local integer UB4=0
local integer level=GetUnitAbilityLevel(SFI,'A0BR')
if level==1 then
set UB4=12
elseif level==2 then
set UB4=20
elseif level==3 then
set UB4=28
elseif level==4 then
set UB4=36
endif
set UA4=IMaxBJ(IMinBJ(UA4,UB4),0)
if GetUnitTypeId(SFI)=='Nfir' then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"灵魂收集数目："+" "+I2S(UA4)+"/"+I2S(UB4))
endif
return false
endfunction
function L91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function U84))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function U94))
set t=null
endfunction
function UC4 takes nothing returns boolean
return GetSpellAbilityId()=='A02H'
endfunction
function UD4 takes nothing returns nothing
local unit dummy
if(PLI()==false)then
set dummy=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'e00E',GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit()),bj_UNIT_FACING)
call AddSkill(dummy,'A02R')
call IssueTargetOrder(dummy,"slow",GetSpellTargetUnit())
else
set dummy=CreateUnit(GetOwningPlayer(GetTriggerUnit()),'e00E',GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit()),bj_UNIT_FACING)
call AddSkill(dummy,'A1H1')
call IssueTargetOrder(dummy,"slow",GetSpellTargetUnit())
endif
endfunction
function LE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UC4))
call TriggerAddAction(t,function UD4)
endfunction
function UE4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call ResetUnitAnimation(hero)
call RemoveUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set hero=null
set dummy=null
set t=null
return false
endfunction
function UF4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'u01I',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function UE4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SetUnitVertexColorBJ(dummy,0,0,0,75)
call SetUnitAnimation(dummy,"spell third")
set hero=null
set dummy=null
set t=null
endfunction
function UG4 takes nothing returns boolean
if GetSpellAbilityId()=='A08C' and GetUnitAbilityLevel(GetTriggerUnit(),'A08C')<5 then
call UF4()
endif
return false
endfunction
function LF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function UG4))
set t=null
endfunction
function UH4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function UZ4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer DC1
local integer level=GetUnitAbilityLevel(hero,'A03K')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1B0')
endif
if level==1 then
set DC1=25
elseif level==2 then
set DC1=50
elseif level==3 then
set DC1=80
endif
call TriggerRegisterTimerEvent(t,DC1,false)
call TriggerAddCondition(t,Condition(function UH4))
set hero=null
set t=null
endfunction
function UV4 takes nothing returns boolean
if GetSpellAbilityId()=='A03K' or GetSpellAbilityId()=='A1B0' then
call UZ4()
endif
return false
endfunction
function LG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function UV4))
set t=null
endfunction
function UW4 takes nothing returns boolean
return(GetLearnedSkill()=='A086' or GetLearnedSkill()=='A08E')and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function UX4 takes nothing returns boolean
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit UY4=(LoadUnitHandle(LY,(handle_id),(304)))
local unit XO3=(LoadUnitHandle(LY,(handle_id),(305)))
if UY4==null or IsUnitDead(UY4)or PLI()or ES1(UY4,FR0[K30])==null then
call ShowUnit(XO3,false)
else
call ShowUnit(XO3,true)
call MUSetUnitX(XO3,GetUnitX(UY4))
call MUSetUnitY(XO3,GetUnitY(UY4))
endif
if GetOwningPlayer(XO3)!=GetOwningPlayer(UY4)then
call SetUnitOwner(XO3,GetOwningPlayer(UY4),true)
endif
return false
endfunction
function UJ4 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit UY4=(LoadUnitHandle(LY,(handle_id),(304)))
if UY4!=null and PLI()and IsUnitDead(UY4)==false then
call UnitRemoveAbility(UY4,'A116')
call UnitRemoveAbility(UY4,'A117')
call SetUnitAbilityLevel(UY4,'S00A',5)
call SetUnitAbilityLevel(UY4,'A08C',5)
elseif UY4!=null and PLI()==false and IsUnitDead(UY4)==false then
call AddSkill(UY4,'A116')
call AddSkill(UY4,'A117')
call SetUnitAbilityLevel(UY4,'S00A',GetUnitAbilityLevel(UY4,'A086'))
call SetUnitAbilityLevel(UY4,'A08C',GetUnitAbilityLevel(UY4,'A08E'))
endif
endfunction
function UK4 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggerUnit())
local trigger t
if((LoadBoolean(LY,(handle_id),(306)))==false)then
call SaveBoolean(LY,(handle_id),(306),(true))
set t=CreateTrigger()
call TriggerRegisterTimerEventPeriodic(t,2.00)
call TriggerRegisterGameStateEventTimeOfDay(t,LESS_THAN,6.00)
call TriggerRegisterGameStateEventTimeOfDay(t,GREATER_THAN,18.00)
call TriggerAddAction(t,function UJ4)
call SaveUnitHandle(LY,(GetHandleId(t)),(304),(GetTriggerUnit()))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function UX4))
call SaveUnitHandle(LY,(handle_id),(304),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(305),(CreateUnit(GetOwningPlayer(GetTriggerUnit()),'o01A',GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)))
endif
if(GetLearnedSkill()=='A086')then
call AddSkill(GetTriggerUnit(),'S00A')
if(PLI())then
call SetUnitAbilityLevel(GetTriggerUnit(),'S00A',5)
else
call SetUnitAbilityLevel(GetTriggerUnit(),'S00A',GetUnitAbilityLevel(GetTriggerUnit(),'A086'))
endif
endif
if(GetLearnedSkill()=='A08E')then
call UnitAddAbility(GetTriggerUnit(),'A08C')
if(PLI())then
call SetUnitAbilityLevel(GetTriggerUnit(),'A08C',5)
else
call SetUnitAbilityLevel(GetTriggerUnit(),'A08C',GetUnitAbilityLevel(GetTriggerUnit(),'A08E'))
endif
endif
endfunction
function LD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function UW4))
call TriggerAddAction(t,function UK4)
endfunction
function UL4 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real PAI=20+level*40
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer UM4=GetUnitAbilityLevel(hero,'A03Q')
if IsUnitType(target,UNIT_TYPE_HERO)==true then
set PAI=PAI/2
endif
if UM4>0 and GetRandomReal(0,100)<15 then
set PAI=PAI*(1.2+1.1*UM4)
call UYI(I2S(R2I(PAI))+"!",3,target,0.02,255,0,0,255)
endif
call AddSkill(dummy,'A0YL')
call SetUnitAbilityLevel(dummy,'A0YL',level)
call IssueTargetOrder(dummy,"slow",target)
call Damage(hero,target,3,PAI)
set hero=null
set target=null
set dummy=null
endfunction
function UN4 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=IJ1(SFI,target,'h010',"UL4",1200,true)
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(SFI,'A0YM')))
set SFI=null
set target=null
set t=null
endfunction
function US4 takes nothing returns boolean
if GetSpellAbilityId()=='A0YM' and CanResistSkill(GetSpellTargetUnit())==false then
call UN4()
endif
return false
endfunction
function LZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function US4))
set t=null
endfunction
function UT4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(hero,'A1CO')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetTriggerUnit()!=target and GetAttacker()==hero then
call UnitRemoveAbility(hero,'A1CO')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerUnit()==target and GetAttacker()==hero then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==4 then
call UnitRemoveAbility(hero,'A1CO')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
else
call UnitRemoveAbility(hero,'A1CO')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function UR4 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A0PL')
local trigger t
local integer handle_id
call DestroyEffect(AddSpecialEffect("war3mapImported\\PhantomStrike.mdx",GetUnitX(hero),GetUnitY(hero)))
call MUSetUnitX(hero,GetUnitX(target))
call MUSetUnitY(hero,GetUnitY(target))
if IsUnitAlly(hero,GetOwningPlayer(target))==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call AddSkill(hero,'A1CO')
call IssueTargetOrder(hero,"attack",target)
call TriggerRegisterTimerEvent(t,3,false)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function UT4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
endif
set hero=null
set target=null
set t=null
endfunction
function UP4 takes nothing returns boolean
if GetSpellAbilityId()=='A0PL' then
call UR4()
endif
return false
endfunction
function LV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UP4))
set t=null
endfunction
function UQ4 takes unit hero,boolean SG2 returns nothing
local integer level=GetUnitAbilityLevel(hero,'A03P')
if SG2==false then
call UnitRemoveAbility(hero,'A13F')
call UnitRemoveAbility(hero,'B0A2')
else
call AddSkill(hero,'A13F')
endif
endfunction
function UU4 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local boolean I05=(LoadBoolean(LY,(handle_id),(674)))
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if hero!=null and IsUnitDead(hero)==false and GetUnitAbilityLevel(hero,'A03P')>0 then
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1625,Condition(function CB1))
if FirstOfGroup(g)!=null then
if I05==true and NPI>7 then
set I05=false
call SaveBoolean(LY,(handle_id),(674),(I05))
set NPI=0
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if I05==false then
set NPI=0
call SaveInteger(LY,(handle_id),(34),(NPI))
call SaveInteger(LY,(GetHandleId((hero))),((4302)),(2))
call UQ4(hero,false)
call SetUnitVertexColorBJ(hero,100,100,100,0)
if GetUnitAbilityLevel(hero,'A20S')==0 then
call UnitSetUsesAltIcon(hero,false)
endif
endif
else
if I05==false and NPI>7 then
set I05=true
set NPI=0
call SaveBoolean(LY,(handle_id),(674),(I05))
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if I05==true then
set NPI=0
call SaveInteger(LY,(handle_id),(34),(NPI))
call SaveInteger(LY,(GetHandleId((hero))),((4302)),(1))
call UQ4(hero,true)
call SetUnitVertexColorBJ(hero,100,100,100,75)
if IsPlayerEnemy(GetOwningPlayer(hero),GetLocalPlayer())==true and P0I(GetLocalPlayer())==false then
call UnitSetUsesAltIcon(hero,true)
else
call UnitSetUsesAltIcon(hero,false)
endif
endif
endif
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function II5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function UU4))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveBoolean(LY,(handle_id),(674),(false))
set t=null
set hero=null
endfunction
function I15 takes nothing returns boolean
if GetLearnedSkill()=='A03P' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A03P')==1 then
call II5()
endif
return false
endfunction
function LH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function I15))
set t=null
endfunction
function IO5 takes nothing returns nothing
local unit dummy
if IsUnitInGroup(GetEnumUnit(),XK)==false then
call GroupAddUnit(XK,GetEnumUnit())
set dummy=CreateUnit(GetOwningPlayer(GetEnumUnit()),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call AddSkill(dummy,'A0RI')
call SetUnitAbilityLevel(dummy,'A0RI',GetUnitAbilityLevel(ZNI,'A0RA'))
call IssueTargetOrder(dummy,"ensnare",GetEnumUnit())
call Damage(ZNI,GetEnumUnit(),1,100)
endif
set dummy=null
endfunction
function I25 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer i
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group DY1=NTI()
local unit PKI=(LoadUnitHandle(LY,(handle_id),(221)))
set GK=PKI
set ZNI=PKI
call GroupEnumUnitsInRange(DY1,x,y,300,Condition(function CA1))
set XK=g
call ForGroup(DY1,function IO5)
call NSI(DY1)
if GetTriggerEvalCount(t)>ZLI*10 then
set i=1
loop
exitwhen i>16
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(2700+i))))
set i=i+1
endloop
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set g=null
set DY1=null
set PKI=null
return false
endfunction
function I35 takes nothing returns nothing
local integer i=1
local location point=GetSpellTargetLoc()
local real I45=GetLocationX(point)
local real I55=GetLocationY(point)
local real x
local real y
local integer JF2=16
local string fx="Abilities\\Spells\\Undead\\Graveyard\\GraveMarker.mdl"
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
call IO1(EC,I45,I55)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function I25))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveUnitHandle(LY,(handle_id),(221),(GetTriggerUnit()))
call SaveReal(LY,(handle_id),(6),((I45)*1.0))
call SaveReal(LY,(handle_id),(7),((I55)*1.0))
loop
exitwhen i>JF2
set x=I45+ZMI*Cos(i*360/JF2*bj_DEGTORAD)
set y=I55+ZMI*Sin(i*360/JF2*bj_DEGTORAD)
call SaveEffectHandle(LY,(handle_id),(2700+i),(AddSpecialEffect(fx,x,y)))
if i==1 or i==5 or i==9 or i==13 then
set x=I45+275*Cos(i*360/JF2*bj_DEGTORAD)
set y=I55+275*Sin(i*360/JF2*bj_DEGTORAD)
endif
set i=i+1
endloop
set t=null
set g=null
endfunction
function I65 takes nothing returns boolean
if GetSpellAbilityId()=='A0RA' then
call I35()
endif
return false
endfunction
function S41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function I65))
set t=null
endfunction
function I75 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(393)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer R2O=90
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A2MB' then
call KillUnit(dummy)
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
if level==1 then
set R2O=160
elseif level==2 then
set R2O=120
endif
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
if NPI>R2O then
call KillUnit(dummy)
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
elseif NPI>30 then
call UnitRemoveAbility(dummy,'Aloc')
call ShowUnit(dummy,true)
call AddSkill(dummy,'Aloc')
endif
set t=null
set dummy=null
set hero=null
return false
endfunction
function I85 takes nothing returns nothing
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIil\\AIilTarget.mdl",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
call SCI(GetEnumUnit(),4406,1)
call SetUnitPosition(GetEnumUnit(),AK,BK)
call PanCameraToTimedForPlayer(GetOwningPlayer(GetEnumUnit()),AK,BK,0)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Items\\AIil\\AIilTarget.mdl",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
endfunction
function I95 takes unit hero,unit target returns nothing
local group g=NTI()
call DestroyEffect(AddSpecialEffect("Doodads\\Cinematic\\ShimmeringPortal\\ShimmeringPortal.mdl",GetUnitX(hero),GetUnitY(hero)))
call DestroyEffect(AddSpecialEffect("Doodads\\Cinematic\\ShimmeringPortal\\ShimmeringPortal.mdl",GetUnitX(target),GetUnitY(target)))
set AK=GetUnitX(target)
set BK=GetUnitY(target)
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),475,Condition(function CU1))
call ForGroup(g,function I85)
call NSI(g)
set g=null
endfunction
function IA5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
if GetTriggerEventId()==EVENT_UNIT_DEATH or target==null or IsUnitDead(target)then
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
call UnitRemoveType(target,UNIT_TYPE_PEON)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A0R0',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2MB',false)
call PZI(GetOwningPlayer(hero),"无效的目标，或者目标已死亡")
elseif hero==null or IsUnitDead(hero)then
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
call UnitRemoveType(target,UNIT_TYPE_PEON)
call PZI(GetOwningPlayer(hero),"施法英雄不存在或已经死亡")
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A0R0',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2MB',false)
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2MB' then
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
call UnitRemoveType(target,UNIT_TYPE_PEON)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A0R0',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2MB',false)
endif
else
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
call UnitRemoveType(target,UNIT_TYPE_PEON)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A0R0',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2MB',false)
call I95(hero,target)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IB5 takes nothing returns boolean
local real d
if IsUnitAlly(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))==false or GetUnitAbilityLevel(GetFilterUnit(),'A04R')>0 or GetOwningPlayer(GetFilterUnit())==Player(15)then
return false
endif
if(IsUnitDead(GetFilterUnit()))then
return false
endif
if IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)or(UJ>0 and C92(GetFilterUnit()))then
set d=QNI(BK,CK,GetUnitX(GetFilterUnit()),GetUnitY(GetFilterUnit()))
if d<AK then
set AK=d
set GK=GetFilterUnit()
endif
endif
return false
endfunction
function IC5 takes unit hero returns unit
local location point
local group g
local real x
local real y
set point=GetSpellTargetLoc()
set x=GetLocationX(point)
set y=GetLocationY(point)
set g=NTI()
set UJ=GetUnitAbilityLevel(hero,'A0R0')
set GK=null
set AK=9999
set BK=x
set CK=y
call GroupEnumUnitsInRange(g,x,y,4000,Condition(function IB5))
call NSI(g)
call RemoveLocation(point)
set point=null
set g=null
return GK
endfunction
function ID5 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetSpellTargetUnit()
local real x
local real y
local unit u
if target==null then
set target=IC5(hero)
endif
if target==null then
call PZI(GetOwningPlayer(hero),"附近找不到目标")
return
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A0R0',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2MB',true)
call AddSkill(hero,'A2MB')
call TriggerRegisterTimerEvent(t,6-GetUnitAbilityLevel(hero,'A0R0'),false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IA5))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\DarkHands.mdl",target,"overhead")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call UnitAddType(target,UNIT_TYPE_PEON)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,.03,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function I75))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(hero,'A0R0')))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set u=CreateUnit(GetOwningPlayer(hero),'h098',GetUnitX(hero),GetUnitY(hero),0)
call SaveUnitHandle(LY,(handle_id),(393),(u))
call ShowUnit(u,false)
set t=null
set target=null
endfunction
function IE5 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local unit SFI=GetTriggerUnit()
if target!=null then
if IsUnitAlly(target,GetOwningPlayer(SFI))==false then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"必须以友方单位或建筑为目标。")
elseif GetUnitAbilityLevel(SFI,'A0R0')>0 and C92(target)==false then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"必须以友方单位或建筑为目标。")
endif
endif
if target==null then
set target=IC5(SFI)
endif
if target==null then
call PJI(SFI)
call PZI(GetOwningPlayer(SFI),"附近找不到目标")
endif
set target=null
set SFI=null
endfunction
function IF5 takes nothing returns boolean
if GetSpellAbilityId()=='A0R0' then
call IE5()
endif
return false
endfunction
function IG5 takes nothing returns boolean
if GetSpellAbilityId()=='A0R0' then
call ID5(GetTriggerUnit())
endif
return false
endfunction
function S21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function IF5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IG5))
set t=null
call A51('h094')
call A51('h095')
call A51('h096')
endfunction
function IH5 takes nothing returns nothing
call Damage(ZTI,GetEnumUnit(),1,ZSI)
endfunction
function IZ5 takes nothing returns nothing
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)+ZSI*0.5)
endfunction
function IV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g=NTI()
local real r1=600
local real r2=600
local unit IW5
set x=GetUnitX(SFI)
set y=GetUnitY(SFI)
call GroupEnumUnitsInRange(g,x,y,r1,Condition(function D91))
set IW5=FirstOfGroup(g)
call NSI(g)
if IW5==null then
if(LoadBoolean(LY,(handle_id),(307)))==true and(LoadBoolean(LY,(handle_id),(308)))==true then
call UnitRemoveAbility(SFI,'A283')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if(LoadBoolean(LY,(handle_id),(307)))==false then
call SaveBoolean(LY,(handle_id),(307),(true))
else
call SaveBoolean(LY,(handle_id),(308),(true))
endif
endif
else
set x=GetUnitX(IW5)
set y=GetUnitY(IW5)
call SaveBoolean(LY,(handle_id),(307),(false))
call SaveBoolean(LY,(handle_id),(308),(false))
call FlushChildHashtable(LY,(GetHandleId(IW5)))
call DestroyEffect(AddSpecialEffect("war3mapImported\\CorpseExplosion.mdx",x,y))
call RemoveUnit(IW5)
set g=NTI()
set GK=SFI
set ZTI=SFI
set ZSI=20*GetUnitAbilityLevel(SFI,'A288')
call GroupEnumUnitsInRange(g,x,y,r2,Condition(function CA1))
call ForGroup(g,function IH5)
set GK=SFI
call GroupEnumUnitsInRange(g,x,y,r2,Condition(function CT1))
call ForGroup(g,function IZ5)
call NSI(g)
endif
set g=null
set SFI=null
set IW5=null
set t=null
return false
endfunction
function IX5 takes nothing returns nothing
local real x=GetUnitX(GetTriggerUnit())
local real y=GetUnitY(GetTriggerUnit())
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call IO1(QF,x,y)
call TriggerRegisterTimerEvent(t,1.5,true)
call TriggerAddCondition(t,Condition(function IV5))
call AddSkill(GetTriggerUnit(),'A283')
call SaveUnitHandle(LY,(handle_id),(14),(GetTriggerUnit()))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveBoolean(LY,(handle_id),(307),(false))
call SaveBoolean(LY,(handle_id),(308),(false))
set t=null
endfunction
function IY5 takes nothing returns boolean
if GetSpellAbilityId()=='A288' then
call IX5()
endif
return false
endfunction
function S31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IY5))
set t=null
endfunction
function IJ5 takes nothing returns nothing
endfunction
function IK5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group g=NTI()
set GK=hero
set ZRI=GetUnitAbilityLevel(hero,'A01I')*10+10
call GroupEnumUnitsInRange(g,GetUnitX(dummy),GetUnitY(dummy),475,Condition(function CT1))
call ForGroup(g,function IJ5)
call NSI(g)
if GetTriggerEvalCount(t)==5 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set dummy=null
return false
endfunction
function IL5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local integer level=GetUnitAbilityLevel(hero,'A01I')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call TriggerAddCondition(t,Condition(function IK5))
call TriggerRegisterTimerEvent(t,1,true)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call AddSkill(dummy,'A262')
call SetUnitAbilityLevel(dummy,'A262',level)
call IssuePointOrder(dummy,"rainoffire",x,y)
set hero=null
set dummy=null
endfunction
function IM5 takes nothing returns boolean
if GetSpellAbilityId()=='A01I' then
call IL5()
endif
return false
endfunction
function S51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IM5))
set t=null
endfunction
function IN5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A24Q')
local integer JV3
local real IS5
local real IT5=3+level
if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetTriggerEvalCount(t)>4*IT5 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A24Z')
call UnitRemoveAbility(target,'A250')
call UnitRemoveAbility(target,'A24X')
call UnitRemoveAbility(target,'A251')
call UnitRemoveAbility(target,'A24Y')
call UnitRemoveAbility(target,'B0EH')
else
set IS5=100*GetUnitState(target,UNIT_STATE_LIFE)/GetUnitState(target,UNIT_STATE_MAX_LIFE)
if IS5<20 then
set JV3=5
elseif IS5<40 then
set JV3=4
elseif IS5<60 then
set JV3=3
elseif IS5<80 then
set JV3=2
else
set JV3=1
endif
if JV3==1 then
if GetUnitAbilityLevel(target,'A24Z')==0 then
call UnitRemoveAbility(target,'A250')
call UnitRemoveAbility(target,'A24X')
call UnitRemoveAbility(target,'A251')
call UnitRemoveAbility(target,'A24Y')
call UnitRemoveAbility(target,'B0EH')
call UnitAddAbility(target,'A24Z')
endif
elseif JV3==2 then
if GetUnitAbilityLevel(target,'A250')==0 then
call UnitRemoveAbility(target,'A24Z')
call UnitRemoveAbility(target,'A24X')
call UnitRemoveAbility(target,'A251')
call UnitRemoveAbility(target,'A24Y')
call UnitRemoveAbility(target,'B0EH')
call UnitAddAbility(target,'A250')
endif
elseif JV3==3 then
if GetUnitAbilityLevel(target,'A24X')==0 then
call UnitRemoveAbility(target,'A24Z')
call UnitRemoveAbility(target,'A250')
call UnitRemoveAbility(target,'A251')
call UnitRemoveAbility(target,'A24Y')
call UnitRemoveAbility(target,'B0EH')
call UnitAddAbility(target,'A24X')
endif
elseif JV3==4 then
if GetUnitAbilityLevel(target,'A251')==0 then
call UnitRemoveAbility(target,'A24Z')
call UnitRemoveAbility(target,'A250')
call UnitRemoveAbility(target,'A24X')
call UnitRemoveAbility(target,'A24Y')
call UnitRemoveAbility(target,'B0EH')
call UnitAddAbility(target,'A251')
endif
elseif JV3==5 then
if GetUnitAbilityLevel(target,'A24Y')==0 then
call UnitRemoveAbility(target,'A24Z')
call UnitRemoveAbility(target,'A250')
call UnitRemoveAbility(target,'A24X')
call UnitRemoveAbility(target,'A251')
call UnitRemoveAbility(target,'B0EH')
call UnitAddAbility(target,'A24Y')
endif
endif
call Damage(hero,target,1,0.01*4*0.25*GetUnitState(target,UNIT_STATE_MAX_LIFE))
if ModuloInteger(GetTriggerEvalCount(t),4)==0 then
call CreateCorpse(GetOwningPlayer(hero),'ugho',GetUnitX(target),GetUnitY(target),0)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IR5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A24Q')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\EntanglingBonesTarget.mdx",target,"chest")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function IN5))
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24Z',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A250',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24X',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A251',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A24Y',false)
set hero=null
set target=null
set t=null
endfunction
function IP5 takes nothing returns boolean
if GetSpellAbilityId()=='A24Q' and CanResistSkill(GetSpellTargetUnit())==false then
call IR5()
endif
return false
endfunction
function S61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IP5))
set t=null
endfunction
function IQ5 takes unit hero,integer IU5 returns nothing
call SaveInteger(LY,(GetHandleId(hero)),(687),(IU5))
call UnitRemoveAbility(hero,'A25X')
call UnitRemoveAbility(hero,'A25Y')
call UnitRemoveAbility(hero,'A25Z')
call UnitRemoveAbility(hero,'A25T')
call UnitRemoveAbility(hero,'A25V')
call UnitRemoveAbility(hero,'A25U')
call UnitRemoveAbility(hero,'A25S')
call UnitRemoveAbility(hero,'A25R')
call UnitRemoveAbility(hero,'A25W')
call UnitRemoveAbility(hero,'A260')
call UnitRemoveAbility(hero,'A26M')
call UnitRemoveAbility(hero,'A26L')
call UnitRemoveAbility(hero,'A26G')
call UnitRemoveAbility(hero,'A26H')
call UnitRemoveAbility(hero,'A26F')
call UnitRemoveAbility(hero,'A26E')
call UnitRemoveAbility(hero,'A256')
call UnitRemoveAbility(hero,'A26I')
call UnitRemoveAbility(hero,'A26J')
call UnitRemoveAbility(hero,'A26K')
call UnitRemoveAbility(hero,'A26D')
if IU5==0 then
call UnitAddAbility(hero,'A26M')
endif
if IU5==1 then
call AddSkill(hero,'A25X')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25X',false)
call UnitAddAbility(hero,'A26L')
elseif IU5==2 then
call AddSkill(hero,'A25Y')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25Y',false)
call UnitAddAbility(hero,'A26G')
elseif IU5==3 then
call AddSkill(hero,'A25Z')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25Z',false)
call UnitAddAbility(hero,'A26H')
elseif IU5==4 then
call AddSkill(hero,'A25T')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25T',false)
call UnitAddAbility(hero,'A26F')
elseif IU5==5 then
call AddSkill(hero,'A25V')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25V',false)
call UnitAddAbility(hero,'A26E')
elseif IU5==6 then
call AddSkill(hero,'A25U')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25U',false)
call UnitAddAbility(hero,'A256')
elseif IU5==7 then
call AddSkill(hero,'A25S')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25S',false)
call UnitAddAbility(hero,'A26I')
elseif IU5==8 then
call AddSkill(hero,'A25R')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25R',false)
call UnitAddAbility(hero,'A26J')
elseif IU5==9 then
call AddSkill(hero,'A25W')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A25W',false)
call UnitAddAbility(hero,'A26K')
elseif IU5==10 then
call AddSkill(hero,'A260')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A260',false)
call UnitAddAbility(hero,'A26D')
endif
endfunction
function O05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer IU5=(LoadInteger(LY,(GetHandleId(hero)),(687)))
local group g
local unit IW5
local integer level=GetUnitAbilityLevel(hero,'A261')
local integer OI5=2+2*level
if IU5<OI5 and IsUnitDead(hero)==false then
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),925,Condition(function D91))
set IW5=FirstOfGroup(g)
call NSI(g)
if IW5!=null then
set IU5=IU5+1
call IQ5(hero,IU5)
call IJ1((IW5),(hero),'h0D6',"CorpseCollector_FX_Nothing",400,false)
call RemoveUnit(IW5)
endif
endif
set t=null
set hero=null
set IW5=null
return false
endfunction
function O15 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,4,true)
call TriggerAddCondition(t,Condition(function O05))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function OO5 takes nothing returns nothing
call Damage(ZPI,GetEnumUnit(),1,ZQI)
endfunction
function O25 takes unit hero,integer level,real QJI,real QKI,integer IU5,boolean EB2 returns nothing
local group g=NTI()
set ZPI=hero
set ZQI=30*IU5
if EB2 then
set ZQI=ZQI+10*IU5
endif
set GK=hero
call GroupEnumUnitsInRange(g,QJI,QKI,350,Condition(function CA1))
call ForGroup(g,function OO5)
call NSI(g)
endfunction
function O35 takes unit hero,real IO3,real I23 returns boolean
local real QJI=(LoadReal(LY,(GetHandleId(hero)),(690)))
local real QKI=(LoadReal(LY,(GetHandleId(hero)),(691)))
if QJI==0 and QKI==0 then
return false
endif
if QNI(IO3,I23,QJI,QKI)<425 then
return true
endif
return false
endfunction
function O45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer IU5=(LoadInteger(LY,(handle_id),(34)))
local integer level=GetUnitAbilityLevel(hero,'A261')
local integer i=1
local unit dummy
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real x
local real y
local real a=(LoadReal(LY,(handle_id),(137)))
local boolean EB2=(LoadBoolean(LY,(handle_id),(688)))
local boolean O55=(LoadBoolean(LY,(handle_id),(689)))
local real O65=(LoadReal(LY,(handle_id),(549)))
local real O75=(LoadReal(LY,(handle_id),(567)))
set O65=PTI(O65+10*Cos(a))
set O75=PUI(O75+10*Sin(a))
call SaveReal(LY,(handle_id),(549),((O65)*1.0))
call SaveReal(LY,(handle_id),(567),((O75)*1.0))
if EB2==false then
set EB2=O35(hero,O65,O75)
if EB2==true then
call SaveBoolean(LY,(handle_id),(688),(EB2))
endif
endif
if EB2 and O55==false then
set O55=true
call SaveBoolean(LY,(handle_id),(689),(O55))
loop
exitwhen i>IU5
set dummy=(LoadUnitHandle(LY,(handle_id),(393+i)))
call SaveEffectHandle(LY,(handle_id),(609+i),(AddSpecialEffectTarget("war3mapImported\\CorpseFire.mdx",dummy,"origin")))
set i=i+1
endloop
endif
set i=1
if QNI(O65,O75,QJI,QKI)<15 then
loop
exitwhen i>IU5
if EB2 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(609+i))))
endif
call KillUnit((LoadUnitHandle(LY,(handle_id),(393+i))))
set i=i+1
endloop
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call O25(hero,level,QJI,QKI,IU5,EB2)
else
loop
exitwhen i>IU5
set dummy=(LoadUnitHandle(LY,(handle_id),(393+i)))
set x=(LoadReal(LY,(handle_id),(549+i)))
set y=(LoadReal(LY,(handle_id),(567+i)))
set x=PTI(x+10*Cos(a))
set y=PUI(y+10*Sin(a))
call SaveReal(LY,(handle_id),(549+i),((x)*1.0))
call SaveReal(LY,(handle_id),(567+i),((y)*1.0))
call MUSetUnitX(dummy,x)
call MUSetUnitY(dummy,y)
set i=i+1
endloop
endif
set t=null
set dummy=null
set hero=null
return false
endfunction
function O85 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local integer level=GetUnitAbilityLevel(hero,'A261')
local integer IU5=(LoadInteger(LY,(GetHandleId(hero)),(687)))
local integer i=1
local unit dummy
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real a=UEI(GetUnitX(hero),GetUnitY(hero),QJI,QKI)*bj_DEGTORAD
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(IU5))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(549),((x)*1.0))
call SaveReal(LY,(handle_id),(567),((y)*1.0))
call SaveBoolean(LY,(handle_id),(688),(false))
call SaveBoolean(LY,(handle_id),(689),(false))
loop
exitwhen i>IU5
set dummy=CreateUnit(GetOwningPlayer(hero),'h0D7',x+GetRandomInt(-200,200),y+GetRandomInt(-200,200),0)
call SaveUnitHandle(LY,(handle_id),(393+i),(dummy))
call SaveReal(LY,(handle_id),(549+i),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(567+i),((GetUnitY(dummy))*1.0))
set i=i+1
endloop
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function O45))
call IQ5(hero,0)
set hero=null
set t=null
set dummy=null
endfunction
function O95 takes nothing returns boolean
if GetSpellAbilityId()=='A261' then
call O85()
endif
return false
endfunction
function OA5 takes nothing returns boolean
if GetLearnedSkill()=='A261' and GetUnitAbilityLevel(GetTriggerUnit(),'A261')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call O15()
endif
return false
endfunction
function S71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O95))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OA5))
set t=null
endfunction
function OB5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit X44
if GetTriggerEventId()==EVENT_UNIT_SPELL_FINISH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
call UnitApplyTimedLife(dummy,'BTLF',0.1)
elseif IsUnitDead(dummy)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveReal(LY,(handle_id),(6),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(dummy))*1.0))
if x!=GetUnitX(dummy)or y!=GetUnitY(dummy)then
call UnitRemoveAbility(dummy,'A2L4')
else
call UnitAddAbility(dummy,'A2L4')
endif
endif
return false
endfunction
function OC5 takes nothing returns boolean
return GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(ZUI)and GetUnitTypeId(GetFilterUnit())=='u01Y'
endfunction
function OD5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'u01Y',GetUnitX(hero)+100,GetUnitY(hero)+100,0)
local group g
local integer level=GetUnitAbilityLevel(hero,'A2L6')
local real GW1
local unit OE5
local unit OF5
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_SPELL_FINISH)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function OB5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(6),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(dummy))*1.0))
call UnitAddAbility(dummy,'A2L4')
call SetUnitAbilityLevel(dummy,'A2L5',GetUnitAbilityLevel(hero,'A2L6'))
call SaveReal(LY,(GetHandleId(dummy)),(34),(((TimerGetElapsed(M)))*1.0))
set ZUI=hero
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function OC5))
if CountUnitsInGroup(g)>level+1 then
set OF5=FirstOfGroup(g)
set GW1=(LoadReal(LY,(GetHandleId(OF5)),(34)))
set OE5=OF5
call GroupRemoveUnit(g,OF5)
loop
exitwhen OF5==null
if GW1>(LoadReal(LY,(GetHandleId(OF5)),(34)))then
set GW1=(LoadReal(LY,(GetHandleId(OF5)),(34)))
set OE5=OF5
endif
set OF5=FirstOfGroup(g)
call GroupRemoveUnit(g,OF5)
endloop
call KillUnit(OE5)
endif
call NSI(g)
set g=null
set dummy=null
set hero=null
set t=null
endfunction
function OG5 takes nothing returns boolean
if GetSpellAbilityId()=='A2L6' then
call OD5()
endif
return false
endfunction
function S81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OG5))
endfunction
function OH5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer EB2=(LoadInteger(LY,(handle_id),(34)))
call SaveInteger(LY,(GetHandleId(hero)),(783),((LoadInteger(LY,(GetHandleId(hero)),(783)))-EB2))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set hero=null
set t=null
return false
endfunction
function OZ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IFO=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'AIcd')
local integer EB2
local integer E01
if IsUnitInRange(hero,IFO,900+25)and IsUnitDead(hero)==false and IsUnitAlly(hero,GetOwningPlayer(IFO))==false and GetUnitTypeId(IFO)!='n0F5' and IsUnitIllusion(IFO)==false and V51(GetUnitTypeId(IFO))==false and GetUnitAbilityLevel(IFO,'A04R')==0 then
set E01=(LoadInteger(LY,(GetHandleId(hero)),(783)))
if IsUnitType(IFO,UNIT_TYPE_HERO)==true then
set EB2=30
else
set EB2=5
endif
set E01=E01+EB2
call SaveInteger(LY,(GetHandleId(hero)),(783),(E01))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,25+level*5,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function OH5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(EB2))
endif
set t=null
set hero=null
set IFO=null
return false
endfunction
function OV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer E01=(LoadInteger(LY,(GetHandleId(hero)),(783)))
local integer O64=(LoadInteger(LY,(handle_id),(238)))
if O64!=E01 then
call G21(hero,E01)
call SaveInteger(LY,(handle_id),(238),(E01))
endif
set t=null
set hero=null
return false
endfunction
function OW5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function OZ5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function OV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function OX5 takes nothing returns boolean
if GetLearnedSkill()=='AIcd' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'AIcd')==1 then
call OW5()
endif
return false
endfunction
function S91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OX5))
set t=null
endfunction
function OY5 takes nothing returns boolean
return GetUnitAbilityLevel(GetTriggerUnit(),'A06K')>0
endfunction
function OJ5 takes nothing returns nothing
if(GetIssuedOrderId()==String2OrderIdBJ("immolation"))then
call AddSkill(GetTriggerUnit(),'A0AZ')
endif
if(GetIssuedOrderId()==String2OrderIdBJ("unimmolation"))then
call UnitRemoveAbility(GetTriggerUnit(),'A0AZ')
endif
endfunction
function LW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function OY5))
call TriggerAddAction(t,function OJ5)
endfunction
function OK5 takes nothing returns nothing
local integer handle_id=GetHandleId(GetEnumUnit())
if GetTriggerUnit()!=GetEnumUnit()then
call SaveInteger(LY,(handle_id),(672),((LoadInteger(LY,(handle_id),(672)))+1))
endif
endfunction
function OL5 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='U00F' and IsUnitIllusion(GetFilterUnit())==false and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))==true
endfunction
function OM5 takes nothing returns boolean
local group g
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and V51(GetUnitTypeId(GetTriggerUnit()))==false and IsUnitIllusion(GetTriggerUnit())==false then
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),475,Condition(function OL5))
if GetUnitTypeId(GetKillingUnit())=='U00F' then
call GroupAddUnit(g,GetKillingUnit())
endif
call ForGroup(g,function OK5)
call NSI(g)
set g=null
endif
return false
endfunction
function ON5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEvalCount(t)==1 then
call ShowUnit(hero,false)
elseif GetTriggerEvalCount(t)>80 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function OS5 takes nothing returns boolean
local unit dummy
local unit hero
local unit IFO
local trigger t
local integer handle_id
if GetUnitTypeId(GetTriggerUnit())=='U00F' then
set hero=GetTriggerUnit()
set IFO=GetKillingUnit()
if hero==IFO then
set dummy=CreateUnit(GetOwningPlayer(hero),'h0BB',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call SetUnitTimeScale(dummy,0.75)
call UnitApplyTimedLife(dummy,'BTLF',1.0)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodAbomination.mdl",dummy,"origin"))
set dummy=null
call SetSoundPosition(PE,GetUnitX(hero),GetUnitY(hero),50)
call SetSoundVolumeBJ(PE,100)
call PlaySoundBJ(PE)
call SetSoundPosition(UE,GetUnitX(hero),GetUnitY(hero),50)
call SetSoundVolumeBJ(UE,100)
call PlaySoundBJ(UE)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,.1,true)
call TriggerAddCondition(t,Condition(function ON5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endif
set hero=null
set IFO=null
endif
return false
endfunction
function OT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local unit hero=(LoadUnitHandle(LY,(GetHandleId(t)),(2)))
local integer handle_id=GetHandleId(hero)
local integer OR5=(LoadInteger(LY,(handle_id),(672)))
local integer OP5=(LoadInteger(LY,(handle_id),(673)))
local integer level=GetUnitAbilityLevel(hero,'A06D')
local integer OQ5=R2I(I2R(OR5)*(0.5+0.5*level))
if OQ5>OP5 then
call ModifyHeroStat(0,hero,0,OQ5-OP5)
call SaveInteger(LY,(handle_id),(673),(OQ5))
call UYI("+"+I2S(OQ5-OP5)+" "+"力量",3,hero,0.023,0,255,0,230)
endif
set t=null
set hero=null
return false
endfunction
function OU5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function OT5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function A05 takes nothing returns boolean
if GetLearnedSkill()=='A06D' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A06D')==1 then
call OU5()
endif
return false
endfunction
function AI5 takes nothing returns boolean
if GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='U00F' then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"你从腐肉技能中获得了"+" "+I2S((LoadInteger(LY,(GetHandleId(K1[GetPlayerId(GetTriggerPlayer())])),(673))))+" "+"点力量")
endif
return false
endfunction
function LX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function A05))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function AI5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function OS5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function OM5))
set t=null
endfunction
function A15 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local unit X44=CreateUnit(GetOwningPlayer(hero),'e02A',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A0PZ')
call IssueTargetOrder(dummy,"thunderbolt",target)
call UnitApplyTimedLife(dummy,'BTLF',1)
call UnitApplyTimedLife(X44,'BTLF',1)
set dummy=null
set X44=null
endfunction
function AO5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer A25=(LoadInteger(LY,(handle_id),(376)))
local boolean A35=(LoadBoolean(LY,(handle_id),(377)))
local unit target
local unit A45=(LoadUnitHandle(LY,(handle_id),(2100+A25)))
if A35 then
set target=(LoadUnitHandle(LY,(handle_id),(17)))
call MUSetUnitX(target,GetUnitX(A45))
call MUSetUnitY(target,GetUnitY(A45))
endif
call RemoveUnit(A45)
set A25=A25-1
call SaveInteger(LY,(handle_id),(376),(A25))
if A25==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if IsUnitInRegion(MN,target)then
call B41(target)
endif
endif
set t=null
set target=null
return false
endfunction
function A55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer A25=(LoadInteger(LY,(handle_id),(376)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local trigger CR3=(LoadTriggerHandle(LY,(handle_id),(11)))
local integer CN3=GetHandleId(CR3)
local group g
local unit u
local real x
local real y
local real z
if A25<16+2*level then
set A25=A25+1
call SaveInteger(LY,(handle_id),(376),(A25))
set x=GetUnitX(SFI)+A25*50*Cos(RM2*bj_DEGTORAD)
set y=GetUnitY(SFI)+A25*50*Sin(RM2*bj_DEGTORAD)
call SaveUnitHandle(LY,(CN3),(2100+A25),(CreateUnit(GetOwningPlayer(SFI),'u00H',x,y,RM2)))
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,125,Condition(function D31))
call GroupRemoveUnit(g,SFI)
set u=GroupPickRandomUnit(g)
call NSI(g)
if u!=null then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call TriggerRegisterTimerEvent(CR3,0.03,true)
call TriggerAddCondition(CR3,Condition(function AO5))
call SaveInteger(LY,(CN3),(376),(A25))
call SaveBoolean(LY,(CN3),(377),(true))
call SaveUnitHandle(LY,(CN3),(17),(u))
if IsUnitEnemy(u,GetOwningPlayer(SFI))then
if IsUnitType(u,UNIT_TYPE_HERO)==true then
call FL1("HA_Hits"+I2S(GetPlayerId(GetOwningPlayer(SFI))),V0I[GetPlayerId(GetOwningPlayer(SFI))])
set V0I[GetPlayerId(GetOwningPlayer(SFI))]=V0I[GetPlayerId(GetOwningPlayer(SFI))]+1
call SCI(SFI,4400,1.5)
endif
set VII[GetPlayerId(GetOwningPlayer(SFI))]=VII[GetPlayerId(GetOwningPlayer(SFI))]+1
call FL1("HA_Total"+I2S(GetPlayerId(GetOwningPlayer(SFI))),VII[GetPlayerId(GetOwningPlayer(SFI))])
call A15(SFI,u)
call Damage(SFI,u,3,90*level)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Human\\HumanBlood\\BloodElfSpellThiefBlood.mdl",u,"origin"))
endif
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set VII[GetPlayerId(GetOwningPlayer(SFI))]=VII[GetPlayerId(GetOwningPlayer(SFI))]+1
call TriggerRegisterTimerEvent(CR3,0.03,true)
call TriggerAddCondition(CR3,Condition(function AO5))
call SaveInteger(LY,(CN3),(376),(A25))
call SaveBoolean(LY,(CN3),(377),(false))
endif
set t=null
set SFI=null
set CR3=null
set g=null
set u=null
return false
endfunction
function A65 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real RM2=UEI(GetUnitX(SFI),GetUnitY(SFI),GetLocationX(point),GetLocationY(point))
local integer level=GetUnitAbilityLevel(SFI,'A06I')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveInteger(LY,(handle_id),(376),(0))
call SaveTriggerHandle(LY,(handle_id),(11),(CreateTrigger()))
call TriggerRegisterTimerEvent(t,0.0375,true)
call TriggerAddCondition(t,Condition(function A55))
call RemoveLocation(point)
set SFI=null
set point=null
set t=null
endfunction
function A75 takes nothing returns boolean
if GetSpellAbilityId()=='A06I' then
call A65()
endif
return false
endfunction
function A85 takes nothing returns boolean
local integer YT3=V0I[GetPlayerId(GetTriggerPlayer())]
local integer QHI=VII[GetPlayerId(GetTriggerPlayer())]
if GetUnitTypeId(K1[GetPlayerId(GetTriggerPlayer())])=='U00F' and QHI>0 then
call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,U2,10.00,"肉钩准确率"+" "+R2S(I2R(YT3)/I2R(QHI)*100)+"% ("+I2S(YT3)+"/"+I2S(QHI)+")")
endif
return false
endfunction
function LY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function A75))
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-stats",true)
call TriggerRegisterPlayerChatEvent(t,BO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-st",true)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-st",true)
call TriggerAddCondition(t,Condition(function A85))
set t=null
endfunction
function A95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real PAI=(25+50*level)+(1.0)*GetHeroStr(hero,true)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST and GetSpellAbilityId()=='A1CX')then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif GetTriggerEvalCount(t)>4 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call PJI(hero)
else
if level>0 then
set NPI=NPI+1
if(NPI<4 and IsUnitType(target,UNIT_TYPE_HERO)==true)or(NPI<8 and IsUnitType(target,UNIT_TYPE_HERO)==false)then
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+PAI)
call Damage(hero,target,1,PAI)
endif
call SaveInteger(LY,(handle_id),(34),(NPI))
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AA5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A1CX')
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function A95))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
call TriggerEvaluate(t)
set t=null
set hero=null
set target=null
endfunction
function AB5 takes nothing returns boolean
if GetSpellAbilityId()=='A1CX' and CanResistSkill(GetSpellTargetUnit())==false then
call AA5()
endif
return false
endfunction
function LJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AB5))
set t=null
endfunction
function AC5 takes nothing returns boolean
if(GetUnitTypeId(GetSummonedUnit())=='o00L')then
return true
endif
if(GetUnitTypeId(GetSummonedUnit())=='o00M')then
return true
endif
if(GetUnitTypeId(GetSummonedUnit())=='o00N')then
return true
endif
if(GetUnitTypeId(GetSummonedUnit())=='o00O')then
return true
endif
return false
endfunction
function AD5 takes unit SWI,real PAI returns nothing
local real QHI=GetUnitState(SWI,UNIT_STATE_MAX_LIFE)
local real QZI=GetUnitState(SWI,UNIT_STATE_LIFE)
if PAI>0 then
if PAI>(QHI-QZI)then
if PAI>=QZI then
call SetUnitState(SWI,UNIT_STATE_LIFE,QHI)
call QFI(SWI,PAI-(QHI-QZI))
else
call QFI(SWI,PAI)
endif
else
call SetUnitState(SWI,UNIT_STATE_LIFE,GetUnitState(SWI,UNIT_STATE_LIFE)+PAI)
endif
endif
endfunction
function AE5 takes nothing returns nothing
endfunction
function AF5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if IsUnitType(GetEventDamageSource(),UNIT_TYPE_HERO)==true then
call AD5(dummy,GetEventDamage()-1)
else
call AD5(dummy,GetEventDamage()-0.25)
endif
else
set g=NTI()
set GK=dummy
call GroupEnumUnitsInRange(g,GetUnitX(dummy),GetUnitY(dummy),400+300*4+25,Condition(function CA1))
call ForGroup(g,function AE5)
call NSI(g)
set g=null
endif
set t=null
set dummy=null
return false
endfunction
function AG5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=GetSummonedUnit()
call TriggerRegisterDeathEvent(t,dummy)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function AF5))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(GetUnitAbilityLevel(GetSummoningUnit(),'A09D')))
call SetUnitAbilityLevelSwapped('A08T',GetSummonedUnit(),GetUnitAbilityLevelSwapped('A09D',GetSummoningUnit()))
call SetUnitAbilityLevelSwapped('A0CF',GetSummonedUnit(),GetUnitAbilityLevelSwapped('A09D',GetSummoningUnit()))
call IssueImmediateOrder(GetSummonedUnit(),"manaflareon")
endfunction
function NW takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function AC5))
call TriggerAddAction(t,function AG5)
endfunction
function AH5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call DisableTrigger(t)
if IsUnitAlly(hero,GetOwningPlayer(target))==true then
call QGI(target,GetEventDamage()*0.107)
else
call Damage(GetEventDamageSource(),target,1,GetEventDamage()*0.071/1.4)
endif
call EnableTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AZ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call SetUnitVertexColor(target,255,255,255,255)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function AV5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=GetUnitAbilityLevel(hero,'A2TD')
local trigger t
local integer handle_id
if IsUnitAlly(target,GetOwningPlayer(target))==true then
call UnitAddAbility(dummy,'A2ZK')
call SetUnitAbilityLevel(dummy,'A2ZK',level)
else
call UnitAddAbility(dummy,'A0CE')
call SetUnitAbilityLevel(dummy,'A0CE',level)
endif
call IssueTargetOrder(dummy,"banish",target)
if GetUnitTypeId(target)=='n0FJ' or GetUnitTypeId(target)=='n0FI' or GetUnitTypeId(target)=='n0F6' or GetUnitTypeId(target)=='n0FH' then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1.5+0.5*level,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function AZ5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SetUnitVertexColor(target,50,255,50,150)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("Abilities\\Spells\\Undead\\Cripple\\CrippleTarget.mdl",GetUnitX(target),GetUnitY(target))))
set t=null
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1.5+0.5*level,false)
call TriggerAddCondition(t,Condition(function AH5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set hero=null
set target=null
set dummy=null
endfunction
function AW5 takes nothing returns boolean
if GetSpellAbilityId()=='A2TD' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
if(IsUnitType(GetSpellTargetUnit(),UNIT_TYPE_STRUCTURE)==false and RKI(GetSpellTargetUnit())==false)or GetUnitTypeId(GetSpellTargetUnit())=='n0FJ' or GetUnitTypeId(GetSpellTargetUnit())=='n0FI' or GetUnitTypeId(GetSpellTargetUnit())=='n0F6' or GetUnitTypeId(GetSpellTargetUnit())=='n0FH' then
else
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"非法目标")
endif
else
call AV5()
endif
endif
return false
endfunction
function LK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AW5))
set t=null
endfunction
function AX5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A0CC')
local real ZO3=80+40*level
if level==0 then
set level=GetUnitAbilityLevel(hero,'A02Z')
set ZO3=120+60*level
endif
set ZO3=ZO3*0.25
if GetUnitAbilityLevel(hero,'Bdcl')==0 or(GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST and(GetSpellAbilityId()=='A0CC' or GetSpellAbilityId()=='A02Z'))then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()!=EVENT_UNIT_SPELL_ENDCAST then
if GetUnitState(hero,UNIT_STATE_LIFE)+ZO3>=GetUnitState(hero,UNIT_STATE_MAX_LIFE)then
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+ZO3+GetUnitState(hero,UNIT_STATE_LIFE)-GetUnitState(hero,UNIT_STATE_MAX_LIFE))
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AY5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function AX5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set hero=null
set target=null
set t=null
endfunction
function AJ5 takes nothing returns boolean
if(GetSpellAbilityId()=='A0CC' or GetSpellAbilityId()=='A02Z')and IsUnitType(GetSpellTargetUnit(),UNIT_TYPE_HERO)then
call AY5()
endif
return false
endfunction
function LL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AJ5))
set t=null
endfunction
function AK5 takes unit hero,unit target returns nothing
local real AL5=10+20*VOI
local real AM5=80+50*VOI
local real DH1=(AL5+AM5*V3I/700)*0.5
call Damage(hero,target,1,DH1)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\ChimaeraLightningMissile\\ChimaeraLightningMissile.mdl",target,"chest"))
endfunction
function AN5 takes nothing returns nothing
local unit target=GetEnumUnit()
local group JAO=V1I
local unit hero=V2I
if IsUnitInGroup(target,JAO)==false then
call GroupAddUnit(JAO,target)
call AK5(hero,target)
endif
set target=null
set JAO=null
set hero=null
endfunction
function AS5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local effect fx
local integer NPI=GetTriggerEvalCount(t)
local real x
local real x0=GetUnitX(hero)
local real y
local real y0=GetUnitY(hero)
local integer i
local integer d
local group g=NTI()
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
set V1I=JAO
set V2I=hero
set VOI=GetUnitAbilityLevel(hero,'A1E7')
if NPI>20 then
set d=21*36+(20-NPI)*36
set V3I=d
set i=0
loop
exitwhen i>36
set x=x0+d*Cos(360*i/36*bj_DEGTORAD)
set y=y0+d*Sin(360*i/36*bj_DEGTORAD)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,100,Condition(function CH1))
call ForGroup(g,function AN5)
set i=i+1
endloop
else
set d=NPI*36
set V3I=d
set i=0
loop
exitwhen i>36
set x=x0+d*Cos(360*i/36*bj_DEGTORAD)
set y=y0+d*Sin(360*i/36*bj_DEGTORAD)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,100,Condition(function CH1))
call ForGroup(g,function AN5)
set i=i+1
endloop
endif
call NSI(g)
if NPI==40 then
call KillUnit(dummy)
call NSI(JAO)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif NPI==20 then
call GroupClear(JAO)
set fx=null
endif
set t=null
set dummy=null
set JAO=null
set hero=null
set g=null
return false
endfunction
function AT5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'h092',x,y,0)
local integer i=0
local integer VB2=36
local group JAO=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\Lightning_Ball_Tail_FX.mdx",SFI,"origin")))
call SaveGroupHandle(LY,(handle_id),(133),(JAO))
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call TriggerRegisterTimerEvent(t,0.06,true)
call TriggerAddCondition(t,Condition(function AS5))
set t=null
set dummy=null
set SFI=null
endfunction
function AR5 takes nothing returns boolean
if GetSpellAbilityId()=='A1E7' then
call AT5()
endif
return false
endfunction
function NM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AR5))
set t=null
endfunction
function AP5 takes integer AQ5 returns boolean
return AQ5!='A09V' and AQ5!='A026' and AQ5!='A0LZ' and AQ5!='A0QN' and AQ5!='A0OI' and AQ5!='A0DY' and AQ5!='A1WB' and AQ5!='AHfa'
endfunction
function AU5 takes unit R5I,unit hero,unit target,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(R5I),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A1AK')
call SetUnitAbilityLevel(dummy,'A1AK',level)
call IssueTargetOrder(dummy,"chainlightning",target)
call AddSkill(dummy,'A18D')
call SetUnitAbilityLevel(dummy,'A18D',level)
call IssueTargetOrder(dummy,"purge",target)
set dummy=null
endfunction
function B05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level
if GetSpellTargetUnit()==hero and AP5(GetSpellAbilityId())==true and IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(hero))==false and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true then
set level=GetUnitAbilityLevel(hero,'A1E6')
call AU5(hero,hero,GetTriggerUnit(),level)
endif
set t=null
set hero=null
return false
endfunction
function BI5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function B05))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function B15 takes nothing returns boolean
if GetLearnedSkill()=='A1E6' and GetUnitAbilityLevel(GetTriggerUnit(),'A1E6')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call BI5()
endif
return false
endfunction
function NN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function B15))
set t=null
endfunction
function BO5 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,V4I[0])
call UnitRemoveAbility(u,V4I[1])
call UnitRemoveAbility(u,V4I[2])
call UnitRemoveAbility(u,V4I[3])
call UnitRemoveAbility(u,V4I[4])
call UnitRemoveAbility(u,V4I[5])
call UnitRemoveAbility(u,V4I[6])
call UnitRemoveAbility(u,V4I[7])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=i
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call AddSkill(u,V4I[i])
else
call UnitRemoveAbility(u,V4I[i])
endif
set i=i+1
endloop
endfunction
function B25 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,V5I[0])
call UnitRemoveAbility(u,V5I[1])
call UnitRemoveAbility(u,V5I[2])
call UnitRemoveAbility(u,V5I[3])
call UnitRemoveAbility(u,V5I[4])
call UnitRemoveAbility(u,V5I[5])
call UnitRemoveAbility(u,V5I[6])
call UnitRemoveAbility(u,V5I[7])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=i
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call AddSkill(u,V5I[i])
else
call UnitRemoveAbility(u,V5I[i])
endif
set i=i+1
endloop
endfunction
function B35 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
if GetTriggerUnit()==hero then
call BO5(hero,0)
call SaveUnitHandle(LY,(handle_id),(2),(null))
else
call B25(target,0)
call SaveUnitHandle(LY,(handle_id),(17),(null))
endif
else
if hero!=null then
call BO5(hero,0)
endif
if target!=null then
call B25(target,0)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function B45 takes unit hero,unit target,unit QB2 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if QB2==null then
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
elseif QB2==target then
call B25(target,0)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(null))
else
call BO5(hero,0)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(2),(null))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
call TriggerRegisterTimerEvent(t,18,false)
call TriggerAddCondition(t,Condition(function B35))
endfunction
function B55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(196)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=GetTriggerEvalCount(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
call MoveLightning(UZI,true,GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
if QNI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))>700 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyLightning(UZI)
call KillUnit(dummy)
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call B45(hero,target,GetTriggerUnit())
else
call B45(hero,target,null)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif NPI>160 then
call DestroyLightning(UZI)
call KillUnit(dummy)
call B45(hero,target,null)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif ModuloInteger(NPI,20)==0 or NPI==1 then
call BO5(hero,(level*7)*R2I(NPI/20))
call B25(target,(level*7)*R2I(NPI/20))
endif
set t=null
set hero=null
set target=null
set UZI=null
set dummy=null
return false
endfunction
function B65 takes unit hero,unit target,lightning UZI,unit dummy returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1DP')
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function B55))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
set t=null
endfunction
function B75 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(196)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real x0=GetUnitX(hero)
local real y0=GetUnitY(hero)
local real x1=(LoadReal(LY,(handle_id),(64)))
local real y1=(LoadReal(LY,(handle_id),(65)))
local real a=(LoadReal(LY,(handle_id),(137)))
local unit target=null
local group g=NTI()
set x1=PTI(x1+25*Cos(a))
set y1=PUI(y1+25*Sin(a))
call SaveReal(LY,(handle_id),(64),((x1)*1.0))
call SaveReal(LY,(handle_id),(65),((y1)*1.0))
call MoveLightning(UZI,true,x0,y0,x1,y1)
call MUSetUnitX(dummy,x1)
call MUSetUnitY(dummy,y1)
set GK=hero
call GroupEnumUnitsInRange(g,x1,y1,225,Condition(function DO1))
set target=FirstOfGroup(g)
call NSI(g)
if target!=null then
call B65(hero,target,UZI,dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)>25 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyLightning(UZI)
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set UZI=null
set target=null
set g=null
set dummy=null
return false
endfunction
function B85 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t
local integer handle_id
local location point
local lightning UZI=AddLightning("CLSB",true,GetUnitX(hero),GetUnitY(hero),GetUnitX(hero),GetUnitY(hero))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h088',GetUnitX(hero),GetUnitY(hero),0)
call SetLightningColor(UZI,0.3,0.5,1,1)
if target==null then
set point=GetSpellTargetLoc()
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function B75))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(137),((Atan2(GetLocationY(point)-GetUnitY(hero),GetLocationX(point)-GetUnitX(hero)))*1.0))
call SaveReal(LY,(handle_id),(64),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(65),((GetUnitY(hero))*1.0))
call RemoveLocation(point)
set point=null
set t=null
else
call B65(hero,target,UZI,dummy)
endif
set target=null
endfunction
function B95 takes nothing returns boolean
if GetSpellAbilityId()=='A1DP' and CanResistSkill(GetSpellTargetUnit())==false then
call B85()
endif
return false
endfunction
function NS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function B95))
set t=null
set V4I[0]='A1DV'
set V4I[1]='A1DQ'
set V4I[2]='A1DR'
set V4I[3]='A1DS'
set V4I[4]='A1DT'
set V4I[5]='A1DU'
set V4I[6]='A1DW'
set V4I[7]='A1DX'
set V5I[0]='A1E4'
set V5I[1]='A1E3'
set V5I[2]='A1E2'
set V5I[3]='A1E1'
set V5I[4]='A1E0'
set V5I[5]='A1E5'
set V5I[6]='A1DZ'
set V5I[7]='A1DY'
endfunction
function BA5 takes integer handle_id returns nothing
local integer i=1
local integer PY2=(LoadInteger(LY,(handle_id),(136)))
local unit target
local integer PCI
if PY2==0 then
return
endif
loop
exitwhen i>PY2
set PCI=(LoadInteger(LY,(handle_id),(2200+i)))
set target=NYI(PCI)
call NXI(PCI)
call UnitRemoveAbility(target,WN[0])
call UnitRemoveAbility(target,WN[1])
call UnitRemoveAbility(target,WN[2])
call UnitRemoveAbility(target,WN[3])
call UnitRemoveAbility(target,WN[4])
call UnitRemoveAbility(target,WN[5])
set i=i+1
endloop
set target=null
endfunction
function BB5 takes unit target,integer handle_id returns nothing
local integer PCI=NKI(target)
local integer PY2=(LoadInteger(LY,(handle_id),(136)))
set PY2=PY2+1
call SaveInteger(LY,(handle_id),(136),(PY2))
call SaveInteger(LY,(handle_id),(2200+PY2),(PCI))
endfunction
function BC5 takes unit u returns integer
return GetUnitAbilityLevel(u,WN[0])*1+GetUnitAbilityLevel(u,WN[1])*2+GetUnitAbilityLevel(u,WN[2])*4+GetUnitAbilityLevel(u,WN[3])*8+GetUnitAbilityLevel(u,WN[4])*16
endfunction
function BD5 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,WN[0])
call UnitRemoveAbility(u,WN[1])
call UnitRemoveAbility(u,WN[2])
call UnitRemoveAbility(u,WN[3])
call UnitRemoveAbility(u,WN[4])
call UnitRemoveAbility(u,WN[5])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=i
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call AddSkill(u,WN[i])
else
call UnitRemoveAbility(u,WN[i])
endif
set i=i+1
endloop
endfunction
function BE5 takes unit u,integer d returns nothing
if IsUnitType(u,UNIT_TYPE_STRUCTURE)==false then
call BD5(u,d+BC5(u))
call BB5(u,VAI)
endif
endfunction
function BF5 takes unit hero,unit dummy,unit target,integer level returns nothing
call IssueTargetOrder(dummy,"chainlightning",target)
call PDI(hero,target,2,(50+25*level)/2.0,0.3)
call BE5(target,1)
endfunction
function BG5 takes nothing returns boolean
if(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false))and GetUnitTypeId(GetFilterUnit())!='n00L' then
if GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<V9I then
set V9I=GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)
set V8I=GetFilterUnit()
endif
endif
return false
endfunction
function BH5 takes nothing returns boolean
if(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false))and GetUnitTypeId(GetFilterUnit())!='emow' and GetUnitTypeId(GetFilterUnit())!='uzig' and GetUnitTypeId(GetFilterUnit())!='n00L' then
if GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)<V9I then
set V9I=GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)
set V8I=GetFilterUnit()
endif
endif
return false
endfunction
function BZ5 takes unit hero,unit dummy,integer level returns nothing
local group g=NTI()
set V8I=null
set V9I=999999
set V6I=30+30*level
set V7I=hero
set GK=hero
if GetUnitAbilityLevel(hero,'A1UV')>0 then
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),525,Condition(function BH5))
else
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),525,Condition(function BG5))
endif
call NSI(g)
if V8I!=null then
call BF5(hero,dummy,V8I,level)
endif
set g=null
endfunction
function BV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=GetTriggerEvalCount(t)
local real JV3
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call BA5(handle_id)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()==hero then
call KillUnit(dummy)
endif
else
if GetUnitAbilityLevel(hero,'A1UV')>0 then
if level==1 then
set JV3=0.55
elseif level==2 then
set JV3=0.45
else
set JV3=0.35
endif
else
if level==1 then
set JV3=0.7
elseif level==2 then
set JV3=0.6
else
set JV3=0.5
endif
endif
set JV3=JV3/0.05
if ModuloInteger(NPI,R2I(JV3))==0 or NPI==1 then
set VAI=handle_id
call BZ5(hero,dummy,level)
endif
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
endif
set t=null
set hero=null
return false
endfunction
function BW5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A1AO')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h081',GetUnitX(hero),GetUnitY(hero),0)
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1UV')
endif
call UnitApplyTimedLife(dummy,'BTLF',30)
call SetUnitAbilityLevel(dummy,'A1DJ',level)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterDeathEvent(t,dummy)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function BV5))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
set hero=null
set t=null
endfunction
function BX5 takes nothing returns boolean
if GetSpellAbilityId()=='A1AO' or GetSpellAbilityId()=='A1UV' then
call BW5()
endif
return false
endfunction
function NT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BX5))
set t=null
set WN[0]='A1DK'
set WN[1]='A1DL'
set WN[2]='A1DN'
set WN[3]='A1DM'
set WN[4]='A1DO'
endfunction
function BY5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
call SetUnitPosition(SFI,x,y)
call SetUnitAnimation(SFI,"morph ALTERNATE")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function BJ5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(SFI,'A06O')
local location point
local real RM2
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local real QJI
local real QKI
local real EN4
local real ES4
local real CasterX
local real CasterY
local integer CasterAbility
local unit dummy
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real PAI
local real DC1=1.65
local unit DT1=null
if level==1 then
set PAI=100
elseif level==2 then
set PAI=160
elseif level==3 then
set PAI=220
elseif level==4 then
set PAI=280
endif
if GetSpellTargetUnit()!=null then
set point=GetUnitLoc(GetSpellTargetUnit())
else
set point=GetSpellTargetLoc()
endif
set QJI=GetLocationX(point)
set QKI=GetLocationY(point)
call RemoveLocation(point)
set RM2=UEI(x,y,QJI,QKI)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveReal(LY,(handle_id),(6),((QJI)*1.0))
call SaveReal(LY,(handle_id),(7),((QKI)*1.0))
call TriggerRegisterTimerEvent(t,QNI(x,y,QJI,QKI)/2000,false)
call TriggerAddCondition(t,Condition(function BY5))
if QNI(x,y,QJI,QKI)<150 then
set QJI=x+150*Cos(RM2*bj_DEGTORAD)
set QKI=y+150*Sin(RM2*bj_DEGTORAD)
endif
if GetSpellTargetUnit()!=null and CanResistSkill(GetSpellTargetUnit())then
set DT1=GetSpellTargetUnit()
endif
call DS1(SFI,DT1,PAI,DC1,0.52,x,y,QJI,QKI,175,null,true,1600)
set dummy=null
set point=null
set SFI=null
set t=null
endfunction
function BK5 takes nothing returns boolean
if GetSpellAbilityId()=='A06O' then
call BJ5()
endif
return false
endfunction
function LM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BK5))
call Q1I('A0X6')
set t=null
endfunction
function BL5 takes nothing returns nothing
call Damage(VCI,GetEnumUnit(),1,110)
call IssueTargetOrder(VDI,"slow",GetEnumUnit())
endfunction
function BM5 takes unit hero,real x,real y,integer level,integer BN5 returns nothing
local group g=NTI()
local real r
local string fx
if BN5==8 then
set r=675
elseif BN5==9 then
set r=700
elseif BN5==10 then
set r=725
else
set r=250+50*BN5
endif
if BN5<4 then
set fx="war3mapImported\\EpiPulse_1_4.mdx"
elseif BN5<8 then
set fx="war3mapImported\\EpiPulse_5_8.mdx"
else
set fx="war3mapImported\\EpiPulse_9_12.mdx"
endif
call DestroyEffect(AddSpecialEffect(fx,x,y))
set GK=hero
set VCI=hero
set VDI=VBI[GetPlayerId(GetOwningPlayer(hero))]
call GroupEnumUnitsInRange(g,x,y,r,Condition(function CA1))
call ForGroup(g,function BL5)
call NSI(g)
call OF1(0.03,false,x,y,150+100*BN5,150+100*BN5,72,0.03,512)
set g=null
endfunction
function BS5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local boolean CK3=(LoadBoolean(LY,(handle_id),(15)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer KO2=(LoadInteger(LY,(handle_id),(25)))
local integer BT5=4+level*2
local real x=II3
local real y=I13
if CK3 then
set BT5=BT5+2
endif
if KO2>BT5 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if SFI!=null and IsUnitDead(SFI)==false then
set x=GetUnitX(SFI)
set y=GetUnitY(SFI)
endif
call BM5(SFI,x,y,level,KO2)
call SaveInteger(LY,(handle_id),(25),(KO2+1))
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
endif
set t=null
set p=null
set SFI=null
return false
endfunction
function BR5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local player p=GetOwningPlayer(SFI)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(SFI,'A06R')
local boolean CK3=false
if level==0 then
set CK3=true
set level=GetUnitAbilityLevel(SFI,'A1B4')
endif
if IsPlayerTeam1(p)then
set VBI[GetPlayerId(p)]=CreateUnit(CO[0],'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
else
set VBI[GetPlayerId(p)]=CreateUnit(BO[0],'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
endif
call AddSkill(VBI[GetPlayerId(p)],'A17B')
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(SFI)))
call SaveReal(LY,(handle_id),(23),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(SFI))*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(25),(2))
call SaveBoolean(LY,(handle_id),(15),(CK3))
call TriggerRegisterTimerEvent(t,0.35,true)
call TriggerAddCondition(t,Condition(function BS5))
call BM5(SFI,GetUnitX(SFI),GetUnitY(SFI),level,1)
set SFI=null
set t=null
endfunction
function BP5 takes nothing returns boolean
if GetSpellAbilityId()=='A06R' or GetSpellAbilityId()=='A1B4' then
call BR5()
endif
return false
endfunction
function LN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_FINISH)
call TriggerAddCondition(t,Condition(function BP5))
call Q1I('A17B')
set t=null
endfunction
function BQ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if((LoadInteger(LY,(GetHandleId((SFI))),((4299))))==1)==false then
call UnitRemoveAbility(SFI,'B04R')
endif
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(379))))
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(380))))
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(381))))
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(382))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function BU5 takes unit SFI,integer level,unit C05,unit CI5,unit C15,unit CO5 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real DC1
set DC1=1.5
call SaveInteger(LY,(GetHandleId((SFI))),((4299)),(2))
call TriggerRegisterTimerEvent(t,DC1,false)
call TriggerAddCondition(t,Condition(function BQ5))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(379),(C05))
call SaveUnitHandle(LY,(handle_id),(380),(CI5))
call SaveUnitHandle(LY,(handle_id),(381),(C15))
call SaveUnitHandle(LY,(handle_id),(382),(CO5))
set t=null
endfunction
function C25 takes nothing returns boolean
if(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))then
call Damage(VFI,GetFilterUnit(),1,VEI)
endif
return false
endfunction
function C35 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit C05=(LoadUnitHandle(LY,(handle_id),(379)))
local unit CI5=(LoadUnitHandle(LY,(handle_id),(380)))
local unit C15=(LoadUnitHandle(LY,(handle_id),(381)))
local unit CO5=(LoadUnitHandle(LY,(handle_id),(382)))
local integer level=GetUnitAbilityLevel(SFI,'A0H0')
local integer NPI=GetTriggerEvalCount(t)
local group g
local integer C45=550
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST or NPI>level*20/0.5 then
call BU5(SFI,level,C05,CI5,C15,CO5)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=SFI
set VFI=SFI
set VEI=level*25*0.5
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),C45,Condition(function C25))
call NSI(g)
endif
set t=null
set SFI=null
set C05=null
set CI5=null
set C15=null
set CO5=null
set g=null
return false
endfunction
function C55 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit C05=CreateUnit(GetOwningPlayer(SFI),'e00Q',GetUnitX(SFI)+150,GetUnitY(SFI)+150,0)
local unit CI5=CreateUnit(GetOwningPlayer(SFI),'e00Q',GetUnitX(SFI)+150,GetUnitY(SFI)-150,0)
local unit C15=CreateUnit(GetOwningPlayer(SFI),'e00Q',GetUnitX(SFI)-150,GetUnitY(SFI)+150,0)
local unit CO5=CreateUnit(GetOwningPlayer(SFI),'e00Q',GetUnitX(SFI)-150,GetUnitY(SFI)-150,0)
local integer level=GetUnitAbilityLevel(SFI,'A0H0')
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(SFI),GetUnitY(SFI),0)
call SaveInteger(LY,(GetHandleId((SFI))),((4299)),(1))
call AddSkill(dummy,'A0HO')
call SetUnitAbilityLevel(dummy,'A0HO',level)
call IssueTargetOrder(dummy,"invisibility",SFI)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function C35))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(379),(C05))
call SaveUnitHandle(LY,(handle_id),(380),(CI5))
call SaveUnitHandle(LY,(handle_id),(381),(C15))
call SaveUnitHandle(LY,(handle_id),(382),(CO5))
call SetUnitTimeScale(C05,0)
call SetUnitTimeScale(CI5,0)
call SetUnitTimeScale(C15,0)
call SetUnitTimeScale(CO5,0)
set t=null
set SFI=null
set dummy=null
set C05=null
set CI5=null
set C15=null
set CO5=null
endfunction
function C65 takes nothing returns boolean
if GetSpellAbilityId()=='A0H0' then
call C55()
endif
return false
endfunction
function LS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function C65))
set t=null
endfunction
function C75 takes nothing returns nothing
call Damage(VGI,GetEnumUnit(),2,50*VHI)
endfunction
function C85 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A29K')
call AddSkill(dummy,'A0M9')
call SetUnitAbilityLevel(dummy,'A0M9',level)
call IssueImmediateOrder(dummy,"thunderclap")
call AddSkill(dummy,'A01W')
call SetUnitAbilityLevel(dummy,'A01W',level)
call IssueImmediateOrder(dummy,"stomp")
set VGI=hero
set VHI=level
call GroupEnumUnitsInRange(g,x,y,350+25,Condition(function C51))
call ForGroup(g,function C75)
call NSI(g)
set hero=null
set dummy=null
set g=null
endfunction
function C95 takes nothing returns boolean
if GetSpellAbilityId()=='A29K' then
call C85()
endif
return false
endfunction
function LT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function C95))
set t=null
endfunction
function CA5 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A0JJ')
local real PAI=40+20*level
if GetUnitAbilityLevel(target,'A04R')==0 then
call Damage(hero,target,2,PAI)
endif
endfunction
function CB5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and GetEventDamage()>0 and GetEventDamage()<=0.02 and GetUnitAbilityLevel(target,'B0GG')>0 then
call DisableTrigger(t)
call CA5(hero,target)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function CC5 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function CB5))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function CD5 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4274))))==1)==false then
call SCI(hero,4274,0.1)
call CC5()
endif
endfunction
function CE5 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A0JJ')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call CD5()
endif
return false
endfunction
function CF5 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function CE5))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function CG5 takes nothing returns boolean
if GetLearnedSkill()=='A0JJ' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0JJ')==1 then
call CF5()
endif
return false
endfunction
function LR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function CG5))
set t=null
endfunction
function SpectralDagger_CastCode takes nothing returns integer
return 'A0HW'
endfunction
function SpectralDagger_PositiveEffect takes nothing returns integer
return 'A0I2'
endfunction
function SpectralDagger_NegativeEffect takes nothing returns integer
return 'A0HY'
endfunction
function SpectralDagger_PositiveBuff takes nothing returns integer
return 'B047'
endfunction
function SpectralDagger_ShadowPathUnit takes nothing returns integer
return 'h002'
endfunction
function SpectralDagger_DaggerUnit takes nothing returns integer
return 'h003'
endfunction
function CH5 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit PKI=(LoadUnitHandle(LY,(handle_id),(221)))
local unit CZ5=(LoadUnitHandle(LY,(handle_id),(383)))
local unit dummy
local real DC1=(LoadReal(LY,(handle_id),(57)))
local integer level=GetUnitAbilityLevel(CZ5,('A0HW'))
local real CV5=(LoadReal(LY,(handle_id),(6)))
local real CW5=(LoadReal(LY,(handle_id),(7)))
local real IV1=GetUnitX(PKI)
local real IW1=GetUnitY(PKI)
if(IV1-CV5)*(IV1-CV5)+(IW1-CW5)*(IW1-CW5)>900 then
set dummy=CreateUnit(GetOwningPlayer(CZ5),('h002'),GetUnitX(PKI),GetUnitY(PKI),0)
call SetUnitAbilityLevel(dummy,('A0I2'),level)
call SetUnitAbilityLevel(dummy,('A0HY'),level)
call UnitApplyTimedLife(dummy,'BTLF',7)
call SaveReal(LY,(handle_id),(6),((IV1)*1.0))
call SaveReal(LY,(handle_id),(7),((IW1)*1.0))
endif
set DC1=DC1+0.2
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
if DC1>7 or GetUnitState(PKI,UNIT_STATE_LIFE)<1 then
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
endif
endfunction
function CX5 takes nothing returns nothing
local unit target=GetEnumUnit()
local sound PGI
local timer t
local integer handle_id
call UnitDamageTarget(XO,target,JO,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
call GroupAddUnit(B2,target)
if IsUnitType(target,UNIT_TYPE_HERO)==true then
set t=CreateTimer()
set handle_id=GetHandleId(t)
set PGI=CreateSound("Sounds\\Spectral Dagger.mp3",false,true,true,10,10,"DefaultEAXON")
call SetSoundPosition(PGI,GetUnitX(target),GetUnitY(target),0)
call SetSoundDistanceCutoff(PGI,700)
call StartSound(PGI)
call KillSoundWhenDone(PGI)
call SaveUnitHandle(LY,(handle_id),(221),(target))
call SaveUnitHandle(LY,(handle_id),(383),(XO))
call SaveReal(LY,(handle_id),(6),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(target))*1.0))
call TimerStart(t,0.2,true,function CH5)
endif
endfunction
function CY5 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(XO))and IsUnitInGroup(GetFilterUnit(),B2)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false
endfunction
function CJ5 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local group Z51=NTI()
local boolexpr QL1=Condition(function CY5)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real QXI=GetUnitX(IG1)
local real QYI=GetUnitY(IG1)
local real RM2=Atan2(QKI-QYI,QJI-QXI)
local real IV1=PTI(GetUnitX(IG1)+30*Cos(RM2))
local real IW1=PUI(GetUnitY(IG1)+30*Sin(RM2))
local unit dummy
local integer level=GetUnitAbilityLevel(SFI,('A0HW'))
if(LoadBoolean(LY,(handle_id),(384)))then
call SaveBoolean(LY,(handle_id),(384),(false))
set dummy=CreateUnit(GetOwningPlayer(SFI),('h002'),QXI,QYI,0)
call SetUnitAbilityLevel(dummy,('A0I2'),level)
call SetUnitAbilityLevel(dummy,('A0HY'),level)
call UnitApplyTimedLife(dummy,'BTLF',12)
else
call SaveBoolean(LY,(handle_id),(384),(true))
endif
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SetUnitFacing(IG1,RM2*bj_RADTODEG)
set B2=JAO
set XO=SFI
set JO=50*GetUnitAbilityLevel(SFI,('A0HW'))
call GroupEnumUnitsInRange(Z51,IV1,IW1,150,QL1)
call ForGroup(Z51,function CX5)
call NSI(Z51)
if(IV1-QJI)*(IV1-QJI)+(IW1-QKI)*(IW1-QKI)<1600 then
call PauseTimer(t)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call KillUnit(IG1)
call NSI(JAO)
endif
endfunction
function CK5 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local group Z51=NTI()
local boolexpr QL1=Condition(function CY5)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real QXI=GetUnitX(IG1)
local real QYI=GetUnitY(IG1)
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real IV1=PTI(GetUnitX(IG1)+30*Cos(RM2))
local real IW1=PUI(GetUnitY(IG1)+30*Sin(RM2))
local unit dummy
local integer level=GetUnitAbilityLevel(SFI,('A0HW'))
if(LoadBoolean(LY,(handle_id),(384)))then
call SaveBoolean(LY,(handle_id),(384),(false))
set dummy=CreateUnit(GetOwningPlayer(SFI),('h002'),QXI,QYI,0)
call SetUnitAbilityLevel(dummy,('A0I2'),level)
call SetUnitAbilityLevel(dummy,('A0HY'),level)
call UnitApplyTimedLife(dummy,'BTLF',12)
else
call SaveBoolean(LY,(handle_id),(384),(true))
endif
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
set B2=JAO
set XO=SFI
set JO=50*GetUnitAbilityLevel(SFI,('A0HW'))
call GroupEnumUnitsInRange(Z51,IV1,IW1,150,QL1)
call ForGroup(Z51,function CX5)
call NSI(Z51)
if(IV1-QJI)*(IV1-QJI)+(IW1-QKI)*(IW1-QKI)<1600 then
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call KillUnit(IG1)
call NSI(JAO)
endif
endfunction
function CL5 takes unit PKI,integer MLI returns boolean
if(GetItemTypeId(UnitItemInSlot(PKI,MLI))=='pspd')then
return true
endif
if(GetItemTypeId(UnitItemInSlot(PKI,MLI))=='oflg')then
return true
endif
return false
endfunction
function CM5 takes nothing returns nothing
local timer t=GetExpiredTimer()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real DC1=(LoadReal(LY,(handle_id),(57)))
local integer TGI=0
loop
exitwhen TGI>5
if CL5(SFI,TGI)then
if GetUnitAbilityLevel(SFI,('B047'))==0 then
call SetItemDropOnDeath(UnitItemInSlot(SFI,TGI),true)
if GetItemTypeId(UnitItemInSlot(SFI,TGI))=='oflg' then
call SetItemDroppable(UnitItemInSlot(SFI,TGI),true)
endif
else
call SetItemDropOnDeath(UnitItemInSlot(SFI,TGI),false)
if GetItemTypeId(UnitItemInSlot(SFI,TGI))=='oflg' then
call SetItemDroppable(UnitItemInSlot(SFI,TGI),false)
endif
endif
endif
set TGI=TGI+1
endloop
set DC1=DC1+0.2
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
if GetUnitAbilityLevel(SFI,('B047'))==0 then
call SetUnitPathing(SFI,true)
else
call SetUnitPathing(SFI,false)
endif
if DC1>30 then
call PauseTimer(t)
call FlushChildHashtable(LY,(handle_id))
call SetUnitPathing(SFI,true)
set TGI=0
loop
exitwhen TGI>5
if CL5(SFI,TGI)then
call SetItemDropOnDeath(UnitItemInSlot(SFI,TGI),true)
if GetItemTypeId(UnitItemInSlot(SFI,TGI))=='oflg' then
call SetItemDroppable(UnitItemInSlot(SFI,TGI),true)
endif
endif
set TGI=TGI+1
endloop
endif
endfunction
function CN5 takes nothing returns boolean
return GetSpellAbilityId()==('A0HW')
endfunction
function CS5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real QXI=PTI(GetUnitX(SFI))
local real QYI=PUI(GetUnitY(SFI))
local unit IG1=CreateUnit(GetOwningPlayer(SFI),('h003'),QXI,QYI,0)
local timer t=CreateTimer()
local integer handle_id=GetHandleId(t)
local group JAO=NTI()
local location AM3
local real RM2
local real QJI
local real QKI
call SetUnitPathing(IG1,false)
call SaveGroupHandle(LY,(handle_id),(133),(JAO))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
if target!=null then
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call TimerStart(t,0.0375,true,function CJ5)
else
set AM3=GetSpellTargetLoc()
set QJI=GetLocationX(AM3)
set QKI=GetLocationY(AM3)
set RM2=Atan2(QKI-QYI,QJI-QXI)
call SetUnitFacing(IG1,RM2*bj_RADTODEG)
set QJI=PTI(QXI+2100*Cos(RM2))
set QKI=PUI(QYI+2100*Sin(RM2))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call TimerStart(t,0.035,true,function CK5)
endif
set t=CreateTimer()
set handle_id=GetHandleId(t)
call SetUnitPathing(SFI,false)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TimerStart(t,0.2,true,function CM5)
endfunction
function MT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CN5))
call TriggerAddAction(t,function CS5)
call CreateSound("Sounds\\Spectral Dagger.mp3",false,false,false,10,10,"DefaultEAXON")
call Q1I(('A0I2'))
call Q1I(('A0HY'))
endfunction
constant function Desolate_AbilityId takes nothing returns integer
return 'A0FX'
endfunction
function CT5 takes nothing returns boolean
return IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and GetUnitAbilityLevel(GetAttacker(),('A0FX'))>0
endfunction
function CR5 takes nothing returns boolean
return IsUnitAlly(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false
endfunction
function CP5 takes nothing returns nothing
local unit Z4O=GetAttacker()
local unit OU3=GetTriggerUnit()
local group Z51=NTI()
local boolexpr QL1=Condition(function CR5)
local integer handle_id
call GroupEnumUnitsInRange(Z51,GetUnitX(OU3),GetUnitY(OU3),325+25,QL1)
call GroupRemoveUnit(Z51,OU3)
if FirstOfGroup(Z51)==null then
set handle_id=GetHandleId(Z4O)
if((LoadInteger(LY,(GetHandleId((Z4O))),((4275))))==1)==false then
call UnitDamageTarget(Z4O,OU3,5+15*GetUnitAbilityLevel(Z4O,('A0FX')),true,true,ATTACK_TYPE_HERO,DAMAGE_TYPE_DIVINE,WEAPON_TYPE_WHOKNOWS)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathandDecay\\DeathandDecayTarget.mdl",OU3,"overhead"))
call SCI(Z4O,4275,0.3)
endif
endif
call NSI(Z51)
endfunction
function MR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function CT5))
call TriggerAddAction(t,function CP5)
endfunction
function CQ5 takes nothing returns nothing
local real d=QLI(GetTriggerUnit(),GetEnumUnit())-25
local real VM2=0
if d<300 then
set VM2=1
elseif d<1000 then
set VM2=(1000-d)/700
endif
if VM2>0 then
set NJ0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=true
call Damage(GetTriggerUnit(),GetEnumUnit(),3,VZI*VM2)
set NJ0[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=false
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathandDecay\\DeathandDecayDamage.mdl",GetEnumUnit(),"chest"))
endif
endfunction
function CU5 takes nothing returns boolean
local unit SFI=GetTriggerUnit()
local real PAI=GetEventDamage()
local integer level=GetUnitAbilityLevel(SFI,'A0NA')
local group g
if RSI(PAI)and GetUnitAbilityLevel(SFI,'BNdo')==0 then
set g=NTI()
set VZI=PAI*(0.06+0.04*level)
call QGI(SFI,VZI)
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),1025,Condition(function C51))
call ForGroup(g,function CQ5)
call NSI(g)
endif
set SFI=null
set g=null
return false
endfunction
function D05 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit SFI=GetTriggerUnit()
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function CU5))
set t=null
set SFI=null
endfunction
function DI5 takes nothing returns boolean
if GetLearnedSkill()=='A0NA' and GetUnitAbilityLevel(GetTriggerUnit(),'A0NA')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call D05()
endif
return false
endfunction
function MP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function DI5))
set t=null
endfunction
constant function Haunt_AbilityCode takes nothing returns integer
return 'A0H9'
endfunction
constant function Haunt_ImageCode takes nothing returns integer
return 'A0N9'
endfunction
constant function Haunt_ImageBuffCode takes nothing returns integer
return 'B06L'
endfunction
constant function Haunt_RealityCode takes nothing returns integer
return 'A0HA'
endfunction
function D15 takes nothing returns boolean
return GetSpellAbilityId()==('A0H9')
endfunction
function DO5 takes nothing returns nothing
local unit target=GetEnumUnit()
local unit SFI=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',GetUnitX(target),GetUnitY(target),0)
call SaveUnitHandle(LY,(GetHandleId(dummy)),(387),(target))
call AddSkill(dummy,('A0N9'))
call SetUnitAbilityLevel(dummy,('A0N9'),GetUnitAbilityLevel(SFI,('A0H9')))
call IssueTargetOrderById(dummy,852274,SFI)
endfunction
function D25 takes nothing returns boolean
return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
endfunction
function D35 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit IYO=(LoadUnitHandle(LY,(handle_id),(386)))
local unit target=(LoadUnitHandle(LY,(handle_id),(387)))
local integer D45=(LoadInteger(LY,(handle_id),(385)))
if GetTriggerEventId()!=EVENT_UNIT_DEATH and GetTriggerEventId()!=EVENT_UNIT_ISSUED_TARGET_ORDER and GetTriggerEventId()!=EVENT_UNIT_ISSUED_POINT_ORDER then
set D45=D45+1
call SaveInteger(LY,(handle_id),(385),(D45))
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call DisableTrigger(GetTriggeringTrigger())
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call SaveInteger(LY,(handle_id),(385),(D45))
if target==GetTriggerUnit()then
call KillUnit(IYO)
endif
elseif IsUnitPaused(IYO)==false then
if D45==2 then
call SetUnitVertexColor(IYO,255,255,255,255)
endif
if D45>1 then
call DisableTrigger(GetTriggeringTrigger())
call IssueTargetOrder(IYO,"attack",target)
call EnableTrigger(GetTriggeringTrigger())
else
call DisableTrigger(GetTriggeringTrigger())
call IssueTargetOrderById(IYO,851986,target)
call EnableTrigger(GetTriggeringTrigger())
endif
endif
endfunction
function D55 takes nothing returns boolean
return GetUnitAbilityLevel(GetSummonedUnit(),('B06L'))>0
endfunction
function D65 takes nothing returns nothing
local unit dummy=GetSummoningUnit()
local unit IYO=GetSummonedUnit()
local unit target=(LoadUnitHandle(LY,(GetHandleId(dummy)),(387)))
local trigger t=CreateTrigger()
call SaveUnitHandle(LY,(GetHandleId(K1[GetPlayerId(GetOwningPlayer(dummy))])),(7100+GetHandleId(IYO)),(target))
call SetUnitPathing(IYO,false)
call SetUnitMoveSpeed(IYO,400)
call MUSetUnitX(IYO,GetUnitX(target))
call MUSetUnitY(IYO,GetUnitY(target))
call IssueTargetOrderById(IYO,851986,target)
call SetUnitVertexColor(IYO,255,255,255,50)
call TriggerRegisterUnitEvent(t,IYO,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,IYO,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,IYO,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddAction(t,function D35)
call DestroyEffect(AddSpecialEffect("units\\nightelf\\SpiritOfVengeance\\SpiritOfVengeance.mdl",GetUnitX(IYO),GetUnitY(IYO)))
call SaveUnitHandle(LY,(GetHandleId(t)),(387),(target))
call SaveUnitHandle(LY,(GetHandleId(t)),(386),(IYO))
call SaveInteger(LY,(GetHandleId(t)),(385),(0))
call FlushChildHashtable(LY,(GetHandleId(dummy)))
endfunction
function D75 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local group Z51=NTI()
local boolexpr QL1=Condition(function D25)
local sound PGI
call AddSkill(GetTriggerUnit(),('A0HA'))
call SetUnitPathing(SFI,false)
call GroupEnumUnitsInRect(Z51,bj_mapInitialPlayableArea,QL1)
call ForGroup(Z51,function DO5)
call SetUnitPathing(SFI,true)
if FirstOfGroup(Z51)!=null then
set PGI=CreateSound("Abilities\\Spells\\Other\\ANsa\\SacrificeUnit.wav",false,false,false,10,10,"DefaultEAXON")
call StartSound(PGI)
call KillSoundWhenDone(PGI)
endif
call NSI(Z51)
endfunction
function D85 takes nothing returns boolean
return GetLearnedSkill()==('A0H9')and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),('A0H9'))==1
endfunction
function D95 takes nothing returns nothing
call AddSkill(GetTriggerUnit(),('A0HA'))
endfunction
function MQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function D15))
call TriggerAddAction(t,function D75)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function D55))
call TriggerAddAction(t,function D65)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function D85))
call TriggerAddAction(t,function D95)
call CreateSound("Abilities\\Spells\\Other\\ANsa\\SacrificeUnit.wav",false,false,false,10,10,"DefaultEAXON")
call Q1I(('A0N9'))
endfunction
function DA5 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'B06L')>0
endfunction
function DB5 takes nothing returns nothing
local real QWI=QMI(GetEnumUnit(),GetSpellTargetLoc())
if QWI<JO then
set XO=GetEnumUnit()
set JO=QWI
endif
endfunction
function DC5 takes nothing returns unit
local group Z51=NTI()
set XO=null
set JO=9999999
call GroupEnumUnitsOfPlayer(Z51,GetOwningPlayer(GetTriggerUnit()),Condition(function DA5))
call ForGroup(Z51,function DB5)
set VVI=Z51
set Z51=null
return XO
endfunction
function Reality_KillOtherImages takes nothing returns nothing
call KillUnit(GetEnumUnit())
endfunction
function DD5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=DC5()
local unit JXO=(LoadUnitHandle(LY,(GetHandleId(SFI)),(7100+GetHandleId(target))))
local real QJI
local real QKI
if target==null then
call PZI(GetOwningPlayer(SFI),"找不到任何鬼影重重产生的分身")
else
set QJI=GetUnitX(target)
set QKI=GetUnitY(target)
call KillUnit(target)
call NSI(VVI)
set VVI=null
call MUSetUnitX(SFI,QJI)
call MUSetUnitY(SFI,QKI)
if QNI(GetCameraEyePositionX(),GetCameraEyePositionY(),GetUnitX(target),GetUnitY(target))>1400 then
call PanCameraToTimedForPlayer(GetOwningPlayer(SFI),QJI,QKI,0)
endif
call IssueTargetOrder(SFI,"attack",JXO)
endif
set SFI=null
set target=null
endfunction
function DE5 takes nothing returns boolean
if GetSpellAbilityId()=='A0HA' then
call DD5()
endif
return false
endfunction
function MU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function DE5))
set t=null
endfunction
function DF5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A30F')
call UnitRemoveAbility(hero,'A30W')
call UnitRemoveAbility(hero,'A30P')
call AddSkill(hero,'A30W')
call SetUnitAbilityLevel(hero,'A30W',level)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function DG5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A30F')
call UnitRemoveAbility(hero,'A30W')
call UnitRemoveAbility(hero,'A30H')
call AddSkill(hero,'A30P')
call SetUnitAbilityLevel(hero,'A30P',level)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function DF5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
return false
endfunction
function DH5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A30F')
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function DG5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call UnitRemoveAbility(hero,'A30W')
call UnitRemoveAbility(hero,'A30P')
call AddSkill(hero,'A30H')
call SetUnitAbilityLevel(hero,'A30H',level)
set t=null
set hero=null
endfunction
function DZ5 takes nothing returns boolean
if GetSpellAbilityId()=='A30F' then
call DH5()
endif
return false
endfunction
function DV5 takes nothing returns nothing
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A30F')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A30H',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A30W',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A30P',false)
call AddSkill(GetTriggerUnit(),'A30W')
call SetUnitAbilityLevel(GetTriggerUnit(),'A30W',level)
endfunction
function DW5 takes nothing returns boolean
if GetLearnedSkill()=='A30F' and IsUnitIllusion(GetTriggerUnit())==false then
call DV5()
endif
return false
endfunction
function LQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function DW5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DZ5))
set t=null
endfunction
function DX5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real LVO=(LoadReal(LY,(GetHandleId(hero)),(685)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if LVO<(TimerGetElapsed(M))or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call SaveReal(LY,(GetHandleId(hero)),(685),((0)*1.0))
call UnitRemoveAbility(hero,'A24H')
call UnitRemoveAbility(hero,'B0EC')
endif
set t=null
set hero=null
return false
endfunction
function DY5 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(hero,'A24H')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A24H',false)
call SaveReal(LY,(GetHandleId(hero)),(685),(((TimerGetElapsed(M))+VWI-0.01)*1.0))
call TriggerRegisterTimerEvent(t,VWI,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function DX5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
endfunction
function DJ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local integer NPI=GetTriggerEvalCount(t)
local real RS2=(LoadReal(LY,(handle_id),(193)))
local integer MKO=(LoadInteger(LY,(handle_id),(12)))
if NPI>35 then
call SaveReal(LY,(handle_id),(193),((RS2*0.98)*1.0))
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH or NPI>MKO then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",x,y))
call UPI(x,y,150)
set x=PTI(x+RS2*Cos(RM2))
set y=PUI(y+RS2*Sin(RM2))
if(IsPointInRegion(LN,((x)*1.0),((y)*1.0)))==false then
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
endif
if NPI==1 and(LoadBoolean(LY,(handle_id),(698)))==false then
call IssueTargetOrder(hero,"attack",target)
endif
endif
set t=null
set target=null
return false
endfunction
function DK5 takes unit hero,unit target,boolean DL5,boolean DM5 returns nothing
local trigger t
local integer handle_id
local real RM2=Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero))
local integer level=GetUnitAbilityLevel(hero,'A0G5')
local unit dummy
if DL5 then
endif
if level>0 and GetUnitAbilityLevel(hero,'BNdo')==0 then
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A1WQ')
call SetUnitAbilityLevel(dummy,'A1WQ',level)
if IssueTargetOrder(dummy,"thunderbolt",target)then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\PhoenixMissile\\Phoenix_Missile_mini.mdl",hero,"weapon"))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(193),((2)*1.0))
call SaveBoolean(LY,(handle_id),(698),(DM5))
call SaveInteger(LY,(handle_id),(12),(80+20*level))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerAddCondition(t,Condition(function DJ5))
call Damage(hero,target,1,GetUnitMoveSpeed(hero)*(0.16+0.06*level))
call DY5(hero)
endif
if DM5==false then
call SCI(hero,4276,1.5)
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
endfunction
function DN5 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A0G5')>0 and IsUnitIllusion(GetAttacker())==false and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))and GetRandomInt(1,100)<=17 and((LoadInteger(LY,(GetHandleId((GetAttacker()))),((4276))))==1)==false then
call DK5(GetAttacker(),GetTriggerUnit(),false,false)
endif
return false
endfunction
function LU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function DN5))
set t=null
endfunction
function DS5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'A312')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1P8',true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function DT5 takes unit hero returns nothing
local trigger t
local integer handle_id
if IsUnitDead(hero)==true then
call UnitRemoveAbility(hero,'A312')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1P8',true)
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterTimerEvent(t,12,false)
call TriggerAddCondition(t,Condition(function DS5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
set t=null
endfunction
function DR5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),VLI)==false then
call GroupAddUnit(VLI,GetEnumUnit())
call DK5(VYI,GetEnumUnit(),false,true)
endif
endfunction
function DP5 takes integer id returns boolean
if id=='A1P8' or id=='A30F' or id=='A0G4' or id=='A1D8' or id=='A0G5' or id=='Aamk' then
return true
endif
if id==852002 or id==852003 or id==852004 or id==852005 or id==852006 or id==852007 then
return true
endif
if id>1000000 then
return true
endif
return false
endfunction
function DQ5 takes nothing returns boolean
if(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(VYI))==true then
if QLI(VJI,GetFilterUnit())<VKI then
set VKI=QLI(VJI,GetFilterUnit())
set VXI=GetFilterUnit()
endif
endif
return false
endfunction
function DU5 takes unit hero,unit target returns unit
local group g=NTI()
set GK=hero
set VYI=hero
set VXI=null
set VKI=999999
set VJI=target
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),4000,Condition(function DQ5))
call NSI(g)
set g=null
return VXI
endfunction
function E05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real JC3=(550+50*level)*0.02
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real x
local real y
local real a
local real d
local string fx
local group g
if(GetTriggerEventId()==EVENT_WIDGET_DEATH and GetTriggerUnit()==hero)or GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER or BH1(hero)or(LoadReal(LY,(handle_id),(442)))<(TimerGetElapsed(M))then
if(GetTriggerEventId()!=EVENT_UNIT_ISSUED_ORDER and GetTriggerEventId()!=EVENT_UNIT_ISSUED_POINT_ORDER and GetTriggerEventId()!=EVENT_UNIT_ISSUED_TARGET_ORDER)or((GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER)and DP5(GetIssuedOrderId())==false)then
call DT5(hero)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call UnitRemoveAbility(target,'A24L')
call UnitRemoveAbility(target,'B0ED')
call NSI((LoadGroupHandle(LY,(handle_id),(187))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitTimeScale(hero,1)
call KillUnit(dummy)
call SetUnitPathing(hero,true)
call SetUnitVertexColor(hero,255,255,255,255)
call UnitRemoveAbility(hero,'A179')
call UPI(GetUnitX(hero),GetUnitY(hero),200)
if GetTriggerEventId()!=EVENT_WIDGET_DEATH then
call ResetUnitAnimation(hero)
endif
endif
elseif GetTriggerEventId()==EVENT_WIDGET_DEATH and GetTriggerUnit()==target then
set fx=""
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))or P0I(GetLocalPlayer())then
set fx="Abilities\\Spells\\Other\\HowlOfTerror\\HowlTarget.mdl"
endif
call UnitRemoveAbility(target,'A24L')
call UnitRemoveAbility(target,'B0ED')
set target=DU5(hero,target)
if target!=null then
call SaveUnitHandle(LY,(handle_id),(17),(target))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget(fx,target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget(fx,target,"overhead")))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+50)*1.0))
call TriggerRegisterDeathEvent(t,target)
else
call DT5(hero)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call UnitRemoveAbility(target,'A24L')
call UnitRemoveAbility(target,'B0ED')
call NSI((LoadGroupHandle(LY,(handle_id),(187))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitTimeScale(hero,1)
call KillUnit(dummy)
call SetUnitPathing(hero,true)
call ResetUnitAnimation(hero)
call SetUnitVertexColor(hero,255,255,255,255)
call UnitRemoveAbility(hero,'A179')
call SetUnitPosition(hero,GetUnitX(hero),GetUnitY(hero))
call UPI(GetUnitX(hero),GetUnitY(hero),500)
endif
else
set d=QNI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
if d<100 then
call DT5(hero)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call UnitRemoveAbility(target,'A24L')
call UnitRemoveAbility(target,'B0ED')
call NSI((LoadGroupHandle(LY,(handle_id),(187))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitTimeScale(hero,1)
call KillUnit(dummy)
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A0GS')
call SetUnitAbilityLevel(dummy,'A0GS',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
call SetUnitPathing(hero,true)
call SetUnitVertexColor(hero,255,255,255,255)
call UnitRemoveAbility(hero,'A179')
call SetUnitPosition(hero,GetUnitX(hero),GetUnitY(hero))
call UPI(GetUnitX(hero),GetUnitY(hero),200)
set VMI=level
call IssueTargetOrder(hero,"attack",target)
else
if GetTriggerEvalCount(t)==1 then
call DisableTrigger(t)
call IssueImmediateOrder(hero,"holdposition")
call EnableTrigger(t)
endif
if ModuloInteger(GetTriggerEvalCount(t),65)==0 then
if GetUnitTypeId(hero)=='E02X' then
call SetUnitAnimationByIndex(hero,1)
else
call SetUnitAnimationByIndex(hero,2)
endif
endif
set a=UDI(hero,target)*bj_DEGTORAD
call SetUnitFacing(hero,a*bj_RADTODEG)
set x=II3+JC3*Cos(a)
set y=I13+JC3*Sin(a)
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
set VLI=(LoadGroupHandle(LY,(handle_id),(187)))
set g=NTI()
set GK=hero
set VYI=hero
call GroupEnumUnitsInRange(g,x,y,325,Condition(function CA1))
set VMI=level
call ForGroup(g,function DR5)
call NSI(g)
set g=null
if d<3000 and GetUnitAbilityLevel(target,'A24L')==0 then
endif
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function EI5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o00Q',GetUnitX(target),GetUnitY(target),0)
local integer level=GetUnitAbilityLevel(hero,'A1P8')
local string fx=""
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1P8',false)
call AddSkill(hero,'A312')
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))or P0I(GetLocalPlayer())then
set fx="Abilities\\Spells\\Other\\HowlOfTerror\\HowlTarget.mdl"
call PingMinimapEx(GetUnitX(target),GetUnitY(target),2,255,255,255,false)
endif
call IssueTargetOrder(hero,"move",target)
call SetUnitPathing(hero,false)
if GetUnitTypeId(hero)=='E02X' then
call SetUnitAnimationByIndex(hero,1)
else
call SetUnitAnimationByIndex(hero,2)
endif
call SetUnitTimeScale(hero,2.5)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A179',false)
call SetUnitVertexColor(hero,255,255,255,100)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+50)*1.0))
call SaveReal(LY,(handle_id),(23),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(hero))*1.0))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget(fx,target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget(fx,target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffectTarget("war3mapImported\\ShockwaveMissilePurple.mdx",hero,"origin")))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerAddCondition(t,Condition(function E05))
set t=null
set hero=null
set target=null
set dummy=null
endfunction
// 裂魂人 暗影冲刺
function E15 takes nothing returns boolean
if GetSpellAbilityId()=='A1P8' then
	if CanResistSkill(GetSpellTargetUnit()) then
		call UnitRemoveAbility(GetSpellTargetUnit(), 'B0BI')
		// 如果目标身上有林肯,则进入CD
		call IssueImmediateOrder(GetTriggerUnit(), "stop")
		call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1P8',false)
		call AddSkill(GetTriggerUnit(),'A312')
		call DT5(GetTriggerUnit())
	else
		call EI5()
	endif
endif
return false
endfunction
function LP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function E15))
set t=null
call Q1I('A0X6')
endfunction
function EO5 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local real RM2=Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero))
local integer level=4
call DK5(hero,target,true,true)
set t=null
endfunction
function E25 takes nothing returns nothing
call EO5(VNI,GetEnumUnit())
endfunction
function E35 takes unit hero,unit Targer returns nothing
local group g=NTI()
set GK=hero
set VNI=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),275,Condition(function CA1))
call ForGroup(g,function E25)
call NSI(g)
set g=null
endfunction
function E45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=GetTriggerEvalCount(t)
local integer E55
local integer level
local real RM2
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real d=QNI(x,y,II3,I13)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
if GetTriggerEventId()==EVENT_UNIT_DEATH or NPI==200 or d>1800 then
call SetUnitVertexColor(hero,255,255,255,255)
call UnitShareVision(target,GetOwningPlayer(hero),false)
call UnitRemoveAbility(hero,'A179')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if NPI<100 then
set E55=NPI
else
set E55=200-NPI
endif
call SetUnitVertexColor(hero,255,255,255,255*(100-E55)/100)
if NPI==100 then
set level=(LoadInteger(LY,(handle_id),(5)))
set RM2=Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero))
call SetUnitPosition(hero,GetUnitX(target)+80*Cos(RM2),GetUnitY(target)+80*Sin(RM2))
call SetUnitAnimation(hero,"attack")
call IssueTargetOrder(hero,"attack",target)
if GetUnitAbilityLevel(hero,'A0G4')>0 then
call EO5(hero,target)
else
call E35(hero,target)
endif
call Damage(hero,target,1,50+100*level)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function E65 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A0G4')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1D8')
endif
call UnitShareVision(target,GetOwningPlayer(hero),true)
call IssueImmediateOrder(hero,"halt")
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call TriggerRegisterTimerEvent(t,0.001,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function E45))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A179',false)
set t=null
set hero=null
set target=null
endfunction
function E75 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SetUnitAnimation(hero,"spell morph")
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function E85 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call UnitShareVision(target,GetOwningPlayer(hero),false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function E95 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0.,true)
call TriggerAddCondition(t,Condition(function E75))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(GetSpellTargetUnit()))
call TriggerRegisterTimerEvent(t,1.,true)
call TriggerAddCondition(t,Condition(function E85))
call UnitShareVision(GetSpellTargetUnit(),GetOwningPlayer(hero),true)
set t=null
set hero=null
endfunction
function EA5 takes nothing returns boolean
if GetSpellAbilityId()=='A0G4' or GetSpellAbilityId()=='A1D8' then
if CanResistSkill(GetSpellTargetUnit())==false then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call E65()
else
call E95()
endif
endif
endif
return false
endfunction
function M01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CHANNEL)
call TriggerAddCondition(t,Condition(function EA5))
set t=null
endfunction
function EB5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A275')
if level==1 then
call AddSkill(hero,'A276')
elseif level==2 then
call UnitRemoveAbility(hero,'A276')
call AddSkill(hero,'A279')
elseif level==3 then
call UnitRemoveAbility(hero,'A276')
call UnitRemoveAbility(hero,'A279')
call AddSkill(hero,'A277')
elseif level==4 then
call UnitRemoveAbility(hero,'A276')
call UnitRemoveAbility(hero,'A279')
call UnitRemoveAbility(hero,'A277')
call AddSkill(hero,'A278')
endif
set hero=null
endfunction
function EC5 takes nothing returns boolean
if GetLearnedSkill()=='A275' and IsUnitIllusion(GetTriggerUnit())==false then
call EB5()
endif
return false
endfunction
function MO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function EC5))
set t=null
endfunction
function Sunder_SwitchConditions takes nothing returns boolean
return GetSpellAbilityId()=='A07R'
endfunction
function ED5 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real EE5=(LoadReal(LY,(handle_id),(295)))
local real EF5=(LoadReal(LY,(handle_id),(296)))
local integer level=GetUnitAbilityLevel(hero,'A07Q')
local real EG5=0.2
if GetSpellTargetUnit()==hero then
call SetUnitState(hero,UNIT_STATE_LIFE,RMaxBJ(GetUnitState(hero,UNIT_STATE_MAX_LIFE)*EF5*0.01,GetUnitState(hero,UNIT_STATE_MAX_LIFE)*EG5))
endif
if GetSpellTargetUnit()==target then
call SetUnitLifePercentBJ(target,EE5)
if GetUnitLifePercent(target)<25.00 and level==1 and GetUnitState(target,UNIT_STATE_LIFE)>1 then
call SetUnitLifePercentBJ(target,20.00)
endif
if GetUnitLifePercent(target)<20.00 and level==2 and GetUnitState(target,UNIT_STATE_LIFE)>1 then
call SetUnitLifePercentBJ(target,20.00)
endif
if GetUnitLifePercent(target)<15.00 and level==3 and GetUnitState(target,UNIT_STATE_LIFE)>1 then
call SetUnitLifePercentBJ(target,20.00)
endif
endif
if GetTriggerEvalCount(t)==2 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set hero=null
set target=null
set t=null
endfunction
function EH5 takes nothing returns boolean
if GetSpellAbilityId()=='A07R' then
call ED5()
endif
return false
endfunction
function EZ5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(295),((GetUnitLifePercent(hero))*1.0))
call SaveReal(LY,(handle_id),(296),((GetUnitLifePercent(target))*1.0))
call TriggerAddCondition(t,Condition(function EH5))
set dummy=CreateUnit(GetOwningPlayer(target),'e00Y',GetUnitX(target),GetUnitY(target),0)
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_SPELL_EFFECT)
call AddSkill(dummy,'A07R')
call IssueTargetOrder(dummy,"thunderbolt",hero)
call ShowUnit(dummy,false)
call SetUnitPathing(dummy,false)
call SetUnitInvulnerable(dummy,true)
call UnitApplyTimedLife(dummy,'BTLF',0.2)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00Y',GetUnitX(hero),GetUnitY(hero),0)
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_SPELL_EFFECT)
call AddSkill(dummy,'A07R')
call IssueTargetOrder(dummy,"thunderbolt",target)
call ShowUnit(dummy,false)
call SetUnitPathing(dummy,false)
call SetUnitInvulnerable(dummy,true)
call UnitApplyTimedLife(dummy,'BTLF',0.2)
set t=null
set hero=null
set target=null
set dummy=null
endfunction
function EV5 takes nothing returns boolean
if GetSpellAbilityId()=='A07Q' then
call EZ5()
endif
return false
endfunction
function MI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EV5))
endfunction
function EW5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IYO=(LoadUnitHandle(LY,(handle_id),(335)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call UnitRemoveAbility(target,'A26W')
call UnitRemoveAbility(target,'B0EJ')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()!=IYO then
call KillUnit(IYO)
endif
else
call IssueTargetOrder(IYO,"attack",target)
if RKI(target)then
call UnitRemoveAbility(target,'A26W')
call UnitRemoveAbility(target,'B0EJ')
endif
endif
set t=null
set IYO=null
set target=null
return false
endfunction
function EX5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit IYO
if GetSummoningUnit()==dummy then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set IYO=GetSummonedUnit()
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterDeathEvent(t,IYO)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function EW5))
call SaveUnitHandle(LY,(handle_id),(335),(IYO))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call UnitAddAbility(IYO,'Aloc')
call SetUnitPosition(IYO,GetUnitX(target)+100,GetUnitY(target)+100)
call IssueTargetOrder(IYO,"attack",target)
call SetUnitMoveSpeed(IYO,522)
call SetUnitVertexColorBJ(IYO,100,100,100,60)
endif
set t=null
set target=null
set hero=null
set dummy=null
return false
endfunction
function EY5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2KZ')
local integer id
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
local trigger t
local integer handle_id
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A26W',false)
if BJ1(target)==false then
call AX1(target,'A26W',1,1.5+level,'B0EJ')
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function EX5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call AddSkill(dummy,'A24K')
call SetUnitAbilityLevel(dummy,'A24K',level)
call IssueTargetOrderById(dummy,852274,target)
set hero=null
set target=null
set dummy=null
set t=null
call IO1(MF,GetUnitX(target),GetUnitY(target))
set hero=null
endfunction
function EJ5 takes nothing returns boolean
if GetSpellAbilityId()=='A2KZ' then
call EY5()
endif
return false
endfunction
function M11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EJ5))
set t=null
endfunction
function EK5 takes nothing returns nothing
local unit hero=GetSummoningUnit()
local unit IYO=GetSummonedUnit()
call SelectUnitAddForPlayer(IYO,GetOwningPlayer(hero))
call UnitAddAbility(IYO,'A2KY')
call UnitRemoveAbility(IYO,'A2KY')
call SetUnitState(IYO,UNIT_STATE_LIFE,GetUnitState(IYO,UNIT_STATE_MAX_LIFE))
call SetUnitPosition(IYO,GetUnitX(IYO),GetUnitY(IYO))
set hero=null
set IYO=null
endfunction
function EL5 takes nothing returns boolean
if GetUnitAbilityLevel(GetSummonedUnit(),'B0EI')>0 then
call EK5()
endif
return false
endfunction
function EM5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit dummy
local integer level=GetUnitAbilityLevel(hero,'A2KX')
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A08Q')
call SetUnitAbilityLevel(dummy,'A08Q',level)
call IssueTargetOrderById(dummy,852274,hero)
set hero=null
set dummy=null
endfunction
function EN5 takes nothing returns boolean
if GetSpellAbilityId()=='A2KX' and GetUnitTypeId(GetTriggerUnit())=='Eevi' then
call EM5()
endif
return false
endfunction
function M41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EN5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function EL5))
set t=null
endfunction
function ES5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>(4*(4+level))or RKI(target)or QLI(hero,target)>700 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetTriggerEvalCount(t)>1 and GetSpellAbilityId()=='A1RA' then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A1RA')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1PH',true)
call KillUnit(dummy)
endif
elseif IsUnitVisible(target,GetOwningPlayer(hero))==false then
if(LoadInteger(LY,(handle_id),(34)))==1 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
else
call SaveInteger(LY,(handle_id),(34),(1))
endif
else
call SaveInteger(LY,(handle_id),(34),(0))
if IsUnitAlly(hero,GetOwningPlayer(target))==false then
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+level*25.0/4.0)
else
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+level*50.0/4.0)
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function ET5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(hero,'A1RA')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1PH',true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetTriggerEvalCount(t)==1 then
call IssueImmediateOrderById(hero,851993)
endif
if IsUnitAlly(hero,GetOwningPlayer(target))==false then
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
else
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function ER5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A1PH')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy
if IsUnitAlly(hero,GetOwningPlayer(target))==false then
set dummy=CreateUnit(GetOwningPlayer(hero),'u01G',0,0,0)
call AddSkill(dummy,'A04L')
call SetUnitAbilityLevel(dummy,'A04L',level)
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
call IssueTargetOrderById(dummy,852487,target)
else
call AddSkill(hero,'A1RA')
call UnitMakeAbilityPermanent(hero,true,'A1RA')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1PH',false)
set dummy=CreateUnit(DO,'u01G',0,0,0)
call AddSkill(dummy,'A04L')
call SetUnitAbilityLevel(dummy,'A04L',level)
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
call IssueTargetOrderById(dummy,852487,hero)
endif
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ES5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ET5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
set hero=null
set target=null
set t=null
endfunction
function EP5 takes nothing returns boolean
if GetSpellAbilityId()=='A1PH' and GetUnitTypeId(GetSpellTargetUnit())!='n00L' and(IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))or CanResistSkill(GetSpellTargetUnit())==false)then
call ER5()
endif
return false
endfunction
function M31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EP5))
endfunction
function EQ5 takes nothing returns boolean
return GetSpellAbilityId()=='A0H4'
endfunction
function EU5 takes nothing returns nothing
local unit PKI=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(PKI,'A0H4')
local unit dummy=CreateUnit(GetOwningPlayer(PKI),'e00E',GetUnitX(PKI),GetUnitY(PKI),0)
call UnitAddAbility(dummy,'A2JN')
call SetUnitAbilityLevel(dummy,'A2JN',level)
call IssueTargetOrderById(dummy,852274,PKI)
endfunction
function M21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EQ5))
call TriggerAddAction(t,function EU5)
endfunction
function F05 takes nothing returns boolean
return GetSpellAbilityId()=='A046' and CanResistSkill(GetSpellTargetUnit())==false
endfunction
function FI5 takes nothing returns nothing
local unit t=GetSpellTargetUnit()
local real F15=(60.00+(50.00*I2R(GetUnitAbilityLevelSwapped('A046',GetTriggerUnit()))))
call UnitDamageTargetBJ(GetTriggerUnit(),t,F15,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_COLD)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",t,"chest"))
endfunction
function M61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function F05))
call TriggerAddAction(t,function FI5)
endfunction
function FO5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=GetEventDamageSource()
local integer level=GetUnitAbilityLevel(hero,'A04E')
local real d=GetEventDamage()
local real QHI=(LoadReal(LY,(handle_id),(412)))
local real Z7O=(LoadReal(LY,(handle_id),(411)))
local real F25=650-50*level
if T2I(GetOwningPlayer(target))then
if(Z7O+VSI)<(TimerGetElapsed(M))then
set QHI=0
endif
set Z7O=(TimerGetElapsed(M))
set QHI=QHI+d
if QHI>F25 and GetUnitAbilityLevel(hero,'BNdo')==0 then
set QHI=0
call EO1(hero)
call DU1(hero,0,0)
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",hero,"origin"))
endif
call SaveReal(LY,(handle_id),(412),((QHI)*1.0))
call SaveReal(LY,(handle_id),(411),((Z7O)*1.0))
endif
set t=null
set hero=null
return false
endfunction
function F35 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function FO5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(412),((0)*1.0))
call SaveReal(LY,(handle_id),(411),(((TimerGetElapsed(M)))*1.0))
set t=null
set hero=null
endfunction
function F45 takes nothing returns boolean
if GetLearnedSkill()=='A04E' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A04E')==1 then
call F35()
endif
return false
endfunction
function M51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function F45))
set t=null
endfunction
function F55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set g=null
return false
endfunction
function F65 takes group g returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveGroupHandle(LY,(handle_id),(22),(g))
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function F55))
set t=null
endfunction
function F75 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit dummy
local integer i=1
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real x2
local real y2
local real PAI
local real DC1
local integer level=GetUnitAbilityLevel(SFI,'A29I')
local group g=NTI()
local real d=500
if level==1 then
set DC1=1.5
set PAI=200
elseif level==2 then
set DC1=1.8
set PAI=290
elseif level==3 then
set DC1=2.25
set PAI=380
endif
loop
exitwhen i>16
set x2=x1+(800)*Cos(22.5*i*bj_DEGTORAD)
set y2=y1+(800)*Sin(22.5*i*bj_DEGTORAD)
call DS1(SFI,null,PAI,DC1,0.52,x1,y1,x2,y2,250,g,false,775)
set i=i+1
endloop
call F65(g)
set SFI=null
set dummy=null
set g=null
endfunction
function F85 takes nothing returns boolean
if GetSpellAbilityId()=='A29I' then
call F75()
endif
return false
endfunction
function M71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function F85))
call Q1I('A0X6')
set t=null
endfunction
function F95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(715)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()==EVENT_WIDGET_DEATH or LVO<(TimerGetElapsed(M))then
call UnitRemoveAbility(target,'A228')
call UnitRemoveAbility(target,'A2Y7')
call UnitRemoveAbility(target,'A2Y6')
call UnitRemoveAbility(target,'A2Y5')
call UnitRemoveAbility(target,'B0HA')
call UnitRemoveAbility(target,'B0E8')
call UnitRemoveAbility(target,'B0HB')
call UnitRemoveAbility(target,'B0H9')
endif
set t=null
set target=null
return false
endfunction
function FA5 takes unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(VTI,'A226')
if level==1 then
call AddSkill(target,'A228')
elseif level==2 then
call AddSkill(target,'A2Y7')
elseif level==3 then
call AddSkill(target,'A2Y6')
elseif level==4 then
call AddSkill(target,'A2Y5')
endif
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function F95))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(GetHandleId(target)),(715),((5.9+(TimerGetElapsed(M)))*1.0))
set t=null
endfunction
function FB5 takes nothing returns nothing
if GetUnitTypeId(GetEnumUnit())=='n00L' then
return
endif
if BJ1(GetEnumUnit())==false then
call FA5(GetEnumUnit())
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A228',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A2Y7',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A2Y6',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A2Y5',false)
call Damage(VTI,GetEnumUnit(),2,25+50*VRI)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\CrushingWave\\CrushingWaveDamage.mdl",GetEnumUnit(),"chest"))
endfunction
function FC5 takes nothing returns nothing
local group g=NTI()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A226')
set GK=hero
set VRI=level
set VTI=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),375+25,Condition(function CH1))
call ForGroup(g,function FB5)
call NSI(g)
set g=null
set hero=null
endfunction
function FD5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitTimeScale(hero,1)
set t=null
set hero=null
return false
endfunction
function FE5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.3,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function FD5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SetUnitTimeScale(hero,2)
set t=null
set hero=null
endfunction
function FF5 takes nothing returns boolean
if GetSpellAbilityId()=='A226' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call FC5()
else
call FE5()
endif
endif
return false
endfunction
function M81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function FF5))
set t=null
endfunction
constant function Healing_RawCode takes nothing returns integer
return 'A0OR'
endfunction
function FG5 takes nothing returns boolean
return GetSpellAbilityId()==('A0OR')
endfunction
function FH5 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(XO))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0
endfunction
function FZ5 takes nothing returns nothing
call Damage(XO,GetEnumUnit(),2,JO)
endfunction
function FV5 takes unit hero,unit target,real PAI returns nothing
local group Z51=NTI()
local boolexpr QL1=Condition(function FH5)
set XO=hero
set JO=PAI
call GroupEnumUnitsInRange(Z51,GetUnitX(target),GetUnitY(target),185+25,QL1)
call ForGroup(Z51,function FZ5)
call NSI(Z51)
endfunction
function FW5 takes nothing returns boolean
return IsUnitInGroup(GetFilterUnit(),B2)==false and IsUnitAlly(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitDead(GetFilterUnit())==false and GetFilterUnit()!=VPI
endfunction
function FX5 takes group FY5,unit FJ5,unit hero,unit OriginalTargetreturns returns unit
local group Z51=NTI()
local boolexpr QL1=Condition(function FW5)
local unit FK5=null
local unit FL5
set B2=FY5
set XO=hero
call GroupEnumUnitsInRange(Z51,GetUnitX(FJ5),GetUnitY(FJ5),500,QL1)
set FL5=FirstOfGroup(Z51)
set FK5=FL5
loop
exitwhen FL5==null
if GetUnitState(FL5,UNIT_STATE_LIFE)!=GetUnitState(FL5,UNIT_STATE_MAX_LIFE)then
if FL5!=hero and IsUnitType(FL5,UNIT_TYPE_HERO)==true and IsUnitType(FK5,UNIT_TYPE_HERO)==false then
set FK5=FL5
elseif FL5!=hero and GetUnitState(FL5,UNIT_STATE_LIFE)<GetUnitState(FK5,UNIT_STATE_LIFE)and IsUnitType(FL5,UNIT_TYPE_HERO)==true and IsUnitType(FK5,UNIT_TYPE_HERO)==true then
set FK5=FL5
elseif FL5!=hero and IsUnitType(FK5,UNIT_TYPE_HERO)==false and GetUnitState(FL5,UNIT_STATE_LIFE)<GetUnitState(FK5,UNIT_STATE_LIFE)then
set FK5=FL5
elseif FL5==hero then
set FK5=FL5
endif
endif
call GroupRemoveUnit(Z51,FL5)
set FL5=FirstOfGroup(Z51)
endloop
call NSI(Z51)
return FK5
endfunction
function FM5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local string FN5="Abilities\\Spells\\Undead\\ReplenishMana\\ReplenishManaCaster.mdl"
local string FS5="origin"
local unit array FT5
local integer x
local integer i=1
local integer level=GetUnitAbilityLevel(SFI,('A0OR'))
local real PAI=60+level*20
local group FY5=NTI()
local integer FR5
local boolean FP5=false
set VPI=SFI
if level==1 then
set FR5=3
elseif level==2 then
set FR5=4
elseif level==3 then
set FR5=5
elseif level==4 then
set FR5=6
endif
call SetUnitState(SFI,UNIT_STATE_LIFE,GetUnitState(SFI,UNIT_STATE_LIFE)+PAI)
call FV5(SFI,SFI,PAI)
call GroupAddUnit(FY5,SFI)
call U5I(FN5,SFI,FS5,2)
if target==SFI then
set FT5[i]=FX5(FY5,SFI,SFI,target)
else
set FT5[i]=target
endif
if FT5[i]==null then
call NSI(FY5)
return
endif
call SetUnitState(FT5[i],UNIT_STATE_LIFE,GetUnitState(FT5[i],UNIT_STATE_LIFE)+PAI)
call FV5(SFI,FT5[i],PAI)
call GroupAddUnit(FY5,FT5[i])
call U5I(FN5,FT5[i],FS5,2)
call UGI("SPLK",GetUnitX(SFI),GetUnitY(SFI),GetUnitX(FT5[i]),GetUnitY(FT5[i]),0.3,0.5,0.9,1,0.7)
set i=2
loop
exitwhen i>FR5 or FP5
set FT5[i]=FX5(FY5,FT5[i-1],SFI,target)
if FT5[i]==null then
set FP5=true
else
call GroupAddUnit(FY5,FT5[i])
call U5I(FN5,FT5[i],FS5,2)
call SetUnitState(FT5[i],UNIT_STATE_LIFE,GetUnitState(FT5[i],UNIT_STATE_LIFE)+PAI)
call FV5(SFI,FT5[i],PAI)
call UGI("SPLK",GetUnitX(FT5[i-1]),GetUnitY(FT5[i-1]),GetUnitX(FT5[i]),GetUnitY(FT5[i]),0.3,0.5,0.9,1,0.7)
set i=i+1
endif
endloop
call NSI(FY5)
endfunction
function NY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FG5))
call TriggerAddAction(t,function FM5)
endfunction
constant function BlowDart_RawCode takes nothing returns integer
return 'A2X6'
endfunction
constant function BlowDart_SlowCode takes nothing returns integer
return 'A0NJ'
endfunction
constant function BlowDart_StunCode takes nothing returns integer
return 'A0NK'
endfunction
constant function BlowDart_IconCode takes nothing returns integer
return 'A0OW'
endfunction
function FQ5 takes nothing returns boolean
return GetSpellAbilityId()==('A2X6')and CanResistSkill(GetSpellTargetUnit())==false
endfunction
function FU5 takes unit hero,unit target,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,('A0NJ'))
call SetUnitAbilityLevel(dummy,('A0NJ'),level)
call IssueTargetOrder(dummy,"slow",target)
endfunction
function G05 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,('A2X6'))
local integer KO2=GetTriggerExecCount(t)
local real PAI=8+6*level
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if level==1 then
call AddSkill(target,('A0OW'))
if KO2==1 then
call FU5(hero,target,1)
endif
if KO2==2 then
call FU5(hero,target,1)
endif
if KO2>2 then
call Damage(dummy,target,2,PAI)
endif
if KO2==8 then
call UnitRemoveAbility(target,('A0OW'))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
if level==2 then
call AddSkill(target,('A0OW'))
if KO2==1 then
call FU5(hero,target,1)
endif
if KO2==2 then
call FU5(hero,target,2)
endif
if KO2>2 then
call Damage(dummy,target,2,PAI)
endif
if KO2==8 then
call UnitRemoveAbility(target,('A0OW'))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
if level==3 then
call AddSkill(target,('A0OW'))
if KO2==1 then
call FU5(hero,target,2)
endif
if KO2==2 then
call FU5(hero,target,3)
endif
if KO2>2 then
call Damage(dummy,target,2,PAI)
endif
if KO2==8 then
call UnitRemoveAbility(target,('A0OW'))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
if level==4 then
call AddSkill(target,('A0OW'))
if KO2==1 then
call FU5(hero,target,2)
endif
if KO2==2 then
call DD1(hero,target,1.0)
endif
if KO2>2 then
call Damage(dummy,target,2,PAI)
endif
if KO2==8 then
call UnitRemoveAbility(target,('A0OW'))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set dummy=null
endfunction
function GI5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GK
local unit target=HK
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddAction(t,function G05)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call FU5(hero,target,1)
set dummy=null
endfunction
function G15 takes nothing returns nothing
local trigger t=IJ1(GetTriggerUnit(),GetSpellTargetUnit(),'h0EQ',"GI5",1300,true)
local integer handle_id=GetHandleId(t)
set t=null
endfunction
function NJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FQ5))
call TriggerAddAction(t,function G15)
call Q1I(('A0NJ'))
call Q1I(('A0NK'))
endfunction
function GO5 takes nothing returns nothing
local unit target=GetEnumUnit()
if IsUnitDead(target)==false then
call UnitRemoveAbility(target,'A0NU')
call UnitRemoveAbility(target,'A0NW')
elseif IsUnitType(target,UNIT_TYPE_HERO)==true then
call OC1(target,'A0NU',5.1)
call OC1(target,'A0NW',5.1)
endif
set target=null
endfunction
function G25 takes nothing returns nothing
local unit target=GetEnumUnit()
if IsUnitDead(target)==false then
if IsUnitAlly(target,JK)==false then
if UJ==0 then
call AddSkill(target,'A0NU')
else
call SetUnitAbilityLevel(target,'A0NU',R2I(VQI*(UJ+1)))
endif
else
if UJ==0 then
call AddSkill(target,'A0NW')
else
call SetUnitAbilityLevel(target,'A0NW',R2I(VQI*(UJ+1)))
endif
endif
endif
set target=null
endfunction
function G35 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local player p=(LoadPlayerHandle(LY,(handle_id),(54)))
local integer NPI=GetTriggerEvalCount(t)
local integer DC1=(LoadInteger(LY,(handle_id),(188)))
local real G45=(LoadReal(LY,(handle_id),(68)))
set VQI=G45
set JK=p
set UJ=NPI
if NPI>=DC1/1.0 then
call ForGroup(g,function GO5)
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call ForGroup(g,function G25)
endif
set t=null
set g=null
set p=null
return false
endfunction
function G55 takes nothing returns nothing
call U5I(LK,GetEnumUnit(),"chest",3)
call U5I(LK,GetEnumUnit(),"chest",3)
call U5I(LK,GetEnumUnit(),"right hand",3)
call U5I(LK,GetEnumUnit(),"left hand",3)
endfunction
function G65 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local group g=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(SFI,'A10Q')
local integer DC1=24
local real G45=0.5+0.25*level
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'h007',x,y,0)
local integer a=0
local boolean CK3=false
if level==0 then
set level=GetUnitAbilityLevel(SFI,'A1DB')
set DC1=24
set G45=1.0+0.25*level
set CK3=true
endif
call RemoveLocation(point)
set LK=""
set UJ=DC1
set a=255
set LK="Abilities\\Weapons\\AvengerMissile\\AvengerMissile.mdl"
call SetUnitVertexColor(dummy,255,255,255,a)
call UnitApplyTimedLife(dummy,'BTLF',5)
if CK3 then
call GroupEnumUnitsInRange(g,x,y,800,Condition(function D51))
else
call GroupEnumUnitsInRange(g,x,y,600,Condition(function D51))
endif
call ForGroup(g,function G55)
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SavePlayerHandle(LY,(handle_id),(54),(GetOwningPlayer(SFI)))
call SaveInteger(LY,(handle_id),(188),(DC1))
call SaveReal(LY,(handle_id),(68),((G45)*1.0))
call TriggerRegisterTimerEvent(t,1.0,true)
call TriggerAddCondition(t,Condition(function G35))
call TriggerEvaluate(t)
set SFI=null
set point=null
set g=null
set t=null
endfunction
function G75 takes nothing returns boolean
if GetSpellAbilityId()=='A10Q' or GetSpellAbilityId()=='A1DB' then
call G65()
endif
return false
endfunction
function NK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function G75))
call Q1I('A0NU')
call Q1I('A0NW')
set t=null
endfunction
function G85 takes string UWI,unit target,unit SFI returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,0.033)
call SetTextTagPosUnit(tt,target,64)
call SetTextTagColor(tt,160,0,255,255)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,0.15)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,0.65)
if IsUnitAlly(SFI,GetLocalPlayer())or P0I(GetLocalPlayer())then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
set tt=null
endfunction
function G95 takes real DC1 returns string
if DC1>4.5 then
return"5.0"
elseif DC1>4.0 then
return"4.5"
elseif DC1>3.5 then
return"4.0"
elseif DC1>3.0 then
return"3.5"
elseif DC1>2.5 then
return"3.0"
elseif DC1>2.0 then
return"2.5"
elseif DC1>1.5 then
return"2.0"
elseif DC1>1.0 then
return"1.5"
elseif DC1>0.5 then
return"1.0"
elseif DC1>0.0 then
return"0.5"
else
return"0.0"
endif
return" "
endfunction
function GA5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=GetTriggerEvalCount(t)
if NPI>11 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call G85(G95(5.5-0.5*NPI),target,target)
endif
set t=null
set target=null
return false
endfunction
function GB5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local real GC5=QDI(GetUnitState(target,UNIT_STATE_LIFE)-PAI,1)
local real GD5=(LoadReal(LY,(GetHandleId(target)),(243)))
call SetUnitState(target,UNIT_STATE_LIFE,GC5)
call SaveReal(LY,(GetHandleId(target)),(243),((GD5-PAI)*1.0))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function GE5 takes unit target,real PAI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real GD5=(LoadReal(LY,(GetHandleId(target)),(243)))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveReal(LY,(GetHandleId(target)),(243),((GD5+PAI)*1.0))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function GB5))
set t=null
endfunction
function GF5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target
local real D14
local real PAI
local integer NPI=GetTriggerEvalCount(t)
local real GD5
local real GG5=(LoadReal(LY,(handle_id),(389)))
local real GH5=(LoadReal(LY,(handle_id),(390)))
if GG5!=(TimerGetElapsed(M))then
set GG5=(TimerGetElapsed(M))
set GH5=0
call SaveReal(LY,(handle_id),(389),((GG5)*1.0))
call SaveReal(LY,(handle_id),(390),((GH5)*1.0))
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
set target=GetTriggerUnit()
set GD5=(LoadReal(LY,(GetHandleId(target)),(243)))
set D14=GetUnitState(target,UNIT_STATE_LIFE)
set PAI=GetEventDamage()
if((D14-GD5-GH5)-PAI)<1 then
call SetUnitState(target,UNIT_STATE_LIFE,D14+PAI+GH5)
call GE5(target,PAI)
else
set GH5=GH5+PAI
call SaveReal(LY,(handle_id),(390),((GH5)*1.0))
endif
else
call SaveInteger(LY,(GetHandleId(((LoadUnitHandle(LY,(handle_id),(17)))))),((2485)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility((LoadUnitHandle(LY,(handle_id),(17))),'A21I')
call UnitRemoveAbility((LoadUnitHandle(LY,(handle_id),(17))),'B07D')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set target=null
set t=null
return false
endfunction
function GZ5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
call AddSkill(target,'A21I')
call TriggerRegisterTimerEvent(t,5,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function GF5))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\DarkHands.mdx",target,"overhead")))
call SaveReal(LY,(GetHandleId(target)),(243),((0)*1.0))
call SaveReal(LY,(handle_id),(389),(((TimerGetElapsed(M)))*1.0))
call SaveReal(LY,(handle_id),(390),((0)*1.0))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(GetHandleId((target))),((2485)),(1))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function GA5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function GV5 takes nothing returns boolean
if GetSpellAbilityId()=='A10L' then
call GZ5()
endif
return false
endfunction
function NL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GV5))
set t=null
endfunction
function GW5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEvalCount(t)>5 or GetUnitAbilityLevel(target,'B0AQ')==0 or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
else
call Damage(hero,target,1,30*level-30)
call UYI(I2S(30*level-30),3,target,0.025,160,255,0,230)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function GX5 takes unit hero,unit target,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local trigger t
local integer handle_id
call AddSkill(dummy,'A17N')
call SetUnitAbilityLevel(dummy,'A17N',level)
if IssueTargetOrder(dummy,"shadowstrike",target)then
call Damage(hero,target,1,25*level)
call UYI(I2S(25*level)+"!",3,target,0.025,160,255,0,230)
if level>1 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,3,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function GW5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
set t=null
endif
endif
set dummy=null
endfunction
function GY5 takes nothing returns nothing
local unit target=GetEnumUnit()
if IsUnitInGroup(target,XK)==false then
call GX5(W0I,target,VUI)
call GroupAddUnit(XK,target)
endif
set target=null
endfunction
function GJ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local group H03
local real x
local real y
local real GK5
local real GL5
local real RS2=30
local unit GM5
set VUI=level
if GetTriggerEvalCount(t)>28 then
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(dummy,false)
call KillUnit(dummy)
else
set x=GetUnitX(dummy)
set y=GetUnitY(dummy)
set H03=NTI()
set XK=g
set GK=SFI
set W0I=SFI
call GroupEnumUnitsInRange(H03,x,y,150,Condition(function CH1))
call ForGroup(H03,function GY5)
call NSI(H03)
set GK5=PTI(x+RS2*Cos(RM2*bj_DEGTORAD))
set GL5=PUI(y+RS2*Sin(RM2*bj_DEGTORAD))
call MUSetUnitX(dummy,GK5)
call MUSetUnitY(dummy,GL5)
if ModuloInteger(GetTriggerEvalCount(t),3)==0 then
set GM5=CreateUnit(GetOwningPlayer(dummy),'o01W',GK5,GL5,0)
call KillUnit(GM5)
set GM5=null
endif
endif
set t=null
set g=null
set H03=null
set dummy=null
set SFI=null
return false
endfunction
function GN5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real x2=GetLocationX(point)
local real y2=GetLocationY(point)
local real RM2=UEI(x1,y1,x2,y2)
local integer level=GetUnitAbilityLevel(SFI,'A173')
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'h07K',x1,y1,RM2)
call IO1(VE,x1,y1)
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.025,true)
call TriggerAddCondition(t,Condition(function GJ5))
call RemoveLocation(point)
set t=null
set dummy=null
set g=null
set SFI=null
set point=null
endfunction
function GS5 takes nothing returns boolean
if GetSpellAbilityId()=='A173' then
call GN5()
endif
return false
endfunction
function M91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GS5))
set t=null
endfunction
function GT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local real DC1=(LoadReal(LY,(handle_id),(57)))
local real IS5=0.75
if IsUnitType(target,UNIT_TYPE_HERO)==false and IsUnitIllusion(target)==false then
set IS5=1.0
endif
if GetUnitState(target,UNIT_STATE_LIFE)<=PAI*IS5 then
set PAI=QDI(GetUnitState(target,UNIT_STATE_LIFE)/IS5-2,0)
endif
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call UnitRemoveAbility(target,'A1W5')
call UnitRemoveAbility(target,'B028')
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
else
set DC1=DC1-1
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
call Damage(hero,target,1,PAI)
if DC1<=0 then
call UnitRemoveAbility(target,'A1W5')
call UnitRemoveAbility(target,'B028')
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function GR5 takes unit target,unit hero,real DC1,real PAI returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(target,'A1W5')
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function GT5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
call TriggerEvaluate(t)
set t=null
endfunction
function GP5 takes nothing returns nothing
if GetUnitAbilityLevel(GetEnumUnit(),'A1W5')==0 then
call GR5(GetEnumUnit(),WII,W1I,WOI)
endif
endfunction
function GQ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real DC1=(LoadReal(LY,(handle_id),(57)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local group g
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
set WII=hero
set W1I=DC1
set WOI=PAI
call GroupEnumUnitsInRange(g,GetUnitX(IG1),GetUnitY(IG1),256+25,Condition(function CA1))
call ForGroup(g,function GP5)
call NSI(g)
set g=null
endif
set t=null
set hero=null
set IG1=null
return false
endfunction
function GU5 takes unit IG1,unit hero,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real DC1=12
local real PAI=36
if level==2 then
set DC1=14
set PAI=58
elseif level==3 then
set DC1=15
set PAI=81
elseif level==4 then
set DC1=16
set PAI=108
endif
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterDeathEvent(t,IG1)
call TriggerAddCondition(t,Condition(function GQ5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call SaveReal(LY,(handle_id),(57),((DC1)*1.0))
set t=null
endfunction
function H05 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local integer HI5
local integer i=1
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local unit dummy
if GetSpellAbilityId()=='A013' then
set HI5=GetUnitAbilityLevel(SFI,'A013')
else
set HI5=GetUnitAbilityLevel(SFI,'A0A6')+1
endif
loop
exitwhen i>18
set dummy=CreateUnit(GetOwningPlayer(SFI),'e017',x,y,0)
call IssuePointOrder(dummy,"move",x+675*Cos(i*20*bj_DEGTORAD),y+675*Sin(i*20*bj_DEGTORAD))
call UnitApplyTimedLife(dummy,'BTLF',1.15)
call GU5(dummy,SFI,HI5)
set i=i+1
endloop
set SFI=null
set dummy=null
endfunction
function H15 takes nothing returns boolean
if GetSpellAbilityId()=='A013' or GetSpellAbilityId()=='A0A6' then
call H05()
endif
return false
endfunction
function MA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function H15))
set t=null
endfunction
function HO5 takes nothing returns nothing
local unit hero=GetSummoningUnit()
local unit target=GetSummonedUnit()
local integer level=GetUnitAbilityLevel(hero,'A0MY')
if level>0 then
call AddSkill(target,'A0MY')
call SetUnitAbilityLevel(target,'A0MY',level)
endif
set hero=null
set target=null
endfunction
function H25 takes nothing returns boolean
local integer RII=GetUnitTypeId(GetSummonedUnit())
if RII=='o00T' or RII=='o00U' or RII=='o00V' or RII=='o00W' then
call HO5()
endif
return false
endfunction
function MB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function H25))
set t=null
endfunction
function H35 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call G21(hero,0)
call SaveInteger(LY,(GetHandleId((hero))),((4277)),(2))
set t=null
set hero=null
return false
endfunction
function H45 takes unit Z4O,unit target returns nothing
local real TH4=100*GetUnitState(target,UNIT_STATE_LIFE)/GetUnitState(target,UNIT_STATE_MAX_LIFE)
local real EB2=2.5*GetUnitAbilityLevel(Z4O,'A1A3')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer FinalBonus
call SaveInteger(LY,(GetHandleId((Z4O))),((4277)),(1))
call TriggerRegisterTimerEvent(t,0.35,false)
call TriggerAddCondition(t,Condition(function H35))
call SaveUnitHandle(LY,(handle_id),(2),(Z4O))
if IsUnitType(target,UNIT_TYPE_HERO)==false then
set EB2=EB2/2
endif
if TH4>80 then
call G21(Z4O,R2I(EB2))
elseif TH4>60 then
call G21(Z4O,R2I(EB2*2))
elseif TH4>40 then
call G21(Z4O,R2I(EB2*2*2))
elseif TH4>20 then
call G21(Z4O,R2I(EB2*2*2*2))
else
call G21(Z4O,R2I(EB2*2*2*2*2))
endif
set t=null
endfunction
function H55 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
if GetSpellAbilityId()=='A09V' and GetUnitAbilityLevel(GetTriggerUnit(),'A1A3')>0 then
call H45(GetTriggerUnit(),GetSpellTargetUnit())
endif
else
if GetUnitAbilityLevel(GetAttacker(),'A1A3')>0 and IsUnitIllusion(GetAttacker())==false and IsUnitEnemy(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==true and((LoadInteger(LY,(GetHandleId((GetAttacker()))),((4277))))==1)==false then
call H45(GetAttacker(),GetTriggerUnit())
endif
endif
return false
endfunction
function MC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function H55))
set t=null
endfunction
function H65 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(684)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or LVO<(TimerGetElapsed(M))or RKI(target)then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveReal(LY,(GetHandleId(target)),(684),((0)*1.0))
call UnitRemoveAbility(target,'A23W')
call UnitRemoveAbility(target,'A23U')
call UnitRemoveAbility(target,'A23V')
call UnitRemoveAbility(target,'A23X')
call UnitRemoveAbility(target,'B0EA')
else
set W3I=false
call Damage(hero,target,1,5+5*level)
set W3I=true
endif
set t=null
set hero=null
set target=null
return false
endfunction
function H75 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local real LVO=(LoadReal(LY,(GetHandleId(target)),(684)))
local integer level=GetUnitAbilityLevel(hero,'A0MM')
if LVO>(TimerGetElapsed(M))then
call SaveReal(LY,(GetHandleId(target)),(684),(((TimerGetElapsed(M))+W2I)*1.0))
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveReal(LY,(GetHandleId(target)),(684),(((TimerGetElapsed(M))+W2I)*1.0))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function H65))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
if BJ1(target)==false then
if level==1 then
call AddSkill(target,'A23W')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A23W',false)
elseif level==2 then
call AddSkill(target,'A23U')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A23U',false)
elseif level==3 then
call AddSkill(target,'A23V')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A23V',false)
elseif level==4 then
call AddSkill(target,'A23X')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A23X',false)
endif
endif
endif
set t=null
set hero=null
set target=null
endfunction
function H85 takes nothing returns boolean
local unit hero=GetTriggerUnit()
local unit target=GetEventDamageSource()
if RLI(target)then
set target=(K1[GetPlayerId(GetOwningPlayer((target)))])
endif
if W3I and IsUnitType(target,UNIT_TYPE_STRUCTURE)==false and QLI(hero,target)<1400 and IsUnitEnemy(hero,GetOwningPlayer(target))and RKI(target)==false and GetUnitAbilityLevel(hero,'BNdo')==0 then
call H75(hero,target)
endif
return false
endfunction
function H95 takes nothing returns nothing
local trigger t=CreateTrigger()
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function H85))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function HA5 takes nothing returns boolean
if GetLearnedSkill()=='A0MM' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A0MM')==1 then
call H95()
endif
return false
endfunction
function MD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function HA5))
set t=null
endfunction
function HB5 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
call UnitRemoveAbility(target,'BEsh')
call UnitRemoveAbility(target,'B0AQ')
set target=null
endfunction
function HC5 takes nothing returns boolean
if GetSpellAbilityId()=='A080' or GetSpellAbilityId()=='A1UZ' then
call HB5()
endif
return false
endfunction
function ME1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HC5))
set t=null
endfunction
function HD5 takes nothing returns boolean
return GetSpellAbilityId()=='A08X'
endfunction
function HE5 takes nothing returns nothing
local location BFO=GetUnitLoc(GetSpellAbilityUnit())
call CreateNUnitsAtLocFacingLocBJ(1,'e00E',GetOwningPlayer(GetSpellAbilityUnit()),BFO,BFO)
call RemoveLocation(BFO)
call UnitAddAbility(bj_lastCreatedUnit,'A09C')
call SetUnitAbilityLevelSwapped('A09C',bj_lastCreatedUnit,GetUnitAbilityLevelSwapped('A08X',GetSpellAbilityUnit()))
call IssueTargetOrder(bj_lastCreatedUnit,"bloodlust",GetSpellAbilityUnit())
endfunction
function MG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function HD5))
call TriggerAddAction(t,function HE5)
endfunction
function HF5 takes unit target,integer HG5 returns nothing
call UnitRemoveAbility(target,'A1M3')
call UnitRemoveAbility(target,'A1M4')
call UnitRemoveAbility(target,'A1MC')
call UnitRemoveAbility(target,'A1M7')
call UnitRemoveAbility(target,'A1M8')
call UnitRemoveAbility(target,'A1M9')
call UnitRemoveAbility(target,'A1MA')
call UnitRemoveAbility(target,'A1M5')
call UnitRemoveAbility(target,'A1MB')
call UnitRemoveAbility(target,'A1M6')
if HG5==1 then
call AddSkill(target,'A1M3')
elseif HG5==2 then
call AddSkill(target,'A1M4')
elseif HG5==3 then
call AddSkill(target,'A1MC')
elseif HG5==4 then
call AddSkill(target,'A1M7')
elseif HG5==5 then
call AddSkill(target,'A1M8')
elseif HG5==6 then
call AddSkill(target,'A1M9')
elseif HG5==7 then
call AddSkill(target,'A1MA')
elseif HG5==8 then
call AddSkill(target,'A1M5')
elseif HG5==9 then
call AddSkill(target,'A1MB')
elseif HG5==10 then
call AddSkill(target,'A1M6')
endif
endfunction
function GravekeepersCloakEnemy_Decay takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer HG5
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set handle_id=GetHandleId(target)
set HG5=(LoadInteger(LY,(handle_id),(427)))
set HG5=QAI(HG5-1,0)
call SaveInteger(LY,(handle_id),(427),(HG5))
call HF5(target,HG5)
set t=null
set target=null
return false
endfunction
function HH5 takes unit hero,integer level,integer HZ5 returns nothing
call UnitRemoveAbility(hero,'A1KR')
call UnitRemoveAbility(hero,'A1KS')
call UnitRemoveAbility(hero,'A1KQ')
call UnitRemoveAbility(hero,'A1KP')
call UnitRemoveAbility(hero,'A1K1')
call UnitRemoveAbility(hero,'A1KW')
call UnitRemoveAbility(hero,'A1KX')
call UnitRemoveAbility(hero,'A1KY')
call UnitRemoveAbility(hero,'A1L4')
call UnitRemoveAbility(hero,'A1L3')
call UnitRemoveAbility(hero,'A1L2')
call UnitRemoveAbility(hero,'A1L1')
call UnitRemoveAbility(hero,'A1L8')
call UnitRemoveAbility(hero,'A1L7')
call UnitRemoveAbility(hero,'A1L9')
call UnitRemoveAbility(hero,'A1LB')
if level==1 then
if HZ5==1 then
call AddSkill(hero,'A1KR')
elseif HZ5==2 then
call AddSkill(hero,'A1KS')
elseif HZ5==3 then
call AddSkill(hero,'A1KQ')
elseif HZ5==4 then
call AddSkill(hero,'A1KP')
endif
elseif level==2 then
if HZ5==1 then
call AddSkill(hero,'A1K1')
elseif HZ5==2 then
call AddSkill(hero,'A1KW')
elseif HZ5==3 then
call AddSkill(hero,'A1KX')
elseif HZ5==4 then
call AddSkill(hero,'A1KY')
endif
elseif level==3 then
if HZ5==1 then
call AddSkill(hero,'A1L4')
elseif HZ5==2 then
call AddSkill(hero,'A1L3')
elseif HZ5==3 then
call AddSkill(hero,'A1L2')
elseif HZ5==4 then
call AddSkill(hero,'A1L1')
endif
elseif level==4 then
if HZ5==1 then
call AddSkill(hero,'A1L8')
elseif HZ5==2 then
call AddSkill(hero,'A1L7')
elseif HZ5==3 then
call AddSkill(hero,'A1L9')
elseif HZ5==4 then
call AddSkill(hero,'A1LB')
endif
endif
endfunction
function HV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer HW5=(LoadInteger(LY,(handle_id),(426)))
local unit hero=(LoadUnitHandle(LY,(HW5),(2)))
local integer HZ5=(LoadInteger(LY,(HW5),(425)))
local integer level=GetUnitAbilityLevel(hero,'A0VX')
set HZ5=Q9I(HZ5+1,4)
call SaveInteger(LY,(HW5),(425),(HZ5))
call HH5(hero,level,HZ5)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function HX5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer HZ5=(LoadInteger(LY,(handle_id),(425)))
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A0VX')
if GetEventDamage()>2 and GetEventDamageSource()!=GetTriggerUnit()and T2I(GetOwningPlayer(GetEventDamageSource()))then
if HZ5>0 then
endif
set HZ5=QAI(HZ5-1,0)
call SaveInteger(LY,(handle_id),(425),(HZ5))
call HH5(hero,level,HZ5)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function HV5))
call SaveInteger(LY,(handle_id),(426),(GetHandleId(GetTriggeringTrigger())))
endif
set t=null
set hero=null
return false
endfunction
function HY5 takes nothing returns nothing
local trigger t
local integer handle_id
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(GetTriggerUnit(),'A0VX')
if level==1 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function HX5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(425),(4))
endif
call HH5(hero,level,4)
set t=null
set hero=null
endfunction
function HJ5 takes nothing returns boolean
if GetLearnedSkill()=='A0VX' and IsUnitIllusion(GetTriggerUnit())==false then
call HY5()
endif
return false
endfunction
function HK5 takes player p returns nothing
call SetPlayerAbilityAvailable(p,'A1KR',false)
call SetPlayerAbilityAvailable(p,'A1KS',false)
call SetPlayerAbilityAvailable(p,'A1KQ',false)
call SetPlayerAbilityAvailable(p,'A1KP',false)
call SetPlayerAbilityAvailable(p,'A1KU',false)
call SetPlayerAbilityAvailable(p,'A1KV',false)
call SetPlayerAbilityAvailable(p,'A1K1',false)
call SetPlayerAbilityAvailable(p,'A1KW',false)
call SetPlayerAbilityAvailable(p,'A1KX',false)
call SetPlayerAbilityAvailable(p,'A1KY',false)
call SetPlayerAbilityAvailable(p,'A1KZ',false)
call SetPlayerAbilityAvailable(p,'A1KT',false)
call SetPlayerAbilityAvailable(p,'A1L4',false)
call SetPlayerAbilityAvailable(p,'A1L3',false)
call SetPlayerAbilityAvailable(p,'A1L2',false)
call SetPlayerAbilityAvailable(p,'A1L1',false)
call SetPlayerAbilityAvailable(p,'A1L0',false)
call SetPlayerAbilityAvailable(p,'A1L5',false)
call SetPlayerAbilityAvailable(p,'A1L8',false)
call SetPlayerAbilityAvailable(p,'A1L7',false)
call SetPlayerAbilityAvailable(p,'A1L9',false)
call SetPlayerAbilityAvailable(p,'A1LB',false)
call SetPlayerAbilityAvailable(p,'A1LA',false)
call SetPlayerAbilityAvailable(p,'A1L6',false)
call SetPlayerAbilityAvailable(p,'A1LH',false)
call SetPlayerAbilityAvailable(p,'A1M3',false)
call SetPlayerAbilityAvailable(p,'A1M4',false)
call SetPlayerAbilityAvailable(p,'A1MC',false)
call SetPlayerAbilityAvailable(p,'A1M7',false)
call SetPlayerAbilityAvailable(p,'A1M8',false)
call SetPlayerAbilityAvailable(p,'A1M9',false)
call SetPlayerAbilityAvailable(p,'A1MA',false)
call SetPlayerAbilityAvailable(p,'A1M5',false)
call SetPlayerAbilityAvailable(p,'A1MB',false)
call SetPlayerAbilityAvailable(p,'A1M6',false)
endfunction
function MZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer i=0
local player p
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function HJ5))
loop
exitwhen i>5
set p=BO[i]
call HK5(p)
set p=CO[i]
call HK5(p)
set i=i+1
endloop
set t=null
endfunction
function HL5 takes nothing returns nothing
local integer level
local unit hero=GetTriggerUnit()
local unit dummy
if GetUnitTypeId(hero)=='u017' or GetUnitTypeId(hero)=='u019' or GetUnitTypeId(hero)=='u018' or GetUnitTypeId(hero)=='u01A' or GetUnitTypeId(hero)=='u01B' or GetUnitTypeId(hero)=='u01C' or GetUnitTypeId(hero)=='u01U' or GetUnitTypeId(hero)=='u01V' or GetUnitTypeId(hero)=='u01W' then
return
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
if GetUnitTypeId(hero)=='u014' or GetUnitTypeId(hero)=='u01D' or GetUnitTypeId(hero)=='u01R' then
set level=1
elseif GetUnitTypeId(hero)=='u015' or GetUnitTypeId(hero)=='u01E' or GetUnitTypeId(hero)=='u01S' then
set level=2
else
set level=3
endif
call AddSkill(dummy,'A1NF')
call SetUnitAbilityLevel(dummy,'A1NF',level)
call IssueImmediateOrder(dummy,"stomp")
set hero=null
set dummy=null
endfunction
function HM5 takes unit HN5,integer BQO,integer level returns nothing
local integer HS5
if level==1 then
set HS5=8
elseif level==2 then
set HS5=14
elseif level==3 then
set HS5=22
endif
call G21(HN5,BQO*HS5)
endfunction
function HT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit HN5=(LoadUnitHandle(LY,(handle_id),(2)))
local unit hero=HN5
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer QX2=(LoadInteger(LY,(handle_id),(28)))
local integer BQO=(LoadInteger(LY,(handle_id),(194)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==HN5 then
set BQO=IMaxBJ(BQO-1,0)
call SaveInteger(LY,(handle_id),(194),(BQO))
call HM5(HN5,BQO,level)
endif
else
set QX2=QX2+1
call SaveInteger(LY,(handle_id),(28),(QX2))
if ModuloInteger(QX2,15)==0 then
set BQO=IMinBJ(BQO+1,7)
call SaveInteger(LY,(handle_id),(194),(BQO))
endif
if GetUnitTypeId(hero)=='u017' or GetUnitTypeId(hero)=='u019' or GetUnitTypeId(hero)=='u018' or GetUnitTypeId(hero)=='u01A' or GetUnitTypeId(hero)=='u01B' or GetUnitTypeId(hero)=='u01C' or GetUnitTypeId(hero)=='u01U' or GetUnitTypeId(hero)=='u01V' or GetUnitTypeId(hero)=='u01W' then
set BQO=7
call SaveInteger(LY,(handle_id),(194),(BQO))
endif
call HM5(HN5,BQO,level)
if GetUnitTypeId(HN5)=='u017' or GetUnitTypeId(HN5)=='u019' or GetUnitTypeId(HN5)=='u018' or GetUnitTypeId(HN5)=='u01A' or GetUnitTypeId(HN5)=='u01B' or GetUnitTypeId(HN5)=='u01C' or GetUnitTypeId(HN5)=='u01U' or GetUnitTypeId(HN5)=='u01V' or GetUnitTypeId(HN5)=='u01W' then
call SetUnitState(HN5,UNIT_STATE_LIFE,GetUnitState(HN5,UNIT_STATE_LIFE)+31.25+18.75*level)
endif
endif
set t=null
set HN5=null
return false
endfunction
function HR5 takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())=='u014' or GetUnitTypeId(GetFilterUnit())=='u015' or GetUnitTypeId(GetFilterUnit())=='u016' or GetUnitTypeId(GetFilterUnit())=='u01D' or GetUnitTypeId(GetFilterUnit())=='u01E' or GetUnitTypeId(GetFilterUnit())=='u01F' or GetUnitTypeId(GetFilterUnit())=='u01R' or GetUnitTypeId(GetFilterUnit())=='u01S' or GetUnitTypeId(GetFilterUnit())=='u01T' or GetUnitTypeId(GetFilterUnit())=='u017' or GetUnitTypeId(GetFilterUnit())=='u019' or GetUnitTypeId(GetFilterUnit())=='u018' or GetUnitTypeId(GetFilterUnit())=='u01A' or GetUnitTypeId(GetFilterUnit())=='u01B' or GetUnitTypeId(GetFilterUnit())=='u01C' or GetUnitTypeId(GetFilterUnit())=='u01U' or GetUnitTypeId(GetFilterUnit())=='u01V' or GetUnitTypeId(GetFilterUnit())=='u01W' then
call KillUnit(GetFilterUnit())
endif
return false
endfunction
function HP5 takes nothing returns nothing
local group g=NTI()
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local integer level=GetUnitAbilityLevel(hero,'A1NE')
local unit HQ5
local unit HU5
local unit Z05
local trigger t
local integer handle_id
local boolean E14=false
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(hero),Condition(function HR5))
call NSI(g)
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2IG')
set E14=true
endif
if level==1 then
set HQ5=CreateUnit(GetOwningPlayer(hero),'u014',x+75,y+75,GetUnitFacing(hero))
set HU5=CreateUnit(GetOwningPlayer(hero),'u01D',x-75,y-75,GetUnitFacing(hero))
elseif level==2 then
set HQ5=CreateUnit(GetOwningPlayer(hero),'u015',x+75,y+75,GetUnitFacing(hero))
set HU5=CreateUnit(GetOwningPlayer(hero),'u01E',x-75,y-75,GetUnitFacing(hero))
elseif level==3 then
set HQ5=CreateUnit(GetOwningPlayer(hero),'u016',x+75,y+75,GetUnitFacing(hero))
set HU5=CreateUnit(GetOwningPlayer(hero),'u01F',x-75,y-75,GetUnitFacing(hero))
endif
call SelectUnitAddForPlayer(HQ5,GetOwningPlayer(hero))
call SelectUnitAddForPlayer(HU5,GetOwningPlayer(hero))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.mdl",HQ5,"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.mdl",HU5,"origin"))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,HQ5,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function HT5))
call SaveUnitHandle(LY,(handle_id),(2),(HQ5))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(28),(0))
call SaveInteger(LY,(handle_id),(194),(7))
call HM5(HQ5,7,level)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,HU5,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function HT5))
call SaveUnitHandle(LY,(handle_id),(2),(HU5))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(28),(0))
call SaveInteger(LY,(handle_id),(194),(7))
call HM5(HU5,7,level)
if E14 then
if level==1 then
set Z05=CreateUnit(GetOwningPlayer(hero),'u01R',x+75,y,GetUnitFacing(hero))
elseif level==2 then
set Z05=CreateUnit(GetOwningPlayer(hero),'u01S',x+75,y,GetUnitFacing(hero))
elseif level==3 then
set Z05=CreateUnit(GetOwningPlayer(hero),'u01T',x+75,y,GetUnitFacing(hero))
endif
call SelectUnitAddForPlayer(Z05,GetOwningPlayer(hero))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.mdl",Z05,"origin"))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,Z05,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function HT5))
call SaveUnitHandle(LY,(handle_id),(2),(Z05))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(28),(0))
call SaveInteger(LY,(handle_id),(194),(7))
call HM5(Z05,7,level)
endif
set g=null
set hero=null
set HQ5=null
set HU5=null
endfunction
function ZI5 takes nothing returns boolean
if GetSpellAbilityId()=='A1NE' or GetSpellAbilityId()=='A2IG' then
call HP5()
elseif GetSpellAbilityId()=='A1NB' or GetSpellAbilityId()=='A1NC' or GetSpellAbilityId()=='A1ND' or GetSpellAbilityId()=='A1NL' or GetSpellAbilityId()=='A1NM' or GetSpellAbilityId()=='A1NN' or GetSpellAbilityId()=='A2IZ' or GetSpellAbilityId()=='A2J0' or GetSpellAbilityId()=='A2J1' then
call HL5()
endif
return false
endfunction
function MF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZI5))
set t=null
endfunction
function Z15 takes unit hero,integer JGO,integer ZO5 returns nothing
local string c1="|c0000cc00"
local string c="||"
local string p=" "
local string s=c1+"|||r"
local string FB1
local boolean TX4=false
local texttag tt=(LoadTextTagHandle(LY,(GetHandleId(hero)),(451)))
if JGO==0 then
set FB1=" "
elseif ZO5==1 then
if JGO==0 then
set FB1=c+p+c+p+c
elseif JGO==1 then
set FB1=s+p+c+p+c
elseif JGO==2 then
set FB1=s+p+s+p+c
elseif JGO==3 then
set FB1=s+p+s+p+s
endif
elseif ZO5==2 then
if JGO==0 then
set FB1=c+p+c+p+c+p+c
elseif JGO==1 then
set FB1=s+p+c+p+c+p+c
elseif JGO==2 then
set FB1=s+p+s+p+c+p+c
elseif JGO==3 then
set FB1=s+p+s+p+s+p+c
elseif JGO==4 then
set FB1=s+p+s+p+s+p+s
endif
elseif ZO5==3 then
if JGO==0 then
set FB1=c+p+c+p+c+p+c+p+c
elseif JGO==1 then
set FB1=s+p+c+p+c+p+c+p+c
elseif JGO==2 then
set FB1=s+p+s+p+c+p+c+p+c
elseif JGO==3 then
set FB1=s+p+s+p+s+p+c+p+c
elseif JGO==4 then
set FB1=s+p+s+p+s+p+s+p+c
elseif JGO==5 then
set FB1=s+p+s+p+s+p+s+p+s
endif
elseif ZO5==4 then
if JGO==0 then
set FB1=c+p+c+p+c+p+c+p+c+p+c
elseif JGO==1 then
set FB1=s+p+c+p+c+p+c+p+c+p+c
elseif JGO==2 then
set FB1=s+p+s+p+c+p+c+p+c+p+c
elseif JGO==3 then
set FB1=s+p+s+p+s+p+c+p+c+p+c
elseif JGO==4 then
set FB1=s+p+s+p+s+p+s+p+c+p+c
elseif JGO==5 then
set FB1=s+p+s+p+s+p+s+p+s+p+c
elseif JGO==6 then
set FB1=s+p+s+p+s+p+s+p+s+p+s
endif
endif
call SetTextTagText(tt,FB1,0.023)
if GetOwningPlayer(hero)==GetLocalPlayer()then
set TX4=true
endif
if IsUnitDead(hero)then
set TX4=false
endif
call SetTextTagPosUnit(tt,hero,0)
call SetTextTagVisibility(tt,TX4)
call SetTextTagPermanent(tt,true)
endfunction
function Z25 takes unit SFI,integer level returns nothing
local integer ZO5=GetUnitAbilityLevel(SFI,'A1NA')
call Z15(SFI,level,ZO5)
if level==0 or((LoadInteger(LY,(GetHandleId((SFI))),((2484))))==1)==true then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call AddSkill(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
call UnitRemoveAbility(SFI,'A0LR')
call UnitRemoveAbility(SFI,'A0YP')
call UnitRemoveAbility(SFI,'A0OG')
call UnitRemoveAbility(SFI,'A0YO')
call UnitRemoveAbility(SFI,'A0NF')
call UnitRemoveAbility(SFI,'A0MD')
elseif level==1 then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call UnitRemoveAbility(SFI,'A1O1')
call AddSkill(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
call AddSkill(SFI,'A0LR')
call UnitRemoveAbility(SFI,'A0YP')
call UnitRemoveAbility(SFI,'A0OG')
call UnitRemoveAbility(SFI,'A0YO')
call UnitRemoveAbility(SFI,'A0NF')
call UnitRemoveAbility(SFI,'A0MD')
elseif level==2 then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call UnitRemoveAbility(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call AddSkill(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
call UnitRemoveAbility(SFI,'A0LR')
call AddSkill(SFI,'A0YP')
call UnitRemoveAbility(SFI,'A0OG')
call UnitRemoveAbility(SFI,'A0YO')
call UnitRemoveAbility(SFI,'A0NF')
call UnitRemoveAbility(SFI,'A0MD')
elseif level==3 then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call UnitRemoveAbility(SFI,'A0LR')
call UnitRemoveAbility(SFI,'A0YP')
call AddSkill(SFI,'A0OG')
call UnitRemoveAbility(SFI,'A0YO')
call UnitRemoveAbility(SFI,'A0NF')
call UnitRemoveAbility(SFI,'A0MD')
call UnitRemoveAbility(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
if ZO5==1 then
call AddSkill(SFI,'A1O7')
else
call AddSkill(SFI,'A1N9')
endif
elseif level==4 then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call UnitRemoveAbility(SFI,'A0LR')
call UnitRemoveAbility(SFI,'A0YP')
call UnitRemoveAbility(SFI,'A0OG')
call AddSkill(SFI,'A0YO')
call UnitRemoveAbility(SFI,'A0NF')
call UnitRemoveAbility(SFI,'A0MD')
call UnitRemoveAbility(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
if ZO5==2 then
call AddSkill(SFI,'A1O8')
else
call AddSkill(SFI,'A1NY')
endif
elseif level==5 then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call UnitRemoveAbility(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call AddSkill(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
call UnitRemoveAbility(SFI,'A0LR')
call UnitRemoveAbility(SFI,'A0YP')
call UnitRemoveAbility(SFI,'A0OG')
call UnitRemoveAbility(SFI,'A0YO')
call AddSkill(SFI,'A0NF')
call UnitRemoveAbility(SFI,'A0MD')
call UnitRemoveAbility(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call UnitRemoveAbility(SFI,'A1O3')
if ZO5==3 then
call AddSkill(SFI,'A1O9')
else
call AddSkill(SFI,'A1O0')
endif
elseif level==6 then
call UnitRemoveAbility(SFI,'A1O7')
call UnitRemoveAbility(SFI,'A1O8')
call UnitRemoveAbility(SFI,'A1O9')
call UnitRemoveAbility(SFI,'A1O1')
call UnitRemoveAbility(SFI,'A1O2')
call UnitRemoveAbility(SFI,'A1NZ')
call UnitRemoveAbility(SFI,'A1N9')
call UnitRemoveAbility(SFI,'A1NY')
call UnitRemoveAbility(SFI,'A1O0')
call AddSkill(SFI,'A1O3')
call UnitRemoveAbility(SFI,'A0LR')
call UnitRemoveAbility(SFI,'A0YP')
call UnitRemoveAbility(SFI,'A0OG')
call UnitRemoveAbility(SFI,'A0YO')
call UnitRemoveAbility(SFI,'A0NF')
call AddSkill(SFI,'A0MD')
endif
if(GetUnitAbilityLevel(SFI,'A1NA')+2)==level then
call AddSkill(SFI,'A1NJ')
else
call UnitRemoveAbility(SFI,'A1NJ')
endif
endfunction
function Z35 takes unit hero,real PAI returns nothing
local integer level=0
local real Z45=110
if PAI>Z45*6 then
set level=6
elseif PAI>Z45*5 then
set level=5
elseif PAI>Z45*4 then
set level=4
elseif PAI>Z45*3 then
set level=3
elseif PAI>Z45*2 then
set level=2
elseif PAI>Z45*1 then
set level=1
endif
set level=Q9I(level,2+GetUnitAbilityLevel(hero,'A1NA'))
call SaveInteger(LY,(GetHandleId(hero)),(450),(level))
call Z25(hero,level)
endfunction
function Z55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer ZO5=GetUnitAbilityLevel(hero,'A1NA')
call Z15(hero,(LoadInteger(LY,(GetHandleId((hero))),(450))),ZO5)
call Z35(hero,(LoadReal(LY,(GetHandleId(hero)),(443))))
set t=null
set hero=null
return false
endfunction
function Z65 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
if IsUnitAlly(target,GetOwningPlayer(hero))==false then
set W5I=true
call Damage(hero,target,1,PAI)
set W5I=false
else
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+PAI)
endif
set hero=null
set target=null
endfunction
function Z75 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call Z35(hero,(LoadReal(LY,(GetHandleId(hero)),(443))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function Z85 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=(LoadInteger(LY,(GetHandleId((hero))),(450)))
local trigger t=IJ1(hero,target,'h0BE',"Z65",1000,false)
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(20),((20+level*65)*1.0))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AntiMagicShell\\AntiMagicShell.mdl",hero,"chest"))
call SaveReal(LY,(GetHandleId(hero)),(443),((0)*1.0))
call Z35(hero,0)
call SCI(hero,2484,4)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerAddCondition(t,Condition(function Z75))
call TriggerRegisterTimerEvent(t,4,false)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set target=null
set t=null
endfunction
function Z95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A1NA')then
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT then
call SaveReal(LY,(GetHandleId(hero)),(443),(((LoadReal(LY,(GetHandleId(hero)),(443)))-PAI)*1.0))
endif
call Z35(hero,(LoadReal(LY,(GetHandleId(hero)),(443))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function ZA5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer handle_id=GetHandleId(hero)
local texttag tt=CreateTextTag()
local boolean TX4=false
local trigger t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function Z55))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
if GetOwningPlayer(hero)==GetLocalPlayer()then
set TX4=true
endif
call SetTextTagText(tt," ",0.023)
call SetTextTagPosUnit(tt,hero,0)
call SetTextTagVisibility(tt,TX4)
call SetTextTagPermanent(tt,true)
set W4I[GetPlayerId(GetOwningPlayer(hero))]=hero
call SaveReal(LY,(handle_id),(443),((0)*1.0))
call Z35(hero,0)
call SaveTextTagHandle(LY,(handle_id),(451),(tt))
set hero=null
set t=null
set tt=null
endfunction
function ZB5 takes unit ZC5,unit ZD5 returns nothing
local real PAI=GetEventDamage()
local integer level=GetUnitAbilityLevel(ZC5,'A1NA')
local real ZE5=(LoadReal(LY,(GetHandleId(ZC5)),(443)))
local trigger t
local integer handle_id
if QLI(ZC5,ZD5)<1400 and W5I==false then
if RSI(PAI)and GetEventDamage()>2 and GetEventDamageSource()!=GetTriggerUnit()and(T2I(GetOwningPlayer(GetEventDamageSource()))or GetUnitTypeId(GetEventDamageSource())=='n00L')then
set ZE5=ZE5+PAI
call SaveReal(LY,(GetHandleId(ZC5)),(443),((ZE5)*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(ZC5))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call TriggerRegisterTimerEvent(t,6,false)
call TriggerRegisterUnitEvent(t,ZC5,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,ZC5,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Z95))
call Z35(ZC5,ZE5)
endif
endif
set t=null
endfunction
function ZF5 takes nothing returns nothing
local integer i=0
loop
exitwhen i>12
if W4I[i]!=null then
call ZB5(W4I[i],GetTriggerUnit())
endif
set i=i+1
endloop
endfunction
function ZG5 takes nothing returns boolean
if GetLearnedSkill()=='A1NA' and GetUnitAbilityLevel(GetTriggerUnit(),'A1NA')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call ZA5()
endif
return false
endfunction
function ZH5 takes nothing returns boolean
if GetSpellAbilityId()=='A1NA' then
call Z85()
endif
return false
endfunction
function MH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function ZG5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZH5))
set t=null
call O42("ZF5")
endfunction
constant function Upheaval_RawCode takes nothing returns integer
return 'A06P'
endfunction
constant function Upheaval_EffectCode takes nothing returns integer
return 'A0JE'
endfunction
constant function Upheaval_EffectModel takes nothing returns integer
return 'e01G'
endfunction
function ZZ5 takes nothing returns boolean
return GetSpellAbilityId()==('A06P')
endfunction
function ZV5 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(XO))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1
endfunction
function ZW5 takes nothing returns nothing
local unit target=GetEnumUnit()
local unit dummy=CreateUnit(GetOwningPlayer(XO),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,('A0JE'))
call SetUnitAbilityLevel(dummy,('A0JE'),YO)
call IssueTargetOrder(dummy,"slow",target)
endfunction
function ZX5 takes unit dummy,unit SFI returns nothing
local group Z51=NTI()
local boolexpr QL1=Condition(function ZV5)
set XO=SFI
call GroupEnumUnitsInRange(Z51,GetUnitX(dummy),GetUnitY(dummy),675,QL1)
call ForGroup(Z51,function ZW5)
call NSI(Z51)
endfunction
function ZY5 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger((t))
elseif GetTriggerEvalCount(t)>32 then
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger((t))
call PJI((LoadUnitHandle(LY,(handle_id),(14))))
else
call SetUnitAnimation(dummy,"birth")
set SFI=(LoadUnitHandle(LY,(handle_id),(14)))
set YO=GetTriggerExecCount(t)*GetUnitAbilityLevel(SFI,('A06P'))/2
call ZX5(dummy,SFI)
endif
set t=null
set dummy=null
set SFI=null
endfunction
function ZJ5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location BFO=GetSpellTargetLoc()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetLocationX(BFO)
local real y=GetLocationY(BFO)
local unit dummy=CreateUnit(GetOwningPlayer(SFI),('e01G'),x,y,0)
call RemoveLocation(BFO)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddAction(t,function ZY5)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
endfunction
function NC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddAction(t,function ZJ5)
call TriggerAddCondition(t,Condition(function ZZ5))
call Q1I(('A0JE'))
endfunction
constant function FatalBonds_RawCode takes nothing returns integer
return 'A0J5'
endfunction
constant function FatalBonds_IconAbility takes nothing returns integer
return 'A0J9'
endfunction
constant function FatalBonds_Icon takes nothing returns integer
return 'A0P2'
endfunction
function ZK5 takes nothing returns boolean
return GetSpellAbilityId()==('A0J5')
endfunction
function ZL5 takes nothing returns nothing
call AddSkill(GetEnumUnit(),('A0P2'))
endfunction
function ZM5 takes nothing returns nothing
call UnitRemoveAbility(GetEnumUnit(),('A0P2'))
endfunction
function ZN5 takes unit ZS5,unit ZT5 returns nothing
if ZS5!=null and ZT5!=null then
call UGI("CLPB",GetUnitX(ZS5),GetUnitY(ZS5),GetUnitX(ZT5),GetUnitY(ZT5),0.7,0.1,0.9,1,0.3)
endif
endfunction
function ZR5 takes nothing returns nothing
local unit SFI=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))
local real PAI=0.25*GetEventDamage()
set PAI=QCI(PAI,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE))
if GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)>1 and GetEnumUnit()!=GetTriggerUnit()then
if GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)<PAI then
call Damage(SFI,GetEnumUnit(),3,PAI)
else
call A41(GetEnumUnit(),PAI)
endif
endif
endfunction
function ZP5 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group Z51=(LoadGroupHandle(LY,(handle_id),(220)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call ForGroup(Z51,function ZM5)
call FlushChildHashtable(LY,(handle_id))
call NSI(Z51)
call FlushTrigger((t))
elseif GetEventDamage()>10 and GetEventDamage()<6000 then
call DisableTrigger(t)
call ForGroup(Z51,function ZR5)
call EnableTrigger(t)
endif
endfunction
function ZQ5 takes nothing returns boolean
return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and GetUnitState(GetFilterUnit(),UNIT_STATE_LIFE)>1
endfunction
function ZU5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local group Z51=NTI()
local integer level=GetUnitAbilityLevel(SFI,('A0J5'))
local boolexpr QL1=Condition(function ZQ5)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer i=2
local group XG4=NTI()
local unit array V05
local string VI5="Abilities\\Spells\\Undead\\Curse\\CurseTarget.mdl"
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call ZN5(SFI,target)
call U5I(VI5,target,"overhead",25)
set V05[1]=target
call SaveUnitHandle(LY,(handle_id),(246),(V05[1]))
call TriggerRegisterUnitEvent(t,V05[1],EVENT_UNIT_DAMAGED)
call GroupEnumUnitsInRange(Z51,GetUnitX(target),GetUnitY(target),700+25,QL1)
call GroupRemoveUnit(Z51,target)
call GroupAddUnit(XG4,target)
call SaveGroupHandle(LY,(handle_id),(220),(XG4))
loop
exitwhen i>(2+level)or FirstOfGroup(Z51)==null
set V05[i]=AU1(Z51,GetUnitX(target),GetUnitY(target))
call ZN5(V05[i-1],V05[i])
call TriggerRegisterUnitEvent(t,V05[i],EVENT_UNIT_DAMAGED)
call GroupAddUnit(XG4,V05[i])
call GroupRemoveUnit(Z51,V05[i])
call U5I(VI5,V05[i],"overhead",25)
set i=i+1
endloop
call SaveInteger(LY,(handle_id),(245),(i-1))
set YO=GetUnitAbilityLevel(SFI,('A0J5'))
call ForGroup(XG4,function ZL5)
call TriggerRegisterTimerEvent(t,25,false)
call TriggerAddAction(t,function ZP5)
call NSI(Z51)
endfunction
function ND1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ZK5))
call TriggerAddAction(t,function ZU5)
call Q1I(('A0J9'))
endfunction
function V15 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A0AS')
if GetTriggerEvalCount(t)>11 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A17K')
call UnitRemoveAbility(target,'B0AP')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call Damage(hero,target,1,level*10+5)
endif
set hero=null
set target=null
set t=null
return false
endfunction
function VO5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A0AS')
if GetTriggerEvalCount(t)>11 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A0P0')
call UnitRemoveAbility(target,'B073')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call QUI(target,level*10+5)
endif
set hero=null
set target=null
set t=null
return false
endfunction
function V25 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
if IsUnitAlly(target,GetOwningPlayer(hero))then
call TriggerAddCondition(t,Condition(function VO5))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Items\\StaffOfSanctuary\\Staff_Sanctuary_Target.mdl",target,"chest")))
call AddSkill(target,'A0P0')
elseif CanResistSkill(GetSpellTargetUnit())==false then
call TriggerAddCondition(t,Condition(function V15))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\Voodoo\\VoodooAuraTarget.mdl",target,"overhead")))
call AddSkill(target,'A17K')
endif
set hero=null
set target=null
set t=null
endfunction
function V35 takes nothing returns boolean
if GetSpellAbilityId()=='A0AS' then
call V25()
endif
return false
endfunction
function NE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function V35))
call Q1I('A0P0')
call Q1I('A17K')
set t=null
endfunction
function V45 takes nothing returns nothing
call Damage(W6I,GetEnumUnit(),1,20+10*W7I)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Immolation\\ImmolationDamage.mdl",GetEnumUnit(),"head"))
endfunction
function V55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level
local integer RII=GetUnitTypeId(hero)
local group g
if RII=='n00U' or RII=='n0KU' then
set level=1
elseif RII=='n00Y' or RII=='n0KV' then
set level=2
elseif RII=='n00Z' or RII=='n0KW' then
set level=3
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set GK=hero
set W6I=hero
set W7I=level
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),325,Condition(function CA1))
call ForGroup(g,function V45)
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function V65 takes unit u returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function V55))
call SaveUnitHandle(LY,(handle_id),(2),(u))
set t=null
endfunction
function V75 takes nothing returns boolean
local integer RII=GetUnitTypeId(GetTriggerUnit())
if RII=='n00U' or RII=='n0KU' or RII=='n00Y' or RII=='n0KV' or RII=='n00Z' or RII=='n0KW' then
call V65(GetTriggerUnit())
endif
return false
endfunction
function V85 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real BA3=(LoadReal(LY,(handle_id),(191)))
local real BB3=(LoadReal(LY,(handle_id),(192)))
local integer level=GetUnitAbilityLevel(hero,'S00U')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',BA3,BB3,0)
call AddSkill(dummy,'S00U')
call SetUnitAbilityLevel(dummy,'S00U',level)
call IssuePointOrderById(dummy,852224,x,y)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set hero=null
set dummy=null
set t=null
return false
endfunction
function V95 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.3,false)
call TriggerAddCondition(t,Condition(function V85))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetSpellTargetX())*1.0))
call SaveReal(LY,(handle_id),(7),((GetSpellTargetY())*1.0))
call SaveReal(LY,(handle_id),(191),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(192),((GetUnitY(hero))*1.0))
set hero=null
set t=null
endfunction
function VA5 takes nothing returns boolean
if GetSpellAbilityId()=='S00U' and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true then
call V95()
endif
return false
endfunction
function NF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VA5))
set t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,GetWorldBounds())
call TriggerAddCondition(t,Condition(function V75))
set t=null
endfunction
function VB5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetUnitAbilityLevel(SFI,'BHfs')==0 then
call UnitRemoveAbility(SFI,'A0C9')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
return false
endfunction
function VC5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
call AddSkill(SFI,'A0C9')
call SetUnitAbilityLevel(SFI,'A0C9',GetUnitAbilityLevel(SFI,'A0CA'))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function VB5))
set SFI=null
set t=null
endfunction
function VD5 takes nothing returns boolean
if GetSpellAbilityId()=='A0CA' then
call VC5()
endif
return false
endfunction
function MV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VD5))
endfunction
function VE5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitState((LoadUnitHandle(LY,(handle_id),(26))),UNIT_STATE_MANA,(LoadReal(LY,(handle_id),(242))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function VF5 takes unit u,real VG5 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function VE5))
call SaveUnitHandle(LY,(handle_id),(26),(u))
call SaveReal(LY,(handle_id),(242),((VG5)*1.0))
set t=null
endfunction
function VH5 takes nothing returns boolean
return GetSpellAbilityId()=='A0CT'
endfunction
function VZ5 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggerUnit())
local real D14=QDI((LoadReal(LY,(handle_id),(7200+1))),1)
local real OA2=QDI((LoadReal(LY,(handle_id),(7250+1))),1)
local real x=(LoadReal(LY,(handle_id),(7300+1)))
local real y=(LoadReal(LY,(handle_id),(7350+1)))
local unit PKI=GetTriggerUnit()
if(LoadReal(LY,(handle_id),(7200+1)))>1 and GetUnitState(PKI,UNIT_STATE_LIFE)>1 then
call AddSpecialEffect("Abilities\\Spells\\NightElf\\Blink\\BlinkTarget.mdl",GetUnitX(PKI),GetUnitY(PKI))
call MUSetUnitX(PKI,x)
call MUSetUnitY(PKI,y)
call SetUnitState(PKI,UNIT_STATE_LIFE,D14)
call SetUnitState(PKI,UNIT_STATE_MANA,OA2)
call UnitRemoveBuffs(PKI,false,true)
call EO1(PKI)
call VF5(PKI,OA2)
endif
endfunction
function MW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VH5))
call TriggerAddAction(t,function VZ5)
endfunction
function VV5 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local unit PKI=(LoadUnitHandle(LY,(GetHandleId(t)),(221)))
local integer handle_id=GetHandleId(PKI)
local integer TGI=1
local integer THI=10
loop
exitwhen TGI>THI
call SaveReal(LY,(handle_id),(7300+(TGI-1)),(((LoadReal(LY,(handle_id),(7300+(TGI)))))*1.0))
call SaveReal(LY,(handle_id),(7350+(TGI-1)),(((LoadReal(LY,(handle_id),(7350+(TGI)))))*1.0))
call SaveReal(LY,(handle_id),(7200+(TGI-1)),(((LoadReal(LY,(handle_id),(7200+(TGI)))))*1.0))
call SaveReal(LY,(handle_id),(7250+(TGI-1)),(((LoadReal(LY,(handle_id),(7250+(TGI)))))*1.0))
set TGI=TGI+1
endloop
call SaveReal(LY,(handle_id),(7300+10),((GetUnitX(PKI))*1.0))
call SaveReal(LY,(handle_id),(7350+10),((GetUnitY(PKI))*1.0))
call SaveReal(LY,(handle_id),(7200+10),((GetUnitState(PKI,UNIT_STATE_LIFE))*1.0))
call SaveReal(LY,(handle_id),(7250+10),((GetUnitState(PKI,UNIT_STATE_MANA))*1.0))
endfunction
function TimeLapseLearn_Conditions takes nothing returns boolean
return GetLearnedSkill()=='A0CT' and IsUnitIllusion(GetTriggerUnit())==false
endfunction
function KO4 takes nothing returns nothing
local unit PKI=GK
local integer level=GetUnitAbilityLevel(PKI,'A0CT')
local trigger t
set t=CreateTrigger()
call TriggerRegisterTimerEventPeriodic(t,0.50)
call TriggerAddAction(t,function VV5)
call SaveUnitHandle(LY,(GetHandleId(t)),(221),(PKI))
endfunction
function MX1 takes nothing returns nothing
endfunction
function VW5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real d=(LoadReal(LY,(handle_id),(138)))
local real VX5=(LoadReal(LY,(GetHandleId(hero)),(508)))-d
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call SaveReal(LY,(GetHandleId(hero)),(508),((VX5)*1.0))
call G21(hero,R2I(VX5/100.0*(0.3*GetUnitAbilityLevel(hero,'A1Q7'))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function VY5 takes unit hero,real d returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real VX5=(LoadReal(LY,(GetHandleId(hero)),(508)))+d
local fogmodifier I31=CreateFogModifierRadius(GetOwningPlayer(hero),FOG_OF_WAR_VISIBLE,GetUnitX(hero),GetUnitY(hero),400,true,true)
call FogModifierStart(I31)
call SaveReal(LY,(GetHandleId(hero)),(508),((VX5)*1.0))
call G21(hero,R2I(VX5/100.0*(0.6*GetUnitAbilityLevel(hero,'A1Q7'))))
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function VW5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(138),((d)*1.0))
call SaveFogModifierHandle(LY,(handle_id),(42),(I31))
set t=null
endfunction
function VJ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real IO3=GetUnitX(hero)
local real I23=GetUnitY(hero)
local real d=QNI(II3,I13,IO3,I23)
if d<1500 then
call VY5(hero,d)
else
call VY5(hero,1500)
endif
call SaveReal(LY,(handle_id),(23),((IO3)*1.0))
call SaveReal(LY,(handle_id),(24),((I23)*1.0))
set t=null
set hero=null
return false
endfunction
function VK5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function VJ5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(23),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(hero))*1.0))
call SaveReal(LY,(GetHandleId(hero)),(508),((0)*1.0))
set t=null
set hero=null
endfunction
function VL5 takes nothing returns boolean
if GetLearnedSkill()=='A1Q7' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A1Q7')==1 then
call VK5()
endif
return false
endfunction
function Register_EchoStep takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function VL5))
set t=null
endfunction
function VM5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(target,'A1QZ')
call SaveInteger(LY,(GetHandleId((target))),((4290)),(2))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()==target then
call KillUnit(hero)
endif
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call SetUnitAbilityLevel(target,'A1QZ',GetUnitAbilityLevel(target,'A1QZ')+1)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\SkeletalMageMissile\\SkeletalMageMissile.mdl",target,"chest"))
endif
else
call MUSetUnitX(hero,GetUnitX(target)-40)
call MUSetUnitY(hero,GetUnitY(target)-40)
if BU1(target)and IsUnitVisible(target,GetOwningPlayer(hero))==false then
call KillUnit(hero)
elseif ModuloInteger(GetTriggerEvalCount(t),5)==0 then
call IssueTargetOrder(hero,"attack",target)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function VN5 takes unit VS5,unit target,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UnitRemoveAbility(VS5,'Avul')
call SaveUnitHandle(LY,(handle_id),(2),(VS5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(target,'A1QZ')
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,VS5,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function VM5))
call TriggerEvaluate(t)
call UnitApplyTimedLife(VS5,'BTLF',12+2*level)
set t=null
endfunction
function VT5 takes nothing returns boolean
return(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4290))))==1)==false and(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))==true or BU1(GetFilterUnit())==false)
endfunction
function VR5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g
local integer i=1
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real a=(LoadReal(LY,(handle_id),(137)))
local unit VS5
local unit target
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
set x=PTI(x+18*Cos(a))
set y=PUI(y+18*Sin(a))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
if GetTriggerEvalCount(t)>166 then
loop
exitwhen i>12
if(LoadBoolean(LY,(handle_id),(511+i-1)))==false then
call KillUnit((LoadUnitHandle(LY,(handle_id),(393+i-1))))
endif
set i=i+1
endloop
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,x,y,400,Condition(function VT5))
loop
exitwhen i>12
if(LoadBoolean(LY,(handle_id),(511+i-1)))==false then
set VS5=(LoadUnitHandle(LY,(handle_id),(393+i-1)))
set x=(LoadReal(LY,(handle_id),(549+i-1)))
set y=(LoadReal(LY,(handle_id),(567+i-1)))
set x=PTI(x+18*Cos(a))
set y=PUI(y+18*Sin(a))
call SaveReal(LY,(handle_id),(549+i-1),((x)*1.0))
call SaveReal(LY,(handle_id),(567+i-1),((y)*1.0))
call MUSetUnitX(VS5,x)
call MUSetUnitY(VS5,y)
set target=FirstOfGroup(g)
if target!=null then
call GroupRemoveUnit(g,target)
call SaveInteger(LY,(GetHandleId((target))),((4290)),(1))
call SaveBoolean(LY,(handle_id),(511+i-1),(true))
call VN5(VS5,target,GetUnitAbilityLevel(hero,'A1QW'))
endif
endif
set i=i+1
endloop
call NSI(g)
set g=null
set VS5=null
set target=null
endif
set t=null
set hero=null
return false
endfunction
function VP5 takes nothing returns nothing
local location point=GetSpellTargetLoc()
local real QJI=GetLocationX(point)
local real QKI=GetLocationY(point)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real a=UEI(x,y,QJI,QKI)*bj_DEGTORAD
local unit dummy
local real IV1=PTI(x+3000*Cos(a))
local real IW1=PUI(y+3000*Sin(a))
local integer i=1
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real DJ1
local integer level=GetUnitAbilityLevel(hero,'A1QW')
local integer RII
call RemoveLocation(point)
if level==1 then
set RII='u01K'
elseif level==2 then
set RII='u01H'
elseif level==3 then
set RII='u01J'
elseif level==4 then
set RII='u01L'
endif
loop
exitwhen i>12
set dummy=CreateUnit(GetOwningPlayer(hero),RII,x+GetRandomInt(-300,300),y+GetRandomInt(-300,300),a*bj_RADTODEG)
call SaveUnitHandle(LY,(handle_id),(393+i-1),(dummy))
call SaveBoolean(LY,(handle_id),(511+i-1),(false))
call SaveReal(LY,(handle_id),(549+i-1),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(567+i-1),((GetUnitY(dummy))*1.0))
set i=i+1
endloop
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function VR5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(47),((IV1)*1.0))
call SaveReal(LY,(handle_id),(48),((IW1)*1.0))
set hero=null
set dummy=null
set point=null
set t=null
endfunction
function VQ5 takes nothing returns boolean
if GetSpellAbilityId()=='A1QW' then
call VP5()
endif
return false
endfunction
function MY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VQ5))
call A51('u01K')
call A51('u01H')
call A51('u01J')
call A51('u01L')
call Q1I('A1QZ')
set t=null
endfunction
function VU5 takes unit hero,unit WNO,unit IN3,integer level,boolean IS3 returns real
local unit dummy=CreateUnit(GetOwningPlayer(IN3),'e00E',GetUnitX(WNO),GetUnitY(WNO),0)
if IS3 then
call AddSkill(dummy,'A0WY')
else
call AddSkill(dummy,'A0NL')
endif
call IssueTargetOrder(dummy,"thunderbolt",IN3)
if IsUnitType(IN3,UNIT_TYPE_HERO)==false then
call PDI(hero,IN3,1,50+25*level,0.4)
else
call PDI(hero,IN3,1,50,0.4)
endif
if IS3 then
return((GetUnitX(IN3)-GetUnitX(WNO))*(GetUnitX(IN3)-GetUnitX(WNO))+(GetUnitY(IN3)-GetUnitY(WNO))*(GetUnitY(IN3)-GetUnitY(WNO)))/1000000
endif
set dummy=null
return((GetUnitX(IN3)-GetUnitX(WNO))*(GetUnitX(IN3)-GetUnitX(WNO))+(GetUnitY(IN3)-GetUnitY(WNO))*(GetUnitY(IN3)-GetUnitY(WNO)))/360000
endfunction
function W05 takes unit hero,unit WNO returns unit
local group g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(WNO),GetUnitY(WNO),600,Condition(function C91))
call GroupRemoveUnit(g,WNO)
set GK=GroupPickRandomUnit(g)
call NSI(g)
set g=null
return GK
endfunction
function WI5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer W15=(LoadInteger(LY,(handle_id),(391)))
local unit WNO=NYI(W15)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local unit IN3
local real M5I
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if NPI<(level*2+1)then
set IN3=W05(hero,WNO)
if IN3!=null then
set M5I=VU5(hero,WNO,IN3,level,false)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(391),(NKI(IN3)))
call SaveInteger(LY,(handle_id),(34),(NPI+1))
call TriggerRegisterTimerEvent(t,M5I+0.4,false)
call TriggerAddCondition(t,Condition(function WI5))
endif
endif
call NXI(W15)
set t=null
set hero=null
set WNO=null
set IN3=null
return false
endfunction
function WO5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local unit IU3=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(SFI,'A0NM')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real M5I=VU5(SFI,SFI,IU3,level,true)
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(391),(NKI(IU3)))
call SaveInteger(LY,(handle_id),(34),(1))
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerAddCondition(t,Condition(function WI5))
set SFI=null
set IU3=null
set t=null
endfunction
function W25 takes nothing returns boolean
if GetSpellAbilityId()=='A0NM' and CanResistSkill(GetSpellTargetUnit())==false then
call WO5()
endif
return false
endfunction
function N01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function W25))
set t=null
endfunction
function W35 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local integer level=GetUnitAbilityLevel(SFI,'A0NE')
call UnitRemoveAbility(SFI,'A0NE')
call AddSkill(SFI,'A0NE')
call SetUnitAbilityLevel(SFI,'A0NE',level)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function W45 takes unit target,integer level returns nothing
local real HJ3=(8+level*8)/3
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+HJ3)
endfunction
function W55 takes nothing returns boolean
if(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))then
call W45(GetFilterUnit(),UJ)
endif
return false
endfunction
function W65 takes unit SFI returns nothing
local integer level=GetUnitAbilityLevel(SFI,'A0NE')
local group g=NTI()
set GK=SFI
set UJ=level
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),525,Condition(function W55))
call NSI(g)
set g=null
endfunction
function W75 takes unit SFI returns nothing
local integer level=GetUnitAbilityLevel(SFI,'A0NE')
local real W85=4+4*level
call SetUnitState(SFI,UNIT_STATE_MANA,GetUnitState(SFI,UNIT_STATE_MANA)-(W85/3))
if GetUnitState(SFI,UNIT_STATE_MANA)<W85 then
if((LoadInteger(LY,(GetHandleId((SFI))),((4265))))==1)==false then
call IssueImmediateOrder(SFI,"unimmolation")
endif
endif
endfunction
function W95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
if GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if GetIssuedOrderId()==852178 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function W35))
endif
else
call W65(SFI)
call W75(SFI)
endif
set t=null
return false
endfunction
function WA5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,0.33,true)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function W95))
set SFI=null
set t=null
endfunction
function WB5 takes nothing returns boolean
if GetSpellAbilityId()=='A0NE' then
call WA5()
endif
return false
endfunction
function N11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function WB5))
set t=null
endfunction
function WC5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A0NO')
local integer NPI=GetTriggerEvalCount(t)
local real WD5=(LoadReal(LY,(handle_id),(392)))
local real H84=0
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if NPI==4 or NPI==8 or NPI==12 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
if NPI==12 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif NPI==4 or NPI==8 then
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\NetherInferno.mdx",target,"origin")))
endif
set H84=(0.08+level*0.08)*QDI(WD5-GetUnitState(target,UNIT_STATE_LIFE),0)
if H84>0 then
call UYI("+"+I2S(R2I(H84)),2,target,0.023,68,0,187,216)
endif
endif
call Damage(hero,target,1,5*level+H84)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function WE5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
call DestroyEffect(AddSpecialEffectTarget("effects\\NetherInferno.mdx",target,"origin"))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function WC5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(392),((GetUnitState(target,UNIT_STATE_LIFE))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\NetherInferno.mdx",target,"origin")))
set t=null
set hero=null
set target=null
endfunction
function WF5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A0NO')
call GroupEnumUnitsInRange(g,x,y,180+25,Condition(function D01))
call ForGroup(g,function WE5)
call NSI(g)
call RemoveLocation(point)
set point=null
set g=null
endfunction
function WG5 takes nothing returns boolean
if GetSpellAbilityId()=='A0NO' then
call WF5()
endif
return false
endfunction
function NI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function WG5))
set t=null
endfunction
function WH5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()!=EVENT_UNIT_SPELL_ENDCAST then
call PJI(hero)
endif
set hero=null
set t=null
return false
endfunction
function WZ5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function WH5))
set t=null
set hero=null
endfunction
function WV5 takes nothing returns boolean
if GetSpellAbilityId()=='A0NT' or GetSpellAbilityId()=='A0NX' then
call WZ5()
endif
return false
endfunction
function WW5 takes nothing returns boolean
if GetUnitTypeId(GetSummonedUnit())=='o000' or GetUnitTypeId(GetSummonedUnit())=='o001' or GetUnitTypeId(GetSummonedUnit())=='o00A' or GetUnitTypeId(GetSummonedUnit())=='o00X' then
call SCI(GetSummoningUnit(),4265,8)
endif
return false
endfunction
function NO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function WW5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function WV5))
set t=null
endfunction
function WX5 takes nothing returns boolean
local integer id=0
local unit target
local real GW1=(TimerGetElapsed(M))
local real mp
local real hp
loop
exitwhen id>12
set target=K1[id]
if target!=null and GetUnitAbilityLevel(target,'B0CD')==0 and W8I[id]>GW1 then
set W8I[id]=0
endif
if target!=null and GetUnitAbilityLevel(target,'B0CD')>0 then
if W8I[id]>GW1 and IsUnitDead(target)==false then
set hp=GetUnitState(target,UNIT_STATE_LIFE)
set mp=GetUnitState(target,UNIT_STATE_MANA)
if hp<W9I[id]then
set W9I[id]=hp
else
endif
if mp<WAI[id]then
set WAI[id]=mp
else
endif
call SetUnitState(target,UNIT_STATE_LIFE,W9I[id])
set WCI[id]=WCI[id]+1
if WCI[id]==10 then
set WCI[id]=0
if WDI[id]==1 then
call Damage(WBI[id],target,1,12.5)
elseif WDI[id]==2 then
call Damage(WBI[id],target,1,20)
elseif WDI[id]==3 then
call Damage(WBI[id],target,1,32)
endif
endif
elseif W8I[id]>GW1 and IsUnitDead(target)==true then
set W8I[id]=0
set W9I[id]=9999
set WAI[id]=9999
endif
if(GetUnitAbilityLevel(target,'B0CD')>0 and W8I[id]<GW1)then
call UnitRemoveAbility(target,'A1JA')
call UnitRemoveAbility(target,'B0CD')
call UnitRemoveAbility(target,'A1LD')
endif
endif
set id=id+1
endloop
set target=null
return false
endfunction
function WY5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit dummy
if GetUnitAbilityLevel(target,'B0CD')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetOwningPlayer(target)!=GetOwningPlayer(GetEventDamageSource())and GetUnitState(target,UNIT_STATE_MAX_LIFE)*(0.09+0.01*level)>GetUnitState(target,UNIT_STATE_LIFE)and((LoadInteger(LY,(GetHandleId((target))),((2485))))==1)==false then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A1JA')
call UnitRemoveAbility(target,'B0CD')
call UnitRemoveAbility(target,'A1LD')
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"overhead"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"origin"))
set dummy=CreateUnit(GetOwningPlayer(GetEventDamageSource()),'e00E',0,0,0)
call UnitRemoveBuffs(target,true,true)
call UnitRemoveAbility(target,'Aetl')
call UnitDamageTarget(dummy,target,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
set dummy=null
endif
set t=null
set target=null
return false
endfunction
function WJ5 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A1MI')
local integer id=GetPlayerId(GetOwningPlayer(target))
local trigger t
local integer handle_id
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2QE')
endif
if level>0 and IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitIllusion(target)==false and V51(GetUnitTypeId(target))==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function WY5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call AddSkill(target,'A1JA')
call AddSkill(target,'A1LD')
if GetUnitAbilityLevel(hero,'A2QE')>0 then
set W8I[id]=(TimerGetElapsed(M))+WEI
else
set W8I[id]=(TimerGetElapsed(M))+7+level
endif
set W9I[id]=GetUnitState(target,UNIT_STATE_LIFE)
set WAI[id]=GetUnitState(target,UNIT_STATE_MANA)
set WBI[id]=hero
set WDI[id]=level
endif
set t=null
endfunction
function WK5 takes nothing returns nothing
local unit hero=GK
local unit target=GetEnumUnit()
local integer id=GetPlayerId(GetOwningPlayer(target))
local integer level=GetUnitAbilityLevel(hero,'A1MI')
local trigger t
local integer handle_id
if IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitIllusion(target)==false and GetUnitAbilityLevel(target,'B0CD')==0 and V51(GetUnitTypeId(target))==false then
if GetUnitAbilityLevel(hero,'A2QE')>0 then
set W8I[id]=WEI
else
set W8I[id]=(TimerGetElapsed(M))+7+level
endif
call AddSkill(target,'A1JA')
call AddSkill(target,'A1LD')
set W9I[id]=GetUnitState(target,UNIT_STATE_LIFE)
set WAI[id]=GetUnitState(target,UNIT_STATE_MANA)
set WBI[id]=hero
set WDI[id]=level
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function WY5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
set t=null
endif
set hero=null
set target=null
endfunction
function WL5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x0=(LoadReal(LY,(handle_id),(282)))
local real y0=(LoadReal(LY,(handle_id),(283)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,x0,y0,825,Condition(function DO1))
call ForGroup(g,function WK5)
call NSI(g)
if GetTriggerEvalCount(t)>120 then
call KillUnit((LoadUnitHandle(LY,(handle_id),(434))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set g=null
return false
endfunction
function Gust takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real RM2=GetUnitFacing(hero)
local real x2
local real y2
local unit WM5
local unit X44
local unit WN5
local unit WS5
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1MI')
call RemoveLocation(point)
set x2=x+350*Cos(RM2*bj_DEGTORAD)
set y2=y+350*Sin(RM2*bj_DEGTORAD)
set WM5=CreateUnit(GetOwningPlayer(hero),'h0B3',x,y,RM2)
set x2=x+350*Cos(RM2*bj_DEGTORAD)
set y2=y-350*Sin(RM2*bj_DEGTORAD)
set x2=x-350*Cos(RM2*bj_DEGTORAD)
set y2=y+350*Sin(RM2*bj_DEGTORAD)
set x2=x-350*Cos(RM2*bj_DEGTORAD)
set y2=y-350*Sin(RM2*bj_DEGTORAD)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function WL5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(282),((x)*1.0))
call SaveReal(LY,(handle_id),(283),((y)*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(434),(WM5))
set point=null
set hero=null
set WM5=null
set X44=null
set WN5=null
set WS5=null
set t=null
endfunction
function Gust_Main takes nothing returns boolean
if GetSpellAbilityId()=='A1N8' then
endif
return false
endfunction
function RO1 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer id=0
local integer i=0
local player p
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function WX5))
loop
exitwhen id>12
set W9I[id]=9999
set WAI[id]=9999
set id=id+1
endloop
loop
exitwhen i>5
set p=BO[i]
call SetPlayerAbilityAvailable(p,'A1LD',false)
set p=CO[i]
call SetPlayerAbilityAvailable(p,'A1LD',false)
set i=i+1
endloop
set t=null
endfunction
function WT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real LVO=(LoadReal(LY,(GetHandleId(hero)),(822)))
if LVO+0.5<(TimerGetElapsed(M))or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if BJ1(GetEnumUnit())then
return false
endif
if GetUnitAbilityLevel(hero,'A1HZ')>0 then
call UnitRemoveAbility(hero,'A1HZ')
call UnitRemoveAbility(hero,'B0C5')
endif
if GetUnitAbilityLevel(hero,'A1I4')>0 then
call UnitRemoveAbility(hero,'A1I4')
call UnitRemoveAbility(hero,'B0C5')
endif
if GetUnitAbilityLevel(hero,'A1I3')>0 then
call UnitRemoveAbility(hero,'A1I3')
call UnitRemoveAbility(hero,'B0C5')
endif
if GetUnitAbilityLevel(hero,'A1I6')>0 then
call UnitRemoveAbility(hero,'A1I6')
call UnitRemoveAbility(hero,'B0C5')
endif
endif
set t=null
set hero=null
return false
endfunction
function WR5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterDeathEvent(t,GetEnumUnit())
call TriggerAddCondition(t,Condition(function WT5))
call SaveUnitHandle(LY,(handle_id),(2),(GetEnumUnit()))
set t=null
endfunction
function WP5 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if RKI(GetEnumUnit())==false then
if WFI==1 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1HZ')==0 then
call UnitRemoveAbility(GetEnumUnit(),'B0C5')
call AddSkill(GetEnumUnit(),'A1HZ')
call SaveReal(LY,(GetHandleId(GetEnumUnit())),(822),(((TimerGetElapsed(M)))*1.0))
endif
elseif WFI==2 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1I4')==0 then
call UnitRemoveAbility(GetEnumUnit(),'B0C5')
call AddSkill(GetEnumUnit(),'A1I4')
call SaveReal(LY,(GetHandleId(GetEnumUnit())),(822),(((TimerGetElapsed(M)))*1.0))
endif
elseif WFI==3 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1I3')==0 then
call UnitRemoveAbility(GetEnumUnit(),'B0C5')
call AddSkill(GetEnumUnit(),'A1I3')
call SaveReal(LY,(GetHandleId(GetEnumUnit())),(822),(((TimerGetElapsed(M)))*1.0))
endif
elseif WFI==4 then
if GetUnitAbilityLevel(GetEnumUnit(),'A1I6')==0 then
call UnitRemoveAbility(GetEnumUnit(),'B0C5')
call AddSkill(GetEnumUnit(),'A1I6')
call SaveReal(LY,(GetHandleId(GetEnumUnit())),(822),(((TimerGetElapsed(M)))*1.0))
endif
endif
endif
endfunction
function WQ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group RG3=(LoadGroupHandle(LY,(handle_id),(340)))
local real x=GetUnitX(dummy)
local real y=GetUnitY(dummy)
local group g=NTI()
local group g2
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call ForGroup(RG3,function WR5)
call NSI(g)
call NSI(RG3)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(dummy,false)
set t=null
set hero=null
set dummy=null
set RG3=null
return false
endif
set WGI=hero
set WFI=GetUnitAbilityLevel(hero,'A1HS')
set GK=hero
call GroupEnumUnitsInRange(g,x,y,300,Condition(function CA1))
call GroupRemoveGroup(g,RG3)
call ForGroup(RG3,function WR5)
call ForGroup(g,function WP5)
call SaveGroupHandle(LY,(handle_id),(340),(g))
call NSI(RG3)
set t=null
set hero=null
set dummy=null
set RG3=null
return false
endfunction
function WU5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local integer level=GetUnitAbilityLevel(hero,'A1HS')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'n0HQ',x,y,0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UnitApplyTimedLife(dummy,'BTLF',16)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,dummy,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function WQ5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveGroupHandle(LY,(handle_id),(340),(NTI()))
call RemoveLocation(point)
set hero=null
set point=null
endfunction
function X05 takes nothing returns boolean
if GetSpellAbilityId()=='A1HS' then
call WU5()
endif
return false
endfunction
function R01 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer i=0
local player p
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function X05))
set t=null
loop
exitwhen i>5
set p=BO[i]
call SetPlayerAbilityAvailable(p,'A1HZ',false)
call SetPlayerAbilityAvailable(p,'A1I4',false)
call SetPlayerAbilityAvailable(p,'A1I3',false)
call SetPlayerAbilityAvailable(p,'A1I6',false)
set p=CO[i]
call SetPlayerAbilityAvailable(p,'A1HZ',false)
call SetPlayerAbilityAvailable(p,'A1I4',false)
call SetPlayerAbilityAvailable(p,'A1I3',false)
call SetPlayerAbilityAvailable(p,'A1I6',false)
set i=i+1
endloop
endfunction
function XI5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit dummy
local real PAI=(100+50*level)/4
if GetTriggerEventId()==EVENT_UNIT_DEATH or QNI(x,y,GetUnitX(target),GetUnitY(target))>765 or GetUnitAbilityLevel(target,'B0CC')==0 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call UnitRemoveAbility(target,'A1J9')
call UnitRemoveAbility(target,'B0CC')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)==(10*0.8)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\ShivasEnchantment.mdx",target,"overhead")))
call Damage(hero,target,1,PAI)
elseif GetTriggerEvalCount(t)==(10*1.6)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\ShivasEnchantment.mdx",target,"overhead")))
call Damage(hero,target,1,PAI)
elseif GetTriggerEvalCount(t)==(10*2.5)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\ShivasEnchantment.mdx",target,"overhead")))
call Damage(hero,target,1,PAI)
elseif GetTriggerEvalCount(t)==(10*3.4)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call Damage(hero,target,1,PAI)
elseif GetTriggerEvalCount(t)>(10*3.9)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call UnitRemoveAbility(target,'A1J9')
call UnitRemoveAbility(target,'B0CC')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A1MJ')
call SetUnitAbilityLevel(dummy,'A1MJ',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
set dummy=null
endif
set t=null
set hero=null
set target=null
return false
endfunction
function X15 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1MG')
local string s="Doodads\\Cinematic\\GlowingRunes\\GlowingRunes4.mdl"
if GetLocalPlayer()==GetOwningPlayer(target)then
endif
call AddSkill(target,'A1J9')
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(6),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(target))*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\ShivasEnchantment.mdx",target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect(s,GetUnitX(target),GetUnitY(target))))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function XI5))
set hero=null
set target=null
set t=null
endfunction
function XO5 takes nothing returns boolean
if GetSpellAbilityId()=='A1MG' and CanResistSkill(GetSpellTargetUnit())==false then
call X15()
endif
return false
endfunction
function RI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XO5))
set t=null
endfunction
function X25 takes nothing returns nothing
local unit hero=WZI
local unit target=GetEnumUnit()
local integer level=WHI
call WJ5(hero,target)
call Damage(hero,target,1,150+100*level)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\PlasmaShot.mdl",target,"chest"))
set hero=null
set target=null
endfunction
function X35 takes nothing returns nothing
local unit hero=WZI
local unit target=GetEnumUnit()
local integer level=WHI
call WJ5(hero,target)
set hero=null
set target=null
endfunction
function X45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real CY3=(LoadReal(LY,(handle_id),(432)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real x=GetUnitX(IG1)+30*Cos(RM2)
local real y=GetUnitY(IG1)+30*Sin(RM2)
local group g
local fogmodifier I31
if QNI(x,y,QJI,QKI)<35 or x!=PTI(x)or y!=PUI(y)then
set x=QJI
set y=QKI
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
set I31=(LoadFogModifierHandle(LY,(handle_id),(440)))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
set I31=null
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(IG1)
set GK=hero
set WZI=hero
set WHI=level
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,CY3+25,Condition(function CA1))
call ForGroup(g,function X25)
call NSI(g)
set g=null
else
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
set GK=hero
set WZI=hero
set WHI=level
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,300,Condition(function CA1))
call ForGroup(g,function X35)
call NSI(g)
set g=null
endif
set t=null
set IG1=null
set hero=null
return false
endfunction
function X55 takes unit hero,real x,real y,real C54,effect FX,fogmodifier I31 returns nothing
local real RM2=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0B6',GetUnitX(hero),GetUnitY(hero),RM2*bj_RADTODEG)
local integer level=GetUnitAbilityLevel(hero,'A1MI')
local real CY3=QCI(25+250+25*C54*2,1000)
local real QWI=QNI(GetUnitX(hero),GetUnitY(hero),x,y)
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2QE')
endif
if IsUnitEnemy(IG1,GetLocalPlayer())and P0I(GetLocalPlayer())==false then
call UnitSetUsesAltIcon(IG1,true)
endif
call TriggerRegisterTimerEvent(t,QCI(2.0/(QWI/30),0.04),true)
call TriggerAddCondition(t,Condition(function X45))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(47),((x)*1.0))
call SaveReal(LY,(handle_id),(48),((y)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(432),((CY3)*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveFogModifierHandle(LY,(handle_id),(440),(I31))
call SaveEffectHandle(LY,(handle_id),(32),(FX))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1MI',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2QE',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1MN',false)
set t=null
set IG1=null
endfunction
function X65 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real x
local real y
local real C54=(TimerGetElapsed(M))-(LoadReal(LY,(handle_id),(431)))
local string s
local fogmodifier I31
local effect FX
local real X75=GetUnitX(IG1)+30*Cos(RM2)
local real X85=GetUnitY(IG1)+30*Sin(RM2)
set x=PTI(X75)
set y=PUI(X85)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A1MN')or x!=X75 or y!=X85 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call RemoveUnit(IG1)
set s=""
if IsPlayerAlly(GetOwningPlayer(hero),GetLocalPlayer())or P0I(GetLocalPlayer())then
set s="war3mapImported\\IceWindGroundFX.mdl"
endif
set I31=CreateFogModifierRadius(GetOwningPlayer(hero),FOG_OF_WAR_VISIBLE,x,y,500,true,true)
call FogModifierStart(I31)
set FX=AddSpecialEffect(s,x,y)
call X55(hero,x,y,C54,FX,I31)
set I31=null
set FX=null
endif
set t=null
set IG1=null
set hero=null
return false
endfunction
function X95 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'H0B8',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
if IsUnitEnemy(IG1,GetLocalPlayer())and P0I(GetLocalPlayer())==false then
call UnitSetUsesAltIcon(IG1,true)
endif
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(13),((a)*1.0))
call SaveReal(LY,(handle_id),(431),(((TimerGetElapsed(M)))*1.0))
call TriggerRegisterTimerEvent(t,0.02,true)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function X65))
call SetUnitColor(IG1,GetPlayerColor(Player(14)))
call RemoveLocation(point)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1MI',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2QE',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1MN',true)
call AddSkill(hero,'A1MN')
set hero=null
set point=null
set t=null
set IG1=null
endfunction
function XA5 takes nothing returns boolean
if GetSpellAbilityId()=='A1MI' or GetSpellAbilityId()=='A2QE' then
call X95()
endif
return false
endfunction
function R11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XA5))
set t=null
endfunction
function ChillingTouch_DPS takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A1HQ')
if GetTriggerEvalCount(t)==6 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call Damage(hero,target,1,8+2*level)
set t=null
set hero=null
set target=null
return false
endfunction
function XB5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer XC5=(LoadInteger(LY,(GetHandleId(hero)),(449)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and GetEventDamage()>1 then
call DisableTrigger(t)
if XC5>0 then
call SaveInteger(LY,(GetHandleId(hero)),(449),(XC5-1))
call UYI("+"+I2S(40+10*level),1,hero,0.024,100,200,255,255)
call Damage(hero,target,1,40+10*level)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function XD5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_ATTACKED or(LoadInteger(LY,(GetHandleId(hero)),(449)))==0 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call SaveInteger(LY,(GetHandleId(hero)),(449),(0))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A1HN')
call UnitRemoveAbility(hero,'B0CJ')
call UnitRemoveAbility(hero,'A1IP')
elseif GetAttacker()==hero and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and((LoadInteger(LY,(GetHandleId((hero))),((4289))))==1)==false then
call SCI(hero,4289,0.4)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.0,false)
call TriggerAddCondition(t,Condition(function XB5))
call SaveUnitHandle(LY,(handle_id),(17),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
endif
set t=null
set hero=null
return false
endfunction
function XE5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1HQ')
call AddSkill(target,'A1HN')
call AddSkill(target,'A1IP')
call SaveInteger(LY,(GetHandleId(target)),(449),(2+level))
call SaveUnitHandle(LY,(handle_id),(2),(target))
call SaveUnitHandle(LY,(handle_id),(19),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\FrostHands.mdx",target,"right,hand")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\FrostHands.mdx",target,"left,hand")))
call TriggerRegisterTimerEvent(t,30,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function XD5))
set hero=null
set target=null
set t=null
endfunction
function XF5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
call RemoveLocation(point)
call DestroyEffect(AddSpecialEffect("war3mapImported\\IcyWind.mdl",x,y))
call GroupEnumUnitsInRange(g,x,y,525+25,Condition(function CR1))
call GroupAddUnit(g,hero)
call ForGroup(g,function XE5)
call NSI(g)
set hero=null
set g=null
set point=null
endfunction
function XG5 takes nothing returns boolean
if GetSpellAbilityId()=='A1HQ' then
call XF5()
endif
return false
endfunction
function R21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XG5))
set t=null
endfunction
function XH5 takes nothing returns nothing
call Damage(WVI,GetEnumUnit(),1,(GetUnitAbilityLevel(WVI,'A1IM')*75)/10)
endfunction
function XZ5 takes unit hero returns nothing
local real DH1=(GetUnitAbilityLevel(hero,'A1IM')*75)/2
set DH1=DH1/10.0
if GetUnitState(hero,UNIT_STATE_LIFE)<=DH1*0.75 then
set DH1=GetUnitState(hero,UNIT_STATE_LIFE)/0.75-10
endif
call Damage(hero,hero,1,DH1)
endfunction
function XV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g
local real DH1
local unit dummy
local integer level=0
local integer NPI=GetTriggerEvalCount(t)
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
else
if GetTriggerEvalCount(t)==1 then
set dummy=CreateUnit(GetOwningPlayer(hero),'h0B2',x,y,0)
call UnitApplyTimedLife(dummy,'BTLF',1)
set dummy=null
call TriggerRegisterTimerEvent(t,0.1,true)
set g=NTI()
set WVI=hero
set GK=hero
call GroupEnumUnitsInRange(g,x,y,350,Condition(function CA1))
call ForGroup(g,function XH5)
call XZ5(hero)
call NSI(g)
else
if NPI==10 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set g=NTI()
set WVI=hero
set GK=hero
call GroupEnumUnitsInRange(g,x,y,350,Condition(function CA1))
call ForGroup(g,function XH5)
call XZ5(hero)
call NSI(g)
call EO1(hero)
call DU1(hero,0,0)
endif
endif
set t=null
set g=null
set hero=null
return false
endfunction
function XW5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real DH1=(GetUnitAbilityLevel(hero,'A1IM')*75)/2
call TriggerRegisterTimerEvent(t,1.5,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function XV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function XX5 takes nothing returns boolean
if GetSpellAbilityId()=='A1IM' then
call XW5()
endif
return false
endfunction
function R61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function XX5))
set t=null
endfunction
function XY5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local player VE2
local integer level=GetUnitAbilityLevel(hero,'A1IN')
local integer MainLevel=GetUnitAbilityLevel(hero,'A1IN')
local real GW1=(TimerGetElapsed(M))
local real XJ5=(LoadReal(LY,(handle_id),(415)))
local real XK5=(LoadReal(LY,(handle_id),(416)))
if IsUnitDead(hero)then
set t=null
set hero=null
return false
endif
if IsPlayerTeam1(GetOwningPlayer(hero))then
set VE2=CO[1]
else
set VE2=BO[1]
endif
if GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetOwningPlayer(GetEventDamageSource())==DO then
if GetUnitAbilityLevel(hero,'A1IE')>0 then
call UnitRemoveAbility(hero,'A1IE')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IF')>0 then
call UnitRemoveAbility(hero,'A1IF')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IG')>0 then
call UnitRemoveAbility(hero,'A1IG')
call UnitRemoveAbility(hero,'B0C9')
endif
call SaveReal(LY,(handle_id),(414),((GW1+2)*1.0))
set t=null
set hero=null
return false
endif
if(LoadReal(LY,(handle_id),(414)))>GW1 then
set t=null
set hero=null
return false
endif
if(IsUnitVisible(hero,VE2)and BM1(hero)==false)or GetUnitAbilityLevel(hero,'BNdo')>0 then
set XK5=0
if GetUnitAbilityLevel(hero,'A1IE')>0 or GetUnitAbilityLevel(hero,'A1IF')>0 or GetUnitAbilityLevel(hero,'A1IG')>0 then
set XJ5=XJ5+0.1
if XJ5>0.4 then
set XJ5=0
if GetUnitAbilityLevel(hero,'A1IE')>0 then
call UnitRemoveAbility(hero,'A1IE')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IF')>0 then
call UnitRemoveAbility(hero,'A1IF')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IG')>0 then
call UnitRemoveAbility(hero,'A1IG')
call UnitRemoveAbility(hero,'B0C9')
endif
endif
endif
call SaveReal(LY,(handle_id),(415),((XJ5)*1.0))
call SaveReal(LY,(handle_id),(416),((XK5)*1.0))
elseif IsUnitVisible(hero,VE2)==false or BM1(hero)then
set XJ5=0
if(level==1 and GetUnitAbilityLevel(hero,'A1IE')==0)or(level==2 and GetUnitAbilityLevel(hero,'A1IF')==0)or(level==3 and GetUnitAbilityLevel(hero,'A1IG')==0)then
set XK5=XK5+0.1
if XK5>0.4 then
set XK5=0
if level==1 then
if GetUnitAbilityLevel(hero,'A1IE')==0 then
call AddSkill(hero,'A1IE')
call UnitMakeAbilityPermanent(hero,true,'A1I7')
call UnitMakeAbilityPermanent(hero,true,'A1I8')
call UnitMakeAbilityPermanent(hero,true,'A1IC')
endif
endif
if level==2 then
if GetUnitAbilityLevel(hero,'A1IE')>0 then
call UnitRemoveAbility(hero,'A1IE')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IF')==0 then
call AddSkill(hero,'A1IF')
call UnitMakeAbilityPermanent(hero,true,'A1I7')
call UnitMakeAbilityPermanent(hero,true,'A1I9')
call UnitMakeAbilityPermanent(hero,true,'A1ID')
endif
endif
if level==3 then
if GetUnitAbilityLevel(hero,'A1IE')>0 then
call UnitRemoveAbility(hero,'A1IE')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IF')>0 then
call UnitRemoveAbility(hero,'A1IF')
call UnitRemoveAbility(hero,'B0C9')
endif
if GetUnitAbilityLevel(hero,'A1IG')==0 then
call AddSkill(hero,'A1IG')
call UnitMakeAbilityPermanent(hero,true,'A1I7')
call UnitMakeAbilityPermanent(hero,true,'A1IA')
call UnitMakeAbilityPermanent(hero,true,'A1IB')
endif
endif
endif
endif
call SaveReal(LY,(handle_id),(415),((XJ5)*1.0))
call SaveReal(LY,(handle_id),(416),((XK5)*1.0))
endif
set t=null
set hero=null
return false
endfunction
function XL5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(handle_id),(415),((0)*1.0))
call SaveReal(LY,(handle_id),(416),((0)*1.0))
call SaveReal(LY,(handle_id),(414),(((TimerGetElapsed(M)))*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function XY5))
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1IE',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1IF',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),'A1IG',false)
set t=null
endfunction
function XM5 takes nothing returns boolean
if GetLearnedSkill()=='A1IN' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A1IN')==1 then
call XL5()
endif
return false
endfunction
function R51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function XM5))
set t=null
endfunction
function XN5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=GetDyingUnit()
if GetOwningPlayer(GetKillingUnit())==GetOwningPlayer(hero)and IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitIllusion(target)==false then
endif
set t=null
set hero=null
set target=null
return false
endfunction
function XS5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer XT5=(LoadInteger(LY,(handle_id),(422)))
local integer XR5=(LoadInteger(LY,(handle_id),(423)))
local integer HJ4=(LoadInteger(LY,(handle_id),(424)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
if(LoadBoolean(LY,(handle_id),(276)))==false and GetTriggerUnit()==hero then
call SaveBoolean(LY,(handle_id),(276),(true))
call SetHeroAgi(hero,GetHeroAgi(hero,false)-XT5-XR5-HJ4,true)
elseif(LoadBoolean(LY,(handle_id),(277)))==false and GetTriggerUnit()==target then
call SaveBoolean(LY,(handle_id),(277),(true))
call SetHeroAgi(target,GetHeroAgi(target,false)+XT5,true)
call SetHeroStr(target,GetHeroStr(target,false)+XR5,true)
call SetHeroInt(target,GetHeroInt(target,false)+HJ4,true)
endif
else
if(LoadBoolean(LY,(handle_id),(276)))==false then
call SaveBoolean(LY,(handle_id),(276),(true))
call SetHeroAgi(hero,GetHeroAgi(hero,false)-XT5-XR5-HJ4,true)
endif
if(LoadBoolean(LY,(handle_id),(277)))==false then
call SaveBoolean(LY,(handle_id),(277),(true))
call SetHeroAgi(target,GetHeroAgi(target,false)+XT5,true)
call SetHeroStr(target,GetHeroStr(target,false)+XR5,true)
call SetHeroInt(target,GetHeroInt(target,false)+HJ4,true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function XP5 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A1HR')
local integer KBO=SEI(target)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer XT5
local integer XR5
local integer HJ4
local real DC1
if KBO==2 then
set XT5=IMinBJ(GetHeroAgi(target,false)-1,1)
set XR5=IMinBJ(GetHeroStr(target,false)-1,1)
set HJ4=IMinBJ(GetHeroInt(target,false)-1,1)
elseif KBO==3 then
set XT5=IMinBJ(GetHeroAgi(target,false)-1,1)
set XR5=IMinBJ(GetHeroStr(target,false)-1,1)
set HJ4=IMinBJ(GetHeroInt(target,false)-1,1)
elseif KBO==1 then
set XT5=IMinBJ(GetHeroAgi(target,false)-1,1)
set XR5=IMinBJ(GetHeroStr(target,false)-1,1)
set HJ4=IMinBJ(GetHeroInt(target,false)-1,1)
endif
call SetHeroAgi(hero,GetHeroAgi(hero,false)+XT5+HJ4+XR5,true)
call SetHeroAgi(target,GetHeroAgi(target,false)-XT5,true)
call SetHeroStr(target,GetHeroStr(target,false)-XR5,true)
call SetHeroInt(target,GetHeroInt(target,false)-HJ4,true)
call SaveInteger(LY,(handle_id),(422),(XT5))
call SaveInteger(LY,(handle_id),(424),(HJ4))
call SaveInteger(LY,(handle_id),(423),(XR5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveBoolean(LY,(handle_id),(276),(false))
call SaveBoolean(LY,(handle_id),(277),(false))
if level==1 then
set DC1=15
elseif level==2 then
set DC1=30
elseif level==3 then
set DC1=60
elseif level==4 then
set DC1=120
endif
call TriggerRegisterTimerEvent(t,DC1,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function XS5))
set t=null
endfunction
function XQ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()!=EVENT_UNIT_DEATH then
call XP5(hero,target)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set target=null
return false
endfunction
function XU5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function XQ5))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function Y05 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1,false)
call TriggerAddCondition(t,Condition(function XU5))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function YI5 takes nothing returns nothing
local unit hero=GetAttacker()
if((LoadInteger(LY,(GetHandleId((hero))),((4274))))==1)==false then
call SCI(hero,4274,0.45-GetUnitAbilityLevel(GetAttacker(),'A1HR')*0.05)
call Y05()
endif
endfunction
function Y15 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A1HR')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call YI5()
endif
return false
endfunction
function YO5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function Y15))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function XN5))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
set t=null
endfunction
function Y25 takes nothing returns boolean
if GetLearnedSkill()=='A1HR' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A1HR')==1 then
call YO5()
endif
return false
endfunction
function R31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function Y25))
set t=null
endfunction
function Y35 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if NPI>(4.0)/0.03 or GetTriggerEventId()==EVENT_WIDGET_DEATH then
if((LoadInteger(LY,(GetHandleId((hero))),((4420))))==1)==false then
call UnitSetUsesAltIcon(hero,false)
endif
call SaveInteger(LY,(GetHandleId((hero))),((4421)),(2))
call UnitAddAbility(hero,'A2VV')
call UnitRemoveAbility(hero,'A2VV')
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetTriggerUnit()==hero then
call IssueImmediateOrder(GetAttacker(),"stop")
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
endif
set t=null
set hero=null
set dummy=null
return false
endfunction
function Y45 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A1IN')
local real d=4.0
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h0B1',GetUnitX(hero),GetUnitY(hero),0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))==false and P0I(GetLocalPlayer())==false then
call UnitSetUsesAltIcon(hero,true)
endif
call AH1(hero,'A1HW',1,d)
call AH1(hero,'A1HX',1,d)
call SaveInteger(LY,(GetHandleId((hero))),((4421)),(1))
call UnitAddAbility(hero,'A2VU')
call UnitRemoveAbility(hero,'A2VU')
if GetUnitTypeId(hero)!='E02X' then
call UnitAddAbility(hero,'Aloc')
call UnitRemoveAbility(hero,'Aloc')
endif
call ShowUnit(hero,false)
call ShowUnit(hero,true)
call SelectUnitAddForPlayer(hero,GetOwningPlayer(hero))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterDeathEvent(t,hero)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function Y35))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
set hero=null
endfunction
function Y55 takes nothing returns boolean
if GetSpellAbilityId()=='A1IN' then
call Y45()
endif
return false
endfunction
function R41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function Y55))
set t=null
endfunction
function Y65 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(196)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real IV1
local real IW1
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real RM2
local real QWI=QNI(II3,I13,QJI,QKI)
call SaveReal(LY,(handle_id),(23),((QJI)*1.0))
call SaveReal(LY,(handle_id),(24),((QKI)*1.0))
if QWI>100 or NPI>(3.5/.03)or RKI(target)==true then
call DestroyLightning(UZI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call MoveLightning(UZI,true,QXI,QYI,QJI,QKI)
if QNI(QXI,QYI,QJI,QKI)>325 then
set RM2=Atan2(QKI-QYI,QJI-QXI)
set IV1=QXI+(325)*Cos(RM2)
set IW1=QYI+(325)*Sin(RM2)
call MUSetUnitX(target,IV1)
call MUSetUnitY(target,IW1)
endif
endif
set t=null
set hero=null
set target=null
set UZI=null
return false
endfunction
function Y75 takes unit hero,unit target,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local lightning UZI=AddLightning("PONC",true,GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
call SetLightningColor(UZI,1,1,1,1)
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(189),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(190),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function Y65))
call Damage(hero,target,1,50*level)
call IssueTargetOrder(hero,"attack",target)
set t=null
set UZI=null
endfunction
function Y85 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real BA3=(LoadReal(LY,(handle_id),(189)))
local real BB3=(LoadReal(LY,(handle_id),(190)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real IV1=BA3+(30*(20+4*2)/30)*NPI*Cos(RM2*bj_DEGTORAD)
local real IW1=BB3+(30*(20+4*2)/30)*NPI*Sin(RM2*bj_DEGTORAD)
local real YB3=SquareRoot((IV1-QJI)*(IV1-QJI)+(IW1-QKI)*(IW1-QKI))
local real YC3=700
local real YD3=175
local real YE3=(1-YB3/YC3)*YD3*2
local group g=NTI()
local unit target
if NPI==1 then
call SetUnitAnimationByIndex(hero,5)
call SetUnitTimeScale(hero,1.5)
endif
if YE3>YD3 then
call SetUnitAnimationByIndex(hero,5)
set YE3=YD3*2-YE3
endif
call SetUnitFlyHeight(hero,QDI(YE3,0),0)
call MUSetUnitX(hero,PTI(IV1))
call MUSetUnitY(hero,PUI(IW1))
call SetUnitFacing(hero,RM2)
set GK=hero
call GroupEnumUnitsInRange(g,IV1,IW1,120,Condition(function D21))
set target=FirstOfGroup(g)
call NSI(g)
if YB3<30 or target!=null or GetTriggerEvalCount(t)>75 then
call SetUnitFlyHeight(hero,0,0)
call SetUnitFacing(hero,RM2)
call SetUnitTimeScale(hero,1)
call SetUnitAnimation(hero,"stand")
call SetUnitPathing(hero,true)
call UnitRemoveAbility(hero,'A1J6')
call UPI(GetUnitX(hero),GetUnitY(hero),100)
if target!=null and RKI(target)==false then
call SCI(target,4408,5)
call Y75(hero,target,level)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function Y95 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A1J7')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QWI=700
local real RM2=GetUnitFacing(hero)
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=PTI(QXI+QWI*Cos(RM2*bj_DEGTORAD))
local real QKI=PUI(QYI+QWI*Sin(RM2*bj_DEGTORAD))
call AddSkill(hero,'Amrf')
call UnitRemoveAbility(hero,'Amrf')
call SetUnitPathing(hero,false)
call AddSkill(hero,'A1J6')
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function Y85))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(189),((QXI)*1.0))
call SaveReal(LY,(handle_id),(190),((QYI)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
set hero=null
set t=null
endfunction
function YA5 takes nothing returns boolean
if GetSpellAbilityId()=='A1J7' then
call Y95()
endif
return false
endfunction
function R71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YA5))
set t=null
endfunction
function YB5 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real PAI=(LoadReal(LY,(handle_id),(20)))
call Damage(hero,target,1,PAI)
set hero=null
set target=null
endfunction
function YC5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local trigger t=IJ1(hero,target,'h0BP',"YB5",700,false)
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A04A')
local real PAI
if level==1 then
set PAI=85
elseif level==2 then
set PAI=165
elseif level==3 then
set PAI=225
elseif level==4 then
set PAI=300
endif
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
set hero=null
set target=null
set t=null
endfunction
function YD5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A04A')
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),500,Condition(function C51))
call ForGroup(g,function YC5)
call NSI(g)
call PlaySoundOnUnitBJ(OF,100,hero)
set hero=null
endfunction
function YE5 takes nothing returns boolean
if GetSpellAbilityId()=='A04A' then
call YD5()
endif
return false
endfunction
function R81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YE5))
set t=null
endfunction
function YF5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),WXI)==false then
call GroupAddUnit(WXI,GetEnumUnit())
call Damage(WYI,GetEnumUnit(),7,WJI)
endif
endfunction
function YG5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(22)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real IT3=QLI(hero,IG1)
local real IV1=GetUnitX(IG1)+WWI*0.02*Cos(a*bj_DEGTORAD)
local real IW1=GetUnitY(IG1)+WWI*0.02*Sin(a*bj_DEGTORAD)
local group g
local real r=100+350*IT3/900
local integer level=GetUnitAbilityLevel(hero,'A306')
local real PAI
if level>0 then
set PAI=190+100*level
else
set level=GetUnitAbilityLevel(hero,'A307')
set PAI=200+125*level
endif
if IT3>900 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call NSI(PR2)
call KillUnit(IG1)
else
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
set GK=hero
set WYI=hero
set WXI=PR2
set WJI=PAI
set g=NTI()
call GroupEnumUnitsInRange(g,IV1,IW1,r,Condition(function CA1))
call ForGroup(g,function YF5)
call NSI(g)
set g=null
endif
set PR2=null
set t=null
set hero=null
set IG1=null
return false
endfunction
function YH5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0EW',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),x,y)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function YG5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
set hero=null
set t=null
set IG1=null
endfunction
function YZ5 takes nothing returns boolean
if GetSpellAbilityId()=='A306' or GetSpellAbilityId()=='A307' then
call YH5()
endif
return false
endfunction
function R91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YZ5))
set t=null
endfunction
function YV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call PJI(hero)
endif
set t=null
set hero=null
return false
endfunction
function YW5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A00P')
call TriggerRegisterTimerEvent(t,1+1.75+0.75*level,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerAddCondition(t,Condition(function YV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function YX5 takes nothing returns boolean
if GetSpellAbilityId()=='A00P' then
call YW5()
endif
return false
endfunction
function RA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YX5))
set t=null
endfunction
function YY5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A00H')
local integer RII
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local real x
local real y
local real d
local real h
local real M5I=40
local unit u
if level==0 then
set M5I=45
set level=GetUnitAbilityLevel(hero,'A0A1')
if level==1 then
set RII='o01C'
elseif level==2 then
set RII='o01D'
elseif level==3 then
set RII='o01E'
endif
else
if level==1 then
set RII='osp4'
elseif level==2 then
set RII='o008'
elseif level==3 then
set RII='o009'
endif
endif
set d=65
set h=65
set x=QJI+0*d
set y=QKI+1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI+1*d
set y=QKI+1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI+2*d
set y=QKI+1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI-1*d
set y=QKI+1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI-2*d
set y=QKI+1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI-1*d
set y=QKI+0*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI+1*d
set y=QKI+0*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI-1*d
set y=QKI-1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI+0*d
set y=QKI-1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set x=QJI+1*d
set y=QKI-1*h
set u=CreateUnit(GetOwningPlayer(hero),RII,x,y,0)
call UnitApplyTimedLife(u,'BTLF',M5I)
set hero=null
endfunction
function YJ5 takes nothing returns boolean
if GetSpellAbilityId()=='A00H' or GetSpellAbilityId()=='A0A1' then
call YY5()
endif
return false
endfunction
function RB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YJ5))
set t=null
endfunction
function YK5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetTriggerEvalCount(t)==4 or RKI(target)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A2O7')
call UnitRemoveAbility(target,'B0GC')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
if GetTriggerEventId()!=EVENT_WIDGET_DEATH then
call Damage(hero,target,1,20*level-10)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function YL5 takes unit hero,unit target,integer level returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(target,'A2O7')
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function YK5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",target,"chest")))
set t=null
endfunction
function YM5 takes nothing returns boolean
if IsUnitInGroup(GetEnumUnit(),WKI)==false and RKI(GetEnumUnit())==false then
call GroupAddUnit(WKI,GetEnumUnit())
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\FireBlast.mdx",GetEnumUnit(),"chest"))
call YL5(WMI,GetEnumUnit(),WLI)
endif
return false
endfunction
function YN5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real a=(LoadReal(LY,(handle_id),(13)))
local real YS5=(1-I2R(NPI)/50)*bj_PI
local real YT5=1400/2*Cos(YS5)
local real YR5=500/2*Sin(YS5)
local real x=PTI(QJI+YT5*Cos(a)-YR5*Sin(a))
local real y=PUI(QKI+YT5*Sin(a)+YR5*Cos(a))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local group g
local integer level=GetUnitAbilityLevel(hero,'A1RJ')
if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and NPI>0 and(GetSpellAbilityId()=='A20N' or GetSpellAbilityId()=='A1RK'))or NPI>100 or BH1(hero)then
call UPI(x,y,300)
call SetUnitVertexColor(hero,255,255,255,255)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1RJ' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1RJ',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A20N',false)
call SetUnitPathing(hero,true)
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if ModuloInteger(NPI,10)==0 then
call UPI(x,y,200)
endif
call SaveInteger(LY,(handle_id),(34),(NPI+1))
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
call SetUnitFacing(hero,(a+YS5-bj_PI/2)*bj_RADTODEG)
set g=NTI()
set WKI=JAO
set GK=hero
set WMI=hero
set WLI=GetUnitAbilityLevel(hero,'A1RJ')
call GroupEnumUnitsInRange(g,x,y,200+25,Condition(function CE1))
call ForGroup(g,function YM5)
call NSI(g)
endif
set t=null
set hero=null
set g=null
set JAO=null
return false
endfunction
function YP5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real a=UEI(QXI,QYI,GetSpellTargetX(),GetSpellTargetY())*bj_DEGTORAD
local real QJI=QXI+1400/2*Cos(a)
local real QKI=QYI+1400/2*Sin(a)
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)-GetUnitState(hero,UNIT_STATE_LIFE)*0.15)
call SCI(hero,4301,2)
call SCI(hero,4415,2)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YN5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(189),((QXI)*1.0))
call SaveReal(LY,(handle_id),(190),((QYI)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(13),((a)*1.0))
call SaveGroupHandle(LY,(handle_id),(133),(NTI()))
call SetUnitPathing(hero,false)
call SetUnitVertexColor(hero,255,255,255,50)
call AddSkill(hero,'A20N')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1RJ',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A20N',true)
set t=null
set hero=null
endfunction
function YQ5 takes nothing returns boolean
if GetSpellAbilityId()=='A1RJ' then
call YP5()
endif
return false
endfunction
function RC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function YQ5))
set t=null
endfunction
function YU5 takes nothing returns nothing
local unit hero=WNI
local unit target=GetEnumUnit()
call Damage(hero,target,1,40+20*WSI)
call U5I("Doodads\\Cinematic\\FireTrapUp\\FireTrapUp.mdl",target,"origin",1)
set hero=null
set target=null
endfunction
function J05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A1RK')
local group g
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set GK=hero
set WNI=hero
set WSI=level
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1000+25,Condition(function CA1))
call ForGroup(g,function YU5)
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function JI5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit J15=(LoadUnitHandle(LY,(handle_id),(589)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if IsUnitIllusion(GetEventDamageSource())==true then
call QGI(J15,GetEventDamage())
endif
else
if GetUnitX(J15)!=x or GetUnitY(J15)!=y then
call SetUnitPosition(J15,x,y)
endif
if GetUnitY(hero)!=x or GetUnitY(hero)!=y then
call SetUnitPosition(hero,x,y)
endif
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
endif
if GetTriggerEvalCount(t)==1 then
call PauseUnit(hero,true)
endif
set t=null
set J15=null
set hero=null
set dummy=null
return false
endfunction
function JO5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit J25=(LoadUnitHandle(LY,(handle_id),(588)))
local unit J15=(LoadUnitHandle(LY,(handle_id),(589)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit ZK3=(LoadUnitHandle(LY,(handle_id),(239)))
local integer level=GetUnitAbilityLevel(hero,'A1RK')
local group g
local unit dummy
local integer J35
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call StopSound(BF,false,false)
call ShowUnit(J25,false)
call ShowUnit(ZK3,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(hero,true)
call SaveInteger(LY,(GetHandleId((hero))),((4326)),(2))
call UnitRemoveAbility(hero,'A04R')
call SetUnitInvulnerable(hero,false)
call PauseUnit(hero,false)
if GetLocalPlayer()==GetOwningPlayer(hero)then
call ClearSelection()
call SelectUnit(hero,true)
endif
call SetUnitState(hero,UNIT_STATE_LIFE,1)
set dummy=CreateUnit(GetOwningPlayer(GetKillingUnit()),'e00E',0,0,0)
call UnitRemoveBuffs(hero,true,true)
call UnitRemoveAbility(hero,'Aetl')
call UnitDamageTarget(dummy,hero,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
set dummy=null
else
if GetTriggerEvalCount(t)==1 then
call SetUnitFlyHeight(J15,0,200)
elseif GetTriggerEvalCount(t)==2 then
call PauseUnit(J15,false)
call UnitApplyTimedLife(J15,'BTLF',0.1)
call StopSound(BF,false,false)
call StartSound(CF)
call DestroyEffect(AddSpecialEffect("war3mapImported\\FireNova2.mdx",GetUnitX(J25),GetUnitY(J25)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(hero,true)
call SaveInteger(LY,(GetHandleId((hero))),((4326)),(2))
call UnitRemoveAbility(hero,'A04R')
call SetUnitInvulnerable(hero,false)
call SetUnitAnimationByIndex(hero,8)
call QueueUnitAnimation(hero,"idle")
call PauseUnit(hero,false)
if GetLocalPlayer()==GetOwningPlayer(hero)then
call ClearSelection()
call SelectUnit(hero,true)
endif
call ShowUnit(J25,false)
call ShowUnit(ZK3,false)
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_MAX_LIFE))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MAX_MANA))
set J35=GetUnitAbilityLevel(hero,'A1RJ')
if J35>0 then
call UnitRemoveAbility(hero,'A1RJ')
call UnitAddAbility(hero,'A1RJ')
call SetUnitAbilityLevel(hero,'A1RJ',J35)
endif
set J35=GetUnitAbilityLevel(hero,'A1YX')
if J35>0 then
call UnitRemoveAbility(hero,'A1YX')
call UnitAddAbility(hero,'A1YX')
call SetUnitAbilityLevel(hero,'A1YX',J35)
endif
set J35=GetUnitAbilityLevel(hero,'A1YY')
if J35>0 then
call UnitRemoveAbility(hero,'A1YY')
call UnitAddAbility(hero,'A1YY')
call SetUnitAbilityLevel(hero,'A1YY',J35)
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A1ZT')
call SetUnitAbilityLevel(dummy,'A1ZT',level)
call IssueImmediateOrder(dummy,"stomp")
set dummy=null
endif
endif
set t=null
set hero=null
set J25=null
set ZK3=null
set J15=null
return false
endfunction
function J45 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit J25
local unit J15
local unit ZK3=CreateUnit(GetOwningPlayer(hero),'h0CL',GetUnitX(hero),GetUnitY(hero),0)
local integer level=GetUnitAbilityLevel(hero,'A1RK')
local unit dummy
local unit J55=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
set J25=CreateUnit(GetOwningPlayer(hero),'h0BX',x,y,0)
if level==1 then
set J15=CreateUnit(GetOwningPlayer(hero),'h0CV',x,y,0)
elseif level==2 then
set J15=CreateUnit(GetOwningPlayer(hero),'h0CX',x,y,0)
elseif level==3 then
set J15=CreateUnit(GetOwningPlayer(hero),'h0CW',x,y,0)
endif
call AddSpecialEffectTarget("war3mapImported\\PhoenixDown_2.mdl",J25,"origin")
if GetLocalPlayer()==GetOwningPlayer(hero)then
call ClearSelection()
call SelectUnit(J15,true)
endif
call UPI(x,y,400)
call ShowUnit(hero,false)
call SaveInteger(LY,(GetHandleId((hero))),((4326)),(1))
call AddSkill(hero,'A04R')
call DU1(hero,0,0)
call SetUnitInvulnerable(hero,true)
call UnitRemoveBuffs(hero,true,true)
call StartSound(BF)
call UnitRemoveAbility(J15,'Arav')
call UnitApplyTimedLife(J25,'BTLF',6.1)
call UnitApplyTimedLife(ZK3,'BTLF',6.1)
call UnitApplyTimedLife(J15,'BTLF',6.1)
call TriggerRegisterTimerEvent(t,5.2,false)
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function JO5))
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(588),(J25))
call SaveUnitHandle(LY,(handle_id),(589),(J15))
call SaveUnitHandle(LY,(handle_id),(239),(ZK3))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function J05))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,.02,true)
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function JI5))
call SaveUnitHandle(LY,(handle_id),(589),(J15))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveUnitHandle(LY,(handle_id),(19),(J55))
if EA1(hero,'I0A8')then
call UnitAddAbility(J55,'A04I')
endif
set t=null
set hero=null
set J25=null
set J15=null
endfunction
function J65 takes nothing returns boolean
if GetSpellAbilityId()=='A1RK' then
call J45()
endif
return false
endfunction
function RZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function J65))
call Q1I('A0X6')
call Q1I('A1ZT')
set t=null
endfunction
function J75 takes nothing returns nothing
local unit hero=WTI
local unit target=GetEnumUnit()
call Damage(hero,target,1,40+20*WRI)
call U5I("Doodads\\Cinematic\\FireTrapUp\\FireTrapUp.mdl",target,"origin",1)
set hero=null
set target=null
endfunction
function J85 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A2YR')
local group g
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set GK=hero
set WTI=hero
set WRI=level
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1000+25,Condition(function CA1))
call ForGroup(g,function J75)
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function J95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit J15=(LoadUnitHandle(LY,(handle_id),(589)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if IsUnitIllusion(GetEventDamageSource())==true then
call QGI(J15,GetEventDamage())
endif
else
if GetUnitX(J15)!=x or GetUnitY(J15)!=y then
call SetUnitPosition(J15,x,y)
endif
if GetUnitY(hero)!=x or GetUnitY(hero)!=y then
call SetUnitPosition(hero,x,y)
endif
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
if target!=null and(GetUnitY(target)!=x or GetUnitY(target)!=y)then
call SetUnitPosition(target,x,y)
endif
endif
if GetTriggerEvalCount(t)==1 then
call PauseUnit(hero,true)
endif
set t=null
set J15=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function JA5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit J25=(LoadUnitHandle(LY,(handle_id),(588)))
local unit J15=(LoadUnitHandle(LY,(handle_id),(589)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local unit ZK3=(LoadUnitHandle(LY,(handle_id),(239)))
local integer level=GetUnitAbilityLevel(hero,'A2YR')
local group g
local unit dummy
local integer J35
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call StopSound(BF,false,false)
call ShowUnit(J25,false)
call ShowUnit(ZK3,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(hero,true)
call SaveInteger(LY,(GetHandleId((hero))),((4326)),(2))
call UnitRemoveAbility(hero,'A04R')
call SetUnitInvulnerable(hero,false)
call PauseUnit(hero,false)
if GetLocalPlayer()==GetOwningPlayer(hero)then
call ClearSelection()
call SelectUnit(hero,true)
endif
call SetUnitState(hero,UNIT_STATE_LIFE,1)
set dummy=CreateUnit(GetOwningPlayer(GetKillingUnit()),'e00E',0,0,0)
call UnitRemoveBuffs(hero,true,true)
call UnitRemoveAbility(hero,'Aetl')
call UnitDamageTarget(dummy,hero,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
if target!=null then
call ShowUnit(target,true)
call SaveInteger(LY,(GetHandleId((target))),((4326)),(2))
call UnitRemoveAbility(target,'A04R')
call SetUnitInvulnerable(target,false)
call PauseUnit(target,false)
if GetLocalPlayer()==GetOwningPlayer(target)then
call ClearSelection()
call SelectUnit(target,true)
endif
call SetUnitState(target,UNIT_STATE_LIFE,1)
set dummy=CreateUnit(GetOwningPlayer(GetKillingUnit()),'e00E',0,0,0)
call UnitRemoveBuffs(target,true,true)
call UnitRemoveAbility(target,'Aetl')
call UnitDamageTarget(dummy,target,100000000.00,true,false,ATTACK_TYPE_MELEE,DAMAGE_TYPE_NORMAL,WEAPON_TYPE_WHOKNOWS)
endif
set dummy=null
else
if GetTriggerEvalCount(t)==1 then
call SetUnitFlyHeight(J15,0,200)
elseif GetTriggerEvalCount(t)==2 then
call PauseUnit(J15,false)
call UnitApplyTimedLife(J15,'BTLF',0.1)
call StopSound(BF,false,false)
call StartSound(CF)
call DestroyEffect(AddSpecialEffect("war3mapImported\\FireNova2.mdx",GetUnitX(J25),GetUnitY(J25)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ShowUnit(hero,true)
call SaveInteger(LY,(GetHandleId((hero))),((4326)),(2))
call UnitRemoveAbility(hero,'A04R')
call SetUnitInvulnerable(hero,false)
call SetUnitAnimationByIndex(hero,8)
call QueueUnitAnimation(hero,"idle")
call PauseUnit(hero,false)
if GetLocalPlayer()==GetOwningPlayer(hero)then
call ClearSelection()
call SelectUnit(hero,true)
endif
call ShowUnit(J25,false)
call ShowUnit(ZK3,false)
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_MAX_LIFE))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MAX_MANA))
if target!=null then
call ShowUnit(target,true)
call SaveInteger(LY,(GetHandleId((target))),((4326)),(2))
call UnitRemoveAbility(target,'A04R')
call SetUnitInvulnerable(target,false)
call PauseUnit(target,false)
if GetLocalPlayer()==GetOwningPlayer(target)then
call ClearSelection()
call SelectUnit(target,true)
endif
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_MAX_LIFE))
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MAX_MANA))
endif
set J35=GetUnitAbilityLevel(hero,'A1RJ')
if J35>0 then
call UnitRemoveAbility(hero,'A1RJ')
call UnitAddAbility(hero,'A1RJ')
call SetUnitAbilityLevel(hero,'A1RJ',J35)
endif
set J35=GetUnitAbilityLevel(hero,'A1YX')
if J35>0 then
call UnitRemoveAbility(hero,'A1YX')
call UnitAddAbility(hero,'A1YX')
call SetUnitAbilityLevel(hero,'A1YX',J35)
endif
set J35=GetUnitAbilityLevel(hero,'A1YY')
if J35>0 then
call UnitRemoveAbility(hero,'A1YY')
call UnitAddAbility(hero,'A1YY')
call SetUnitAbilityLevel(hero,'A1YY',J35)
endif
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A1ZT')
call SetUnitAbilityLevel(dummy,'A1ZT',level)
call IssueImmediateOrder(dummy,"stomp")
set dummy=null
endif
endif
set t=null
set hero=null
set target=null
set J25=null
set ZK3=null
set J15=null
return false
endfunction
function JB5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit J25
local unit J15
local unit ZK3=CreateUnit(GetOwningPlayer(hero),'h0CL',GetUnitX(hero),GetUnitY(hero),0)
local integer level=GetUnitAbilityLevel(hero,'A2YR')
local unit dummy
local unit J55=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
if target==hero then
set target=null
endif
set J25=CreateUnit(GetOwningPlayer(hero),'h0BX',x,y,0)
if level==1 then
set J15=CreateUnit(GetOwningPlayer(hero),'h0CV',x,y,0)
elseif level==2 then
set J15=CreateUnit(GetOwningPlayer(hero),'h0CX',x,y,0)
elseif level==3 then
set J15=CreateUnit(GetOwningPlayer(hero),'h0CW',x,y,0)
endif
call AddSpecialEffectTarget("war3mapImported\\PhoenixDown_2.mdl",J25,"origin")
if GetLocalPlayer()==GetOwningPlayer(hero)then
call ClearSelection()
call SelectUnit(J15,true)
endif
call UPI(x,y,400)
call ShowUnit(hero,false)
call SaveInteger(LY,(GetHandleId((hero))),((4326)),(1))
call AddSkill(hero,'A04R')
call DU1(hero,0,0)
call SetUnitInvulnerable(hero,true)
call UnitRemoveBuffs(hero,true,true)
if target!=null then
call ShowUnit(target,false)
call SaveInteger(LY,(GetHandleId((target))),((4326)),(1))
call AddSkill(target,'A04R')
call DU1(target,0,0)
call SetUnitInvulnerable(target,true)
call UnitRemoveBuffs(target,true,true)
endif
call StartSound(BF)
call UnitRemoveAbility(J15,'Arav')
call UnitApplyTimedLife(J25,'BTLF',6.1)
call UnitApplyTimedLife(ZK3,'BTLF',6.1)
call UnitApplyTimedLife(J15,'BTLF',6.1)
call TriggerRegisterTimerEvent(t,5.2,false)
call TriggerRegisterTimerEvent(t,6,false)
call TriggerAddCondition(t,Condition(function JA5))
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DEATH)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(588),(J25))
call SaveUnitHandle(LY,(handle_id),(589),(J15))
call SaveUnitHandle(LY,(handle_id),(239),(ZK3))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function J85))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,.02,true)
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,J15,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function J95))
call SaveUnitHandle(LY,(handle_id),(589),(J15))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveUnitHandle(LY,(handle_id),(19),(J55))
if EA1(hero,'I0A8')then
call UnitAddAbility(J55,'A04I')
endif
set t=null
set hero=null
set target=null
set J25=null
set J15=null
endfunction
function JC5 takes nothing returns boolean
if GetSpellAbilityId()=='A2YR' then
call JB5()
endif
return false
endfunction
function RV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function JC5))
call Q1I('A0X6')
call Q1I('A1ZT')
set t=null
endfunction
function JD5 takes nothing returns nothing
call SetUnitState(GetEnumUnit(),UNIT_STATE_LIFE,GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)+WPI)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\BirdShitTarget_1.mdx",GetEnumUnit(),"origin"))
endfunction
function JE5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g
local integer level=GetUnitAbilityLevel(hero,'A27B')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect(AddSpecialEffect("war3mapImported\\Firaga_2.mdx",x,y))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set g=NTI()
set WPI=50+75*level
set GK=hero
call GroupEnumUnitsInRange(g,x,y,425,Condition(function CT1))
call ForGroup(g,function JD5)
call NSI(g)
set t=null
set hero=null
set g=null
return false
endfunction
function JF5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
call TriggerRegisterTimerEvent(t,3,false)
call TriggerAddCondition(t,Condition(function JE5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
if IsPlayerAlly(GetOwningPlayer(hero),GetLocalPlayer())or P0I(GetLocalPlayer())then
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\BirdShit_1.mdx",x,y)))
else
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("",x,y)))
endif
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))or P0I(GetLocalPlayer())then
call PingMinimapEx(x,y,3,255,0,0,false)
call IO1(KF,x,y)
endif
call I41(GetOwningPlayer(hero),4,x,y,500)
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)*0.9)
set t=null
set hero=null
endfunction
function JG5 takes nothing returns boolean
if GetSpellAbilityId()=='A27B' then
call JF5()
endif
return false
endfunction
function RE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function JG5))
set t=null
endfunction
function JH5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call UnitRemoveAbility(target,'A270')
call UnitRemoveAbility(target,'B0EK')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)>4 then
call UnitRemoveAbility(target,'A270')
call UnitRemoveAbility(target,'B0EK')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call Damage(hero,target,1,16+12*level)
else
call Damage(hero,target,1,16+12*level)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function JZ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real x=II3+12*Cos(a)
local real y=I13+12*Sin(a)
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
if GetTriggerEvalCount(t)>25 then
call UPI(x,y,100)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function JV5 takes unit hero,unit target,real x,real y,real a returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A271')
call SetUnitPosition(target,GetUnitX(target),GetUnitY(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(137),((a*bj_DEGTORAD)*1.0))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function JZ5))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",target,"chest")))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function JH5))
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A270',false)
call AddSkill(target,'A270')
set t=null
endfunction
function JW5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),WQI)==false then
if QLI(X0I,GetEnumUnit())<24 or RAbsBJ(Cos(UDI(X0I,GetEnumUnit())-XOI))<0.26 then
call GroupAddUnit(WQI,GetEnumUnit())
if Sin((UDI(X0I,GetEnumUnit())-XOI)*bj_DEGTORAD)<0 then
call JV5(WUI,GetEnumUnit(),XII,X1I,XOI-90)
else
call JV5(WUI,GetEnumUnit(),XII,X1I,XOI+90)
endif
endif
endif
endfunction
function JX5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
if GetTriggerEvalCount(t)>125 then
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set x=x+8*Cos(a)
set y=y+8*Sin(a)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set GK=hero
set XII=x
set X1I=y
set XOI=a*bj_RADTODEG
set WQI=PR2
set WUI=hero
set X0I=IG1
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,225,Condition(function CA1))
call ForGroup(g,function JW5)
call NSI(g)
endif
set t=null
set hero=null
return false
endfunction
function JY5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local real RM2=Atan2(QKI-GetUnitY(hero),QJI-GetUnitX(hero))
local integer level=GetUnitAbilityLevel(hero,'A271')
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0DA',GetUnitX(hero),GetUnitY(hero),RM2*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.01,true)
call TriggerAddCondition(t,Condition(function JX5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(137),((RM2)*1.0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
set t=null
set hero=null
endfunction
function JJ5 takes nothing returns boolean
if GetSpellAbilityId()=='A271' then
call JY5()
endif
return false
endfunction
function RH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function JJ5))
set t=null
endfunction
function JK5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real GW1=(LoadReal(LY,(GetHandleId(hero)),(681)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if((TimerGetElapsed(M))-GW1<0.49)==false or GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitRemoveAbility(hero,'A1Z4')
call UnitRemoveAbility(hero,'A1ZA')
call UnitRemoveAbility(hero,'A1ZB')
call UnitRemoveAbility(hero,'A1Z9')
call UnitRemoveAbility(hero,'B0DV')
endif
set t=null
set hero=null
return false
endfunction
function JL5 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer JM5
call TriggerRegisterTimerEvent(t,0.5,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function JK5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(GetHandleId(hero)),(681),(((TimerGetElapsed(M)))*1.0))
if X6I==1 then
set JM5='A1Z4'
call UnitRemoveAbility(hero,'A1ZA')
call UnitRemoveAbility(hero,'A1ZB')
call UnitRemoveAbility(hero,'A1Z9')
elseif X6I==2 then
set JM5='A1ZA'
call UnitRemoveAbility(hero,'A1Z4')
call UnitRemoveAbility(hero,'A1ZB')
call UnitRemoveAbility(hero,'A1Z9')
elseif X6I==3 then
set JM5='A1ZB'
call UnitRemoveAbility(hero,'A1Z4')
call UnitRemoveAbility(hero,'A1ZA')
call UnitRemoveAbility(hero,'A1Z9')
elseif X6I==4 then
set JM5='A1Z9'
call UnitRemoveAbility(hero,'A1Z4')
call UnitRemoveAbility(hero,'A1ZA')
call UnitRemoveAbility(hero,'A1ZB')
endif
call AddSkill(hero,JM5)
call UnitMakeAbilityPermanent(hero,true,JM5)
set t=null
endfunction
function JN5 takes nothing returns nothing
local unit target=GetEnumUnit()
local real JS5=X9I
local real JT5=XAI
local real PAI=JS5+JT5*GetUnitState(target,UNIT_STATE_MAX_LIFE)
set PAI=PAI/5
if IsUnitEnemy(target,GetOwningPlayer(X7I))==true then
call Damage(X7I,target,3,PAI)
if RKI(target)==false then
call JL5(target)
endif
else
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+PAI*0.5)
endif
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\FireRayTarget.mdx",target,"origin"))
call I41(GetOwningPlayer(target),2,GetUnitX(X7I),GetUnitY(X7I),500)
set target=null
endfunction
function JR5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real JP5=GetUnitFacing(hero)
local real a=JP5*bj_DEGTORAD
local location l1=GetUnitLoc(hero)
local real JQ5=GetLocationZ(l1)
local location l2=Location(GetUnitX(hero)+X2I*Cos(a),GetUnitY(hero)+X2I*Sin(a))
local real JU5=GetLocationZ(l2)
local lightning K05=(LoadLightningHandle(LY,(handle_id),(676)))
local lightning KI5=(LoadLightningHandle(LY,(handle_id),(677)))
local lightning K15=(LoadLightningHandle(LY,(handle_id),(678)))
local lightning KO5=(LoadLightningHandle(LY,(handle_id),(679)))
local lightning K25=(LoadLightningHandle(LY,(handle_id),(680)))
local real K35=1
local real QXI
local real QYI
local real K45
local real K55
local real K65
local real K75
local real K85
local real K95
local real KA5
local real KB5
local real KC5
local real KD5
local real KE5
local real KF5
local real KG5
local real KH5
local real KZ5
local real KV5
local real KW5
local real KX5
local real KY5
local real KJ5
local real KK5
local real KL5
local real KM5
local real KN5
local real KS5
local real KT5
local real KR5
local real KP5
local real KQ5
local real KU5
local real L05
local group g
local real x
local real y
local integer i
local real LI5
local real L15
local real LO5
local boolean L25=FALSE
local boolean L35=false
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit NewTarget=null
local unit DriftTarget=null
local real L45
local real L55
local real L65
local real L75=(LoadReal(LY,(handle_id),(688)))
local boolean L85=(LoadBoolean(LY,(handle_id),(689)))
local boolean L95=(LoadBoolean(LY,(handle_id),(672)))
local real LA5
local ubersplat AR1
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real JS5
local real JT5
local real LB5
local real LC5=5
if GetUnitCurrentOrder(hero)==852001 then
call DisableTrigger(t)
call PJI(hero)
call EnableTrigger(t)
endif
call RemoveLocation(l1)
call RemoveLocation(l2)
if IsUnitPaused(hero)==false and(GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER)then
set QXI=GetUnitX(hero)
set QYI=GetUnitY(hero)
if GetIssuedOrderId()!=852490 and GetIssuedOrderId()!=852185 and GetIssuedOrderId()!=852600 then
call DisableTrigger(t)
call PJI(hero)
call EnableTrigger(t)
endif
if GetIssuedOrderId()==851971 then
if GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER then
set x=GetUnitX(GetOrderTargetUnit())
set y=GetUnitY(GetOrderTargetUnit())
else
set x=GetOrderPointX()
set y=GetOrderPointY()
endif
set LI5=UEI(x,y,QXI,QYI)
if LI5<0 then
set LI5=LI5+360
endif
set LO5=JP5-LI5
if LO5<0 then
set LO5=LO5+360
endif
if LO5<180 then
set L25=true
set L15=JP5+6
else
set L35=true
set L15=JP5-6
endif
set L75=UEI(x,y,QXI,QYI)+180
call SaveReal(LY,(handle_id),(688),((L75)*1.0))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT or GetTriggerEventId()==EVENT_WIDGET_DEATH or(LoadInteger(LY,(GetHandleId(hero)),(704)))==-1 or NPI>=6.0/.02 or BG1(hero)or TLI(hero)then
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and(GetSpellAbilityId()=='A1Z3' or GetSpellAbilityId()=='A1RK' or GetSpellAbilityId()=='A27H'))then
call SaveInteger(LY,(GetHandleId((hero))),((4312)),(2))
call BP1(hero)
call SetUnitPathing(hero,true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A205')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1Z3',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A205',false)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1YY' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YY',true)
endif
call DestroyLightning(K05)
call DestroyLightning(KI5)
call DestroyLightning(K15)
call DestroyLightning(KO5)
call DestroyLightning(K25)
call StopSound(JF,false,true)
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if GetIssuedOrderId()==String2OrderIdBJ("immolation")then
set L85=true
endif
if GetIssuedOrderId()==String2OrderIdBJ("unimmolation")then
set L85=false
endif
call SaveBoolean(LY,(handle_id),(689),(L85))
else
set LI5=JP5-L75
if LI5<-180 then
set LI5=LI5+360
elseif LI5>180 then
set LI5=LI5-360
endif
set LA5=1
if NPI<35 and L95==true then
set LA5=7
endif
if LI5<(-1*LA5)then
set JP5=JP5+LA5
elseif LI5>LA5 then
set JP5=JP5-LA5
else
set L95=false
call SaveBoolean(LY,(handle_id),(672),(L95))
set JP5=L75
endif
if((LoadInteger(LY,(GetHandleId((hero))),((4301))))==1)==false then
call SetUnitFacing(hero,JP5)
endif
set a=JP5*bj_DEGTORAD
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
set K45=X2I
set QXI=GetUnitX(hero)+50*Cos(a)
set QYI=GetUnitY(hero)+50*Sin(a)
if L85 and BE1(hero)==false and BG1(hero)==false then
if((LoadInteger(LY,(GetHandleId((hero))),((4331))))==1)==true then
set LC5=LC5*2
endif
set L65=a
set L45=PTI(GetUnitX(hero)+LC5*Cos(L65))
set L55=PUI(GetUnitY(hero)+LC5*Sin(L65))
call UPI(L45,L55,200)
call MUSetUnitX(hero,L45)
call MUSetUnitY(hero,L55)
endif
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)-GetUnitState(hero,UNIT_STATE_LIFE)*0.06*0.02)
call UPI(QXI,QYI,200)
if ModuloInteger(NPI,10)==0 then
set X8I=NTI()
set GK=hero
set i=0
loop
exitwhen i*50>X2I
set x=QXI+i*50*Cos(a)
set y=QYI+i*50*Sin(a)
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,130+25,Condition(function CA1))
call GroupAddGroup(g,X8I)
call GroupEnumUnitsInRange(g,x,y,130+25,Condition(function CT1))
call GroupAddGroup(g,X8I)
call NSI(g)
if ModuloInteger(i,3)==0 then
call I41(GetOwningPlayer(hero),2,x,y,225)
endif
set i=i+1
endloop
set X7I=hero
set X6I=GetUnitAbilityLevel(hero,'A1YY')
set LB5=(I2R(NPI)/50.0)/6
set X9I=(5*X6I+10)+(5*X6I+10)*LB5
set XAI=(X6I+LB5*(X6I))/100
call GroupRemoveUnit(X8I,hero)
call ForGroup(X8I,function JN5)
call NSI(X8I)
set g=null
set X8I=null
endif
if IsUnitDead(hero)==false then
if target!=null then
set K45=QLI(hero,target)
endif
set K55=QXI
set K65=QYI
set K75=JQ5+200
set K85=K55+K45*Cos(a)
set K95=K65+K45*Sin(a)
set KA5=JU5
set KB5=QXI+X3I*Cos((JP5-90)*bj_DEGTORAD)
set KC5=QYI+X4I*Cos((JP5-90)*bj_DEGTORAD)
set KD5=JQ5+200
set KE5=KB5+K45*Cos(a)
set KF5=KC5+K45*Sin(a)
set KG5=JU5
set KH5=QXI+X3I*Cos((JP5+90)*bj_DEGTORAD)
set KZ5=QYI+X4I*Cos((JP5+90)*bj_DEGTORAD)
set KV5=JQ5+200
set KW5=KH5+K45*Cos(a)
set KX5=KZ5+K45*Sin(a)
set KY5=JU5
set KJ5=QXI
set KK5=QYI
set KL5=JQ5+200+X5I
set KM5=KJ5+K45*Cos(a)
set KN5=KK5+K45*Sin(a)
set KS5=JU5
set KT5=QXI
set KR5=QYI
set KP5=JQ5+200-X5I
set KQ5=KT5+K45*Cos(a)
set KU5=KR5+K45*Sin(a)
set L05=JU5
if ModuloInteger(NPI,10)==0 and K45==X2I then
set x=GetUnitX(hero)+(X2I)*Cos(a)
set y=GetUnitY(hero)+(X2I)*Sin(a)
call DestroyEffect(AddSpecialEffect("war3mapImported\\FireRayTarget.mdx",x,y))
endif
if ModuloInteger(NPI,10)==0 then
call SetSoundPosition(JF,GetUnitX(hero),GetUnitY(hero),100)
set x=GetUnitX(hero)+(K45)*Cos(a)
set y=GetUnitY(hero)+(K45)*Sin(a)
set AR1=CreateUbersplat(x,y,"SRAY",255,255,255,255,false,false)
call SetUbersplatRenderAlways(AR1,true)
call AP1(AR1,10)
set AR1=null
endif
call MoveLightningEx(K05,false,K55,K65,K75,K85,K95,KA5)
call MoveLightningEx(KI5,false,KB5,KC5,KD5,KE5,KF5,KG5)
call MoveLightningEx(K15,false,KH5,KZ5,KV5,KW5,KX5,KY5)
call MoveLightningEx(KO5,false,KJ5,KK5,KL5,KM5,KN5,KS5)
call MoveLightningEx(K25,false,KT5,KR5,KP5,KQ5,KU5,L05)
if P0I(GetLocalPlayer())then
set K35=1
endif
call SetLightningColor(K05,1.00,1.00,1.00,K35)
call SetLightningColor(KI5,1.00,1.00,1.00,K35)
call SetLightningColor(K15,1.00,1.00,1.00,K35)
call SetLightningColor(KO5,1.00,1.00,1.00,K35)
call SetLightningColor(K25,1.00,1.00,1.00,K35)
endif
endif
set t=null
set hero=null
set K05=null
set KI5=null
set K15=null
set KO5=null
set K25=null
set l1=null
set l2=null
return false
endfunction
function LD5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),GetSpellTargetX(),GetSpellTargetY())*bj_DEGTORAD
local real QJI=PTI(GetUnitX(hero)+X2I*Cos(a))
local real QKI=PUI(GetUnitY(hero)+X2I*Sin(a))
local lightning K05=AddLightning("SRAY",false,GetUnitX(hero),GetUnitY(hero),QJI,QKI)
local lightning KI5=AddLightning("SRAY",false,GetUnitX(hero),GetUnitY(hero),QJI,QKI)
local lightning K15=AddLightning("SRAY",false,GetUnitX(hero),GetUnitY(hero),QJI,QKI)
local lightning KO5=AddLightning("SRAY",false,GetUnitX(hero),GetUnitY(hero),QJI,QKI)
local lightning K25=AddLightning("SRAY",false,GetUnitX(hero),GetUnitY(hero),QJI,QKI)
call SetUnitFacing(hero,a*bj_RADTODEG)
call StartSound(JF)
call SetSoundPosition(JF,GetUnitX(hero),GetUnitY(hero),100)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function JR5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(13),((a)*1.0))
call SaveReal(LY,(handle_id),(688),((a*bj_RADTODEG)*1.0))
call SaveLightningHandle(LY,(handle_id),(676),(K05))
call SaveLightningHandle(LY,(handle_id),(677),(KI5))
call SaveLightningHandle(LY,(handle_id),(678),(K15))
call SaveLightningHandle(LY,(handle_id),(679),(KO5))
call SaveLightningHandle(LY,(handle_id),(680),(K25))
call SaveBoolean(LY,(handle_id),(689),(false))
call SaveBoolean(LY,(handle_id),(672),(true))
call SaveReal(LY,(handle_id),(688),((a*bj_RADTODEG)*1.0))
call SaveReal(LY,(handle_id),(23),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(hero))*1.0))
call BT1(hero)
call SaveInteger(LY,(GetHandleId((hero))),((4312)),(1))
call SetUnitPathing(hero,false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1Z3',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A205',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YY',false)
call AddSkill(hero,'A1Z3')
call UnitMakeAbilityPermanent(hero,true,'A1Z3')
call AddSkill(hero,'A205')
call UnitMakeAbilityPermanent(hero,true,'A205')
call TriggerEvaluate(t)
set t=null
set hero=null
set hero=null
set K05=null
set KI5=null
set K15=null
set KO5=null
set K25=null
endfunction
function LE5 takes nothing returns boolean
if GetSpellAbilityId()=='A1YY' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
else
call LD5()
endif
endif
return false
endfunction
function RG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function LE5))
call B01('A1Z4')
call B01('A1ZA')
call B01('A1ZB')
call B01('A1Z9')
set t=null
endfunction
function LF5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A1YX')
if GetTriggerEventId()==EVENT_UNIT_DEATH or(TimerGetElapsed(M))>=(LoadReal(LY,(GetHandleId(target)),(757)))or RKI(target)==true then
call UnitRemoveAbility(target,'A2W7')
call UnitRemoveAbility(target,'A2W9')
call UnitRemoveAbility(target,'A2L8')
call UnitRemoveAbility(target,'A2W8')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
if ModuloInteger(GetTriggerEvalCount(t),4)==0 then
call Damage(hero,target,1,20*level-10)
endif
set t=null
set hero=null
return false
endfunction
function LG5 takes nothing returns nothing
local unit hero=XBI
local unit target=GetEnumUnit()
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(hero,'A1YX')
local integer LH5
call SaveReal(LY,(GetHandleId(target)),(757),(((TimerGetElapsed(M))+4)*1.0))
if GetUnitAbilityLevel(target,'A2W7')==0 and GetUnitAbilityLevel(target,'A2W9')==0 and GetUnitAbilityLevel(target,'A2L8')==0 and GetUnitAbilityLevel(target,'A2W8')==0 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function LF5))
call TriggerRegisterDeathEvent(t,target)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",target,"chest")))
if BJ1(target)==false then
if level==1 then
set LH5='A2W7'
elseif level==2 then
set LH5='A2W9'
elseif level==3 then
set LH5='A2L8'
elseif level==4 then
set LH5='A2W8'
endif
call UnitAddAbility(target,LH5)
call UnitMakeAbilityPermanent(target,true,LH5)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(target),LH5,false)
endif
set hero=null
set target=null
set t=null
endfunction
function LZ5 takes unit hero,unit IG1,real IS5,unit dummy,unit target returns nothing
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local group g=NTI()
set GK=hero
set XBI=hero
call GroupEnumUnitsInRange(g,x,y,175+25,Condition(function CE1))
call ForGroup(g,function LG5)
call NSI(g)
call DestroyEffect(AddSpecialEffect("war3mapImported\\Firaga_2.mdx",x,y))
call KillUnit(IG1)
call ShowUnit(IG1,false)
set g=null
endfunction
function LV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit LW5=(LoadUnitHandle(LY,(handle_id),(393)))
local real IS5=(LoadReal(LY,(handle_id),(685)))
local real QJI
local real QKI
local real x
local real y
local real a
local real r=18
local integer level=GetUnitAbilityLevel(hero,'A1YX')
if GetTriggerEventId()==EVENT_UNIT_DEATH then
set QJI=GetUnitX(target)
set QKI=GetUnitY(target)
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call RemoveSavedHandle(LY,(handle_id),(17))
call SaveUnitHandle(LY,(handle_id),(17),(null))
elseif target==null then
set QJI=(LoadReal(LY,(handle_id),(47)))
set QKI=(LoadReal(LY,(handle_id),(48)))
else
set QJI=GetUnitX(target)
set QKI=GetUnitY(target)
endif
set a=UEI(GetUnitX(LW5),GetUnitY(LW5),QJI,QKI)
call SetUnitFacing(LW5,a)
set x=GetUnitX(LW5)+r*Cos(a*bj_DEGTORAD)
set y=GetUnitY(LW5)+r*Sin(a*bj_DEGTORAD)
call MUSetUnitX(LW5,x)
call MUSetUnitY(LW5,y)
if QNI(x,y,QJI,QKI)<r*2 then
call LZ5(hero,LW5,IS5,dummy,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
set LW5=null
set dummy=null
return false
endfunction
function LX5 takes unit hero,unit LW5,unit target,real IS5,unit dummy returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g
local unit NewTarget
if hero==target then
call KillUnit(LW5)
call ShowUnit(LW5,false)
else
call SetUnitVertexColor(LW5,255,255,255,255)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function LV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(393),(LW5))
call SaveReal(LY,(handle_id),(47),((GetSpellTargetX())*1.0))
call SaveReal(LY,(handle_id),(48),((GetSpellTargetY())*1.0))
call SaveReal(LY,(handle_id),(685),((IS5)*1.0))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
endif
set t=null
endfunction
function LY5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local unit LJ5=(LoadUnitHandle(LY,(handle_id),(393)))
local unit LK5=(LoadUnitHandle(LY,(handle_id),(394)))
local unit LL5=(LoadUnitHandle(LY,(handle_id),(395)))
local unit LM5=(LoadUnitHandle(LY,(handle_id),(396)))
local integer level=GetUnitAbilityLevel(hero,'A1YX')
local real a=GetUnitFacing(hero)
local real x
local real y
local group g
local group g2
local real JC3=-1*360*0.02/4
local real a2
local real DJ1
local real IS5=(LoadReal(LY,(handle_id),(685)))
local real S83
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer LN5=800
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A1Z2' then
if IsUnitDead(LJ5)==false then
call LX5(hero,LJ5,GetSpellTargetUnit(),IS5,dummy)
call RemoveSavedHandle(LY,(handle_id),(393))
elseif IsUnitDead(LK5)==false then
call LX5(hero,LK5,GetSpellTargetUnit(),IS5,dummy)
call RemoveSavedHandle(LY,(handle_id),(394))
elseif IsUnitDead(LL5)==false then
call LX5(hero,LL5,GetSpellTargetUnit(),IS5,dummy)
call RemoveSavedHandle(LY,(handle_id),(395))
elseif IsUnitDead(LM5)==false then
call LX5(hero,LM5,GetSpellTargetUnit(),IS5,dummy)
call RemoveSavedHandle(LY,(handle_id),(396))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1Z2',false)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1YX' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YX',true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
elseif GetSpellAbilityId()=='A1RK' then
if LJ5!=null and IsUnitDead(LJ5)==false then
call LX5(hero,LJ5,hero,IS5,dummy)
endif
if LK5!=null and IsUnitDead(LK5)==false then
call LX5(hero,LK5,hero,IS5,dummy)
endif
if LL5!=null and IsUnitDead(LL5)==false then
call LX5(hero,LL5,hero,IS5,dummy)
endif
if LM5!=null and IsUnitDead(LM5)==false then
call LX5(hero,LM5,hero,IS5,dummy)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1Z2',false)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1YX' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YX',true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if LJ5!=null and IsUnitDead(LJ5)==false then
set DJ1=360*4/4.0
set a2=DJ1+JC3*NPI
set x=PTI(QXI+200*Cos(a2*bj_DEGTORAD))
set y=PUI(QYI+200*Sin(a2*bj_DEGTORAD))
call SetUnitFacing(LJ5,a2-90)
call MUSetUnitX(LJ5,x)
call MUSetUnitY(LJ5,y)
endif
if LK5!=null and IsUnitDead(LK5)==false then
set DJ1=360*3/4.0
set a2=DJ1+JC3*NPI
set x=PTI(QXI+200*Cos(a2*bj_DEGTORAD))
set y=PUI(QYI+200*Sin(a2*bj_DEGTORAD))
call SetUnitFacing(LK5,a2-90)
call MUSetUnitX(LK5,x)
call MUSetUnitY(LK5,y)
endif
if LL5!=null and IsUnitDead(LL5)==false then
set DJ1=360*2/4.0
set a2=DJ1+JC3*NPI
set x=PTI(QXI+200*Cos(a2*bj_DEGTORAD))
set y=PUI(QYI+200*Sin(a2*bj_DEGTORAD))
call SetUnitFacing(LL5,a2-90)
call MUSetUnitX(LL5,x)
call MUSetUnitY(LL5,y)
endif
if LM5!=null and IsUnitDead(LM5)==false then
set DJ1=360*1/4.0
set a2=DJ1+JC3*NPI
set x=PTI(QXI+200*Cos(a2*bj_DEGTORAD))
set y=PUI(QYI+200*Sin(a2*bj_DEGTORAD))
call SetUnitFacing(LM5,a2-90)
call MUSetUnitX(LM5,x)
call MUSetUnitY(LM5,y)
endif
if NPI>LN5 or GetTriggerEventId()==EVENT_UNIT_DEATH then
if LJ5!=null and IsUnitDead(LJ5)==false then
call LX5(hero,LJ5,hero,IS5,dummy)
endif
if LK5!=null and IsUnitDead(LK5)==false then
call LX5(hero,LK5,hero,IS5,dummy)
endif
if LL5!=null and IsUnitDead(LL5)==false then
call LX5(hero,LL5,hero,IS5,dummy)
endif
if LM5!=null and IsUnitDead(LM5)==false then
call LX5(hero,LM5,hero,IS5,dummy)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1Z2',false)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1YX' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YX',true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set IS5=RMinBJ(0.25+0.75*(I2R(NPI)/500.0),1)
call SaveReal(LY,(handle_id),(685),((IS5)*1.0))
set S83=0.25+(1-0.2)*2.5
call SetUnitScale(LJ5,S83,S83,S83)
call SetUnitScale(LK5,S83,S83,S83)
call SetUnitScale(LL5,S83,S83,S83)
call SetUnitScale(LM5,S83,S83,S83)
if NPI==(LN5-175)then
call OQ1(KF,GetOwningPlayer(hero))
endif
if NPI>(LN5-200)then
if ModuloInteger(NPI,10)==0 or ModuloInteger(NPI,10)==1 or ModuloInteger(NPI,10)==2 or ModuloInteger(NPI,10)==3 or ModuloInteger(NPI,10)==4 then
call SetUnitVertexColor(LJ5,255,0,0,255)
call SetUnitVertexColor(LK5,255,0,0,255)
call SetUnitVertexColor(LL5,255,0,0,255)
call SetUnitVertexColor(LM5,255,0,0,255)
else
call SetUnitVertexColor(LJ5,255,255,255,255)
call SetUnitVertexColor(LK5,255,255,255,255)
call SetUnitVertexColor(LL5,255,255,255,255)
call SetUnitVertexColor(LM5,255,255,255,255)
endif
endif
endif
endif
set t=null
set hero=null
set LJ5=null
set LK5=null
set LL5=null
set LM5=null
set dummy=null
return false
endfunction
function LS5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real x
local real y
local unit LJ5
local unit LK5
local unit LL5
local unit LM5
local real a=GetUnitFacing(hero)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',QXI,QYI,0)
call UnitAddAbility(dummy,'A21U')
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)-GetUnitState(hero,UNIT_STATE_LIFE)*0.20)
call AddSkill(hero,'A1Z2')
call UnitMakeAbilityPermanent(hero,true,'A1Z2')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1Z2',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YX',false)
set x=GetUnitX(hero)+200*Cos(bj_DEGTORAD*360*4/4.0*-1.0)
set y=GetUnitY(hero)+200*Sin(bj_DEGTORAD*360*4/4.0*-1.0)
set LJ5=CreateUnit(GetOwningPlayer(hero),'h0CU',x,y,360*4/4.0*-1.0)
set x=GetUnitX(hero)+200*Cos(bj_DEGTORAD*360*3/4.0*-1.0)
set y=GetUnitY(hero)+200*Sin(bj_DEGTORAD*360*3/4.0*-1.0)
set LK5=CreateUnit(GetOwningPlayer(hero),'h0CU',x,y,360*3/4.0*-1.0)
set x=GetUnitX(hero)+200*Cos(bj_DEGTORAD*360*2/4.0*-1.0)
set y=GetUnitY(hero)+200*Sin(bj_DEGTORAD*360*2/4.0*-1.0)
set LL5=CreateUnit(GetOwningPlayer(hero),'h0CU',x,y,360*2/4.0*-1.0)
set x=GetUnitX(hero)+200*Cos(bj_DEGTORAD*360*1/4.0*-1.0)
set y=GetUnitY(hero)+200*Sin(bj_DEGTORAD*360*1/4.0*-1.0)
set LM5=CreateUnit(GetOwningPlayer(hero),'h0CU',x,y,360*1/4.0*-1.0)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function LY5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(393),(LJ5))
call SaveUnitHandle(LY,(handle_id),(394),(LK5))
call SaveUnitHandle(LY,(handle_id),(395),(LL5))
call SaveUnitHandle(LY,(handle_id),(396),(LM5))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
set hero=null
set LJ5=null
set LK5=null
set LL5=null
set LM5=null
set dummy=null
endfunction
function LT5 takes nothing returns boolean
if GetSpellAbilityId()=='A1YX' then
call LS5()
endif
return false
endfunction
function RF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function LT5))
set t=null
endfunction
function LR5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2L1')
if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>4 then
call UnitRemoveAbility(target,'A2L8')
call SaveInteger(LY,(GetHandleId((target))),((4311)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call Damage(hero,target,1,20*level)
set t=null
set hero=null
return false
endfunction
function LP5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function LR5))
call TriggerRegisterDeathEvent(t,target)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",target,"chest")))
call UnitAddAbility(target,'A2L8')
call UnitMakeAbilityPermanent(target,true,'A2L8')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2L8',false)
call SaveInteger(LY,(GetHandleId((target))),((4311)),(1))
set hero=null
set target=null
set t=null
endfunction
function LQ5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local group g=NTI()
call DestroyEffect(AddSpecialEffect("Environment\\LargeBuildingFire\\LargeBuildingFire1.mdl",x,y))
call GroupEnumUnitsInRange(g,x,y,275+25,Condition(function C51))
call ForGroup(g,function LP5)
call NSI(g)
set g=null
set hero=null
endfunction
function LU5 takes nothing returns boolean
if GetSpellAbilityId()=='A2L1' then
call LQ5()
endif
return false
endfunction
function RD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function LU5))
set t=null
endfunction
function M05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=(LoadInteger(LY,(GetHandleId(target)),(627)))
local real MI5=(LoadReal(LY,(GetHandleId(target)),(628)))
local integer level=GetUnitAbilityLevel(hero,'A1S4')
local real PAI=(5+level*15)*Pow(2,IMinBJ(NPI,5)-1)
set PAI=PAI+IMaxBJ(NPI-5,0)*50
if GetTriggerEventId()==EVENT_UNIT_DEATH then
if IsUnitType(target,UNIT_TYPE_HERO)==true then
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId(target)),(627),(0))
call SaveReal(LY,(GetHandleId(target)),(628),((0)*1.0))
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A1S9' then
if IsUnitType(target,UNIT_TYPE_HERO)==true then
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId(target)),(627),(0))
call SaveReal(LY,(GetHandleId(target)),(628),((0)*1.0))
if((LoadInteger(LY,(GetHandleId((target))),((4293))))==1)then
call SetUnitInvulnerable(target,false)
endif
call Damage(hero,target,1,PAI)
if((LoadInteger(LY,(GetHandleId((target))),((4293))))==1)then
call SetUnitInvulnerable(target,true)
endif
call UYI(I2S(R2I(PAI))+"!",2,target,0.025,100,0,200,216)
endif
elseif(TimerGetElapsed(M))>MI5 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
if IsUnitType(target,UNIT_TYPE_HERO)==true then
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId(target)),(627),(0))
call SaveReal(LY,(GetHandleId(target)),(628),((0)*1.0))
if((LoadInteger(LY,(GetHandleId((target))),((4293))))==1)then
call SetUnitInvulnerable(target,false)
endif
call Damage(hero,target,1,PAI)
if((LoadInteger(LY,(GetHandleId((target))),((4293))))==1)then
call SetUnitInvulnerable(target,true)
endif
call UYI(I2S(R2I(PAI))+"!",2,target,0.025,100,0,200,216)
else
if IsUnitType(target,UNIT_TYPE_HERO)==true then
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function M15 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(hero,'A1S4')
local unit IG1
if(LoadInteger(LY,(GetHandleId(target)),(627)))>0 then
call SaveInteger(LY,(GetHandleId(target)),(627),((LoadInteger(LY,(GetHandleId(target)),(627)))+1))
call SaveReal(LY,(GetHandleId(target)),(628),(((TimerGetElapsed(M))+10)*1.0))
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
if IsUnitType(target,UNIT_TYPE_HERO)==true then
endif
call SaveInteger(LY,(GetHandleId(target)),(627),(1))
if IsUnitType(target,UNIT_TYPE_HERO)==true then
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\shamanyouranus-ShadowyMissile.mdl",target,"chest")))
else
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\shamanyouranus-ShadowyMissile.mdl",target,"origin")))
endif
call SaveReal(LY,(GetHandleId(target)),(628),(((TimerGetElapsed(M))+10)*1.0))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function M05))
set IG1=null
endif
call UYI("+"+I2S((LoadInteger(LY,(GetHandleId(target)),(627)))),3,target,0.025,100,0,200,216)
call Damage(hero,target,1,50)
set t=null
endfunction
function MO5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XDI)==false then
call GroupAddUnit(XDI,GetEnumUnit())
call M15(XCI,GetEnumUnit())
endif
endfunction
function M25 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local integer NPI=GetTriggerEvalCount(t)
local real a=(LoadReal(LY,(handle_id),(137)))
local real x=PTI(GetUnitX(IG1)+(20)*Cos(a))
local real y=PUI(GetUnitY(IG1)+(20)*Sin(a))
local group g
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local unit target
if NPI==75 then
call NSI(JAO)
call KillUnit(IG1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set GK=hero
set XCI=hero
set XDI=JAO
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,190+25,Condition(function CE1))
call ForGroup(g,function MO5)
set target=FirstOfGroup(g)
call NSI(g)
endif
set t=null
set hero=null
set IG1=null
set g=null
set target=null
set JAO=null
return false
endfunction
function M35 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),x,y)*bj_DEGTORAD
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0C2',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function M25))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveGroupHandle(LY,(handle_id),(133),(NTI()))
call AddSkill(hero,'A1S9')
set t=null
set hero=null
set IG1=null
endfunction
function M45 takes nothing returns boolean
if GetSpellAbilityId()=='A1S4' then
call M35()
endif
return false
endfunction
function RW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function M45))
set t=null
endfunction
function M55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit M65=GetSummonedUnit()
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_SUMMON then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetUnitAbilityLevel(M65,'B0DA')>0 and GetOwningPlayer(GetSummoningUnit())==GetOwningPlayer(hero)then
if IsUnitAlly(target,GetOwningPlayer(hero))==true then
call SelectUnitAddForPlayer(M65,GetOwningPlayer(hero))
else
call IssueTargetOrder(M65,"attack",target)
endif
endif
set t=null
set hero=null
set target=null
set M65=null
return false
endfunction
function M75 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call SaveInteger(LY,(GetHandleId((target))),((4293)),(2))
call SetUnitInvulnerable(target,false)
call PauseUnit(target,false)
call ShowUnit(target,true)
call RemoveSavedHandle(LY,(GetHandleId(target)),(673))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()!=EVENT_UNIT_DEATH then
call ClearSelectionForPlayer(GetOwningPlayer(target))
call SelectUnitAddForPlayer(target,GetOwningPlayer(target))
call IO1(DF,GetUnitX(target),GetUnitY(target))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,3,false)
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function M55))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(dummy,'A1S5')
call SetUnitAbilityLevel(dummy,'A1S5',GetUnitAbilityLevel(hero,'A1S8'))
call IssueTargetOrderById(dummy,852274,target)
call IssueTargetOrderById(dummy,852274,target)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function M85 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A1S8')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(target),'o019',GetUnitX(target),GetUnitY(target),0)
call UnitApplyTimedLife(dummy,'BTLF',2.6)
if IsUnitAlly(target,GetOwningPlayer(hero))==false then
set dummy=CreateUnit(GetOwningPlayer(hero),'o019',GetUnitX(target),GetUnitY(target),0)
call UnitApplyTimedLife(dummy,'BTLF',2.6)
endif
call SetUnitInvulnerable(target,true)
call PauseUnit(target,true)
call ShowUnit(target,false)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\WILLTHEALMIGHTY-Void5.mdx",GetUnitX(target),GetUnitY(target))))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function M75))
call SaveUnitHandle(LY,(GetHandleId(hero)),(673),(target))
call SaveInteger(LY,(GetHandleId((target))),((4293)),(1))
set hero=null
set target=null
set t=null
set dummy=null
endfunction
function M95 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A1S8' and(IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true or CanResistSkill(GetSpellTargetUnit())==false)then
call M85()
endif
else
if GetSpellAbilityId()=='A1S8' and GetSpellTargetUnit()!=GetTriggerUnit()and IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endif
return false
endfunction
function RX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function M95))
set t=null
endfunction
function MA5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A1SB')
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetEventDamage()>5 then
call DisableTrigger(t)
call Damage(GetEventDamageSource(),GetTriggerUnit(),3,(0.1+0.1*level)*GetEventDamage())
call EnableTrigger(t)
endif
set hero=null
set t=null
return false
endfunction
function MB5 takes nothing returns nothing
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local group g=NTI()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A1SB')
local unit target
local trigger t
local integer handle_id
set GK=hero
call GroupEnumUnitsInRange(g,x,y,475,Condition(function CE1))
set target=(LoadUnitHandle(LY,(GetHandleId(hero)),(673)))
if target!=null then
if QNI(GetUnitX(target),GetUnitY(target),x,y)<475 and IsUnitEnemy(target,GetOwningPlayer(hero))==true then
call GroupAddUnit(g,target)
endif
endif
set target=GroupPickRandomUnit(g)
call NSI(g)
call DestroyEffect(AddSpecialEffect("war3mapImported\\Desecrate.mdx",x,y))
if target!=null then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,12,false)
call TriggerAddCondition(t,Condition(function MA5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\void.mdx",target,"chest")))
endif
set g=null
set hero=null
set target=null
set t=null
endfunction
function MC5 takes nothing returns boolean
if GetSpellAbilityId()=='A1SB' then
call MB5()
endif
return false
endfunction
function RY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MC5))
set t=null
endfunction
function MD5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=GetTriggerEvalCount(t)
local integer level=GetUnitAbilityLevel(hero,'A2XI')
if level==0 then
set level=GetUnitAbilityLevel(hero,'A1SA')
endif
if NPI==5 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if((LoadInteger(LY,(GetHandleId((target))),((4293))))==1)then
call SetUnitInvulnerable(target,false)
endif
call Damage(hero,target,1,4*(25+25*level))
if((LoadInteger(LY,(GetHandleId((target))),((4293))))==1)then
call SetUnitInvulnerable(target,true)
endif
else
endif
set t=null
set hero=null
set target=null
return false
endfunction
function ME5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function MD5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerEvaluate(t)
set t=null
set hero=null
set target=null
endfunction
function MF5 takes nothing returns boolean
if(GetSpellAbilityId()=='A2XI' or GetSpellAbilityId()=='A1SA')and IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true and CanResistSkill(GetSpellTargetUnit())==false then
call ME5()
endif
return false
endfunction
function MG5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(826)))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=GetUnitAbilityLevel(hero,'A2XE')
if JGO>0 then
call UnitAddAbility(dummy,'A1SA')
call SetUnitAbilityLevel(dummy,'A1SA',level)
call IssueTargetOrder(dummy,"purge",target)
call UnitRemoveAbility(hero,XEI[JGO])
set JGO=JGO-1
call SaveInteger(LY,(GetHandleId(hero)),(826),(JGO))
call AddSkill(hero,XEI[JGO])
endif
set hero=null
set target=null
endfunction
function MH5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(826)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if JGO<3 then
set NPI=NPI-1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==0 then
call UnitRemoveAbility(hero,XEI[JGO])
set NPI=40
call SaveInteger(LY,(handle_id),(34),(NPI))
set JGO=JGO+1
call SaveInteger(LY,(GetHandleId(hero)),(826),(JGO))
call AddSkill(hero,XEI[JGO])
endif
endif
set t=null
set hero=null
return false
endfunction
function MZ5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2XE')
local trigger t
local integer handle_id
local integer MV5=GetUnitAbilityLevel(hero,XEI[0])
local integer MW5=GetUnitAbilityLevel(hero,XEI[1])
local integer MX5=GetUnitAbilityLevel(hero,XEI[2])
local integer MY5=GetUnitAbilityLevel(hero,XEI[3])
if level>0 and(MV5+MW5+MX5+MY5)==0 then
call UnitRemoveAbility(hero,'A1SA')
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(hero)),(826),(3))
call AddSkill(hero,XEI[3])
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function MH5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(40))
set t=null
endif
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2XI')
if level>0 then
call AddSkill(hero,'A1SA')
call SetUnitAbilityLevel(hero,'A1SA',level)
endif
endif
set hero=null
endfunction
function MJ5 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_HERO_SKILL then
if(GetLearnedSkill()=='A2XI' or GetLearnedSkill()=='A2XE')and IsUnitIllusion(GetTriggerUnit())==false then
call MZ5()
endif
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
if GetItemType(GetManipulatedItem())==ITEM_TYPE_PERMANENT and F01(GetManipulatedItem())==L30 then
call MZ5()
endif
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if(GetSpellAbilityId()==XEI[0]or GetSpellAbilityId()==XEI[1]or GetSpellAbilityId()==XEI[2]or GetSpellAbilityId()==XEI[3])and IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==true and CanResistSkill(GetSpellTargetUnit())==false then
call MG5()
endif
endif
return false
endfunction
function RJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MF5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MJ5))
set XEI[0]='A2XH'
set XEI[1]='A2XC'
set XEI[2]='A2XB'
set XEI[3]='A2Y4'
set t=null
endfunction
function MK5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'A1SP')
set t=null
set hero=null
return false
endfunction
function ML5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call AddSkill(hero,'A1SP')
call UnitMakeAbilityPermanent(hero,true,'A1SP')
call SetUnitAbilityLevel(hero,'A1SP',GetUnitAbilityLevel(hero,'A1SO'))
call TriggerRegisterTimerEvent(t,3,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function MK5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function MM5 takes nothing returns boolean
if GetSpellAbilityId()=='A1SO' then
call ML5()
endif
return false
endfunction
function RK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MM5))
set t=null
endfunction
function MN5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer NPI=GetTriggerEvalCount(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x
local real y
local real d
local real DH1
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real a=UEI(II3,I13,GetUnitX(target),GetUnitY(target))*bj_DEGTORAD
local integer level=GetUnitAbilityLevel(hero,'A1SQ')
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call UnitShareVision(IG1,GetOwningPlayer(target),false)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()!=IG1 then
call KillUnit(IG1)
endif
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
call UnitRemoveBuffs(IG1,true,true)
elseif NPI<3/0.02 then
call SetUnitFacing(IG1,a*bj_RADTODEG)
else
if NPI==4/0.02 then
call UnitShareVision(IG1,GetOwningPlayer(target),true)
endif
call SetUnitFacing(IG1,a*bj_RADTODEG)
set x=II3+(280+XFI*NPI*0.02)*0.02*Cos(a)
set y=I13+(280+XFI*NPI*0.02)*0.02*Sin(a)
call SetUnitPosition(IG1,x,y)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
if QNI(x,y,GetUnitX(target),GetUnitY(target))<20 then
set d=RMinBJ(QNI(x,y,(LoadReal(LY,(handle_id),(6))),(LoadReal(LY,(handle_id),(7)))),1500)
set DH1=d/1500*(125*GetUnitAbilityLevel(hero,'A1SQ'))
set DH1=RMaxBJ(DH1,50)
call KillUnit(IG1)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call Damage(hero,target,1,DH1)
call DD1(hero,target,2+0.2*level)
endif
endif
set t=null
set hero=null
set target=null
set IG1=null
return false
endfunction
function MS5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))*bj_DEGTORAD
local real x=PTI(GetUnitX(hero)+150*Cos(a))
local real y=PUI(GetUnitY(hero)+150*Sin(a))
local integer level=GetUnitAbilityLevel(hero,'A1SQ')
local unit IG1
local integer RII
local string s="effects\\Snipe Target.mdx"
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))==false and P0I(GetLocalPlayer())==false then
set s=""
endif
if level==1 then
set RII='h0CG'
elseif level==2 then
set RII='h0C1'
elseif level==3 then
set RII='h0CF'
elseif level==4 then
set RII='h0CH'
endif
set IG1=CreateUnit(GetOwningPlayer(hero),RII,x,y,a*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,IG1,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,IG1,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function MN5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(23),((GetUnitX(IG1))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(IG1))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(s,target,"overhead")))
set t=null
set hero=null
set IG1=null
endfunction
function MT5 takes nothing returns boolean
if GetSpellAbilityId()=='A1SQ' and CanResistSkill(GetSpellTargetUnit())==false then
call MS5()
endif
return false
endfunction
function RL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function MT5))
call Q1I('A0X6')
set t=null
endfunction
function MR5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A1SS')
call UnitRemoveAbility(target,'B0DE')
set t=null
set target=null
return false
endfunction
function MP5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A1T4')
call UnitRemoveAbility(target,'B0DG')
set t=null
set target=null
return false
endfunction
function MQ5 takes nothing returns nothing
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(XGI,'A1T5')
local boolean CK3=false
if level==0 then
set level=GetUnitAbilityLevel(XGI,'A235')
set CK3=true
endif
if BJ1(GetEnumUnit())==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,2,false)
call TriggerRegisterUnitEvent(t,GetEnumUnit(),EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function MR5))
call SaveUnitHandle(LY,(handle_id),(17),(GetEnumUnit()))
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A1SS',false)
call AddSkill(GetEnumUnit(),'A1SS')
endif
call Damage(XGI,GetEnumUnit(),1,level*50+200)
set t=null
endfunction
function MU5 takes nothing returns nothing
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(XGI,'A1T5')
local boolean CK3=false
if level==0 then
set level=GetUnitAbilityLevel(XGI,'A235')
set CK3=true
endif
if BJ1(GetEnumUnit())==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,3,false)
call TriggerRegisterUnitEvent(t,GetEnumUnit(),EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function MP5))
call SaveUnitHandle(LY,(handle_id),(17),(GetEnumUnit()))
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A1T4',false)
call AddSkill(GetEnumUnit(),'A1T4')
endif
if CK3 then
call Damage(XGI,GetEnumUnit(),1,level*50+50+75)
else
call Damage(XGI,GetEnumUnit(),1,level*50+50)
endif
set t=null
endfunction
function N05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g
local integer NPI=GetTriggerEvalCount(t)
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
if NPI==1 then
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\Calldown_FlyUp.mdx",hero,"chest"))
elseif NPI==2 then
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\Calldown_FlyUp.mdx",hero,"chest"))
elseif NPI==3 then
call DestroyEffect(AddSpecialEffect("war3mapImported\\Calldown_FlyDown.mdx",x,y))
elseif NPI==4 then
set g=NTI()
set GK=hero
set XGI=hero
call GroupEnumUnitsInRange(g,x,y,600+25,Condition(function CA1))
call ForGroup(g,function MQ5)
call NSI(g)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\DemolisherFireMissile\\DemolisherFireMissile.mdl",x,y))
elseif NPI==5 then
call DestroyEffect(AddSpecialEffect("war3mapImported\\Calldown_FlyDown.mdx",x,y))
elseif NPI==6 then
set g=NTI()
set GK=hero
set XGI=hero
call GroupEnumUnitsInRange(g,x,y,600+25,Condition(function CA1))
call ForGroup(g,function MU5)
call NSI(g)
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\DemolisherFireMissile\\DemolisherFireMissile.mdl",x,y))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set g=null
return false
endfunction
function NI5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local string s=""
local fogmodifier I31=CreateFogModifierRadius(GetOwningPlayer(hero),FOG_OF_WAR_VISIBLE,x,y,350,true,true)
call FogModifierStart(I31)
if IsPlayerAlly(GetLocalPlayer(),GetOwningPlayer(hero))==true or P0I(GetLocalPlayer())then
set s="war3mapImported\\CallDown_4.mdx"
endif
call TriggerRegisterTimerEvent(t,0.1,false)
call TriggerRegisterTimerEvent(t,0.8,false)
call TriggerRegisterTimerEvent(t,1.6,false)
call TriggerRegisterTimerEvent(t,2,false)
call TriggerRegisterTimerEvent(t,3.6,false)
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function N05))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect(s,x,y)))
call SaveFogModifierHandle(LY,(handle_id),(42),(I31))
set t=null
set hero=null
endfunction
function N15 takes nothing returns boolean
if GetSpellAbilityId()=='A1T5' or GetSpellAbilityId()=='A235' then
call NI5()
endif
return false
endfunction
function RM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function N15))
set t=null
endfunction
function NO5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer UT3=(LoadInteger(LY,(handle_id),(375)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and(GetEventDamage()>20 or IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==true)then
set NPI=(LoadInteger(LY,(UT3),(34)))
if NPI>0 then
call SaveInteger(LY,(UT3),(34),(NPI+1))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function N25 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if P2I(hero)==false then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A237')
call UnitAddAbility(hero,'A22B')
call UnitRemoveAbility(hero,'A22B')
if(ES1((hero),FR0[KN0])!=null)then
call UnitAddAbility(hero,'A237')
endif
endif
set t=null
set hero=null
return false
endfunction
function N35 takes unit hero returns nothing
local trigger t
local integer handle_id
if P2I(hero)==false then
call UnitRemoveAbility(hero,'A237')
call UnitAddAbility(hero,'A22B')
call UnitRemoveAbility(hero,'A22B')
if(ES1((hero),FR0[KN0])!=null)then
call UnitAddAbility(hero,'A237')
endif
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function N25))
set t=null
endif
endfunction
function N45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=GetUnitAbilityLevel(hero,'A229')
local integer UT3=handle_id
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if IsUnitIllusion(GetAttacker())==true and GetUnitAbilityLevel(GetAttacker(),'A1TW')>0 then
call N35(GetAttacker())
call UnitRemoveAbility(GetAttacker(),'A1TW')
endif
if GetAttacker()==hero then
set NPI=NPI+1
if NPI>3+level then
call UnitRemoveAbility(hero,'A1TW')
call UnitRemoveAbility(hero,'B0DJ')
call N35(hero)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2,false)
call TriggerAddCondition(t,Condition(function NO5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(375),(UT3))
endif
endif
else
call UnitRemoveAbility(hero,'A1TW')
call UnitRemoveAbility(hero,'B0DJ')
call N35(hero)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function N55 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,15,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function N45))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(1))
call UnitRemoveAbility(hero,'A237')
call UnitAddAbility(hero,'A22A')
call UnitRemoveAbility(hero,'A22A')
if(ES1((hero),FR0[KN0])!=null)then
call UnitAddAbility(hero,'A237')
endif
set t=null
set hero=null
endfunction
function N65 takes nothing returns boolean
if IsUnitIllusion(GetTriggerUnit())==true and GetUnitTypeId(GetTriggerUnit())=='E02O' then
call N35(GetTriggerUnit())
endif
return false
endfunction
function N75 takes nothing returns boolean
if GetSpellAbilityId()=='A229' and GetUnitTypeId(GetTriggerUnit())=='E02N' then
call N55()
endif
return false
endfunction
function RN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function N75))
set t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,GetWorldBounds())
call TriggerAddCondition(t,Condition(function N65))
set t=null
endfunction
function N85 takes nothing returns boolean
local unit target=GetFilterUnit()
local unit hero=XHI
local real QXI=XZI
local real QYI=XVI
local real IO3=XWI
local real I23=XXI
local real x
local real y
local real a
local real d
if(RKI(GetFilterUnit())==false and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))then
if((LoadInteger(LY,(GetHandleId((target))),((4324))))==1)==false then
call SCI(target,4324,0.3)
endif
set d=QNI(QXI,QYI,GetUnitX(target),GetUnitY(target))
set a=UEI(QXI,QYI,GetUnitX(target),GetUnitY(target))*bj_DEGTORAD
if d>XYI then
set x=GetUnitX(target)+11*Cos(a)
set y=GetUnitY(target)+11*Sin(a)
else
set x=GetUnitX(target)-11*Cos(a)
set y=GetUnitY(target)-11*Sin(a)
endif
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
endif
set target=null
set hero=null
return false
endfunction
function N95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QXI=(LoadReal(LY,(handle_id),(6)))
local real QYI=(LoadReal(LY,(handle_id),(7)))
local real x
local real y
local integer i=0
local group g
if GetTriggerEvalCount(t)>(50*(2+0.5*GetUnitAbilityLevel(hero,'A1SU')))then
loop
exitwhen i>16
set i=i+1
endloop
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set XZI=QXI
set XVI=QYI
set XHI=hero
set GK=hero
loop
exitwhen i>16
set x=QXI+XYI*Cos(bj_DEGTORAD*360.0*i/16.0)
set y=QYI+XYI*Sin(bj_DEGTORAD*360.0*i/16.0)
set XWI=x
set XXI=y
call GroupEnumUnitsInRange(g,x,y,75,Condition(function N85))
set i=i+1
endloop
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function NA5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QXI=(LoadReal(LY,(handle_id),(6)))
local real QYI=(LoadReal(LY,(handle_id),(7)))
local real x
local real y
local integer i=0
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
loop
exitwhen i>16
set x=QXI+XYI*Cos(bj_DEGTORAD*360.0*i/16.0)
set y=QYI+XYI*Sin(bj_DEGTORAD*360.0*i/16.0)
set i=i+1
endloop
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\KineticField_FX_Stand.mdx",QXI,QYI)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((QXI)*1.0))
call SaveReal(LY,(handle_id),(7),((QYI)*1.0))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function N95))
set t=null
set hero=null
return false
endfunction
function NB5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real QXI=GetSpellTargetX()
local real QYI=GetSpellTargetY()
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\KineticField_FX_Start.mdx",QXI,QYI)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((QXI)*1.0))
call SaveReal(LY,(handle_id),(7),((QYI)*1.0))
call TriggerRegisterTimerEvent(t,1.2,false)
call TriggerAddCondition(t,Condition(function NA5))
call I41(GetOwningPlayer(hero),5.5,QXI,QYI,300)
set t=null
set hero=null
endfunction
function NC5 takes nothing returns boolean
if GetSpellAbilityId()=='A1SU' then
call NB5()
endif
return false
endfunction
function RS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NC5))
set t=null
endfunction
function ND5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real a=UEI(x,y,QJI,QKI)
local real d=QNI(x,y,QJI,QKI)
local real r=(LoadReal(LY,(handle_id),(671)))
call SetUnitFacing(IG1,a)
set x=x+r*Cos(a*bj_DEGTORAD)
set y=y+r*Sin(a*bj_DEGTORAD)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
if d<40 then
call KillUnit(IG1)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SCI(target,4411,1)
call SetUnitPosition(target,QJI,QKI)
call PanCameraToTimedForPlayer(GetOwningPlayer(target),QJI,QKI,0)
elseif RKI(target)then
call KillUnit(IG1)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set IG1=null
return false
endfunction
function NE5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local real x=(LoadReal(LY,(GetHandleId(target)),(7400)))
local real y=(LoadReal(LY,(GetHandleId(target)),(7500)))
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0C6',GetUnitX(target),GetUnitY(target),0)
local real d=QNI(x,y,GetUnitX(target),GetUnitY(target))
local real r=0.02*(RMaxBJ(d/1.8,600))
call TriggerAddCondition(t,Condition(function ND5))
call TriggerRegisterTimerEvent(t,0.02,true)
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(671),((r)*1.0))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("effects\\Lightning_Ball_Tail_FX.mdx",target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect("effects\\Lightning_Ball_Tail_FX.mdx",x,y)))
call TriggerEvaluate(t)
set hero=null
set target=null
endfunction
function NF5 takes nothing returns boolean
if GetSpellAbilityId()=='A1SW' and CanResistSkill(GetSpellTargetUnit())==false then
if IsUnitIllusion(GetSpellTargetUnit())then
call KillUnit(GetSpellTargetUnit())
else
call NE5()
endif
endif
return false
endfunction
function Y0O takes nothing returns nothing
local unit target=GK
local integer handle_id=GetHandleId(target)
local integer i=0
loop
exitwhen i>15
set i=i+1
endloop
set target=null
endfunction
function NG5 takes nothing returns nothing
local unit target=GetEnumUnit()
local integer handle_id=GetHandleId(target)
local integer i=1
loop
exitwhen i>15
call SaveReal(LY,(handle_id),(7400+i-1),(((LoadReal(LY,(handle_id),(7400+i))))*1.0))
call SaveReal(LY,(handle_id),(7500+i-1),(((LoadReal(LY,(handle_id),(7500+i))))*1.0))
set i=i+1
endloop
call SaveReal(LY,(handle_id),(7400+15),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(7500+15),((GetUnitY(target))*1.0))
set target=null
endfunction
function NH5 takes nothing returns boolean
local group g=NTI()
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function D51))
call ForGroup(g,function NG5)
call NSI(g)
set g=null
return false
endfunction
function RR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NF5))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function NH5))
set t=null
endfunction
function NZ5 takes nothing returns nothing
if XJI!=GetEnumUnit()then
call Damage(XKI,GetEnumUnit(),1,XLI*20+20)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\Bolt\\BoltImpact.mdl",GetEnumUnit(),"chest"))
endif
endfunction
function NV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local group g
local integer NPI=GetTriggerEvalCount(t)
local unit ZK3=null
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
call MUSetUnitX(IG1,GetUnitX(target))
call MUSetUnitY(IG1,GetUnitY(target))
if NPI==1 or NPI==100 or NPI==200 or NPI==300 then
set g=NTI()
if IsUnitDead(target)then
set ZK3=CreateUnit(GetOwningPlayer(target),'e00C',GetUnitX(target),GetUnitY(target),0)
call UnitApplyTimedLife(ZK3,'BTLF',0.2)
call IssueTargetOrder(dummy,"chainlightning",ZK3)
else
call IssueTargetOrder(dummy,"chainlightning",target)
call Damage(hero,target,1,level*20+20)
endif
call U5I("war3mapImported\\ThunderStorm_Groundeffect.mdx",target,"origin",0.6)
set GK=hero
set XKI=hero
set XJI=target
set XLI=level
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),240+25,Condition(function CA1))
call ForGroup(g,function NZ5)
call NSI(g)
if GetTriggerEvalCount(t)==300 then
call KillUnit(dummy)
call KillUnit(IG1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
set IG1=null
return false
endfunction
function NW5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1TV')
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'e02P',GetUnitX(target),GetUnitY(target),0)
call AddSkill(IG1,'Aloc')
call AddSkill(dummy,'A1U7')
call SetUnitAbilityLevel(dummy,'A1U7',level)
call AddSkill(dummy,'Aloc')
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function NV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveInteger(LY,(handle_id),(5),(level))
set hero=null
set target=null
set IG1=null
set t=null
endfunction
function NX5 takes nothing returns boolean
if GetSpellAbilityId()=='A1TV' and CanResistSkill(GetSpellTargetUnit())==false then
call NW5()
endif
return false
endfunction
function RP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NX5))
set t=null
endfunction
function NY5 takes nothing returns nothing
local unit dummy
if XTI then
set dummy=CreateUnit(GetOwningPlayer(GetEnumUnit()),'e00E',GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
call UnitRemoveAbility(GetEnumUnit(),'B0H3')
call AddSkill(dummy,'A2VF')
call IssueTargetOrder(dummy,"doom",GetEnumUnit())
set dummy=null
endif
call Damage(XNI,GetEnumUnit(),1,XMI)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\Purge_NoBirth.mdx",GetEnumUnit(),"origin"))
endfunction
function NJ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local boolean CK3=(LoadBoolean(LY,(handle_id),(15)))
local group g
local integer NPI=GetTriggerEvalCount(t)
local integer MKO=20
if CK3 then
set MKO=28
endif
if NPI>MKO then
call StopSound(EF,false,true)
call KillUnit(IG1)
call ShowUnit(IG1,false)
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
set XNI=hero
set XMI=0.25*(150+50*level)*(NPI/I2R(MKO))
set XSI=false
set XTI=CK3
if ModuloInteger(NPI,4)==0 then
set XSI=true
endif
call GroupEnumUnitsInRange(g,GetUnitX(IG1),GetUnitY(IG1),475,Condition(function CH1))
call ForGroup(g,function NY5)
call NSI(g)
set g=null
endif
set t=null
set hero=null
set IG1=null
set dummy=null
return false
endfunction
function NK5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0CK',QJI,QKI,0)
local integer level=GetUnitAbilityLevel(hero,'A1U6')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',QJI,QKI,0)
local boolean CK3=false
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2V8')
set CK3=true
endif
call SetSoundVolume(EF,200)
call StartSound(EF)
call SetSoundPosition(EF,QJI,QKI,100)
if IsPlayerTeam2(GetOwningPlayer(hero))then
call AddSkill(dummy,'A1U5')
if CK3 then
call SetUnitAbilityLevel(dummy,'A1U5',2)
endif
else
call AddSkill(dummy,'A1U4')
if CK3 then
call SetUnitAbilityLevel(dummy,'A1U4',2)
endif
endif
call IssuePointOrder(dummy,"cloudoffog",QJI,QKI)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveBoolean(LY,(handle_id),(15),(CK3))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function NJ5))
set t=null
set hero=null
endfunction
function NL5 takes nothing returns boolean
if GetSpellAbilityId()=='A1U6' or GetSpellAbilityId()=='A2V8' then
call NK5()
endif
return false
endfunction
function RT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NL5))
set t=null
endfunction
function NM5 takes nothing returns nothing
local integer NN5=YII
local unit target=GetEnumUnit()
local integer NS5=662-1+NN5
local real NT5=(LoadReal(LY,(GetHandleId(target)),(NS5)))
local real SOI=(TimerGetElapsed(M))
if NT5<SOI then
call SaveReal(LY,(GetHandleId(target)),(NS5),((SOI+2)*1.0))
if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==false then
call Damage(XRI,target,1,2+6*Y0I)
else
endif
endif
set target=null
endfunction
function Spirits_DamageHeroes takes nothing returns nothing
local integer NN5=YII
local unit target=GetEnumUnit()
local integer NS5=662-1+NN5
local real NT5=(LoadReal(LY,(GetHandleId(target)),(NS5)))
local real SOI=(TimerGetElapsed(M))
if NT5<SOI then
call SaveReal(LY,(GetHandleId(target)),(NS5),((SOI+2)*1.0))
if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==false then
call Damage(XRI,target,1,15+10*Y0I)
else
endif
endif
set target=null
endfunction
function NR5 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==false then
call Damage(XRI,GetEnumUnit(),1,XQI)
else
endif
endfunction
function NP5 takes unit hero,unit NQ5 returns nothing
local group g=NTI()
set GK=hero
set XQI=25*Y0I
set XRI=hero
set XPI=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(NQ5),GetUnitY(NQ5),0)
call GroupEnumUnitsInRange(g,GetUnitX(NQ5),GetUnitY(NQ5),325,Condition(function CJ1))
call AddSkill(XPI,'A1TO')
call ForGroup(g,function NR5)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\FreezingBreath\\FreezingBreathMissile.mdl",GetUnitX(NQ5),GetUnitY(NQ5)))
call KillUnit(NQ5)
call NSI(g)
call UnitApplyTimedLife(CreateUnit(GetOwningPlayer(hero),'o00Q',GetUnitX(NQ5),GetUnitY(NQ5),0),'BTLF',2)
set g=null
endfunction
function NU5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit R74=(LoadUnitHandle(LY,(handle_id),(393)))
local unit R84=(LoadUnitHandle(LY,(handle_id),(394)))
local unit R94=(LoadUnitHandle(LY,(handle_id),(395)))
local unit RA4=(LoadUnitHandle(LY,(handle_id),(396)))
local unit RB4=(LoadUnitHandle(LY,(handle_id),(397)))
local real x
local real y
local real a
local real d=(LoadReal(LY,(handle_id),(138)))
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real JC3
local integer NPI=GetTriggerEvalCount(t)
local real DJ1
local group g
local integer S05=0
local real Q4I=2.25
local real SI5
if IsUnitDead(R74)==false then
set S05=S05+1
endif
if IsUnitDead(R84)==false then
set S05=S05+1
endif
if IsUnitDead(R94)==false then
set S05=S05+1
endif
if IsUnitDead(RA4)==false then
set S05=S05+1
endif
if IsUnitDead(RB4)==false then
set S05=S05+1
endif
if S05==5 then
set Q4I=2.25
elseif S05==4 then
set Q4I=2.1
elseif S05==3 then
set Q4I=1.95
elseif S05==2 then
set Q4I=1.8
elseif S05==1 then
set Q4I=1.65
endif
set JC3=-1*360*0.02/Q4I
set SI5=(LoadReal(LY,(handle_id),(137)))+JC3
call SaveReal(LY,(handle_id),(137),((SI5)*1.0))
set Y0I=GetUnitAbilityLevel(hero,'A1T8')
set XRI=hero
if NPI==50 then
call ShowUnit(R84,true)
call SaveBoolean(LY,(handle_id),(512),(true))
call AddSkill(R84,'Aloc')
endif
if NPI==100 then
call ShowUnit(R94,true)
call SaveBoolean(LY,(handle_id),(513),(true))
call AddSkill(R94,'Aloc')
endif
if NPI==150 then
call ShowUnit(RA4,true)
call SaveBoolean(LY,(handle_id),(514),(true))
call AddSkill(RA4,'Aloc')
endif
if NPI==200 then
call ShowUnit(RB4,true)
call SaveBoolean(LY,(handle_id),(515),(true))
call AddSkill(RB4,'Aloc')
endif
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A24A' then
if(LoadBoolean(LY,(handle_id),(655)))==true then
call SaveBoolean(LY,(handle_id),(655),(false))
call SaveBoolean(LY,(handle_id),(656),(false))
else
call SaveBoolean(LY,(handle_id),(655),(true))
call SaveBoolean(LY,(handle_id),(656),(false))
endif
elseif GetSpellAbilityId()=='A24B' then
if(LoadBoolean(LY,(handle_id),(656)))==true then
call SaveBoolean(LY,(handle_id),(655),(false))
call SaveBoolean(LY,(handle_id),(656),(false))
else
call SaveBoolean(LY,(handle_id),(655),(false))
call SaveBoolean(LY,(handle_id),(656),(true))
endif
endif
endif
if(LoadBoolean(LY,(handle_id),(655)))then
set d=RMaxBJ(d-5,100)
call SaveReal(LY,(handle_id),(138),((d)*1.0))
elseif(LoadBoolean(LY,(handle_id),(656)))then
set d=RMinBJ(d+5,875)
call SaveReal(LY,(handle_id),(138),((d)*1.0))
endif
if GetTriggerEventId()==EVENT_UNIT_DEATH or NPI==950 or(IsUnitDead(R74)and IsUnitDead(R84)and IsUnitDead(R94)and IsUnitDead(RA4)and IsUnitDead(RB4))or(NPI>1 and GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A1T8')then
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT then
call UnitRemoveAbility(hero,'A24A')
call UnitRemoveAbility(hero,'A24B')
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if IsUnitDead(R74)==false then
call NP5(hero,R74)
endif
if IsUnitDead(R84)==false then
call NP5(hero,R84)
endif
if IsUnitDead(R94)==false then
call NP5(hero,R94)
endif
if IsUnitDead(RA4)==false then
call NP5(hero,RA4)
endif
if IsUnitDead(RB4)==false then
call NP5(hero,RB4)
endif
else
set g=NTI()
if IsUnitDead(R74)==false and(LoadBoolean(LY,(handle_id),(511)))then
set DJ1=360*5/5.0
set a=DJ1+SI5
set x=PTI(QXI+d*Cos(a*bj_DEGTORAD))
set y=PUI(QYI+d*Sin(a*bj_DEGTORAD))
call MUSetUnitX(R74,x)
call MUSetUnitY(R74,y)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,95,Condition(function D21))
if FirstOfGroup(g)!=null then
call NP5(hero,R74)
endif
call GroupClear(g)
set XUI=R74
set YII=1
set XRI=hero
call GroupEnumUnitsInRange(g,x,y,175,Condition(function CY1))
call ForGroup(g,function NM5)
call GroupClear(g)
endif
if IsUnitDead(R84)==false and(LoadBoolean(LY,(handle_id),(512)))then
set DJ1=360*4/5.0
set a=DJ1+SI5
set x=PTI(QXI+d*Cos(a*bj_DEGTORAD))
set y=PUI(QYI+d*Sin(a*bj_DEGTORAD))
call MUSetUnitX(R84,x)
call MUSetUnitY(R84,y)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,95,Condition(function D21))
if FirstOfGroup(g)!=null then
call NP5(hero,R84)
endif
call GroupClear(g)
set XUI=R84
set YII=2
set XRI=hero
call GroupEnumUnitsInRange(g,x,y,175,Condition(function CY1))
call ForGroup(g,function NM5)
call GroupClear(g)
endif
if IsUnitDead(R94)==false and(LoadBoolean(LY,(handle_id),(513)))then
set DJ1=360*3/5.0
set a=DJ1+SI5
set x=PTI(QXI+d*Cos(a*bj_DEGTORAD))
set y=PUI(QYI+d*Sin(a*bj_DEGTORAD))
call MUSetUnitX(R94,x)
call MUSetUnitY(R94,y)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,95,Condition(function D21))
if FirstOfGroup(g)!=null then
call NP5(hero,R94)
endif
call GroupClear(g)
set XUI=R94
set YII=3
set XRI=hero
call GroupEnumUnitsInRange(g,x,y,175,Condition(function CY1))
call ForGroup(g,function NM5)
call GroupClear(g)
endif
if IsUnitDead(RA4)==false and(LoadBoolean(LY,(handle_id),(514)))then
set DJ1=360*2/5.0
set a=DJ1+SI5
set x=PTI(QXI+d*Cos(a*bj_DEGTORAD))
set y=PUI(QYI+d*Sin(a*bj_DEGTORAD))
call MUSetUnitX(RA4,x)
call MUSetUnitY(RA4,y)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,95,Condition(function D21))
if FirstOfGroup(g)!=null then
call NP5(hero,RA4)
endif
call GroupClear(g)
set XUI=RA4
set YII=4
set XRI=hero
call GroupEnumUnitsInRange(g,x,y,175,Condition(function CY1))
call ForGroup(g,function NM5)
call GroupClear(g)
endif
if IsUnitDead(RB4)==false and(LoadBoolean(LY,(handle_id),(515)))then
set DJ1=360*1/5.0
set a=DJ1+SI5
set x=PTI(QXI+d*Cos(a*bj_DEGTORAD))
set y=PUI(QYI+d*Sin(a*bj_DEGTORAD))
call MUSetUnitX(RB4,x)
call MUSetUnitY(RB4,y)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,95,Condition(function D21))
if FirstOfGroup(g)!=null then
call NP5(hero,RB4)
endif
call GroupClear(g)
set XUI=RB4
set YII=5
set XRI=hero
call GroupEnumUnitsInRange(g,x,y,175,Condition(function CY1))
call ForGroup(g,function NM5)
call GroupClear(g)
endif
call NSI(g)
endif
set t=null
set hero=null
set R74=null
set R84=null
set R94=null
set RA4=null
set RB4=null
return false
endfunction
function S15 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit R74
local unit R84
local unit R94
local unit RA4
local unit RB4
local real x
local real y
set x=GetUnitX(hero)+250*Cos(bj_DEGTORAD*360*5/5.0*-1.0)
set y=GetUnitY(hero)+250*Sin(bj_DEGTORAD*360*5/5.0*-1.0)
set R74=CreateUnit(GetOwningPlayer(hero),'h0CJ',x,y,360*5/5.0*-1.0)
call AddSkill(R74,'Aloc')
set x=GetUnitX(hero)+250*Cos(bj_DEGTORAD*360*4/5.0*-1.0)
set y=GetUnitY(hero)+250*Sin(bj_DEGTORAD*360*4/5.0*-1.0)
set R84=CreateUnit(GetOwningPlayer(hero),'h0CJ',x,y,360*4/5.0*-1.0)
call ShowUnit(R84,false)
call SetUnitInvulnerable(R84,true)
set x=GetUnitX(hero)+250*Cos(bj_DEGTORAD*360*3/5.0*-1.0)
set y=GetUnitY(hero)+250*Sin(bj_DEGTORAD*360*3/5.0*-1.0)
set R94=CreateUnit(GetOwningPlayer(hero),'h0CJ',x,y,360*3/5.0*-1.0)
call ShowUnit(R94,false)
call SetUnitInvulnerable(R84,true)
set x=GetUnitX(hero)+250*Cos(bj_DEGTORAD*360*2/5.0*-1.0)
set y=GetUnitY(hero)+250*Sin(bj_DEGTORAD*360*2/5.0*-1.0)
set RA4=CreateUnit(GetOwningPlayer(hero),'h0CJ',x,y,360*2/5.0*-1.0)
call ShowUnit(RA4,false)
call SetUnitInvulnerable(RA4,true)
set x=GetUnitX(hero)+250*Cos(bj_DEGTORAD*360*1/5.0*-1.0)
set y=GetUnitY(hero)+250*Sin(bj_DEGTORAD*360*1/5.0*-1.0)
set RB4=CreateUnit(GetOwningPlayer(hero),'h0CJ',x,y,360*1/5.0*-1.0)
call ShowUnit(RB4,false)
call SetUnitInvulnerable(RB4,true)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(393),(R74))
call SaveUnitHandle(LY,(handle_id),(394),(R84))
call SaveUnitHandle(LY,(handle_id),(395),(R94))
call SaveUnitHandle(LY,(handle_id),(396),(RA4))
call SaveUnitHandle(LY,(handle_id),(397),(RB4))
call SaveBoolean(LY,(handle_id),(511),(true))
call SaveBoolean(LY,(handle_id),(512),(false))
call SaveBoolean(LY,(handle_id),(513),(false))
call SaveBoolean(LY,(handle_id),(514),(false))
call SaveBoolean(LY,(handle_id),(515),(false))
call SaveBoolean(LY,(handle_id),(655),(false))
call SaveBoolean(LY,(handle_id),(656),(false))
call SaveReal(LY,(handle_id),(138),((150)*1.0))
call AddSkill(hero,'A24B')
call AddSkill(hero,'A24A')
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NU5))
set hero=null
set t=null
set R74=null
set R84=null
set R94=null
set RA4=null
set RB4=null
endfunction
function SO5 takes nothing returns boolean
if GetSpellAbilityId()=='A1T8' then
call S15()
endif
return false
endfunction
function RQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SO5))
set t=null
endfunction
function S25 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
call QGI(hero,GetEventDamage()*0.05*level)
set t=null
set hero=null
return false
endfunction
function S35 takes unit u returns nothing
local trigger t
call UnitRemoveAbility(u,'A1TS')
call UnitRemoveAbility(u,'A1TR')
call UnitRemoveAbility(u,'A1TT')
call UnitRemoveAbility(u,'A1TP')
if(LoadBoolean(LY,(GetHandleId(u)),(708)))then
call SaveBoolean(LY,(GetHandleId(u)),(708),(false))
set t=(LoadTriggerHandle(LY,(GetHandleId(u)),(709)))
call FlushChildHashtable(LY,(GetHandleId(t)))
call FlushTrigger(t)
call RemoveSavedHandle(LY,(GetHandleId(u)),(709))
set t=null
endif
endfunction
function S45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call S35(hero)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
return false
endfunction
function S55 takes unit u,integer i returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(u))
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function S45))
if i==1 then
call AddSkill(u,'A1TS')
call SetPlayerAbilityAvailable(GetOwningPlayer(u),'A1TS',false)
elseif i==2 then
call AddSkill(u,'A1TR')
call SetPlayerAbilityAvailable(GetOwningPlayer(u),'A1TR',false)
elseif i==3 then
call AddSkill(u,'A1TT')
call SetPlayerAbilityAvailable(GetOwningPlayer(u),'A1TT',false)
elseif i==4 then
call AddSkill(u,'A1TP')
call SetPlayerAbilityAvailable(GetOwningPlayer(u),'A1TP',false)
endif
if(LoadBoolean(LY,(GetHandleId(u)),(708)))==false then
call SaveBoolean(LY,(GetHandleId(u)),(708),(true))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,u,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function S25))
call SaveTriggerHandle(LY,(GetHandleId(u)),(709),(t))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(u))
call SaveInteger(LY,(GetHandleId(t)),(5),(i))
endif
set t=null
endfunction
function S65 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=GetUnitAbilityLevel(hero,'A28Q')
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit S75=(LoadUnitHandle(LY,(GetHandleId(hero)),(652)))
local boolean ZXO=false
local real S85=0.2*(GetUnitState(hero,UNIT_STATE_LIFE)*0.045)
local real S95=0.2*(GetUnitState(hero,UNIT_STATE_MANA)*0.045)
if GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if GetIssuedOrderId()==String2OrderIdBJ("manashieldon")then
call S55(hero,level)
elseif GetIssuedOrderId()==String2OrderIdBJ("manashieldoff")then
call S35(hero)
endif
endif
if GetUnitAbilityLevel(hero,'A1TS')>0 or GetUnitAbilityLevel(hero,'A1TR')>0 or GetUnitAbilityLevel(hero,'A1TT')>0 or GetUnitAbilityLevel(hero,'A1TP')>0 then
set ZXO=true
call SetUnitState(hero,UNIT_STATE_LIFE,RMaxBJ(GetUnitState(hero,UNIT_STATE_LIFE)-S85,1))
call SetUnitState(hero,UNIT_STATE_MANA,RMaxBJ(GetUnitState(hero,UNIT_STATE_MANA)-S95,1))
endif
if S75==null then
if target!=null then
call S35(target)
set target=null
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
else
if target==null then
set target=S75
if ZXO then
call SaveUnitHandle(LY,(handle_id),(17),(target))
call S55(target,level)
else
call S35(target)
endif
elseif target!=S75 then
call S35(target)
if ZXO then
set target=S75
call SaveUnitHandle(LY,(handle_id),(17),(target))
call S55(target,level)
endif
elseif ZXO==false then
call S35(target)
elseif target==S75 then
if ZXO then
set target=S75
call SaveUnitHandle(LY,(handle_id),(17),(target))
call S55(target,level)
endif
endif
endif
set t=null
set hero=null
set target=null
set S75=null
return false
endfunction
function SA5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A28Q')
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(null))
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function S65))
set hero=null
set t=null
endfunction
function SB5 takes nothing returns boolean
if GetLearnedSkill()=='A28Q' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A28Q')==1 then
call SA5()
endif
return false
endfunction
function RU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function SB5))
set t=null
endfunction
function SC5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),YOI)==false then
call GroupAddUnit(YOI,GetEnumUnit())
call AddSkill(GetEnumUnit(),'A2TP')
call AX1(GetEnumUnit(),'A2TP',1,0.25+0.5*Y3I,'B0GU')
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl",GetEnumUnit(),"chest"))
endif
endfunction
function SD5 takes unit hero,unit target,group JAO returns nothing
local real x1=GetUnitX(hero)
local real y1=GetUnitY(hero)
local real x2=GetUnitX(target)
local real y2=GetUnitY(target)
local real a=UEI(x1,y1,x2,y2)*bj_DEGTORAD
local real x
local real y
local real d=QNI(x1,y1,x2,y2)
local group g=NTI()
local integer i=1
set YOI=JAO
set Y1I=hero
set Y3I=GetUnitAbilityLevel(hero,'A1TA')
set Y2I=Y3I*50+50
loop
exitwhen i>8
set GK=hero
set x=x1+d*i/8*Cos(a)
set y=y1+d*i/8*Sin(a)
call GroupEnumUnitsInRange(g,x,y,100,Condition(function CA1))
call ForGroup(g,function SC5)
call GroupClear(g)
set i=i+1
endloop
call NSI(g)
set g=null
endfunction
function SE5 takes unit hero,unit target returns boolean
return((LoadInteger(LY,(GetHandleId((hero))),((4294))))==1)
endfunction
function SF5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real d=QLI(hero,target)
local real a=UDI(hero,target)*bj_DEGTORAD
local real x=GetUnitX(hero)+20*Cos(a)
local real y=GetUnitY(hero)+20*Sin(a)
local location point
if d<300 or d>2150 then
set point=BN1(x,y)
set x=GetLocationX(point)
set y=GetLocationY(point)
call MUSetUnitX(hero,PTI(x))
call MUSetUnitY(hero,PUI(y))
call UPI(x,y,350)
call RemoveLocation(point)
set point=null
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SaveInteger(LY,(GetHandleId((hero))),((4295)),(2))
else
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function SG5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local lightning UZI=(LoadLightningHandle(LY,(handle_id),(196)))
local integer NPI=GetTriggerEvalCount(t)
local real d=QLI(hero,target)
local real a=1
local real Z33=GetUnitState(hero,UNIT_STATE_LIFE)
local real KWO=GetUnitState(hero,UNIT_STATE_MANA)
local real SH5=(LoadReal(LY,(handle_id),(670)))
local real SZ5=(LoadReal(LY,(handle_id),(667)))
local real SV5
local real SW5
local real SX5=1.5
if target==null or hero==null or IsUnitDead(hero)==true or(NPI>600 and SE5(hero,target)==false and((LoadInteger(LY,(GetHandleId((hero))),((4295))))==1)==false)or(d>925 and((LoadInteger(LY,(GetHandleId((hero))),((4295))))==1)==false)or GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A1TU')then
call NSI(JAO)
call DestroyLightning(UZI)
call UnitRemoveAbility(target,'A1TH')
call UnitRemoveAbility(target,'A1TI')
call UnitRemoveAbility(target,'A1TG')
call UnitRemoveAbility(target,'A1TJ')
call UnitRemoveAbility(target,'B0DH')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A1TH')
call UnitRemoveAbility(hero,'A1TI')
call UnitRemoveAbility(hero,'A1TG')
call UnitRemoveAbility(hero,'A1TJ')
call UnitRemoveAbility(hero,'B0DH')
call UnitRemoveAbility(hero,'A1TU')
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A1TA' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1TA',true)
endif
call RemoveSavedHandle(LY,GetHandleId(hero),652)
else
set SV5=Z33/GetUnitState(hero,UNIT_STATE_MAX_LIFE)
set SW5=KWO/GetUnitState(hero,UNIT_STATE_MAX_MANA)
if SV5-SH5>0 and(SV5-SH5)<0.5 then
if((LoadInteger(LY,(GetHandleId((hero))),((4298))))==1)==false then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+SX5*(SV5-SH5)*GetUnitState(hero,UNIT_STATE_MAX_LIFE))
endif
endif
if SW5-SZ5>0 and(SW5-SZ5)<0.5 then
call SetUnitState(target,UNIT_STATE_MANA,GetUnitState(target,UNIT_STATE_MANA)+SX5*(SW5-SZ5)*GetUnitState(hero,UNIT_STATE_MAX_MANA))
endif
call SaveReal(LY,(handle_id),(670),((GetUnitState(hero,UNIT_STATE_LIFE)/GetUnitState(hero,UNIT_STATE_MAX_LIFE))*1.0))
call SaveReal(LY,(handle_id),(667),((GetUnitState(hero,UNIT_STATE_MANA)/GetUnitState(hero,UNIT_STATE_MAX_MANA))*1.0))
call MoveLightning(UZI,true,GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
call SD5(hero,target,JAO)
if IsUnitVisible(hero,GetLocalPlayer())==false and IsUnitVisible(target,GetLocalPlayer())==false then
set a=0
endif
if P0I(GetLocalPlayer())then
set a=1
endif
if d<700 or((LoadInteger(LY,(GetHandleId((hero))),((4295))))==1)==true then
call SetLightningColor(UZI,0.00,1.00,1.00,a)
else
call SetLightningColor(UZI,0.80,0.70,0.40,a)
endif
endif
set t=null
set hero=null
set target=null
set JAO=null
set UZI=null
return false
endfunction
function SY5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local lightning UZI=AddLightning("CHIM",true,GetUnitX(hero),GetUnitY(hero),GetUnitX(target),GetUnitY(target))
local integer level=GetUnitAbilityLevel(hero,'A1TA')
local integer X63
local real d=QLI(hero,target)
local real a=UDI(hero,target)*bj_DEGTORAD
local location point
local real x
local real y
call SetLightningColor(UZI,0.00,1.00,1.00,1)
call AddSkill(hero,'A1TU')
if level==1 then
set X63='A1TH'
elseif level==2 then
set X63='A1TI'
elseif level==3 then
set X63='A1TG'
elseif level==4 then
set X63='A1TJ'
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1TA',false)
call AddSkill(hero,X63)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),X63,false)
call AddSkill(target,X63)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),X63,false)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveGroupHandle(LY,(handle_id),(133),(NTI()))
call SaveLightningHandle(LY,(handle_id),(196),(UZI))
call SaveReal(LY,(handle_id),(670),((GetUnitState(hero,UNIT_STATE_LIFE)/GetUnitState(hero,UNIT_STATE_MAX_LIFE))*1.0))
call SaveReal(LY,(handle_id),(667),((GetUnitState(hero,UNIT_STATE_MANA)/GetUnitState(hero,UNIT_STATE_MAX_MANA))*1.0))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SG5))
call SaveUnitHandle(LY,(GetHandleId(hero)),(652),(target))
if d>700 then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Weapons\\DragonHawkMissile\\DragonHawkMissile.mdl",hero,"chest")))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function SF5))
call SaveInteger(LY,(GetHandleId((hero))),((4295)),(1))
endif
set hero=null
set t=null
endfunction
function SJ5 takes nothing returns boolean
if GetSpellAbilityId()=='A1TA' then
call SY5()
endif
return false
endfunction
function P01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function SJ5))
set t=null
endfunction
function SK5 takes unit hero,real x,real y returns boolean
local boolean FB1=false
local player p=GetOwningPlayer(hero)
local unit dummy=CreateUnit(p,'e02Q',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A1V4')
if IssuePointOrder(dummy,"blink",x,y)==true then
call KillUnit(dummy)
set dummy=null
return true
else
call KillUnit(dummy)
set dummy=null
return false
endif
endfunction
function SL5 takes string UWI,unit target returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,0.033)
call SetTextTagPosUnit(tt,target,64)
call SetTextTagColor(tt,0,50,255,255)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,0.15)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,0.85)
call SetTextTagVisibility(tt,true)
set tt=null
endfunction
function SM5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=GetTriggerEvalCount(t)
if IsUnitDead(hero)==false and NPI<12 then
call SL5(I2S(12-NPI),hero)
endif
if NPI==12 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function SN5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(GetHandleId(hero)),(652)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call SaveInteger(LY,(GetHandleId((hero))),((4294)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call UPI(QJI,QKI,250)
call UPI(QXI,QYI,250)
if GetTriggerEvalCount(t)==1 then
if IsUnitDead(hero)==false then
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(hero),GetUnitY(hero)))
call SetUnitPosition(hero,QJI,QKI)
call PanCameraToTimedForPlayer(GetOwningPlayer(hero),QJI,QKI,0)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(hero),GetUnitY(hero)))
endif
if target!=null and IsUnitDead(target)==false and GetOwningPlayer(target)!=BO[0]and GetOwningPlayer(target)!=CO[0]and((LoadBoolean(LY,(GetHandleId(GetOwningPlayer((target)))),(139)))==false)then
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(target),GetUnitY(target)))
call SCI(target,4402,1)
call SetUnitPosition(target,QJI,QKI)
if IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitDead(target)==false then
call PanCameraToTimedForPlayer(GetOwningPlayer(target),QJI,QKI,0)
endif
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(target),GetUnitY(target)))
endif
else
if IsUnitDead(hero)==false then
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(hero),GetUnitY(hero)))
call SetUnitPosition(hero,QXI,QYI)
call PanCameraToTimedForPlayer(GetOwningPlayer(hero),QXI,QYI,0)
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(hero),GetUnitY(hero)))
endif
if target!=null and IsUnitDead(target)==false and GetOwningPlayer(target)!=BO[0]and GetOwningPlayer(target)!=CO[0]and((LoadBoolean(LY,(GetHandleId(GetOwningPlayer((target)))),(139)))==false)then
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(target),GetUnitY(target)))
call SCI(target,4402,1)
call SetUnitPosition(target,QXI,QYI)
if IsUnitType(target,UNIT_TYPE_HERO)==true and IsUnitDead(target)==false then
call PanCameraToTimedForPlayer(GetOwningPlayer(target),QXI,QYI,0)
endif
call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",GetUnitX(target),GetUnitY(target)))
endif
call SaveInteger(LY,(GetHandleId((hero))),((4294)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set hero=null
set target=null
set I31=null
return false
endfunction
function SS5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local fogmodifier I31
local integer level=GetUnitAbilityLevel(hero,'A1TB')
if BG1(hero)or BE1(hero)or IsUnitDead(hero)then
call SaveInteger(LY,(GetHandleId((hero))),((4294)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)==(2.75-0.25*level)/.05 then
set I31=CreateFogModifierRadius(GetOwningPlayer(hero),FOG_OF_WAR_VISIBLE,GetUnitX(hero),GetUnitY(hero),400,true,true)
call FogModifierStart(I31)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerRegisterTimerEvent(t,12,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function SN5))
call SaveReal(LY,(handle_id),(189),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(190),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\EarthlyEminence.mdl",GetUnitX(hero),GetUnitY(hero))))
call SaveFogModifierHandle(LY,(handle_id),(42),(I31))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function SM5))
endif
set hero=null
set t=null
set I31=null
return false
endfunction
function ST5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local unit target=(LoadUnitHandle(LY,(GetHandleId(hero)),(652)))
local integer id=GetPlayerId(GetOwningPlayer(hero))
local integer level=GetUnitAbilityLevel(hero,'A1TB')
call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\NightElf\\NECancelDeath\\NECancelDeath.mdl",hero,"chest"))
if target!=null then
endif
call PingMinimapEx(x,y,4.0,255,0,0,false)
call I41(BO[1],2.5,x,y,300)
call I41(CO[1],2.5,x,y,300)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,.05,true)
call TriggerAddCondition(t,Condition(function SS5))
call SaveReal(LY,(handle_id),(47),((x)*1.0))
call SaveReal(LY,(handle_id),(48),((y)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\EarthlyEminence.mdl",x,y)))
call SaveInteger(LY,(GetHandleId((hero))),((4294)),(1))
set hero=null
set t=null
endfunction
function SR5 takes nothing returns boolean
if GetSpellAbilityId()=='A1TB' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call ST5()
else
if SK5(GetTriggerUnit(),GetSpellTargetX(),GetSpellTargetY())==false then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"无法重定位于未探索的区域")
else
if IsPlayerTeam1(GetOwningPlayer(GetTriggerUnit()))then
if IsPointInRegion(Y5I,GetSpellTargetX(),GetSpellTargetY())==true then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"你不能传送到那里")
endif
else
if IsPointInRegion(Y4I,GetSpellTargetX(),GetSpellTargetY())==true then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"你不能传送到那里")
endif
endif
endif
endif
endif
return false
endfunction
function PI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function SR5))
set Y4I=CreateRegion()
call RegionAddRect(Y4I,F4)
call RegionAddRect(Y4I,G5)
set Y5I=CreateRegion()
call RegionAddRect(Y5I,E4)
call RegionAddRect(Y5I,H5)
set t=null
endfunction
function SP5 takes unit hero,unit target,real QXI,real QYI,real a2 returns nothing
local integer i=0
local real QJI
local real QKI=GetUnitY(target)
local real a
local real x
local real y
local real SQ5
if target!=null then
set QJI=GetUnitX(target)
set QKI=GetUnitY(target)
set a=UEI(QXI,QYI,QJI,QKI)
else
set a=a2
set QJI=QXI+50*Cos(a*bj_DEGTORAD)
set QKI=QYI+50*Sin(a*bj_DEGTORAD)
endif
set SQ5=a
set x=QJI+200*Cos(SQ5*bj_DEGTORAD)
set y=QKI+200*Sin(SQ5*bj_DEGTORAD)
call OA1(CreateDestructable('B006',x,y,-1*SQ5,0.6,1),7)
set SQ5=a-40
set x=QJI+200*Cos(SQ5*bj_DEGTORAD)
set y=QKI+200*Sin(SQ5*bj_DEGTORAD)
call OA1(CreateDestructable('B006',x,y,-1*SQ5,0.6,1),7)
set SQ5=a-80
set x=QJI+200*Cos(SQ5*bj_DEGTORAD)
set y=QKI+200*Sin(SQ5*bj_DEGTORAD)
call OA1(CreateDestructable('B006',x,y,-1*SQ5,0.6,1),7)
set SQ5=a+40
set x=QJI+200*Cos(SQ5*bj_DEGTORAD)
set y=QKI+200*Sin(SQ5*bj_DEGTORAD)
call OA1(CreateDestructable('B006',x,y,-1*SQ5,0.6,1),7)
set SQ5=a+80
set x=QJI+200*Cos(SQ5*bj_DEGTORAD)
set y=QKI+200*Sin(SQ5*bj_DEGTORAD)
call OA1(CreateDestructable('B006',x,y,-1*SQ5,0.6,1),7)
if target!=null then
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\ChainFreeze_F6.mdx",target,"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\FrostWyrmMissile\\FrostWyrmMissile.mdl",target,"chest"))
call Damage(Y6I,target,1,Y8I*70)
endif
endfunction
function SU5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),Y9I)==false then
call GroupAddUnit(Y9I,GetEnumUnit())
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\ChainFreeze_F6.mdx",GetEnumUnit(),"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\FrostWyrmMissile\\FrostWyrmMissile.mdl",GetEnumUnit(),"chest"))
call Damage(Y6I,GetEnumUnit(),1,Y8I*70)
endif
endfunction
function T05 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit TI5=(LoadUnitHandle(LY,(handle_id),(45)))
local real EN4=(LoadReal(LY,(handle_id),(683)))
local real ES4=(LoadReal(LY,(handle_id),(684)))
local real QXI=GetUnitX(TI5)
local real QYI=GetUnitY(TI5)
local real RM2=Atan2(ES4-QYI,EN4-QXI)
local real IV1=QXI+22*Cos(RM2)
local real IW1=QYI+22*Sin(RM2)
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local integer level=GetUnitAbilityLevel(hero,'A1YO')
local group g=NTI()
set GK=hero
set Y6I=hero
set Y9I=JAO
set Y8I=level
set Y7I=null
call GroupEnumUnitsInRange(g,IV1,IW1,225,Condition(function CA1))
call ForGroup(g,function SU5)
call NSI(g)
call SetUnitPosition(TI5,IV1,IW1)
if QNI(IV1,IW1,EN4,ES4)<40 then
call KillUnit(TI5)
call ShowUnit(TI5,false)
call SetUnitPathing(TI5,true)
call SP5(hero,null,IV1,IW1,RM2*bj_RADTODEG)
call NSI(JAO)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set TI5=null
set JAO=null
set g=null
return false
endfunction
function T15 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit TI5=CreateUnit(GetOwningPlayer(hero),'h0CS',GetUnitX(hero),GetUnitY(hero),0)
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local real RM2=Atan2(QKI-QYI,QJI-QXI)
local real EN4=PTI(QJI)
local real ES4=PUI(QKI)
call SetUnitFacing(TI5,RM2*bj_RADTODEG)
call SetUnitPathing(TI5,false)
call TriggerRegisterTimerEvent(t,.02,true)
call TriggerAddCondition(t,Condition(function T05))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(683),((EN4)*1.0))
call SaveReal(LY,(handle_id),(684),((ES4)*1.0))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(45),(TI5))
call SaveGroupHandle(LY,(handle_id),(133),(NTI()))
set hero=null
set TI5=null
set t=null
endfunction
function TO5 takes nothing returns boolean
if GetSpellAbilityId()=='A1YO' then
call T15()
endif
return false
endfunction
function P11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TO5))
set t=null
endfunction
function T25 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A1YQ')
local integer NPI=GetTriggerEvalCount(t)
local real y=(NPI-50)*(NPI-50)/4.3
local real PAI
if level==1 then
set PAI=75
elseif level==2 then
set PAI=150
else
set PAI=225
endif
if NPI==1 then
call IssueTargetOrder(hero,"attack",target)
endif
if NPI<50 then
if RNI(target)==false then
call SetUnitFlyHeight(target,700*NPI/50,0)
endif
elseif NPI<100 then
if RNI(target)==false then
call SetUnitFlyHeight(target,700-700*(NPI-50)/50,0)
endif
else
if RNI(target)==false then
call SetUnitFlyHeight(target,GetUnitDefaultFlyHeight(target),0)
endif
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call AX1(target,'A204',1,1+level,'B0DY')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A204',false)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function T35 takes unit hero,unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A1YQ')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call UYI("WALRUS PUNCH !!",3.5,hero,0.03,255,0,0,255)
call IO1(YF,GetUnitX(target),GetUnitY(target))
call AddSkill(dummy,'A1UP')
call IssueTargetOrder(dummy,"thunderbolt",target)
if RNI(target)==false then
call AddSkill(target,'Amrf')
call UnitRemoveAbility(target,'Amrf')
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"overhead"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"head"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"left,hand"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"right,hand"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"chest"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostBolt\\FrostBoltMissile.mdl",target,"origin"))
call TriggerRegisterTimerEvent(t,.01,true)
call TriggerAddCondition(t,Condition(function T25))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\FreezingBreath\\FreezingBreathMissile.mdl",target,"chest")))
set t=null
endfunction
function T45 takes nothing returns boolean
local trigger t2=GetTriggeringTrigger()
local integer KAO=GetHandleId(t2)
local unit hero=(LoadUnitHandle(LY,(KAO),(2)))
local unit target=(LoadUnitHandle(LY,(KAO),(17)))
local effect T55=(LoadEffectHandle(LY,(KAO),(32)))
local trigger t=(LoadTriggerHandle(LY,(KAO),(35)))
local integer handle_id=(LoadInteger(LY,(KAO),(375)))
if GetTriggerEvalCount(t2)==1 then
call IssueTargetOrder(hero,"attack",target)
else
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and GetEventDamage()>30 then
call AH1(hero,'A1UH',1,0.1)
call AH1(hero,'A1UI',1,0.1)
call DestroyEffect(T55)
call FlushTrigger(t2)
call FlushChildHashtable(LY,(KAO))
call FlushTrigger(t)
call FlushChildHashtable(LY,(handle_id))
call T35(hero,target)
endif
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==hero and GetTriggerUnit()!=target then
call FlushChildHashtable(LY,(KAO))
call FlushTrigger(t2)
endif
else
call UnitRemoveAbility(hero,'A1UH')
call UnitRemoveAbility(hero,'A1UI')
call RemoveSavedHandle(LY,(handle_id),(17))
call FlushChildHashtable(LY,(KAO))
call FlushTrigger(t2)
endif
endif
set t2=null
set t=null
set hero=null
set target=null
set T55=null
return false
endfunction
function T65 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target
local effect T55=(LoadEffectHandle(LY,(handle_id),(32)))
local trigger t2
local integer KAO
if GetTriggerEventId()!=EVENT_PLAYER_UNIT_ATTACKED then
call DestroyEffect(T55)
call UnitRemoveAbility(hero,'A1UH')
call UnitRemoveAbility(hero,'A1UI')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetAttacker()==hero and GetTriggerUnit()!=(LoadUnitHandle(LY,(handle_id),(17)))and IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(hero))==false and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false then
set target=GetTriggerUnit()
call SaveUnitHandle(LY,(handle_id),(17),(target))
call UnitRemoveAbility(hero,'A1UH')
call UnitRemoveAbility(hero,'A1UI')
if GetUnitState(target,UNIT_STATE_LIFE)/GetUnitState(target,UNIT_STATE_MAX_LIFE)>0.5 then
call AddSkill(hero,'A1UH')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1UH',false)
else
call AddSkill(hero,'A1UI')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1UI',false)
endif
call IssueImmediateOrder(hero,"stop")
set t2=CreateTrigger()
set KAO=GetHandleId(t2)
call TriggerRegisterTimerEvent(t2,0,false)
call TriggerRegisterTimerEvent(t2,2,false)
call TriggerRegisterUnitEvent(t2,target,EVENT_UNIT_DAMAGED)
call UMI(t2,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t2,Condition(function T45))
call SaveUnitHandle(LY,(KAO),(2),(hero))
call SaveUnitHandle(LY,(KAO),(17),(target))
call SaveEffectHandle(LY,(KAO),(32),(T55))
call SaveInteger(LY,(KAO),(375),(handle_id))
call SaveTriggerHandle(LY,(KAO),(35),(t))
endif
set t=null
set hero=null
set target=null
set T55=null
return false
endfunction
function T75 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterTimerEvent(t,10,false)
call TriggerAddCondition(t,Condition(function T65))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(null))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\WalrusPunchWeaponFX.mdx",hero,"weapon")))
set t=null
set hero=null
endfunction
function T85 takes nothing returns boolean
if GetSpellAbilityId()=='A1YQ' then
call T75()
endif
return false
endfunction
function PO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function T85))
set t=null
endfunction
function T95 takes nothing returns nothing
call ShowUnit(GetEnumUnit(),true)
call UnitRemoveAbility(GetEnumUnit(),'A04R')
call SetUnitInvulnerable(GetEnumUnit(),false)
call PauseUnit(GetEnumUnit(),false)
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
call SetUnitPosition(GetEnumUnit(),YHI,YZI)
call SelectUnitForPlayerSingle(GetEnumUnit(),GetOwningPlayer(GetEnumUnit()))
else
call MUSetUnitX(GetEnumUnit(),YHI)
call MUSetUnitY(GetEnumUnit(),YZI)
endif
if GetEnumUnit()==YCI and YDI!=null then
call IssueTargetOrder(YCI,"attack",YDI)
endif
if GetUnitTypeId(GetEnumUnit())=='E02I' then
call SetUnitVertexColor(GetEnumUnit(),255,255,255,255)
endif
call DestroyEffect(AddSpecialEffect("war3mapImported\\ChainFreeze_F6.mdx",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FrostWyrmMissile\\FrostWyrmMissile.mdl",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
endfunction
function Snowball_Slow takes nothing returns nothing
local integer OO1
if YGI==1 then
set OO1='A20F'
elseif YGI==2 then
set OO1='A20E'
elseif YGI==3 then
set OO1='A1SL'
elseif YGI==4 then
set OO1='A20D'
endif
if IsUnitInGroup(GetEnumUnit(),YAI)==false then
call GroupAddUnit(YAI,GetEnumUnit())
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),OO1,false)
call AX1(GetEnumUnit(),OO1,1,5,'B0DC')
endif
endfunction
function TA5 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),YAI)==false then
call GroupAddUnit(YAI,GetEnumUnit())
call Damage(YCI,GetEnumUnit(),1,40*YGI+40+YWI*(10+10*YGI))
call SetUnitAbilityLevel(YEI,'A0X6',DB1(0.25*YGI+0.25))
call MUSetUnitX(YEI,GetUnitX(GetEnumUnit()))
call MUSetUnitY(YEI,GetUnitY(GetEnumUnit()))
call IssueTargetOrder(YEI,"thunderbolt",GetEnumUnit())
endif
endfunction
function TB5 takes nothing returns nothing
call MUSetUnitX(GetEnumUnit(),YHI)
call MUSetUnitY(GetEnumUnit(),YZI)
endfunction
function TC5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real r=(LoadReal(LY,(handle_id),(671)))
local real a=UEI(GetUnitX(IG1),GetUnitY(IG1),QJI,QKI)*bj_DEGTORAD
local real x=GetUnitX(IG1)+r*Cos(a)
local real y=GetUnitY(IG1)+r*Sin(a)
local group JAO=(LoadGroupHandle(LY,(handle_id),(133)))
local group g
local integer NPI=GetTriggerEvalCount(t)
local real S83=RMinBJ(2.5+(NPI*0.02),10)
local real CY3=225+40*(NPI*0.02)
local integer TD5=(LoadInteger(LY,(handle_id),(34)))
set YWI=TD5
set YGI=GetUnitAbilityLevel(hero,'A1S7')
set GK=hero
set YAI=JAO
set YCI=hero
set YDI=target
set YEI=(LoadUnitHandle(LY,(handle_id),(19)))
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
call SetUnitFacing(IG1,a*bj_RADTODEG-180)
call SetUnitScale(IG1,S83,S83,S83)
set YHI=x
set YZI=y
call ForGroup((LoadGroupHandle(LY,(handle_id),(22))),function TB5)
if QNI(x,y,QJI,QKI)<r*2 or NPI==150 then
call UPI(x,y,300)
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,CY3,Condition(function CA1))
call ForGroup(g,function TA5)
call NSI(g)
set g=null
set YHI=x
set YZI=y
call ForGroup((LoadGroupHandle(LY,(handle_id),(22))),function T95)
call NSI((LoadGroupHandle(LY,(handle_id),(22))))
call NSI(JAO)
call KillUnit(IG1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitInvulnerable(hero,false)
call UnitRemoveAbility(hero,'Abun')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YO',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YQ',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YR',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1S7',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2XK',false)
else
if ModuloInteger(GetTriggerEvalCount(t),5)==0 then
call UPI(x,y,300)
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,CY3,Condition(function CA1))
call ForGroup(g,function TA5)
call NSI(g)
set g=null
endif
endif
set t=null
set hero=null
set IG1=null
set JAO=null
return false
endfunction
function TE5 takes unit hero,group g,unit TF5 returns nothing
if IsUnitInGroup(TF5,g)==false then
call GroupAddUnit(g,TF5)
call DestroyEffect(AddSpecialEffect("war3mapImported\\ChainFreeze_F6.mdx",GetUnitX(TF5),GetUnitY(TF5)))
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\FrostWyrmMissile\\FrostWyrmMissile.mdl",GetUnitX(TF5),GetUnitY(TF5)))
if hero!=TF5 then
call ShowUnit(TF5,false)
call AddSkill(TF5,'A04R')
call SetUnitInvulnerable(TF5,true)
call PauseUnit(TF5,true)
endif
if hero!=TF5 then
set YWI=YWI+1
endif
endif
endfunction
function TG5 takes nothing returns nothing
call TE5(YCI,YBI,GetEnumUnit())
endfunction
function TH5 takes nothing returns boolean
return((IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))==false and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))or(GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(GK)and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit()))))and((LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetFilterUnit()))),(139)))==false or YCI==GetFilterUnit())
endfunction
function TZ5 takes unit hero,unit target,integer TD5 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QXI=GetUnitX(hero)
local real QYI=GetUnitY(hero)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real a=UEI(QXI,QYI,QJI,QKI)*bj_DEGTORAD
local group g=NTI()
set YVI=0
set YWI=TD5
set YCI=hero
call SetUnitVertexColor(hero,255,255,255,0)
set YVI=1.5*RMaxBJ(133,GetUnitMoveSpeed(hero))+YWI*100
call SetUnitTimeScale(YFI,2)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function TC5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(YEI))
call SaveUnitHandle(LY,(handle_id),(45),(YFI))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(671),((YVI*0.02)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveInteger(LY,(handle_id),(34),(TD5))
call SaveGroupHandle(LY,(handle_id),(22),(YBI))
call SaveGroupHandle(LY,(handle_id),(133),(NTI()))
set t=null
set g=null
endfunction
function TV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real S83=RMinBJ(2.5+(NPI*0.02),10)
local real CY3=225+40*(NPI*0.02)
local unit TF5
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
set YGI=GetUnitAbilityLevel(hero,'A1S7')
set GK=hero
set YCI=hero
set YDI=target
set YEI=(LoadUnitHandle(LY,(handle_id),(19)))
set YFI=IG1
call SetUnitScale(IG1,S83,S83,S83)
if GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER then
if GetIssuedOrderId()==851971 then
set TF5=GetOrderTargetUnit()
if QLI(hero,TF5)<425 and IsUnitAlly(TF5,GetOwningPlayer(hero))==true and(IsUnitType(TF5,UNIT_TYPE_HERO)==true or GetOwningPlayer(TF5)==GetOwningPlayer(hero))then
call TE5(hero,(LoadGroupHandle(LY,(handle_id),(22))),TF5)
endif
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2XK' then
call TZ5(hero,target,YWI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
set YBI=(LoadGroupHandle(LY,(handle_id),(22)))
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),100+25,Condition(function TH5))
call ForGroup(g,function TG5)
call NSI(g)
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==200 then
call TZ5(hero,target,YWI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set hero=null
set IG1=null
return false
endfunction
function TW5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0C3',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
local group g=NTI()
set YVI=0
set YWI=0
set YCI=hero
set YBI=NTI()
set YVI=1.5*RMaxBJ(133,GetUnitMoveSpeed(hero))
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),100+25,Condition(function TH5))
call ForGroup(g,function TG5)
call NSI(g)
set YEI=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(YEI,'A0X6')
call SetUnitInvulnerable(hero,true)
call AddSkill(hero,'Abun')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YO',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YQ',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1YR',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A1S7',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2XK',true)
call AddSkill(hero,'A2XK')
call SetUnitTimeScale(IG1,2)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(YEI))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveGroupHandle(LY,(handle_id),(22),(YBI))
set t=null
set g=null
endfunction
function TX5 takes nothing returns boolean
if GetSpellAbilityId()=='A1S7' then
call TW5()
endif
return false
endfunction
function P21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function TX5))
call Q1I('A0X6')
set t=null
endfunction
function TY5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call IssueTargetOrder(hero,"move",target)
set t=null
set hero=null
set target=null
return false
endfunction
function TJ5 takes nothing returns nothing
local unit hero=GetSummonedUnit()
local unit target=GetSummoningUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerAddCondition(t,Condition(function TY5))
call TriggerRegisterTimerEvent(t,0.2,false)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function TK5 takes nothing returns boolean
local integer id=GetUnitTypeId(GetSummonedUnit())
if id=='o01J' or id=='o01K' or id=='o01L' or id=='o01M' then
call TJ5()
endif
return false
endfunction
function P31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function TK5))
endfunction
function TL5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call MUSetUnitX(hero,GetUnitX(target))
call MUSetUnitY(hero,GetUnitY(target))
call MUSetUnitX(dummy,GetUnitX(target))
call MUSetUnitY(dummy,GetUnitY(target))
endif
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function TM5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
set YXI=GetEventDamageSource()
endif
set t=null
set hero=null
set target=null
return false
endfunction
function TN5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetSummoningUnit()
local unit target=GetSummonedUnit()
local unit dummy
local integer TS5
local integer TT5
local integer TR5
if GetUnitTypeId(target)=='npn3' or GetUnitTypeId(target)=='npn6' or GetUnitTypeId(target)=='n010' then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function TL5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
if EA1(hero,'I0A8')then
call UnitAddAbility(dummy,'A04I')
endif
endif
if GetUnitAbilityLevel(hero,'A1B6')>0 then
if GetUnitTypeId(target)=='npn1' or GetUnitTypeId(target)=='npn4' or GetUnitTypeId(target)=='n011' then
set TS5=GetUnitAbilityLevel(hero,'A0MX')
if TS5>0 then
call AddSkill(target,'A0MX')
call SetUnitAbilityLevel(target,'A0MX',TS5)
endif
endif
if GetUnitTypeId(target)=='npn2' or GetUnitTypeId(target)=='npn5' or GetUnitTypeId(target)=='n012' then
set TR5=GetUnitAbilityLevel(hero,'Acdh')
if TR5>0 then
call AddSkill(target,'Acdh')
call SetUnitAbilityLevel(target,'Acdh',TR5)
endif
endif
if GetUnitTypeId(target)=='npn3' or GetUnitTypeId(target)=='npn6' or GetUnitTypeId(target)=='n010' then
set TT5=GetUnitAbilityLevel(hero,'A06M')
if TT5>0 then
call AddSkill(target,'A06M')
call SetUnitAbilityLevel(target,'A06M',TT5)
endif
endif
endif
set t=null
set hero=null
set target=null
set dummy=null
endfunction
function TP5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetSummoningUnit()
local unit target=GetSummonedUnit()
local integer TS5
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function TM5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
endfunction
function TQ5 takes nothing returns boolean
local integer RII=GetUnitTypeId(GetSummonedUnit())
call TN5()
if P3I(RII)then
call TP5()
endif
return false
endfunction
function P41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function TQ5))
set t=null
endfunction
function TU5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer PCI=(LoadInteger(LY,(handle_id),(30)))
local unit target=NYI(PCI)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero and(GetEventDamage()>40 or IsUnitType(target,UNIT_TYPE_STRUCTURE)==true or GetUnitTypeId(target)=='umtw' or GetUnitTypeId(target)=='ebal')and(LoadBoolean(LY,(GetHandleId(hero)),(183)))==true then
call SaveBoolean(LY,(GetHandleId(hero)),(183),(false))
call SaveReal(LY,(GetHandleId(hero)),(184),(((TimerGetElapsed(M)))*1.0))
call UnitRemoveAbility(hero,'A2XS')
call UnitRemoveAbility(hero,'A2XU')
call FlushChildHashtable(LY,(GetHandleId((LoadTriggerHandle(LY,(handle_id),(35))))))
call FlushTrigger((LoadTriggerHandle(LY,(handle_id),(35))))
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call NXI(PCI)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function R05 takes nothing returns boolean
local trigger t
local integer handle_id
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_DEATH then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(183),(false))
call SaveReal(LY,(GetHandleId(GetTriggerUnit())),(184),(((TimerGetElapsed(M)))*1.0))
call UnitRemoveAbility(GetTriggerUnit(),'A2XS')
call UnitRemoveAbility(GetTriggerUnit(),'A2XU')
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
elseif GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(182)))then
if IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set target=GetTriggerUnit()
set hero=GetAttacker()
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function TU5))
call SaveInteger(LY,(handle_id),(30),(NKI(target)))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveTriggerHandle(LY,(handle_id),(35),(GetTriggeringTrigger()))
set target=null
set hero=null
set t=null
endif
endif
return false
endfunction
function RI5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real QZI=(TimerGetElapsed(M))
local integer level=GetUnitAbilityLevel(SFI,'A0MX')
local real PD2=(LoadReal(LY,(GetHandleId(SFI)),(184)))
local boolean R15=(LoadBoolean(LY,(GetHandleId(SFI)),(183)))
local real Z7O=(LoadReal(LY,(handle_id),(411)))
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and GetAttacker()==SFI then
set Z7O=(TimerGetElapsed(M))
call SaveReal(LY,(handle_id),(411),((Z7O)*1.0))
endif
if((TimerGetElapsed(M))>(Z7O+18-2*level))and R15==false and GetUnitTypeId(SFI)=='Npbm' and IsUnitDead(SFI)==false then
call SaveBoolean(LY,(GetHandleId(SFI)),(183),(true))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function R05))
call SaveUnitHandle(LY,(handle_id),(182),(SFI))
call AddSkill(SFI,'A2XS')
call AddSkill(SFI,'A2XU')
call SetPlayerAbilityAvailable(GetOwningPlayer(SFI),'A2XS',false)
elseif R15==false and(GetUnitAbilityLevel(SFI,'A2XS')>0 or GetUnitAbilityLevel(SFI,'A2XU')>0)then
call UnitRemoveAbility(SFI,'A2XS')
call UnitRemoveAbility(SFI,'A2XU')
endif
set t=null
set SFI=null
return false
endfunction
function RO5 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function RI5))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(181),(0))
call SaveReal(LY,(handle_id),(411),(((TimerGetElapsed(M)))*1.0))
set SFI=null
set t=null
endfunction
function R25 takes nothing returns boolean
if GetLearnedSkill()=='A0MX' and GetUnitAbilityLevel(GetTriggerUnit(),'A0MX')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call RO5()
endif
return false
endfunction
function P51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function R25))
set t=null
endfunction
function R35 takes nothing returns nothing
call DD1(YYI,GetEnumUnit(),0.75+0.25*GetUnitAbilityLevel(YYI,'A27F'))
endfunction
function R45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local group g
local real d=QNI(QXI,QYI,QJI,QKI)/25
local location point
local integer NPI=GetTriggerEvalCount(t)
local real x=QXI+d*NPI*Cos(a)
local real y=QYI+d*NPI*Sin(a)
call MUSetUnitX(target,PTI(x))
call MUSetUnitY(target,PUI(y))
if RNI(target)==false then
call SetUnitFlyHeight(target,325-13*NPI,0)
endif
if NPI==25 then
call MUSetUnitX(target,PTI(QJI))
call MUSetUnitY(target,PUI(QKI))
if IsPointInRegion(LN,GetUnitX(target),GetUnitY(target))==true then
set point=BN1(GetUnitX(target),GetUnitY(target))
call MUSetUnitX(target,PPI(GetLocationX(point)))
call MUSetUnitY(target,Q0I(GetLocationY(point)))
call RemoveLocation(point)
set point=null
endif
set GK=hero
set YYI=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),350,Condition(function CA1))
call GroupRemoveUnit(g,target)
call ForGroup(g,function R35)
call NSI(g)
call UPI(GetUnitX(target),GetUnitY(target),150)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\WarStomp\\WarStompCaster.mdl",GetUnitX(target),GetUnitY(target)))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if RNI(target)==false then
call SetUnitFlyHeight(target,GetUnitDefaultFlyHeight(target),0)
endif
call SetUnitPathing(target,true)
endif
set t=null
set hero=null
set target=null
set g=null
return false
endfunction
function R55 takes unit hero,unit target,unit Target2,real R65,real R75,effect FX,effect RU2 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QJI=R65
local real QKI=R75
local real a=UEI(GetUnitX(target),GetUnitY(target),R65,R75)*bj_DEGTORAD
if QNI(GetUnitX(target),GetUnitY(target),R65,R75)>375 then
set QJI=GetUnitX(target)+375*Cos(a)
set QKI=GetUnitY(target)+375*Sin(a)
endif
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveReal(LY,(handle_id),(189),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(190),((GetUnitY(target))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(FX))
call SaveEffectHandle(LY,(handle_id),(176),(RU2))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function R45))
set t=null
endfunction
function R85 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer MKO=(LoadInteger(LY,(handle_id),(12)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local integer R95=(LoadInteger(LY,(handle_id),(706)))
local real a
if GetTriggerEventId()==EVENT_WIDGET_DEATH or(GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT and BG1(target)==false)then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A27F',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A27X',false)
call R55(hero,target,(LoadUnitHandle(LY,(handle_id),(711))),QJI,QKI,(LoadEffectHandle(LY,(handle_id),(32))),(LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A27X' then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
set a=UEI(GetUnitX(target),GetUnitY(target),GetSpellTargetX(),GetSpellTargetY())*bj_DEGTORAD
if QNI(GetUnitX(target),GetUnitY(target),GetSpellTargetX(),GetSpellTargetY())>375 then
set QJI=GetUnitX(target)+375*Cos(a)
set QKI=GetUnitY(target)+375*Sin(a)
else
set QJI=GetSpellTargetX()
set QKI=GetSpellTargetY()
endif
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect("Abilities\\Spells\\Other\\GeneralAuraTarget\\GeneralAuraTarget.mdl",QJI,QKI)))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
call SaveUnitHandle(LY,(handle_id),(711),(GetSpellTargetUnit()))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\GeneralAuraTarget\\GeneralAuraTarget.mdl",GetSpellTargetUnit(),"origin")))
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call SetUnitPathing(target,false)
if(LoadInteger(LY,(handle_id),(707)))==1 then
set R95=R95+3
else
set R95=R95-3
endif
call SaveInteger(LY,(handle_id),(706),(R95))
if R95==30 then
call SaveInteger(LY,(handle_id),(707),(-1))
elseif R95==-30 then
call SaveInteger(LY,(handle_id),(707),(1))
endif
if RNI(target)==false then
if NPI<15 then
call SetUnitFlyHeight(target,NPI*20,0)
else
call SetUnitFlyHeight(target,300+R95,0)
endif
endif
if NPI>(MKO-25)then
if RNI(target)==false then
call SetUnitFlyHeight(target,300,0)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A27F',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A27X',false)
call R55(hero,target,(LoadUnitHandle(LY,(handle_id),(711))),QJI,QKI,(LoadEffectHandle(LY,(handle_id),(32))),(LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function RA5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A27F')
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A282')
call SetUnitAbilityLevel(dummy,'A282',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A27F',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A27X',true)
call UnitAddAbility(hero,'A27X')
call SetUnitPathing(target,false)
if RNI(target)==false then
call AddSkill(target,'Amrf')
call UnitRemoveAbility(target,'Amrf')
endif
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(711),(target))
call SaveInteger(LY,(handle_id),(12),(R2I((1.25+0.25*level)/.02)))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveInteger(LY,(handle_id),(706),(0))
call SaveInteger(LY,(handle_id),(707),(1))
call SaveReal(LY,(handle_id),(47),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(48),((GetUnitY(target))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\AntiGravityTarget.mdx",target,"origin")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect("Abilities\\Spells\\Other\\GeneralAuraTarget\\GeneralAuraTarget.mdl",GetUnitX(target),GetUnitY(target))))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function R85))
set hero=null
set target=null
endfunction
function RB5 takes nothing returns boolean
if GetSpellAbilityId()=='A27F' and CanResistSkill(GetSpellTargetUnit())==false then
call RA5()
endif
return false
endfunction
function P61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function RB5))
call Q1I('A0X6')
call Q1I('A282')
set t=null
endfunction
function RC5 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A27G')
if IsUnitType(target,UNIT_TYPE_HERO)==true then
if level==1 then
call AH1(target,'A27W',1,10)
elseif level==2 then
call AH1(target,'A286',1,10)
elseif level==3 then
call AH1(target,'A285',1,10)
elseif level==4 then
call AH1(target,'A287',1,10)
endif
else
if level==1 then
call AH1(target,'A291',1,10)
elseif level==2 then
call AH1(target,'A28Z',1,10)
elseif level==3 then
call AH1(target,'A292',1,10)
elseif level==4 then
call AH1(target,'A290',1,10)
endif
endif
call IO1(PF,GetUnitX(target),GetUnitY(target))
endfunction
function RD5 takes nothing returns nothing
local real d
if IsUnitInGroup(GetEnumUnit(),YLI)==false then
set d=QLI(GetEnumUnit(),YKI)
if d<YMI then
set YMI=d
set YJI=GetEnumUnit()
endif
endif
endfunction
function RE5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local group g=NTI()
call GroupAddUnit(PR2,target)
call RC5(hero,target)
set GK=hero
set YJI=null
set YKI=target
set YLI=PR2
set YMI=999999
call GroupEnumUnitsInRange(g,x,y,440+25,Condition(function CF1))
call ForGroup(g,function RD5)
call NSI(g)
if YJI==null or GetTriggerEvalCount(t)>26 then
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set target=YJI
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set g=null
set t=null
set hero=null
set target=null
set PR2=null
return false
endfunction
function RF5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group PR2=NTI()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
call IO1(PF,GetUnitX(hero),GetUnitY(hero))
call AddSkill(dummy,'A284')
call SetUnitAbilityLevel(dummy,'A284',GetUnitAbilityLevel(hero,'A27G'))
call IssueTargetOrder(dummy,"chainlightning",target)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveGroupHandle(LY,(handle_id),(187),(PR2))
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerAddCondition(t,Condition(function RE5))
set hero=null
set target=null
set t=null
set dummy=null
endfunction
function RG5 takes nothing returns boolean
if GetSpellAbilityId()=='A27G' and CanResistSkill(GetSpellTargetUnit())==false then
call RF5()
endif
return false
endfunction
function P71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function RG5))
set t=null
endfunction
function RH5 takes nothing returns boolean
if IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),GetLearnedSkill())==1 then
if GetLearnedSkill()=='A27F' then
call UnitRemoveAbility(GetTriggerUnit(),'A27I')
elseif GetLearnedSkill()=='A27G' then
call UnitRemoveAbility(GetTriggerUnit(),'A27K')
elseif GetLearnedSkill()=='A27V' then
call UnitRemoveAbility(GetTriggerUnit(),'A27J')
endif
endif
return false
endfunction
function RZ5 takes integer RV5,integer RW5 returns nothing
set YTI[YPI]=RV5
set YRI[YPI]=RW5
set YPI=YPI+1
endfunction
function RX5 takes integer id returns integer
local integer i=0
loop
exitwhen i==YPI
if id==YTI[i]or id==YRI[i]then
return i
endif
set i=i+1
endloop
return-1
endfunction
function RY5 takes integer id returns nothing
set YNI[YSI]=id
set YSI=YSI+1
endfunction
function RJ5 takes integer id returns boolean
local integer i=0
loop
exitwhen i==YSI
if id==YNI[i]then
return true
endif
set i=i+1
endloop
return false
endfunction
function RK5 takes nothing returns boolean
if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and RJ5(GetSpellAbilityId())==false then
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(705),(GetSpellAbilityId()))
call SaveInteger(LY,(GetHandleId(GetTriggerUnit())),(712),(GetUnitAbilityLevel(GetTriggerUnit(),GetSpellAbilityId())))
endif
return false
endfunction
function RL5 takes unit u returns nothing
call UnitRemoveAbility(u,'A13D')
call UnitRemoveAbility(u,'A2NI')
call UnitRemoveAbility(u,'A1QV')
call UnitRemoveAbility(u,'A1TU')
call UnitRemoveAbility(u,'A24A')
call UnitRemoveAbility(u,'A24B')
call UnitRemoveAbility(u,'A1NH')
call UnitRemoveAbility(u,'A20N')
call UnitRemoveAbility(u,'A1Z2')
call UnitRemoveAbility(u,'A1Z3')
call UnitRemoveAbility(u,'A205')
call UnitRemoveAbility(u,'A1VU')
call UnitRemoveAbility(u,'A0GC')
call UnitRemoveAbility(u,'A24E')
call UnitRemoveAbility(u,'A0RT')
call UnitRemoveAbility(u,'A1RA')
call UnitRemoveAbility(u,'A0HA')
call UnitRemoveAbility(u,'A0SA')
call UnitRemoveAbility(u,'A121')
call UnitRemoveAbility(u,'A1WF')
call UnitRemoveAbility(u,'A02T')
call UnitRemoveAbility(u,'A1S9')
call UnitRemoveAbility(u,'A21H')
call UnitRemoveAbility(u,'A1MN')
call UnitRemoveAbility(u,'A06K')
call UnitRemoveAbility(u,'A0NE')
call UnitRemoveAbility(u,'A0MP')
call UnitRemoveAbility(u,'A2MB')
endfunction
function RM5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer RN5=(LoadInteger(LY,(handle_id),(704)))
local integer XD4=(LoadInteger(LY,(handle_id),(713)))
if RN5==(LoadInteger(LY,(GetHandleId(hero)),(704)))then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEvalCount(t)>(15-XD4)and IsUnitDead(hero)==false then
call UnitRemoveAbility(hero,RN5)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function RS5 takes unit hero,integer RN5,real Z7O returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function RM5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(704),(RN5))
call SaveInteger(LY,(GetHandleId(hero)),(704),(-1))
call SaveInteger(LY,(handle_id),(713),(R2I((TimerGetElapsed(M))-Z7O)))
set t=null
endfunction
function RT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer RN5=(LoadInteger(LY,(handle_id),(704)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=GetUnitAbilityLevel(hero,'A27H')
local real Z7O=(LoadReal(LY,(handle_id),(411)))
if level==0 then
set level=GetUnitAbilityLevel(hero,'A2V9')
endif
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT and GetTriggerEventId()!=EVENT_WIDGET_DEATH then
if NPI==0 then
call SaveInteger(LY,(handle_id),(34),(1))
call DisplayTimedTextToPlayer(GetOwningPlayer(hero),0,0,10,"|c00ff0303"+"你窃取来的技能还能保留20秒"+"|r")
else
call RL5(hero)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),RN5,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call RS5(hero,RN5,Z7O)
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A27H' or GetSpellAbilityId()=='A2V9' then
call RL5(hero)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),RN5,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call RS5(hero,RN5,Z7O)
elseif GetSpellAbilityId()==RN5 then
call SaveReal(LY,(handle_id),(411),(((TimerGetElapsed(M)))*1.0))
endif
elseif GetTriggerEventId()==EVENT_WIDGET_DEATH then
call RL5(hero)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),RN5,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call RS5(hero,RN5,Z7O)
endif
set t=null
set hero=null
return false
endfunction
function RR5 takes nothing returns nothing
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer RN5=(LoadInteger(LY,(handle_id),(704)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RP5=60*(2+GetUnitAbilityLevel(hero,'A27H'))
if GetUnitAbilityLevel(hero,'A27H')==0 then
set RP5=60*(2+GetUnitAbilityLevel(hero,'A2V9'))
endif
if(LoadInteger(LY,(GetHandleId(target)),(3000)))>0 then
call SaveInteger(LY,(GetHandleId(hero)),(3000),((LoadInteger(LY,(GetHandleId(target)),(3000)))))
endif
if(LoadInteger(LY,(GetHandleId(target)),(3001)))>0 then
call SaveInteger(LY,(GetHandleId(hero)),(3001),((LoadInteger(LY,(GetHandleId(target)),(3001)))))
endif
if(LoadInteger(LY,(GetHandleId(target)),(3002)))>0 then
call SaveInteger(LY,(GetHandleId(hero)),(3002),((LoadInteger(LY,(GetHandleId(target)),(3002)))))
endif
if(LoadInteger(LY,(GetHandleId(target)),(710)))>0 then
call SaveInteger(LY,(GetHandleId(hero)),(710),((LoadInteger(LY,(GetHandleId(target)),(710)))))
endif
call IO1(SF,GetUnitX(hero),GetUnitY(hero))
call UYI(GetObjectName(RN5),3.5,hero,0.024,170,0,255,216)
call SaveInteger(LY,(GetHandleId(hero)),(704),(RN5))
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),RN5,true)
call AddSkill(hero,RN5)
call SetUnitAbilityLevel(hero,RN5,level)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveInteger(LY,(handle_id),(704),(RN5))
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterTimerEvent(t,RP5,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterTimerEvent(t,RP5-20,false)
call TriggerAddCondition(t,Condition(function RT5))
set t=null
set hero=null
set target=null
endfunction
function RQ5 takes unit hero,unit target,integer RN5,integer level returns nothing
local trigger t=IJ1(target,hero,'h0DB',"RR5",900,false)
local integer handle_id=GetHandleId(t)
call IO1(NF,GetUnitX(target),GetUnitY(target))
call UYI(GetObjectName(RN5),3.75,target,0.024,170,0,255,216)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(704),(RN5))
call SaveInteger(LY,(handle_id),(5),(level))
set t=null
endfunction
function RU5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if RJ5(GetSpellAbilityId())==true then
else
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function P05 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer PI5
local integer P15=(LoadInteger(LY,(GetHandleId(target)),(705)))
if P15!=0 then
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\Nebula.mdx",target,"origin"))
set PI5=RX5(P15)
if PI5!=-1 then
if GetSpellAbilityId()=='A27H' then
set P15=YTI[PI5]
else
set P15=YRI[PI5]
endif
endif
call RQ5(hero,target,P15,(LoadInteger(LY,(GetHandleId(target)),(712))))
endif
set hero=null
set target=null
endfunction
function SpellSteal takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local string fx=""
if IsPlayerAlly(GetOwningPlayer(hero),GetLocalPlayer())or P0I(GetLocalPlayer())then
set fx="war3mapImported\\Nebula.mdx"
endif
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget(fx,target,"origin")))
call TriggerRegisterTimerEvent(t,20,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function RU5))
set hero=null
set target=null
endfunction
function PO5 takes nothing returns boolean
if(GetSpellAbilityId()=='A27H' or GetSpellAbilityId()=='A2V9')and CanResistSkill(GetSpellTargetUnit())==false then
call P05()
endif
return false
endfunction
function P25 takes nothing returns nothing
call RY5('A1WH')
call RY5('ANcr')
call RY5('A03G')
call RY5('A093')
call RY5('A15J')
call RY5('A0AG')
call RY5('A0BE')
call RY5('A1TX')
call RY5('A229')
call RY5('A1RI')
call RY5('A1C0')
call RY5('A11T')
call RY5('A19Z')
call RY5('A2NE')
call RY5('A13D')
call RY5('A2NI')
call RY5('A1QV')
call RY5('A1TU')
call RY5('A24A')
call RY5('A24B')
call RY5('A1NH')
call RY5('A20N')
call RY5('A1Z2')
call RY5('A1Z3')
call RY5('A205')
call RY5('A1VU')
call RY5('A0GC')
call RY5('A24E')
call RY5('A0RT')
call RY5('A1RA')
call RY5('A0HA')
call RY5('A0SA')
call RY5('A121')
call RY5('A1WF')
call RY5('A02T')
call RY5('A1S9')
call RY5('A21H')
call RY5('A1MN')
call RY5('A0KX')
call RY5('A0KW')
call RY5('A0A5')
call RY5('A0BG')
call RY5('A21W')
call RY5('A21X')
call RY5('A21V')
call RY5('A21Y')
call RY5('A1GU')
call RY5('A1VH')
call RY5('A1VG')
call RY5('A2M0')
call RY5('A2MB')
call RY5('A2O2')
call RY5('A2O9')
call RY5('A1S7')
call RY5('A2XK')
call RY5('A0QN')
call RY5('A026')
call RY5('AHfa')
call RY5('A09V')
call RY5('A0DY')
call RY5('A1WB')
call RY5('A0LZ')
call RY5('A0OI')
call RY5('A2UM')
call RY5('A1NA')
call RY5('A1EA')
call RY5('A0NS')
call RY5('A1DA')
call RY5('A28Q')
call RY5('A0WQ')
call RY5('A1T8')
call RY5('A10R')
call RY5('A11N')
call RY5('A0EY')
call RY5('A0FH')
call RY5('A0VK')
call RY5('A0VQ')
call RY5('A073')
call RY5('A03J')
call RY5('A04J')
call RY5('A04M')
call RY5('A04N')
call RY5('A27F')
call RY5('A27X')
call RY5('A27G')
call RY5('A27H')
call RY5('A0Q5')
call RY5('A0TK')
call RY5('AIbk')
call RY5('A0JY')
call RY5('A1AC')
call RY5('AIpl')
call RY5('AIpr')
call RY5('Aeat')
call RY5('A0K0')
call RY5('A0H7')
call RY5('A0H6')
call RY5('A0FO')
call RY5('A02X')
call RY5('AIsw')
call RY5('AItb')
call RY5('A0B6')
call RY5('A1R5')
call RY5('A206')
call RY5('A1FD')
call RY5('A1FO')
call RY5('A1FQ')
call RY5('A1IO')
call RY5('A0B8')
call RY5('A1WE')
call RY5('A0T8')
call RY5('A0T7')
call RY5('A017')
call RY5('A1QD')
call RY5('A1FP')
call RY5('A0JL')
call RY5('ACch')
call RY5('AIxk')
call RY5('AIpg')
call RY5('A11F')
call RY5('A11E')
call RY5('A0S3')
call RY5('A11D')
call RY5('A11G')
call RY5('A11H')
call RY5('A0T9')
call RY5('A15W')
call RY5('AChx')
call RY5('A0FD')
call RY5('A0TE')
call RY5('A1T7')
call RY5('A19M')
call RY5('A02O')
call RY5('A08Y')
call RY5('A08Z')
call RY5('A090')
call RY5('A092')
call RY5('A0HB')
call RY5('A0D3')
call RY5('A0DF')
call RY5('A02W')
call RY5('A0CK')
call RY5('A0K7')
call RY5('A0JT')
call RY5('AIda')
call RY5('A269')
call RY5('A1WO')
call RY5('A1EW')
call RY5('A1MO')
call RY5('A1ZI')
call RY5('A1ZH')
call RY5('A1ZW')
call RY5('A231')
call RY5('A12W')
call RY5('A14A')
call RY5('A1Q8')
call RY5('A28Y')
call RY5('A28D')
call RY5('A28F')
call RY5('A2N1')
call RY5('A2VE')
call RY5('A2WH')
call RY5('A2WI')
call RY5('A2JO')
call RY5('A2JQ')
call RY5('A2JP')
call RY5('A2JR')
call RY5('A2JL')
call RY5('A2FX')
call RY5('A2K1')
call RY5('A2K4')
call RY5('A2K7')
call RY5('A2KG')
call RY5('A2KE')
call RY5('A2KH')
call RY5('A2K9')
call RY5('A2EA')
call RY5('A2TH')
call RY5('A2TJ')
call RY5('A2TK')
call RY5('A2LI')
call RZ5('A1W8','A1W9')
call RZ5('A21F','A21G')
call RZ5('A05T','A08H')
call RZ5('A01P','A09Z')
call RZ5('A095','A09W')
call RZ5('A0MU','A0A2')
call RZ5('A054','A00U')
call RZ5('A067','A08P')
call RZ5('A0CC','A02Z')
call RZ5('A28R','A28S')
call RZ5('A00H','A0A1')
call RZ5('A03R','A0AV')
call RZ5('A013','A0A6')
call RZ5('A0NT','A0NX')
call RZ5('A29G','A29H')
call RZ5('A04P','A1AU')
call RZ5('A0Z8','A1CV')
call RZ5('A0IN','A1AW')
call RZ5('A0M1','A1AX')
call RZ5('A03O','A1AY')
call RZ5('A0LT','A1CS')
call RZ5('A03K','A1B0')
call RZ5('A0O5','A1B1')
call RZ5('A06R','A1B4')
call RZ5('A0QR','A1B3')
call RZ5('A21Y','A1GU')
call RZ5('A01Y','A1AZ')
call RZ5('A0MQ','A1B6')
call RZ5('A0FL','A1CX')
call RZ5('A12P','A1D6')
call RZ5('A0J1','A1D7')
call RZ5('A0G4','A1D8')
call RZ5('A02Q','A1D9')
call RZ5('A0NS','A1DA')
call RZ5('A10Q','A1DB')
call RZ5('A0AK','A1FY')
call RZ5('A0E2','A1MR')
call RZ5('A19O','A1MV')
call RZ5('A0DH','A1OB')
call RZ5('A0S8','A1QP')
call RZ5('S008','S00U')
call RZ5('A1AO','A1UV')
call RZ5('A080','A1UZ')
call RZ5('A0OK','A1VW')
call RZ5('A0DY','A1WB')
call RZ5('A0QK','A21Q')
call RZ5('A1T5','A235')
call RZ5('A0MW','A27C')
call RZ5('A0O2','A289')
call RZ5('A1NE','A2IG')
call RZ5('A0L3','A2QC')
call RZ5('A1MI','A2QE')
call RZ5('A0ER','A2S8')
call RZ5('A2BG','A2TU')
call RZ5('A1BX','A2TX')
call RZ5('A27H','A2V9')
call RZ5('A1U6','A2V8')
call RZ5('A049','A2WB')
call RZ5('A05E','A2WA')
endfunction
function P81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PO5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function RK5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function RH5))
set t=null
call P25()
endfunction
function P35 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A27S')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A27S')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A27Q')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A27Q')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A27R')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A27R')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A27T')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A27T')
endif
endfunction
function P45 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if YQI==1 then
if GetUnitAbilityLevel(GetEnumUnit(),'A27S')==0 then
call AddSkill(GetEnumUnit(),'A27S')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A27S',false)
endif
elseif YQI==2 then
if GetUnitAbilityLevel(GetEnumUnit(),'A27Q')==0 then
call UnitRemoveAbility(GetEnumUnit(),'A27S')
call AddSkill(GetEnumUnit(),'A27Q')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A27Q',false)
endif
elseif YQI==3 then
if GetUnitAbilityLevel(GetEnumUnit(),'A27R')==0 then
call UnitRemoveAbility(GetEnumUnit(),'A27S')
call UnitRemoveAbility(GetEnumUnit(),'A27Q')
call AddSkill(GetEnumUnit(),'A27R')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A27R',false)
endif
elseif YQI==4 then
if GetUnitAbilityLevel(GetEnumUnit(),'A27T')==0 then
call UnitRemoveAbility(GetEnumUnit(),'A27S')
call UnitRemoveAbility(GetEnumUnit(),'A27Q')
call UnitRemoveAbility(GetEnumUnit(),'A27R')
call AddSkill(GetEnumUnit(),'A27T')
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),'A27T',false)
endif
endif
endfunction
function P55 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group RG3=(LoadGroupHandle(LY,(handle_id),(340)))
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
if hero==null or GetUnitTypeId(hero)!='E02X' then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ForGroup(RG3,function P35)
call NSI(RG3)
call NSI(g)
return false
endif
set GK=hero
set YQI=GetUnitAbilityLevel(hero,'A27V')
if IsUnitDead(hero)==false then
call GroupEnumUnitsInRange(g,x,y,925,Condition(function CU1))
endif
call GroupRemoveGroup(g,RG3)
call ForGroup(RG3,function P35)
if IsUnitDead(hero)==false then
call ForGroup(g,function P45)
endif
call SaveGroupHandle(LY,(handle_id),(340),(g))
call NSI(RG3)
set t=null
set hero=null
set RG3=null
set g=null
return false
endfunction
function P65 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local integer i
local player p
call TriggerRegisterTimerEvent(t,0.3,true)
call TriggerAddCondition(t,Condition(function P55))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(340),(NTI()))
set i=0
loop
exitwhen i>5
set p=BO[i]
call SetPlayerAbilityAvailable(p,'A27S',false)
call SetPlayerAbilityAvailable(p,'A27Q',false)
call SetPlayerAbilityAvailable(p,'A27R',false)
call SetPlayerAbilityAvailable(p,'A27T',false)
set p=CO[i]
call SetPlayerAbilityAvailable(p,'A27S',false)
call SetPlayerAbilityAvailable(p,'A27Q',false)
call SetPlayerAbilityAvailable(p,'A27R',false)
call SetPlayerAbilityAvailable(p,'A27T',false)
set i=i+1
endloop
set t=null
set hero=null
endfunction
function P75 takes nothing returns boolean
if GetLearnedSkill()=='A27V' and GetUnitAbilityLevel(GetTriggerUnit(),'A27V')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call P65()
endif
return false
endfunction
function P91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function P75))
set t=null
endfunction
function P85 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call AddUnitAnimationProperties(hero,"alternate",false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function P95 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function P85))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function PA5 takes nothing returns boolean
if(GetSpellAbilityId()=='A073' or GetSpellAbilityId()=='A03J' or GetSpellAbilityId()=='A04J' or GetSpellAbilityId()=='A04M' or GetSpellAbilityId()=='A04N')and GetUnitTypeId(GetTriggerUnit())=='E02X' then
call P95()
endif
return false
endfunction
function PA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PA5))
set t=null
endfunction
function PB5 takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",GetTriggerUnit(),"origin"))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",GetTriggerUnit(),"origin"))
endfunction
function PC5 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='H00S' then
call PB5()
endif
return false
endfunction
function SZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function PC5))
set t=null
endfunction
function PD5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A29V')
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A29W' then
call UnitRemoveAbility(hero,'A29W')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A29W',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A29V',true)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call DD1(hero,target,0.5+0.5*level)
call MUSetUnitX(hero,GetUnitX(target))
call MUSetUnitY(hero,GetUnitY(target))
call IssueTargetOrder(hero,"attack",target)
call UnitShareVision(target,GetOwningPlayer(hero),false)
endif
else
call UnitRemoveAbility(hero,'A29W')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A29W',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A29V',true)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call UnitShareVision(target,GetOwningPlayer(hero),false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function PE5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEvalCount(GetTriggeringTrigger())>30 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call EO1(hero)
endif
set t=null
set hero=null
return false
endfunction
function PF5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer level=GetUnitAbilityLevel(hero,'A29V')
if NPI>60 then
call UnitRemoveAbility(hero,'B0EV')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>100 and IsUnitType(GetEventDamageSource(),UNIT_TYPE_STRUCTURE)==false then
call QGI(hero,GetEventDamage())
set target=K1[GetPlayerId(GetOwningPlayer(GetEventDamageSource()))]
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call EO1(hero)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if IsUnitDead(target)==false then
call UnitShareVision(target,GetOwningPlayer(hero),true)
call AddSkill(hero,'A29W')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A29W',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A29V',false)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function PD5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\RetaliationTarget.mdx",hero,"origin")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\RetaliationTarget.mdx",target,"origin")))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function PE5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
endif
else
call SaveInteger(LY,(handle_id),(34),(NPI+1))
endif
set t=null
set hero=null
return false
endfunction
function PG5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function PF5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\RetaliationShield.mdx",hero,"chest")))
set hero=null
set t=null
endfunction
function PH5 takes nothing returns boolean
if GetSpellAbilityId()=='A29V' then
call PG5()
endif
return false
endfunction
function Register_Retaliation takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PH5))
set t=null
endfunction
function PZ5 takes nothing returns nothing
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\ImmolationRed\\ImmolationRedDamage.mdl",GetEnumUnit(),"chest"))
call Damage(YUI,GetEnumUnit(),1,(20+10*J0I)/5)
endfunction
function PV5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer level=GetUnitAbilityLevel(hero,'A2HS')
local group g
if GetUnitAbilityLevel(hero,'B0FP')==0 and GetUnitAbilityLevel(hero,'B0FQ')==0 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A2H7')
call UnitRemoveAbility(hero,'B0FO')
call UnitRemoveAbility(hero,'A2IX')
call UnitRemoveAbility(hero,'A2IW')
call UnitRemoveAbility(hero,'A2IV')
call UnitRemoveAbility(hero,'A2IY')
else
set GK=hero
set YUI=hero
set J0I=level
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),400+25,Condition(function CA1))
call ForGroup(g,function PZ5)
call NSI(g)
endif
set g=null
set t=null
set hero=null
return false
endfunction
function PW5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
local integer level=GetUnitAbilityLevel(hero,'A2HS')
call UnitAddAbility(dummy,'A2H5')
call SetUnitAbilityLevel(dummy,'A2H5',level)
call IssueTargetOrder(dummy,"antimagicshell",hero)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function PV5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\FlameGuard.mdx",hero,"origin")))
if level==1 then
elseif level==2 then
elseif level==3 then
elseif level==4 then
endif
set hero=null
set dummy=null
set t=null
endfunction
function PX5 takes nothing returns boolean
if GetSpellAbilityId()=='A2HS' then
call PW5()
endif
return false
endfunction
function PC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PX5))
set t=null
endfunction
function PY5 takes unit hero returns nothing
call UnitRemoveAbility(hero,'BOhx')
call UnitRemoveAbility(hero,'B00H')
endfunction
function PJ5 takes unit hero returns nothing
call UnitRemoveAbility(hero,'A2H9')
call UnitRemoveAbility(hero,'B0FM')
endfunction
function PK5 takes unit hero returns nothing
call UnitRemoveAbility(hero,'A2JH')
call UnitRemoveAbility(hero,'A2JG')
call UnitRemoveAbility(hero,'A2JJ')
call UnitRemoveAbility(hero,'A2JI')
call UnitRemoveAbility(hero,'B0FL')
endfunction
function PL5 takes unit hero returns nothing
call AddSkill(hero,'A2H9')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2H9',false)
endfunction
function PM5 takes unit hero returns nothing
local integer level=GetUnitAbilityLevel(hero,'A2H0')
if level==1 then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2JH',false)
call AddSkill(hero,'A2JH')
elseif level==2 then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2JG',false)
call AddSkill(hero,'A2JG')
elseif level==3 then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2JJ',false)
call AddSkill(hero,'A2JJ')
elseif level==4 then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2JI',false)
call AddSkill(hero,'A2JI')
endif
endfunction
function PN5 takes unit hero,unit target returns nothing
local real a=GetRandomReal(0,360)
local real x=GetUnitX(target)+50*Cos(a*bj_DEGTORAD)
local real y=GetUnitY(target)+50*Sin(a*bj_DEGTORAD)
call SetUnitPosition(hero,x,y)
call SetUnitFacing(hero,bj_RADTODEG*Atan2(GetUnitY(target)-GetUnitY(hero),GetUnitX(target)-GetUnitX(hero)))
call SetUnitAnimation(hero,"Attack")
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\Fire_Blink_2.mdx",hero,"chest"))
call PK5(hero)
if IsUnitType(target,UNIT_TYPE_HERO)==true or IsUnitIllusion(target)==true then
call PM5(hero)
call UnitRemoveAbility(hero,'A2JF')
else
call AddSkill(hero,'A2JF')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2JF',false)
endif
call IssueTargetOrder(hero,"attack",target)
endfunction
function PS5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real QXI=(LoadReal(LY,(handle_id),(189)))
local real QYI=(LoadReal(LY,(handle_id),(190)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local unit target=null
local boolean FW1=false
local fogmodifier I31=(LoadFogModifierHandle(LY,(handle_id),(42)))
local integer level=GetUnitAbilityLevel(hero,'A2H0')
loop
exitwhen FirstOfGroup(g)==null or FW1
set target=FirstOfGroup(g)
call GroupRemoveUnit(g,target)
if IsUnitInGroup(target,PR2)and target!=null then
set target=null
set FW1=false
else
set FW1=true
endif
endloop
call SetUnitPathing(hero,false)
call SetUnitInvulnerable(hero,true)
call BF1(hero)
if FW1==false or((LoadInteger(LY,(GetHandleId((hero))),((4319))))==1)==true then
call SaveInteger(LY,(GetHandleId((hero))),((4318)),(2))
call PJ5(hero)
call UnitRemoveAbility(hero,'A2JF')
call PK5(hero)
call BF1(hero)
call PY5(hero)
call UnitAddAbility(hero,'A2H2')
call UnitRemoveAbility(hero,'A2H2')
call BF1(hero)
if((LoadInteger(LY,(GetHandleId((hero))),((4319))))==1)==false then
call MUSetUnitX(hero,QXI)
call MUSetUnitY(hero,QYI)
endif
call SetUnitVertexColor(hero,255,255,255,255)
call SetUnitPathing(hero,true)
call SetUnitInvulnerable(hero,false)
call SetUnitTimeScale(hero,1)
call NSI(PR2)
call NSI(g)
call RemoveUnit((LoadUnitHandle(LY,(handle_id),(19))))
call FogModifierStop(I31)
call DestroyFogModifier(I31)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call GroupAddUnit(PR2,target)
call PN5(hero,target)
endif
set t=null
set hero=null
set target=null
set g=null
set PR2=null
return false
endfunction
function PT5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local fogmodifier I31=CreateFogModifierRadius(GetOwningPlayer(hero),FOG_OF_WAR_VISIBLE,x,y,600,true,true)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'h0E7',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A2H0')
call SetUnitVertexColor(dummy,255,255,255,100)
call FogModifierStart(I31)
call SaveInteger(LY,(GetHandleId((hero))),((4318)),(1))
set GK=hero
call GroupEnumUnitsInRange(g,x,y,150+100*level+25,Condition(function CG1))
call BF1(hero)
call PY5(hero)
call UnitAddAbility(hero,'A2H1')
call UnitRemoveAbility(hero,'A2H1')
call SetUnitVertexColor(hero,255,255,255,125)
call SetUnitPathing(hero,false)
call SetUnitInvulnerable(hero,true)
call SetUnitTimeScale(hero,3)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function PS5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(189),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(190),((GetUnitY(hero))*1.0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveFogModifierHandle(LY,(handle_id),(42),(I31))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call PL5(hero)
call TriggerEvaluate(t)
set hero=null
set t=null
set I31=null
set dummy=null
set g=null
endfunction
function PR5 takes nothing returns boolean
if GetSpellAbilityId()=='A2H0' then
call PT5()
endif
return false
endfunction
function PP5 takes nothing returns boolean
local unit IYO=GetSummonedUnit()
if IsUnitIllusion(IYO)==true and GetUnitTypeId(IYO)=='N0MH' then
call PJ5(IYO)
call UnitRemoveAbility(IYO,'A2JF')
call PK5(IYO)
call UnitAddAbility(IYO,'A2H2')
call UnitRemoveAbility(IYO,'A2H2')
endif
set IYO=null
return false
endfunction
function PD1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function PR5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function PP5))
set t=null
endfunction
function PQ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2H3')
local integer MKO=1
local real PAI
if level==1 then
set MKO=1
set PAI=80
endif
if level==2 then
set MKO=2
set PAI=60
endif
if level==3 then
set MKO=2
set PAI=120
endif
if level==4 then
set MKO=3
set PAI=100
endif
if GetTriggerEvalCount(t)==MKO then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call Damage(hero,target,1,PAI)
set t=null
set hero=null
set target=null
return false
endfunction
function PU5 takes nothing returns nothing
local unit hero=GK
local unit target=HK
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A2H3')
call UnitAddAbility(dummy,'A2H4')
call SetUnitAbilityLevel(dummy,'A2H4',level)
call IssueTargetOrder(dummy,"ensnare",target)
call TriggerAddCondition(t,Condition(function PQ5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerRegisterTimerEvent(t,1,true)
set dummy=null
set hero=null
set target=null
endfunction
function Q05 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local unit u1=null
local unit u2=null
local unit u3=null
local integer VB2=0
local unit u
local trigger t
set GK=hero
call GroupEnumUnitsInRange(g,x,y,425,Condition(function CF1))
loop
exitwhen FirstOfGroup(g)==null or VB2==2
set u=GroupPickRandomUnit(g)
if u!=null then
if VB2==0 then
set u1=u
elseif VB2==1 then
set u2=u
elseif VB2==2 then
set u3=u
endif
set VB2=VB2+1
call GroupRemoveUnit(g,u)
endif
endloop
call NSI(g)
if u1!=null then
call IJ1(hero,u1,'h0E0',"PU5",9000,false)
endif
if u2!=null then
call IJ1(hero,u2,'h0E0',"PU5",9000,false)
endif
if u3!=null then
endif
set g=null
set hero=null
set u=null
set u1=null
set u2=null
set u3=null
endfunction
function QI5 takes nothing returns boolean
if GetSpellAbilityId()=='A2H3' then
call Q05()
endif
return false
endfunction
function PB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QI5))
set t=null
endfunction
function Q15 takes nothing returns boolean
local unit hero=(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))
local integer handle_id=GetHandleId(hero)
local integer i=0
local real SOI=(TimerGetElapsed(M))
local integer QO5=(LoadInteger(LY,(handle_id),(749)))
local real x
local real y
local real t
loop
exitwhen i>QO5
set t=(LoadReal(LY,(handle_id),(10000+i)))
if t+10>SOI then
set x=(LoadReal(LY,(handle_id),(11000+i)))
set y=(LoadReal(LY,(handle_id),(12000+i)))
endif
set i=i+1
endloop
set hero=null
return false
endfunction
function Q25 takes integer handle_id,integer QO5,real IV1,real IW1 returns boolean
local real x
local real y
local real t
local integer i=0
local real SOI=(TimerGetElapsed(M))
loop
exitwhen i>QO5
set t=(LoadReal(LY,(handle_id),(10000+i)))
if t+10>SOI then
set x=(LoadReal(LY,(handle_id),(11000+i)))
set y=(LoadReal(LY,(handle_id),(12000+i)))
if QNI(x,y,IV1,IW1)<75 then
return true
endif
endif
set i=i+1
endloop
return false
endfunction
function Q35 takes integer handle_id,integer QO5 returns integer
local real t
local integer i=0
local real SOI=(TimerGetElapsed(M))
loop
exitwhen i>QO5
set t=(LoadReal(LY,(handle_id),(10000+i)))
if t+10<SOI then
return i
endif
set i=i+1
endloop
return-1
endfunction
function Q45 takes unit hero,integer Q55,real x,real y returns nothing
local integer handle_id=GetHandleId(hero)
local integer QO5=(LoadInteger(LY,(handle_id),(749)))
local integer Q65
if Q25(handle_id,QO5,x,y)then
return
endif
set Q65=Q35(handle_id,QO5)
if Q65==-1 then
set Q65=QO5
set QO5=QO5+1
call SaveInteger(LY,(handle_id),(749),(QO5))
endif
call SaveInteger(LY,(handle_id),(13000),(Q55))
call SaveReal(LY,(handle_id),(10000),(((TimerGetElapsed(M)))*1.0))
call SaveReal(LY,(handle_id),(11000),((x)*1.0))
call SaveReal(LY,(handle_id),(11000),((y)*1.0))
endfunction
function Q75 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function Q15))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function Q85 takes nothing returns nothing
call Damage(J1I,GetEnumUnit(),1,50+JII*50)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Weapons\\LordofFlameMissile\\LordofFlameMissile.mdl",GetEnumUnit(),"origin"))
endfunction
function Q95 takes unit hero,unit DX3,real x,real y returns nothing
local group g
call KillUnit(DX3)
call U7I("war3mapImported\\Firaga_2.mdx",x,y,2)
set g=NTI()
set GK=hero
set J1I=hero
set JII=GetUnitAbilityLevel(hero,'A2JK')
call GroupEnumUnitsInRange(g,x,y,450+25,Condition(function CA1))
call UnitRemoveAbility(hero,'A04R')
call ForGroup(g,function Q85)
call AddSkill(hero,'A04R')
call NSI(g)
set g=null
endfunction
function QA5 takes unit hero,unit QB5 returns nothing
local integer handle_id=GetHandleId(hero)
local integer QC5=(LoadInteger(LY,(handle_id),(746)))
local unit QD5
local integer i=1
local integer x
loop
exitwhen i>QC5
set QD5=(LoadUnitHandle(LY,(handle_id),(1450+i)))
if QD5==QB5 then
set QC5=QC5-1
call SaveUnitHandle(LY,(handle_id),(1450+i),((LoadUnitHandle(LY,(handle_id),(1450+i+1)))))
call SaveInteger(LY,(handle_id),(746),(QC5))
set x=i+1
loop
exitwhen x>QC5
call SaveUnitHandle(LY,(handle_id),(1450+x),((LoadUnitHandle(LY,(handle_id),(1450+x+1)))))
set x=x+1
endloop
endif
set i=i+1
endloop
set QD5=null
endfunction
function QE5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit DX3=(LoadUnitHandle(LY,(handle_id),(19)))
local real IO3=GetUnitX(DX3)
local real I23=GetUnitY(DX3)
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real a=UEI(IO3,I23,QJI,QKI)*bj_DEGTORAD
local real IV1
local real IW1
local real d=QNI(IO3,I23,QJI,QKI)
local real JC3=GetUnitMoveSpeed(hero)*2.5*0.02
local group g
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call QA5(hero,DX3)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif d<2 then
call SetUnitAnimationByIndex(DX3,1)
else
if d<JC3 then
set IV1=QJI
set IW1=QKI
else
set IV1=IO3+JC3*Cos(a)
set IW1=I23+JC3*Sin(a)
endif
call MUSetUnitX(DX3,IV1)
call MUSetUnitY(DX3,IW1)
endif
set t=null
set hero=null
set DX3=null
return false
endfunction
function QF5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),GetSpellTargetX(),GetSpellTargetY())*bj_DEGTORAD
local integer handle_id=GetHandleId(hero)
local integer QC5=(LoadInteger(LY,(handle_id),(746)))
local integer level=GetUnitAbilityLevel(hero,'A2JK')
local unit QD5=(LoadUnitHandle(LY,(handle_id),(1450+1)))
local unit QG5=CreateUnit(GetOwningPlayer(hero),'h0E8',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
local trigger t
local integer i=1
set QC5=QC5+1
call SaveUnitHandle(LY,(handle_id),(1450+QC5),(QG5))
call SaveInteger(LY,(handle_id),(746),(QC5))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SetUnitVertexColor(QG5,255,255,255,75)
call SetUnitTimeScale(QG5,2)
call SetUnitAnimationByIndex(QG5,0)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function QE5))
call TriggerRegisterDeathEvent(t,QG5)
call UnitApplyTimedLife(QG5,'BTLF',45)
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\Phoenix_Missile_smaller.mdx",QG5,"hand right alternate")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\Phoenix_Missile_smaller.mdx",QG5,"hand left alternate")))
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffectTarget("war3mapImported\\FlameDash_Ground.mdx",QG5,"origin")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(QG5))
call SaveReal(LY,(handle_id),(47),((GetSpellTargetX())*1.0))
call SaveReal(LY,(handle_id),(48),((GetSpellTargetY())*1.0))
set hero=null
set t=null
set QD5=null
set QG5=null
endfunction
function QH5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(747)))
if JGO>0 then
call QF5()
call UnitRemoveAbility(hero,J5I[JGO])
set JGO=JGO-1
call SaveInteger(LY,(GetHandleId(hero)),(747),(JGO))
call AddSkill(hero,J5I[JGO])
else
call PZI(GetOwningPlayer(GetTriggerUnit()),"No more charges")
endif
set hero=null
endfunction
function QZ5 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='h0E8'
endfunction
function QV5 takes nothing returns nothing
local real QWI=QNI(GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),JOI,J2I)
if QWI>J3I and IsUnitDead(GetEnumUnit())==false then
set J4I=GetEnumUnit()
set J3I=QWI
endif
endfunction
function QW5 takes unit hero,real x,real y returns unit
local group g=NTI()
set J4I=null
set J3I=-1
set JOI=x
set J2I=y
call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(hero),Condition(function QZ5))
call ForGroup(g,function QV5)
call NSI(g)
set g=null
return J4I
endfunction
function FireRemnant_FindTargetClosest takes nothing returns nothing
local real QWI=QNI(GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),JOI,J2I)
if QWI<J3I and IsUnitDead(GetEnumUnit())==false then
set J4I=GetEnumUnit()
set J3I=QWI
endif
endfunction
function QX5 takes unit u1,unit u2 returns real
local real IT3=QLI(u1,u2)
local real Q4I=IT3/1300.0
if Q4I>0.4 then
return IT3/0.4
endif
return 1300.0
endfunction
function QY5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real EN4=(LoadReal(LY,(handle_id),(47)))
local real ES4=(LoadReal(LY,(handle_id),(48)))
local unit DX3=(LoadUnitHandle(LY,(handle_id),(19)))
local real IO3=GetUnitX(hero)
local real I23=GetUnitY(hero)
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real a
local real IV1
local real IW1
local real d
local real IF1=(LoadReal(LY,(handle_id),(44)))
local real JC3=IF1*0.02
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if DX3!=null then
set QJI=GetUnitX(DX3)
set QKI=GetUnitY(DX3)
call SaveReal(LY,(handle_id),(6),((QJI)*1.0))
call SaveReal(LY,(handle_id),(7),((QKI)*1.0))
endif
set a=UEI(IO3,I23,QJI,QKI)*bj_DEGTORAD
set d=QNI(IO3,I23,QJI,QKI)
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call SaveInteger(LY,(GetHandleId((hero))),((4319)),(2))
call SetUnitVertexColor(hero,255,255,255,255)
call SetUnitTimeScale(hero,1)
call SetUnitAnimationByIndex(hero,0)
call SetUnitPathing(hero,true)
call SetUnitInvulnerable(hero,false)
call UnitRemoveAbility(hero,'A04R')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif d<JC3 then
call MUSetUnitX(hero,QJI)
call MUSetUnitY(hero,QKI)
call Q95(hero,DX3,QJI,QKI)
set DX3=QW5(hero,EN4,ES4)
if DX3==null then
call SaveInteger(LY,(GetHandleId((hero))),((4319)),(2))
call UPI(QJI,QKI,100)
call SetUnitVertexColor(hero,255,255,255,255)
call SetUnitTimeScale(hero,1)
call SetUnitAnimationByIndex(hero,1)
call SetUnitPathing(hero,true)
call SetUnitInvulnerable(hero,false)
call UnitRemoveAbility(hero,'A04R')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SaveInteger(LY,(handle_id),(34),(NPI+1))
call SaveUnitHandle(LY,(handle_id),(19),(DX3))
call SaveReal(LY,(handle_id),(44),((QX5(hero,DX3))*1.0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(DX3))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(DX3))*1.0))
endif
else
call SetUnitAnimationByIndex(hero,0)
call SetUnitPathing(hero,false)
set IV1=IO3+JC3*Cos(a)
set IW1=I23+JC3*Sin(a)
call MUSetUnitX(hero,IV1)
call MUSetUnitY(hero,IW1)
call SetUnitFacing(hero,a*bj_RADTODEG)
call UPI(IV1,IW1,100)
endif
call Q45(hero,NPI,GetUnitX(hero),GetUnitY(hero))
set t=null
set hero=null
set DX3=null
return false
endfunction
function QJ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+150)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function QK5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t
local integer handle_id=GetHandleId(hero)
local integer QC5=(LoadInteger(LY,(handle_id),(746)))
local unit DX3
if QC5>0 and((LoadInteger(LY,(GetHandleId((hero))),((4319))))==1)==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SetUnitVertexColor(hero,255,0,0,75)
call SetUnitTimeScale(hero,2)
call SetUnitAnimationByIndex(hero,0)
call SetUnitPathing(hero,false)
call SetUnitInvulnerable(hero,true)
call AddSkill(hero,'A04R')
call SaveInteger(LY,(GetHandleId((hero))),((4319)),(1))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function QY5))
call TriggerRegisterDeathEvent(t,hero)
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\Phoenix_Missile_smaller.mdx",hero,"hand right alternate")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\Phoenix_Missile_smaller.mdx",hero,"hand left alternate")))
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffectTarget("war3mapImported\\FlameDash_Ground.mdx",hero,"origin")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(47),((GetSpellTargetX())*1.0))
call SaveReal(LY,(handle_id),(48),((GetSpellTargetY())*1.0))
set DX3=QW5(hero,GetSpellTargetX(),GetSpellTargetY())
call SaveUnitHandle(LY,(handle_id),(19),(DX3))
call SaveReal(LY,(handle_id),(44),((QX5(hero,DX3))*1.0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(DX3))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(DX3))*1.0))
call SaveInteger(LY,(handle_id),(34),(1))
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.0,false)
call TriggerAddCondition(t,Condition(function QJ5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
set t=null
set hero=null
set DX3=null
endfunction
function QL5 takes nothing returns boolean
if GetSpellAbilityId()==J5I[0]or GetSpellAbilityId()==J5I[1]or GetSpellAbilityId()==J5I[2]or GetSpellAbilityId()==J5I[3]then
call QH5()
elseif GetSpellAbilityId()=='A2JL' then
call QK5()
endif
return false
endfunction
function QM5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(747)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if JGO<3 then
set NPI=NPI-1
call SaveInteger(LY,(handle_id),(34),(NPI))
if NPI==0 then
call UnitRemoveAbility(hero,J5I[JGO])
set NPI=35
call SaveInteger(LY,(handle_id),(34),(NPI))
set JGO=JGO+1
call SaveInteger(LY,(GetHandleId(hero)),(747),(JGO))
call AddSkill(hero,J5I[JGO])
endif
endif
set t=null
set hero=null
return false
endfunction
function QN5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveInteger(LY,(GetHandleId(hero)),(747),(3))
call AddSkill(hero,J5I[3])
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function QM5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(handle_id),(34),(30))
set hero=null
set t=null
endfunction
function QS5 takes nothing returns boolean
if GetLearnedSkill()=='A2JK' and IsUnitIllusion(GetTriggerUnit())==false then
call AddSkill(GetTriggerUnit(),'A2JL')
call SetUnitAbilityLevel(GetTriggerUnit(),'A2JL',GetUnitAbilityLevel(GetTriggerUnit(),'A2JK'))
if GetUnitAbilityLevel(GetTriggerUnit(),'A2JK')==1 then
call QN5()
call Q75()
endif
endif
return false
endfunction
function PE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QL5))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function QS5))
set t=null
set J5I[0]='A2JO'
set J5I[1]='A2JQ'
set J5I[2]='A2JP'
set J5I[3]='A2JR'
endfunction
function QT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamage()>2 and J6I then
set J6I=false
call Damage(GetEventDamageSource(),target,3,GetEventDamage()*0.25)
set J6I=true
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function QR5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer level=GetUnitAbilityLevel(hero,'A2A8')
set J6I=true
call UnitAddAbility(dummy,'A2A7')
call SetUnitAbilityLevel(dummy,'A2A7',level)
call IssueTargetOrder(dummy,"soulburn",target)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,2+level,false)
call TriggerAddCondition(t,Condition(function QT5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set hero=null
set target=null
set t=null
endfunction
function QP5 takes nothing returns boolean
if GetSpellAbilityId()=='A2A8' then
call QR5()
endif
return false
endfunction
function Register_ArcaneSeal takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function QP5))
set t=null
endfunction
function QQ5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real d=(LoadReal(LY,(handle_id),(138)))
local real x=PTI(GetUnitX(target)+d/10*Cos(a))
local real y=PUI(GetUnitY(target)+d/10*Sin(a))
if GetTriggerEvalCount(t)==11 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call DestroyEffect(AddSpecialEffect("war3mapImported\\ThrustMovement.mdx",x,y))
call UPI(x,y,150)
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
endif
set target=null
set t=null
return false
endfunction
function QU5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A2A9')
local real a
local real x
local real y
local real d
local integer i=-1
local boolean K3O=false
if hero==target then
set a=GetUnitFacing(hero)*bj_DEGTORAD
else
set a=UDI(hero,target)*bj_DEGTORAD
endif
loop
exitwhen K3O or i==23
set i=i+1
set x=PTI(GetUnitX(target)+(350-i*25)*Cos(a))
set y=PUI(GetUnitY(target)+(350-i*25)*Sin(a))
if(IsPointInRegion(LN,((x)*1.0),((y)*1.0)))==false then
set K3O=true
endif
endloop
set d=QNI(x,y,GetUnitX(target),GetUnitY(target))
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function QQ5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(138),((d)*1.0))
if IsUnitAlly(hero,GetOwningPlayer(target))==true then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+50+50*level)
else
call Damage(hero,target,3,50+50*level)
endif
set hero=null
set target=null
set t=null
endfunction
function UI5 takes nothing returns boolean
if GetSpellAbilityId()=='A2A9' then
call QU5()
endif
return false
endfunction
function Register_Thrust takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UI5))
set t=null
endfunction
function U15 takes nothing returns nothing
call IssueTargetOrder(J7I,"ensnare",GetEnumUnit())
call Damage(GetTriggerUnit(),GetEnumUnit(),1,60*J8I)
endfunction
function UO5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g1=NTI()
local group g2=NTI()
local integer level=GetUnitAbilityLevel(hero,'A2A6')
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
set J8I=level
set J7I=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call UnitAddAbility(J7I,'A2AE')
call SetUnitAbilityLevel(J7I,'A2AE',level)
call GroupEnumUnitsInRange(g1,x,y,425,Condition(function C51))
call GroupEnumUnitsInRange(g2,x,y,825,Condition(function C51))
call GroupRemoveGroup(g1,g2)
call ForGroup(g2,function U15)
call NSI(g1)
call NSI(g2)
call DestroyEffect(AddSpecialEffect("war3mapImported\\ConjureForceAoE.mdx",x,y))
set hero=null
set g1=null
set g2=null
endfunction
function U25 takes nothing returns boolean
if GetSpellAbilityId()=='A2A6' then
call UO5()
endif
return false
endfunction
function Register_ConjureForce takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U25))
set t=null
endfunction
function U35 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),JAI)==false then
call GroupAddUnit(JAI,GetEnumUnit())
call Damage(J9I,GetEnumUnit(),3,JBI)
endif
endfunction
function U45 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real PAI=(LoadReal(LY,(handle_id),(20)))
local group H03
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x
local real y
if GetTriggerEvalCount(t)>67 then
call NSI(g)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(IG1)
else
set x=GetUnitX(IG1)
set y=GetUnitY(IG1)
set H03=NTI()
set JAI=g
set GK=IG1
set J9I=hero
set JBI=PAI
call GroupEnumUnitsInRange(H03,x,y,225,Condition(function CH1))
call ForGroup(H03,function U35)
call NSI(H03)
call MUSetUnitX(IG1,PTI(x+15*Cos(RM2*bj_DEGTORAD)))
call MUSetUnitY(IG1,PUI(y+15*Sin(RM2*bj_DEGTORAD)))
endif
set t=null
set g=null
set H03=null
set hero=null
set IG1=null
return false
endfunction
function U55 takes unit hero,real PAI,real x,real y returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local group g=NTI()
local real x1=GetUnitX(hero)
local real y1=GetUnitY(hero)
local real x2=x
local real y2=y
local real RM2=UEI(x1,y1,x2,y2)
local integer level=GetUnitAbilityLevel(hero,'A2AA')
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0DI',x1,y1,RM2)
call SetUnitScale(IG1,1.5,1.5,1.5)
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveGroupHandle(LY,(handle_id),(22),(g))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(20),((PAI)*1.0))
call TriggerRegisterTimerEvent(t,0.015,true)
call TriggerAddCondition(t,Condition(function U45))
set t=null
set IG1=null
set g=null
endfunction
function U65 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local boolean PK2=(LoadBoolean(LY,(handle_id),(95)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AB',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AA',true)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if PK2==false and GetEventDamage()>2 and GetEventDamage()<3000 and IsUnitIllusion(target)==false then
call SaveReal(LY,(handle_id),(20),(((LoadReal(LY,(handle_id),(20)))+GetEventDamage())*1.0))
call QGI(target,GetEventDamage())
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_ENDCAST then
if GetSpellAbilityId()=='A2AA' then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call SaveBoolean(LY,(handle_id),(95),(true))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2AB' then
call U55(hero,(LoadReal(LY,(handle_id),(20))),GetSpellTargetX(),GetSpellTargetY())
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AB',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AA',true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AB',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AA',true)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function U75 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(hero,'A2AB')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AB',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2AA',false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_ENDCAST)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterTimerEvent(t,20,false)
call TriggerAddCondition(t,Condition(function U65))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveBoolean(LY,(handle_id),(95),(false))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\WispShellBlue_2.mdx",hero,"origin")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\DivineWrathTarget.mdx",target,"origin")))
set hero=null
set target=null
set t=null
endfunction
function U85 takes nothing returns boolean
if GetSpellAbilityId()=='A2AA' then
call U75()
endif
return false
endfunction
function Register_DivineWrath takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U85))
set t=null
endfunction
function U95 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT or GetSpellAbilityId()=='A2BD' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2BC',true)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2BD',false)
call UnitRemoveAbility(hero,'Aetl')
call UnitRemoveAbility(hero,'A2B3')
call UnitRemoveAbility(hero,'A2B0')
call UnitRemoveAbility(hero,'A2B1')
call UnitRemoveAbility(hero,'A2B2')
call UnitRemoveAbility(hero,'B0F2')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function UA5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2BC')
call TriggerRegisterTimerEvent(t,5,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DEATH)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function U95))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call UnitAddAbility(hero,'A2BD')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2BC',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2BD',true)
call UnitAddAbility(hero,'Aetl')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'Aetl',false)
if level==1 then
call UnitAddAbility(hero,'A2B3')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2B3',false)
elseif level==2 then
call UnitAddAbility(hero,'A2B0')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2B0',false)
elseif level==3 then
call UnitAddAbility(hero,'A2B1')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2B1',false)
elseif level==4 then
call UnitAddAbility(hero,'A2B2')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2B2',false)
endif
set t=null
set hero=null
endfunction
function UB5 takes nothing returns boolean
if GetSpellAbilityId()=='A2BC' then
call UA5()
endif
return false
endfunction
function Register_Wraith takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UB5))
set t=null
endfunction
function UC5 takes unit hero,unit VS5,unit target,integer level returns nothing
call GroupAddUnit(JCI,target)
call DD1(hero,target,1.25+0.25*level)
call Damage(hero,target,1,40*level)
call KillUnit(VS5)
endfunction
function UD5 takes nothing returns boolean
if(IsUnitEnemy(GK,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or CI1(GetFilterUnit())))and(IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GK))==true or BU1(GetFilterUnit())==false)then
return IsUnitInGroup(GetFilterUnit(),JCI)==false
endif
return false
endfunction
function UE5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local group g
local integer i=1
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real a=(LoadReal(LY,(handle_id),(137)))
local unit VS5
local unit target
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
set JCI=PR2
set x=PTI(x+12*Cos(a))
set y=PUI(y+12*Sin(a))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
if GetTriggerEvalCount(t)>39 then
loop
exitwhen i>3
call KillUnit((LoadUnitHandle(LY,(handle_id),(393+i-1))))
set i=i+1
endloop
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,x,y,275,Condition(function UD5))
loop
exitwhen i>3
if(LoadBoolean(LY,(handle_id),(511+i-1)))==false then
set VS5=(LoadUnitHandle(LY,(handle_id),(393+i-1)))
set x=(LoadReal(LY,(handle_id),(549+i-1)))
set y=(LoadReal(LY,(handle_id),(567+i-1)))
set x=PTI(x+12*Cos(a))
set y=PUI(y+12*Sin(a))
call SaveReal(LY,(handle_id),(549+i-1),((x)*1.0))
call SaveReal(LY,(handle_id),(567+i-1),((y)*1.0))
call MUSetUnitX(VS5,x)
call MUSetUnitY(VS5,y)
set target=GroupPickRandomUnit(g)
if target!=null then
call GroupRemoveUnit(g,target)
call SaveInteger(LY,(GetHandleId((target))),((4314)),(1))
call SaveBoolean(LY,(handle_id),(511+i-1),(true))
call UC5(hero,VS5,target,GetUnitAbilityLevel(hero,'A2B4'))
endif
endif
set i=i+1
endloop
call NSI(g)
set g=null
set VS5=null
set target=null
endif
set t=null
set hero=null
return false
endfunction
function UF5 takes nothing returns nothing
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real a=UEI(x,y,QJI,QKI)*bj_DEGTORAD
local real b
local unit dummy
local real IV1=PTI(x+500*Cos(a))
local real IW1=PUI(y+500*Sin(a))
local integer i=0
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real DJ1
local integer level=GetUnitAbilityLevel(hero,'A2B4')
local integer RII='h0DN'
set i=i+1
set b=a*bj_RADTODEG+90
if b>360 then
set b=b-360
endif
set b=b*bj_DEGTORAD
set dummy=CreateUnit(GetOwningPlayer(hero),RII,x+100*Cos(a)+100*Cos(b),y+100*Sin(a)+100*Sin(b),a*bj_RADTODEG)
call SaveUnitHandle(LY,(handle_id),(393+i-1),(dummy))
call SaveBoolean(LY,(handle_id),(511+i-1),(false))
call SaveReal(LY,(handle_id),(549+i-1),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(567+i-1),((GetUnitY(dummy))*1.0))
set i=i+1
set b=a*bj_RADTODEG-90
if b<0 then
set b=360+b
endif
set b=b*bj_DEGTORAD
set dummy=CreateUnit(GetOwningPlayer(hero),RII,x+100*Cos(a)+100*Cos(b),y+100*Sin(a)+100*Sin(b),a*bj_RADTODEG)
call SaveUnitHandle(LY,(handle_id),(393+i-1),(dummy))
call SaveBoolean(LY,(handle_id),(511+i-1),(false))
call SaveReal(LY,(handle_id),(549+i-1),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(567+i-1),((GetUnitY(dummy))*1.0))
set i=i+1
set dummy=CreateUnit(GetOwningPlayer(hero),RII,x+100*Cos(a),y+100*Sin(a),a*bj_RADTODEG)
call SaveUnitHandle(LY,(handle_id),(393+i-1),(dummy))
call SaveBoolean(LY,(handle_id),(511+i-1),(false))
call SaveReal(LY,(handle_id),(549+i-1),((GetUnitX(dummy))*1.0))
call SaveReal(LY,(handle_id),(567+i-1),((GetUnitY(dummy))*1.0))
call TriggerRegisterTimerEvent(t,0.015,true)
call TriggerAddCondition(t,Condition(function UE5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(47),((IV1)*1.0))
call SaveReal(LY,(handle_id),(48),((IW1)*1.0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
set hero=null
set dummy=null
set t=null
endfunction
function UG5 takes nothing returns boolean
if GetSpellAbilityId()=='A2B4' then
call UF5()
endif
return false
endfunction
function Q31 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UG5))
set t=null
endfunction
function UH5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=GetTriggerEvalCount(t)
local integer level=GetUnitAbilityLevel(hero,'A2B5')
if NPI==6 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitShareVision(target,GetOwningPlayer(hero),false)
endif
call Damage(hero,target,1,20+10*level)
set t=null
set hero=null
set target=null
return false
endfunction
function UZ5 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function UH5))
call SaveUnitHandle(LY,(handle_id),(2),(GetTriggerUnit()))
call SaveUnitHandle(LY,(handle_id),(17),(GetEnumUnit()))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Weapons\\BansheeMissile\\BansheeMissile.mdl",GetEnumUnit(),"overhead")))
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl",GetEnumUnit(),"origin"))
call UnitShareVision(GetEnumUnit(),GetOwningPlayer(GetTriggerUnit()),true)
set t=null
endfunction
function UV5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(dummy,'A2B7')
call IssueImmediateOrderById(dummy,852625)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Undead\\AnimateDead\\AnimateDeadTarget.mdl",GetUnitX(hero),GetUnitY(hero)))
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),625,Condition(function C51))
call ForGroup(g,function UZ5)
call NSI(g)
set g=null
set hero=null
set dummy=null
endfunction
function UW5 takes nothing returns boolean
if GetSpellAbilityId()=='A2B5' then
call UV5()
endif
return false
endfunction
function Register_Miasma takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UW5))
set t=null
endfunction
function GetTotalMinutes takes nothing returns integer
return R2I((TimerGetElapsed(M))/60)
endfunction
function UX5 takes unit hero,integer ZO3 returns nothing
local integer JD3=GetHeroAgi(hero,false)
local integer JE3=GetHeroStr(hero,false)
local integer UY5=GetHeroInt(hero,false)
call SetHeroAgi(hero,JD3-ZO3,true)
call SetHeroStr(hero,JE3-ZO3,true)
call SetHeroInt(hero,UY5-ZO3,true)
endfunction
function UJ5 takes unit hero,integer ZO3 returns nothing
local integer JD3=GetHeroAgi(hero,false)
local integer JE3=GetHeroStr(hero,false)
local integer UY5=GetHeroInt(hero,false)
call SetHeroAgi(hero,JD3+ZO3,true)
call SetHeroStr(hero,JE3+ZO3,true)
call SetHeroInt(hero,UY5+ZO3,true)
endfunction
function UK5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer UL5=(LoadInteger(LY,(handle_id),(744)))
local integer level=GetUnitAbilityLevel(hero,'A2G2')
local integer BX1=(R2I((TimerGetElapsed(M))/60))
local real HJ3=level+1+(0.1+0.1*level)*BX1
local integer UM5=3+3*level+R2I((0.1+0.1*level)*BX1)
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2G2' then
if target!=null and target!=GetSpellTargetUnit()then
call UnitRemoveAbility(target,'A2IO')
call UX5(target,UL5)
call UX5(hero,UL5)
call SaveInteger(LY,(handle_id),(744),(0))
endif
set target=GetSpellTargetUnit()
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(target,'A2IO')
call U5I("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl",hero,"chest",1.9)
call U5I("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl",target,"chest",1.9)
return false
else
return false
endif
endif
if target==null then
elseif IsUnitDead(target)or IsUnitDead(hero)or QLI(hero,target)>1400 then
call UX5(hero,UL5)
call UX5(target,UL5)
call SaveInteger(LY,(handle_id),(744),(0))
call UnitRemoveAbility(hero,'A2IO')
call UnitRemoveAbility(target,'A2IO')
else
if GetUnitAbilityLevel(hero,'A2IO')==0 then
call AddSkill(hero,'A2IO')
endif
if GetUnitAbilityLevel(target,'A2IO')==0 then
call AddSkill(target,'A2IO')
endif
if UL5!=UM5 then
call UJ5(hero,UM5-UL5)
call UJ5(target,UM5-UL5)
call SaveInteger(LY,(handle_id),(744),(UM5))
endif
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+HJ3)
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+HJ3)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function UN5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UK5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(null))
call SaveInteger(LY,(handle_id),(744),(0))
set t=null
set hero=null
endfunction
function US5 takes nothing returns boolean
if GetLearnedSkill()=='A2G2' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A2G2')==1 then
call UN5()
endif
return false
endfunction
function Register_Brotherhood takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function US5))
set t=null
endfunction
function UT5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or(GetEventDamage()>30 and GetEventDamageSource()!=GetTriggerUnit()and T2I(GetOwningPlayer(GetEventDamageSource())))then
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
call QGI(hero,GetEventDamage())
endif
call UnitRemoveAbility(hero,'A2IL')
call UnitRemoveAbility(hero,'A2IM')
call UnitRemoveAbility(hero,'A2BY')
call UnitRemoveAbility(hero,'A2IN')
call UnitRemoveAbility(hero,'B0F4')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
return false
endfunction
function UR5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local integer level=GetUnitAbilityLevel(hero,'A2BV')
local real d
local integer id
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
if level==1 then
set d=4
set id='A2IL'
elseif level==2 then
set d=5
set id='A2IM'
elseif level==3 then
set d=6
set id='A2BY'
elseif level==4 then
set d=7
set id='A2IN'
endif
call AddSkill(target,id)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),id,false)
call TriggerAddCondition(t,Condition(function UT5))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,d,false)
call SaveUnitHandle(LY,(handle_id),(2),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIsp\\SpeedTarget.mdl",target,"origin")))
set hero=null
set target=null
set t=null
endfunction
function UP5 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),375,Condition(function CR1))
call ForGroup(g,function UR5)
call NSI(g)
set g=null
set hero=null
endfunction
function UQ5 takes nothing returns boolean
if GetSpellAbilityId()=='A2BV' then
call UP5()
endif
return false
endfunction
function Register_Gallop takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function UQ5))
endfunction
function UU5 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit Z4O=(LoadUnitHandle(LY,(handle_id),(17)))
local integer AF1=(LoadInteger(LY,(handle_id),(59)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,AF1)
call UnitRemoveAbility(hero,'B0FJ')
call UnitRemoveAbility(hero,'B0FK')
elseif GetEventDamageSource()==hero and GetEventDamage()>0 then
call TriggerRegisterTimerEvent(t,0.3,false)
endif
set t=null
set hero=null
set Z4O=null
return false
endfunction
function I06 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit Z4O=GetAttacker()
local integer level=GetUnitAbilityLevel(hero,'A2EY')
local integer id
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if hero==GetTriggerUnit()and((LoadInteger(LY,(GetHandleId((hero))),((4316))))==1)==false and IsUnitAlly(hero,GetOwningPlayer(Z4O))==false then
if GetRandomReal(0,100)<(NPI+1)*JDI[level]then
call SaveInteger(LY,(handle_id),(34),(0))
call SCI(hero,4316,0.9)
if level==1 then
set id='A2GD'
elseif level==2 then
set id='A2GE'
elseif level==3 then
set id='A2GF'
elseif level==4 then
set id='A2GC'
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),id,false)
call AddSkill(hero,id)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,Z4O,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1.0,false)
call TriggerAddCondition(t,Condition(function UU5))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(Z4O))
call SaveInteger(LY,(handle_id),(59),(id))
else
call SaveInteger(LY,(handle_id),(34),(NPI+1))
endif
endif
set t=null
set hero=null
set Z4O=null
return false
endfunction
function II6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterAnyUnitEventBJ(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function I06))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set t=null
endfunction
function I16 takes nothing returns boolean
if GetLearnedSkill()=='A2EY' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A2EY')==1 then
call II6()
endif
return false
endfunction
function PH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function I16))
set t=null
set JDI[1]=3.646
set JDI[2]=4.562
set JDI[3]=5.570
set JDI[4]=6.668
endfunction
function IO6 takes unit u,integer d returns nothing
local integer array b
local integer a=d
local integer c=1
local integer i=0
local integer EU1
if d<1 then
call UnitRemoveAbility(u,JEI[0])
call UnitRemoveAbility(u,JEI[1])
call UnitRemoveAbility(u,JEI[2])
call UnitRemoveAbility(u,JEI[3])
call UnitRemoveAbility(u,JEI[4])
call UnitRemoveAbility(u,JEI[5])
call UnitRemoveAbility(u,JEI[6])
call UnitRemoveAbility(u,JEI[7])
call UnitRemoveAbility(u,JEI[8])
return
endif
loop
exitwhen c==0
set c=a/2
set b[i]=a-c*2
set a=c
set i=i+1
endloop
set EU1=8
set i=0
loop
exitwhen i>EU1
if b[i]==1 then
call AddSkill(u,JEI[i])
else
call UnitRemoveAbility(u,JEI[i])
endif
set i=i+1
endloop
endfunction
function I26 takes unit hero,integer level,unit target returns nothing
local integer handle_id=GetHandleId(hero)
local integer I36=(LoadInteger(LY,(handle_id),(739)))
if IsUnitType(target,UNIT_TYPE_HERO)==true then
set I36=I36+6+4*level
call SaveInteger(LY,(handle_id),(739),(I36))
call UYI(GetUnitName(hero)+" Won The Duel!!",5,hero,0.03,255,0,0,255)
call IO6(hero,I36)
endif
endfunction
function I46 takes unit u returns boolean
return GetUnitAbilityLevel(u,'Bcyc')==0 or PII(u)==false
endfunction
function I56 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real GW1=(LoadReal(LY,(handle_id),(442)))
local unit dummy
call BP1(hero)
call BP1(target)
if GetTriggerEvalCount(t)==1 then
set dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2G5')
call IssueTargetOrder(dummy,"doom",target)
set dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call UnitAddAbility(dummy,'A2G5')
call IssueTargetOrder(dummy,"doom",hero)
set dummy=null
endif
if GetTriggerEventId()==EVENT_WIDGET_DEATH or GW1<(TimerGetElapsed(M))or I46(hero)==false or I46(target)==false then
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
if GetTriggerUnit()==hero then
call I26(target,level,GetTriggerUnit())
else
call I26(hero,level,GetTriggerUnit())
endif
endif
call UnitRemoveAbility(hero,'B0FG')
call UnitRemoveAbility(target,'B0FG')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call SetUnitPathing(hero,true)
call SetUnitPathing(target,true)
elseif GetIssuedOrderId()!=851973 then
call SetUnitPathing(hero,false)
call SetUnitPathing(target,false)
call DisableTrigger(t)
call IssueTargetOrder(hero,"attack",target)
call IssueTargetOrder(target,"attack",hero)
call EnableTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function I66 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2CI')
local trigger t
local integer handle_id
call SetUnitPathing(hero,false)
call SetUnitPathing(target,false)
call IssueTargetOrder(hero,"attack",target)
call IssueTargetOrder(target,"attack",hero)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\DuelFX.mdx",hero,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("war3mapImported\\DuelFX.mdx",target,"overhead")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+0.75*level+3.25)*1.0))
call TriggerAddCondition(t,Condition(function I56))
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_ISSUED_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ISSUED_ORDER)
set hero=null
set target=null
set t=null
endfunction
function I76 takes nothing returns boolean
if GetSpellAbilityId()=='A2CI' and CanResistSkill(GetSpellTargetUnit())==false then
call I66()
endif
return false
endfunction
function PV1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function I76))
set t=null
set JEI[0]='A2GK'
set JEI[1]='A2GJ'
set JEI[2]='A2GI'
set JEI[3]='A2GH'
set JEI[4]='A2GN'
set JEI[5]='A2GO'
set JEI[6]='A2GM'
set JEI[7]='A2GL'
set JEI[8]='A2GP'
endfunction
function I86 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real d
local unit Z4O
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
set d=GetEventDamage()
if RSI(d)and d>50 then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
set Z4O=GetEventDamageSource()
if IsUnitType(Z4O,UNIT_TYPE_HERO)==false and GetUnitAbilityLevel(Z4O,'A04R')!=0 then
set Z4O=K1[GetPlayerId(GetOwningPlayer(Z4O))]
endif
call QGI(hero,d)
set d=d*(0.4+0.2*level)
if IsUnitAlly(target,GetOwningPlayer(hero))==true then
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+d)
else
call Damage(hero,target,3,d)
endif
endif
endif
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or NPI==3 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function I96 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2IQ')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call U5I("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl",hero,"chest",1.9)
call U5I("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl",target,"chest",1.9)
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkTarget.mdl",hero,"chest")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkTarget.mdl",target,"chest")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
call TriggerAddCondition(t,Condition(function I86))
call TriggerRegisterTimerEvent(t,10,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
set hero=null
set target=null
set t=null
endfunction
function IA6 takes nothing returns boolean
if GetSpellAbilityId()=='A2IQ' then
call I96()
endif
return false
endfunction
function Register_Deflection takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IA6))
set t=null
endfunction
function IB6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer MKO=5
if hero==target then
set MKO=5
endif
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or NPI>MKO then
call UnitRemoveAbility(target,JFI[level])
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+20+10*level)
call U5I("Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl",target,"chest",1.9)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IC6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2J2')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call EO1(target)
call DU1(target,0,0)
call AddSkill(target,JFI[level])
call SetPlayerAbilityAvailable(GetOwningPlayer(target),JFI[level],false)
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Human\\InnerFire\\InnerFireTarget.mdl",target,"overhead")))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveInteger(LY,(handle_id),(34),(0))
call TriggerAddCondition(t,Condition(function IB6))
call TriggerRegisterTimerEvent(t,1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerEvaluate(t)
set hero=null
set target=null
set t=null
endfunction
function ID6 takes nothing returns boolean
if GetSpellAbilityId()=='A2J2' then
call IC6()
endif
return false
endfunction
function PG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ID6))
set JFI[1]='A2J9'
set JFI[2]='A2JA'
set JFI[3]='A2J8'
set JFI[4]='A2J7'
set t=null
endfunction
function IE6 takes unit hero,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),0)
call AddSkill(dummy,'A2JC')
call SetUnitAbilityLevel(dummy,'A2JC',level/3)
call IssueTargetOrder(dummy,"bloodlust",hero)
set dummy=null
endfunction
function IF6 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_SUMMONED)==true or IsUnitIllusion(GetEnumUnit())==true then
call Damage(GetTriggerUnit(),GetEnumUnit(),1,GetUnitState(GetEnumUnit(),UNIT_STATE_MAX_LIFE)*0.25)
endif
call Damage(GetTriggerUnit(),GetEnumUnit(),1,40*JZI+(12+2*JZI)*JGI+(5+15*JZI)*JHI)
endfunction
function IG6 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
set JHI=JHI+1
else
set JGI=JGI+1
endif
endfunction
function IH6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local integer level=GetUnitAbilityLevel(hero,'A2JB')
local group g=NTI()
call DestroyEffect(AddSpecialEffect("war3mapImported\\OverwhelmingOdds.mdx",x,y))
call GroupEnumUnitsInRange(g,x,y,330+25,Condition(function C51))
set JGI=0
set JHI=0
set JZI=level
call ForGroup(g,function IG6)
call ForGroup(g,function IF6)
call NSI(g)
call IE6(hero,9*JHI+3*JGI)
set hero=null
set g=null
endfunction
function IZ6 takes nothing returns boolean
if GetSpellAbilityId()=='A2JB' then
call IH6()
endif
return false
endfunction
function PZ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IZ6))
call Q1I('A2JC')
set t=null
endfunction
function IV6 takes nothing returns nothing
set JJI=true
call Damage(JVI,GetEnumUnit(),1,((200+400*JXI)/JWI)/22)
set JJI=false
endfunction
function IW6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g
if GetTriggerEvalCount(t)>22 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,x,y,170+25,Condition(function DO1))
set JXI=GetUnitAbilityLevel(hero,'A2BG')
if JXI==0 then
set JXI=GetUnitAbilityLevel(hero,'A2TU')
endif
set JVI=hero
set JWI=CountUnitsInGroup(g)
call ForGroup(g,function IV6)
call NSI(g)
set g=null
endif
set t=null
set hero=null
return false
endfunction
function IX6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local string s="war3mapImported\\DivineWrathTarget.mdx"
local location point=GetSpellTargetLoc()
call PlaySoundAtPointBJ(JYI,100,point,0)
call RemoveLocation(point)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function IW6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call DestroyEffect(AddSpecialEffect(s,x,y))
set t=null
set hero=null
endfunction
function IY6 takes nothing returns boolean
if GetSpellAbilityId()=='A2BG' or GetSpellAbilityId()=='A2TU' then
call IX6()
endif
return false
endfunction
function PX1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IY6))
set t=null
set JYI=CreateSound("Abilities\\Spells\\Demon\\RainOfFire\\RainOfFireTarget2.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(JYI,"StarfallTarget")
call SetSoundDuration(JYI,3000)
endfunction
function IJ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2BT')
local real d
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
set d=GetEventDamage()*(0.2+0.05*level)
else
call SaveInteger(LY,(GetHandleId((target))),((4317)),(2))
call UnitRemoveAbility(target,'A2I6')
call UnitRemoveAbility(target,'A2I5')
call UnitRemoveAbility(target,'A2I7')
call UnitRemoveAbility(target,'A2I8')
call UnitRemoveAbility(target,'B0FS')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IK6 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local integer level=GetUnitAbilityLevel(hero,'A2BT')
local unit LastTarget=(LoadUnitHandle(LY,(GetHandleId(hero)),(741)))
local integer NPI=(LoadInteger(LY,(GetHandleId(target)),(742)))
local integer id
if((LoadInteger(LY,(GetHandleId((target))),((4317))))==1)==true then
call SaveInteger(LY,(GetHandleId(target)),(742),(0))
call SaveReal(LY,(GetHandleId(target)),(743),(((TimerGetElapsed(M)))*1.0))
else
if(LoadReal(LY,(GetHandleId(target)),(743)))+10<(TimerGetElapsed(M))then
set NPI=1
else
set NPI=NPI+1
endif
if IsUnitType(target,UNIT_TYPE_HERO)==true or IsUnitIllusion(target)==true then
call UKI(GetOwningPlayer(hero),I2S(NPI)+"!",2,target,0.026,50,0,255,216)
endif
call SaveInteger(LY,(GetHandleId(target)),(742),(NPI))
call SaveReal(LY,(GetHandleId(target)),(743),(((TimerGetElapsed(M)))*1.0))
if NPI==4 then
call SaveInteger(LY,(GetHandleId(target)),(742),(0))
call SaveInteger(LY,(GetHandleId((target))),((4317)),(1))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.5+0.5*level,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function IJ6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
if level==1 then
set id='A2I6'
elseif level==2 then
set id='A2I5'
elseif level==3 then
set id='A2I7'
elseif level==4 then
set id='A2I8'
endif
call AddSkill(target,id)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),id,false)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\FarseerMissile_Purple_2.mdx",target,"chest"))
endif
endif
set t=null
endfunction
function IL6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call IK6(hero,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function IM6 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,1.2,false)
call TriggerAddCondition(t,Condition(function IL6))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set target=null
set hero=null
set t=null
endfunction
function IN6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetAttacker()==hero and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(hero))then
if((LoadInteger(LY,(GetHandleId((hero))),((4315))))==1)==false then
call SCI(hero,4315,0.3)
call IM6()
endif
endif
set t=null
set hero=null
return false
endfunction
function IS6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function IN6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function IT6 takes nothing returns boolean
if GetLearnedSkill()=='A2BT' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A2BT')==1 then
call IS6()
endif
return false
endfunction
function Register_Amp takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function IT6))
set t=null
endfunction
function IR6 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local integer level=GetUnitAbilityLevel(hero,'A2BE')
local real PAI=40+20*level+1.6*GetHeroInt(hero,true)
set JJI=true
call Damage(hero,target,1,PAI)
set JJI=false
set hero=null
set target=null
endfunction
function IP6 takes nothing returns nothing
local trigger t=IJ1(GetTriggerUnit(),GetSpellTargetUnit(),'h0DQ',"IR6",500,false)
local integer handle_id=GetHandleId(t)
set t=null
endfunction
function IQ6 takes nothing returns boolean
if GetSpellAbilityId()=='A2BE' and CanResistSkill(GetSpellTargetUnit())==false then
call IP6()
endif
return false
endfunction
function PY1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function IQ6))
set t=null
endfunction
function IU6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real d
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
else
call UnitRemoveAbility(target,'A2HX')
call UnitRemoveAbility(target,'A2I0')
call UnitRemoveAbility(target,'A2HY')
call UnitRemoveAbility(target,'A2HZ')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set target=null
set t=null
return false
endfunction
function O06 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2HN')
local real M5I=2+level
local integer id='A2HX'
if level==1 then
set id='A2HX'
elseif level==2 then
set id='A2I0'
elseif level==3 then
set id='A2HY'
elseif level==4 then
set id='A2HZ'
endif
call AddSkill(target,id)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),id,false)
call TriggerRegisterTimerEvent(t,M5I,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function IU6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set hero=null
set target=null
set t=null
endfunction
function OI6 takes nothing returns boolean
if GetSpellAbilityId()=='A2HN' and IsUnitType(GetSpellTargetUnit(),UNIT_TYPE_HERO)==true and CanResistSkill(GetSpellTargetUnit())==false then
call O06()
endif
return false
endfunction
function PJ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OI6))
set t=null
endfunction
function O16 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=GK
local unit target=HK
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local integer level=GetUnitAbilityLevel(hero,'A2IT')
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',x,y,0)
call UnitAddAbility(dummy,'A2IU')
call SetUnitAbilityLevel(dummy,'A2IU',level)
call IssueImmediateOrder(dummy,"thunderclap")
set hero=null
set target=null
set dummy=null
endfunction
function OO6 takes unit hero,group g returns unit
local unit O26=null
local real d=99999
local unit OF5=FirstOfGroup(g)
call GroupRemoveUnit(g,OF5)
loop
exitwhen OF5==null
if QLI(hero,OF5)<d then
set d=QLI(hero,OF5)
set O26=OF5
endif
set OF5=FirstOfGroup(g)
call GroupRemoveUnit(g,OF5)
endloop
return O26
endfunction
function O36 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=null
local group g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),1600+25,Condition(function D11))
set target=OO6(hero,g)
call NSI(g)
if target!=null then
call IJ1(hero,target,'h0E6',"O16",800,false)
endif
set g=null
set target=null
set hero=null
endfunction
function O46 takes nothing returns boolean
if GetSpellAbilityId()=='A2IT' then
call O36()
endif
return false
endfunction
function PW1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O46))
set t=null
endfunction
function O56 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer XT5=(LoadInteger(LY,(handle_id),(422)))
local integer XR5=(LoadInteger(LY,(handle_id),(423)))
local integer HJ4=(LoadInteger(LY,(handle_id),(424)))
call SetHeroAgi(target,GetHeroAgi(target,false)+XT5,true)
call SetHeroStr(target,GetHeroStr(target,false)+XR5,true)
call SetHeroInt(target,GetHeroInt(target,false)+HJ4,true)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set target=null
return false
endfunction
function O66 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local integer level=GetUnitAbilityLevel(hero,'A2FK')
local trigger t
local integer handle_id
local integer KBO
local integer XT5
local integer XR5
local integer HJ4
local real JC3
if IsUnitType(target,UNIT_TYPE_HERO)==true then
set KBO=SEI(target)
set JC3=0.15
if KBO==2 then
set XT5=R2I(JC3*GetHeroAgi(target,false))-1
set XR5=0
set HJ4=0
elseif KBO==3 then
set XT5=0
set XR5=R2I(JC3*GetHeroStr(target,false))-1
set HJ4=0
elseif KBO==1 then
set XT5=0
set XR5=0
set HJ4=R2I(JC3*GetHeroInt(target,false))-1
endif
call SetHeroAgi(target,GetHeroAgi(target,false)-XT5,true)
call SetHeroStr(target,GetHeroStr(target,false)-XR5,true)
call SetHeroInt(target,GetHeroInt(target,false)-HJ4,true)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,7,false)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function O56))
call SaveInteger(LY,(handle_id),(422),(XT5))
call SaveInteger(LY,(handle_id),(424),(HJ4))
call SaveInteger(LY,(handle_id),(423),(XR5))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
endif
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",target,"chest"))
call Damage(hero,target,JLI,50+50*level)
set hero=null
set target=null
endfunction
function O76 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),x,y)*bj_DEGTORAD
set x=GetUnitX(hero)
set y=GetUnitY(hero)
if UPI(x,y,JKI)>0 then
set JLI=3
else
set JLI=1
endif
call GroupEnumUnitsInRange(g,x,y,JKI+25,Condition(function C51))
call ForGroup(g,function O66)
call NSI(g)
call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\WhirlingDeath_01.mdx",hero,"origin"))
set hero=null
set g=null
endfunction
function O86 takes nothing returns boolean
if GetSpellAbilityId()=='A2FK' then
call O76()
endif
return false
endfunction
function PK1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function O86))
set t=null
endfunction
function O96 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A2E3')
call Damage(hero,target,3,60+40*level)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",target,"origin"))
endfunction
function OA6 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false then
call GroupAddUnit(XK,GetEnumUnit())
call O96(GK,GetEnumUnit())
endif
endfunction
function OB6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer CV3=(LoadInteger(LY,(handle_id),(18)))
local integer NPI=GetTriggerEvalCount(t)
local unit CW3
local group CX3=(LoadGroupHandle(LY,(handle_id),(16)))
local group g
local boolean UL1=(LoadBoolean(LY,(handle_id),(727)))
local boolean OC6=(LoadBoolean(LY,(handle_id),(740)))
if BG1(SFI)then
set OC6=true
call SaveBoolean(LY,(handle_id),(740),(OC6))
endif
if UL1==false then
set CW3=(LoadUnitHandle(LY,(handle_id),(700+CV3+1-NPI)))
call RemoveUnit(CW3)
else
set CW3=(LoadUnitHandle(LY,(handle_id),(700+NPI)))
if OC6==false then
call MUSetUnitX(SFI,GetUnitX(CW3))
call MUSetUnitY(SFI,GetUnitY(CW3))
endif
call RemoveUnit(CW3)
set g=NTI()
set GK=SFI
set XK=CX3
call GroupEnumUnitsInRange(g,GetUnitX(SFI),GetUnitY(SFI),250,Condition(function CD1))
call ForGroup(g,function OA6)
call NSI(g)
endif
if NPI==(CV3)then
call UPI(GetUnitX(SFI),GetUnitY(SFI),90)
call NSI(CX3)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set SFI=null
set CW3=null
set CX3=null
set g=null
return false
endfunction
function OD6 takes nothing returns nothing
if RJI(GetEnumDestructable())and IsDestructableDeadBJ(GetEnumDestructable())==false then
set JMI=JMI+1
endif
endfunction
function OE6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local integer MKO=(LoadInteger(LY,(handle_id),(12)))
local integer NPI=GetTriggerEvalCount(t)
local real x=(LoadReal(LY,(handle_id),(6)))+NPI*50*Cos(RM2*bj_DEGTORAD)
local real y=(LoadReal(LY,(handle_id),(7)))+NPI*50*Sin(RM2*bj_DEGTORAD)
local boolean CK3=(LoadBoolean(LY,(handle_id),(15)))
local unit CL3
local trigger CM3=(LoadTriggerHandle(LY,(handle_id),(11)))
local integer CN3=GetHandleId(CM3)
local integer ID='u01Q'
local real CY3=250
local rect r
local real d=90
set r=Rect(x-d,y-d,x+d,y+d)
set JMI=0
call EnumDestructablesInRect(r,Condition(function N1I),function OD6)
if JMI>0 or NPI==MKO or NPI==(MKO-1)or NPI==(MKO-2)then
set ID='u01P'
endif
set CL3=CreateUnit(GetOwningPlayer(SFI),ID,x,y,RM2)
call SaveUnitHandle(LY,(CN3),(700+NPI),(CL3))
if JMI>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call TriggerRegisterTimerEvent(CM3,0.5/MKO,true)
call TriggerAddCondition(CM3,Condition(function OB6))
call SaveInteger(LY,(CN3),(18),(NPI))
call SaveBoolean(LY,(CN3),(727),(true))
call SaveUnitHandle(LY,(CN3),(14),(SFI))
call SaveGroupHandle(LY,(CN3),(16),(NTI()))
call SaveReal(LY,(CN3),(6),((x)*1.0))
call SaveReal(LY,(CN3),(7),((y)*1.0))
call SaveBoolean(LY,(CN3),(740),(false))
elseif NPI>MKO then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call TriggerRegisterTimerEvent(CM3,0.5/MKO,true)
call TriggerAddCondition(CM3,Condition(function OB6))
call SaveInteger(LY,(CN3),(18),(NPI))
call SaveBoolean(LY,(CN3),(727),(false))
call SaveUnitHandle(LY,(CN3),(14),(SFI))
call SaveGroupHandle(LY,(CN3),(16),(NTI()))
call SaveBoolean(LY,(CN3),(740),(false))
endif
set t=null
set SFI=null
set CL3=null
set CM3=null
return false
endfunction
function OF6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real RM2=UEI(GetUnitX(SFI),GetUnitY(SFI),GetLocationX(point),GetLocationY(point))
local integer level=GetUnitAbilityLevel(SFI,'A2E3')
local integer CT3
local integer MKO
local trigger CR3=CreateTrigger()
set CT3=600+200*level
set MKO=CT3/50
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveInteger(LY,(handle_id),(12),(MKO))
call SaveTriggerHandle(LY,(handle_id),(11),(CR3))
call SaveReal(LY,(handle_id),(6),((GetUnitX(SFI))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(SFI))*1.0))
call TriggerRegisterTimerEvent(t,0.5/MKO,true)
call TriggerAddCondition(t,Condition(function OE6))
call RemoveLocation(point)
set t=null
set SFI=null
set point=null
endfunction
function OG6 takes nothing returns boolean
if GetSpellAbilityId()=='A2E3' then
call OF6()
endif
return false
endfunction
function PL1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OG6))
set t=null
endfunction
function OH6 takes unit hero returns nothing
local integer NPI=(LoadInteger(LY,(GetHandleId(hero)),(728)))
local integer level=GetUnitAbilityLevel(hero,'A2E4')
local integer i=1
set NPI=IMinBJ(NPI,4*level)
loop
exitwhen i>20
if NPI==i then
call AddSkill(hero,JNI[i])
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),JNI[i],false)
else
call UnitRemoveAbility(hero,JNI[i])
endif
set i=i+1
endloop
endfunction
function OZ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(GetHandleId(hero)),(728)))-1
call SaveInteger(LY,(GetHandleId(hero)),(728),(NPI))
call OH6(hero)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function OV6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local integer NPI=(LoadInteger(LY,(GetHandleId(hero)),(728)))+1
if IsUnitEnemy(GetAttacker(),GetOwningPlayer(hero))==true then
call SaveInteger(LY,(GetHandleId(hero)),(728),(NPI))
call OH6(hero)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,16,false)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function OZ6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
set t=null
set hero=null
return false
endfunction
function OW6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function OV6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function OX6 takes nothing returns boolean
if GetLearnedSkill()=='A2E4' and GetUnitAbilityLevel(GetTriggerUnit(),'A2E4')==1 and IsUnitIllusion(GetTriggerUnit())==false then
call OW6()
endif
return false
endfunction
function PM1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function OX6))
set t=null
set JNI[1]='A2DG'
set JNI[2]='A2DF'
set JNI[3]='A2DL'
set JNI[4]='A2DM'
set JNI[5]='A2DJ'
set JNI[6]='A2DI'
set JNI[7]='A2DN'
set JNI[8]='A2DO'
set JNI[9]='A2DH'
set JNI[10]='A2DU'
set JNI[11]='A2DP'
set JNI[12]='A2DQ'
set JNI[13]='A2DR'
set JNI[14]='A2DS'
set JNI[15]='A2DT'
set JNI[16]='A2DK'
set JNI[17]='A2OT'
set JNI[18]='A2OS'
set JNI[19]='A2OU'
set JNI[20]='A2OV'
endfunction
function OY6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'Bpig')
call UnitRemoveAbility(hero,'BEia')
call UnitRemoveAbility(hero,'A2FX')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function OJ6 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer Z43=R2I(100*GetUnitState(target,UNIT_STATE_LIFE)/GetUnitState(target,UNIT_STATE_MAX_LIFE))
local integer level=QAI(Q9I(R2I(100-Z43)/5,20),1)
call UnitAddAbility(dummy,'A2DV')
call SetUnitAbilityLevel(dummy,'A2DV',level)
call IssueTargetOrder(dummy,"slow",target)
set dummy=null
endfunction
function OK6 takes nothing returns nothing
if Q2==false and((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4349))))==1)==false then
call SCI(GetEnumUnit(),4348,0.49)
call Damage(JPI,GetEnumUnit(),3,(25+25*JQI)*0.5)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",GetEnumUnit(),"origin"))
call OJ6(JPI,GetEnumUnit())
endif
endfunction
function OL6 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),JRI)==false then
call GroupAddUnit(JRI,GetEnumUnit())
call Damage(JPI,GetEnumUnit(),3,60+40*JQI)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",GetEnumUnit(),"origin"))
call OJ6(JPI,GetEnumUnit())
endif
endfunction
function OM6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real x
local real y
local real a
local integer ON6=(LoadInteger(LY,(handle_id),(33)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real OS6
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2FX' then
call SaveInteger(LY,(handle_id),(33),(2))
call GroupClear(PR2)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2FX',false)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function OY6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
elseif GetTriggerEventId()==EVENT_WIDGET_DEATH or(LoadInteger(LY,(GetHandleId(hero)),(704)))==-1 then
call BP1(hero)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A2E5' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E5',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2FX',false)
call UnitRemoveAbility(hero,'A2FX')
call UnitRemoveAbility(hero,'Bpig')
call UnitRemoveAbility(hero,'BEia')
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif ON6==0 then
set a=UEI(GetUnitX(IG1),GetUnitY(IG1),QJI,QKI)*bj_DEGTORAD
set x=GetUnitX(IG1)+18*Cos(a)
set y=GetUnitY(IG1)+18*Sin(a)
call UPI(x,y,175)
if QNI(x,y,QJI,QKI)<40 then
set x=QJI
set y=QKI
endif
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
set GK=hero
set JPI=hero
set JQI=GetUnitAbilityLevel(hero,'A2E5')
set JRI=PR2
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,JSI+25,Condition(function CA1))
call ForGroup(g,function OL6)
call NSI(g)
if x==QJI and y==QKI then
call SaveInteger(LY,(handle_id),(33),(1))
call GroupClear(PR2)
endif
elseif ON6==1 then
set NPI=NPI+1
if NPI==25 then
set x=GetUnitX(IG1)
set y=GetUnitY(IG1)
call UPI(x,y,175)
set NPI=0
set GK=hero
set JPI=hero
set JQI=GetUnitAbilityLevel(hero,'A2E5')
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,JTI+25,Condition(function CA1))
call ForGroup(g,function OK6)
call NSI(g)
set OS6=(15+5*JQI)/2
if GetUnitState(hero,UNIT_STATE_MANA)<OS6 or QLI(hero,IG1)>2000 then
call SaveInteger(LY,(handle_id),(33),(2))
call GroupClear(PR2)
call UnitRemoveAbility(hero,'A2FX')
call UnitRemoveAbility(hero,'Bpig')
call UnitRemoveAbility(hero,'BEia')
else
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)-OS6)
endif
endif
call SaveInteger(LY,(handle_id),(34),(NPI))
elseif ON6==2 then
set a=UEI(GetUnitX(IG1),GetUnitY(IG1),GetUnitX(hero),GetUnitY(hero))*bj_DEGTORAD
set x=GetUnitX(IG1)+16*Cos(a)
set y=GetUnitY(IG1)+16*Sin(a)
call UPI(x,y,175)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
set GK=hero
set JPI=hero
set JQI=GetUnitAbilityLevel(hero,'A2E5')
set JRI=PR2
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,JSI+25,Condition(function CA1))
call ForGroup(g,function OL6)
call NSI(g)
if QNI(x,y,GetUnitX(hero),GetUnitY(hero))<40 then
call BP1(hero)
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A2E5' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E5',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2FX',false)
endif
endif
set t=null
set hero=null
set IG1=null
set PR2=null
set g=null
return false
endfunction
function OT6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),x,y)*bj_DEGTORAD
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0DS',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OM6))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveInteger(LY,(handle_id),(33),(0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call BT1(hero)
call AddSkill(hero,'A2FX')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E5',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2FX',true)
set hero=null
set t=null
set IG1=null
endfunction
function OR6 takes nothing returns boolean
if GetSpellAbilityId()=='A2E5' then
call OT6()
endif
return false
endfunction
function PN1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function OR6))
call Q1I('A2DV')
set t=null
endfunction
function OP6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call UnitRemoveAbility(hero,'Bpig')
call UnitRemoveAbility(hero,'BEia')
call UnitRemoveAbility(hero,'A2E6')
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function OQ6 takes unit hero,unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local integer Z43=R2I(100*GetUnitState(target,UNIT_STATE_LIFE)/GetUnitState(target,UNIT_STATE_MAX_LIFE))
local integer level=QAI(Q9I(R2I(100-Z43)/5,20),1)
call UnitAddAbility(dummy,'A2DV')
call SetUnitAbilityLevel(dummy,'A2DV',level)
call IssueTargetOrder(dummy,"slow",target)
set dummy=null
endfunction
function OU6 takes nothing returns nothing
if Q2==false and((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((4348))))==1)==false then
call SCI(GetEnumUnit(),4349,0.49)
call Damage(K1I,GetEnumUnit(),3,(25+25*KOI)*0.5)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",GetEnumUnit(),"origin"))
call OQ6(K1I,GetEnumUnit())
endif
endfunction
function A06 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),KII)==false then
call GroupAddUnit(KII,GetEnumUnit())
call Damage(K1I,GetEnumUnit(),3,60+40*KOI)
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",GetEnumUnit(),"origin"))
call OQ6(K1I,GetEnumUnit())
endif
endfunction
function AI6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real x
local real y
local real a
local integer ON6=(LoadInteger(LY,(handle_id),(33)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local real OS6
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2E6' then
call SaveInteger(LY,(handle_id),(33),(2))
call GroupClear(PR2)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E6',false)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function OP6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
endif
elseif GetTriggerEventId()==EVENT_WIDGET_DEATH or(LoadInteger(LY,(GetHandleId(hero)),(704)))==-1 then
call BP1(hero)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A2YO' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2YO',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E6',false)
call UnitRemoveAbility(hero,'A2E6')
call UnitRemoveAbility(hero,'Bpig')
call UnitRemoveAbility(hero,'BEia')
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif ON6==0 then
set a=UEI(GetUnitX(IG1),GetUnitY(IG1),QJI,QKI)*bj_DEGTORAD
set x=GetUnitX(IG1)+18*Cos(a)
set y=GetUnitY(IG1)+18*Sin(a)
call UPI(x,y,175)
if QNI(x,y,QJI,QKI)<40 then
set x=QJI
set y=QKI
endif
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
set GK=hero
set K1I=hero
set KOI=GetUnitAbilityLevel(hero,'A2YO')
set KII=PR2
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,JUI+25,Condition(function CA1))
call ForGroup(g,function A06)
call NSI(g)
if x==QJI and y==QKI then
call SaveInteger(LY,(handle_id),(33),(1))
call GroupClear(PR2)
endif
elseif ON6==1 then
set NPI=NPI+1
if NPI==25 then
set x=GetUnitX(IG1)
set y=GetUnitY(IG1)
call UPI(x,y,175)
set NPI=0
set GK=hero
set K1I=hero
set KOI=GetUnitAbilityLevel(hero,'A2YO')
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,K0I+25,Condition(function CA1))
call ForGroup(g,function OU6)
call NSI(g)
set OS6=(15+5*KOI)/2
if GetUnitState(hero,UNIT_STATE_MANA)<OS6 or QLI(hero,IG1)>2000 then
call SaveInteger(LY,(handle_id),(33),(2))
call GroupClear(PR2)
call UnitRemoveAbility(hero,'A2E6')
call UnitRemoveAbility(hero,'Bpig')
call UnitRemoveAbility(hero,'BEia')
else
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)-OS6)
endif
endif
call SaveInteger(LY,(handle_id),(34),(NPI))
elseif ON6==2 then
set a=UEI(GetUnitX(IG1),GetUnitY(IG1),GetUnitX(hero),GetUnitY(hero))*bj_DEGTORAD
set x=GetUnitX(IG1)+16*Cos(a)
set y=GetUnitY(IG1)+16*Sin(a)
call UPI(x,y,175)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
set GK=hero
set K1I=hero
set KOI=GetUnitAbilityLevel(hero,'A2YO')
set KII=PR2
set g=NTI()
call GroupEnumUnitsInRange(g,x,y,JUI+25,Condition(function CA1))
call ForGroup(g,function A06)
call NSI(g)
if QNI(x,y,GetUnitX(hero),GetUnitY(hero))<40 then
call BP1(hero)
call KillUnit(IG1)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if(LoadInteger(LY,(GetHandleId(hero)),(704)))==0 or(LoadInteger(LY,(GetHandleId(hero)),(704)))=='A2YO' then
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2YO',true)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E6',false)
endif
endif
set t=null
set hero=null
set IG1=null
set PR2=null
set g=null
return false
endfunction
function A16 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local real a=UEI(GetUnitX(hero),GetUnitY(hero),x,y)*bj_DEGTORAD
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0DS',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AI6))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveInteger(LY,(handle_id),(33),(0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call BT1(hero)
call AddSkill(hero,'A2E6')
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2YO',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(hero),'A2E6',true)
set hero=null
set t=null
set IG1=null
endfunction
function AO6 takes nothing returns boolean
if GetSpellAbilityId()=='A2YO' then
call A16()
endif
return false
endfunction
function PS1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AO6))
call Q1I('A2DV')
set t=null
endfunction
function A26 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetTriggerUnit()==hero and GetLearnedSkill()=='A2E5' then
call SetUnitAbilityLevel(hero,'A2YO',GetUnitAbilityLevel(hero,'A2E5'))
endif
set t=null
set hero=null
return false
endfunction
function XAO takes nothing returns nothing
local unit hero=GK
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call AddSkill(hero,'A2YO')
call SetUnitAbilityLevel(hero,'A2YO',GetUnitAbilityLevel(hero,'A2E5'))
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function A26))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function Trap_RemoveBonus takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if((LoadInteger(LY,(GetHandleId(hero)),(754)))==(LoadInteger(LY,(handle_id),(754))))then
call G21((hero),(0))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function A36 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
set K3I=K3I+60
else
set K3I=K3I+20
endif
call UnitRemoveAbility(GetEnumUnit(),'A2LE')
call UnitRemoveAbility(GetEnumUnit(),'B0G1')
endfunction
function A46 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
set K3I=K3I+60
else
set K3I=K3I+20
endif
endfunction
function A56 takes nothing returns nothing
call DD1(K4I,GetEnumUnit(),0.5+K5I*0.5)
call Damage(K4I,GetEnumUnit(),1,K3I)
endfunction
function A66 takes nothing returns boolean
return GetUnitAbilityLevel(GetFilterUnit(),'B0G1')>0
endfunction
function A76 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local group g=NTI()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
set K4I=hero
set K5I=GetUnitAbilityLevel(hero,'A2L9')
set K3I=0
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function A66))
call ForGroup(g,function A36)
call ForGroup(g,function A56)
call NSI(g)
set g=null
set hero=null
endfunction
function A86 takes nothing returns boolean
if GetSpellAbilityId()=='A2L9' then
call A76()
endif
return false
endfunction
function A96 takes string UWI,unit target,unit SFI returns nothing
local texttag tt=CreateTextTag()
call SetTextTagText(tt,UWI,0.033)
call SetTextTagPosUnit(tt,target,64)
call SetTextTagColor(tt,0,75,255,255)
call SetTextTagVelocity(tt,0,0.0355)
call SetTextTagFadepoint(tt,0.15)
call SetTextTagPermanent(tt,false)
call SetTextTagLifespan(tt,1.0)
if IsUnitAlly(SFI,GetLocalPlayer())or P0I(GetLocalPlayer())then
call SetTextTagVisibility(tt,true)
else
call SetTextTagVisibility(tt,false)
endif
set tt=null
endfunction
function AA6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real Z7O=(LoadReal(LY,(GetHandleId(target)),(753)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or Z7O<(TimerGetElapsed(M))then
call UnitRemoveAbility(target,'A2LE')
call UnitRemoveAbility(target,'B0G1')
call SaveReal(LY,(GetHandleId(target)),(753),((0)*1.0))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
return false
endfunction
function AB6 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local group g=NTI()
call SaveReal(LY,(GetHandleId(target)),(753),(((TimerGetElapsed(M))+K2I)*1.0))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.25,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function AA6))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call AddSkill(target,'A2LE')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2LE',false)
set K4I=hero
set K5I=GetUnitAbilityLevel(hero,'A2L9')
set K3I=0
call GroupEnumUnitsInRange(g,0,0,9999,Condition(function A66))
call ForGroup(g,function A46)
call NSI(g)
call A96(I2S(K3I),target,hero)
set t=null
endfunction
function AC6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
if GetEventDamageSource()==hero and GetEventDamage()>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if BJ1(target)==false then
call AB6(hero,target)
endif
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AD6 takes nothing returns nothing
local unit hero=GetAttacker()
local unit target=GetTriggerUnit()
local trigger t
local integer handle_id
if((LoadInteger(LY,(GetHandleId((hero))),((4325))))==1)==false then
call SCI(hero,4325,0.2)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function AC6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
endif
set hero=null
set target=null
endfunction
function AE6 takes nothing returns boolean
if GetUnitAbilityLevel(GetAttacker(),'A2L9')>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitTypeId(GetTriggerUnit())!='n00L' and IsUnitEnemy(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
call AD6()
endif
return false
endfunction
function PQ1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function A86))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function AE6))
set t=null
endfunction
function AF6 takes nothing returns nothing
local integer handle_id=GetHandleId(GetTriggeringTrigger())
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit AG6=GK
local unit target=HK
local integer level=GetUnitAbilityLevel(hero,'A2LA')
if RKI(target)==false then
call Damage(hero,target,1,20+80*level)
call AX1(target,'A2MK',1,4,'B0G4')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2MK',false)
call UnitMakeAbilityPermanent(target,true,'A2MJ')
endif
set hero=null
set target=null
set AG6=null
endfunction
function AH6 takes nothing returns nothing
local unit hero=K6I
local unit target=GetEnumUnit()
local trigger t=IJ1(K7I,target,'h0EE',"AF6",600,false)
local integer handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set hero=null
set target=null
set t=null
endfunction
function AZ6 takes unit hero,unit target returns nothing
local integer level=GetUnitAbilityLevel(hero,'A2LA')
local group g=NTI()
set GK=hero
set K6I=hero
set K7I=target
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),500+25,Condition(function CA1))
call GroupRemoveUnit(g,target)
call ForGroup(g,function AH6)
call NSI(g)
set hero=null
set target=null
set g=null
endfunction
function AV6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local real x=GetUnitX(IG1)
local real y=GetUnitY(IG1)
local real QJI=GetUnitX(target)
local real QKI=GetUnitY(target)
local real AW6=UTI(QJI,QKI,x,y)
local integer NPI=GetTriggerEvalCount(t)
local real IZ1=UEI(x,y,QJI,QKI)
local real IV1
local real IW1
local real IH1=AW6/((K8I/.02)-NPI)
if IH1<K9I*0.02 then
set IH1=K9I*0.02
endif
set IV1=x+IH1*Cos(IZ1*bj_DEGTORAD)
set IW1=y+IH1*Sin(IZ1*bj_DEGTORAD)
call MUSetUnitX(IG1,IV1)
call MUSetUnitY(IG1,IW1)
call SetUnitFacing(IG1,IZ1)
if UTI(QJI,QKI,IV1,IW1)<=IH1 then
call KillUnit(IG1)
call AZ6(hero,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
set IG1=null
return false
endfunction
function AX6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0EJ',GetUnitX(hero),GetUnitY(hero),0)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function AV6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
set hero=null
set target=null
set IG1=null
set t=null
endfunction
function AY6 takes nothing returns boolean
if GetSpellAbilityId()=='A2LA' and CanResistSkill(GetSpellTargetUnit())==false then
call AX6()
endif
return false
endfunction
function PP1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AY6))
set t=null
endfunction
function AJ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2LB')
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+0.1*(20+GetUnitState(target,UNIT_STATE_MAX_LIFE)*(0.02+0.01*level)))
if GetTriggerEvalCount(t)>39 or(GetTriggerEvalCount(t)==1 and IsUnitHidden(target))then
call UnitRemoveAbility(target,'A2LD')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(609))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(610))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(611))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(612))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(613))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(614))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(615))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(616))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(617))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AK6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t
local integer handle_id
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2LG')
if IssueTargetOrder(dummy,"thunderbolt",target)==true then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call AddSkill(target,'A2LD')
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function AJ6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(609),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"hand right")))
call SaveEffectHandle(LY,(handle_id),(610),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"hand left")))
call SaveEffectHandle(LY,(handle_id),(611),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"foot right")))
call SaveEffectHandle(LY,(handle_id),(612),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"foot left")))
call SaveEffectHandle(LY,(handle_id),(613),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"foot right mount rear")))
call SaveEffectHandle(LY,(handle_id),(614),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"foot left mount rear")))
call SaveEffectHandle(LY,(handle_id),(615),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"head")))
call SaveEffectHandle(LY,(handle_id),(616),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"chest")))
call SaveEffectHandle(LY,(handle_id),(617),(AddSpecialEffectTarget("war3mapImported\\Cryofreeze5.mdx",target,"weapon")))
endif
set hero=null
set target=null
set t=null
endfunction
function AL6 takes nothing returns boolean
if GetSpellAbilityId()=='A2LB' then
call AK6()
endif
return false
endfunction
function PT1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AL6))
set t=null
endfunction
function AM6 takes nothing returns nothing
local unit target=GetEnumUnit()
call DisableTrigger(KBI)
call UnitWakeUp(target)
call IssueTargetOrder(target,"attack",KCI)
call EnableTrigger(KBI)
set target=null
endfunction
function AN6 takes nothing returns nothing
call SCI(GetEnumUnit(),4328,0.75)
endfunction
function AS6 takes nothing returns nothing
local unit target=GetEnumUnit()
if IsUnitInGroup(target,KAI)==false then
call GroupAddUnit(KAI,target)
call TriggerRegisterUnitEvent(KBI,target,EVENT_UNIT_ISSUED_TARGET_ORDER)
call TriggerRegisterUnitEvent(KBI,target,EVENT_UNIT_ISSUED_POINT_ORDER)
call TriggerRegisterUnitEvent(KBI,target,EVENT_UNIT_ISSUED_TARGET_ORDER)
call SaveInteger(LY,(GetHandleId((target))),((4328)),(1))
endif
set target=null
endfunction
function AT6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(22)))
local group g
if GetTriggerEventId()!=EVENT_UNIT_ISSUED_TARGET_ORDER and GetTriggerEventId()!=EVENT_UNIT_ISSUED_POINT_ORDER and GetTriggerEventId()!=EVENT_UNIT_ISSUED_TARGET_ORDER then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
set KAI=PR2
set KBI=t
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),350+25,Condition(function CA1))
call GroupRemoveUnit(g,target)
call ForGroup(g,function AS6)
call NSI(g)
if NPI==(2.25+0.25*level)*20 or IsUnitDead(target)then
call ForGroup(PR2,function AN6)
call NSI(PR2)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set KBI=t
set KCI=target
call ForGroup(PR2,function AM6)
if ModuloInteger(NPI,20)==0 or NPI==0 then
endif
endif
else
if UnitIsSleeping(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'B008')==0 and GetIssuedOrderId()!=851973 and FSI==false then
call DisableTrigger(t)
call ClearSelectionForPlayer(GetOwningPlayer(GetTriggerUnit()))
call IssueTargetOrder(GetTriggerUnit(),"attack",target)
call EnableTrigger(t)
endif
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AR6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A0Z0')
local unit target=GetSpellTargetUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2NJ')
call SetUnitAbilityLevel(dummy,'A2NJ',level)
call IssueTargetOrder(dummy,"thunderbolt",target)
set KDI=hero
call TriggerRegisterTimerEvent(t,0.05,true)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\WintersCurse.mdx",target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffect("war3mapImported\\WintersCurseAoE.mdx",GetUnitX(target),GetUnitY(target))))
call TriggerAddCondition(t,Condition(function AT6))
set hero=null
set target=null
set t=null
endfunction
function AP6 takes nothing returns boolean
if GetSpellAbilityId()=='A0Z0' and CanResistSkill(GetSpellTargetUnit())==false then
call AR6()
endif
return false
endfunction
function PR1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function AP6))
set t=null
endfunction
function AQ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2N3')
call Damage(hero,target,3,(0.032+0.002*level)*GetUnitState(target,UNIT_STATE_MAX_LIFE))
if(TimerGetElapsed(M))>=(LoadReal(LY,(GetHandleId(hero)),(782)))then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function AU6 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)*0.8)
if(LoadReal(LY,(GetHandleId(hero)),(782)))>(TimerGetElapsed(M))then
call SaveReal(LY,(GetHandleId(hero)),(782),(((TimerGetElapsed(M))+KEI)*1.0))
else
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function AQ6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("effects\\BasicWaterFlash.mdx",target,"chest")))
call SaveReal(LY,(GetHandleId(hero)),(782),(((TimerGetElapsed(M))+KEI)*1.0))
endif
set t=null
endfunction
function B06 takes nothing returns boolean
local real d
local real Z7O
local integer NPI
local unit hero
local unit target
if GetUnitAbilityLevel(GetTriggerUnit(),'B0G7')>0 and GetUnitAbilityLevel(GetEventDamageSource(),'A2N3')>0 and(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
set hero=GetEventDamageSource()
set target=GetTriggerUnit()
set NPI=(LoadInteger(LY,(GetHandleId(hero)),(780)))
set Z7O=(LoadReal(LY,(GetHandleId(hero)),(781)))
if Z7O+KEI<(TimerGetElapsed(M))then
set NPI=1
set Z7O=(TimerGetElapsed(M))
call SaveInteger(LY,(GetHandleId(hero)),(780),(NPI))
call SaveReal(LY,(GetHandleId(hero)),(781),((Z7O)*1.0))
else
set NPI=NPI+1
set Z7O=(TimerGetElapsed(M))
call SaveInteger(LY,(GetHandleId(hero)),(780),(NPI))
call SaveReal(LY,(GetHandleId(hero)),(781),((Z7O)*1.0))
endif
if NPI==4 then
set NPI=0
call SaveInteger(LY,(GetHandleId(hero)),(780),(NPI))
call AU6(hero,target)
endif
call FlushChildHashtable(LY,(GetHandleId(GetTriggeringTrigger())))
call FlushTrigger(GetTriggeringTrigger())
endif
return false
endfunction
function BI6 takes nothing returns nothing
local trigger t
local unit target
local unit hero
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
set target=GetSpellTargetUnit()
set hero=GetTriggerUnit()
else
set target=GetTriggerUnit()
set hero=GetAttacker()
endif
if IsUnitIllusion(hero)==false then
set t=CreateTrigger()
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
call SaveBoolean(LY,(GetHandleId(t)),(264),(true))
else
call SaveBoolean(LY,(GetHandleId(t)),(264),(false))
endif
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function B06))
endif
set t=null
set target=null
set hero=null
endfunction
function B16 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetUnitAbilityLevel(GetAttacker(),'A2N3')>0 and(LoadBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(14)))then
call BI6()
endif
elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER then
if(GetIssuedOrderId()==OrderId("poisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(true))
elseif(GetIssuedOrderId()==OrderId("unpoisonarrows"))then
call SaveBoolean(LY,(GetHandleId(GetTriggeringTrigger())),(263),(false))
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A2N3' then
call BI6()
endif
return false
endfunction
function BO6 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_ISSUED_ORDER)
call TriggerAddCondition(t,Condition(function B16))
call SaveUnitHandle(LY,(GetHandleId(t)),(14),(GetTriggerUnit()))
set t=null
endfunction
function B26 takes nothing returns boolean
if GetLearnedSkill()=='A2N3' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A2N3')==1 then
call BO6()
endif
return false
endfunction
function PU1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function B26))
set t=null
endfunction
function B36 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call KillUnit(dummy)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
set dummy=null
return false
endif
if IsUnitDead(hero)==false then
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
else
if IsUnitAlly(dummy,BO[0])==true then
call MUSetUnitX(dummy,QS)
call MUSetUnitY(dummy,US)
else
call MUSetUnitX(dummy,O50)
call MUSetUnitY(dummy,O60)
endif
endif
set t=null
set hero=null
set dummy=null
return false
endfunction
function B46 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if IsUnitDead(target)==false then
call Damage(hero,target,7,GetUnitState(target,UNIT_STATE_LIFE)*0.06)
endif
if GetTriggerEvalCount(t)==5 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function B56 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local integer level
local integer B66
local integer B76
if((LoadInteger(LY,(GetHandleId((target))),((4329))))==1)==false and GetUnitTypeId(target)!='n00L' then
call SCI(target,4329,KFI)
set level=GetUnitAbilityLevel(hero,'A2NE')
if level==1 then
set B66='A2NB'
set B76='A2NA'
elseif level==2 then
set B66='A2N6'
set B76='A2N8'
elseif level==3 then
set B66='A2NC'
set B76='A2N7'
elseif level==4 then
set B66='A2ND'
set B76='A2N9'
endif
call AX1(target,B66,1,5,'B0GA')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),B66,false)
call UnitMakeAbilityPermanent(target,true,B76)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function B46))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\FrostDamage\\FrostDamage.mdl",target,"chest")))
endif
endfunction
function B86 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetEventDamageSource()==hero then
call DisableTrigger(t)
call B56(hero,target)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set target=null
set hero=null
return false
endfunction
function B96 takes nothing returns nothing
local trigger t=CreateTrigger()
local unit target=GetTriggerUnit()
local unit hero=GetAttacker()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function B86))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set target=null
set hero=null
endfunction
function BA6 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
if GetAttacker()==(LoadUnitHandle(LY,(GetHandleId(GetTriggeringTrigger())),(2)))and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false then
if GetUnitTypeId(GetAttacker())=='N0MB' or GetUnitTypeId(GetAttacker())=='N0MC' or GetUnitTypeId(GetAttacker())=='N0MO' or GetUnitTypeId(GetAttacker())=='N0MA' then
call B96()
endif
endif
else
call B36()
endif
return false
endfunction
function BB6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o01Y',GetUnitX(hero),GetUnitY(hero),0)
if IsUnitIllusion(hero)==false then
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
else
call TriggerRegisterDeathEvent(t,hero)
endif
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function BA6))
call SaveUnitHandle(LY,(GetHandleId(t)),(2),(hero))
call SaveUnitHandle(LY,(GetHandleId(t)),(19),(dummy))
set hero=null
set dummy=null
set t=null
endfunction
function BC6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
call SetTerrainPathable(x,y,PATHING_TYPE_WALKABILITY,false)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
return false
endfunction
function BD6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
call SetTerrainPathable(x,y,PATHING_TYPE_WALKABILITY,true)
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function BC6))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set hero=null
set t=null
endfunction
function BE6 takes nothing returns boolean
if GetTriggerEventId()==EVENT_PLAYER_HERO_SKILL then
if GetLearnedSkill()=='A2NE' and GetUnitAbilityLevel(GetTriggerUnit(),'A2NE')==1 then
call BB6()
endif
else
if GetSpellAbilityId()=='A2NE' then
if GetUnitTypeId(GetTriggerUnit())!='N0M7' then
call UPI(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),150)
if IsTerrainPathable(GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),PATHING_TYPE_WALKABILITY)then
call BD6()
endif
endif
endif
endif
return false
endfunction
function Q01 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BE6))
set t=null
endfunction
function BF6 takes nothing returns nothing
call DD1(KGI,GetEnumUnit(),1.5)
call Damage(KGI,GetEnumUnit(),2,50+50*KHI)
endfunction
function BG6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real QJI=(LoadReal(LY,(handle_id),(47)))
local real QKI=(LoadReal(LY,(handle_id),(48)))
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A2F4')
set x=PTI(x+32*Cos(a))
set y=PUI(y+32*Sin(a))
if QNI(x,y,QJI,QKI)<40 then
set x=QJI
set y=QKI
endif
call MUSetUnitX(hero,x)
call MUSetUnitY(hero,y)
call SetUnitFacing(hero,a*bj_RADTODEG)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,125+25,Condition(function CA1))
if FirstOfGroup(g)!=null or(x==QJI and y==QKI)or GetTriggerEvalCount(t)>200 or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call DestroyEffect(AddSpecialEffect("war3mapImported\\BlackDragonMissile.mdx",x,y))
call GroupEnumUnitsInRange(g,x,y,300+25,Condition(function CA1))
set KHI=level
set KGI=hero
if GetTriggerEventId()!=EVENT_WIDGET_DEATH then
call ForGroup(g,function BF6)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
call NSI(g)
set t=null
set hero=null
set g=null
return false
endfunction
function BH6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local real a=UEI(x,y,QJI,QKI)*bj_DEGTORAD
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterDeathEvent(t,hero)
call TriggerAddCondition(t,Condition(function BG6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(47),((QJI)*1.0))
call SaveReal(LY,(handle_id),(48),((QKI)*1.0))
set hero=null
set t=null
endfunction
function BZ6 takes nothing returns boolean
if GetSpellAbilityId()=='A2F4' then
call BH6()
endif
return false
endfunction
function Register_SonicBoom takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BZ6))
set t=null
endfunction
function BV6 takes nothing returns nothing
local unit hero=KZI
local unit target=GetEnumUnit()
call AH1(target,'A2F3',1,10)
call Damage(hero,target,2,50*KVI+2*GetHeroAgi(hero,true))
set hero=null
set target=null
endfunction
function BW6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real C54=QCI((TimerGetElapsed(M))-(LoadReal(LY,(GetHandleId(hero)),(358))),5.0)
local integer level=GetUnitAbilityLevel(hero,'A2EE')
local real PAI=(40+80*level)*(C54)
local group g=NTI()
local real d=C54*600
local real a=(LoadReal(LY,(GetHandleId(hero)),(736)))
local real x=GetUnitX(hero)+d*Cos(a)
local real y=GetUnitY(hero)+d*Sin(a)
set GK=hero
call GroupEnumUnitsInRange(g,x,y,325,Condition(function CA1))
set KVI=level
set KZI=hero
call ForGroup(g,function BV6)
call NSI(g)
call U7I("effects\\BasicWaterFlash.mdx",x,y,1)
set hero=null
set g=null
endfunction
function BX6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
call SetUnitTimeScale(SFI,1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerEventId()!=EVENT_UNIT_DEATH then
call PJI(SFI)
endif
set t=null
set SFI=null
return false
endfunction
function BY6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
local location point=GetSpellTargetLoc()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=UEI(GetUnitX(SFI),GetUnitY(SFI),x,y)*bj_DEGTORAD
local real Q4I=RMaxBJ(QNI(GetUnitX(SFI),GetUnitY(SFI),x,y)/600,0.32)
call RemoveLocation(point)
call SaveReal(LY,(GetHandleId(SFI)),(356),((x)*1.0))
call SaveReal(LY,(GetHandleId(SFI)),(357),((y)*1.0))
call SaveReal(LY,(GetHandleId(SFI)),(736),((a)*1.0))
call SaveReal(LY,(GetHandleId(SFI)),(358),(((TimerGetElapsed(M)))*1.0))
call SetUnitTimeScale(SFI,0.75)
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call TriggerRegisterTimerEvent(t,Q4I-0.01,false)
call TriggerRegisterUnitEvent(t,SFI,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function BX6))
set t=null
set SFI=null
endfunction
function BJ6 takes nothing returns boolean
if GetSpellAbilityId()=='A2EE' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(360),(false))
call BY6()
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(360),(true))
elseif(LoadBoolean(LY,(GetHandleId(GetTriggerUnit())),(360)))==true then
call BW6()
endif
endif
return false
endfunction
function Register_WindBlast takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_ENDCAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BJ6))
set t=null
endfunction
function BK6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
if GetUnitAbilityLevel(hero,'B086')==0 and GetUnitAbilityLevel(hero,'B087')==0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(hero,'A2F2')
call UnitRemoveAbility(hero,'B0F7')
endif
set t=null
set hero=null
return false
endfunction
function BL6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit target=GetSpellTargetUnit()
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2F2',false)
call AddSkill(target,'A2F2')
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerAddCondition(t,Condition(function BK6))
call SaveUnitHandle(LY,(handle_id),(2),(target))
set hero=null
set t=null
endfunction
function BM6 takes nothing returns boolean
if GetSpellAbilityId()=='A2F0' then
call BL6()
endif
return false
endfunction
function Register_WindBarrier takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BM6))
set t=null
endfunction
function BN6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2F5')
local integer id
local integer E11
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if IsUnitAlly(target,GetOwningPlayer(hero))==true then
set E11='B0F8'
if level==1 then
set id='A2FG'
elseif level==2 then
set id='A2FF'
elseif level==3 then
set id='A2FH'
endif
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+100+50*level)
else
set E11='B0F9'
if level==1 then
set id='A2FD'
elseif level==2 then
set id='A2FC'
elseif level==3 then
set id='A2FE'
endif
call Damage(hero,target,1,100+50*level)
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(target),id,false)
call AX1(target,id,1,4,E11)
set t=null
set hero=null
set target=null
return false
endfunction
function BS6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetEnumUnit()
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call EO1(target)
call DU1(target,0,0)
call UnitAddAbility(dummy,'A2FI')
call IssueTargetOrder(dummy,"cyclone",target)
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function BN6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
set hero=null
set target=null
set dummy=null
endfunction
function BT6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local group g=NTI()
call I41(GetOwningPlayer(hero),4,QJI,QKI,300)
call GroupEnumUnitsInRange(g,QJI,QKI,400+25,Condition(function CO1))
call ForGroup(g,function BS6)
call NSI(g)
set hero=null
set g=null
endfunction
function BR6 takes nothing returns boolean
if GetSpellAbilityId()=='A2F5' then
call BT6()
endif
return false
endfunction
function Register_PrevailingWinds takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function BR6))
set t=null
endfunction
function BP6 takes nothing returns nothing
call UOI("war3mapImported\\FortunesEndTarget.mdx",GetEnumUnit(),"origin",3)
call IssueTargetOrder(KXI,"purge",GetEnumUnit())
if KJI!=null and GetUnitAbilityLevel(GetEnumUnit(),'A2T4')>0 then
call TriggerEvaluate(KJI)
endif
call Damage(KWI,GetEnumUnit(),1,75*KYI)
endfunction
function BQ6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=(LoadUnitHandle(LY,(GetHandleId(hero)),(796)))
local real C54=QCI((TimerGetElapsed(M))-(LoadReal(LY,(GetHandleId(hero)),(358))),3)
local integer level=GetUnitAbilityLevel(hero,'A2QT')
local integer BU6=R2I(2.0*C54)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e00E',GetUnitX(hero),GetUnitY(hero),GetUnitFacing(hero))
local unit C06
local group g
if target!=null then
set C06=CreateUnit(GetOwningPlayer(hero),'o00Z',GetUnitX(target),GetUnitY(target),0)
call UnitApplyTimedLife(C06,'BTLF',0.5)
call UnitAddAbility(dummy,'A2T2')
call SetUnitAbilityLevel(dummy,'A2T2',BU6)
set GK=hero
set KWI=hero
set KXI=dummy
set KYI=level
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),215+25,Condition(function CA1))
call ForGroup(g,function BP6)
call NSI(g)
endif
set hero=null
set target=null
set dummy=null
set C06=null
set g=null
endfunction
function CI6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call SaveReal(LY,(GetHandleId(SFI)),(356),((GetUnitX(target))*1.0))
call SaveReal(LY,(GetHandleId(SFI)),(357),((GetUnitY(target))*1.0))
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set SFI=null
return false
endfunction
function C16 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=GetTriggerUnit()
call SaveReal(LY,(GetHandleId(SFI)),(358),(((TimerGetElapsed(M)))*1.0))
call SaveUnitHandle(LY,(GetHandleId(SFI)),(796),(GetSpellTargetUnit()))
call DestroyEffect(AddSpecialEffect("war3mapImported\\CleanseTargetArea.mdx",GetUnitX(GetSpellTargetUnit()),GetUnitY(GetSpellTargetUnit())))
call SaveUnitHandle(LY,(handle_id),(14),(SFI))
call SaveUnitHandle(LY,(handle_id),(17),(GetSpellTargetUnit()))
call TriggerRegisterTimerEvent(t,10,false)
call TriggerRegisterDeathEvent(t,GetSpellTargetUnit())
call TriggerAddCondition(t,Condition(function CI6))
set t=null
set SFI=null
endfunction
function CO6 takes nothing returns boolean
if GetSpellAbilityId()=='A2QT' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(360),(false))
call C16()
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if CanResistSkill(GetSpellTargetUnit())==false then
call SaveBoolean(LY,(GetHandleId(GetTriggerUnit())),(360),(true))
endif
elseif(LoadBoolean(LY,(GetHandleId(GetTriggerUnit())),(360)))==true then
call BQ6()
endif
endif
return false
endfunction
function QF1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_ENDCAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CO6))
set t=null
endfunction
function C26 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
call DisableTrigger(t)
call Damage(GetEventDamageSource(),target,3,0.5*GetEventDamage())
call EnableTrigger(t)
endif
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or IsUnitDead(target)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call BP1(target)
call UnitRemoveAbility(target,'A2T4')
set KJI=null
endif
set t=null
set target=null
return false
endfunction
function C36 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2T5')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
set KJI=t
call BT1(target)
call AddSkill(target,'A2T4')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2T4',false)
call TriggerRegisterTimerEvent(t,2+level,false)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function C26))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("war3mapImported\\FatesEdict.mdx",target,"origin")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl",target,"overhead")))
set hero=null
set target=null
set t=null
endfunction
function C46 takes nothing returns boolean
if GetSpellAbilityId()=='A2T5' then
if IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==false or CanResistSkill(GetSpellTargetUnit())==false then
call C36()
endif
endif
return false
endfunction
function QE1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function C46))
set t=null
endfunction
function C56 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2SG')
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
if GetTriggerEventId()==EVENT_WIDGET_DEATH or NPI>9 then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if GetSpellAbilityId()=='A2T2' and GetSpellTargetUnit()==target then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call SetUnitState(target,UNIT_STATE_LIFE,GetUnitState(target,UNIT_STATE_LIFE)+11*level)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function C66 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2SG')
local real PAI=level*90
local real IS5=0.75
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,1,true)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function C56))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\DarkMending.mdx",target,"origin")))
if IsUnitType(target,UNIT_TYPE_HERO)==false then
set IS5=1.0
endif
if GetUnitState(target,UNIT_STATE_LIFE)<=PAI*IS5 and IsUnitAlly(target,GetOwningPlayer(hero))==true then
set PAI=GetUnitState(target,UNIT_STATE_LIFE)/0.75-10
endif
call Damage(hero,target,1,PAI)
set t=null
set hero=null
set target=null
endfunction
function C76 takes nothing returns boolean
if GetSpellAbilityId()=='A2SG' then
if IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==false or CanResistSkill(GetSpellTargetUnit())==false then
call C66()
endif
endif
return false
endfunction
function QG1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function C76))
set t=null
endfunction
function C86 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local integer KO2=(LoadInteger(LY,(handle_id),(25)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local integer i=0
local real C96=(LoadReal(LY,(handle_id),(697)))
local real CA6=(LoadReal(LY,(handle_id),(811)))
local real KMO=GetUnitState(target,UNIT_STATE_LIFE)
local real CB6=GetUnitState(target,UNIT_STATE_MAX_LIFE)
local real CC6=(LoadReal(LY,(handle_id),(808)))
local real CD6
local real PAI
if KO2>(level+6)*50 or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call DisableTrigger(t)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call UnitRemoveAbility(target,'A2T0')
call UnitRemoveAbility(target,'A2SZ')
if GetTriggerEventId()!=EVENT_WIDGET_DEATH then
set CC6=CC6*2
loop
exitwhen i>NPI
set i=i+1
set KMO=GetUnitState(target,UNIT_STATE_LIFE)
set CD6=RMinBJ(CB6-KMO,CC6)
call SetUnitState(target,UNIT_STATE_LIFE,KMO+CD6)
set CC6=CC6-CD6
set PAI=(LoadReal(LY,(handle_id),(20000+i)))
if(LoadUnitHandle(LY,(handle_id),(22000+i)))==hero or((LoadInteger(LY,(GetHandleId((target))),((2485))))==1)then
if GetUnitState(target,UNIT_STATE_LIFE)<=PAI+2 then
set PAI=GetUnitState(target,UNIT_STATE_LIFE)-2
endif
endif
call Damage((LoadUnitHandle(LY,(handle_id),(22000+i))),target,6,PAI)
endloop
set KMO=GetUnitState(target,UNIT_STATE_LIFE)
set CD6=RMinBJ(CB6-KMO,CC6)
call SetUnitState(target,UNIT_STATE_LIFE,KMO+CD6)
set CC6=CC6-CD6
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
elseif GetTriggerEventId()==EVENT_UNIT_DAMAGED and RSI(GetEventDamage())then
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
call SaveUnitHandle(LY,(handle_id),(22000+NPI),(GetEventDamageSource()))
call SaveReal(LY,(handle_id),(20000+NPI),((GetEventDamage())*1.0))
call QGI(target,GetEventDamage())
elseif GetTriggerEventId()!=EVENT_UNIT_DAMAGED and GetTriggerEventId()!=EVENT_WIDGET_DEATH then
set KO2=KO2+1
call SaveInteger(LY,(handle_id),(25),(KO2))
if CB6!=CA6 then
set CA6=CB6
set C96=KMO
call SaveReal(LY,(handle_id),(697),((C96)*1.0))
call SaveReal(LY,(handle_id),(811),((CA6)*1.0))
endif
if KMO>C96 then
if((LoadInteger(LY,(GetHandleId((target))),((4298))))==1)==false then
set CC6=CC6+KMO-C96
call SaveReal(LY,(handle_id),(808),((CC6)*1.0))
else
call SetUnitState(target,UNIT_STATE_LIFE,KMO)
endif
endif
call SetUnitState(target,UNIT_STATE_LIFE,C96)
endif
set t=null
set target=null
set hero=null
return false
endfunction
function CE6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer level=GetUnitAbilityLevel(hero,'A2TF')
call UnitRemoveAbility(target,'B09Y')
call AddSkill(target,'A2T0')
call AddSkill(target,'A2SZ')
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function C86))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveInteger(LY,(handle_id),(25),(0))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveReal(LY,(handle_id),(808),((0)*1.0))
call SaveReal(LY,(handle_id),(697),((GetUnitState(target,UNIT_STATE_LIFE))*1.0))
call SaveReal(LY,(handle_id),(811),((GetUnitState(target,UNIT_STATE_MAX_LIFE))*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\FalsePromise.mdx",target,"chest")))
call EO1(target)
call DU1(target,0,0)
set hero=null
set target=null
set t=null
endfunction
function CF6 takes nothing returns boolean
if GetSpellAbilityId()=='A2TF' then
call CE6()
endif
return false
endfunction
function QH1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CF6))
set t=null
endfunction
function CG6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
local real x
local real y
local real a
if GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(IG1)
else
set a=UEI(GetUnitX(IG1),GetUnitY(IG1),GetUnitX(target),GetUnitY(target))
set x=GetUnitX(IG1)+20*Cos(a*bj_DEGTORAD)
set y=GetUnitY(IG1)+20*Sin(a*bj_DEGTORAD)
call MUSetUnitX(IG1,x)
call MUSetUnitY(IG1,y)
call SetUnitFacing(IG1,a)
if QLI(IG1,target)<30 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call Damage(IG1,target,1,100+50*level)
call KillUnit(IG1)
call SetUnitAnimationByIndex(IG1,3)
endif
endif
set t=null
set target=null
set IG1=null
return false
endfunction
function CH6 takes integer level,unit IG1,unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitAnimationByIndex(IG1,2)
call SetUnitVertexColor(IG1,255,255,255,150)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function CG6))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SetUnitAnimationByIndex(IG1,2)
set t=null
endfunction
function CZ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
local group g
local unit target
if GetTriggerEvalCount(t)>KKI/0.05 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(IG1)
else
set GK=IG1
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(IG1),GetUnitY(IG1),375+25,Condition(function CE1))
set target=AU1(g,GetUnitX(IG1),GetUnitY(IG1))
call NSI(g)
if target!=null then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call CH6(level,IG1,target)
endif
set g=null
set target=null
endif
set t=null
set IG1=null
return false
endfunction
function CV6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local integer level=(LoadInteger(LY,(handle_id),(5)))
local unit IG1=(LoadUnitHandle(LY,(handle_id),(45)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerAddCondition(t,Condition(function CZ6))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
call SetUnitAnimationByIndex(IG1,1)
set t=null
set IG1=null
return false
endfunction
function CW6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local unit IG1=CreateUnit(GetOwningPlayer(hero),'h0EG',x,y,270)
local integer level=GetUnitAbilityLevel(hero,'A2LL')
call SetUnitAnimationByIndex(IG1,0)
call TriggerRegisterTimerEvent(t,3,false)
call TriggerAddCondition(t,Condition(function CV6))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveUnitHandle(LY,(handle_id),(45),(IG1))
set hero=null
set IG1=null
set t=null
endfunction
function CX6 takes nothing returns boolean
if GetSpellAbilityId()=='A2LL' then
call CW6()
endif
return false
endfunction
function QI1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CX6))
set t=null
endfunction
function CY6 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2M9')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2M9')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2MA')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2MA')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2LN')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2LN')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2M8')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2M8')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2NP')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2NP')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2NS')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2NS')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2NR')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2NR')
endif
if GetUnitAbilityLevel(GetEnumUnit(),'A2NQ')>0 then
call UnitRemoveAbility(GetEnumUnit(),'A2NQ')
endif
endfunction
function CJ6 takes nothing returns nothing
if BJ1(GetEnumUnit())then
return
endif
if KLI==1 then
set KMI='A2M9'
elseif KLI==2 then
set KMI='A2MA'
elseif KLI==3 then
set KMI='A2LN'
elseif KLI==4 then
set KMI='A2M8'
endif
if GetUnitAbilityLevel(GetEnumUnit(),KMI)==0 then
call AddSkill(GetEnumUnit(),KMI)
call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),KMI,false)
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'ACes')
if KMI=='A2M9' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2M4')
elseif KMI=='A2MA' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2M5')
elseif KMI=='A2LN' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2M6')
elseif KMI=='A2M8' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2M7')
elseif KMI=='A2NP' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2NM')
elseif KMI=='A2NS' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2NL')
elseif KMI=='A2NR' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2NN')
elseif KMI=='A2NQ' then
call UnitMakeAbilityPermanent(GetEnumUnit(),true,'A2NO')
endif
endif
endfunction
function CK6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local real LVO=(LoadReal(LY,(handle_id),(442)))
local integer level=GetUnitAbilityLevel(hero,'A2LM')
local group RG3=(LoadGroupHandle(LY,(handle_id),(340)))
local group g=NTI()
local group g1=NTI()
local group g2=NTI()
set KLI=level
if(TimerGetElapsed(M))>LVO then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call ForGroup(RG3,function CY6)
call NSI(RG3)
call NSI(g)
call NSI(g1)
call NSI(g2)
return false
endif
set GK=hero
call GroupEnumUnitsInRange(g1,x,y,275+25,Condition(function CU1))
call GroupEnumUnitsInRange(g2,x,y,275+144,Condition(function CX1))
call GroupAddGroup(g1,g)
call GroupAddGroup(g2,g)
call NSI(g1)
call NSI(g2)
call GroupRemoveGroup(g,RG3)
call ForGroup(RG3,function CY6)
call ForGroup(g,function CJ6)
call SaveGroupHandle(LY,(handle_id),(340),(g))
call NSI(RG3)
set t=null
set hero=null
set RG3=null
set g=null
return false
endfunction
function CL6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real QJI=GetSpellTargetX()
local real QKI=GetSpellTargetY()
local integer i
local integer level=GetUnitAbilityLevel(hero,'A2LM')
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function CK6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(340),(NTI()))
call SaveReal(LY,(handle_id),(6),((QJI)*1.0))
call SaveReal(LY,(handle_id),(7),((QKI)*1.0))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+3+0.5*level)*1.0))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffect("war3mapImported\\MagneticField04.mdl",QJI,QKI)))
set i=0
loop
exitwhen i>5
call SetPlayerAbilityAvailable(BO[i],'A2M9',false)
call SetPlayerAbilityAvailable(CO[i],'A2M9',false)
call SetPlayerAbilityAvailable(BO[i],'A2MA',false)
call SetPlayerAbilityAvailable(CO[i],'A2MA',false)
call SetPlayerAbilityAvailable(BO[i],'A2MA',false)
call SetPlayerAbilityAvailable(CO[i],'A2LN',false)
call SetPlayerAbilityAvailable(BO[i],'A2M8',false)
call SetPlayerAbilityAvailable(CO[i],'A2M8',false)
set i=i+1
endloop
set hero=null
set t=null
endfunction
function CM6 takes nothing returns boolean
if GetSpellAbilityId()=='A2LM' then
call CL6()
endif
return false
endfunction
function Q11 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CM6))
set t=null
endfunction
function CN6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2M1')
local integer OO1=(LoadInteger(LY,(handle_id),(758)))
local integer NPI=(LoadInteger(LY,(handle_id),(34)))
local group g
if GetTriggerEventId()==EVENT_WIDGET_DEATH or NPI>120 or RKI(target)then
call UnitRemoveAbility(target,'A2LW')
call UnitRemoveAbility(target,'A2LY')
call UnitRemoveAbility(target,'B0G2')
call UnitRemoveAbility(target,'B0G3')
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set NPI=NPI+1
call SaveInteger(LY,(handle_id),(34),(NPI))
set GK=hero
set g=NTI()
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),225+25,Condition(function CA1))
call GroupRemoveUnit(g,target)
if FirstOfGroup(g)==null then
if OO1=='A2LW' then
if GetUnitAbilityLevel(target,'A2LW')==0 then
call AddSkill(target,'A2LW')
call UnitMakeAbilityPermanent(target,true,'A2LU')
call UnitMakeAbilityPermanent(target,true,'A2ME')
endif
else
if GetUnitAbilityLevel(target,'A2LY')==0 then
call AddSkill(target,'A2LY')
call UnitMakeAbilityPermanent(target,true,'A2LT')
call UnitMakeAbilityPermanent(target,true,'A2ME')
endif
endif
if ModuloInteger(NPI,10)==0 then
call Damage(hero,target,1,level*15*0.5)
endif
else
if OO1=='A2LW' then
if GetUnitAbilityLevel(target,'A2LW')>0 then
call UnitRemoveAbility(target,'A2LW')
call UnitRemoveAbility(target,'B0G2')
endif
else
if GetUnitAbilityLevel(target,'A2LY')>0 then
call UnitRemoveAbility(target,'A2LY')
call UnitRemoveAbility(target,'B0G3')
endif
endif
endif
call NSI(g)
set g=null
endif
set t=null
set hero=null
set target=null
return false
endfunction
function CS6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local integer OO1='A2LW'
if GetUnitTypeId(hero)=='N0MM' then
set OO1='A2LY'
endif
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2LW',false)
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2LY',false)
call TriggerRegisterTimerEvent(t,0.05,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function CN6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(758),(OO1))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\Flux3.mdx",target,"origin")))
call TriggerEvaluate(t)
set hero=null
set target=null
set t=null
endfunction
function CT6 takes nothing returns boolean
if GetSpellAbilityId()=='A2M1' and CanResistSkill(GetSpellTargetUnit())==false then
call CS6()
endif
return false
endfunction
function QO1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function CT6))
set t=null
endfunction
function CR6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit CP6=(LoadUnitHandle(LY,(handle_id),(17)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call FlushChildHashtable(LY,(GetHandleId(CP6)))
call RemoveUnit(CP6)
set t=null
set CP6=null
return false
endfunction
function CQ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit CP6=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call FlushChildHashtable(LY,(GetHandleId(CP6)))
call ShowUnit(CP6,false)
set t=null
set CP6=null
return false
endfunction
function CU6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit CP6=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2M0')
if GetTriggerEvalCount(t)==200 or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(CP6)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Orc\\FeralSpirit\\feralspirittarget.mdl",GetUnitX(CP6),GetUnitX(CP6)))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(CP6))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function CQ6))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,3,false)
call TriggerAddCondition(t,Condition(function CR6))
call SaveUnitHandle(LY,(handle_id),(17),(CP6))
else
call SuspendHeroXP(CP6,true)
call UnitModifySkillPoints(CP6,-25)
endif
set t=null
set hero=null
set CP6=null
return false
endfunction
function D06 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit CP6=CreateUnit(GetOwningPlayer(hero),'N0MM',GetUnitX(hero),GetUnitY(hero),0)
local integer level=GetUnitAbilityLevel(hero,'A2M0')
local integer i=0
local item BA1
local integer DI6='I02M'
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\FeralSpirit\\feralspirittarget.mdl",CP6,"chest"))
if IsPlayerTeam1(GetOwningPlayer(CP6))==false then
set DI6='I0PC'
endif
call SelectUnitAddForPlayer(CP6,GetOwningPlayer(hero))
call MUDisableItemTrigger()
loop
exitwhen i>5
if UnitItemInSlot(hero,i)!=null and GetItemTypeId(UnitItemInSlot(hero,i))!=FR0[VL0]and GetItemTypeId(UnitItemInSlot(hero,i))!=FR0[WH0]and GetItemTypeId(UnitItemInSlot(hero,i))!=FR0[ZA0]and GetItemTypeId(UnitItemInSlot(hero,i))!=FR0[ZB0]and GetItemTypeId(UnitItemInSlot(hero,i))!=FR0[ZZ0]then
set BA1=CreateItem(GetItemTypeId(UnitItemInSlot(hero,i)),0,0)
if GetItemCharges(UnitItemInSlot(hero,i))>0 then
call SetItemCharges(BA1,GetItemCharges(UnitItemInSlot(hero,i)))
endif
call UnitAddItem(CP6,BA1)
call SetItemPlayer(BA1,GetOwningPlayer(CP6),false)
if GetItemTypeId(BA1)==FR0[W30]or GetItemTypeId(BA1)==FR0[W40]or GetItemTypeId(BA1)==FR0[GZ0]then
call SetItemDropOnDeath(BA1,false)
endif
else
call UnitAddItem(CP6,CreateItem(DI6,0,0))
endif
set i=i+1
endloop
call MUEnableItemTrigger()
call SetHeroLevel(CP6,GetHeroLevel(hero),false)
set i=1
loop
exitwhen i>GetUnitAbilityLevel(hero,'Aamk')
call SelectHeroSkill(CP6,'Aamk')
set i=i+1
endloop
set i=1
loop
exitwhen i>GetUnitAbilityLevel(hero,'A2LL')
call SelectHeroSkill(CP6,'A2LL')
set i=i+1
endloop
set i=1
loop
exitwhen i>GetUnitAbilityLevel(hero,'A2LM')
call SelectHeroSkill(CP6,'A2LM')
set i=i+1
endloop
set i=1
loop
exitwhen i>GetUnitAbilityLevel(hero,'A2M1')
call SelectHeroSkill(CP6,'A2M1')
set i=i+1
endloop
set i=1
loop
exitwhen i>GetUnitAbilityLevel(hero,'A2B4')
call SelectHeroSkill(CP6,'A2B4')
set i=i+1
endloop
set i=1
loop
exitwhen i>GetUnitAbilityLevel(hero,'A2M0')
call SelectHeroSkill(CP6,'A2M0')
set i=i+1
endloop
call UnitRemoveAbility(CP6,'A2M0')
call UnitModifySkillPoints(CP6,-25)
call SuspendHeroXP(CP6,true)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterDeathEvent(t,CP6)
call TriggerAddCondition(t,Condition(function CU6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(CP6))
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)*(1-(0.45-0.15*level)))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)*(1-(0.45-0.15*level)))
call SetUnitState(CP6,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE))
call SetUnitState(CP6,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA))
set hero=null
set CP6=null
set t=null
endfunction
function D16 takes nothing returns boolean
if GetSpellAbilityId()=='A2M0' then
call D06()
endif
return false
endfunction
function Q21 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function D16))
set t=null
endfunction
function DO6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g=NTI()
local integer level=GetUnitAbilityLevel(hero,'A0VC')
set GK=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),400+25,Condition(function DO1))
if FirstOfGroup(g)==null then
if GetUnitAbilityLevel(hero,'A2NX')!=level then
call AddSkill(hero,'A2NX')
call SetUnitAbilityLevel(hero,'A2NX',level)
endif
else
if GetUnitAbilityLevel(hero,'A2NX')>0 then
call UnitRemoveAbility(hero,'A2NX')
endif
endif
call NSI(g)
set hero=null
set t=null
set g=null
return false
endfunction
function D26 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function DO6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function D36 takes nothing returns boolean
if GetLearnedSkill()=='A0VC' and GetUnitAbilityLevel(GetTriggerUnit(),'A0VC')==1 then
call D26()
endif
return false
endfunction
function Q61 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function D36))
set t=null
endfunction
function D46 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local integer level=GetUnitAbilityLevel(hero,'A2O2')
local integer JJ3=GetHeroAgi(hero,true)
local real D56=JJ3*(0.12+0.06*level)
local integer O93=R2I(D56/2.0+0.5)
local integer D66=(LoadInteger(LY,(handle_id),(34)))
local real LVO=(LoadReal(LY,(handle_id),(442)))
if LVO<(TimerGetElapsed(M))then
set D66=2
call SaveInteger(LY,(handle_id),(34),(D66))
call UnitRemoveAbility(dummy,'A2O3')
endif
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()=='A2O2' then
set D66=1
call SaveInteger(LY,(handle_id),(34),(D66))
call SaveReal(LY,(handle_id),(442),(((TimerGetElapsed(M))+30)*1.0))
call UnitRemoveAbility(dummy,'A2NY')
call UnitRemoveAbility(dummy,'A2O3')
endif
if IsUnitDead(hero)==true then
call UnitRemoveAbility(dummy,'A2NY')
call UnitRemoveAbility(dummy,'A2O3')
else
if GetUnitAbilityLevel(dummy,'A2NY')==0 then
call AddSkill(dummy,'A2NY')
if D66==1 then
call AddSkill(dummy,'A2O3')
else
endif
endif
call SetUnitAbilityLevel(dummy,'A2NY',O93)
call SetUnitAbilityLevel(dummy,'A2O3',O93)
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
endif
set hero=null
set t=null
return false
endfunction
function D76 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit dummy=CreateUnit(GetOwningPlayer(hero),'e01V',0,0,0)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function D46))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveInteger(LY,(handle_id),(34),(2))
call AddSkill(dummy,'A2NY')
set t=null
set hero=null
endfunction
function D86 takes nothing returns boolean
if GetLearnedSkill()=='A2O2' and IsUnitIllusion(GetTriggerUnit())==false and GetUnitAbilityLevel(GetTriggerUnit(),'A2O2')==1 then
call D76()
endif
return false
endfunction
function Q41 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_SKILL)
call TriggerAddCondition(t,Condition(function D86))
call Q1I('A2NY')
call Q1I('A2O3')
set t=null
endfunction
function D96 takes unit hero,unit target,integer level returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call AddSkill(dummy,'A2WG')
call SetUnitAbilityLevel(dummy,'A2WG',level)
call IssueTargetOrder(dummy,"drunkenhaze",target)
set dummy=null
endfunction
function DA6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real RM2=(LoadReal(LY,(handle_id),(13)))
local real d=(LoadReal(LY,(handle_id),(138)))
local integer level=GetUnitAbilityLevel(hero,'A2WF')
local real DC1=(0.5+0.1*level)/(0.02)
local real RS2=d/DC1
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local integer NPI=GetTriggerEvalCount(t)
if NPI>DC1 or GetTriggerEventId()==EVENT_UNIT_DEATH then
call UPI(GetUnitX(target),GetUnitY(target),100)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
set x=PTI(x+RS2*Cos(RM2))
set y=PUI(y+RS2*Sin(RM2))
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function DB6 takes unit dummy,unit target,unit hero,real x,real y returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real RM2=Atan2(GetUnitY(target)-GetUnitY(dummy),GetUnitX(target)-GetUnitX(dummy))
local real IT3=QNI(x,y,GetUnitX(target),GetUnitY(target))
local real d=RMaxBJ(1,350*(1-IT3/900))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(13),((RM2)*1.0))
call SaveReal(LY,(handle_id),(138),((d)*1.0))
call SaveReal(LY,(handle_id),(6),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(target))*1.0))
call D96(hero,target,GetUnitAbilityLevel(hero,'A2WF'))
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function DA6))
set t=null
endfunction
function DC6 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),XK)==false and RKI(GetEnumUnit())==false then
call GroupAddUnit(XK,GetEnumUnit())
call DB6(GK,GetEnumUnit(),KNI,KSI,KTI)
endif
endfunction
function DD6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real a=(LoadReal(LY,(handle_id),(137)))
local real x1=(LoadReal(LY,(handle_id),(64)))
local real y1=(LoadReal(LY,(handle_id),(65)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y2=(LoadReal(LY,(handle_id),(67)))
local group g=(LoadGroupHandle(LY,(handle_id),(22)))
local real x=GetUnitX(dummy)
local real y=GetUnitY(dummy)
local group g2
if QNI(x,y,x2,y2)<100 then
set x=x2
set y=y2
else
set x=x+40*Cos(a)
set y=y+40*Sin(a)
endif
call MUSetUnitX(dummy,PTI(x))
call MUSetUnitY(dummy,PUI(y))
set g2=NTI()
set GK=dummy
set KNI=hero
set KSI=x1
set KTI=y1
set XK=g
call GroupEnumUnitsInRange(g2,x,y,250+25,Condition(function CA1))
call ForGroup(g2,function DC6)
call NSI(g2)
if(x==x2 and y==y2)or GetTriggerEvalCount(t)>35 then
set g2=NTI()
set GK=dummy
set KNI=hero
set KSI=x1
set KTI=y1
set XK=g
call GroupEnumUnitsInRange(g2,x,y,250+25,Condition(function CA1))
call ForGroup(g2,function DC6)
call NSI(g2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
call NSI(g)
endif
set t=null
set dummy=null
set g=null
set g2=null
return false
endfunction
function DE6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local location point=GetSpellTargetLoc()
local unit hero=GetTriggerUnit()
local real x=GetLocationX(point)
local real y=GetLocationY(point)
local real a=Atan2(y-GetUnitY(hero),x-GetUnitX(hero))
local unit dummy=CreateUnit(GetOwningPlayer(hero),'n0NI',GetUnitX(hero),GetUnitY(hero),a*bj_RADTODEG)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function DD6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveReal(LY,(handle_id),(64),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(65),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(66),((GetUnitX(hero)+900*Cos(a))*1.0))
call SaveReal(LY,(handle_id),(67),((GetUnitY(hero)+900*Sin(a))*1.0))
call SaveGroupHandle(LY,(handle_id),(22),(NTI()))
call RemoveLocation(point)
set t=null
set point=null
set hero=null
endfunction
function DF6 takes nothing returns boolean
if GetSpellAbilityId()=='A2WF' then
call DE6()
endif
return false
endfunction
function Q51 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function DF6))
set t=null
endfunction
function BoulderSmash_FindClosestMagnetizedTarget takes nothing returns nothing
local real d=QLI(GetEnumUnit(),LWI)
if d<AK then
set AK=d
set LFI=GetEnumUnit()
endif
endfunction
function DG6 takes nothing returns boolean
return IsUnitDead(GetFilterUnit())==false and IsUnitEnemy(KQI,GetOwningPlayer(GetFilterUnit()))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((809))))==1)
endfunction
function DH6 takes unit target returns nothing
local unit dummy=CreateUnit(GetOwningPlayer(target),'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2TG')
call SetUnitAbilityLevel(dummy,'A2TG',KUI)
call IssueTargetOrder(dummy,"soulburn",target)
set dummy=null
endfunction
function DZ6 takes nothing returns nothing
call DH6(GetEnumUnit())
endfunction
function DV6 takes unit target returns nothing
local group g=NTI()
if((LoadInteger(LY,(GetHandleId((target))),((809))))==1)==true then
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function DG6))
endif
call GroupAddUnit(g,target)
call ForGroup(g,function DZ6)
call NSI(g)
set g=null
endfunction
function DW6 takes nothing returns nothing
local unit target=GetEnumUnit()
if GetUnitTypeId(target)!='o01X' then
call SetUnitPathing(target,true)
endif
call SaveInteger(LY,(GetHandleId((target))),((4336)),(2))
set target=null
endfunction
function DX6 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),KPI)==false then
call GroupAddUnit(KPI,GetEnumUnit())
call DV6(GetEnumUnit())
if L1I==1 then
call Damage(KQI,GetEnumUnit(),1,75*KUI-25)
endif
endif
endfunction
function DY6 takes nothing returns nothing
local unit target=GetEnumUnit()
local real a=(LoadReal(LY,(GetHandleId(target)),(801)))
local real d=(LoadReal(LY,(GetHandleId(target)),(802)))
local real x=L0I+d*Cos(a)
local real y=LII+d*Sin(a)
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",x,y))
if GetUnitTypeId(target)=='o01X' or GetUnitTypeId(target)=='o020' then
set L1I=1
call SetUnitPosition(target,x,y)
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
else
call MUSetUnitX(target,x)
call MUSetUnitY(target,y)
call UPI(x,y,100)
endif
set target=null
endfunction
function DJ6 takes nothing returns nothing
local unit target=GetEnumUnit()
if IsUnitDead(target)==true or((LoadInteger(LY,(GetHandleId((target))),((4306))))==1)==true or GetUnitAbilityLevel(target,'B08V')>0 or((LoadInteger(LY,(GetHandleId((target))),((4335))))==1)==true then
call GroupRemoveUnit(KPI,target)
call SaveInteger(LY,(GetHandleId((target))),((4336)),(2))
if GetUnitTypeId(target)!='o01X' then
call SetUnitPathing(target,true)
endif
endif
set target=null
endfunction
function DK6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group DL6=(LoadGroupHandle(LY,(handle_id),(803)))
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real a=bj_DEGTORAD*UEI(II3,I13,QJI,QKI)
local real x
local real y
local boolean DM6=false
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
set L1I=0
set KPI=DL6
call ForGroup(DL6,function DJ6)
if GetTriggerEvalCount(t)>200 or FirstOfGroup(DL6)==null then
set DM6=true
else
set x=II3+KRI*0.03*Cos(a)
set y=I13+KRI*0.03*Sin(a)
if QNI(x,y,QJI,QKI)<30 then
set x=QJI
set y=QKI
set DM6=true
endif
set x=PTI(x)
set y=PUI(y)
set KPI=DL6
set L0I=x
set LII=y
call ForGroup(DL6,function DY6)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
set g=NTI()
set GK=hero
set KPI=PR2
set KQI=hero
set KUI=GetUnitAbilityLevel(hero,'A2QI')
call GroupEnumUnitsInRange(g,x,y,180+25,Condition(function CA1))
call ForGroup(g,function DX6)
call NSI(g)
set g=null
endif
if DM6 then
call ForGroup(DL6,function DW6)
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call NSI(PR2)
call NSI(DL6)
endif
set hero=null
set t=null
set PR2=null
set DL6=null
return false
endfunction
function MagneticGrip_PullableTargetsFilter takes nothing returns boolean
return((GetUnitTypeId(GetFilterUnit())=='o01X' or GetUnitTypeId(GetFilterUnit())=='o020')or(IsUnitEnemy(KQI,GetOwningPlayer(GetFilterUnit()))==false and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0))and IsUnitDead(GetFilterUnit())==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4336))))==1)==false
endfunction
function DN6 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='o01X'
endfunction
function DS6 takes nothing returns nothing
local unit target=GetEnumUnit()
call SetUnitPathing(target,false)
call SaveInteger(LY,(GetHandleId((target))),((4336)),(1))
call SaveReal(LY,(GetHandleId(target)),(801),((bj_DEGTORAD*UEI(L0I,LII,GetUnitX(target),GetUnitY(target)))*1.0))
call SaveReal(LY,(GetHandleId(target)),(802),((QNI(L0I,LII,GetUnitX(target),GetUnitY(target)))*1.0))
set target=null
endfunction
function DT6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t
local integer handle_id
local real QJI=GetUnitX(GetSpellTargetUnit())
local real QKI=GetUnitY(GetSpellTargetUnit())
local real x=GetUnitX(hero)
local real y=GetUnitY(hero)
local real a=UEI(x,y,QJI,QKI)
local unit target=GetSpellTargetUnit()
local group g
if target==null then
set g=NTI()
call GroupEnumUnitsInRange(g,GetSpellTargetX(),GetSpellTargetY(),240+25,Condition(function DN6))
if FirstOfGroup(g)==null then
call NSI(g)
set hero=null
set g=null
return
endif
set target=FirstOfGroup(g)
call NSI(g)
endif
set g=NTI()
call GroupAddUnit(g,target)
set QJI=GetUnitX(target)
set QKI=GetUnitY(target)
set a=UEI(x,y,QJI,QKI)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
set L0I=QJI
set LII=QKI
call ForGroup(g,function DS6)
set x=x+100*Cos(a*bj_DEGTORAD)
set y=y+100*Sin(a*bj_DEGTORAD)
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerAddCondition(t,Condition(function DK6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(23),((QJI)*1.0))
call SaveReal(LY,(handle_id),(24),((QKI)*1.0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveGroupHandle(LY,(handle_id),(803),(g))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\MagneticGripTarget.mdx",target,"chest")))
set hero=null
set t=null
set g=null
endfunction
function DR6 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local group g
if target==null then
set g=NTI()
call GroupEnumUnitsInRange(g,GetSpellTargetX(),GetSpellTargetY(),240+25,Condition(function DN6))
if FirstOfGroup(g)==null then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"附近没有巨石")
endif
call NSI(g)
endif
set g=null
set target=null
endfunction
function DP6 takes nothing returns boolean
if GetSpellAbilityId()=='A2QI' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
call DR6()
else
call DT6()
endif
endif
return false
endfunction
function Q91 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function DP6))
set t=null
endfunction
function DQ6 takes integer i returns boolean
return L7I[0]==i or L7I[1]==i or L7I[2]==i or L7I[3]==i or L7I[4]==i or L7I[5]==i or L7I[6]==i
endfunction
function DU6 takes nothing returns boolean
return IsUnitDead(GetFilterUnit())==false and IsUnitEnemy(L3I,GetOwningPlayer(GetFilterUnit()))and GetUnitAbilityLevel(GetFilterUnit(),'A04R')==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((809))))==1)
endfunction
function E06 takes nothing returns nothing
call AX1((GetEnumUnit()),'A2QN',1,2,'B0GK')
endfunction
function EI6 takes unit target returns nothing
local group g=NTI()
if((LoadInteger(LY,(GetHandleId((target))),((809))))==1)==true then
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function DU6))
endif
call GroupAddUnit(g,target)
call ForGroup(g,function E06)
call NSI(g)
set g=null
endfunction
function RollingBoulder_FindClosestMagnetizedTarget takes nothing returns nothing
local real d=QLI(GetEnumUnit(),LBI)
if d<AK then
set AK=d
set L4I=GetEnumUnit()
endif
endfunction
function E16 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),L5I)==false then
call GroupAddUnit(L5I,GetEnumUnit())
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true then
set L8I=true
set L4I=GetEnumUnit()
if((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((809))))==1)then
set LBI=GetEnumUnit()
endif
if LAI==1 then
call Damage(L3I,GetEnumUnit(),1,L9I)
call EI6(GetEnumUnit())
else
call Damage(L3I,GetEnumUnit(),1,L9I)
endif
else
if LAI==1 then
call Damage(L3I,GetEnumUnit(),1,L9I)
else
call Damage(L3I,GetEnumUnit(),1,L9I)
endif
endif
endif
endfunction
function EO6 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='o01X' or GetUnitTypeId(GetFilterUnit())=='o020'
endfunction
function E26 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local real H71=(LoadReal(LY,(handle_id),(6)))
local real H81=(LoadReal(LY,(handle_id),(7)))
local real IO3=GetUnitX(hero)
local real I23=GetUnitY(hero)
local real d=QNI(H71,H81,IO3,I23)
local real x
local real y
local real a=(LoadReal(LY,(handle_id),(137)))
local real r=L2I
local integer E36=(LoadInteger(LY,(handle_id),(34)))
local real E63=(LoadReal(LY,(handle_id),(138)))
local boolean E46=false
local unit E56=(LoadUnitHandle(LY,(handle_id),(810)))
set L8I=false
call SetUnitTimeScale(hero,3)
call SetUnitFacing(hero,a)
call SetUnitAnimationByIndex(hero,0)
if GetTriggerEvalCount(t)>30 then
if E36==0 then
set g=NTI()
call GroupEnumUnitsInRange(g,IO3,I23,150+25,Condition(function EO6))
if FirstOfGroup(g)!=null then
if(GetUnitTypeId((FirstOfGroup(g)))=='o020')==false then
call KillUnit(FirstOfGroup(g))
endif
set E36=1
call SaveInteger(LY,(handle_id),(34),(E36))
endif
call NSI(g)
endif
if E36==1 then
set r=r*2
endif
if E56!=null then
set a=UDI(hero,E56)
call SaveReal(LY,(handle_id),(137),((a)*1.0))
endif
set x=H71+0.02*r*Cos(a*bj_DEGTORAD)
set y=H81+0.02*r*Sin(a*bj_DEGTORAD)
call MUSetUnitX(hero,PTI(x))
call MUSetUnitY(hero,PUI(y))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call MUSetUnitX(dummy,GetUnitX(hero))
call MUSetUnitY(dummy,GetUnitY(hero))
call UPI(GetUnitX(hero),GetUnitY(hero),100)
set d=QNI(H71,H81,GetUnitX(hero),GetUnitY(hero))
set E63=E63+d
call SaveReal(LY,(handle_id),(138),((E63)*1.0))
set g=NTI()
set GK=hero
set L3I=hero
set L5I=PR2
set L6I=1
set L4I=null
set L9I=100
set LAI=E36
set LBI=null
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),150+25,Condition(function CA1))
call ForGroup(g,function E16)
call NSI(g)
if LBI!=null then
set g=NTI()
set L4I=null
set AK=9999
call GroupEnumUnitsInRange(g,GetUnitX(LBI),GetUnitY(LBI),600+25,Condition(function DU6))
call NSI(g)
if L4I==null then
set E46=true
set L4I=LBI
else
set E56=L4I
call SaveUnitHandle(LY,(handle_id),(810),(E56))
endif
endif
else
call MUSetUnitX(hero,H71)
call MUSetUnitY(hero,H81)
if BG1(hero)then
set E46=true
endif
endif
if BG1(hero)or GetTriggerEventId()==EVENT_WIDGET_DEATH or E46 or(E56==null and(GetTriggerEvalCount(t)>130 or L8I or(E36==0 and E63>800)or(E36==1 and E63>1600)))then
call KillUnit(dummy)
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitAddAbility(hero,'A2QR')
call UnitRemoveAbility(hero,'A2QR')
call SetUnitTimeScale(hero,1)
if L8I==true then
set x=GetUnitX(L4I)+50*Cos(a*bj_DEGTORAD)
set y=GetUnitY(L4I)+50*Sin(a*bj_DEGTORAD)
call MUSetUnitX(hero,PTI(x))
call MUSetUnitY(hero,PUI(y))
call IssueTargetOrder(hero,"attack",L4I)
endif
endif
set hero=null
set t=null
set g=null
set PR2=null
return false
endfunction
function E66 takes unit hero,unit E76 returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o01P',GetUnitX(hero),GetUnitY(hero),0)
local real a=UEI(GetUnitX(hero),GetUnitY(hero),GetSpellTargetX(),GetSpellTargetY())
call UnitAddAbility(hero,'A2QQ')
call UnitRemoveAbility(hero,'A2QQ')
call SetUnitTimeScale(hero,3)
call TriggerRegisterDeathEvent(t,hero)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function E26))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call SaveReal(LY,(handle_id),(6),((GetUnitX(hero))*1.0))
call SaveReal(LY,(handle_id),(7),((GetUnitY(hero))*1.0))
call SaveReal(LY,(handle_id),(137),((a)*1.0))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveReal(LY,(handle_id),(138),((0)*1.0))
call SaveUnitHandle(LY,(handle_id),(810),(null))
if E76!=null and GetUnitTypeId(E76)=='o01X' then
call KillUnit(E76)
endif
set t=null
endfunction
function E86 takes nothing returns boolean
return((GetUnitTypeId(GetFilterUnit())=='o01X' and GetOwningPlayer(GetFilterUnit())==GetOwningPlayer(L3I))or(GetUnitTypeId((GetFilterUnit()))=='o020'))and IsUnitDead(GetFilterUnit())==false
endfunction
function RollingBoulder_Loop takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local group g
if GetUnitTypeId(hero)=='N0MU' and IsUnitDead(hero)==false then
set g=NTI()
set L3I=hero
call GroupEnumUnitsInRange(g,GetUnitX(hero),GetUnitY(hero),150+25,Condition(function E86))
if FirstOfGroup(g)!=null then
endif
call NSI(g)
set g=null
endif
set hero=null
set t=null
return false
endfunction
function E96 takes nothing returns boolean
return GetUnitTypeId(GetFilterUnit())=='N0MU' and IsUnitIllusion(GetFilterUnit())==false
endfunction
function EA6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real GW1=(LoadReal(LY,(handle_id),(442)))
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(800)))
local group g
if hero==null then
set g=NTI()
call GroupEnumUnitsInRange(g,0,0,99999,Condition(function E96))
set hero=FirstOfGroup(g)
call NSI(g)
set g=null
if hero!=null then
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveInteger(LY,(GetHandleId(hero)),(800),(6))
call AddSkill(hero,L7I[6])
endif
endif
if GetTriggerEventId()==EVENT_UNIT_SPELL_CAST then
if(DQ6(GetSpellAbilityId()))and JGO<=0 then
call PJI(hero)
endif
elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if DQ6(GetSpellAbilityId())or GetSpellAbilityId()=='A2TJ' then
if GetSpellAbilityId()=='A2TJ' then
call E66(hero,null)
endif
endif
elseif JGO<6 then
set GW1=GW1-0.2
call SaveReal(LY,(handle_id),(442),((GW1)*1.0))
if GW1<=0.then
call UnitRemoveAbility(hero,L7I[JGO])
set JGO=JGO+1
call AddSkill(hero,L7I[JGO])
call SaveInteger(LY,(GetHandleId(hero)),(800),(JGO))
call SaveReal(LY,(handle_id),(442),((LOI)*1.0))
endif
endif
set hero=null
set t=null
return false
endfunction
function EB6 takes unit hero returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.2,true)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_CAST)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EA6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(442),((LOI)*1.0))
call SaveInteger(LY,(GetHandleId(hero)),(800),(6))
call AddSkill(hero,L7I[6])
set t=null
endfunction
function QD1 takes nothing returns nothing
call EB6(GK)
endfunction
function EC6 takes unit ED6 returns nothing
local unit hero=K1[GetPlayerId(GetOwningPlayer(ED6))]
local integer handle_id=GetHandleId(hero)
local integer EE6=(LoadInteger(LY,(handle_id),(279)))
local integer i=1
local integer x=1
local unit E76
loop
exitwhen i>EE6
set E76=(LoadUnitHandle(LY,(handle_id),(1400+i)))
if IsUnitDead(E76)==false then
call SaveUnitHandle(LY,(handle_id),(1400+x),(E76))
set x=x+1
endif
set i=i+1
endloop
set EE6=EE6-1
call SaveInteger(LY,(handle_id),(279),(EE6))
set E76=null
set hero=null
endfunction
function EF6 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='o01X' then
call EC6(GetTriggerUnit())
endif
return false
endfunction
function EG6 takes nothing returns nothing
local unit E76
local unit hero=GetTriggerUnit()
local integer handle_id=GetHandleId(hero)
local integer EE6=(LoadInteger(LY,(handle_id),(279)))
local unit EH6=(LoadUnitHandle(LY,(handle_id),(1400+1)))
local real x
local real y
local integer JGO=(LoadInteger(LY,(GetHandleId(hero)),(800)))
if JGO>0 then
if GetSpellTargetUnit()==null then
set x=GetSpellTargetX()
set y=GetSpellTargetY()
else
set x=GetUnitX(GetSpellTargetUnit())
set y=GetUnitY(GetSpellTargetUnit())
endif
call UnitRemoveAbility(hero,L7I[JGO])
set JGO=IMaxBJ(0,JGO-1)
call AddSkill(hero,L7I[JGO])
call SaveInteger(LY,(GetHandleId(hero)),(800),(JGO))
set E76=CreateUnit(GetOwningPlayer(hero),'o01X',x,y,0)
call UnitApplyTimedLife(E76,'BTLF',120)
call SetUnitPathing(E76,false)
set EE6=EE6+1
call SaveUnitHandle(LY,(handle_id),(1400+EE6),(E76))
call SaveInteger(LY,(handle_id),(279),(EE6))
if(EE6>6)then
call KillUnit(EH6)
endif
endif
set E76=null
set hero=null
set EH6=null
endfunction
function EZ6 takes nothing returns boolean
if DQ6(GetSpellAbilityId())then
call EG6()
endif
return false
endfunction
function QA1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EZ6))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function EF6))
set L7I[0]='A31H'
set L7I[1]='A31J'
set L7I[2]='A31G'
set L7I[3]='A2TH'
set L7I[4]='A31L'
set L7I[5]='A31I'
set L7I[6]='A31K'
set t=null
endfunction
function BoulderSmash_FindRock takes nothing returns boolean
if IsUnitInGroup(GetFilterUnit(),LDI)==false and(GetUnitTypeId(GetFilterUnit())=='o01X' or GetUnitTypeId(GetFilterUnit())=='o020')and GetFilterUnit()!=LFI then
call GroupAddUnit(LDI,GetFilterUnit())
set LZI=LZI+1
if GetUnitTypeId(GetFilterUnit())=='o01X' then
call KillUnit(GetFilterUnit())
endif
endif
return false
endfunction
function EV6 takes nothing returns nothing
if IsUnitInGroup(GetEnumUnit(),LDI)==false then
call GroupAddUnit(LDI,GetEnumUnit())
call Damage(LEI,GetEnumUnit(),1,LHI)
if LVI==1 then
call DD1(LEI,GetEnumUnit(),0.25+0.5*LGI)
endif
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)==true and((LoadInteger(LY,(GetHandleId((GetEnumUnit()))),((809))))==1)then
set LWI=GetEnumUnit()
endif
endif
endfunction
function EW6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real QJI=(LoadReal(LY,(handle_id),(6)))
local real QKI=(LoadReal(LY,(handle_id),(7)))
local real a
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local real x
local real y
local boolean DM6=false
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local group g
local integer RockBonusCount=(LoadInteger(LY,(handle_id),(34)))
local integer HeroSTR=GetHeroStr(hero,true)
local unit E56=(LoadUnitHandle(LY,(handle_id),(810)))
if E56!=null then
set QJI=GetUnitX(E56)
set QKI=GetUnitY(E56)
endif
set a=bj_DEGTORAD*UEI(GetUnitX(target),GetUnitY(target),QJI,QKI)
set x=II3+(LCI)*0.03*Cos(a)
set y=I13+(LCI)*0.03*Sin(a)
if QNI(x,y,QJI,QKI)<(5+(LCI)*0.03)then
set x=QJI
set y=QKI
set DM6=true
endif
set x=PTI(x)
set y=PUI(y)
set LDI=PR2
set LEI=hero
set LGI=GetUnitAbilityLevel(hero,'A2UU')
set LHI=125
set LWI=null
if((LoadInteger(LY,(GetHandleId((target))),((4306))))==1)==true or GetTriggerEventId()==EVENT_UNIT_DEATH or GetUnitAbilityLevel(target,'B08V')>0 or((LoadInteger(LY,(GetHandleId((target))),((4336))))==1)==true or(E56==null and GetTriggerEvalCount(t)>200)then
set DM6=true
else
call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl",x,y))
if GetUnitTypeId(target)=='o01X' or GetUnitTypeId(target)=='o020' then
set LVI=1
call SetUnitPosition(target,x,y)
call MUSetUnitX(target,PTI(x))
call MUSetUnitY(target,PUI(y))
else
set LVI=0
call MUSetUnitX(target,PTI(x))
call MUSetUnitY(target,PUI(y))
endif
call UPI(x,y,150)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
set g=NTI()
set GK=hero
call GroupEnumUnitsInRange(g,x,y,200+25,Condition(function CA1))
call GroupRemoveUnit(g,target)
call ForGroup(g,function EV6)
call NSI(g)
if LWI!=null and LVI==1 then
set g=NTI()
set LFI=null
set AK=9999
call GroupEnumUnitsInRange(g,GetUnitX(LWI),GetUnitY(LWI),600+25,Condition(function DG6))
call NSI(g)
if LFI!=null then
set E56=LFI
call SaveUnitHandle(LY,(handle_id),(810),(E56))
set DM6=false
endif
endif
set g=null
endif
if DM6 then
if GetUnitTypeId(target)!='o01X' then
call SetUnitPathing(target,true)
endif
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call NSI(PR2)
call SaveInteger(LY,(GetHandleId((target))),((4335)),(2))
if GetTriggerEventId()!=EVENT_UNIT_DEATH then
if IsPlayerAlly(GetOwningPlayer(hero),GetOwningPlayer(target))==false then
call Damage(LEI,target,1,LHI)
endif
endif
endif
set target=null
set t=null
set PR2=null
set hero=null
return false
endfunction
function EX6 takes nothing returns boolean
if GetUnitTypeId(GetFilterUnit())=='o01X' then
return true
endif
return false
endfunction
function EY6 takes nothing returns nothing
local unit target=GetSpellTargetUnit()
local unit hero=GetTriggerUnit()
local integer level=GetUnitAbilityLevel(hero,'A2UU')
local trigger t
local integer handle_id
local real a
local real x
local real y
local integer i=-1
local boolean K3O=false
local real d=400+100*level
local group g
if target==null then
set g=NTI()
call GroupEnumUnitsInRange(g,GetSpellTargetX(),GetSpellTargetY(),180+25,Condition(function EX6))
set target=FirstOfGroup(g)
call NSI(g)
set g=null
set a=GetUnitFacing(hero)
else
set a=UDI(hero,target)
endif
if target==null then
return
endif
set t=CreateTrigger()
set handle_id=GetHandleId(t)
if hero==target then
set a=GetUnitFacing(hero)
endif
if GetUnitTypeId(target)=='o01X' or GetUnitTypeId(target)=='o020' then
set d=2000
endif
loop
exitwhen K3O or i==23
set i=i+1
set x=PTI(GetUnitX(target)+(d-i*25)*Cos(a*bj_DEGTORAD))
set y=PUI(GetUnitY(target)+(d-i*25)*Sin(a*bj_DEGTORAD))
if(IsPointInRegion(LN,((x)*1.0),((y)*1.0)))==false then
set K3O=true
endif
endloop
call SetUnitPathing(target,false)
call TriggerRegisterTimerEvent(t,0.03,true)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function EW6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
call SaveReal(LY,(handle_id),(23),((GetUnitX(target))*1.0))
call SaveReal(LY,(handle_id),(24),((GetUnitY(target))*1.0))
call SaveInteger(LY,(handle_id),(34),(0))
call SaveGroupHandle(LY,(handle_id),(187),(NTI()))
call SaveUnitHandle(LY,(handle_id),(810),(null))
call SaveInteger(LY,(GetHandleId((target))),((4335)),(1))
set target=null
set hero=null
set t=null
endfunction
function EJ6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local group g
if GetUnitTypeId(target)=='n00L' then
call PJI(hero)
call PZI(GetOwningPlayer(hero),"非法目标")
elseif target==null then
set g=NTI()
call GroupEnumUnitsInRange(g,GetSpellTargetX(),GetSpellTargetY(),180+25,Condition(function EX6))
if FirstOfGroup(g)==null then
call PJI(hero)
call PZI(GetOwningPlayer(hero),"非法目标")
endif
call NSI(g)
set g=null
endif
set hero=null
set target=null
endfunction
function EK6 takes nothing returns boolean
if GetSpellAbilityId()=='A2UU' then
if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT then
if IsUnitEnemy(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))==false or CanResistSkill(GetSpellTargetUnit())==false then
call EY6()
endif
else
call EJ6()
endif
endif
return false
endfunction
function QB1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function EK6))
set t=null
endfunction
function EL6 takes nothing returns nothing
call Damage(LXI,GetEnumUnit(),1,LYI)
endfunction
function EM6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group g
local boolean EN6=false
if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
if DQ6(GetSpellAbilityId())and GetSpellTargetUnit()==dummy then
set EN6=true
endif
endif
if EN6==true or GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT then
set g=NTI()
call MUSetUnitX(target,GetUnitX(dummy))
call MUSetUnitY(target,GetUnitY(dummy))
call KillUnit(dummy)
call SetUnitInvulnerable(target,false)
call PauseUnit(target,false)
call ShowUnit(target,true)
call ClearSelectionForPlayer(GetOwningPlayer(target))
call SelectUnitAddForPlayer(target,GetOwningPlayer(target))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set GK=hero
set LXI=hero
set LYI=300
call GroupEnumUnitsInRange(g,GetUnitX(target),GetUnitY(target),300+25,Condition(function CA1))
call ForGroup(g,function EL6)
call NSI(g)
endif
set g=null
set t=null
set hero=null
set target=null
set dummy=null
return false
endfunction
function ES6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2S9')
local trigger t
local integer handle_id
local unit dummy=CreateUnit(GetOwningPlayer(hero),'o020',GetUnitX(target),GetUnitY(target),0)
local integer JGO=(LoadInteger(LY,(GetHandleId(GetTriggerUnit())),(800)))
if(IsUnitEnemy(target,GetOwningPlayer(hero)))==false or CanResistSkill(GetSpellTargetUnit())==false then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SelectUnitRemoveForPlayer(target,GetOwningPlayer(target))
call SetUnitInvulnerable(target,true)
call PauseUnit(target,true)
call ShowUnit(target,false)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(19),(dummy))
call TriggerRegisterTimerEvent(t,3,false)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function EM6))
endif
set dummy=CreateUnit(GetOwningPlayer(target),'o021',GetUnitX(target),GetUnitY(target),0)
call UnitApplyTimedLife(dummy,'BTLF',3)
set hero=null
set target=null
set dummy=null
set t=null
endfunction
function ET6 takes nothing returns boolean
if GetSpellAbilityId()=='A2S9' then
call ES6()
endif
return false
endfunction
function ER6 takes nothing returns nothing
if IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))and(LoadBoolean(LY,(GetHandleId(GetOwningPlayer(GetSpellTargetUnit()))),(139)))and GetSpellTargetUnit()!=GetTriggerUnit()then
call PJI(GetTriggerUnit())
call PZI(GetOwningPlayer(GetTriggerUnit()),"该目标拒绝某些友方技能")
endif
endfunction
function EP6 takes nothing returns boolean
if GetSpellAbilityId()=='A2S9' then
call ER6()
endif
return false
endfunction
function QC1 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function ET6))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function EP6))
set t=null
endfunction
function XCO takes nothing returns nothing
call AddSkill(GK,'A2S9')
endfunction
function EQ6 takes nothing returns nothing
set LKI=GetEnumUnit()
call ExecuteFunc("EU6")
endfunction
function F06 takes nothing returns boolean
return IsUnitDead(GetFilterUnit())==false and(GetUnitTypeId(GetFilterUnit())=='o01X' or GetUnitTypeId(GetFilterUnit())=='o020')and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4335))))==1)==false and((LoadInteger(LY,(GetHandleId((GetFilterUnit()))),((4340))))==1)==false
endfunction
function FI6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local group g=NTI()
local integer NPI=GetTriggerEvalCount(t)
local integer level=GetUnitAbilityLevel(hero,'A2TI')
local real LVO=(LoadReal(LY,(GetHandleId(target)),(807)))
if ModuloInteger(NPI,5)==0 then
call Damage(hero,target,1,(25+25*level)/2)
endif
set LJI=hero
set GK=hero
call GroupEnumUnitsInRange(g,x,y,400+25,Condition(function F06))
call ForGroup(g,function EQ6)
call NSI(g)
if(TimerGetElapsed(M))>LVO or IsUnitDead(target)then
call SaveInteger(LY,(GetHandleId((target))),((809)),(2))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(32))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
endif
set t=null
set hero=null
set target=null
return false
endfunction
function F16 takes unit hero,unit target returns nothing
local trigger t
local integer handle_id
local real LVO=(LoadReal(LY,(GetHandleId(target)),(807)))
call SaveReal(LY,(GetHandleId(target)),(807),(((TimerGetElapsed(M))+6)*1.0))
if LVO<(TimerGetElapsed(M))then
call SaveInteger(LY,(GetHandleId((target))),((809)),(1))
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveEffectHandle(LY,(handle_id),(32),(AddSpecialEffectTarget("war3mapImported\\MagnetizeTargetOverhead.mdx",target,"origin")))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function FI6))
endif
set t=null
endfunction
function FO6 takes nothing returns nothing
call F16(LJI,GetEnumUnit())
endfunction
function F26 takes unit hero,unit target returns nothing
local group g=NTI()
local real x=GetUnitX(target)
local real y=GetUnitY(target)
local real V83=300
if GetUnitTypeId(target)=='o01X' then
call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\DemolisherMissile\\DemolisherMissile.mdx",GetUnitX(target),GetUnitY(target)))
call UnitApplyTimedLife(target,'BTLF',8)
call SaveInteger(LY,(GetHandleId((target))),((4340)),(1))
call SetUnitVertexColor(target,0,0,0,100)
set V83=600
else
call DestroyEffect(AddSpecialEffect("war3mapImported\\MagnetizeCastAoE.mdx",GetUnitX(target),GetUnitY(target)))
endif
set GK=hero
set LJI=hero
set LKI=target
call GroupEnumUnitsInRange(g,x,y,V83+25,Condition(function CA1))
call ForGroup(g,function FO6)
call NSI(g)
set hero=null
set g=null
endfunction
function EU6 takes nothing returns nothing
call F26(LJI,LKI)
endfunction
function F36 takes nothing returns boolean
if GetSpellAbilityId()=='A2TI' then
call F26(GetTriggerUnit(),GetTriggerUnit())
endif
return false
endfunction
function Q81 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function F36))
set t=null
endfunction
function F46 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SetUnitAnimationByIndex(hero,8)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function F56 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SetUnitAnimationByIndex(hero,7)
call TriggerRegisterTimerEvent(t,2.5,false)
call TriggerAddCondition(t,Condition(function F46))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
set t=null
set hero=null
endfunction
function F66 takes nothing returns boolean
if GetUnitTypeId(GetTriggerUnit())=='N0MU' or GetUnitTypeId(GetTriggerUnit())=='N0MW' then
call F56()
endif
return false
endfunction
function Q71 takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function F66))
set t=null
endfunction
function F76 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local real LVO=(LoadReal(LY,(GetHandleId(target)),(804)))
if LVO>(TimerGetElapsed(M))or GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A2SP')
endif
set t=null
set target=null
return false
endfunction
function F86 takes unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call SaveReal(LY,(GetHandleId(target)),(804),(((TimerGetElapsed(M))+10)*1.0))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerRegisterDeathEvent(t,target)
call TriggerAddCondition(t,Condition(function F76))
call AddSkill(target,'A2SP')
call SetPlayerAbilityAvailable(GetOwningPlayer(target),'A2SP',false)
set t=null
endfunction
function F96 takes nothing returns nothing
if IsUnitType(GetEnumUnit(),UNIT_TYPE_HERO)or IsUnitIllusion(GetEnumUnit())==true then
set LMI=true
call F86(GetEnumUnit())
endif
call Damage(LLI,GetEnumUnit(),1,75*LNI)
endfunction
function FA6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+200)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=null
set hero=null
return false
endfunction
function FB6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local real x=(LoadReal(LY,(handle_id),(6)))
local real y=(LoadReal(LY,(handle_id),(7)))
local group g=NTI()
set LNI=GetUnitAbilityLevel(hero,'A2SO')
set GK=hero
set LLI=hero
set LMI=false
call GroupEnumUnitsInRange(g,x,y,175+25,Condition(function CA1))
call ForGroup(g,function F96)
call NSI(g)
call U7I("effects\\BasicWaterFlash.mdx",x,y,1)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if LMI then
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call TriggerRegisterTimerEvent(t,0,false)
call TriggerAddCondition(t,Condition(function FA6))
endif
set g=null
set t=null
set hero=null
return false
endfunction
function FC6 takes nothing returns nothing
local unit hero=GetTriggerUnit()
local real x=GetSpellTargetX()
local real y=GetSpellTargetY()
local integer level=GetUnitAbilityLevel(hero,'A2SO')
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.6,false)
call TriggerAddCondition(t,Condition(function FB6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveReal(LY,(handle_id),(6),((x)*1.0))
call SaveReal(LY,(handle_id),(7),((y)*1.0))
set hero=null
set t=null
endfunction
function FD6 takes nothing returns boolean
if GetSpellAbilityId()=='A2SO' then
call FC6()
endif
return false
endfunction
function Register_Pop takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FD6))
set t=null
endfunction
function FE6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=(LoadInteger(LY,(handle_id),(5)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
if GetOwningPlayer(GetEventDamageSource())==GetOwningPlayer(hero)or GetOwningPlayer(GetEventDamageSource())==GetOwningPlayer(target)then
call DisableTrigger(t)
call Damage(hero,target,3,GetEventDamage()*(0.6+0.1*level))
call QGI(hero,GetEventDamage()*(0.6+0.1*level))
call EnableTrigger(t)
endif
endif
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or IsUnitDead(target)then
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(175))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(176))))
call DestroyEffect((LoadEffectHandle(LY,(handle_id),(177))))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitRemoveAbility(target,'A2SH')
call UnitRemoveAbility(target,'B0GQ')
endif
set t=null
set hero=null
set target=null
return false
endfunction
function FF6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local integer level=GetUnitAbilityLevel(hero,'A2SI')
call AddSkill(target,'A2SH')
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,hero,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,3.5+0.5*level,false)
call TriggerAddCondition(t,Condition(function FE6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveInteger(LY,(handle_id),(5),(level))
call SaveEffectHandle(LY,(handle_id),(175),(AddSpecialEffectTarget("effects\\PoisonHands.mdx",target,"overhead")))
call SaveEffectHandle(LY,(handle_id),(176),(AddSpecialEffectTarget("effects\\PoisonHands.mdx",target,"hand,left")))
call SaveEffectHandle(LY,(handle_id),(177),(AddSpecialEffectTarget("effects\\PoisonHands.mdx",target,"hand,right")))
set t=null
set hero=null
set target=null
endfunction
function FG6 takes nothing returns boolean
if GetSpellAbilityId()=='A2SI' then
call FF6()
endif
return false
endfunction
function Register_SealedFate takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FG6))
set t=null
endfunction
function FH6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IYO=(LoadUnitHandle(LY,(handle_id),(335)))
if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
call SetUnitState(target,UNIT_STATE_LIFE,RMaxBJ(1,GetUnitState(target,UNIT_STATE_LIFE)-GetEventDamage()))
elseif GetTriggerEventId()==EVENT_WIDGET_DEATH then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
if GetTriggerUnit()==target then
call KillUnit(IYO)
endif
else
call IssueTargetOrderById(IYO,851986,target)
endif
set t=null
set hero=null
set target=null
set IYO=null
return false
endfunction
function FZ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local unit IYO=GetSummonedUnit()
local unit dummy
if GetUnitAbilityLevel(IYO,'B0GO')>0 then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
call SaveUnitHandle(LY,(handle_id),(335),(IYO))
call TriggerRegisterDeathEvent(t,IYO)
call TriggerRegisterDeathEvent(t,target)
call TriggerRegisterUnitEvent(t,IYO,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function FH6))
set dummy=CreateUnit(GetOwningPlayer(IYO),'e00E',GetUnitX(IYO),GetUnitY(IYO),0)
call UnitAddAbility(dummy,'A2RU')
call SetUnitAbilityLevel(dummy,'A2RU',GetUnitAbilityLevel(hero,'A2QW'))
call IssueTargetOrder(dummy,"banish",IYO)
call UnitShareVision(IYO,GetOwningPlayer(hero),true)
call IssueTargetOrderById(IYO,851986,target)
endif
set t=null
set hero=null
set target=null
set IYO=null
set dummy=null
return false
endfunction
function FV6 takes nothing returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=GetTriggerUnit()
local unit target=GetSpellTargetUnit()
local unit dummy
local player p
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function FZ6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
if IsUnitAlly(target,BO[0])==true then
set p=BO[0]
else
set p=CO[0]
endif
set dummy=CreateUnit(p,'e00E',GetUnitX(target),GetUnitY(target),0)
call UnitAddAbility(dummy,'A2RT')
call SetUnitAbilityLevel(dummy,'A2RT',GetUnitAbilityLevel(hero,'A2QW'))
call IssueTargetOrderById(dummy,852274,target)
set t=null
set hero=null
set target=null
endfunction
function FW6 takes nothing returns boolean
if GetSpellAbilityId()=='A2QW' then
call FV6()
endif
return false
endfunction
function Register_SoulFragment takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FW6))
set t=null
endfunction
function FX6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
local unit target=(LoadUnitHandle(LY,(handle_id),(17)))
local integer level=GetUnitAbilityLevel(hero,'A2SQ')
if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
else
call SetUnitState(hero,UNIT_STATE_LIFE,GetUnitState(hero,UNIT_STATE_LIFE)+GetEventDamage()*(0.25+0.25*level))
call SetUnitState(hero,UNIT_STATE_MANA,GetUnitState(hero,UNIT_STATE_MANA)+GetEventDamage()*(0.25*level))
endif
set t=null
set hero=null
set target=null
return false
endfunction
function FY6 takes unit hero,unit target returns nothing
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
call TriggerRegisterUnitEvent(t,target,EVENT_UNIT_DAMAGED)
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function FX6))
call SaveUnitHandle(LY,(handle_id),(2),(hero))
call SaveUnitHandle(LY,(handle_id),(17),(target))
set t=null
endfunction
function FJ6 takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit hero=(LoadUnitHandle(LY,(handle_id),(2)))
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call UnitAddAbility(hero,'A2SX')
call UnitRemoveAbility(hero,'A2SX')
set hero=null
set t=null
return false
endfunction
function FK6 takes nothing returns nothing
if RKI(GetEnumUnit())==false then
call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\SpellShieldAmulet\\SpellShieldCaster.mdl",GetEnumUnit(),"overhead"))
call SetUnitOwner(LRI,GetOwningPlayer(GetEnumUnit()),false)
call IssueTargetOrder(LRI,"banish",GetEnumUnit())
call FY6(LPI,GetEnumUnit())
endif
endfunction
function RiftWalk_Move takes nothing returns boolean
local trigger t=GetTriggeringTrigger()
local integer handle_id=GetHandleId(t)
local unit SFI=(LoadUnitHandle(LY,(handle_id),(14)))
local real x2=(LoadReal(LY,(handle_id),(66)))
local real y2=(LoadReal(LY,(handle_id),(67)))
local real a=(LoadReal(LY,(handle_id),(137)))
local integer NPI=GetTriggerEvalCount(t)
local real x=GetUnitX(SFI)
local real y=GetUnitY(SFI)
local real II3=(LoadReal(LY,(handle_id),(23)))
local real I13=(LoadReal(LY,(handle_id),(24)))
local unit dummy=(LoadUnitHandle(LY,(handle_id),(19)))
local group g=NTI()
local group PR2=(LoadGroupHandle(LY,(handle_id),(187)))
local integer level=GetUnitAbilityLevel(SFI,'A2SQ')
if QNI(x,y,x2,y2)<=LSI then
set x=x2
set y=y2
else
set x=PTI(II3+65*Cos(a*bj_DEGTORAD))
set y=PUI(I13+65*Sin(a*bj_DEGTORAD))
endif
set GK=SFI
set LTI=PR2
set LRI=dummy
set LPI=SFI
call GroupEnumUnitsInRange(g,x,y,200+25,Condition(function CA1))
call ForGroup(g,function FK6)
call NSI(g)
call SaveReal(LY,(handle_id),(23),((x)*1.0))
call SaveReal(LY,(handle_id),(24),((y)*1.0))
call MUSetUnitX(SFI,x)
call MUSetUnitY(SFI,y)
if(x==x2 and y==y2)or NPI>40 then
call NSI(PR2)
call FlushChildHashtable(LY,(handle_id))
call FlushTrigger(t)
call KillUnit(dummy)
call UnitAddAbility(SFI,'A2SW')
call UnitRemoveAbility(SFI,'A2SW')
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function FJ6))
call SetUnitAnimation(SFI,"stand")
call SetUnitPathing(SFI,true)
call SetUnitInvulnerable(SFI,false)
if GetUnitTypeId(SFI)=='E02X' then
call SetUnitVertexColor(SFI,255,255,255,255)
else
call SetUnitVertexColor(SFI,255,255,255,255)
endif
call SaveInteger(LY,(GetHandleId((SFI))),((4261)),(2))
endif
set t=null
set SFI=null
set dummy=null
return false
endfunction
function FL6 takes nothing returns nothing
local unit SFI=GetTriggerUnit()
local location point
local trigger t=CreateTrigger()
local integer handle_id=GetHandleId(t)
local real x1=GetUnitX(SFI)
local real y1=GetUnitY(SFI)
local real x2
local real y2
local real a
local unit dummy=CreateUnit(GetOwningPlayer(SFI),'e00E',x1,y1,0)
local group g=NTI()
if GetSpellTargetUnit()==null then
set point=GetSpellTargetLoc()
else
set point=GetUnitLoc(GetSpellTargetUnit())
endif
set x2=GetLocationX(point)
set y2=GetLocationY(point)
set a=UEI(x1,y1,x2,y2)
call RemoveLocation(point)
call AddSkill(dummy,'A2SV')
call SetUnitAbilityLevel(dummy,'A2SV',GetUnitAbilityLevel(SFI,'A2SQ'))
set LRI=dummy
set LPI=SFI
call GroupEnumUnitsInRange(g,x2,y2,200+25,Condition(function C51))
call ForGroup(g,function FK6)
call NSI(g)
set g=null
call UnitAddAbility(SFI,'A2SW')
call UnitRemoveAbility(SFI,'A2SW')
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call SaveUnitHandle(LY,(handle_id),(2),(SFI))
call TriggerRegisterTimerEvent(t,4,false)
call TriggerAddCondition(t,Condition(function FJ6))
set SFI=null
set point=null
set t=null
set dummy=null
endfunction
function FM6 takes nothing returns boolean
if GetSpellAbilityId()=='A2SQ' then
call FL6()
endif
return false
endfunction
function Register_RiftWalk takes nothing returns nothing
local trigger t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function FM6))
set t=null
endfunction
function InitCustomTeams takes nothing returns nothing
call SetPlayerTeam(Player(1),0)
call SetPlayerTeam(Player(2),0)
call SetPlayerTeam(Player(3),0)
call SetPlayerTeam(Player(4),0)
call SetPlayerTeam(Player(5),0)
call SetPlayerTeam(Player(7),1)
call SetPlayerTeam(Player(8),1)
call SetPlayerTeam(Player(9),1)
call SetPlayerTeam(Player(10),1)
call SetPlayerTeam(Player(11),1)
endfunction
function main takes nothing returns nothing
local weathereffect we
local integer i
local player p
local unit u
local integer MSI
local trigger t
local real life
local integer MLI
local integer MMI
local version v
local integer MGI
local real HE1
local real HF1
local real HG1
local real HH1
local real HZ1
local real HV1
local real HW1
local real HX1
local real HY1
local real HJ1
local real HK1
local real HL1
local real HM1
local real HN1
local real HS1
local real HT1
local real HR1
local real HP1
local real HQ1
local real HU1
local integer Z01
local player T4I
local real ZH1
local real ZZ1
local real ZV1
local real ZW1
local real ZX1
local real ZY1
local real ZJ1
local real ZK1
local real ZL1
local real ZM1
local real ZN1
local real ZS1
local real ZT1
local real ZR1
local real ZP1
local real ZQ1
local real ZU1
local real V01
local real VI1
local real V11
local real VO1
local real V21
local real V31
local real V41
local location BFO
local region S5O
local real d
local integer handle_id
//初始化
call InitializeYD()
call SetCameraBounds(-7552.0+GetCameraMargin(CAMERA_MARGIN_LEFT),-7936.0+GetCameraMargin(CAMERA_MARGIN_BOTTOM),7552.0-GetCameraMargin(CAMERA_MARGIN_RIGHT),7424.0-GetCameraMargin(CAMERA_MARGIN_TOP),-7552.0+GetCameraMargin(CAMERA_MARGIN_LEFT),7424.0-GetCameraMargin(CAMERA_MARGIN_TOP),7552.0-GetCameraMargin(CAMERA_MARGIN_RIGHT),-7936.0+GetCameraMargin(CAMERA_MARGIN_BOTTOM))
call SetDayNightModels("Environment\\DNC\\DNCFelwood\\DNCFelwoodTerrain\\DNCFelwoodTerrain.mdl","Environment\\DNC\\DNCFelwood\\DNCFelwoodUnit\\DNCFelwoodUnit.mdl")
call SetWaterBaseColor(0,0,255,255)
call NewSoundEnvironment("Default")
call SetAmbientDaySound("FelwoodDay")
call SetAmbientNightSound("FelwoodNight")
call SetMapMusic("Music",true,0)
set BC=CreateSound("Abilities\\Spells\\Human\\Avatar\\Avatar.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(BC,"Avatar")
call SetSoundDuration(BC,3199)
set CC=CreateSound("Abilities\\Spells\\NightElf\\Blink\\BlinkArrival1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(CC,"BlinkTarget")
call SetSoundDuration(CC,1466)
call SetSoundPitch(CC,1.6)
set DC=CreateSound("Abilities\\Spells\\Human\\Blizzard\\BlizzardLoop1.wav",true,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(DC,"BlizzardLoop")
call SetSoundDuration(DC,4000)
set EC=CreateSound("Buildings\\Undead\\TempleOfTheDamned\\TempleOfTheDamnedWhat.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(EC,"TempleOfTheDamnedWhat")
call SetSoundDuration(EC,3518)
call SetSoundDistanceCutoff(EC,2000.0)
set FC=CreateSound("Abilities\\Spells\\Human\\Flare\\FlareTarget2.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(FC,"Flare2")
call SetSoundDuration(FC,1344)
call SetSoundDistanceCutoff(FC,2000.0)
set GC=CreateSound("Sounds\\Dominating.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(GC,1802)
call SetSoundChannel(GC,0)
call SetSoundVolume(GC,127)
call SetSoundPitch(GC,1.0)
set HC=CreateSound("Sounds\\Double_Kill.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(HC,2012)
call SetSoundChannel(HC,0)
call SetSoundVolume(HC,127)
call SetSoundPitch(HC,1.0)
set ZC=CreateSound("Sounds\\firstblood.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(ZC,1567)
call SetSoundChannel(ZC,0)
call SetSoundVolume(ZC,127)
call SetSoundPitch(ZC,1.0)
set VC=CreateSound("Units\\Creeps\\GoblinSapper\\GoblinSapperPissed1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(VC,"GoblinSapperPissed")
call SetSoundDuration(VC,1515)
call SetSoundChannel(VC,0)
set WC=CreateSound("Units\\Creeps\\GoblinSapper\\GoblinSapperYesAttack1.wav",false,false,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(WC,"GoblinSapperYesAttack")
call SetSoundDuration(WC,813)
call SetSoundChannel(WC,0)
set XC=CreateSound("Sounds\\GodLike.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(XC,1828)
call SetSoundChannel(XC,0)
call SetSoundVolume(XC,127)
call SetSoundPitch(XC,1.0)
set YC=CreateSound("Units\\Orc\\HeroBladeMaster\\HeroBladeMasterPissed1.wav",false,true,true,10,10,"HeroAcksEAX")
call SetSoundParamsFromLabel(YC,"HeroBladeMasterPissed")
call SetSoundDuration(YC,2235)
set JC=CreateSound("Sounds\\HolyShit.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(JC,2325)
call SetSoundChannel(JC,0)
call SetSoundVolume(JC,127)
call SetSoundPitch(JC,1.0)
set NC=CreateSound("Buildings\\NightElf\\MoonWell\\MoonWellWhat1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(NC,"MoonWellWhat")
call SetSoundDuration(NC,2972)
call SetSoundDistances(NC,600.0,10000.0)
call SetSoundDistanceCutoff(NC,2000.0)
set TC=CreateSound("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaos.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(TC,"MarkOfChaos")
call SetSoundDuration(TC,4000)
set RC=CreateSound("Sounds\\Killing_Spree.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(RC,2377)
call SetSoundChannel(RC,0)
call SetSoundVolume(RC,127)
call SetSoundPitch(RC,1.0)
set PC=CreateSound("Sound\\Buildings\\Death\\NightElfBuildingDeathSmall1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(PC,"DeathNightElfBuildingCancel")
call SetSoundDuration(PC,3675)
set QC=CreateSound("Sounds\\MegaKill.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(QC,2612)
call SetSoundChannel(QC,0)
call SetSoundVolume(QC,127)
call SetSoundPitch(QC,1.0)
set UC=CreateSound("Abilities\\Spells\\NightElf\\ShadowMeld\\ShadowMeld1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(UC,"ShadowMeld")
call SetSoundDuration(UC,941)
set OD=CreateSound("Sounds\\MonsterKill.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(OD,3344)
call SetSoundChannel(OD,0)
call SetSoundVolume(OD,127)
call SetSoundPitch(OD,1.0)
set ED=CreateSound("Units\\Creeps\\Ogre\\OgrePissed1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(ED,"OgrePissed")
call SetSoundDuration(ED,3309)
set JD=CreateSound("Sounds\\Ownage.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(JD,2586)
call SetSoundChannel(JD,0)
call SetSoundVolume(JD,127)
call SetSoundPitch(JD,1.0)
set KD=CreateSound("Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed1.wav",false,true,true,10,10,"HeroAcksEAX")
call SetSoundParamsFromLabel(KD,"PandarenBrewmasterPissed")
call SetSoundDuration(KD,2316)
set LD=CreateSound("Abilities\\Spells\\Human\\Polymorph\\PolymorphDone.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(LD,"PolymorphDone")
call SetSoundDuration(LD,1498)
set MD=CreateSound("Buildings\\Naga\\TempleofTides\\TempleOfTidesWhat1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(MD,"TempleOfTidesWhat")
call SetSoundDuration(MD,3483)
call SetSoundDistanceCutoff(MD,2000.0)
set ND=CreateSound("Buildings\\Undead\\TombOfRelics\\TombOfRelicsWhat1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(ND,"TombOfRelicsWhat")
call SetSoundDuration(ND,3065)
call SetSoundDistanceCutoff(ND,2000.0)
set TD=CreateSound("Abilities\\Spells\\Orc\\Disenchant\\Disenchant.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(TD,"Disenchant")
call SetSoundDuration(TD,2043)
set PD=CreateSound("Sound\\Interface\\Rescue.wav",false,false,false,10,10,"")
call SetSoundParamsFromLabel(PD,"Rescue")
call SetSoundDuration(PD,3796)
set QD=CreateSound("Abilities\\Spells\\Undead\\Sleep\\SleepBirth1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(QD,"Sleep")
call SetSoundDuration(QD,3203)
set UD=CreateSound("Abilities\\Spells\\Undead\\DevourMagic\\DevourMagic.wav",false,true,true,10,10,"MissilesEAX")
call SetSoundParamsFromLabel(UD,"DevourMagicLaunch")
call SetSoundDuration(UD,1225)
set IE=CreateSound("Abilities\\Spells\\Other\\BlackArrow\\TheBlackArrow.wav",false,true,true,10,10,"MissilesEAX")
call SetSoundParamsFromLabel(IE,"BlackArrowHit")
call SetSoundDuration(IE,1776)
call SetSoundVolume(IE,50)
set OE=CreateSound("Sound\\Ambient\\DoodadEffects\\TheHornOfCenarius.wav",false,false,false,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(OE,"HornOfCenariusSound")
call SetSoundDuration(OE,12121)
call SetSoundVolume(OE,115)
set AE=CreateSound("Sounds\\triple_kill.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(AE,1907)
call SetSoundChannel(AE,0)
call SetSoundVolume(AE,127)
call SetSoundPitch(AE,1.0)
set EE=CreateSound("Sounds\\Unstoppable.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(EE,2038)
call SetSoundChannel(EE,0)
call SetSoundVolume(EE,127)
call SetSoundPitch(EE,1.0)
set FE=CreateSound("Abilities\\Spells\\Human\\DivineShield\\PaladinDivineShieldDeath1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(FE,"DivineShieldDeath")
call SetSoundDuration(FE,1043)
call SetSoundDistanceCutoff(FE,1500.0)
set GE=CreateSound("Abilities\\Spells\\Items\\AIso\\SoulGem.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(GE,"SoulGem")
call SetSoundDuration(GE,4474)
set HE=CreateSound("Sounds\\WhickedSick.mp3",false,false,false,10,10,"DefaultEAXON")
call SetSoundDuration(HE,2612)
call SetSoundChannel(HE,0)
call SetSoundVolume(HE,127)
call SetSoundPitch(HE,1.0)
set ZE=CreateSound("Units\\Creeps\\GoblinSapper\\GoblinSapperYesAttack4.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(ZE,"GoblinSapperYesAttack")
call SetSoundDuration(ZE,1091)
call SetSoundChannel(ZE,0)
set VE=CreateSound("Abilities\\Spells\\NightElf\\shadowstrike\\ShadowStrikeBirth1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(VE,"ShadowStrikeBirth")
call SetSoundDuration(VE,2194)
call SetSoundPitch(VE,1.2)
set WE=CreateSound("Abilities\\Spells\\Other\\BlackArrow\\TheBlackArrow.wav",false,true,true,10,10,"MissilesEAX")
call SetSoundParamsFromLabel(WE,"BlackArrowHit")
call SetSoundDuration(WE,1776)
call SetSoundPitch(WE,1.6)
set XE=CreateSound("Abilities\\Spells\\NightElf\\CorrosiveBreath\\CorrosiveBreathMissileLaunch1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(XE,"CorrosiveBreathMissileLaunch")
call SetSoundDuration(XE,1301)
call SetSoundPitch(XE,1.2)
set YE=CreateSound("Sound\\Interface\\Warning\\NightElf\\SentinelAllyHeroDies1.wav",false,false,false,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(YE,"AllyHeroDiesNightElf")
call SetSoundDuration(YE,1963)
call SetSoundVolume(YE,127)
set JE=CreateSound("Sound\\Interface\\Warning\\Undead\\NecromancerAllyHeroDies1.wav",false,false,false,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(JE,"AllyHeroDiesUndead")
call SetSoundDuration(JE,1933)
call SetSoundVolume(JE,127)
set KE=CreateSound("Abilities\\Spells\\Human\\ReviveHuman\\ReviveHuman.wav",false,false,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(KE,"ReviveHuman")
call SetSoundDuration(KE,3196)
call SetSoundChannel(KE,8)
set LE=CreateSound("Sound\\Interface\\SecretFound.wav",false,false,false,10,10,"")
call SetSoundParamsFromLabel(LE,"SecretFound")
call SetSoundDuration(LE,2525)
set ME=CreateSound("Sounds\\UltraKill.mp3",false,false,false,10,10,"")
call SetSoundDuration(ME,1958)
call SetSoundChannel(ME,0)
call SetSoundVolume(ME,127)
call SetSoundPitch(ME,1.0)
set NE=CreateSound("Sounds\\Rampage.mp3",false,false,false,10,10,"")
call SetSoundDuration(NE,1195)
call SetSoundChannel(NE,0)
call SetSoundVolume(NE,127)
call SetSoundPitch(NE,1.0)
set SE=CreateSound("Buildings\\NightElf\\AltarOfElders\\AltarOfEldersWhat1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(SE,"AltarOfEldersWhat")
call SetSoundDuration(SE,3496)
set TE=CreateSound("Units\\Orc\\AncestralGuardian\\AncestralGuardianAttack1.wav",false,true,true,10,10,"CombatSoundsEAX")
call SetSoundParamsFromLabel(TE,"AncestralGuardianAttack1")
call SetSoundDuration(TE,1181)
set RE=CreateSound("Abilities\\Spells\\Human\\Feedback\\Feedback.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(RE,"Feedback")
call SetSoundDuration(RE,1222)
set PE=CreateSound("Units\\Undead\\Abomination\\AbominationPissed5.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(PE,"AbominationPissed")
call SetSoundDuration(PE,1735)
set QE=CreateSound("Units\\Undead\\Abomination\\AbominationDeath1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(QE,"AbominationDeath")
call SetSoundDuration(QE,2455)
set UE=CreateSound("Sound\\Units\\Death\\ArtilleryCorpseExplodeDeath1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(UE,"ArtilleryExplodeDeath")
call SetSoundDuration(UE,1486)
set IF=CreateSound("Units\\Undead\\CryptFiend\\CryptFiendPissed2.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(IF,"CryptFiendPissed")
call SetSoundDuration(IF,3541)
set OF=CreateSound("Units\\Undead\\Banshee\\BansheeDeath.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(OF,"BansheeDeath")
call SetSoundDuration(OF,2380)
set AF=CreateSound("Abilities\\Spells\\Human\\FlameStrike\\FlameStrikeTargetWaveNonLoop1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(AF,"FlameStrikeTarget")
call SetSoundDuration(AF,1927)
set BF=CreateSound("Abilities\\Spells\\Other\\Volcano\\VolcanoLoop.wav",false,false,false,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(BF,"VolcanoLoop")
call SetSoundDuration(BF,7616)
set CF=CreateSound("Abilities\\Spells\\Human\\ThunderClap\\ThunderClapCaster.wav",false,false,false,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(CF,"ThunderClap")
call SetSoundDuration(CF,3451)
set DF=CreateSound("Abilities\\Spells\\Orc\\MirrorImage\\MirrorImage.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(DF,"MirrorImage")
call SetSoundDuration(DF,1756)
set EF=CreateSound("Abilities\\Spells\\Human\\CloudOfFog\\CloudOfFogLoop1.wav",true,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(EF,"CloudOfFogLoop")
call SetSoundDuration(EF,2038)
call SetSoundPitch(EF,0.9)
set FF=CreateSound("Units\\Human\\Gyrocopter\\GyrocopterPissed1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(FF,"GyrocopterPissed")
call SetSoundDuration(FF,3913)
set WF=CreateSound("Sound\\Interface\\SecretFound.wav",false,false,false,10,10,"")
call SetSoundParamsFromLabel(WF,"SecretFound")
call SetSoundDuration(WF,2525)
set XF=CreateSound("Sound\\Interface\\Hint.wav",false,false,false,10,10,"")
call SetSoundParamsFromLabel(XF,"Hint")
call SetSoundDuration(XF,2006)
set YF=CreateSound("war3mapImported\\pl_impact_stun.mp3",false,true,true,10,10,"SpellsEAX")
call SetSoundDuration(YF,1340)
call SetSoundChannel(YF,11)
call SetSoundVolume(YF,127)
call SetSoundPitch(YF,1.0)
call SetSoundDistances(YF,600.0,10000.0)
call SetSoundDistanceCutoff(YF,2000.0)
call SetSoundConeAngles(YF,0.0,0.0,127)
call SetSoundConeOrientation(YF,0.0,0.0,0.0)
set JF=CreateSound("Sound\\Buildings\\Fire\\OrcHumanLargeBuildingFire1.wav",true,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(JF,"HumanFireLarge")
call SetSoundDuration(JF,3471)
set KF=CreateSound("Units\\Human\\Phoenix\\PhoenixEggWhat1.wav",false,false,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(KF,"PhoenixEggWhat")
call SetSoundDuration(KF,1579)
call SetSoundChannel(KF,0)
set LF=CreateSound("Abilities\\Spells\\NightElf\\BattleRoar\\BattleRoar.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(LF,"BattleRoar")
call SetSoundDuration(LF,1991)
set MF=CreateSound("Buildings\\Undead\\Ziggurat\\ZigguratUpgrade.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(MF,"ZigguratUpgradeWhat")
call SetSoundDuration(MF,4203)
call SetSoundDistances(MF,600.0,10000.0)
call SetSoundDistanceCutoff(MF,3000.0)
set NF=CreateSound("Abilities\\Spells\\Human\\SpellSteal\\SpellStealMissile.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(NF,"SpellStealMissileLaunch")
call SetSoundDuration(NF,1541)
set SF=CreateSound("Abilities\\Spells\\Human\\SpellSteal\\SpellStealTarget.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(SF,"SpellStealTarget")
call SetSoundDuration(SF,984)
set TF=CreateSound("Abilities\\Spells\\Undead\\UndeadMine\\AcolyteMining.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(TF,"AcolyteMining")
call SetSoundDuration(TF,4233)
call SetSoundChannel(TF,0)
set RF=CreateSound("Abilities\\Weapons\\AvengerMissile\\DestroyerMissile.wav",false,true,true,10,10,"MissilesEAX")
call SetSoundParamsFromLabel(RF,"DestroyerMissileLaunch")
call SetSoundDuration(RF,817)
set PF=CreateSound("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouch.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(PF,"SpiritTouch")
call SetSoundDuration(PF,2043)
call SetSoundChannel(PF,11)
set QF=CreateSound("Abilities\\Spells\\Human\\FlameStrike\\FlameStrikeTargetWaveNonLoop1.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(QF,"FlameStrikeTarget")
call SetSoundDuration(QF,1927)
set UF=CreateSound("Units\\Orc\\SentryWard\\SentryWard.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(UF,"SentryWardBirth")
call SetSoundDuration(UF,1499)
set IG=CreateSound("Buildings\\Orc\\TaurenTotem\\TaurenTotemWhat1.wav",false,true,true,10,10,"DefaultEAXON")
call SetSoundParamsFromLabel(IG,"TaurenTotemWhat")
call SetSoundDuration(IG,3785)
set OG=CreateSound("Abilities\\Weapons\\GargoyleMissile\\GargoyleMissileLaunch3.wav",false,true,true,10,10,"MissilesEAX")
call SetSoundParamsFromLabel(OG,"GargoyleMissileLaunch")
call SetSoundDuration(OG,919)
set AG=CreateSound("Abilities\\Spells\\Items\\ResourceItems\\ReceiveGold.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(AG,"ReceiveGold")
call SetSoundDuration(AG,589)
set BG=CreateSound("Abilities\\Spells\\Human\\InnerFire\\InnerFireBirth.wav",false,true,true,10,10,"SpellsEAX")
call SetSoundParamsFromLabel(BG,"InnerFire")
call SetSoundDuration(BG,2096)
set L3=Rect(6176.0,3136.0,6400.0,3392.0)
set M3=Rect(3616.0,3584.0,3872.0,3872.0)
set N3=Rect(2304.0,5280.0,2752.0,5728.0)
set S3=Rect(6176.0,5952.0,6624.0,6240.0)
set T3=Rect(-4224.0,-6848.0,-3968.0,-6592.0)
set R3=Rect(-6304.0,-4384.0,-6080.0,-4224.0)
set P3=Rect(-4928.0,-5760.0,-4736.0,-5536.0)
set Q3=Rect(6048.0,3424.0,6304.0,3776.0)
set U3=Rect(4128.0,3776.0,4352.0,4032.0)
set I4=Rect(2752.0,5408.0,3040.0,5632.0)
set O4=Rect(-7040.0,-6912.0,-6688.0,-6656.0)
set A4=Rect(-3648.0,-6880.0,-3424.0,-6688.0)
set B4=Rect(-6336.0,-4224.0,-5984.0,-3904.0)
set C4=Rect(-4896.0,-5504.0,-4608.0,-5184.0)
set D4=Rect(2912.0,-2944.0,3104.0,-2720.0)
set E4=Rect(5696.0,5504.0,7296.0,7392.0)
set F4=Rect(-7680.0,-8032.0,-6176.0,-6240.0)
set G4=Rect(-2464.0,1536.0,-2240.0,1760.0)
set H4=Rect(4512.0,-1120.0,4768.0,-832.0)
set Z4=Rect(-3328.0,-416.0,-3104.0,-96.0)
set V4=Rect(1440.0,-4096.0,1728.0,-3872.0)
set W4=Rect(-4576.0,3328.0,-4448.0,3488.0)
set X4=Rect(-3264.0,4192.0,-2912.0,4320.0)
set Y4=Rect(2848.0,-5088.0,3072.0,-4928.0)
set J4=Rect(-1824.0,2240.0,-1472.0,2464.0)
set K4=Rect(3008.0,-3776.0,3136.0,-3648.0)
set L4=Rect(1184.0,2976.0,1280.0,3104.0)
set M4=Rect(-512.0,-3648.0,-320.0,-3520.0)
set N4=Rect(-7104.0,6656.0,-6848.0,6912.0)
set S4=Rect(-7104.0,6656.0,-6880.0,6880.0)
set T4=Rect(-5952.0,-6432.0,-5248.0,-5728.0)
set R4=Rect(5088.0,7488.0,5792.0,8192.0)
set P4=Rect(4032.0,-2432.0,4320.0,-2144.0)
set Q4=Rect(3904.0,-1408.0,4960.0,-640.0)
set U4=Rect(-3552.0,-768.0,-2528.0,320.0)
set I5=Rect(1056.0,-5216.0,2368.0,-3744.0)
set O5=Rect(-5120.0,3008.0,-3648.0,4320.0)
set A5=Rect(-3456.0,3808.0,-2656.0,4864.0)
set B5=Rect(2272.0,-6080.0,3776.0,-4928.0)
set C5=Rect(-1888.0,2208.0,-992.0,3040.0)
set D5=Rect(416.0,2624.0,1632.0,3648.0)
set E5=Rect(2592.0,-4800.0,3744.0,-3328.0)
set F5=Rect(-1024.0,-3808.0,192.0,-2752.0)
set G5=Rect(-7936.0,-7776.0,-5920.0,-5760.0)
set H5=Rect(5504.0,5184.0,7744.0,7136.0)
set Z5=Rect(-800.0,3072.0,64.0,4032.0)
set V5=Rect(-384.0,3392.0,-192.0,3520.0)
set W5=Rect(-1728.0,-5056.0,-768.0,-3840.0)
set X5=Rect(-1152.0,-4704.0,-960.0,-4480.0)
set Y5=Rect(-480.0,-800.0,-256.0,-512.0)
set J5=Rect(3648.0,-2528.0,4384.0,-2208.0)
set K5=Rect(7264.0,-5504.0,7488.0,-5280.0)
set L5=Rect(-8160.0,6848.0,-7968.0,7040.0)
set M5=Rect(3744.0,-2464.0,4416.0,-1984.0)
set N5=Rect(3456.0,-2624.0,4416.0,-2112.0)
set S5=Rect(3584.0,-2560.0,4192.0,-2336.0)
set T5=Rect(4096.0,-2528.0,4192.0,-2144.0)
set R5=Rect(3968.0,-2624.0,4096.0,-1920.0)
set P5=Rect(3936.0,-2528.0,4192.0,-2240.0)
set Q5=Rect(3968.0,-2624.0,4032.0,-2048.0)
set U5=Rect(3872.0,-2592.0,4480.0,-2240.0)
set I6=Rect(3936.0,-2528.0,4448.0,-1984.0)
set O6=Rect(-8160.0,-8192.0,-3712.0,-4352.0)
set A6=Rect(-8192.0,-4960.0,-4640.0,-3552.0)
set B6=Rect(-4000.0,-7744.0,-3072.0,-5152.0)
set C6=Rect(2304.0,4064.0,8032.0,7776.0)
set D6=Rect(4640.0,1952.0,8000.0,4384.0)
set E6=Rect(3136.0,2816.0,5216.0,4960.0)
set F6=Rect(-7968.0,5216.0,-7456.0,5920.0)
set G6=Rect(-8064.0,2880.0,-7648.0,4512.0)
set H6=Rect(-3296.0,3712.0,-2688.0,3968.0)
set Z6=Rect(-2400.0,2016.0,-1952.0,2624.0)
set V6=Rect(-2016.0,1600.0,-1216.0,2048.0)
set W6=Rect(-2144.0,2528.0,-1888.0,2944.0)
set X6=Rect(-1280.0,1728.0,-736.0,2176.0)
set Y6=Rect(-1696.0,-768.0,-1376.0,-448.0)
set J6=Rect(-576.0,0.0,-352.0,256.0)
set K6=Rect(3872.0,-1984.0,4448.0,-1504.0)
set L6=Rect(3456.0,-2048.0,4064.0,-1664.0)
set M6=Rect(4992.0,-3072.0,5664.0,-2784.0)
set N6=Rect(4896.0,-3744.0,5280.0,-3456.0)
set S6=Rect(7488.0,-3520.0,8192.0,-2336.0)
set T6=Rect(6656.0,-3328.0,7808.0,-2656.0)
set R6=Rect(7104.0,-8192.0,8192.0,-5920.0)
set P6=Rect(5952.0,-8192.0,7200.0,-7712.0)
set Q6=Rect(7168.0,-6240.0,8128.0,-5184.0)
set U6=Rect(5824.0,-8032.0,6400.0,-7776.0)
set I7=Rect(6976.0,-6560.0,7488.0,-5920.0)
set O7=Rect(-5856.0,2944.0,-5600.0,3200.0)
set A7=Rect(6784.0,-7776.0,7264.0,-7456.0)
set B7=Rect(-8128.0,-8192.0,5536.0,-7744.0)
set C7=Rect(2368.0,-7904.0,2688.0,-7584.0)
set D7=Rect(-1664.0,-7808.0,-1344.0,-7552.0)
set E7=Rect(-2944.0,-8192.0,-1664.0,-7680.0)
set F7=Rect(-4000.0,-8192.0,-3168.0,-7616.0)
set G7=Rect(-5760.0,-8000.0,-5184.0,-7584.0)
set H7=Rect(-3296.0,3744.0,-3104.0,3872.0)
set Z7=Rect(-8192.0,-8192.0,-6720.0,-7744.0)
set V7=Rect(-8192.0,-6432.0,-7456.0,-4928.0)
set W7=Rect(-8192.0,-8128.0,-7904.0,8160.0)
set X7=Rect(-7744.0,3936.0,-7328.0,5600.0)
set Y7=Rect(-7680.0,1984.0,-6560.0,2816.0)
set J7=Rect(-7776.0,1696.0,-6944.0,2176.0)
set K7=Rect(-8032.0,-3040.0,-7680.0,-2720.0)
set L7=Rect(-7904.0,-2656.0,-7552.0,-2336.0)
set M7=Rect(-3936.0,-2720.0,-3584.0,-2400.0)
set N7=Rect(-3168.0,-1952.0,-2912.0,-1696.0)
set S7=Rect(-4128.0,-1632.0,-3776.0,-1152.0)
set T7=Rect(-4992.0,-1792.0,-3968.0,-1440.0)
set R7=Rect(-5536.0,-1664.0,-4832.0,-1280.0)
set P7=Rect(-2304.0,3872.0,-2048.0,4096.0)
set Q7=Rect(-5664.0,-1440.0,-5344.0,0.0)
set U7=Rect(-5824.0,-1504.0,-5472.0,-544.0)
set I8=Rect(-5216.0,-1216.0,-4480.0,-384.0)
set O8=Rect(-5632.0,448.0,-5152.0,1856.0)
set A8=Rect(-5856.0,1440.0,-5248.0,2592.0)
set B8=Rect(-5408.0,1888.0,-4928.0,2368.0)
set C8=Rect(-5056.0,1664.0,-4064.0,2144.0)
set D8=Rect(-4320.0,1344.0,-3808.0,1952.0)
set E8=Rect(-4224.0,1440.0,-3200.0,2016.0)
set F8=Rect(-2112.0,3424.0,-1856.0,3744.0)
set G8=Rect(-2400.0,640.0,-2208.0,896.0)
set H8=Rect(-3392.0,640.0,-3200.0,896.0)
set Z8=Rect(-3744.0,-1024.0,-3232.0,384.0)
set V8=Rect(-2016.0,-5504.0,-1664.0,-4768.0)
set W8=Rect(-1760.0,-5248.0,-1312.0,-4800.0)
set X8=Rect(896.0,-3328.0,1088.0,-3072.0)
set Y8=Rect(2368.0,-3808.0,2688.0,-3360.0)
set J8=Rect(1952.0,-3744.0,2208.0,-3456.0)
set K8=Rect(-768.0,-1344.0,-480.0,-1024.0)
set L8=Rect(1152.0,-6560.0,1376.0,-6272.0)
set M8=Rect(1216.0,-6368.0,1504.0,-6176.0)
set N8=Rect(-1376.0,-6784.0,-1184.0,-6528.0)
set S8=Rect(7616.0,-6528.0,8192.0,8160.0)
set T8=Rect(7072.0,-2304.0,7264.0,-2048.0)
set R8=Rect(-7872.0,7872.0,8192.0,8192.0)
set P8=Rect(1792.0,7776.0,2112.0,8192.0)
set Q8=Rect(-2656.0,0.0,-2496.0,256.0)
set U8=Rect(-768.0,7232.0,-416.0,7424.0)
set I9=Rect(-7968.0,5472.0,-7648.0,5792.0)
set O9=Rect(1120.0,7904.0,1312.0,8160.0)
set A9=Rect(736.0,4480.0,1120.0,4800.0)
set B9=Rect(2208.0,4928.0,2400.0,5152.0)
set C9=Rect(576.0,4384.0,1120.0,4928.0)
set D9=Rect(2560.0,4160.0,2784.0,4576.0)
set E9=Rect(-5984.0,-3776.0,-5504.0,-3232.0)
set F9=Rect(576.0,4256.0,1024.0,4672.0)
set G9=Rect(544.0,4352.0,992.0,4768.0)
set H9=Rect(704.0,2496.0,1376.0,2784.0)
set Z9=Rect(-2240.0,1792.0,-1856.0,2240.0)
set V9=Rect(-1472.0,1472.0,-992.0,1728.0)
set W9=Rect(2368.0,-3200.0,2656.0,-2880.0)
set X9=Rect(2624.0,-3584.0,2816.0,-2848.0)
set Y9=Rect(2464.0,-3392.0,2656.0,-3136.0)
set J9=Rect(2784.0,-3232.0,2976.0,-2976.0)
set K9=Rect(2784.0,-3424.0,2976.0,-3168.0)
set L9=Rect(7328.0,7808.0,8192.0,8192.0)
set M9=Rect(1984.0,7584.0,3296.0,8192.0)
set N9=Rect(2240.0,7392.0,2560.0,8192.0)
set S9=Rect(-1888.0,416.0,-1696.0,576.0)
set T9=Rect(7776.0,2720.0,8192.0,3648.0)
set R9=Rect(5280.0,640.0,5664.0,1184.0)
set P9=Rect(-3104.0,2720.0,-2624.0,3232.0)
set Q9=Rect(7584.0,-7072.0,7776.0,-6880.0)
set Y8=Rect(2816.0,-3488.0,3008.0,-3232.0)
set J8=Rect(1568.0,-2976.0,1760.0,-2656.0)
set W9=Rect(2368.0,-3264.0,2656.0,-2944.0)
set X9=Rect(2624.0,-3648.0,2816.0,-2912.0)
set Y9=Rect(2464.0,-3456.0,2656.0,-3200.0)
set B7=Rect(-8192.0,-8128.0,5472.0,-7648.0)
set U9=Rect(-8192.0,-3712.0,-7008.0,-2144.0)
set IA=Rect(-3360.0,-8192.0,-1472.0,-7648.0)
set OA=Rect(-2528.0,-7840.0,-1696.0,-7488.0)
set BA=Rect(-2336.0,-7584.0,-1600.0,-7456.0)
set CA=Rect(-8192.0,2016.0,-6816.0,2880.0)
set DA=Rect(6880.0,-3328.0,8000.0,-2624.0)
set EA=Rect(-7520.0,-7040.0,-7360.0,-6912.0)
set FA=Rect(-7520.0,-6912.0,-7360.0,-6784.0)
set GA=Rect(-7520.0,-6656.0,-7360.0,-6528.0)
set HA=Rect(-7520.0,-6528.0,-7360.0,-6400.0)
set ZA=Rect(-7520.0,-6784.0,-7360.0,-6656.0)
set VA=Rect(6944.0,6208.0,7104.0,6336.0)
set WA=Rect(6944.0,6080.0,7104.0,6208.0)
set XA=Rect(6944.0,5952.0,7104.0,6080.0)
set YA=Rect(6944.0,5824.0,7104.0,5952.0)
set JA=Rect(6944.0,5696.0,7104.0,5824.0)
set KA=Rect(3904.0,2976.0,4160.0,3264.0)
set LA=Rect(2336.0,5952.0,2592.0,6240.0)
set MA=Rect(6304.0,1984.0,6560.0,2272.0)
set NA=Rect(-3328.0,-6912.0,-3072.0,-6624.0)
set SA=Rect(-4384.0,-4800.0,-4128.0,-4512.0)
set TA=Rect(-6432.0,-3840.0,-6176.0,-3552.0)
set RA=Rect(-7584.0,6176.0,-6304.0,7552.0)
set PA=Rect(3616.0,-2656.0,3968.0,-2080.0)
set QA=Rect(4000.0,-2592.0,4416.0,-2016.0)
set UA=Rect(-1088.0,5376.0,768.0,6624.0)
set IB=Rect(1600.0,1024.0,3456.0,2432.0)
set OB=Rect(5504.0,-1056.0,7200.0,512.0)
set AB=Rect(-6944.0,-1792.0,-5248.0,-224.0)
set BB=Rect(-1536.0,-7424.0,640.0,-6048.0)
set CB=Rect(-3328.0,-7200.0,-2464.0,-6368.0)
set DB=Rect(-4288.0,-4544.0,-3424.0,-3712.0)
set EB=Rect(-6784.0,-3616.0,-5920.0,-2784.0)
set FB=Rect(1472.0,5440.0,2336.0,6272.0)
set GB=Rect(2656.0,2336.0,3520.0,3168.0)
set HB=Rect(5984.0,1152.0,6848.0,1984.0)
set ZB=Rect(-4128.0,-3712.0,-2496.0,-2272.0)
set VB=Rect(-8192.0,-8128.0,-5120.0,-5536.0)
set WB=Rect(4608.0,4352.0,8192.0,8192.0)
set XB=Rect(-8096.0,-7104.0,-8064.0,-7072.0)
set YB=Rect(-8096.0,-7104.0,-8064.0,-7072.0)
set JB=Rect(-8096.0,-7104.0,-8064.0,-7072.0)
set E9=Rect(6208.0,7488.0,8192.0,8192.0)
set KB=Rect(-2784.0,1280.0,-1952.0,2048.0)
set LB=Rect(2528.0,-3168.0,3360.0,-2464.0)
set MB=Rect(-3936.0,4480.0,-3136.0,5120.0)
set SB=Rect(3680.0,-6016.0,4416.0,-5376.0)
set TB=Rect(3424.0,-352.0,4224.0,320.0)
set RB=Rect(-4608.0,-448.0,-3872.0,192.0)
set PB=Rect(3456.0,-2624.0,4384.0,-2112.0)
set QB=Rect(608.0,4320.0,1120.0,4768.0)
set IC=Rect(-3840.0,1440.0,-3328.0,1888.0)
set OC=Rect(2400.0,-3360.0,2912.0,-2912.0)
set AC=Rect(-1888.0,-5280.0,-1376.0,-4832.0)
set p=Player(15)
set WY=CreateUnit(p,'u00Z',7360.0,-4416.0,270.000)
call SetUnitColor(WY,ConvertPlayerColor(12))
set VY=CreateUnit(p,'u00Z',-7296.0,4224.0,270.000)
call SetUnitColor(VY,ConvertPlayerColor(12))
set NZ=CreateUnit(p,'n0EO',-7168.0,6464.0,270.000)
call SetUnitColor(NZ,ConvertPlayerColor(0))
set TZ=CreateUnit(p,'n01F',-7424.0,-6976.0,270.000)
set LZ=CreateUnit(p,'n0EO',-7360.0,6464.0,270.000)
call SetUnitColor(LZ,ConvertPlayerColor(0))
set RZ=CreateUnit(p,'n01F',-7424.0,-6592.0,270.000)
set PZ=CreateUnit(p,'n01F',-7424.0,-6464.0,270.000)
set VX=CreateUnit(p,'n0EO',-7360.0,6784.0,270.000)
call SetUnitColor(VX,ConvertPlayerColor(0))
set HX=CreateUnit(p,'n0EO',-6848.0,6784.0,270.000)
call SetUnitColor(HX,ConvertPlayerColor(0))
set QZ=CreateUnit(p,'n01F',-7424.0,-6720.0,270.000)
set UZ=CreateUnit(p,'n01F',-7424.0,-6848.0,270.000)
set IV=CreateUnit(p,'nfoh',-7296.0,-7200.0,270.000)
set u=CreateUnit(p,'uC74',3200.0,-64.0,270.000)
set IZ=CreateUnit(p,'n0EO',-6848.0,6464.0,270.000)
call SetUnitColor(IZ,ConvertPlayerColor(0))
set BX=CreateUnit(p,'n01F',7040.0,6272.0,270.000)
set CX=CreateUnit(p,'n01F',7040.0,5888.0,270.000)
set DX=CreateUnit(p,'n01F',7040.0,5760.0,270.000)
set EX=CreateUnit(p,'n01F',7040.0,6016.0,270.000)
set AX=CreateUnit(p,'n01F',7040.0,6144.0,270.000)
set GX=CreateUnit(p,'ndfl',6784.0,6368.0,270.000)
set EZ=CreateUnit(p,'n0EO',-7360.0,7104.0,270.000)
call SetUnitColor(EZ,ConvertPlayerColor(0))
set ZX=CreateUnit(p,'n0EO',-7168.0,7104.0,270.000)
call SetUnitColor(ZX,ConvertPlayerColor(0))
set u=CreateUnit(p,'uC74',-4544.0,1152.0,270.000)
set MZ=CreateUnit(p,'n0EO',-7168.0,6784.0,270.000)
call SetUnitColor(MZ,ConvertPlayerColor(0))
set HY=CreateUnit(p,'n0EO',-6848.0,7104.0,270.000)
call SetUnitColor(HY,ConvertPlayerColor(0))
set KZ=CreateUnit(p,'u010',-7296.0,4416.0,270.000)
call SetUnitColor(KZ,ConvertPlayerColor(12))
set XY=CreateUnit(p,'u010',7360.0,-4224.0,270.000)
call SetUnitColor(XY,ConvertPlayerColor(12))
set JY=CreateUnit(p,'n0EO',-6656.0,7104.0,270.000)
call SetUnitColor(JY,ConvertPlayerColor(0))
set KY=CreateUnit(p,'n0EO',-6656.0,6464.0,270.000)
call SetUnitColor(KY,ConvertPlayerColor(0))
set YY=CreateUnit(p,'n0EO',-6656.0,6784.0,270.000)
call SetUnitColor(YY,ConvertPlayerColor(0))
set p=Player(0)
set OV=CreateUnit(p,'nC38',-7264.0,-6944.0,270.000)
call SetUnitColor(OV,ConvertPlayerColor(12))
set AV=CreateUnit(p,'n01K',-7264.0,-6752.0,270.000)
call SetUnitColor(AV,ConvertPlayerColor(12))
set DV=CreateUnit(p,'n009',-6624.0,-6560.0,270.000)
call SetUnitColor(DV,ConvertPlayerColor(12))
set VZ=CreateUnit(p,'n00X',-7136.0,-6496.0,270.000)
call SetUnitColor(VZ,ConvertPlayerColor(1))
set HZ=CreateUnit(p,'n00V',-6880.0,-6496.0,270.000)
call SetUnitColor(HZ,ConvertPlayerColor(12))
set FZ=CreateUnit(p,'n00W',-7264.0,-6560.0,270.000)
call SetUnitColor(FZ,ConvertPlayerColor(12))
set AZ=CreateUnit(p,'n002',-6752.0,-6496.0,270.000)
call SetUnitColor(AZ,ConvertPlayerColor(12))
set HW=CreateUnit(p,'e025',-6624.0,-7200.0,270.000)
set CV=CreateUnit(p,'hC95',-6944.0,-7200.0,270.000)
call SetUnitColor(CV,ConvertPlayerColor(0))
set UH=CreateUnit(p,'etol',-5632.0,-6144.0,270.000)
set VV=CreateUnit(p,'e00S',-4448.0,-4960.0,270.000)
set XV=CreateUnit(p,'e00S',-5280.0,-6112.0,270.000)
set VW=CreateUnit(p,'edob',-6400.0,-5696.0,270.000)
set WV=CreateUnit(p,'e00S',-6368.0,-4256.0,270.000)
set YV=CreateUnit(p,'e00S',-5600.0,-5728.0,270.000)
set JV=CreateUnit(p,'eaom',-6080.0,-4480.0,270.000)
set KV=CreateUnit(p,'eaoe',-6656.0,-4480.0,270.000)
set MV=CreateUnit(p,'eaom',-4416.0,-5312.0,270.000)
set TV=CreateUnit(p,'eaoe',-4864.0,-4992.0,270.000)
set NV=CreateUnit(p,'e00S',-3744.0,-6816.0,270.000)
set LV=CreateUnit(p,'eaom',-4032.0,-7040.0,270.000)
set SV=CreateUnit(p,'eaoe',-4032.0,-6528.0,270.000)
set UV=CreateUnit(p,'emow',-5792.0,-5408.0,270.000)
set QV=CreateUnit(p,'emow',-6624.0,-5088.0,270.000)
set PV=CreateUnit(p,'emow',-5088.0,-5536.0,270.000)
set IW=CreateUnit(p,'emow',-5344.0,-3936.0,270.000)
set OW=CreateUnit(p,'emow',-5088.0,-4576.0,270.000)
set AW=CreateUnit(p,'emow',-3936.0,-5344.0,270.000)
set BW=CreateUnit(p,'emow',-4512.0,-7072.0,270.000)
set CW=CreateUnit(p,'emow',-4896.0,-6240.0,270.000)
set DW=CreateUnit(p,'emow',-3808.0,-5856.0,270.000)
set EW=CreateUnit(p,'emow',-5472.0,-4704.0,270.000)
set FW=CreateUnit(p,'emow',-4512.0,-5856.0,270.000)
set GW=CreateUnit(p,'eaow',-4544.0,-6528.0,270.000)
set ZV=CreateUnit(p,'e00S',-6112.0,-1248.0,270.000)
set BV=CreateUnit(p,'eaow',-6080.0,-5120.0,270.000)
set HV=CreateUnit(p,'e00S',-6112.0,1568.0,270.000)
set GV=CreateUnit(p,'e00S',-1504.0,-1824.0,270.000)
set FV=CreateUnit(p,'e00S',-544.0,-6688.0,270.000)
set EV=CreateUnit(p,'e00S',4960.0,-6752.0,270.000)
set WZ=CreateUnit(p,'e00S',-3488.0,-3296.0,270.000)
set ZW=CreateUnit(p,'edob',-5248.0,-6848.0,270.000)
set ZY=CreateUnit(p,'n0HE',-7008.0,-6496.0,270.000)
call SetUnitColor(ZY,ConvertPlayerColor(12))
set p=Player(6)
set MW=CreateUnit(p,'n002',5984.0,6112.0,270.000)
call SetUnitColor(MW,ConvertPlayerColor(12))
set SW=CreateUnit(p,'n00W',6048.0,6624.0,270.000)
call SetUnitColor(SW,ConvertPlayerColor(12))
set TW=CreateUnit(p,'n00V',5984.0,6240.0,270.000)
call SetUnitColor(TW,ConvertPlayerColor(12))
set RW=CreateUnit(p,'n00X',5984.0,6496.0,270.000)
call SetUnitColor(RW,ConvertPlayerColor(1))
set OX=CreateUnit(p,'nC38',6560.0,6624.0,270.000)
call SetUnitColor(OX,ConvertPlayerColor(12))
set IX=CreateUnit(p,'n01K',6368.0,6624.0,270.000)
call SetUnitColor(IX,ConvertPlayerColor(12))
set WX=CreateUnit(p,'usep',4352.0,3584.0,270.000)
set QW=CreateUnit(p,'n009',6048.0,5984.0,270.000)
call SetUnitColor(QW,ConvertPlayerColor(12))
set UW=CreateUnit(p,'nC35',6816.0,5984.0,270.000)
call SetUnitColor(UW,ConvertPlayerColor(12))
set PW=CreateUnit(p,'u00Q',6816.0,5664.0,270.000)
set YZ=CreateUnit(p,'u00M',6240.0,-2080.0,270.000)
set XZ=CreateUnit(p,'u00D',6304.0,-96.0,270.000)
set RX=CreateUnit(p,'uzig',4384.0,4256.0,270.000)
set KX=CreateUnit(p,'unpl',5184.0,4864.0,270.000)
set LX=CreateUnit(p,'utod',3904.0,3904.0,270.000)
set MX=CreateUnit(p,'u00M',1056.0,-96.0,270.000)
set NX=CreateUnit(p,'u00D',2528.0,1824.0,270.000)
set SX=CreateUnit(p,'u00N',3936.0,3488.0,270.000)
set TX=CreateUnit(p,'u00T',4832.0,4832.0,270.000)
set XX=CreateUnit(p,'u00T',5152.0,4512.0,270.000)
set PX=CreateUnit(p,'uzig',3168.0,4064.0,270.000)
set QX=CreateUnit(p,'uzig',5728.0,4000.0,270.000)
set LW=CreateUnit(p,'u00N',2976.0,5792.0,270.000)
set KW=CreateUnit(p,'usep',3392.0,5504.0,270.000)
set JW=CreateUnit(p,'utod',3392.0,6080.0,270.000)
set YW=CreateUnit(p,'uzig',4128.0,6240.0,270.000)
set XW=CreateUnit(p,'usap',3968.0,5888.0,270.000)
set UX=CreateUnit(p,'ubon',4992.0,5952.0,270.000)
set IY=CreateUnit(p,'uzig',2656.0,4704.0,270.000)
set OY=CreateUnit(p,'uzig',5536.0,2464.0,270.000)
set AY=CreateUnit(p,'uzig',4064.0,5280.0,270.000)
set BY=CreateUnit(p,'uzig',3488.0,4832.0,270.000)
set CY=CreateUnit(p,'usap',6400.0,3584.0,270.000)
set DY=CreateUnit(p,'utod',6080.0,2944.0,270.000)
set EY=CreateUnit(p,'usep',6656.0,2880.0,270.000)
set FY=CreateUnit(p,'u00N',6368.0,2528.0,270.000)
set GY=CreateUnit(p,'uzig',5024.0,3744.0,270.000)
set WW=CreateUnit(p,'uzig',6880.0,3936.0,270.000)
set JX=CreateUnit(p,'ubon',6464.0,4608.0,270.000)
set YX=CreateUnit(p,'uzig',4640.0,2848.0,270.000)
set GZ=CreateUnit(p,'u00M',-4704.0,5920.0,270.000)
set SZ=CreateUnit(p,'u00D',32.0,5920.0,270.000)
set JZ=CreateUnit(p,'n0HE',5984.0,6368.0,270.000)
call SetUnitColor(JZ,ConvertPlayerColor(12))
set p=Player(15)
set BZ=CreateUnit(p,'e00D',-6005.1,5458.6,212.150)
set ZZ=CreateUnit(p,'e00B',-561.7,-651.7,325.600)
set DZ=CreateUnit(p,'e00A',5901.5,-6198.9,64.000)
set CZ=CreateUnit(p,'e008',-5467.9,-5891.1,307.304)
set OZ=CreateUnit(p,'e001',4901.8,4536.6,212.110)
call ConfigureNeutralVictim()
set M2I=Filter(function MJI)
set filterIssueHauntOrderAtLocBJ=Filter(function IssueHauntOrderAtLocBJFilter)
set filterEnumDestructablesInCircleBJ=Filter(function MBI)
set filterGetUnitsInRectOfPlayer=Filter(function GetUnitsInRectOfPlayerFilter)
set filterGetUnitsOfTypeIdAll=Filter(function GetUnitsOfTypeIdAllFilter)
set filterGetUnitsOfPlayerAndTypeId=Filter(function GetUnitsOfPlayerAndTypeIdFilter)
set filterMeleeTrainedUnitIsHeroBJ=Filter(function MeleeTrainedUnitIsHeroBJFilter)
set filterLivingPlayerUnitsOfTypeId=Filter(function LivingPlayerUnitsOfTypeIdFilter)
set MLI=0
loop
exitwhen MLI==16
set bj_FORCE_PLAYER[MLI]=CreateForce()
call ForceAddPlayer(bj_FORCE_PLAYER[MLI],Player(MLI))
set MLI=MLI+1
endloop
set bj_FORCE_ALL_PLAYERS=CreateForce()
call ForceEnumPlayers(bj_FORCE_ALL_PLAYERS,null)
set bj_cineModePriorSpeed=GetGameSpeed()
set bj_cineModePriorFogSetting=IsFogEnabled()
set bj_cineModePriorMaskSetting=IsFogMaskEnabled()
set MLI=0
loop
exitwhen MLI>=bj_MAX_QUEUED_TRIGGERS
set bj_queuedExecTriggers[MLI]=null
set bj_queuedExecUseConds[MLI]=false
set MLI=MLI+1
endloop
set bj_isSinglePlayer=false
set MMI=0
set MLI=0
loop
exitwhen MLI>=12
if(GetPlayerController(Player(MLI))==MAP_CONTROL_USER and GetPlayerSlotState(Player(MLI))==PLAYER_SLOT_STATE_PLAYING)then
set MMI=MMI+1
endif
set MLI=MLI+1
endloop
set bj_isSinglePlayer=(MMI==1)
set bj_rescueSound=CreateSoundFromLabel("Rescue",false,false,false,10000,10000)
set bj_questDiscoveredSound=CreateSoundFromLabel("QuestNew",false,false,false,10000,10000)
set bj_questUpdatedSound=CreateSoundFromLabel("QuestUpdate",false,false,false,10000,10000)
set bj_questCompletedSound=CreateSoundFromLabel("QuestCompleted",false,false,false,10000,10000)
set bj_questFailedSound=CreateSoundFromLabel("QuestFailed",false,false,false,10000,10000)
set bj_questHintSound=CreateSoundFromLabel("Hint",false,false,false,10000,10000)
set bj_questSecretSound=CreateSoundFromLabel("SecretFound",false,false,false,10000,10000)
set bj_questItemAcquiredSound=CreateSoundFromLabel("ItemReward",false,false,false,10000,10000)
set bj_questWarningSound=CreateSoundFromLabel("Warning",false,false,false,10000,10000)
set bj_victoryDialogSound=CreateSoundFromLabel("QuestCompleted",false,false,false,10000,10000)
set bj_defeatDialogSound=CreateSoundFromLabel("QuestFailed",false,false,false,10000,10000)
call DelayedSuspendDecayCreate()
set v=VersionGet()
if(v==VERSION_REIGN_OF_CHAOS)then
set bj_MELEE_MAX_TWINKED_HEROES=bj_MELEE_MAX_TWINKED_HEROES_V0
else
set bj_MELEE_MAX_TWINKED_HEROES=bj_MELEE_MAX_TWINKED_HEROES_V1
endif
call InitQueuedTriggers()
call InitRescuableBehaviorBJ()
call InitDNCSounds()
call InitMapRects()
call InitSummonableCaps()
set MGI=0
loop
set bj_stockAllowedPermanent[MGI]=false
set bj_stockAllowedCharged[MGI]=false
set bj_stockAllowedArtifact[MGI]=false
set MGI=MGI+1
exitwhen MGI>10
endloop
call SetAllItemTypeSlots(11)
call SetAllUnitTypeSlots(11)
set bj_stockUpdateTimer=CreateTimer()
call TimerStart(bj_stockUpdateTimer,bj_STOCK_RESTOCK_INITIAL_DELAY,false,function MXI)
set bj_stockItemPurchased=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(bj_stockItemPurchased,Player(15),EVENT_PLAYER_UNIT_SELL_ITEM,null)
call TriggerAddAction(bj_stockItemPurchased,function RemovePurchasedItem)
call DetectGameStarted()
set i=0
set i=0
loop
exitwhen(i>16)
set T[i]=0
set P[i]=0
set Q[i]=0
set V0[i]=0
set i=i+1
endloop
set i=0
loop
exitwhen(i>100)
set R[i]=false
set H1[i]=0
set Z1[i]=0
set V1[i]=0
set W1[i]=0
set Y1[i]=0
set J1[i]=0
set VO[i]=0
set i=i+1
endloop
set i=0
loop
exitwhen(i>4)
set I0[i]=0
set i=i+1
endloop
set i=0
loop
exitwhen(i>2)
set A0[i]=false
set W0[i]=0
set T1[i]=0
set i=i+1
endloop
set i=0
loop
exitwhen(i>12)
set C0[i]=""
set E0[i]=CreateTimer()
set i=i+1
endloop
set i=0
loop
exitwhen(i>13)
set D0[i]=false
set F0[i]=CreateTimer()
set S0[i]=false
set IO[i]=0
set F3[i]=false
set i=i+1
endloop
set i=0
loop
exitwhen(i>1)
set G0[i]=0
set M2[i]=""
set S2[i]=false
set T2[i]=0
set E3[i]=false
set i=i+1
endloop
set T0=150
set EI=true
set FI=true
set GI=true
set HI=true
set ZI=true
set VI=true
set WI=true
set XI=true
set YI=true
set JI=true
set KI=true
set LI=true
set NI=3
set SI=1
set X1=80
set i=0
loop
exitwhen(i>17)
set K1[i]=null
set i=i+1
endloop
set i=0
loop
exitwhen(i>40)
set R1[i]=0
set P1[i]=0
set Q1[i]=0
set i=i+1
endloop
set OO=CreateForce()
set AO=CreateForce()
set B2=CreateGroup()
set X2=CreateTimer()
set P2=CreateForce()
set U2=0.00
set O3=true
set A3=true
set i=0
loop
exitwhen(i>14)
set C3[i]=false
set i=i+1
endloop
set i=0
loop
exitwhen(i>15)
set K3[i]="Here"
set i=i+1
endloop
call NOI()
call NQI()
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15,true)
call TriggerAddCondition(t,Condition(function S1I))
set t=null
set HJ[0]=false
set HJ[1]=false
set HJ[2]=false
set HJ[3]=false
set HJ[4]=false
set HJ[5]=false
set HJ[6]=false
set HJ[7]=false
set HJ[8]=false
set HJ[9]=false
set HJ[10]=false
set HJ[11]=false
set HJ[12]=false
set HJ[13]=false
set HJ[14]=false
set HJ[15]=false
set HJ[16]=false
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function B11))
set t=null
set YN=CreateRegion()
call RegionAddRect(YN,G5)
set KN=CreateRegion()
call RegionAddRect(KN,H5)
set XN=CreateRegion()
call RegionAddRect(XN,O6)
call RegionAddRect(XN,A6)
call RegionAddRect(XN,B6)
set JN=CreateRegion()
call RegionAddRect(JN,C6)
call RegionAddRect(JN,D6)
call RegionAddRect(JN,E6)
set LN=CreateRegion()
call RegionAddRect(LN,F6)
call RegionAddRect(LN,G6)
call RegionAddRect(LN,H6)
call RegionAddRect(LN,Z6)
call RegionAddRect(LN,V6)
call RegionAddRect(LN,W6)
call RegionAddRect(LN,X6)
call RegionAddRect(LN,Y6)
call RegionAddRect(LN,J6)
call RegionAddRect(LN,K6)
call RegionAddRect(LN,L6)
call RegionAddRect(LN,M6)
call RegionAddRect(LN,N6)
call RegionAddRect(LN,S6)
call RegionAddRect(LN,T6)
call RegionAddRect(LN,R6)
call RegionAddRect(LN,P6)
call RegionAddRect(LN,Q6)
call RegionAddRect(LN,U6)
call RegionAddRect(LN,I7)
call RegionAddRect(LN,O7)
call RegionAddRect(LN,A7)
call RegionAddRect(LN,B7)
call RegionAddRect(LN,C7)
call RegionAddRect(LN,D7)
call RegionAddRect(LN,E7)
call RegionAddRect(LN,F7)
call RegionAddRect(LN,G7)
call RegionAddRect(LN,H7)
call RegionAddRect(LN,Z7)
call RegionAddRect(LN,V7)
call RegionAddRect(LN,W7)
call RegionAddRect(LN,X7)
call RegionAddRect(LN,Y7)
call RegionAddRect(LN,J7)
call RegionAddRect(LN,K7)
call RegionAddRect(LN,L7)
call RegionAddRect(LN,M7)
call RegionAddRect(LN,N7)
call RegionAddRect(LN,S7)
call RegionAddRect(LN,T7)
call RegionAddRect(LN,R7)
call RegionAddRect(LN,P7)
call RegionAddRect(LN,Q7)
call RegionAddRect(LN,U7)
call RegionAddRect(LN,I8)
call RegionAddRect(LN,O8)
call RegionAddRect(LN,A8)
call RegionAddRect(LN,B8)
call RegionAddRect(LN,C8)
call RegionAddRect(LN,D8)
call RegionAddRect(LN,E8)
call RegionAddRect(LN,F8)
call RegionAddRect(LN,G8)
call RegionAddRect(LN,H8)
call RegionAddRect(LN,Z8)
call RegionAddRect(LN,V8)
call RegionAddRect(LN,W8)
call RegionAddRect(LN,X8)
call RegionAddRect(LN,Y8)
call RegionAddRect(LN,J8)
call RegionAddRect(LN,K8)
call RegionAddRect(LN,L8)
call RegionAddRect(LN,M8)
call RegionAddRect(LN,N8)
call RegionAddRect(LN,S8)
call RegionAddRect(LN,T8)
call RegionAddRect(LN,R8)
call RegionAddRect(LN,P8)
call RegionAddRect(LN,Q8)
call RegionAddRect(LN,U8)
call RegionAddRect(LN,I9)
call RegionAddRect(LN,O9)
call RegionAddRect(LN,A9)
call RegionAddRect(LN,B9)
call RegionAddRect(LN,C9)
call RegionAddRect(LN,D9)
call RegionAddRect(LN,E9)
call RegionAddRect(LN,F9)
call RegionAddRect(LN,G9)
call RegionAddRect(LN,H9)
call RegionAddRect(LN,Z9)
call RegionAddRect(LN,V9)
call RegionAddRect(LN,W9)
call RegionAddRect(LN,X9)
call RegionAddRect(LN,Y9)
call RegionAddRect(LN,J9)
call RegionAddRect(LN,K9)
call RegionAddRect(LN,L9)
call RegionAddRect(LN,M9)
call RegionAddRect(LN,N9)
call RegionAddRect(LN,S9)
call RegionAddRect(LN,T9)
call RegionAddRect(LN,R9)
call RegionAddRect(LN,P9)
set MN=CreateRegion()
call RegionAddRect(MN,QB)
call RegionAddRect(MN,IC)
call RegionAddRect(MN,OC)
call RegionAddRect(MN,AC)
call EI1('B06Z')
call EI1('BPSE')
call EI1('B06Q')
call EI1('BSTN')
call EI1('BHtc')
call EI1('B0BM')
call EI1('B0BR')
call EI1('B0C1')
call EI1('BEer')
call EI1('B02U')
call EI1('B07E')
call EI1('B0CF')
call EI1('B06M')
call EI1('B07N')
call EI1('B08S')
call EI1('B00Q')
call EI1('B072')
call EI1('BUan')
call EI1('B095')
call EI1('B083')
call EI1('B02V')
call EI1('B01Y')
call EI1('BNab')
call EI1('B08R')
call EI1('B066')
call EI1('B03I')
call EI1('B063')
call EI1('Bena')
call EI1('Beng')
call EI1('B03C')
call EI1('B00L')
call EI1('BHca')
call EI1('Bcsd')
call EI1('B079')
call EI1('B0BQ')
call EI1('B0B9')
call EI1('Bprg')
call EI1('B08M')
call EI1('B02G')
call EI1('B01X')
call EI1('B01D')
call EI1('B092')
call EI1('B0AQ')
call EI1('BEsh')
call EI1('B017')
call EI1('B0AE')
call EI1('B0AD')
call EI1('B08O')
call EI1('Bfro')
call EI1('B027')
call EI1('B028')
call EI1('B05H')
call EI1('B0BS')
call EI1('Bcri')
call EI1('B0BF')
call EI1('B0BE')
call EI1('B090')
call EI1('B008')
call EI1('B04B')
call EI1('B02F')
call EI1('BUsp')
call EI1('Bust')
call EI1('B0CC')
call EI1('BCri')
call EI1('B03J')
call EI1('BEsh')
call EI1('B0AQ')
call EI1('Bena')
call EI1('Beng')
call EI1('B078')
call EI1('Bdet')
call EI1('B00T')
call EI1('Bslo')
call EI1('BNdh')
call EI1('B0C8')
call EI1('B08O')
call EI1('B07V')
call EI1('B07U')
call EI1('B01X')
call EI1('BNsi')
call EI1('B031')
call EI1('BNso')
call EI1('B00P')
call EI1('B02M')
call EI1('A1LD')
call EI1('B0CD')
call EI1('A1JA')
call EI1('B043')
call EI1('BNpa')
call EI1('B01N')
call EI1('BIcb')
call EI1('B04Q')
call EI1('B00C')
call EI1('B09K')
call EI1('B033')
call EI1('B08F')
call EI1('B08E')
call EI1('Bpoi')
call EI1('B0AM')
call EI1('BNrd')
call EI1('B00H')
call EI1('BOhx')
call EI1('B03F')
call EI1('B02N')
call EI1('B0E7')
call EI1('B06D')
call EI1('B0BN')
call EI1('B09Q')
call EI1('B0DI')
call EI1('B0BB')
call EI1('B09J')
call EI1('B0AF')
call EI1('B08B')
call EI1('B071')
call EI1('B08N')
call EI1('B02I')
call EI1('B08Q')
call EI1('B0C2')
call EI1('B06S')
call EI1('B02S')
call EI1('B02W')
call EI1('B05Q')
call EI1('B02D')
call EI1('B0BY')
call EI1('B02P')
call EI1('B05F')
call EI1('B0EP')
call EI1('B0ER')
call EI1('B0ET')
call EI1('B0FN')
call EI1('B0FY')
call EI1('B0FT')
call EI1('B0FZ')
call EI1('B0G0')
call EI1('B0GT')
call EI1('B0F5')
call EI1('A1W3')
call EI1('B0DO')
call EI1('B02U')
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function E51))
set t=null
call FlushGameCache(InitGameCache("dr.x"))
set OS=InitGameCache("dr.x")
set BS[0]='A17F'
set BS[1]='A17G'
set BS[2]='A17H'
set BS[3]='A17C'
set BS[4]='A17D'
set BS[5]='A17E'
set BS[6]='A17J'
set BS[7]='A17I'
set BS[8]='A17L'
set CS[0]='A2XY'
set CS[1]='A2XX'
set CS[2]='A2XW'
set CS[3]='A2XV'
set CS[4]='A2Y2'
set CS[5]='A2Y0'
set CS[6]='A2Y1'
set CS[7]='A2XZ'
set CS[8]='A2Y3'
set DS[0]='A1QE'
set DS[1]='A1QF'
set DS[2]='A1QI'
set DS[3]='A1QK'
set DS[4]='A1QJ'
set DS[5]='A1QH'
set DS[6]='A1QO'
set DS[7]='A1QN'
set DS[8]='A1QM'
set DS[9]='A1QG'
set DS[10]='A1QQ'
set ES[0]='A1GK'
set ES[1]='A1GL'
set ES[2]='A1GJ'
set ES[3]='A1GP'
set ES[4]='A1GM'
set ES[5]='A1GN'
set ES[6]='A1GO'
set ES[7]='A1GI'
set ES[8]='A1GQ'
set FS[0]='A1CM'
set FS[1]='A1CK'
set FS[2]='A1CF'
set FS[3]='A1CI'
set FS[4]='A1CG'
set FS[5]='A1CH'
set HS=CreateTrigger()
call TriggerAddCondition(HS,Condition(function GL1))
set ZS[0]='h09G'
set WS[0]=50
set ZS[1]='h09T'
set WS[1]=100
set ZS[2]='h09F'
set WS[2]=150
set ZS[3]='h09H'
set WS[3]=200
set ZS[4]='h09E'
set WS[4]=250
set ZS[5]='h09D'
set WS[5]=300
set ZS[6]='h09C'
set WS[6]=350
set ZS[7]='h09B'
set WS[7]=400
set ZS[8]='h099'
set WS[8]=450
set ZS[9]='h09A'
set WS[9]=500
set ZS[10]='h09J'
set WS[10]=550
set ZS[11]='h09K'
set WS[11]=600
set ZS[12]='h09L'
set WS[12]=650
set ZS[13]='h09M'
set WS[13]=700
set ZS[14]='h09N'
set WS[14]=750
set ZS[15]='h09O'
set WS[15]=800
set ZS[16]='h09P'
set WS[16]=850
set ZS[17]='h09Q'
set WS[17]=900
set ZS[18]='h09R'
set WS[18]=950
set ZS[19]='h09S'
set WS[19]=1000
set ZS[20]='h09I'
set WS[20]=1050
set ZS[21]='h09Z'
set WS[21]=1100
set ZS[22]='h09X'
set WS[22]=1150
set ZS[23]='h0A1'
set WS[23]=1200
set ZS[24]='h0A2'
set WS[24]=1250
set ZS[25]='h0A6'
set WS[25]=1300
set ZS[26]='h0A3'
set WS[26]=1350
set ZS[27]='h0A4'
set WS[27]=1400
set ZS[28]='h09Y'
set WS[28]=1450
set ZS[29]='h09V'
set WS[29]=1500
set ZS[30]='h0A0'
set WS[30]=1550
set ZS[31]='h09U'
set WS[31]=1600
set ZS[32]='h0AF'
set WS[32]=1650
set ZS[33]='h0AD'
set WS[33]=1700
set ZS[34]='h0AE'
set WS[34]=1750
set ZS[35]='h0AC'
set WS[35]=1800
set ZS[36]='h0AB'
set WS[36]=1850
set ZS[37]='h0AA'
set WS[37]=1900
set ZS[38]='h0A9'
set WS[38]=1950
set ZS[39]='h0AG'
set WS[39]=2000
set ZS[40]='h0A7'
set WS[40]=2050
set ZS[41]='h0AO'
set WS[41]=2100
set ZS[42]='h0AY'
set WS[42]=2150
set ZS[43]='h0AH'
set WS[43]=2200
set ZS[44]='h0AI'
set WS[44]=2250
set ZS[45]='h0AJ'
set WS[45]=2300
set ZS[46]='h0AP'
set WS[46]=2350
set ZS[47]='h0AQ'
set WS[47]=2400
set ZS[48]='h0AK'
set WS[48]=2450
set ZS[49]='h0AR'
set WS[49]=2500
set ZS[50]='h0AL'
set WS[50]=2550
set ZS[51]='h0AS'
set WS[51]=2600
set ZS[52]='h09W'
set WS[52]=2650
set ZS[53]='h0AM'
set WS[53]=2700
set ZS[54]='h0A8'
set WS[54]=2750
set ZS[55]='h0AT'
set WS[55]=2800
set ZS[56]='h0AU'
set WS[56]=2850
set ZS[57]='h0AN'
set WS[57]=2900
set ZS[58]='h0AV'
set WS[58]=2950
set ZS[59]='h0AW'
set WS[59]=3000
set VS[0]=ZS[GV1(1)]
set VS[1]=ZS[GV1(1)]
set VS[2]=ZS[GV1(1)]
set VS[3]=ZS[GV1(1)]
set VS[4]=ZS[GV1(1)]
set VS[5]=ZS[GV1(1)]
set VS[6]=ZS[GV1(1)]
set VS[7]=ZS[GV1(1)]
set VS[8]=ZS[GV1(1)]
set VS[9]=ZS[GV1(1)]
set VS[10]=ZS[GV1(1)]
set VS[11]=ZS[GV1(1)]
set VS[12]=ZS[GV1(1)]
set VS[13]=ZS[GV1(1)]
set VS[14]=ZS[GV1(1)]
set XS[0]=false
set XS[1]=false
set XS[2]=false
set XS[3]=false
set XS[4]=false
set XS[5]=false
set XS[6]=false
set XS[7]=false
set XS[8]=false
set XS[9]=false
set XS[10]=false
set XS[11]=false
set XS[12]=false
set XS[13]=false
set XS[14]=false
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function H01))
set t=null
set LY=InitHashtable()
set M=CreateTimer()
set MS=Rect(-7040,-7680,7040,7168)
call SetFloatGameState(GAME_STATE_TIME_OF_DAY,6.00)
call SuspendTimeOfDay(false)
call SetTimeOfDayScale(0.5)
call SetSkyModel("Environment\\Sky\\FoggedSky\\FoggedSky.mdl")
call SetCreepCampFilterState(true)
set D3="Normal Mode"
call TimerStart(M,99999.00,false,null)
set V3=AddWeatherEffect(bj_mapInitialPlayableArea,'RAhr')
set Z3=AddWeatherEffect(bj_mapInitialPlayableArea,'SNbs')
set KS=AddWeatherEffect(bj_mapInitialPlayableArea,'LRma')
set LS=AddWeatherEffect(bj_mapInitialPlayableArea,'WOlw')
set BO[0]=Player(0)
set BO[1]=Player(1)
set BO[2]=Player(2)
set BO[3]=Player(3)
set BO[4]=Player(4)
set BO[5]=Player(5)
set CO[0]=Player(6)
set CO[1]=Player(7)
set CO[2]=Player(8)
set CO[3]=Player(9)
set CO[4]=Player(10)
set CO[5]=Player(11)
set DO=Player(12)
set EO=Player(15)
call SetUnitPathing(CZ,false)
call SetUnitPathing(DZ,false)
call SetUnitPathing(ZZ,false)
call SetUnitPathing(BZ,false)
call SetUnitPathing(OZ,false)
call BK1(OZ,true)
call BK1(BZ,true)
call BK1(ZZ,true)
call BK1(DZ,true)
call BK1(CZ,true)
set U0=GetUnitLoc(OZ)
set II=GetUnitLoc(CZ)
set BI=GetUnitLoc(ZZ)
set CI=GetUnitLoc(BZ)
set DI=GetUnitLoc(DZ)
set I2='A06G'
set O2[1]=II
set O2[2]=CI
set O2[3]=BI
set O2[4]=DI
set O2[5]=U0
set TI=GetRectCenter(M3)
set RI=GetRectCenter(N3)
set PI=GetRectCenter(L3)
set QI=GetRectCenter(U3)
set I1=GetRectCenter(I4)
set UI=GetRectCenter(Q3)
set O1=GetRectCenter(C4)
set B1=GetRectCenter(B4)
set A1=GetRectCenter(A4)
set C1=GetRectCenter(P3)
set E1=GetRectCenter(R3)
set D1=GetRectCenter(T3)
set F1=GetRectCenter(G4)
set G1=GetRectCenter(D4)
set J2=true
set QS=GetUnitX(IV)
set US=GetUnitY(IV)
set IT=GetUnitX(CV)
set OT=GetUnitY(CV)
set AT=GetUnitX(AV)
set BT=GetUnitY(AV)
set CT=GetUnitX(OV)
set DT=GetUnitY(OV)
set ET=GetUnitX(HW)
set FT=GetUnitY(HW)
set GT=GetUnitX(HZ)
set HT=GetUnitY(HZ)
set ZT=GetUnitX(FZ)
set VT=GetUnitY(FZ)
set WT=GetUnitX(AZ)
set XT=GetUnitY(AZ)
set YT=GetUnitX(VZ)
set JT=GetUnitY(VZ)
set KT=GetUnitX(DV)
set LT=GetUnitY(DV)
set KT=GetUnitX(DV)
set LT=GetUnitY(DV)
set MT=GetUnitX(ZY)
set ST=GetUnitY(ZY)
set RT=GetUnitX(UH)
set PT=GetUnitY(UH)
set QT=GetUnitX(HV)
set UT=GetUnitY(HV)
set IR=GetUnitX(GV)
set OR=GetUnitY(GV)
set BR=GetUnitX(EV)
set CR=GetUnitY(EV)
set DR=GetUnitX(ZV)
set GR=GetUnitY(ZV)
set HR=GetUnitX(WZ)
set ZR=GetUnitY(WZ)
set WR=GetUnitX(FV)
set XR=GetUnitY(FV)
set YR=GetUnitX(WV)
set JR=GetUnitY(WV)
set KR=GetUnitX(VV)
set LR=GetUnitY(VV)
set SR=GetUnitX(NV)
set RR=GetUnitY(NV)
set PR=GetUnitX(YV)
set QR=GetUnitY(YV)
set UR=GetUnitX(XV)
set IP=GetUnitY(XV)
set OP=GetUnitX(JV)
set BP=GetUnitY(JV)
set DP=GetUnitX(MV)
set EP=GetUnitY(MV)
set FP=GetUnitX(LV)
set GP=GetUnitY(LV)
set ZP=GetUnitX(KV)
set VP=GetUnitY(KV)
set WP=GetUnitX(TV)
set YP=GetUnitY(TV)
set JP=GetUnitX(SV)
set KP=GetUnitY(SV)
set LP=GetUnitX(UV)
set MP=GetUnitY(UV)
set TP=GetUnitX(QV)
set RP=GetUnitY(QV)
set PP=GetUnitX(IW)
set QP=GetUnitY(IW)
set UP=GetUnitX(OW)
set IQ=GetUnitY(OW)
set OQ=GetUnitX(AW)
set AQ=GetUnitY(AW)
set BQ=GetUnitX(PV)
set CQ=GetUnitY(PV)
set DQ=GetUnitX(CW)
set EQ=GetUnitY(CW)
set FQ=GetUnitX(DW)
set GQ=GetUnitY(DW)
set HQ=GetUnitX(BW)
set ZQ=GetUnitY(BW)
set VQ=GetUnitX(EW)
set WQ=GetUnitY(EW)
set XQ=GetUnitX(FW)
set YQ=GetUnitY(FW)
set JQ=GetUnitX(BV)
set KQ=GetUnitY(BV)
set LQ=GetUnitX(GW)
set MQ=GetUnitY(GW)
set NQ=GetUnitX(VW)
set SQ=GetUnitY(VW)
set TQ=GetUnitX(ZW)
set RQ=GetUnitY(ZW)
call RemoveUnit(WV)
call RemoveUnit(KV)
call RemoveUnit(JV)
call RemoveUnit(VV)
call RemoveUnit(TV)
call RemoveUnit(MV)
call RemoveUnit(NV)
call RemoveUnit(SV)
call RemoveUnit(LV)
call RemoveUnit(BV)
call RemoveUnit(GW)
call RemoveUnit(UH)
call RemoveUnit(YV)
call RemoveUnit(XV)
call RemoveUnit(UV)
call RemoveUnit(QV)
call RemoveUnit(IW)
call RemoveUnit(OW)
call RemoveUnit(AW)
call RemoveUnit(PV)
call RemoveUnit(CW)
call RemoveUnit(DW)
call RemoveUnit(BW)
call RemoveUnit(EW)
call RemoveUnit(FW)
call RemoveUnit(DV)
call RemoveUnit(ZY)
call RemoveUnit(VZ)
call RemoveUnit(AZ)
call RemoveUnit(FZ)
call RemoveUnit(HZ)
call RemoveUnit(AV)
call RemoveUnit(OV)
call RemoveUnit(IV)
call RemoveUnit(CV)
call RemoveUnit(HW)
call RemoveUnit(HV)
call RemoveUnit(GV)
call RemoveUnit(EV)
call RemoveUnit(ZV)
call RemoveUnit(WZ)
call RemoveUnit(FV)
call RemoveUnit(VW)
call RemoveUnit(ZW)
set PQ=CreateUnit(BO[0],'nfoh',QS,US,270)
set QQ=CreateUnit(EO,'hC95',IT,OT,270)
set UQ=CreateUnit(EO,'n01K',AT,BT,270)
set I00=CreateUnit(EO,'nC38',CT,DT,270)
set II0=CreateUnit(EO,'e025',ET,FT,270)
set I10=CreateUnit(EO,'n00V',GT,HT,270)
set IO0=CreateUnit(EO,'n00W',ZT,VT,270)
set I20=CreateUnit(EO,'n002',WT,XT,270)
set I30=CreateUnit(EO,'n00X',YT,JT,270)
set I40=CreateUnit(EO,'n009',KT,LT,270)
set I50=CreateUnit(EO,'n0HE',MT,ST,270)
set I60=CreateUnit(BO[0],'etol',RT,PT,270)
set I70=CreateUnit(BO[0],'e00R',QT,UT,90)
set I80=CreateUnit(BO[0],'e00R',IR,OR,45)
set I90=CreateUnit(BO[0],'e00R',BR,CR,0)
set IA0=CreateUnit(BO[0],'e011',DR,GR,90)
set IB0=CreateUnit(BO[0],'e011',HR,ZR,45)
set IC0=CreateUnit(BO[0],'e011',WR,XR,0)
set ID0=CreateUnit(BO[0],'e00S',YR,JR,90)
set IE0=CreateUnit(BO[0],'e00S',KR,LR,45)
set IF0=CreateUnit(BO[0],'e00S',SR,RR,0)
set IG0=CreateUnit(BO[0],'e019',PR,QR,45)
set IH0=CreateUnit(BO[0],'e019',UR,IP,45)
set IZ0=CreateUnit(BO[0],'eaom',OP,BP,90)
set IV0=CreateUnit(BO[0],'eaom',DP,EP,45)
set IW0=CreateUnit(BO[0],'eaom',FP,GP,0)
set IX0=CreateUnit(BO[0],'eaoe',ZP,VP,90)
set IY0=CreateUnit(BO[0],'eaoe',WP,YP,45)
set IJ0=CreateUnit(BO[0],'eaoe',JP,KP,0)
set IK0=CreateUnit(BO[0],'emow',LP,MP,270)
set IL0=CreateUnit(BO[0],'emow',TP,RP,270)
set IM0=CreateUnit(BO[0],'emow',PP,QP,270)
set IN0=CreateUnit(BO[0],'emow',UP,IQ,270)
set IS0=CreateUnit(BO[0],'emow',OQ,AQ,270)
set IT0=CreateUnit(BO[0],'emow',BQ,CQ,270)
set IR0=CreateUnit(BO[0],'emow',DQ,EQ,270)
set IP0=CreateUnit(BO[0],'emow',FQ,GQ,270)
set IQ0=CreateUnit(BO[0],'emow',HQ,ZQ,270)
set IU0=CreateUnit(BO[0],'emow',VQ,WQ,270)
set O00=CreateUnit(BO[0],'emow',XQ,YQ,270)
set OI0=CreateUnit(BO[0],'eaow',JQ,KQ,270)
set O10=CreateUnit(BO[0],'eaow',LQ,MQ,270)
set OO0=CreateUnit(BO[0],'edob',NQ,SQ,270)
set O20=CreateUnit(BO[0],'edob',TQ,RQ,270)
call SetPlayerAbilityAvailable(EO,'Aro1',false)
call SetUnitColor(QQ,TS)
call SetUnitColor(II0,TS)
call SetUnitColor(I00,PS)
call SetUnitColor(UQ,PS)
call SetUnitColor(I10,PS)
call SetUnitColor(IO0,PS)
call SetUnitColor(I20,PS)
call SetUnitColor(I30,PS)
call SetUnitColor(I40,PS)
call BK1(I70,true)
call BK1(I80,true)
call BK1(I90,true)
call BK1(IA0,true)
call BK1(IB0,true)
call BK1(IC0,true)
call BK1(ID0,true)
call BK1(IE0,true)
call BK1(IF0,true)
call BK1(IG0,true)
call BK1(IH0,true)
call BK1(I60,true)
call BK1(IZ0,true)
call BK1(IV0,true)
call BK1(IW0,true)
call BK1(IX0,true)
call BK1(IY0,true)
call BK1(IJ0,true)
call BK1(OI0,true)
call BK1(O10,true)
call BK1(OO0,true)
call BK1(O20,true)
call BK1(IK0,true)
call BK1(IL0,true)
call BK1(IM0,true)
call BK1(IN0,true)
call BK1(IS0,true)
call BK1(IT0,true)
call BK1(IR0,true)
call BK1(IP0,true)
call BK1(IQ0,true)
call BK1(IU0,true)
call BK1(O00,true)
call AddUnitToStock(II0,'h02C',0,0)
set O50=GetUnitX(GX)
set O60=GetUnitY(GX)
set O70=GetUnitX(UW)
set O80=GetUnitY(UW)
set O90=GetUnitX(IX)
set OA0=GetUnitY(IX)
set OB0=GetUnitX(OX)
set OC0=GetUnitY(OX)
set OD0=GetUnitX(PW)
set OE0=GetUnitY(PW)
set OF0=GetUnitX(TW)
set OG0=GetUnitY(TW)
set OH0=GetUnitX(SW)
set OZ0=GetUnitY(SW)
set OV0=GetUnitX(MW)
set OW0=GetUnitY(MW)
set OX0=GetUnitX(RW)
set OY0=GetUnitY(RW)
set OJ0=GetUnitX(QW)
set OK0=GetUnitY(QW)
set OL0=GetUnitX(JZ)
set OM0=GetUnitY(JZ)
set ON0=GetUnitX(KX)
set OS0=GetUnitY(KX)
set OT0=GetUnitX(GZ)
set OR0=GetUnitY(GZ)
set OP0=GetUnitX(MX)
set OQ0=GetUnitY(MX)
set OU0=GetUnitX(YZ)
set A00=GetUnitY(YZ)
set AI0=GetUnitX(SZ)
set A10=GetUnitY(SZ)
set AO0=GetUnitX(NX)
set A20=GetUnitY(NX)
set A30=GetUnitX(XZ)
set A40=GetUnitY(XZ)
set A50=GetUnitX(LW)
set A60=GetUnitY(LW)
set A70=GetUnitX(SX)
set A80=GetUnitY(SX)
set A90=GetUnitX(FY)
set AA0=GetUnitY(FY)
set AB0=GetUnitX(TX)
set AC0=GetUnitY(TX)
set AD0=GetUnitX(XX)
set AE0=GetUnitY(XX)
set AF0=GetUnitX(KW)
set AG0=GetUnitY(KW)
set AH0=GetUnitX(WX)
set AZ0=GetUnitY(WX)
set AV0=GetUnitX(EY)
set AW0=GetUnitY(EY)
set AX0=GetUnitX(JW)
set AY0=GetUnitY(JW)
set AJ0=GetUnitX(LX)
set AK0=GetUnitY(LX)
set AL0=GetUnitX(DY)
set AM0=GetUnitY(DY)
set AN0=GetUnitX(IY)
set AS0=GetUnitY(IY)
set AT0=GetUnitX(PX)
set AR0=GetUnitY(PX)
set AP0=GetUnitX(BY)
set AQ0=GetUnitY(BY)
set AU0=GetUnitX(YW)
set B00=GetUnitY(YW)
set BI0=GetUnitX(AY)
set B10=GetUnitY(AY)
set BO0=GetUnitX(RX)
set B20=GetUnitY(RX)
set B30=GetUnitX(QX)
set B40=GetUnitY(QX)
set B50=GetUnitX(OY)
set B60=GetUnitY(OY)
set B70=GetUnitX(GY)
set B80=GetUnitY(GY)
set B90=GetUnitX(WW)
set BA0=GetUnitY(WW)
set BB0=GetUnitX(YX)
set BC0=GetUnitY(YX)
set BD0=GetUnitX(XW)
set BE0=GetUnitY(XW)
set BF0=GetUnitX(CY)
set BG0=GetUnitY(CY)
set BH0=GetUnitX(UX)
set BZ0=GetUnitY(UX)
set BV0=GetUnitX(JX)
set BW0=GetUnitY(JX)
call RemoveUnit(IY)
call RemoveUnit(PX)
call RemoveUnit(BY)
call RemoveUnit(YW)
call RemoveUnit(AY)
call RemoveUnit(RX)
call RemoveUnit(QX)
call RemoveUnit(OY)
call RemoveUnit(GY)
call RemoveUnit(WW)
call RemoveUnit(YX)
call RemoveUnit(GZ)
call RemoveUnit(SZ)
call RemoveUnit(LW)
call RemoveUnit(MX)
call RemoveUnit(NX)
call RemoveUnit(SX)
call RemoveUnit(YZ)
call RemoveUnit(XZ)
call RemoveUnit(FY)
call RemoveUnit(TX)
call RemoveUnit(XX)
call RemoveUnit(KW)
call RemoveUnit(WX)
call RemoveUnit(EY)
call RemoveUnit(JW)
call RemoveUnit(LX)
call RemoveUnit(DY)
call RemoveUnit(XW)
call RemoveUnit(CY)
call RemoveUnit(UX)
call RemoveUnit(JX)
call RemoveUnit(KX)
call RemoveUnit(TW)
call RemoveUnit(SW)
call RemoveUnit(MW)
call RemoveUnit(RW)
call RemoveUnit(QW)
call RemoveUnit(JZ)
call RemoveUnit(OX)
call RemoveUnit(IX)
call RemoveUnit(GX)
call RemoveUnit(UW)
call RemoveUnit(PW)
set BX0=CreateUnit(CO[0],'ndfl',O50,O60,270)
set BY0=CreateUnit(EO,'nC35',O70,O80,270)
set BJ0=CreateUnit(EO,'n01K',O90,OA0,270)
set BK0=CreateUnit(EO,'nC38',OB0,OC0,270)
set BL0=CreateUnit(EO,'u00Q',OD0,OE0,270)
set BM0=CreateUnit(EO,'n00V',OF0,OG0,0)
set BN0=CreateUnit(EO,'n00W',OH0,OZ0,0)
set BS0=CreateUnit(EO,'n002',OV0,OW0,0)
set BT0=CreateUnit(EO,'n00X',OX0,OY0,0)
set BR0=CreateUnit(EO,'n009',OJ0,OK0,0)
set BP0=CreateUnit(EO,'n0HE',OL0,OM0,0)
set BQ0=CreateUnit(CO[0],'unpl',ON0,OS0,220)
set BU0=CreateUnit(CO[0],'u00M',OT0,OR0,270)
set C00=CreateUnit(CO[0],'u00M',OP0,OQ0,270)
set CI0=CreateUnit(CO[0],'u00M',OU0,A00,270)
set C10=CreateUnit(CO[0],'u00D',AI0,A10,270)
set CO0=CreateUnit(CO[0],'u00D',AO0,A20,270)
set C20=CreateUnit(CO[0],'u00D',A30,A40,270)
set C30=CreateUnit(CO[0],'u00N',A50,A60,270)
set C40=CreateUnit(CO[0],'u00N',A70,A80,270)
set C50=CreateUnit(CO[0],'u00N',A90,AA0,270)
set C60=CreateUnit(CO[0],'u00T',AB0,AC0,270)
set C70=CreateUnit(CO[0],'u00T',AD0,AE0,270)
set C80=CreateUnit(CO[0],'usep',AF0,AG0,270)
set C90=CreateUnit(CO[0],'usep',AH0,AZ0,270)
set CA0=CreateUnit(CO[0],'usep',AV0,AW0,270)
set CB0=CreateUnit(CO[0],'utod',AX0,AY0,270)
set CC0=CreateUnit(CO[0],'utod',AJ0,AK0,270)
set CD0=CreateUnit(CO[0],'utod',AL0,AM0,270)
set CE0=CreateUnit(CO[0],'uzig',AN0,AS0,270)
set CF0=CreateUnit(CO[0],'uzig',AT0,AR0,270)
set CG0=CreateUnit(CO[0],'uzig',AP0,AQ0,270)
set CH0=CreateUnit(CO[0],'uzig',AU0,B00,270)
set CZ0=CreateUnit(CO[0],'uzig',BI0,B10,270)
set CV0=CreateUnit(CO[0],'uzig',BO0,B20,270)
set CW0=CreateUnit(CO[0],'uzig',B30,B40,270)
set CX0=CreateUnit(CO[0],'uzig',B50,B60,270)
set CY0=CreateUnit(CO[0],'uzig',B70,B80,270)
set CJ0=CreateUnit(CO[0],'uzig',B90,BA0,270)
set CK0=CreateUnit(CO[0],'uzig',BB0,BC0,270)
set CL0=CreateUnit(CO[0],'usap',BD0,BE0,270)
set CM0=CreateUnit(CO[0],'usap',BF0,BG0,270)
set CN0=CreateUnit(CO[0],'ubon',BH0,BZ0,270)
set CS0=CreateUnit(CO[0],'ubon',BV0,BW0,270)
call SetUnitColor(BY0,O30)
call SetUnitColor(BK0,O40)
call SetUnitColor(BJ0,O40)
call SetUnitColor(BM0,O40)
call SetUnitColor(BN0,O40)
call SetUnitColor(BS0,O40)
call SetUnitColor(BT0,O40)
call SetUnitColor(BR0,O40)
call BK1(BU0,true)
call BK1(C00,true)
call BK1(CI0,true)
call BK1(C10,true)
call BK1(CO0,true)
call BK1(C20,true)
call BK1(C30,true)
call BK1(C40,true)
call BK1(C50,true)
call BK1(C60,true)
call BK1(C70,true)
call BK1(BQ0,true)
call BK1(C80,true)
call BK1(C90,true)
call BK1(CA0,true)
call BK1(CB0,true)
call BK1(CC0,true)
call BK1(CD0,true)
call BK1(CL0,true)
call BK1(CM0,true)
call BK1(CN0,true)
call BK1(CS0,true)
call BK1(CE0,true)
call BK1(CF0,true)
call BK1(CG0,true)
call BK1(CH0,true)
call BK1(CZ0,true)
call BK1(CV0,true)
call BK1(CW0,true)
call BK1(CX0,true)
call BK1(CY0,true)
call BK1(CJ0,true)
call BK1(CK0,true)
call AddUnitToStock(BL0,'h02C',0,0)
set HE1=GetUnitX(TZ)
set HF1=GetUnitY(TZ)
set HG1=GetUnitX(UZ)
set HH1=GetUnitY(UZ)
set HZ1=GetUnitX(QZ)
set HV1=GetUnitY(QZ)
set HW1=GetUnitX(RZ)
set HX1=GetUnitY(RZ)
set HY1=GetUnitX(PZ)
set HJ1=GetUnitY(PZ)
set HK1=GetUnitX(BX)
set HL1=GetUnitY(BX)
set HM1=GetUnitX(AX)
set HN1=GetUnitY(AX)
set HS1=GetUnitX(EX)
set HT1=GetUnitY(EX)
set HR1=GetUnitX(CX)
set HP1=GetUnitY(CX)
set HQ1=GetUnitX(DX)
set HU1=GetUnitY(DX)
set Z01=25
call RemoveUnit(TZ)
call RemoveUnit(UZ)
call RemoveUnit(QZ)
call RemoveUnit(RZ)
call RemoveUnit(PZ)
call RemoveUnit(BX)
call RemoveUnit(AX)
call RemoveUnit(EX)
call RemoveUnit(CX)
call RemoveUnit(DX)
set CT0=CreateUnit(Player(1),'ncop',HE1,HF1,270)
call UnitAddAbility(CT0,'A141')
call ClearSelectionForPlayer(Player(1))
call SelectUnitAddForPlayer(CT0,Player(1))
if GetLocalPlayer()==Player(1)then
call SetUnitVertexColor(CT0,255,255,255,255)
else
call SetUnitVertexColor(CT0,255,255,255,Z01)
endif
set CR0=CreateUnit(Player(2),'ncop',HG1,HH1,270)
call UnitAddAbility(CR0,'A141')
call ClearSelectionForPlayer(Player(2))
call SelectUnitAddForPlayer(CR0,Player(2))
if GetLocalPlayer()==Player(2)then
call SetUnitVertexColor(CR0,255,255,255,255)
else
call SetUnitVertexColor(CR0,255,255,255,Z01)
endif
set CP0=CreateUnit(Player(3),'ncop',HZ1,HV1,270)
call UnitAddAbility(CP0,'A141')
call ClearSelectionForPlayer(Player(3))
call SelectUnitAddForPlayer(CP0,Player(3))
if GetLocalPlayer()==Player(3)then
call SetUnitVertexColor(CP0,255,255,255,255)
else
call SetUnitVertexColor(CP0,255,255,255,Z01)
endif
set CQ0=CreateUnit(Player(4),'ncop',HW1,HX1,270)
call UnitAddAbility(CQ0,'A141')
call ClearSelectionForPlayer(Player(4))
call SelectUnitAddForPlayer(CQ0,Player(4))
if GetLocalPlayer()==Player(4)then
call SetUnitVertexColor(CQ0,255,255,255,255)
else
call SetUnitVertexColor(CQ0,255,255,255,Z01)
endif
set CU0=CreateUnit(Player(5),'ncop',HY1,HJ1,270)
call UnitAddAbility(CU0,'A141')
call ClearSelectionForPlayer(Player(5))
call SelectUnitAddForPlayer(CU0,Player(5))
if GetLocalPlayer()==Player(5)then
call SetUnitVertexColor(CU0,255,255,255,255)
else
call SetUnitVertexColor(CU0,255,255,255,Z01)
endif
set D00=CreateUnit(Player(7),'ncop',HK1,HL1,270)
call UnitAddAbility(D00,'A1WI')
call ClearSelectionForPlayer(Player(7))
call SelectUnitAddForPlayer(D00,Player(7))
if GetLocalPlayer()==Player(7)then
call SetUnitVertexColor(D00,255,255,255,255)
else
call SetUnitVertexColor(D00,255,255,255,Z01)
endif
set DI0=CreateUnit(Player(8),'ncop',HM1,HN1,270)
call UnitAddAbility(DI0,'A1WI')
call ClearSelectionForPlayer(Player(8))
call SelectUnitAddForPlayer(DI0,Player(8))
if GetLocalPlayer()==Player(8)then
call SetUnitVertexColor(DI0,255,255,255,255)
else
call SetUnitVertexColor(DI0,255,255,255,Z01)
endif
set D10=CreateUnit(Player(9),'ncop',HS1,HT1,270)
call UnitAddAbility(D10,'A1WI')
call ClearSelectionForPlayer(Player(9))
call SelectUnitAddForPlayer(D10,Player(9))
if GetLocalPlayer()==Player(9)then
call SetUnitVertexColor(D10,255,255,255,255)
else
call SetUnitVertexColor(D10,255,255,255,Z01)
endif
set DO0=CreateUnit(Player(10),'ncop',HR1,HP1,270)
call UnitAddAbility(DO0,'A1WI')
call ClearSelectionForPlayer(Player(10))
call SelectUnitAddForPlayer(DO0,Player(10))
if GetLocalPlayer()==Player(10)then
call SetUnitVertexColor(DO0,255,255,255,255)
else
call SetUnitVertexColor(DO0,255,255,255,Z01)
endif
set D20=CreateUnit(Player(11),'ncop',HQ1,HU1,270)
call UnitAddAbility(D20,'A1WI')
call ClearSelectionForPlayer(Player(11))
call SelectUnitAddForPlayer(D20,Player(11))
if GetLocalPlayer()==Player(11)then
call SetUnitVertexColor(D20,255,255,255,255)
else
call SetUnitVertexColor(D20,255,255,255,Z01)
endif
set D30[1]=CT0
set D30[2]=CR0
set D30[3]=CP0
set D30[4]=CQ0
set D30[5]=CU0
set D30[7]=D00
set D30[8]=DI0
set D30[9]=D10
set D30[10]=DO0
set D30[11]=D20
set D40[1]=GetUnitX(CT0)
set D40[2]=GetUnitX(CR0)
set D40[3]=GetUnitX(CP0)
set D40[4]=GetUnitX(CQ0)
set D40[5]=GetUnitX(CU0)
set D40[7]=GetUnitX(D00)
set D40[8]=GetUnitX(DI0)
set D40[9]=GetUnitX(D10)
set D40[10]=GetUnitX(DO0)
set D40[11]=GetUnitX(D20)
set D50[1]=GetUnitY(CT0)
set D50[2]=GetUnitY(CR0)
set D50[3]=GetUnitY(CP0)
set D50[4]=GetUnitY(CQ0)
set D50[5]=GetUnitY(CU0)
set D50[7]=GetUnitY(D00)
set D50[8]=GetUnitY(DI0)
set D50[9]=GetUnitY(D10)
set D50[10]=GetUnitY(DO0)
set D50[11]=GetUnitY(D20)
call Z91()
call ZE1()
call SNI('esen',"stand 4")
call SNI('e00V',"stand 4")
call SNI('edry',"spell")
call SNI('e00W',"spell")
call SNI('ugho',"stand victory")
call SNI('u001',"stand victory")
call SNI('unec',"stand channel")
call SNI('u002',"stand channel")
call SYI('n00M',0.4,'n00M')
call SYI('e02R',0.5,'e02R')
call SYI('e02T',1.2,'e02T')
call SYI('e02S',0.5,'e02S')
call SYI('e030',0.5,'e030')
call SYI('n0LS',1,'n0LS')
set t=CreateTrigger()
set T4I=Player(15)
set ZH1=GetUnitX(VX)
set ZZ1=GetUnitY(VX)
set ZV1=GetUnitX(MZ)
set ZW1=GetUnitY(MZ)
set ZX1=GetUnitX(HX)
set ZY1=GetUnitY(HX)
set ZJ1=GetUnitX(YY)
set ZK1=GetUnitY(YY)
set ZL1=GetUnitX(LZ)
set ZM1=GetUnitY(LZ)
set ZN1=GetUnitX(NZ)
set ZS1=GetUnitY(NZ)
set ZT1=GetUnitX(IZ)
set ZR1=GetUnitY(IZ)
set ZP1=GetUnitX(KY)
set ZQ1=GetUnitY(KY)
set ZU1=GetUnitX(EZ)
set V01=GetUnitY(EZ)
set VI1=GetUnitX(ZX)
set V11=GetUnitY(ZX)
set VO1=GetUnitX(HY)
set V21=GetUnitY(HY)
set V31=GetUnitX(JY)
set V41=GetUnitY(JY)
call RemoveUnit(VX)
call RemoveUnit(NZ)
call RemoveUnit(MZ)
call RemoveUnit(LZ)
call RemoveUnit(HX)
call RemoveUnit(IZ)
call RemoveUnit(EZ)
call RemoveUnit(ZX)
call RemoveUnit(HY)
call RemoveUnit(YY)
call RemoveUnit(KY)
call RemoveUnit(JY)
set EI0=CreateUnit(T4I,'n008',ZL1,ZM1,270)
set E10=CreateUnit(T4I,'n0GJ',ZN1,ZS1,270)
set EO0=CreateUnit(T4I,'n01D',ZT1,ZR1,270)
set E20=CreateUnit(T4I,'n0LH',ZP1,ZQ1,270)
set E30=CreateUnit(T4I,'n01N',ZH1,ZZ1,270)
set E40=CreateUnit(T4I,'n007',ZV1,ZW1,270)
set E50=CreateUnit(T4I,'n005',ZX1,ZY1,270)
set E60=CreateUnit(T4I,'n0LI',ZJ1,ZK1,270)
set E70=CreateUnit(T4I,'n01B',ZU1,V01,270)
set E80=CreateUnit(T4I,'n01P',VI1,V11,270)
set E90=CreateUnit(T4I,'n0GK',VO1,V21,270)
set EA0=CreateUnit(T4I,'n0LJ',V31,V41,270)
call SetUnitColor(EI0,ConvertPlayerColor(1))
call SetUnitColor(E10,ConvertPlayerColor(1))
call SetUnitColor(EO0,ConvertPlayerColor(9))
call SetUnitColor(E20,ConvertPlayerColor(9))
call SetUnitColor(E30,ConvertPlayerColor(6))
call SetUnitColor(E40,ConvertPlayerColor(6))
call SetUnitColor(E50,ConvertPlayerColor(10))
call SetUnitColor(E60,ConvertPlayerColor(10))
call SetUnitColor(E70,ConvertPlayerColor(0))
call SetUnitColor(E80,ConvertPlayerColor(0))
call SetUnitColor(E90,ConvertPlayerColor(11))
call SetUnitColor(EA0,ConvertPlayerColor(11))
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function VB1))
set CG=CreateTrigger()
call TriggerRegisterTimerEventSingle(CG,0.01)
call TriggerAddAction(CG,function VD1)
set t=CreateTrigger()
call TriggerRegisterPlayerEventLeave(t,BO[1])
call TriggerRegisterPlayerEventLeave(t,BO[2])
call TriggerRegisterPlayerEventLeave(t,BO[3])
call TriggerRegisterPlayerEventLeave(t,BO[4])
call TriggerRegisterPlayerEventLeave(t,BO[5])
call TriggerRegisterPlayerEventLeave(t,CO[1])
call TriggerRegisterPlayerEventLeave(t,CO[2])
call TriggerRegisterPlayerEventLeave(t,CO[3])
call TriggerRegisterPlayerEventLeave(t,CO[4])
call TriggerRegisterPlayerEventLeave(t,CO[5])
call TriggerAddAction(t,function VJ1)
if C2 then
call VG1()
set t=CreateTrigger()
if IsPlayerObserver(D60)then
call TriggerRegisterPlayerEventLeave(t,D60)
endif
if IsPlayerObserver(D70)then
call TriggerRegisterPlayerEventLeave(t,D70)
endif
call TriggerAddAction(t,function VH1)
endif
set EF0[0]=false
set EF0[1]=false
set EF0[2]=false
set EF0[3]=false
set EF0[4]=false
set EF0[5]=false
set EF0[6]=false
set EF0[7]=false
set EF0[8]=false
set EF0[9]=false
set EF0[10]=false
set EF0[11]=false
set EF0[12]=false
set EF0[13]=false
set EF0[14]=false
set EF0[15]=false
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_HERO_REVIVE_FINISH)
call TriggerAddAction(t,function WD1)
set t=CreateTrigger()
call TriggerRegisterEnterRectSimple(t,bj_mapInitialPlayableArea)
call TriggerAddCondition(t,Condition(function QX1))
call TriggerAddAction(t,function QP1)
set DN=t
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerAddAction(t,function UO1)
call TriggerAddCondition(t,Condition(function U11))
set EV0=t
set EW0=CreateTrigger()
call TriggerRegisterTimerEvent(EW0,0.6,true)
call TriggerAddCondition(EW0,Condition(function U31))
call DisableTrigger(EW0)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,.5,true)
call TriggerAddAction(t,function U51)
set EX0=t
call BW1(0,0,false)
call U81()
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.5,true)
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerAddCondition(t,Condition(function UD1))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.1,true)
call TriggerAddCondition(t,Condition(function UB1))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PAWN_ITEM)
call TriggerAddCondition(t,Condition(function UA1))
set t=null
call Q1I('A27F')
call Q1I('A27X')
call Q1I('A27H')
call Q1I('A2V9')
call Q1I('A27V')
call Q1I('A27G')
call Q1I('A27I')
call Q1I('A27K')
call Q1I('A27J')
set DG=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(DG,BO[0],EVENT_PLAYER_UNIT_DEATH,Condition(function ULI))
call TriggerRegisterPlayerUnitEvent(DG,CO[0],EVENT_PLAYER_UNIT_DEATH,Condition(function ULI))
call TriggerRegisterPlayerUnitEvent(DG,DO,EVENT_PLAYER_UNIT_DEATH,Condition(function ULI))
call TriggerAddAction(DG,function UP1)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function I7O))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function O3O))
call TriggerAddAction(t,function OPO)
set EG=t
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ARO))
set t=null
call AXO('nstl',62)
call AXO('nsth',119)
call AXO('n026',88)
call AXO('ndtw',119)
call AXO('efon',30)
call AXO('n004',300)
call AXO('n018',300)
call AXO('n01C',300)
call AXO('n01G',300)
call AXO('o00T',20)
call AXO('o00U',25)
call AXO('o00V',30)
call AXO('o00W',35)
call AXO('n00H',200)
call AXO('n00G',300)
call AXO('n00K',400)
call AXO('n00J',200)
call AXO('n00A',300)
call AXO('n006',400)
call AXO('n0F5',0)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function AUO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function B1O))
set t=null
set FL0=CreateTrigger()
call TriggerAddCondition(FL0,Condition(function B8O))
set FG=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(FG,DO,EVENT_PLAYER_UNIT_DEATH,Condition(function N1I))
call TriggerAddCondition(FG,Condition(function BDO))
call TriggerAddAction(FG,function BGO)
set t=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(t,BO[0],EVENT_PLAYER_UNIT_DEATH,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[0],EVENT_PLAYER_UNIT_DEATH,Condition(function N1I))
call TriggerAddCondition(t,Condition(function BLO))
set t=null
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function C3O))
call TriggerRegisterTimerEvent(t,6,false)
set t=null
set GO0=GO0+1 //1
set FT0[GO0]='I0FF'
set FR0[GO0]='I0FG'
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSelectHeroOn.blp"
set GI0[GO0]=0
set FU0[GO0]=500
set GO0=GO0+1 //2
set FT0[GO0]='I02Q'
set FR0[GO0]='I02O'
set FP0[GO0]='h011'
set FQ0[GO0]='I00A'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBootsOfSpeed.blp"
set GI0[GO0]=0
set FU0[GO0]=450
set G40=GO0
set GO0=GO0+1 //3
set FT0[GO0]='I02S'
set FR0[GO0]='I02P'
set FP0[GO0]='h012'
set FQ0[GO0]='I0CA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGlove.blp"
set GI0[GO0]=0
set FU0[GO0]=500
set G50=GO0
set GO0=GO0+1 //4
set FT0[GO0]='I02N'
set FR0[GO0]='I02R'
set FP0[GO0]='h013'
set FQ0[GO0]='I0CS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBoots.blp"
set GI0[GO0]=0
set FU0[GO0]=450
set G60=GO0
set GO0=GO0+1 //5
set FT0[GO0]='I02X'
set FR0[GO0]='I02Y'
set FP0[GO0]='h015'
set FQ0[GO0]='I0D4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNCirclet.blp"
set GI0[GO0]=0
set FU0[GO0]=165
set G70=GO0
set GO0=GO0+1 //6
set FT0[GO0]='I02Z'
set FR0[GO0]='I043'
set FP0[GO0]='h016'
set FQ0[GO0]='I0CV'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBelt.blp"
set GI0[GO0]=0
set FU0[GO0]=450
set G80=GO0
set GO0=GO0+1 //7
set FT0[GO0]='I030'
set FR0[GO0]='I044'
set FP0[GO0]='h017'
set FQ0[GO0]='I0D2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_ThrowingKnife_03.blp"
set GI0[GO0]=0
set FU0[GO0]=1000
set G90=GO0
set GO0=GO0+1 //8
set FT0[GO0]='I031'
set FR0[GO0]='I045'
set FP0[GO0]='h018'
set FQ0[GO0]='I0D5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNClawsOfAttack.blp"
set GI0[GO0]=0
set FU0[GO0]=450
set GA0=GO0
set GO0=GO0+1 //9
set FT0[GO0]='I032'
set FR0[GO0]='I046'
set FP0[GO0]='h019'
set FQ0[GO0]='I0CZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSteelMelee.blp"
set GI0[GO0]=0
set FU0[GO0]=1200
set GB0=GO0
set GO0=GO0+1 //10
set FT0[GO0]='I033'
set FR0[GO0]='I047'
set FP0[GO0]='h01A'
set FQ0[GO0]='I0D7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Chest_Chain_12.blp"
set GI0[GO0]=0
set FU0[GO0]=550
set GC0=GO0
set GO0=GO0+1 //11
set FT0[GO0]='I034'
set FR0[GO0]='I048'
set FP0[GO0]='h01B'
set FQ0[GO0]='I0CX'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_19.blp"
set GI0[GO0]=0
set FU0[GO0]=1400
set GD0=GO0
set GO0=GO0+1 //12
set FT0[GO0]='I035'
set FR0[GO0]='I049'
set FP0[GO0]='h01C'
set FQ0[GO0]='I0CI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNFrostMourne.blp"
set GI0[GO0]=0
set FU0[GO0]=2400
set GE0=GO0
set GO0=GO0+1 //13
set FT0[GO0]='I036'
set FR0[GO0]='I04A'
set FP0[GO0]='h01D'
set FQ0[GO0]='I0CH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Weapon_Bow_06.blp"
set GI0[GO0]=0
set FU0[GO0]=3300
set GF0=GO0
set GO0=GO0+1 //14
set FT0[GO0]='I037'
set FR0[GO0]='I04B'
set FP0[GO0]='h01E'
set FQ0[GO0]='I0CR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNEnchantedGemstone.blp"
set GI0[GO0]=0
set FU0[GO0]=1000
set GG0=GO0
set GO0=GO0+1 //15
set FT0[GO0]='I038'
set FR0[GO0]='I04C'
set FP0[GO0]='h01F'
set FQ0[GO0]='I0CJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGauntletsOfOgrePower.blp"
set GI0[GO0]=0
set FU0[GO0]=150
set GH0=GO0
set GO0=GO0+1 //16
set FT0[GO0]='I039'
set FR0[GO0]='I04D'
set FP0[GO0]='h01G'
set FQ0[GO0]='I0DG'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGem.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set GZ0=GO0
set GO0=GO0+1 //17
set FT0[GO0]='I0MS'
set FR0[GO0]='I0MR'
set FP0[GO0]=0
set FQ0[GO0]='I0MT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGem.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set GV0=GO0
set GO0=GO0+1 //18
set FT0[GO0]='I03B'
set FR0[GO0]='I04E'
set FP0[GO0]='h01H'
set FQ0[GO0]='I0DA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHelmutPurple.blp"
set GI0[GO0]=0
set FU0[GO0]=950
set GW0=GO0
set GO0=GO0+1 //19
set FT0[GO0]='I03C'
set FR0[GO0]='I04F'
set FP0[GO0]='h01I'
set FQ0[GO0]='I0CQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPeriapt1.blp"
set GI0[GO0]=0
set FU0[GO0]=2000
set GX0=GO0
set GO0=GO0+1 //20
set FT0[GO0]='I03D'
set FR0[GO0]='I04G'
set FP0[GO0]='h01J'
set FQ0[GO0]='I0CU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNNatureTouchGrow.blp"
set GI0[GO0]=0
set FU0[GO0]=50
set GY0=GO0
set GO0=GO0+1 //21
set FT0[GO0]='I03E'
set FR0[GO0]='I04H'
set FP0[GO0]='h01K'
set FQ0[GO0]='I0C7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNDaggerOfEscape.blp"
set GI0[GO0]=12
set FU0[GO0]=2250
set GJ0=GO0
set GO0=GO0+1 //22
set FT0[GO0]='I03E'
set FR0[GO0]='I04I'
set FP0[GO0]='h01K'
set FQ0[GO0]='I0DH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNDaggerOfEscape.blp"
set GI0[GO0]=0
set FU0[GO0]=2250
set GK0=GO0
set GO0=GO0+1 //23
set FT0[GO0]='I03F'
set FR0[GO0]='I04J'
set FP0[GO0]='h01L'
set FQ0[GO0]='I0CM'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNMantleOfIntelligence.blp"
set GI0[GO0]=0
set FU0[GO0]=150
set GL0=GO0
set GO0=GO0+1 //24
set FT0[GO0]='I03G'
set FR0[GO0]='I04K'
set FP0[GO0]='h01M'
set FQ0[GO0]='I0CD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUndeadShrine.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set GM0=GO0
set GO0=GO0+1 //25
set FT0[GO0]='I03H'
set FR0[GO0]='I04L'
set FP0[GO0]='h01N'
set FQ0[GO0]='I0CG'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSpiritWalkerMasterTraining.blp"
set GI0[GO0]=0
set FU0[GO0]=3200
set GN0=GO0
set GO0=GO0+1 //26
set FT0[GO0]='I03I'
set FR0[GO0]='I04M'
set FP0[GO0]='h01O'
set FQ0[GO0]='I0D0'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHammer.blp"
set GI0[GO0]=0
set FU0[GO0]=1600
set GS0=GO0
set GO0=GO0+1 //27
set FT0[GO0]='I03J'
set FR0[GO0]='I04N'
set FP0[GO0]='h01P'
set FQ0[GO0]='I0CN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStaffOfNegation.blp"
set GI0[GO0]=0
set FU0[GO0]=2700
set GT0=GO0
set GO0=GO0+1 //28
set FT0[GO0]='I03K'
set FR0[GO0]='I04O'
set FP0[GO0]='h01Q'
set FQ0[GO0]='I0D8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSpiritWalkerAdeptTraining.tga"
set GI0[GO0]=0
set FU0[GO0]=1000
set GR0=GO0
set GO0=GO0+1 //29
set FT0[GO0]='I03L'
set FR0[GO0]='I04P'
set FP0[GO0]='h01R'
set FQ0[GO0]='I0CE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Misc_Cape_08.blp"
set GI0[GO0]=0
set FU0[GO0]=550
set GP0=GO0
set GO0=GO0+1 //30
set FT0[GO0]='I03M'
set FR0[GO0]='I04Q'
set FP0[GO0]='h01S'
set FQ0[GO0]='I0DB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Chest_Plate13.blp"
set GI0[GO0]=0
set FU0[GO0]=1400
set GQ0=GO0
set GO0=GO0+1 //31
set FT0[GO0]='I03N'
set FR0[GO0]='I04R'
set FP0[GO0]='h01T'
set FQ0[GO0]='I0CL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUsedSoulGem.blp"
set GI0[GO0]=0
set FU0[GO0]=1200
set GU0=GO0
set GO0=GO0+1 //32
set FT0[GO0]='I03P'
set FR0[GO0]='I04S'
set FP0[GO0]='h01U'
set FQ0[GO0]='I0CY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAlleriaFlute.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set H00=GO0
set GO0=GO0+1 //33
set FT0[GO0]='I03Q'
set FR0[GO0]='I04T'
set FP0[GO0]='h01V'
set FQ0[GO0]='I0DI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGoldRing.blp"
set GI0[GO0]=0
set FU0[GO0]=875
set HI0=GO0
set GO0=GO0+1 //34
set FT0[GO0]='I03R'
set FR0[GO0]='I04U'
set FP0[GO0]='h01W'
set FQ0[GO0]='I0CW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingPurple.blp"
set GI0[GO0]=0
set FU0[GO0]=200
set H10=GO0
set GO0=GO0+1 //35
set FT0[GO0]='I03S'
set FR0[GO0]='I04V'
set FP0[GO0]='h01X'
set FQ0[GO0]='I0DJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingSkull.blp"
set GI0[GO0]=0
set FU0[GO0]=350
set HO0=GO0
set GO0=GO0+1 //36
set FT0[GO0]='I03T'
set FR0[GO0]='I04W'
set FP0[GO0]='h01Y'
set FQ0[GO0]='I0CP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRobeOfTheMagi.blp"
set GI0[GO0]=0
set FU0[GO0]=450
set H20=GO0
set GO0=GO0+1 //37
set FT0[GO0]='I03U'
set FR0[GO0]='I04X'
set FP0[GO0]='h01Z'
set FQ0[GO0]='I0CC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStaffOfTeleportation.blp"
set GI0[GO0]=0
set FU0[GO0]=3800
set H30=GO0
set GO0=GO0+1 //38
set FT0[GO0]='I03V'
set FR0[GO0]='I04Y'
set FP0[GO0]='h020'
set FQ0[GO0]='I0C5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSlippersOfAgility.blp"
set GI0[GO0]=0
set FU0[GO0]=150
set H40=GO0
set GO0=GO0+1 //39
set FT0[GO0]='I03W'
set FR0[GO0]='I04Z'
set FP0[GO0]='h021'
set FQ0[GO0]='I0DK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSobiMask.blp"
set GI0[GO0]=0
set FU0[GO0]=325
set H50=GO0
set GO0=GO0+1 //40
set FT0[GO0]='I03X'
set FR0[GO0]='I050'
set FP0[GO0]='h022'
set FQ0[GO0]='I0D1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWandOfCyclone.blp"
set GI0[GO0]=0
set FU0[GO0]=1000
set H60=GO0
set GO0=GO0+1 //41
set FT0[GO0]='I03A'
set FR0[GO0]='I051'
set FP0[GO0]='h023'
set FQ0[GO0]='I0D9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSteelArmor.blp"
set GI0[GO0]=0
set FU0[GO0]=250
set H70=GO0
set GO0=GO0+1 //42
set FT0[GO0]='I0KB'
set FR0[GO0]='I0KA'
set FP0[GO0]=0
set FQ0[GO0]='I0KC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSteelArmor.blp"
set GI0[GO0]=0
set FU0[GO0]=250
set H80=GO0
set GO0=GO0+1 //43
set FT0[GO0]='I03Y'
set FR0[GO0]='I052'
set FP0[GO0]='h024'
set FQ0[GO0]='I0C9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrbofSlowness.blp"
set GI0[GO0]=0
set FU0[GO0]=2100
set H90=GO0
set GO0=GO0+1 //44
set FT0[GO0]='I03Z'
set FR0[GO0]='I053'
set FP0[GO0]='h025'
set FQ0[GO0]='I0CK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSoulGem.blp"
set GI0[GO0]=0
set FU0[GO0]=1100
set HA0=GO0
set GO0=GO0+1 //45
set FT0[GO0]='I040'
set FR0[GO0]='I054'
set FP0[GO0]='h026'
set FQ0[GO0]='I0DL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPeriapt.blp"
set GI0[GO0]=0
set FU0[GO0]=875
set HB0=GO0
set GO0=GO0+1 //46
set FT0[GO0]='I041'
set FR0[GO0]='I055'
set FP0[GO0]='h027'
set FQ0[GO0]='I0D6'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSteelRanged.blp"
set GI0[GO0]=0
set FU0[GO0]=1500
set HC0=GO0
set GO0=GO0+1 //47
set FT0[GO0]='I00L'
set FR0[GO0]='I0AV'
set FP0[GO0]='h02B'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle0.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HD0=GO0
set GO0=GO0+1 //48
set FT0[GO0]='I05E'
set FR0[GO0]='I0AM'
set FP0[GO0]=0
set FQ0[GO0]='I0DN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle0.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HE0=GO0
set GO0=GO0+1 //49
set FT0[GO0]='I0AU'
set FR0[GO0]='I0AN'
set FP0[GO0]=0
set FQ0[GO0]='I0DO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle1.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HF0=GO0
set GO0=GO0+1 //50
set FT0[GO0]='I0AS'
set FR0[GO0]='I0AO'
set FP0[GO0]=0
set FQ0[GO0]='I0DP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle2.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HG0=GO0
set GO0=GO0+1 //51
set FT0[GO0]='I0AT'
set FR0[GO0]='I0AP'
set FP0[GO0]=0
set FQ0[GO0]='I0DQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle3.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HH0=GO0
set GO0=GO0+1 //52
set FT0[GO0]='I0GW'
set FR0[GO0]='I0GY'
set FP0[GO0]=0
set FQ0[GO0]='I0H3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle_Illusion.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HY0=GO0
set GO0=GO0+1 //53
set FT0[GO0]='I0H2'
set FR0[GO0]='I0GX'
set FP0[GO0]=0
set FQ0[GO0]='I0DR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle_Regeneration.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HX0=GO0
set GO0=GO0+1 //54
set FT0[GO0]='I0GV'
set FR0[GO0]='I0H1'
set FP0[GO0]=0
set FQ0[GO0]='I0H4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle_Haste.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HW0=GO0
set GO0=GO0+1 //55
set FT0[GO0]='I0RD'
set FR0[GO0]='I0RE'
set FP0[GO0]=0
set FQ0[GO0]='I0RF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle_Illusion.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HJ0=GO0
set GO0=GO0+1 //56
set FT0[GO0]='I0AR'
set FR0[GO0]='I0H0'
set FP0[GO0]=0
set FQ0[GO0]='I0H6'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle_DoubleDamage.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HV0=GO0
set GO0=GO0+1 //57
set FT0[GO0]='I0AQ'
set FR0[GO0]='I0GZ'
set FP0[GO0]=0
set FQ0[GO0]='I0H5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBottle_Invisibility.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set HZ0=GO0
set GO0=GO0+1 //58
set FT0[GO0]='I0GD'
set FR0[GO0]='I0GC'
set FP0[GO0]='h074'
set FQ0[GO0]='I0GE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWand.blp"
set GI0[GO0]=17
set FU0[GO0]=200
set HK0=GO0
set GO0=GO0+1 //59
set FT0[GO0]='I0HC'
set FR0[GO0]='I0HB'
set FP0[GO0]=0
set FQ0[GO0]='I0HA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStarWand.blp"
set GI0[GO0]=17
set FU0[GO0]=500
set X10=GO0
set GO0=GO0+1 //60
set FT0[GO0]='I0HT'
set FR0[GO0]='I0HR'
set FP0[GO0]='h07W'
set FQ0[GO0]='I0HV'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrcMeleeUpTwo.blp"
set GI0[GO0]=5
set FU0[GO0]=225
set HL0=GO0
set GO0=GO0+1 //61
set FT0[GO0]='I0HU'
set FR0[GO0]='I0HP'
set FP0[GO0]=0
set FQ0[GO0]='I0HW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrcMeleeUpTwo.blp"
set GI0[GO0]=5
set FU0[GO0]=225
set HM0=GO0
set GO0=GO0+1 //62
set FT0[GO0]='I0N4'
set FR0[GO0]='I0N3'
set FP0[GO0]=0
set FQ0[GO0]='I0N5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPoisonBlade.blp"
set GI0[GO0]=30
set FU0[GO0]=775
set HT0=GO0
set GO0=GO0+1 //63
set FT0[GO0]='I0N7'
set FR0[GO0]='I0N6'
set FP0[GO0]=0
set FQ0[GO0]='I0N8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPoisonBlade.blp"
set GI0[GO0]=30
set FU0[GO0]=775
set HR0=GO0
set GO0=GO0+1 //64
set FT0[GO0]='I0J7'
set FR0[GO0]='I0J6'
set FP0[GO0]='h083'
set FQ0[GO0]='I0J8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAmulet.blp"
set GI0[GO0]=0
set FU0[GO0]=1800
set HN0=GO0
set GO0=GO0+1 //65
set FT0[GO0]='I0JJ'
set FR0[GO0]='I0JI'
set FP0[GO0]='h087'
set FQ0[GO0]='I0JK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGreenStaff.blp"
set GI0[GO0]=30
set FU0[GO0]=1600
set X50=GO0
set GO0=GO0+1 //66
set FT0[GO0]='I0P9'
set FR0[GO0]='I0PB'
set FP0[GO0]='h0EI'
set FQ0[GO0]='I0PA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPendantOfMana.blp"
set GI0[GO0]=0
set FU0[GO0]=1400
set XE0=GO0
set GO0=GO0+1 //67
set FT0[GO0]='I0PN'
set FR0[GO0]='I0PM'
set FP0[GO0]=0
set FQ0[GO0]='I0PO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPendantOfMana.blp"
set GI0[GO0]=10
set FU0[GO0]=2150
set XF0=GO0
set GO0=GO0+1 //68
set FT0[GO0]='I0QE'
set FR0[GO0]='I0QF'
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStone.blp"
set GI0[GO0]=10
set FU0[GO0]=0
set XG0=GO0
set GO0=GO0+1 //69
set FT0[GO0]='I0QG'
set FR0[GO0]='I0QH'
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNThunderLizardEgg.blp"
set GI0[GO0]=10
set FU0[GO0]=0
set XH0=GO0
set GO0=GO0+1 //70
set FT0[GO0]='I0MA'
set FR0[GO0]='I0M9'
set FP0[GO0]='h0CM'
set FQ0[GO0]='I0MB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrbOfVenom.blp"
set GI0[GO0]=0
set FU0[GO0]=275
set G20=GO0
set GO0=GO0+1 //71
set FT0[GO0]='I0MD'
set FR0[GO0]='I0ME'
set FP0[GO0]=0
set FQ0[GO0]='I0MC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrbOfVenom.blp"
set GI0[GO0]=0
set FU0[GO0]=275
set G30=GO0
set GO0=GO0+1 //72
set FT0[GO0]='I057'
set FR0[GO0]='I05C'
set FP0[GO0]='h02A'
set FQ0[GO0]='I0Q8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAncientOfTheEarth.blp"
set GI0[GO0]=0
set FU0[GO0]=125
set Z80=GO0
set GO0=GO0+1 //73
set FT0[GO0]='I0Q7'
set FR0[GO0]='I0Q6'
set FP0[GO0]=0
set FQ0[GO0]='I0Q9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAncientOfTheEarth.blp"
set GI0[GO0]=0
set FU0[GO0]=0
set Z90=GO0
set GO0=GO0+1 //74
set FT0[GO0]='I042'
set FR0[GO0]='I05D'
set FP0[GO0]='h028'
set FQ0[GO0]='I0PY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNLesserClarityPotion.blp"
set GI0[GO0]=0
set FU0[GO0]=50
set Z50=GO0
set GO0=GO0+1 //75
set FT0[GO0]='I0HO'
set FR0[GO0]='I0HN'
set FP0[GO0]='h07V'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNVialFull.blp"
set GI0[GO0]=0
set FU0[GO0]=200
set Z60=GO0
set GO0=GO0+1 //76
set FT0[GO0]='I056'
set FR0[GO0]='I05F'
set FP0[GO0]='h029'
set FQ0[GO0]='I0PZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHealingSalve.blp"
set GI0[GO0]=0
set FU0[GO0]=110
set Z70=GO0
set GO0=GO0+1 //77
set FT0[GO0]='I058'
set FR0[GO0]='I05G'
set FP0[GO0]='h02C'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSentryWard.blp"
set GI0[GO0]=0
set FU0[GO0]=150
set ZA0=GO0
set GO0=GO0+1 //78
set FT0[GO0]='I059'
set FR0[GO0]='I05H'
set FP0[GO0]='h02D'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBlueSentryWard.blp"
set GI0[GO0]=0
set FU0[GO0]=200
set ZB0=GO0
set GO0=GO0+1 //79
set FT0[GO0]='I05A'
set FR0[GO0]='I05I'
set FP0[GO0]='h02E'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNScrollUber.blp"
set GI0[GO0]=0
set FU0[GO0]=100
set ZC0=GO0
set GO0=GO0+1 //80
set FT0[GO0]='I05B'
set FR0[GO0]='I05J'
set FP0[GO0]='h02F'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNCritterChicken.blp"
set GI0[GO0]=0
set FU0[GO0]=120
set ZD0=GO0
set GO0=GO0+1 //81
set FT0[GO0]='I0B0'
set FR0[GO0]='I0B1'
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNCheese.blp"
set GI0[GO0]=0
set FU0[GO0]=1000
set ZE0=GO0
set GO0=GO0+1 //82
set FT0[GO0]='I0GG'
set FR0[GO0]='I0GF'
set FP0[GO0]='h075'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPotionOfDivinity.blp"
set GI0[GO0]=30
set FU0[GO0]=160
set ZF0=GO0
set GO0=GO0+1 //83
set FT0[GO0]='I0GI'
set FR0[GO0]='I0GH'
set FP0[GO0]='h076'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNDustOfAppearance.blp"
set GI0[GO0]=60
set FU0[GO0]=180
set ZG0=GO0
set GO0=GO0+1 //84
set FT0[GO0]='I0KT'
set FR0[GO0]='I0KS'
set FP0[GO0]='h0B9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWandOfManaSteal.blp"
set GI0[GO0]=0
set FU0[GO0]=600
set ZH0=GO0
set GO0=GO0+1 //85
set FT0[GO0]='I0NF'
set FR0[GO0]='I0NG'
set FP0[GO0]='h0D3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSmokePotion.blp"
set GI0[GO0]=90
set FU0[GO0]=100
set ZZ0=GO0
set GO0=GO0+1 //86
set FT0[GO0]='I061'
set FR0[GO0]='I062'
set FP0[GO0]=0
set FQ0[GO0]='I01J'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrbOfFire.blp"
set GI0[GO0]=0
set FU0[GO0]=1750
set ZV0=GO0
set GO0=GO0+1 //87
set FT0[GO0]='I064'
set FR0[GO0]='I063'
set FP0[GO0]=0
set FQ0[GO0]='I01K'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Helmet_17.blp"
set GI0[GO0]=0
set FU0[GO0]=600
set ZW0=GO0
set GO0=GO0+1 //88
set FT0[GO0]='I065'
set FR0[GO0]='I066'
set FP0[GO0]=0
set FQ0[GO0]='I01L'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNThoriumArmor.blp"
set GI0[GO0]=25
set FU0[GO0]=800
set ZX0=GO0
set GO0=GO0+1 //89
set FT0[GO0]='I068'
set FR0[GO0]='I067'
set FP0[GO0]=0
set FQ0[GO0]='I01M'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingVioletSpider.tga"
set GI0[GO0]=0
set FU0[GO0]=525
set ZY0=GO0
set GO0=GO0+1 //90
set FT0[GO0]='I069'
set FR0[GO0]='I06A'
set FP0[GO0]=0
set FQ0[GO0]='I0C6'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingVioletSpider.tga"
set GI0[GO0]=0
set FU0[GO0]=525
set ZJ0=GO0
set GO0=GO0+1 //91
set FT0[GO0]='I06C'
set FR0[GO0]='I06B'
set FP0[GO0]=0
set FQ0[GO0]='I01P'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAbility_Rogue_Sprint.blp"
set GI0[GO0]=50
set FU0[GO0]=2450
set ZK0=GO0
set GO0=GO0+1 //92
set FT0[GO0]='I03O'
set FR0[GO0]='I02T'
set FP0[GO0]=0
set FQ0[GO0]='I01R'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWirtsLegGreen.blp"
set GI0[GO0]=0
set FU0[GO0]=1400
set ZL0=GO0
set GO0=GO0+1 //93
set FT0[GO0]='I02U'
set FR0[GO0]='I05Y'
set FP0[GO0]=0
set FQ0[GO0]='I01Q'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWirtsLeg.blp"
set GI0[GO0]=0
set FU0[GO0]=1400
set ZM0=GO0
set GO0=GO0+1 //94
set FT0[GO0]='I060'
set FR0[GO0]='I05Z'
set FP0[GO0]=0
set FQ0[GO0]='I01S'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWirtsLegBlue.blp"
set GI0[GO0]=0
set FU0[GO0]=1400
set ZN0=GO0
set GO0=GO0+1 //95
set FT0[GO0]='I06E'
set FR0[GO0]='I06D'
set FP0[GO0]=0
set FQ0[GO0]='I01T'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGoldGloves.BLP"
set GI0[GO0]=100
set FU0[GO0]=2050
set ZS0=GO0
set GO0=GO0+1 //96
set FT0[GO0]='I0NO'
set FR0[GO0]='I0NN'
set FP0[GO0]=0
set FQ0[GO0]='I0NP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGoldGloves.BLP"
set GI0[GO0]=100
set FU0[GO0]=2050
set ZT0=GO0
set GO0=GO0+1 //97
set FT0[GO0]='I06G'
set FR0[GO0]='I06F'
set FP0[GO0]=0
set FQ0[GO0]='I01U'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Mace_10.blp"
set GI0[GO0]=0
set FU0[GO0]=1675
set ZR0=GO0
set GO0=GO0+1 //98
set FT0[GO0]='I06I'
set FR0[GO0]='I06H'
set FP0[GO0]=0
set FQ0[GO0]='I01V'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRunedBracers.blp"
set GI0[GO0]=0
set FU0[GO0]=525
set ZP0=GO0
set GO0=GO0+1 //99
set FT0[GO0]='I06K'
set FR0[GO0]='I06J'
set FP0[GO0]=0
set FQ0[GO0]='I01W'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRevenant.blp"
set GI0[GO0]=0
set FU0[GO0]=485
set ZQ0=GO0
set GO0=GO0+1 //100
set FT0[GO0]='I06M'
set FR0[GO0]='I06L'
set FP0[GO0]=0
set FQ0[GO0]='I01X'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNTalisman.tga"
set GI0[GO0]=0
set FU0[GO0]=470
set ZU0=GO0
set GO0=GO0+1 //101
set FT0[GO0]='I08F'
set FR0[GO0]='I08G'
set FP0[GO0]=0
set FQ0[GO0]='I01Y'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_10.blp"
set GI0[GO0]=0
set FU0[GO0]=2050
set V00=GO0
set GO0=GO0+1 //102
set FT0[GO0]='I08I'
set FR0[GO0]='I08H'
set FP0[GO0]=0
set FQ0[GO0]='I01Z'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNJapaneseSword.BLP"
set GI0[GO0]=0
set FU0[GO0]=2050
set VI0=GO0
set GO0=GO0+1 //103
set FT0[GO0]='I08J'
set FR0[GO0]='I08K'
set FP0[GO0]=0
set FQ0[GO0]='I020'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Hammer_10.blp"
set GI0[GO0]=0
set FU0[GO0]=2950
set V10=GO0
set GO0=GO0+1 //104
set FT0[GO0]='I08M'
set FR0[GO0]='I08L'
set FP0[GO0]=0
set FQ0[GO0]='I0C8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Hammer_10.blp"
set GI0[GO0]=0
set FU0[GO0]=2950
set VO0=GO0
set GO0=GO0+1 //105
set FT0[GO0]='I08N'
set FR0[GO0]='I08O'
set FP0[GO0]=0
set FQ0[GO0]='I021'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Chest_Plate06.blp"
set GI0[GO0]=17
set FU0[GO0]=2200
set V20=GO0
set GO0=GO0+1 //106
set FT0[GO0]='I08Q'
set FR0[GO0]='I08P'
set FP0[GO0]=0
set FQ0[GO0]='I022'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStormHammer.blp"
set GI0[GO0]=0
set FU0[GO0]=2800
set V30=GO0
set GO0=GO0+1 //107
set FT0[GO0]='I08S'
set FR0[GO0]='I08R'
set FP0[GO0]=0
set FQ0[GO0]='I023'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_11.blp"
set GI0[GO0]=12
set FU0[GO0]=3150
set V40=GO0
set GO0=GO0+1 //108
set FT0[GO0]='I0JB'
set FR0[GO0]='I0J9'
set FP0[GO0]=0
set FQ0[GO0]='I0JD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNDiffusal2.blp"
set GI0[GO0]=12
set FU0[GO0]=3850
set V50=GO0
set GO0=GO0+1 //109
set FT0[GO0]='I0EW'
set FR0[GO0]='I0EV'
set FP0[GO0]=0
set FQ0[GO0]='I0EX'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_11.blp"
set GI0[GO0]=0
set FU0[GO0]=0
set V60=GO0
set GO0=GO0+1 //110
set FT0[GO0]='I0JC'
set FR0[GO0]='I0JA'
set FP0[GO0]=0
set FQ0[GO0]='I0JE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNDiffusal2.blp"
set GI0[GO0]=0
set FU0[GO0]=0
set V70=GO0
set GO0=GO0+1 //111
set FT0[GO0]='I08U'
set FR0[GO0]='I08T'
set FP0[GO0]=0
set FQ0[GO0]='I024'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Helmet_13.blp"
set GI0[GO0]=60
set FU0[GO0]=1850
set V80=GO0
set GO0=GO0+1 //112
set FT0[GO0]='I08W'
set FR0[GO0]='I08V'
set FP0[GO0]=0
set FQ0[GO0]='I0CO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Helmet_13.blp"
set GI0[GO0]=0
set FU0[GO0]=1850
set V90=GO0
set GO0=GO0+1 //113
set FT0[GO0]='I08X'
set FR0[GO0]='I08Y'
set FP0[GO0]=0
set FQ0[GO0]='I025'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHelmOfValor.blp"
set GI0[GO0]=22
set FU0[GO0]=1800
set VA0=GO0
set GO0=GO0+1 //114
set FT0[GO0]='I090'
set FR0[GO0]='I08Z'
set FP0[GO0]=0
set FQ0[GO0]='I026'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStaffofpurification.blp"
set GI0[GO0]=23
set FU0[GO0]=2850
set VB0=GO0
set GO0=GO0+1 //115
set FT0[GO0]='I092'
set FR0[GO0]='I091'
set FP0[GO0]=0
set FQ0[GO0]='I027'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPhilosophersStone.blp"
set GI0[GO0]=0
set FU0[GO0]=3300
set VC0=GO0
set GO0=GO0+1 //116
set FT0[GO0]='I094'
set FR0[GO0]='I093'
set FP0[GO0]=0
set FQ0[GO0]='I028'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSpellShieldAmulet.blp"
set GI0[GO0]=45
set FU0[GO0]=2300
set VD0=GO0
set GO0=GO0+1 //117
set FT0[GO0]='I096'
set FR0[GO0]='I095'
set FP0[GO0]=0
set FQ0[GO0]='I029'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSpell_Holy_BlessingOfStrength.blp"
set GI0[GO0]=0
set FU0[GO0]=4100
set VE0=GO0
set GO0=GO0+1 //118
set FT0[GO0]='I098'
set FR0[GO0]='I097'
set FP0[GO0]=0
set FQ0[GO0]='I02A'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAbility_Gouge.blp"
set GI0[GO0]=0
set FU0[GO0]=4100
set VF0=GO0
set GO0=GO0+1 //119
set FT0[GO0]='I09A'
set FR0[GO0]='I099'
set FP0[GO0]=0
set FQ0[GO0]='I02B'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_ThrowingAxe_06.blp"
set GI0[GO0]=0
set FU0[GO0]=4350
set VG0=GO0
set GO0=GO0+1 //120
set FT0[GO0]='I09B'
set FR0[GO0]='I09C'
set FP0[GO0]=0
set FQ0[GO0]='I02C'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNThoriumMelee.blp"
set GI0[GO0]=0
set FU0[GO0]=2150
set VH0=GO0
set GO0=GO0+1 //121
set FT0[GO0]='I0G2'
set FR0[GO0]='I0FZ'
set FP0[GO0]=0
set FQ0[GO0]='I0G8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=80
set FU0[GO0]=3975
set VZ0=GO0
set GO0=GO0+1 //122
set FT0[GO0]='I0G6'
set FR0[GO0]='I0G0'
set FP0[GO0]=0
set FQ0[GO0]='I0G9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=75
set FU0[GO0]=3975
set VV0=GO0
set GO0=GO0+1 //123
set FT0[GO0]='I09E'
set FR0[GO0]='I0FY'
set FP0[GO0]=0
set FQ0[GO0]='I0G7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=70
set FU0[GO0]=3975
set VW0=GO0
set GO0=GO0+1 //124
set FT0[GO0]='I0G5'
set FR0[GO0]='I0FS'
set FP0[GO0]=0
set FQ0[GO0]='I02D'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=65
set FU0[GO0]=3975
set VX0=GO0
set GO0=GO0+1 //125
set FT0[GO0]='I0G3'
set FR0[GO0]='I09D'
set FP0[GO0]=0
set FQ0[GO0]='I0GB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=60
set FU0[GO0]=3975
set VY0=GO0
set GO0=GO0+1 //126
set FT0[GO0]='I0G4'
set FR0[GO0]='I0G1'
set FP0[GO0]=0
set FQ0[GO0]='I0GA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=55
set FU0[GO0]=3975
set VJ0=GO0
set GO0=GO0+1 //127
set FT0[GO0]='I0P6'
set FR0[GO0]='I0P8'
set FP0[GO0]=0
set FQ0[GO0]='I0P7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRodOfNecromancy.blp"
set GI0[GO0]=50
set FU0[GO0]=3975
set VK0=GO0
set GO0=GO0+1 //128
set FT0[GO0]='I0AX'
set FR0[GO0]='I0AW'
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNArcaniteArmor.blp"
set GI0[GO0]=0
set FU0[GO0]=0
set VL0=GO0
set GO0=GO0+1 //129
set FT0[GO0]='I09G'
set FR0[GO0]='I09F'
set FP0[GO0]=0
set FQ0[GO0]='I02E'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_ThrowingAxe_02.blp"
set GI0[GO0]=35
set FU0[GO0]=4950
set VM0=GO0
set GO0=GO0+1 //130
set FT0[GO0]='I0MV'
set FR0[GO0]='I0MU'
set FP0[GO0]=0
set FQ0[GO0]='I0MW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_ThrowingAxe_02.blp"
set GI0[GO0]=50
set FU0[GO0]=4950
set VN0=GO0
set GO0=GO0+1 //131
set FT0[GO0]='I09I'
set FR0[GO0]='I09H'
set FP0[GO0]=0
set FQ0[GO0]='I02F'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNLothars.BLP"
set GI0[GO0]=22
set FU0[GO0]=2800
set VS0=GO0
set GO0=GO0+1 //132
set FT0[GO0]='I09K'
set FR0[GO0]='I09M'
set FP0[GO0]=0
set FQ0[GO0]='I01G'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_06.blp"
set GI0[GO0]=40
set FU0[GO0]=2720
set VT0=GO0
set GO0=GO0+1 //133
set FT0[GO0]='I09J'
set FR0[GO0]='I09P'
set FP0[GO0]=0
set FQ0[GO0]='I02G'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_06.blp"
set GI0[GO0]=36
set FU0[GO0]=3970
set VR0=GO0
set GO0=GO0+1 //134
set FT0[GO0]='I09Q'
set FR0[GO0]='I09N'
set FP0[GO0]=0
set FQ0[GO0]='I0DC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_06.blp"
set GI0[GO0]=32
set FU0[GO0]=5220
set VP0=GO0
set GO0=GO0+1 //135
set FT0[GO0]='I09S'
set FR0[GO0]='I09O'
set FP0[GO0]=0
set FQ0[GO0]='I0DD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_06.blp"
set GI0[GO0]=28
set FU0[GO0]=6470
set VQ0=GO0
set GO0=GO0+1 //136
set FT0[GO0]='I09R'
set FR0[GO0]='I09L'
set FP0[GO0]=0
set FQ0[GO0]='I0D3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_06.blp"
set GI0[GO0]=24
set FU0[GO0]=7720
set VU0=GO0
set GO0=GO0+1 //137
set FT0[GO0]='I09U'
set FR0[GO0]='I09T'
set FP0[GO0]=0
set FQ0[GO0]='I02H'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNNecromancerAdept.blp"
set GI0[GO0]=95
set FU0[GO0]=2700
set W00=GO0
set GO0=GO0+1 //138
set FT0[GO0]='I09V'
set FR0[GO0]='I09X'
set FP0[GO0]=0
set FQ0[GO0]='I02I'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBookOfTheDead.blp"
set GI0[GO0]=95
set FU0[GO0]=3950
set WI0=GO0
set GO0=GO0+1 //139
set FT0[GO0]='I09W'
set FR0[GO0]='I09Y'
set FP0[GO0]=0
set FQ0[GO0]='I02J'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNNecromancerMaster.blp"
set GI0[GO0]=95
set FU0[GO0]=5200
set W10=GO0
set GO0=GO0+1 //140
set FT0[GO0]='I0A0'
set FR0[GO0]='I09Z'
set FP0[GO0]=0
set FQ0[GO0]='I0BO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrb of Water.blp"
set GI0[GO0]=0
set FU0[GO0]=5175
set WO0=GO0
set GO0=GO0+1 //141
set FT0[GO0]='I0HK'
set FR0[GO0]='I0HJ'
set FP0[GO0]=0
set FQ0[GO0]='I0HL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrb of Water.blp"
set GI0[GO0]=0
set FU0[GO0]=5175
set W20=GO0
set GO0=GO0+1 //142
set FT0[GO0]='I0A2'
set FR0[GO0]='I0A1'
set FP0[GO0]=0
set FQ0[GO0]='I0BP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_25.blp"
set GI0[GO0]=0
set FU0[GO0]=7800
set W30=GO0
set GO0=GO0+1 //143
set FT0[GO0]='I0LI'
set FR0[GO0]='I0LJ'
set FP0[GO0]=0
set FQ0[GO0]='I0LK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_25.blp"
set GI0[GO0]=0
set FU0[GO0]=7800
set W40=GO0
set GO0=GO0+1 //144
set FT0[GO0]='I0A4'
set FR0[GO0]='I0A3'
set FP0[GO0]=0
set FQ0[GO0]='I0BQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Weapon_Crossbow_10.blp"
set GI0[GO0]=0
set FU0[GO0]=5550
set W50=GO0
set GO0=GO0+1 //145
set FT0[GO0]='I0A6'
set FR0[GO0]='I0A5'
set FP0[GO0]=0
set FQ0[GO0]='I0BR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Weapon_Halberd_10.blp"
set GI0[GO0]=0
set FU0[GO0]=5400
set W60=GO0
set GO0=GO0+1 //146
set FT0[GO0]='I0K8'
set FR0[GO0]='I0K7'
set FP0[GO0]=0
set FQ0[GO0]='I0K9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Weapon_Halberd_10.blp"
set GI0[GO0]=0
set FU0[GO0]=5400
set W70=GO0
set GO0=GO0+1 //147
set FT0[GO0]='I0A7'
set FR0[GO0]='I0A8'
set FP0[GO0]=0
set FQ0[GO0]='I0BS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNTransmute.blp"
set GI0[GO0]=0
set FU0[GO0]=5150
set W80=GO0
set GO0=GO0+1 //148
set FT0[GO0]='I0KQ'
set FR0[GO0]='I0KP'
set FP0[GO0]=0
set FQ0[GO0]='I0KR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNTransmute.blp"
set GI0[GO0]=0
set FU0[GO0]=5150
set W90=GO0
set GO0=GO0+1 //149
set FT0[GO0]='I0AA'
set FR0[GO0]='I0A9'
set FP0[GO0]=0
set FQ0[GO0]='I0BT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHeartOfAszune.blp"
set GI0[GO0]=0
set FU0[GO0]=5500
set WA0=GO0
set GO0=GO0+1 //150
set FT0[GO0]='I0AA'
set FR0[GO0]='I0KL'
set FQ0[GO0]='I0KM'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHeartOfAszune.blp"
set GI0[GO0]=0
set FU0[GO0]=5500
set WB0=GO0
set GO0=GO0+1 //151
set FT0[GO0]='I0AC'
set FR0[GO0]='I0AB'
set FP0[GO0]=0
set FQ0[GO0]='I0BU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHornOfDoom.blp"
set GI0[GO0]=35
set FU0[GO0]=6150
set WC0=GO0
set GO0=GO0+1 //152
set FT0[GO0]='I0AD'
set FR0[GO0]='I0AE'
set FP0[GO0]=0
set FQ0[GO0]='I0BV'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNIceShard.blp"
set GI0[GO0]=0
set FU0[GO0]=5675
set WD0=GO0
set GO0=GO0+1 //153
set FT0[GO0]='I0AG'
set FR0[GO0]='I0AF'
set FP0[GO0]=0
set FQ0[GO0]='I0CT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNIceShard.blp"
set GI0[GO0]=0
set FU0[GO0]=5675
set WE0=GO0
set GO0=GO0+1 //154
set FT0[GO0]='I0AH'
set FR0[GO0]='I0AI'
set FP0[GO0]=0
set FQ0[GO0]='I0BW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_ThrowingKnife_04.blp"
set GI0[GO0]=0
set FU0[GO0]=6000
set WF0=GO0
set GO0=GO0+1 //155
set FT0[GO0]='I0RG'
set FR0[GO0]='I0RH'
set FP0[GO0]=0
set FQ0[GO0]='I0RI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_ThrowingKnife_04.blp"
set GI0[GO0]=0
set FU0[GO0]=6000
set WG0=GO0
set GO0=GO0+1 //156
set FT0[GO0]='I0B8'
set FR0[GO0]='I0AY'
set FP0[GO0]=0
set FQ0[GO0]='I00B'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set FU0[GO0]=4200
set JD0=GO0
set GO0=GO0+1 //157
set FT0[GO0]='I0AK'
set FR0[GO0]='I0AJ'
set FP0[GO0]=0
set FQ0[GO0]='I0BX'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHeartOfSearinox.blp"
set GI0[GO0]=210
set FU0[GO0]=5225
set WH0=GO0
set GO0=GO0+1 //158
set FT0[GO0]='I07K'
set FR0[GO0]='I0AL'
set FP0[GO0]=0
set FQ0[GO0]='I0BY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Sword_09.blp"
set GI0[GO0]=35
set FU0[GO0]=5675
set WZ0=GO0
set GO0=GO0+1 //159
set FT0[GO0]='I0BB'
set FR0[GO0]='I0BA'
set FP0[GO0]=0
set FQ0[GO0]='I0BZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAdvancedUnholyArmor.blp"
set GI0[GO0]=0
set FU0[GO0]=2275
set WV0=GO0
set GO0=GO0+1 //160
set FT0[GO0]='I0LE'
set FR0[GO0]='I0LC'
set FP0[GO0]=0
set FQ0[GO0]='I0LD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAdvancedUnholyArmor.blp"
set GI0[GO0]=0
set FU0[GO0]=2275
set WW0=GO0
set GO0=GO0+1 //161
set FT0[GO0]='I0BC'
set FR0[GO0]='I0BD'
set FP0[GO0]=0
set FQ0[GO0]='I00C'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNArcaneRing.blp"
set GI0[GO0]=33
set FU0[GO0]=1700
set WX0=GO0
set GO0=GO0+1 //162
set FT0[GO0]='I0BF'
set FR0[GO0]='I0BE'
set FQ0[GO0]='I0C0'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNThunderMallet.blp"
set GI0[GO0]=35
set FU0[GO0]=5700
set WY0=GO0
set GO0=GO0+1 //163
set FT0[GO0]='I014'
set FR0[GO0]='I01D'
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRavenForm.blp"
set GI0[GO0]=0
set FU0[GO0]=370
set WJ0=GO0
set GO0=GO0+1 //164
set FT0[GO0]='I0BH'
set FR0[GO0]='I0BG'
set FP0[GO0]=0
set FQ0[GO0]='I0C1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNCloakOfFlames.blp"
set GI0[GO0]=0
set FU0[GO0]=2075
set WK0=GO0
set GO0=GO0+1 //165
set FT0[GO0]='I0BI'
set FR0[GO0]='I0BJ'
set FP0[GO0]=0
set FQ0[GO0]='I0C2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Chest_Chain_14.blp"
set GI0[GO0]=0
set FU0[GO0]=5250
set WL0=GO0
set GO0=GO0+1 //166
set FT0[GO0]='I0BL'
set FR0[GO0]='I0BK'
set FP0[GO0]=0
set FQ0[GO0]='I0C3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Misc_Gem_Bloodstone_02.blp"
set GI0[GO0]=70
set FU0[GO0]=5075
set WM0=GO0
set GO0=GO0+1 //167
set FT0[GO0]='I0QX'
set FR0[GO0]='I0QY'
set FP0[GO0]=0
set FQ0[GO0]='I0QZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNCrimsonGuard.blp"
set GI0[GO0]=70
set FU0[GO0]=5075
set Z40=GO0
set GO0=GO0+1 //168
set FT0[GO0]='I0BN'
set FR0[GO0]='I0BM'
set FP0[GO0]=0
set FQ0[GO0]='I0C4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHoodOfCunning.blp"
set GI0[GO0]=0
set FU0[GO0]=2125
set WN0=GO0
set GO0=GO0+1 //169
set FT0[GO0]='I00S'
set FR0[GO0]='I00M'
set FP0[GO0]=0
set FQ0[GO0]='I01C'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNImprovedUnholyStrength.blp"
set GI0[GO0]=0
set FU0[GO0]=2400
set WS0=GO0
set GO0=GO0+1 //170
set FT0[GO0]='I00T'
set FR0[GO0]='I00Q'
set FP0[GO0]=0
set FQ0[GO0]='I01E'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUnholyStrength.blp"
set GI0[GO0]=0
set FU0[GO0]=2400
set WT0=GO0
set GO0=GO0+1 //171
set FT0[GO0]='I00V'
set FR0[GO0]='I00N'
set FP0[GO0]=0
set FQ0[GO0]='I01F'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNImprovedUnholyStrength.blp"
set GI0[GO0]=0
set FU0[GO0]=2400
set WR0=GO0
set GO0=GO0+1 //172
set FT0[GO0]='I00W'
set FR0[GO0]='I00R'
set FP0[GO0]=0
set FQ0[GO0]='I0DE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUnholyStrength.blp"
set GI0[GO0]=0
set FU0[GO0]=2400
set WP0=GO0
set GO0=GO0+1 //173
set FT0[GO0]='I00X'
set FR0[GO0]='I00Z'
set FP0[GO0]=0
set FQ0[GO0]='I0CF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAdvancedMoonArmor.blp"
set GI0[GO0]=30
set FU0[GO0]=5060
set WQ0=GO0
set GO0=GO0+1 //174
set FT0[GO0]='I00Y'
set FR0[GO0]='I010'
set FP0[GO0]=0
set FQ0[GO0]='I0DF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAdvancedMoonArmor.blp"
set GI0[GO0]=0
set FU0[GO0]=5060
set WU0=GO0
set GO0=GO0+1 //175
set FT0[GO0]='I013'
set FR0[GO0]='I012'
set FP0[GO0]=0
set FQ0[GO0]='I0CB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNStaffOfSilence.blp"
set GI0[GO0]=18
set FU0[GO0]=4125
set X00=GO0
set GO0=GO0+1 //176
set FT0[GO0]='I0GK'
set FR0[GO0]='I0GJ'
set FP0[GO0]=0
set FQ0[GO0]='I0GL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPhaseBoots.blp"
set GI0[GO0]=8
set FU0[GO0]=1350
set XI0=GO0
set GO0=GO0+1 //177
set FT0[GO0]='I0HG'
set FR0[GO0]='I0HI'
set FP0[GO0]=0
set FQ0[GO0]='I0HH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNForceStaff.blp"
set GI0[GO0]=20
set FU0[GO0]=2250
set XO0=GO0
set GO0=GO0+1 //178
set FT0[GO0]='I0I0'
set FR0[GO0]='I0K6'
set FP0[GO0]=0
set FQ0[GO0]='I0I2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPipeOfInsight.blp"
set GI0[GO0]=25
set FU0[GO0]=3525
set X20=GO0
set FU0[GO0]=1960
set GO0=GO0+1 //179
set FT0[GO0]='I0JG'
set FR0[GO0]='I0JF'
set FP0[GO0]=0
set FQ0[GO0]='I0JH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNImprovedUnholyArmor.blp"
set GI0[GO0]=12
set FU0[GO0]=550
set X30=GO0
set GO0=GO0+1 //180
set FT0[GO0]='I0KD'
set FR0[GO0]='I0KF'
set FP0[GO0]=0
set FQ0[GO0]='I0KE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNImprovedUnholyArmor.blp"
set GI0[GO0]=12
set FU0[GO0]=550
set X40=GO0
set GO0=GO0+1 //181
set FT0[GO0]='I0KX'
set FR0[GO0]='I0KY'
set FP0[GO0]=0
set FQ0[GO0]='I0KZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUrnOfKelThuzad.blp"
set GI0[GO0]=8
set FU0[GO0]=875
set X60=GO0
set GO0=GO0+1 //182
set FT0[GO0]='I0LG'
set FR0[GO0]='I0LF'
set FP0[GO0]=0
set FQ0[GO0]='I0LH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUrnOfKelThuzad.blp"
set GI0[GO0]=0
set FU0[GO0]=875
set X70=GO0
set GO0=GO0+1 //183
set FT0[GO0]='I0LP'
set FR0[GO0]='I0LL'
set FP0[GO0]=0
set FQ0[GO0]='I0LQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSoulRing.blp"
set GI0[GO0]=30
set FU0[GO0]=800
set X80=GO0
set GO0=GO0+1 //184
set FT0[GO0]='I0LR'
set FR0[GO0]='I0LT'
set FP0[GO0]=0
set FQ0[GO0]='I0LS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGhostBlade.blp"
set GI0[GO0]=30
set FU0[GO0]=4900
set HS0=GO0
set GO0=GO0+1 //185
set FT0[GO0]='I0MJ'
set FR0[GO0]='I0MI'
set FP0[GO0]=0
set FQ0[GO0]='I0MK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNArcaneBoots.blp"
set GI0[GO0]=45
set FU0[GO0]=1450
set X90=GO0
set GO0=GO0+1 //186
set FT0[GO0]='I0N1'
set FR0[GO0]='I0N0'
set FP0[GO0]=0
set FQ0[GO0]='I0N2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNMedalionOfCourage.blp"
set GI0[GO0]=7
set FU0[GO0]=1200
set XA0=GO0
set GO0=GO0+1 //187
set FT0[GO0]='I0ND'
set FR0[GO0]='I0NE'
set FP0[GO0]=0
set FQ0[GO0]='I0NC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNJanggo.blp"
set GI0[GO0]=30
set FU0[GO0]=1850
set HP0=GO0
set GO0=GO0+1 //188
set FT0[GO0]='I0NL'
set FR0[GO0]='I0NK'
set FP0[GO0]=0
set FQ0[GO0]='I0NM'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNJanggo.blp"
set GI0[GO0]=0
set FU0[GO0]=0
set HQ0=GO0
set GO0=GO0+1 //189
set FT0[GO0]='I0O2'
set FR0[GO0]='I0O3'
set FP0[GO0]=0
set FQ0[GO0]='I0O4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBoneChimes.blp"
set GI0[GO0]=30
set FU0[GO0]=2670
set XB0=GO0
set GO0=GO0+1 //190
set FT0[GO0]='I0OC'
set FR0[GO0]='I0OE'
set FP0[GO0]=0
set FQ0[GO0]='I0OD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBoneChimes.blp"
set GI0[GO0]=30
set FU0[GO0]=5475
set HU0=GO0
set GO0=GO0+1 //191
set FT0[GO0]='I0OF'
set FR0[GO0]='I0OG'
set FP0[GO0]=0
set FQ0[GO0]='I0OH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNTranquilBoots.blp"
set GI0[GO0]=60
set FU0[GO0]=1000
set Z00=GO0
set GO0=GO0+1 //192
set FT0[GO0]='I0OJ'
set FR0[GO0]='I0OI'
set FP0[GO0]=0
set FQ0[GO0]='I0OK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNTranquilBoots.blp"
set GI0[GO0]=60
set FU0[GO0]=1000
set ZI0=GO0
set GO0=GO0+1 //193
set FT0[GO0]='I0OM'
set FR0[GO0]='I0OL'
set FP0[GO0]=0
set FQ0[GO0]='I0ON'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWitchDoctorMaster.blp"
set GI0[GO0]=10
set FU0[GO0]=3100
set Z10=GO0
set GO0=GO0+1 //194
set FT0[GO0]='I0OP'
set FR0[GO0]='I0OO'
set FP0[GO0]=0
set FQ0[GO0]='I0OQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNPendantOfMana.blp"
set GI0[GO0]=20
set FU0[GO0]=4200
set ZO0=GO0
set GO0=GO0+1 //195
set FT0[GO0]='I0OU'
set FR0[GO0]='I0OV'
set FP0[GO0]=0
set FQ0[GO0]='I0OW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHalberd.blp"
set GI0[GO0]=30
set FU0[GO0]=3850
set XC0=GO0
set GO0=GO0+1 //196
set FT0[GO0]='I0OY'
set FR0[GO0]='I0OX'
set FP0[GO0]=0
set FQ0[GO0]='I0OZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAnnihilator.blp"
set GI0[GO0]=60
set FU0[GO0]=6750
set XD0=GO0
set GO0=GO0+1 //197
set FT0[GO0]='I0P0'
set FR0[GO0]='I0P1'
set FP0[GO0]=0
set FQ0[GO0]='I0P2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingJadeFalcon.blp"
set GI0[GO0]=0
set FU0[GO0]=1010
set Z20=GO0
set GO0=GO0+1 //198
set FT0[GO0]='I0P3'
set FR0[GO0]='I0P4'
set FP0[GO0]=0
set FQ0[GO0]='I0P5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingJadeFalcon.blp"
set GI0[GO0]=0
set FU0[GO0]=1010
set Z30=GO0
set GO0=GO0+1 //199
set FT0[GO0]='I0QI'
set FR0[GO0]='I0QJ'
set FP0[GO0]=0
set FQ0[GO0]='I0QK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Weapon_Halberd_10.blp"
set GI0[GO0]=0
set FU0[GO0]=100000
set XZ0=GO0
set GO0=GO0+1 //200
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h02G'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //201
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h086'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //202
set FT0[GO0]='I05L'
set FR0[GO0]='I05R'
set FP0[GO0]='h02H'
set FQ0[GO0]='I0DS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=200
set XV0=GO0
set GO0=GO0+1 //203
set FT0[GO0]='I05M'
set FR0[GO0]='I05S'
set FP0[GO0]='h02I'
set FQ0[GO0]='I0DT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=200
set XW0=GO0
set GO0=GO0+1 //204
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h02J'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //205
set FT0[GO0]='I05O'
set FR0[GO0]='I05T'
set FP0[GO0]='h02K'
set FQ0[GO0]='I0DU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=2000
set XX0=GO0
set GO0=GO0+1 //206
set FP0[GO0]='h014'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=0
set XY0=GO0
set GO0=GO0+1 //207
set FT0[GO0]='I05P'
set FR0[GO0]='I05U'
set FP0[GO0]='h02L'
set FQ0[GO0]='I0DW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1550
set XJ0=GO0
set GO0=GO0+1 //208
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h02M'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //209
set FT0[GO0]='I05K'
set FR0[GO0]='I05V'
set FP0[GO0]='h02N'
set FQ0[GO0]='I0DX'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=210
set XK0=GO0
set GO0=GO0+1 //210
set FT0[GO0]='I05N'
set FR0[GO0]='I05W'
set FP0[GO0]='h02O'
set FQ0[GO0]='I0DY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=170
set XL0=GO0
set GO0=GO0+1 //211
set FT0[GO0]='I05Q'
set FR0[GO0]='I05X'
set FP0[GO0]='h02P'
set FQ0[GO0]='I0DZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=155
set XM0=GO0
set GO0=GO0+1 //212
set FT0[GO0]='I06N'
set FR0[GO0]='I06O'
set FP0[GO0]='h02Q'
set FQ0[GO0]='I0E0'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=600
set XN0=GO0
set GO0=GO0+1 //213
set FT0[GO0]='I06Q'
set FR0[GO0]='I06P'
set FP0[GO0]='h02R'
set FQ0[GO0]='I0E1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=600
set XS0=GO0
set GO0=GO0+1 //214
set FT0[GO0]='I06R'
set FR0[GO0]='I06S'
set FP0[GO0]='h02S'
set FQ0[GO0]='I0E2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1000
set XT0=GO0
set GO0=GO0+1 //215
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h02T'
set G00[GO0]=""
set GI0[GO0]=0
set FU0[GO0]=500
set GO0=GO0+1 //216
set FT0[GO0]='I06W'
set FR0[GO0]='I06V'
set FP0[GO0]='h02U'
set FQ0[GO0]='I0E4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set XR0=GO0
set GO0=GO0+1 //217
set FT0[GO0]='I06X'
set FR0[GO0]='I06Y'
set FP0[GO0]='h02V'
set FQ0[GO0]='I0E5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=700
set XP0=GO0
set GO0=GO0+1 //218
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h02W'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //219
set FT0[GO0]='I070'
set FR0[GO0]='I06Z'
set FP0[GO0]='h02X'
set FQ0[GO0]='I0E6'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set XQ0=GO0
set GO0=GO0+1 //220
set FT0[GO0]='I071'
set FR0[GO0]='I072'
set FP0[GO0]='h02Y'
set FQ0[GO0]='I0E7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=650
set XU0=GO0
set GO0=GO0+1 //221
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h02Z'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //222
set FT0[GO0]='I074'
set FR0[GO0]='I073'
set FP0[GO0]='h030'
set FQ0[GO0]='I0E8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set Y00=GO0
set GO0=GO0+1 //223
set FP0[GO0]='h031'
set G00[GO0]=""
set GI0[GO0]=0
set FU0[GO0]=500
set YI0=GO0
set GO0=GO0+1 //224
set FT0[GO0]='I076'
set FR0[GO0]='I07V'
set FP0[GO0]='h032'
set FQ0[GO0]='I0EA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set Y10=GO0
set GO0=GO0+1 //225
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h033'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //226
set FT0[GO0]='I077'
set FR0[GO0]='I07W'
set FP0[GO0]='h034'
set FQ0[GO0]='I0EB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=500
set YO0=GO0
set GO0=GO0+1 //227
set FT0[GO0]='I078'
set FR0[GO0]='I07X'
set FP0[GO0]='h035'
set FQ0[GO0]='I0EC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1375
set Y20=GO0
set GO0=GO0+1 //228
set FT0[GO0]='I079'
set FR0[GO0]='I07Y'
set FP0[GO0]='h036'
set FQ0[GO0]='I0ED'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=800
set Y30=GO0
set GO0=GO0+1 //229
set FT0[GO0]='I07A'
set FR0[GO0]='I07Z'
set FP0[GO0]=0
set FQ0[GO0]='I0EE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1000
set Y40=GO0
set GO0=GO0+1 //230
set FT0[GO0]='I07B'
set FR0[GO0]='I080'
set FP0[GO0]='h038'
set FQ0[GO0]='I0EF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1250
set Y50=GO0
set GO0=GO0+1 //231
set FT0[GO0]='I07C'
set FR0[GO0]='I081'
set FP0[GO0]='h039'
set FQ0[GO0]='I0EG'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1250
set Y60=GO0
set GO0=GO0+1 //232
set FT0[GO0]='I07D'
set FR0[GO0]='I082'
set FP0[GO0]='h03A'
set FQ0[GO0]='I0EH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1325
set Y70=GO0
set GO0=GO0+1 //233
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h03C'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //234
set FT0[GO0]='I07E'
set FR0[GO0]='I083'
set FP0[GO0]='h03D'
set FQ0[GO0]='I0EI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1200
set Y80=GO0
set GO0=GO0+1 //235
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h03E'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //236
set FT0[GO0]='I07G'
set FR0[GO0]='I07F'
set FP0[GO0]='h03F'
set FQ0[GO0]='I0EJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1350
set Y90=GO0
set GO0=GO0+1 //237
set FT0[GO0]='I07H'
set FR0[GO0]='I084'
set FP0[GO0]='h03G'
set FQ0[GO0]='I0EK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1200
set YA0=GO0
set GO0=GO0+1 //238
set FT0[GO0]='I07O'
set FR0[GO0]='I085'
set FP0[GO0]='h03H'
set FQ0[GO0]='I0EL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1100
set YB0=GO0
set GO0=GO0+1 //239
set FP0[GO0]='h03I'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=480
set YC0=GO0
set GO0=GO0+1 //240
set FP0[GO0]='h03J'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1800
set YD0=GO0
set GO0=GO0+1 //241
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h03K'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1760
set YK0=GO0
set GO0=GO0+1 //242
set FT0[GO0]='I07J'
set FR0[GO0]='I088'
set FP0[GO0]='h03L'
set FQ0[GO0]='I0EO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1800
set YE0=GO0
set GO0=GO0+1 //243
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h03M'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //244
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h03N'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //245
set FT0[GO0]='I07M'
set FR0[GO0]='I089'
set FP0[GO0]='h03O'
set FQ0[GO0]='I0EP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=840
set YF0=GO0
set GO0=GO0+1 //246
set FT0[GO0]='I07P'
set FR0[GO0]='I08A'
set FP0[GO0]='h03Q'
set FQ0[GO0]='I0EQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=220
set YG0=GO0
set GO0=GO0+1 //247
set FT0[GO0]='I07Q'
set FR0[GO0]='I08B'
set FP0[GO0]='h03R'
set FQ0[GO0]='I0ER'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=300
set YH0=GO0
set GO0=GO0+1 //248
set FT0[GO0]='I07R'
set FR0[GO0]='I08C'
set FP0[GO0]='h03S'
set FQ0[GO0]='I0ES'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1300
set YZ0=GO0
set GO0=GO0+1 //249
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h03U'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //250
set FT0[GO0]='I07S'
set FR0[GO0]='I08D'
set FP0[GO0]='h03V'
set FQ0[GO0]='I0ET'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=500
set YV0=GO0
set GO0=GO0+1 //251
set FT0[GO0]='I07T'
set FR0[GO0]='I08E'
set FP0[GO0]='h03W'
set FQ0[GO0]='I0EU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=600
set YW0=GO0
set GO0=GO0+1 //252
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h079'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //253
set FT0[GO0]='I0H8'
set FR0[GO0]='I0H7'
set FP0[GO0]='h07S'
set FQ0[GO0]='I0H9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=150
set YX0=GO0
set GO0=GO0+1 //254
set FT0[GO0]='I0HD'
set FR0[GO0]='I0HF'
set FP0[GO0]='h07T'
set FQ0[GO0]='I0HE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set YY0=GO0
set GO0=GO0+1 //255
set FT0[GO0]='I0QR'
set FR0[GO0]='I0QS'
set FP0[GO0]='h03T'
set FQ0[GO0]='I0QT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=800
set J10=GO0
set GO0=GO0+1 //256
set FT0[GO0]='I0QU'
set FR0[GO0]='I0QV'
set FP0[GO0]='h0EU'
set FQ0[GO0]='I0QW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=825
set JO0=GO0
set GO0=GO0+1 //257
set FT0[GO0]='I0PD'
set FR0[GO0]='I0PE'
set FP0[GO0]=0
set FQ0[GO0]='I0PF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=300
set JI0=GO0
set GO0=GO0+1 //258
set FT0[GO0]='I0HX'
set FR0[GO0]='I0HZ'
set FP0[GO0]='h07X'
set FQ0[GO0]='I0HY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=800
set YJ0=GO0
set GO0=GO0+1 //259
set FT0[GO0]='I07L'
set FR0[GO0]='I0KN'
set FP0[GO0]='h03P'
set FQ0[GO0]='I0KO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=900
set YL0=GO0
set GO0=GO0+1 //260
set FT0[GO0]='I0KW'
set FR0[GO0]='I0KV'
set FP0[GO0]='h0BA'
set FQ0[GO0]='I0KU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=250
set YM0=GO0
set GO0=GO0+1 //261
set FT0[GO0]='I0LM'
set FR0[GO0]='I0LN'
set FP0[GO0]='h0BQ'
set FQ0[GO0]='I0LO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=125
set YN0=GO0
set GO0=GO0+1 //262
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]=0
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=480
set YS0=GO0
set GO0=GO0+1 //263
set FT0[GO0]='I0N9'
set FR0[GO0]='I0NA'
set FP0[GO0]='h0D1'
set FQ0[GO0]='I0NB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=875
set YT0=GO0
set GO0=GO0+1 //264
set FT0[GO0]='I0NH'
set FR0[GO0]='I0NI'
set FP0[GO0]='h0CY'
set FQ0[GO0]='I0NJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=325
set YR0=GO0
set GO0=GO0+1 //265
set FT0[GO0]='I0O5'
set FR0[GO0]='I0O6'
set FP0[GO0]='h0DD'
set FQ0[GO0]='I0O7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=1270
set YP0=GO0
set GO0=GO0+1 //266
set FT0[GO0]='I0OB'
set FR0[GO0]='I0OA'
set FP0[GO0]='h03X'
set FQ0[GO0]='I0O9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
set GI0[GO0]=0
set FU0[GO0]=775
set YQ0=GO0
set GO0=GO0+1 //267
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h0DT'
set G00[GO0]=""
set GI0[GO0]=0
set YU0=GO0
set GO0=GO0+1 //268
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h0DU'
set G00[GO0]=""
set GI0[GO0]=0
set J00=GO0
set GO0=GO0+1 //269
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h0E9'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //270
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h0EA'
set G00[GO0]=""
set GI0[GO0]=0
set GO0=GO0+1 //271
set FT0[GO0]=0
set FR0[GO0]=0
set FP0[GO0]='h0EC'
set G00[GO0]=""
set GI0[GO0]=0
set MT0=CreateRegion()
call RegionAddRect(MT0,VB)
call RegionAddRect(MT0,WB)
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function CBO))
set J20=t
set t=null
set JC0=JC0+1
set J50[JC0]=HI0
set J60[JC0]=HB0
set JB0[JC0]=ZV0
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=GY0
set J70[JC0]=XV0
set JB0[JC0]=ZW0
set JC0=JC0+1
set J50[JC0]=GC0
set J60[JC0]=GY0
set J70[JC0]=XW0
set JB0[JC0]=ZX0
set JC0=JC0+1
set J50[JC0]=H10
set J60[JC0]=H50
set JB0[JC0]=ZY0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=XX0
set JB0[JC0]=ZK0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=G60
set J70[JC0]=G50
set JB0[JC0]=ZL0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=G80
set J70[JC0]=G50
set JB0[JC0]=ZM0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=H20
set J70[JC0]=G50
set JB0[JC0]=ZN0
set JC0=JC0+1
set J50[JC0]=G50
set J60[JC0]=XJ0
set JB0[JC0]=ZS0
set JC0=JC0+1
set J50[JC0]=H00
set J60[JC0]=H20
set J70[JC0]=H50
set JB0[JC0]=ZR0
set JC0=JC0+1
set J50[JC0]=G70
set J60[JC0]=GH0
set J70[JC0]=XK0
set JB0[JC0]=ZP0
set JC0=JC0+1
set J50[JC0]=G70
set J60[JC0]=H40
set J70[JC0]=XL0
set JB0[JC0]=ZQ0
set JC0=JC0+1
set J50[JC0]=G70
set J60[JC0]=GL0
set J70[JC0]=XM0
set JB0[JC0]=ZU0
set JC0=JC0+1
set J50[JC0]=G90
set J60[JC0]=G60
set J70[JC0]=XN0
set JB0[JC0]=V00
set JC0=JC0+1
set J50[JC0]=GR0
set J60[JC0]=G80
set J70[JC0]=XS0
set JB0[JC0]=VI0
set JC0=JC0+1
set J50[JC0]=HC0
set J60[JC0]=G80
set J70[JC0]=XT0
set JB0[JC0]=V10
set JC0=JC0+1
set J50[JC0]=GB0
set J60[JC0]=GC0
set J70[JC0]=H20
set JB0[JC0]=V20
set JC0=JC0+1
set J50[JC0]=GS0
set J60[JC0]=G50
set J70[JC0]=XR0
set JB0[JC0]=V30
set JC0=JC0+1
set J50[JC0]=G90
set J60[JC0]=G90
set J70[JC0]=H20
set J80[JC0]=XP0
set JB0[JC0]=V40
set JC0=JC0+1
set J50[JC0]=V40
set J60[JC0]=XP0
set JB0[JC0]=V50
set JC0=JC0+1
set J50[JC0]=V60
set J60[JC0]=XP0
set JB0[JC0]=V50
set JC0=JC0+1
set J50[JC0]=GW0
set J60[JC0]=GM0
set JB0[JC0]=V80
set JC0=JC0+1
set J50[JC0]=GM0
set J60[JC0]=XQ0
set JB0[JC0]=VA0
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=H60
set J70[JC0]=HB0
set J80[JC0]=XU0
set JB0[JC0]=VB0
set JC0=JC0+1
set J50[JC0]=GU0
set J60[JC0]=GG0
set J70[JC0]=HA0
set JB0[JC0]=VC0
set JC0=JC0+1
set J50[JC0]=ZW0
set J60[JC0]=ZX0
set J70[JC0]=Y00
set JB0[JC0]=VD0
set JC0=JC0+1
set J50[JC0]=VI0
set J60[JC0]=V00
set JB0[JC0]=VE0
set JC0=JC0+1
set J50[JC0]=GS0
set J60[JC0]=GS0
set J70[JC0]=Y10
set JB0[JC0]=VF0
set JC0=JC0+1
set J50[JC0]=ZV0
set J60[JC0]=GB0
set J70[JC0]=GD0
set JB0[JC0]=VG0
set JC0=JC0+1
set J50[JC0]=GA0
set J60[JC0]=GB0
set J70[JC0]=YO0
set JB0[JC0]=VH0
set JC0=JC0+1
set J50[JC0]=GS0
set J60[JC0]=GR0
set J70[JC0]=Y20
set JB0[JC0]=VZ0
set JC0=JC0+1
set J50[JC0]=V00
set J60[JC0]=H90
set J70[JC0]=Y30
set JB0[JC0]=VN0
set JC0=JC0+1
set J50[JC0]=GD0
set J60[JC0]=XE0
set JB0[JC0]=VS0
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=ZU0
set J70[JC0]=Y50
set JB0[JC0]=VT0
set JC0=JC0+1
set J50[JC0]=VT0
set J60[JC0]=Y50
set JB0[JC0]=VR0
set JC0=JC0+1
set J50[JC0]=VR0
set J60[JC0]=Y50
set JB0[JC0]=VP0
set JC0=JC0+1
set J50[JC0]=VP0
set J60[JC0]=Y50
set JB0[JC0]=VQ0
set JC0=JC0+1
set J50[JC0]=VQ0
set J60[JC0]=Y50
set JB0[JC0]=VU0
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=G80
set J70[JC0]=Y60
set JB0[JC0]=W00
set JC0=JC0+1
set J50[JC0]=W00
set J60[JC0]=Y60
set JB0[JC0]=WI0
set JC0=JC0+1
set J50[JC0]=WI0
set J60[JC0]=Y60
set JB0[JC0]=W10
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=ZV0
set J70[JC0]=Y70
set JB0[JC0]=WO0
set JC0=JC0+1
set J50[JC0]=GE0
set J60[JC0]=H30
set JB0[JC0]=W30
set JC0=JC0+1
set J50[JC0]=VH0
set J60[JC0]=GE0
set J70[JC0]=Y80
set JB0[JC0]=W50
set JC0=JC0+1
set J50[JC0]=GE0
set J60[JC0]=HC0
set J70[JC0]=HC0
set JB0[JC0]=W60
set JC0=JC0+1
set J50[JC0]=H30
set J60[JC0]=Y90
set JB0[JC0]=W80
set JC0=JC0+1
set J50[JC0]=GN0
set J60[JC0]=HA0
set J70[JC0]=YA0
set JB0[JC0]=WA0
set JC0=JC0+1
set J50[JC0]=GN0
set J60[JC0]=V80
set J70[JC0]=YB0
set JB0[JC0]=WC0
set JC0=JC0+1
set J50[JC0]=GN0
set J60[JC0]=V90
set J70[JC0]=YB0
set JB0[JC0]=WC0
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=H90
set J70[JC0]=GU0
set J80[JC0]=G20
set JB0[JC0]=WD0
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=H90
set J70[JC0]=GU0
set J80[JC0]=G30
set JB0[JC0]=WD0
set JC0=JC0+1
set J50[JC0]=GF0
set J60[JC0]=H00
set J70[JC0]=HN0
set JB0[JC0]=WF0
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=GC0
set J70[JC0]=YR0
set JB0[JC0]=XA0
set JC0=JC0+1
set J50[JC0]=GU0
set J60[JC0]=GR0
set J70[JC0]=G90
set J80[JC0]=H60
set JB0[JC0]=JD0
set JC0=JC0+1
set J50[JC0]=ZV0
set J60[JC0]=ZR0
set J70[JC0]=YE0
set JB0[JC0]=WH0
set JC0=JC0+1
set J50[JC0]=H90
set J60[JC0]=GT0
set J70[JC0]=HB0
set JB0[JC0]=WZ0
set JC0=JC0+1
set J50[JC0]=HA0
set J60[JC0]=HI0
set J70[JC0]=H70
set JB0[JC0]=WV0
set JC0=JC0+1
set J50[JC0]=HA0
set J60[JC0]=HI0
set J70[JC0]=H80
set JB0[JC0]=WV0
set JC0=JC0+1
set J50[JC0]=GG0
set J60[JC0]=H10
set J70[JC0]=YF0
set JB0[JC0]=WX0
set JC0=JC0+1
set J50[JC0]=GX0
set J60[JC0]=V30
set J70[JC0]=YL0
set JB0[JC0]=WY0
set JC0=JC0+1
set J50[JC0]=ZD0
set J70[JC0]=YG0
set JB0[JC0]=WJ0
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=ZY0
set J70[JC0]=GM0
set J80[JC0]=YH0
set JB0[JC0]=WK0
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=ZJ0
set J70[JC0]=GM0
set J80[JC0]=YH0
set JB0[JC0]=WK0
set JC0=JC0+1
set J50[JC0]=GX0
set J60[JC0]=GQ0
set J70[JC0]=GC0
set J80[JC0]=YZ0
set JB0[JC0]=WL0
set JC0=JC0+1
set J50[JC0]=VC0
set J60[JC0]=X80
set J70[JC0]=J10
set JB0[JC0]=WM0
set JC0=JC0+1
set J50[JC0]=WV0
set J60[JC0]=ZX0
set J70[JC0]=JO0
set JB0[JC0]=Z40
set JC0=JC0+1
set J50[JC0]=WW0
set J60[JC0]=ZX0
set J70[JC0]=JO0
set JB0[JC0]=Z40
set JC0=JC0+1
set J50[JC0]=HO0
set J60[JC0]=HO0
set J70[JC0]=HI0
set J80[JC0]=GP0
set JB0[JC0]=WN0
set JC0=JC0+1
set J50[JC0]=G50
set J60[JC0]=GW0
set J70[JC0]=GA0
set J80[JC0]=YV0
set JB0[JC0]=WP0
set JC0=JC0+1
set J50[JC0]=GT0
set J60[JC0]=GQ0
set J70[JC0]=YW0
set JB0[JC0]=WQ0
set JC0=JC0+1
set J50[JC0]=ZR0
set J60[JC0]=ZR0
set J70[JC0]=YQ0
set JB0[JC0]=X00
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=GA0
set J70[JC0]=GA0
set JB0[JC0]=XI0
set JC0=JC0+1
set J50[JC0]=HK0
set J60[JC0]=GY0
set J70[JC0]=GY0
set J80[JC0]=GY0
set J90[JC0]=YX0
set JB0[JC0]=X10
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=HO0
set J70[JC0]=YY0
set JB0[JC0]=XO0
set JC0=JC0+1
set J50[JC0]=WN0
set J60[JC0]=ZW0
set J70[JC0]=YJ0
set JB0[JC0]=X20
set JC0=JC0+1
set J50[JC0]=H70
set J60[JC0]=H40
set J70[JC0]=H40
set JB0[JC0]=X30
set JC0=JC0+1
set J50[JC0]=H80
set J60[JC0]=H40
set J70[JC0]=H40
set JB0[JC0]=X30
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=GH0
set J70[JC0]=GH0
set J80[JC0]=YM0
set JB0[JC0]=X60
set JC0=JC0+1
set J50[JC0]=H50
set J60[JC0]=HO0
set J70[JC0]=YN0
set JB0[JC0]=X80
set JC0=JC0+1
set J50[JC0]=GF0
set J60[JC0]=X50
set JB0[JC0]=HS0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=GG0
set JB0[JC0]=X90
set JC0=JC0+1
set J50[JC0]=H20
set J60[JC0]=ZP0
set J70[JC0]=YT0
set JB0[JC0]=HP0
set JC0=JC0+1
set J50[JC0]=HP0
set J60[JC0]=YT0
set JB0[JC0]=HP0
set JC0=JC0+1
set J50[JC0]=HQ0
set J60[JC0]=YT0
set JB0[JC0]=HP0
set JC0=JC0+1
set J50[JC0]=GW0
set J60[JC0]=ZU0
set J70[JC0]=YP0
set JB0[JC0]=XB0
set JC0=JC0+1
set J50[JC0]=G40
set J60[JC0]=H10
set J70[JC0]=HO0
set JB0[JC0]=Z00
set JC0=JC0+1
set J50[JC0]=H60
set J60[JC0]=H60
set J70[JC0]=HA0
set JB0[JC0]=Z10
set JC0=JC0+1
set J50[JC0]=VI0
set J60[JC0]=HN0
set JB0[JC0]=XC0
set JC0=JC0+1
set J50[JC0]=V10
set J60[JC0]=H30
set JB0[JC0]=XD0
set JC0=JC0+1
set J50[JC0]=ZQ0
set J60[JC0]=ZY0
set JB0[JC0]=Z20
set JC0=JC0+1
set J50[JC0]=ZQ0
set J60[JC0]=ZJ0
set JB0[JC0]=Z30
set JC0=JC0+1
set J50[JC0]=XG0
set J60[JC0]=XG0
set J70[JC0]=XG0
set J80[JC0]=XG0
set J90[JC0]=XG0
set JA0[JC0]=XG0
set JB0[JC0]=XH0
set GO0=GO0+1
set FT0[GO0]='I0AZ'
set FR0[GO0]='I011'
set FP0[GO0]=0
set FQ0[GO0]='I0EY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JE0=GO0
set GO0=GO0+1
set FT0[GO0]='I00F'
set FR0[GO0]='I00D'
set FP0[GO0]=0
set FQ0[GO0]='I0EZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JF0=GO0
set GO0=GO0+1
set FT0[GO0]='I0R9'
set FR0[GO0]='I0RA'
set FP0[GO0]=0
set FQ0[GO0]='I0RB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L60=GO0
set GO0=GO0+1
set FT0[GO0]='I0R6'
set FR0[GO0]='I0R7'
set FP0[GO0]=0
set FQ0[GO0]='I0R8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L50=GO0
set GO0=GO0+1
set FT0[GO0]='I018'
set FR0[GO0]='I009'
set FP0[GO0]=0
set FQ0[GO0]='I0F0'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JG0=GO0
set GO0=GO0+1
set FT0[GO0]='I019'
set FR0[GO0]='I005'
set FP0[GO0]=0
set FQ0[GO0]='I0F6'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JH0=GO0
set GO0=GO0+1
set FT0[GO0]='I01A'
set FR0[GO0]='I00G'
set FP0[GO0]=0
set FQ0[GO0]='I0F1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JZ0=GO0
set GO0=GO0+1
set FT0[GO0]='I01B'
set FR0[GO0]='I004'
set FP0[GO0]=0
set FQ0[GO0]='I0F2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JV0=GO0
set GO0=GO0+1
set FT0[GO0]='I0R3'
set FR0[GO0]='I0R4'
set FP0[GO0]=0
set FQ0[GO0]='I0R5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L40=GO0
set GO0=GO0+1
set FT0[GO0]='I01H'
set FR0[GO0]='I003'
set FP0[GO0]=0
set FQ0[GO0]='I0F3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JW0=GO0
set GO0=GO0+1
set FT0[GO0]='I01I'
set FR0[GO0]='I002'
set FP0[GO0]=0
set FQ0[GO0]='I0F5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JX0=GO0
set GO0=GO0+1
set FT0[GO0]='I02K'
set FR0[GO0]='I001'
set FP0[GO0]=0
set FQ0[GO0]='I0F4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JY0=GO0
set GO0=GO0+1
set FT0[GO0]='I02L'
set FR0[GO0]='I00I'
set FP0[GO0]=0
set FQ0[GO0]='I0FE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JJ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0R1'
set FR0[GO0]='I0R0'
set FP0[GO0]=0
set FQ0[GO0]='I0R2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JK0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B2'
set FR0[GO0]='I00H'
set FP0[GO0]=0
set FQ0[GO0]='I0F9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JM0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B3'
set FR0[GO0]='I00P'
set FP0[GO0]=0
set FQ0[GO0]='I0FA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JN0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B4'
set FR0[GO0]='I00U'
set FP0[GO0]=0
set FQ0[GO0]='I0F7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JS0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B7'
set FR0[GO0]='I000'
set FP0[GO0]=0
set FQ0[GO0]='I0FD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JT0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B6'
set FR0[GO0]='I016'
set FP0[GO0]=0
set FQ0[GO0]='I0FC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JR0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B5'
set FR0[GO0]='I017'
set FP0[GO0]=0
set FQ0[GO0]='I0FB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JP0=GO0
set GO0=GO0+1
set FT0[GO0]='I0B9'
set FR0[GO0]='I00O'
set FP0[GO0]=0
set FQ0[GO0]='I0F8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JQ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0J5'
set FR0[GO0]='I0IT'
set FP0[GO0]=0
set FQ0[GO0]='I0IJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JU0=GO0
set GO0=GO0+1
set FT0[GO0]='I0IV'
set FR0[GO0]='I0IU'
set FP0[GO0]=0
set FQ0[GO0]='I0I9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K00=GO0
set GO0=GO0+1
set FT0[GO0]='I0IW'
set FR0[GO0]='I0IS'
set FP0[GO0]=0
set FQ0[GO0]='I0II'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KI0=GO0
set GO0=GO0+1
set FT0[GO0]='I0IX'
set FR0[GO0]='I0IR'
set FP0[GO0]=0
set FQ0[GO0]='I0IA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K10=GO0
set GO0=GO0+1
set FT0[GO0]='I0IY'
set FR0[GO0]='I0IQ'
set FP0[GO0]=0
set FQ0[GO0]='I0IH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KO0=GO0
set GO0=GO0+1
set FT0[GO0]='I0IZ'
set FR0[GO0]='I0IK'
set FP0[GO0]=0
set FQ0[GO0]='I0IG'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K20=GO0
set GO0=GO0+1
set FT0[GO0]='I0J0'
set FR0[GO0]='I0IL'
set FP0[GO0]=0
set FQ0[GO0]='I0IF'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K30=GO0
set GO0=GO0+1
set FT0[GO0]='I0J1'
set FR0[GO0]='I0IM'
set FP0[GO0]=0
set FQ0[GO0]='I0IE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K40=GO0
set GO0=GO0+1
set FT0[GO0]='I0J2'
set FR0[GO0]='I0IP'
set FP0[GO0]=0
set FQ0[GO0]='I0ID'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K50=GO0
set GO0=GO0+1
set FT0[GO0]='I0J3'
set FR0[GO0]='I0IO'
set FP0[GO0]=0
set FQ0[GO0]='I0IC'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K60=GO0
set GO0=GO0+1
set FT0[GO0]='I0J4'
set FR0[GO0]='I0IN'
set FP0[GO0]=0
set FQ0[GO0]='I0IB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K70=GO0
set GO0=GO0+1
set FT0[GO0]='I0I6'
set FR0[GO0]='I0I7'
set FP0[GO0]=0
set FQ0[GO0]='I0I8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K80=GO0
set GO0=GO0+1
set FT0[GO0]='I0JZ'
set FR0[GO0]='I0JS'
set FP0[GO0]=0
set FQ0[GO0]='I0JR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set K90=GO0
set GO0=GO0+1
set FT0[GO0]='I0K0'
set FR0[GO0]='I0JT'
set FP0[GO0]=0
set FQ0[GO0]='I0JL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KA0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K1'
set FR0[GO0]='I0JU'
set FP0[GO0]=0
set FQ0[GO0]='I0JM'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KB0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K2'
set FR0[GO0]='I0JW'
set FP0[GO0]=0
set FQ0[GO0]='I0JN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KC0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K3'
set FR0[GO0]='I0JV'
set FP0[GO0]=0
set FQ0[GO0]='I0JQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KD0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K4'
set FR0[GO0]='I0JY'
set FP0[GO0]=0
set FQ0[GO0]='I0JP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KE0=GO0
set GO0=GO0+1
set FT0[GO0]='I0K5'
set FR0[GO0]='I0JX'
set FP0[GO0]=0
set FQ0[GO0]='I0JO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KF0=GO0
set GO0=GO0+1
set FT0[GO0]='I0KI'
set FR0[GO0]='I0KH'
set FP0[GO0]=0
set FQ0[GO0]='I0KJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KG0=GO0
set GO0=GO0+1
set FT0[GO0]='I0L4'
set FR0[GO0]='I0L5'
set FP0[GO0]=0
set FQ0[GO0]='I0L8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set JL0=GO0
set GO0=GO0+1
set FT0[GO0]='I0L3'
set FR0[GO0]='I0L0'
set FP0[GO0]=0
set FQ0[GO0]='I0L9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KH0=GO0
set GO0=GO0+1
set FT0[GO0]='I0L2'
set FR0[GO0]='I0L7'
set FP0[GO0]=0
set FQ0[GO0]='I0LA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KZ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0LU'
set FR0[GO0]='I0LV'
set FP0[GO0]=0
set FQ0[GO0]='I0LW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KV0=GO0
set GO0=GO0+1
set FT0[GO0]='I0M1'
set FR0[GO0]='I0M0'
set FP0[GO0]=0
set FQ0[GO0]='I0M2'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KW0=GO0
set GO0=GO0+1
set FT0[GO0]='I0M5'
set FR0[GO0]='I0M4'
set FP0[GO0]=0
set FQ0[GO0]='I0M3'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KX0=GO0
set GO0=GO0+1
set FT0[GO0]='I0M6'
set FR0[GO0]='I0M7'
set FP0[GO0]=0
set FQ0[GO0]='I0M8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KY0=GO0
set GO0=GO0+1
set FT0[GO0]='I0MF'
set FR0[GO0]='I0MG'
set FP0[GO0]=0
set FQ0[GO0]='I0MH'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KJ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0MM'
set FR0[GO0]='I0ML'
set FP0[GO0]=0
set FQ0[GO0]='I0MN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KK0=GO0
set GO0=GO0+1
set FT0[GO0]='I0MO'
set FR0[GO0]='I0MP'
set FP0[GO0]=0
set FQ0[GO0]='I0MQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KL0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NQ'
set FR0[GO0]='I0NR'
set FP0[GO0]=0
set FQ0[GO0]='I0NS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KM0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NT'
set FR0[GO0]='I0NU'
set FP0[GO0]=0
set FQ0[GO0]='I0NV'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KN0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NW'
set FR0[GO0]='I0NX'
set FP0[GO0]=0
set FQ0[GO0]='I0NY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KS0=GO0
set GO0=GO0+1
set FT0[GO0]='I0NZ'
set FR0[GO0]='I0O0'
set FP0[GO0]=0
set FQ0[GO0]='I0O1'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KT0=GO0
set GO0=GO0+1
set FT0[GO0]='I0OR'
set FR0[GO0]='I0OS'
set FP0[GO0]=0
set FQ0[GO0]='I0OT'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KR0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PG'
set FR0[GO0]='I0PH'
set FP0[GO0]=0
set FQ0[GO0]='I0PI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KP0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PJ'
set FR0[GO0]='I0PK'
set FP0[GO0]=0
set FQ0[GO0]='I0PL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KQ0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PP'
set FR0[GO0]='I0PQ'
set FP0[GO0]=0
set FQ0[GO0]='I0PR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set KU0=GO0
set GO0=GO0+1
set FT0[GO0]='I0PS'
set FR0[GO0]='I0PT'
set FP0[GO0]=0
set FQ0[GO0]='I0PU'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L00=GO0
set GO0=GO0+1
set FT0[GO0]='I0PV'
set FR0[GO0]='I0PW'
set FP0[GO0]=0
set FQ0[GO0]='I0PX'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set LI0=GO0
set GO0=GO0+1
set FT0[GO0]='I0Q0'
set FR0[GO0]='I0Q2'
set FP0[GO0]=0
set FQ0[GO0]='I0Q4'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set LO0=GO0
set GO0=GO0+1
set FT0[GO0]='I0Q1'
set FR0[GO0]='I0Q3'
set FP0[GO0]=0
set FQ0[GO0]='I0Q5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L10=GO0
set GO0=GO0+1
set FT0[GO0]='I0QL'
set FR0[GO0]='I0QM'
set FP0[GO0]=0
set FQ0[GO0]='I0QN'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L20=GO0
set GO0=GO0+1
set FT0[GO0]='I0QO'
set FR0[GO0]='I0QP'
set FP0[GO0]=0
set FQ0[GO0]='I0QQ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L30=GO0
set GO0=GO0+1
set FT0[GO0]='I0RJ'
set FR0[GO0]='I0RK'
set FP0[GO0]=0
set FQ0[GO0]='I0RL'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L70=GO0
set GO0=GO0+1
set FT0[GO0]='I0RM'
set FR0[GO0]='I0RN'
set FP0[GO0]=0
set FQ0[GO0]='I0RO'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
set GI0[GO0]=60
set L80=GO0
set GO0=GO0+1
set FT0[GO0]='I03A'
set FR0[GO0]='I051'
set FP0[GO0]='h08K'
set FQ0[GO0]='I0D9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSteelArmor.blp"
set GI0[GO0]=0
set G10[GO0]=H70
set GO0=GO0+1
set FT0[GO0]='I03Y'
set FR0[GO0]='I052'
set FP0[GO0]='h08X'
set FQ0[GO0]='I0C9'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrbofSlowness.blp"
set GI0[GO0]=0
set G10[GO0]=H90
set GO0=GO0+1
set FT0[GO0]='I02S'
set FR0[GO0]='I02P'
set FP0[GO0]='h08S'
set FQ0[GO0]='I0CA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGlove.blp"
set GI0[GO0]=0
set G10[GO0]=G50
set GO0=GO0+1
set FT0[GO0]='I02N'
set FR0[GO0]='I02R'
set FP0[GO0]='h08P'
set FQ0[GO0]='I0CS'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBoots.blp"
set GI0[GO0]=0
set G10[GO0]=G60
set GO0=GO0+1
set FT0[GO0]='I02Z'
set FR0[GO0]='I043'
set FP0[GO0]='h08Q'
set FQ0[GO0]='I0CV'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNBelt.blp"
set GI0[GO0]=0
set G10[GO0]=G80
set GO0=GO0+1
set FT0[GO0]='I031'
set FR0[GO0]='I045'
set FP0[GO0]='h08T'
set FQ0[GO0]='I0D5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNClawsOfAttack.blp"
set GI0[GO0]=0
set G10[GO0]=GA0
set GO0=GO0+1
set FT0[GO0]='I03B'
set FR0[GO0]='I04E'
set FP0[GO0]='h08N'
set FQ0[GO0]='I0DA'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNHelmutPurple.blp"
set GI0[GO0]=0
set G10[GO0]=GW0
set GO0=GO0+1
set FT0[GO0]='I03E'
set FR0[GO0]='I04H'
set FP0[GO0]='h08W'
set FQ0[GO0]='I0C7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNDaggerOfEscape.blp"
set GI0[GO0]=18
set G10[GO0]=GJ0
set GO0=GO0+1
set FT0[GO0]='I03G'
set FR0[GO0]='I04K'
set FP0[GO0]='h08O'
set FQ0[GO0]='I0CD'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNUndeadShrine.blp"
set GI0[GO0]=0
set G10[GO0]=GM0
set GO0=GO0+1
set FT0[GO0]='I03P'
set FR0[GO0]='I04S'
set FP0[GO0]='h08U'
set FQ0[GO0]='I0CY'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAlleriaFlute.blp"
set GI0[GO0]=0
set G10[GO0]=H00
set GO0=GO0+1
set FT0[GO0]='I03Q'
set FR0[GO0]='I04T'
set FP0[GO0]='h08G'
set FQ0[GO0]='I0DI'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGoldRing.blp"
set GI0[GO0]=0
set G10[GO0]=HI0
set GO0=GO0+1
set FT0[GO0]='I03S'
set FR0[GO0]='I04V'
set FP0[GO0]='h08L'
set FQ0[GO0]='I0DJ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRingSkull.blp"
set GI0[GO0]=0
set G10[GO0]=HO0
set GO0=GO0+1
set FT0[GO0]='I03T'
set FR0[GO0]='I04W'
set FP0[GO0]='h08R'
set FQ0[GO0]='I0CP'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNRobeOfTheMagi.blp"
set GI0[GO0]=0
set G10[GO0]=H20
set GO0=GO0+1
set FT0[GO0]='I03V'
set FR0[GO0]='I04Y'
set FP0[GO0]='h08E'
set FQ0[GO0]='I0C5'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSlippersOfAgility.blp"
set GI0[GO0]=0
set G10[GO0]=H40
set GO0=GO0+1
set FT0[GO0]='I03W'
set FR0[GO0]='I04Z'
set FP0[GO0]='h08J'
set FQ0[GO0]='I0DK'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSobiMask.blp"
set GI0[GO0]=0
set G10[GO0]=H50
set GO0=GO0+1
set FT0[GO0]='I0GD'
set FR0[GO0]='I0GC'
set FP0[GO0]='h08I'
set FQ0[GO0]='I0GE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNWand.blp"
set GI0[GO0]=0
set G10[GO0]=HK0
set GO0=GO0+1
set FT0[GO0]='I0HT'
set FR0[GO0]='I0HR'
set FP0[GO0]='h08F'
set FQ0[GO0]='I0HW'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrcMeleeUpTwo.blp"
set GI0[GO0]=0
set G10[GO0]=HL0
set GO0=GO0+1
set FT0[GO0]='I0J7'
set FR0[GO0]='I0J6'
set FP0[GO0]='h08V'
set FQ0[GO0]='I0J8'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNAmulet.blp"
set GI0[GO0]=0
set G10[GO0]=HN0
set GO0=GO0+1
set FT0[GO0]='I03L'
set FR0[GO0]='I04P'
set FP0[GO0]='h08M'
set FQ0[GO0]='I0CE'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Misc_Cape_08.blp"
set GI0[GO0]=0
set G10[GO0]=GP0
set GO0=GO0+1
set FT0[GO0]='I05A'
set FR0[GO0]='I05I'
set FP0[GO0]='h08H'
set FQ0[GO0]=0
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNScrollUber.blp"
set GI0[GO0]=0
set G10[GO0]=ZC0
set GO0=GO0+1
set FT0[GO0]='I037'
set FR0[GO0]='I04B'
set FP0[GO0]='h093'
set FQ0[GO0]='I0CR'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNEnchantedGemstone.blp"
set GI0[GO0]=0
set G10[GO0]=GG0
set GO0=GO0+1
set FT0[GO0]='I02Q'
set FR0[GO0]='I02O'
set FP0[GO0]='h0BO'
set FQ0[GO0]='I00A'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNINV_Misc_Cape_08.blp"
set GI0[GO0]=0
set G10[GO0]=G40
set GO0=GO0+1
set GO0=GO0+1
set FT0[GO0]='I032'
set FR0[GO0]='I046'
set FP0[GO0]='h0EV'
set FQ0[GO0]='I0CZ'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNSteelMelee.blp"
set GI0[GO0]=0
set G10[GO0]=GB0
set GO0=GO0+1
set FT0[GO0]='I0MA'
set FR0[GO0]='I0M9'
set FP0[GO0]='h0CN'
set FQ0[GO0]='I0MB'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNOrbOfVenom.blp"
set GI0[GO0]=0
set G10[GO0]=G20
set GO0=GO0+1
set FT0[GO0]='I033'
set FR0[GO0]='I047'
set FP0[GO0]='h0D0'
set FQ0[GO0]='I0D7'
set G00[GO0]="ReplaceableTextures\\CommandButtons\\BTNGlove.blp"
set GI0[GO0]=0
set G10[GO0]=GC0
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELL)
call TriggerAddCondition(t,Condition(function ENO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_PAWN_ITEM)
call TriggerAddCondition(t,Condition(function FYO))
set LY0=t
set t=null
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function FKO))
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_PAWN_ITEM)
call TriggerAddCondition(t,Condition(function G5O))
set MO0=t
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_USE_ITEM)
call TriggerAddCondition(t,Condition(function G9O))
set M20=t
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function G7O))
set t=null
set t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function GGO))
set t=null
set t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call USI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function GWO))
set M60=t
set t=null
set t=CreateTrigger()
set t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddAction(t,function GNO)
call TriggerAddCondition(t,Condition(function GJO))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function GPO))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddAction(t,function H3O)
call TriggerAddCondition(t,Condition(function HIO))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.33,true)
call TriggerAddCondition(t,Condition(function HTO))
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.75,true)
call TriggerAddCondition(t,Condition(function Z0O))
set t=null
call SetPlayerAbilityAvailable(BO[1],'A174',false)
call SetPlayerAbilityAvailable(BO[2],'A174',false)
call SetPlayerAbilityAvailable(BO[3],'A174',false)
call SetPlayerAbilityAvailable(BO[4],'A174',false)
call SetPlayerAbilityAvailable(BO[5],'A174',false)
call SetPlayerAbilityAvailable(CO[1],'A174',false)
call SetPlayerAbilityAvailable(CO[2],'A174',false)
call SetPlayerAbilityAvailable(CO[3],'A174',false)
call SetPlayerAbilityAvailable(CO[4],'A174',false)
call SetPlayerAbilityAvailable(CO[5],'A174',false)
set t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ZNO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call TriggerAddCondition(t,Condition(function ZRO))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function ZTO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_DROP_ITEM)
call TriggerAddCondition(t,Condition(function ZUO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call TriggerAddCondition(t,Condition(function V4O))
set MG0[0]='A2VP'
set MG0[1]='A2VQ'
set MG0[2]='A2VR'
set MG0[3]='A2VS'
set MG0[4]='A2VT'
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function V9O))
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.5,true)
call TriggerAddCondition(t,Condition(function VWO))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VJO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function VNO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
call TriggerAddCondition(t,Condition(function X8O))
set t=null
call L2O()
call SetAltMinimapIcon("war3mapImported\\black.blp")
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SUMMON)
call TriggerAddCondition(t,Condition(function LNO))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function LJO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function NAO))
call SetPlayerAbilityAvailable(BO[1],'A1VV',false)
call SetPlayerAbilityAvailable(BO[2],'A1VV',false)
call SetPlayerAbilityAvailable(BO[3],'A1VV',false)
call SetPlayerAbilityAvailable(BO[4],'A1VV',false)
call SetPlayerAbilityAvailable(BO[5],'A1VV',false)
call SetPlayerAbilityAvailable(CO[1],'A1VV',false)
call SetPlayerAbilityAvailable(CO[2],'A1VV',false)
call SetPlayerAbilityAvailable(CO[3],'A1VV',false)
call SetPlayerAbilityAvailable(CO[4],'A1VV',false)
call SetPlayerAbilityAvailable(CO[5],'A1VV',false)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_USE_ITEM)
call TriggerAddCondition(t,Condition(function NNO))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddAction(t,function NRO)
call TriggerAddCondition(t,Condition(function NTO))
set BFO=GetRectCenter(P4)
set N0=CreateUnitAtLoc(Player(12),'n00L',BFO,bj_UNIT_FACING)
call SetUnitAcquireRange(N0,150)
call B5O(N0)
call RemoveLocation(BFO)
call UnitAddItem(N0,CreateItem(FR0[VL0],0,0))
call UnitAddAbility(N0,'A142')
set BFO=GetRectCenter(H4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(Z4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(V4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(W4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(X4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(Y4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(J4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(K4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(L4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(M4)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(V5)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set BFO=GetRectCenter(X5)
call RemoveUnit(CreateUnitAtLoc(DO,'u001',BFO,0))
call RemoveLocation(BFO)
set t=CreateTrigger()
call TriggerRegisterUnitInRange(t,DZ,300,Condition(function ULI))
call TriggerRegisterUnitInRange(t,ZZ,300,Condition(function ULI))
call TriggerRegisterUnitInRange(t,BZ,300,Condition(function ULI))
call TriggerAddCondition(t,Condition(function NUO))
set t=null
set GG=CreateTrigger()
call TriggerAddAction(GG,function SIO)
set HG=CreateTrigger()
call TriggerAddAction(HG,function SOO)
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,C4)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,P3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,SA)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function S3O))
set t=null
set S5O=null
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,U3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,M3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,KA)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function S6O))
set t=null
set S5O=null
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,B4)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,R3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,TA)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function S8O))
set t=null
set S5O=null
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,I4)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,N3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,LA)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function SAO))
set t=null
set S5O=null
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,T3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,A4)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,NA)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function SCO))
set t=null
set S5O=null
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,Q3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,L3)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
set S5O=CreateRegion()
call RegionAddRect(S5O,MA)
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function SEO))
set t=null
set S5O=null
set ZG=CreateTrigger()
call TriggerAddAction(ZG,function SPO)
set VG=CreateTrigger()
call TriggerRegisterUnitEvent(VG,IX0,EVENT_UNIT_DEATH)
call TriggerAddAction(VG,function T0O)
set WG=CreateTrigger()
call TriggerRegisterUnitEvent(WG,IY0,EVENT_UNIT_DEATH)
call TriggerAddAction(WG,function T1O)
set XG=CreateTrigger()
call TriggerRegisterUnitEvent(XG,IJ0,EVENT_UNIT_DEATH)
call TriggerAddAction(XG,function T2O)
set YG=CreateTrigger()
call TriggerRegisterUnitEvent(YG,IZ0,EVENT_UNIT_DEATH)
call TriggerAddAction(YG,function T4O)
set JG=CreateTrigger()
call TriggerRegisterUnitEvent(JG,IV0,EVENT_UNIT_DEATH)
call TriggerAddAction(JG,function T6O)
set KG=CreateTrigger()
call TriggerRegisterUnitEvent(KG,IW0,EVENT_UNIT_DEATH)
call TriggerAddAction(KG,function T8O)
set LG=CreateTrigger()
call TriggerRegisterUnitEvent(LG,CB0,EVENT_UNIT_DEATH)
call TriggerAddAction(LG,function TAO)
set MG=CreateTrigger()
call TriggerRegisterUnitEvent(MG,CC0,EVENT_UNIT_DEATH)
call TriggerAddAction(MG,function TCO)
set NG=CreateTrigger()
call TriggerRegisterUnitEvent(NG,CD0,EVENT_UNIT_DEATH)
call TriggerAddAction(NG,function TEO)
set SG=CreateTrigger()
call TriggerRegisterUnitEvent(SG,C80,EVENT_UNIT_DEATH)
call TriggerAddAction(SG,function TGO)
set TG=CreateTrigger()
call TriggerRegisterUnitEvent(TG,C90,EVENT_UNIT_DEATH)
call TriggerAddAction(TG,function TZO)
set RG=CreateTrigger()
call TriggerRegisterUnitEvent(RG,CA0,EVENT_UNIT_DEATH)
call TriggerAddAction(RG,function TWO)
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,I60,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function TYO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,BQ0,EVENT_UNIT_DAMAGED)
call TriggerAddCondition(t,Condition(function TKO))
set t=null
set PG=CreateTrigger()
call UMI(PG,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(PG,Condition(function TMO))
call TriggerAddAction(PG,function TNO)
set QG=CreateTrigger()
call UMI(QG,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(QG,Condition(function TTO))
call TriggerAddAction(QG,function TRO)
set UG=CreateTrigger()
call TriggerAddAction(UG,function TQO)
set IH=CreateTrigger()
call TriggerRegisterTimerEventSingle(IH,75.00)
call TriggerAddAction(IH,function R0O)
set OH=CreateTrigger()
call TriggerAddCondition(OH,Condition(function P3O))
set BH=CreateTrigger()
call TriggerAddAction(BH,function P5O)
set CH=CreateTrigger()
call TriggerAddAction(CH,function PAO)
set DH=CreateTrigger()
call UMI(DH,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(DH,Condition(function PCO))
call TriggerAddAction(DH,function PDO)
set EH=CreateTrigger()
call UMI(EH,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(EH,Condition(function PFO))
call TriggerAddAction(EH,function PGO)
set FH=CreateTrigger()
call TriggerRegisterTimerEventPeriodic(FH,1.00)
call TriggerAddAction(FH,function PXO)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SELECTED)
call TriggerAddCondition(t,Condition(function UVO))
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DESELECTED)
call TriggerAddCondition(t,Condition(function UZO))
set t=null
if GetRandomInt(0,10)<11 then
set t=CreateTrigger()
set d=GetRandomReal(60,90)
call TriggerRegisterTimerEvent(t,d,false)
set t=null
endif
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IA0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IA0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I62))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IB0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IB0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I72))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IC0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IC0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I82))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,ID0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,ID0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I92))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IE0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IE0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IA2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IF0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IF0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IB2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IG0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IG0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IC2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IH0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IH0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function ID2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IZ0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IZ0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IE2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IV0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IV0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IF2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IW0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IW0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IG2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IX0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IX0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IH2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IY0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IY0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IZ2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,IJ0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,IJ0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IV2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,I60,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,I60,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IW2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C10,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C10,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function UNO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,CO0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,CO0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function USO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C20,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C20,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function UTO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C30,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C30,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function URO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C40,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C40,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function UPO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C50,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C50,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function UQO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C60,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C60,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function UUO))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C70,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C70,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I02))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C80,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C80,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function II2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,C90,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,C90,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I12))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,CA0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,CA0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function IO2))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,CB0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,CB0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I22))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,CC0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,CC0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I32))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,CD0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,CD0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I42))
set t=CreateTrigger()
call TriggerRegisterUnitEvent(t,BQ0,EVENT_UNIT_DAMAGED)
call TriggerRegisterUnitEvent(t,BQ0,EVENT_UNIT_DEATH)
call TriggerAddCondition(t,Condition(function I52))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function UKO))
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,5,true)
call TriggerAddCondition(t,Condition(function IR2))
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,4,true)
call TriggerAddCondition(t,Condition(function O22))
set t=null
set TR0=NTI()
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,bj_mapInitialPlayableArea)
call TriggerRegisterEnterRegion(t,S5O,Condition(function N1I))
call TriggerAddCondition(t,Condition(function O72))
set t=null
set S5O=null
set t=CreateTrigger()
call TriggerAddCondition(t,Condition(function O92))
call TriggerRegisterTimerEvent(t,5,true)
set t=null
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_VISIBLE,-4550,1250,300,true,true))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_VISIBLE,-4550,1250,300,true,true))
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_VISIBLE,3200,1,300,true,true))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_VISIBLE,3200,1,300,true,true))
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_VISIBLE,-7292,4186,450,true,true))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_VISIBLE,-7292,4186,450,true,true))
call DestroyFogModifier(CreateFogModifierRadius(BO[0],FOG_OF_WAR_VISIBLE,7348,-4334,450,true,true))
call DestroyFogModifier(CreateFogModifierRadius(CO[0],FOG_OF_WAR_VISIBLE,7348,-4334,450,true,true))
call DestroyFogModifier(CreateFogModifierRect(BO[0],FOG_OF_WAR_VISIBLE,MS,true,true))
call DestroyFogModifier(CreateFogModifierRect(CO[0],FOG_OF_WAR_VISIBLE,MS,true,true))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,3.5,true)
call TriggerAddCondition(t,Condition(function OX2))
set t=null
set RK=CreateTrigger()
call TriggerRegisterUnitEvent(RK,BQ0,EVENT_UNIT_DEATH)
call TriggerAddAction(RK,function OR2)
set PK=CreateTrigger()
call TriggerRegisterUnitEvent(PK,I60,EVENT_UNIT_DEATH)
call TriggerAddAction(PK,function OS2)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_ATTACKED)
call TriggerAddCondition(t,Condition(function A02))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_CAST)
call TriggerAddCondition(t,Condition(function A12))
set t=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddAction(t,function A22)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function A62))
set t=null
set R50=CreateTrigger()
call TriggerAddAction(R50,function AB2)
set t=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(t,DO,EVENT_PLAYER_UNIT_ATTACKED,Condition(function N1I))
call TriggerAddCondition(t,Condition(function AD2))
set t=null
set R60=CreateRegion()
call RegionAddRect(R60,M5)
call RegionAddRect(R60,N5)
call RegionAddRect(R60,S5)
call RegionAddRect(R60,T5)
call RegionAddRect(R60,R5)
call RegionAddRect(R60,P5)
call RegionAddRect(R60,Q5)
call RegionAddRect(R60,U5)
call RegionAddRect(R60,I6)
set GH=CreateTrigger()
call TriggerRegisterEnterRectSimple(GH,bj_mapInitialPlayableArea)
call TriggerAddCondition(GH,Condition(function AF2))
call TriggerAddAction(GH,function AG2)
set HH=CreateTrigger()
call UMI(HH,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(HH,Condition(function AZ2))
call TriggerAddAction(HH,function AJ2)
set ZH=CreateTrigger()
call UMI(ZH,EVENT_PLAYER_UNIT_DEATH)
call TriggerAddCondition(ZH,Condition(function AL2))
call TriggerAddAction(ZH,function AS2)
if(bj_isSinglePlayer and AR2())then
call BK2()
endif
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,WO,"-wtf",true)
call TriggerAddAction(t,function BT2)
call TriggerAddCondition(t,Condition(function BM2))
set t=CreateTrigger()
call TriggerRegisterPlayerUnitEvent(t,BO[1],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,BO[2],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,BO[3],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,BO[4],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,BO[5],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[1],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[2],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[3],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[4],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerRegisterPlayerUnitEvent(t,CO[5],EVENT_PLAYER_HERO_LEVEL,Condition(function N1I))
call TriggerAddCondition(t,Condition(function BQ2))
set t=null
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,WO,"-test",true)
call TriggerAddCondition(t,Condition(function CI2))
set t=null
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,GetWorldBounds())
call TriggerRegisterEnterRegion(t,S5O,Condition(function ULI))
call TriggerAddCondition(t,Condition(function CJ2))
set t=null
set S5O=null
set t=CreateTrigger()
call TriggerRegisterUnitInRange(t,DZ,300,Condition(function ULI))
call TriggerRegisterUnitInRange(t,ZZ,300,Condition(function ULI))
call TriggerRegisterUnitInRange(t,BZ,300,Condition(function ULI))
call TriggerAddCondition(t,Condition(function CL2))
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,25,false)
call TriggerAddAction(t,function CT2)
set t=null
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,2,false)
call TriggerAddCondition(t,Condition(function DO2))
set t=null
set QK=CreateRegion()
call RegionAddRect(QK,F4)
call RegionAddRect(QK,E4)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,25,false)
call TriggerAddAction(t,function D92)
set t=null
set t=CreateTrigger()
call TriggerRegisterPlayerChatEvent(t,BO[1],"-",false)
call TriggerRegisterPlayerChatEvent(t,BO[2],"-",false)
call TriggerRegisterPlayerChatEvent(t,BO[3],"-",false)
call TriggerRegisterPlayerChatEvent(t,BO[4],"-",false)
call TriggerRegisterPlayerChatEvent(t,BO[5],"-",false)
call TriggerRegisterPlayerChatEvent(t,CO[1],"-",false)
call TriggerRegisterPlayerChatEvent(t,CO[2],"-",false)
call TriggerRegisterPlayerChatEvent(t,CO[3],"-",false)
call TriggerRegisterPlayerChatEvent(t,CO[4],"-",false)
call TriggerRegisterPlayerChatEvent(t,CO[5],"-",false)
call TriggerAddAction(t,function DB2)
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_FINISH)
call TriggerAddCondition(t,Condition(function GQ2))
call TriggerAddAction(t,function H12)
set VM[0]=false
set VM[1]=false
set VM[2]=false
set VM[3]=false
set VM[4]=false
set VM[5]=false
set VM[6]=false
set VM[7]=false
set VM[8]=false
set VM[9]=false
set VM[10]=false
set VM[11]=false
set VM[12]=false
set VM[13]=false
set VM[14]=false
set VM[15]=false
set VM[16]=false
set RV0[0]=false
set RV0[1]=false
set RV0[2]=false
set RV0[3]=false
set RV0[4]=false
set RV0[5]=false
set RV0[6]=false
set RV0[7]=false
set RV0[8]=false
set RV0[9]=false
set RV0[10]=false
set RV0[11]=false
set RV0[12]=false
set RV0[13]=false
set RV0[14]=false
set RV0[15]=false
set RV0[16]=false
set RW0[0]=true
set RW0[1]=true
set RW0[2]=true
set RW0[3]=true
set RW0[4]=true
set RW0[5]=true
set RW0[6]=true
set RW0[7]=true
set RW0[8]=true
set RW0[9]=true
set RW0[10]=true
set RW0[11]=true
set RW0[12]=true
set RW0[13]=true
set RW0[14]=true
set RW0[15]=true
set RW0[16]=true
set RX0[0]=false
set RX0[1]=false
set RX0[2]=false
set RX0[3]=false
set RX0[4]=false
set RX0[5]=false
set RX0[6]=false
set RX0[7]=false
set RX0[8]=false
set RX0[9]=false
set RX0[10]=false
set RX0[11]=false
set RX0[12]=false
set RX0[13]=false
set RX0[14]=false
set RX0[15]=false
set RX0[16]=false
set RL0[0]=false
set RL0[1]=false
set RL0[2]=false
set RL0[3]=false
set RL0[4]=false
set RL0[5]=false
set RL0[6]=false
set RL0[7]=false
set RL0[8]=false
set RL0[9]=false
set RL0[10]=false
set RL0[11]=false
set RL0[12]=false
set RL0[13]=false
set RL0[14]=false
set RL0[15]=false
set RL0[16]=false
set RL0[GetPlayerId(BO[1])]=true
set RL0[GetPlayerId(BO[2])]=true
set RL0[GetPlayerId(BO[3])]=true
set RL0[GetPlayerId(BO[4])]=true
set RL0[GetPlayerId(BO[5])]=true
set RL0[GetPlayerId(CO[1])]=true
set RL0[GetPlayerId(CO[2])]=true
set RL0[GetPlayerId(CO[3])]=true
set RL0[GetPlayerId(CO[4])]=true
set RL0[GetPlayerId(CO[5])]=true
call HM2()
set GM[0]=true
set GM[1]=true
set GM[2]=true
set GM[3]=true
set GM[4]=true
set GM[5]=true
set GM[6]=true
set GM[7]=true
set GM[8]=true
set GM[9]=true
set GM[10]=true
set GM[11]=true
set GM[12]=true
set GM[13]=true
set GM[14]=true
set GM[15]=true
set RP0[0]=false
set RP0[1]=false
set RP0[2]=false
set RP0[3]=false
set RP0[4]=false
set RP0[5]=false
set RP0[6]=false
set RP0[7]=false
set RP0[8]=false
set RP0[9]=false
set RP0[10]=false
set RP0[11]=false
set RP0[12]=false
set RP0[13]=false
set RP0[14]=false
set HM[GetPlayerId(BO[1])]=false
set HM[GetPlayerId(BO[2])]=false
set HM[GetPlayerId(BO[3])]=false
set HM[GetPlayerId(BO[4])]=false
set HM[GetPlayerId(BO[5])]=false
set HM[GetPlayerId(CO[1])]=false
set HM[GetPlayerId(CO[2])]=false
set HM[GetPlayerId(CO[3])]=false
set HM[GetPlayerId(CO[4])]=false
set HM[GetPlayerId(CO[5])]=false
set RQ0[GetPlayerId(BO[1])]=false
set RQ0[GetPlayerId(BO[2])]=false
set RQ0[GetPlayerId(BO[3])]=false
set RQ0[GetPlayerId(BO[4])]=false
set RQ0[GetPlayerId(BO[5])]=false
set RQ0[GetPlayerId(CO[1])]=false
set RQ0[GetPlayerId(CO[2])]=false
set RQ0[GetPlayerId(CO[3])]=false
set RQ0[GetPlayerId(CO[4])]=false
set RQ0[GetPlayerId(CO[5])]=false
set t=CreateTrigger()
call USI(t,EVENT_PLAYER_UNIT_ISSUED_ORDER)
call USI(t,EVENT_PLAYER_UNIT_ISSUED_TARGET_ORDER)
call USI(t,EVENT_PLAYER_UNIT_ISSUED_POINT_ORDER)
call TriggerAddCondition(t,Condition(function Z72))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,5,true)
call TriggerAddCondition(t,Condition(function Z62))
set P00[GetPlayerId(BO[1])]=false
set P00[GetPlayerId(BO[2])]=false
set P00[GetPlayerId(BO[3])]=false
set P00[GetPlayerId(BO[4])]=false
set P00[GetPlayerId(BO[5])]=false
set P00[GetPlayerId(CO[1])]=false
set P00[GetPlayerId(CO[2])]=false
set P00[GetPlayerId(CO[3])]=false
set P00[GetPlayerId(CO[4])]=false
set P00[GetPlayerId(CO[5])]=false
set t=null
set WM[GetPlayerId(BO[1])]=false
set WM[GetPlayerId(BO[2])]=false
set WM[GetPlayerId(BO[3])]=false
set WM[GetPlayerId(BO[4])]=false
set WM[GetPlayerId(BO[5])]=false
set WM[GetPlayerId(CO[1])]=false
set WM[GetPlayerId(CO[2])]=false
set WM[GetPlayerId(CO[3])]=false
set WM[GetPlayerId(CO[4])]=false
set WM[GetPlayerId(CO[5])]=false
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function ZG2))
set P20[0]=false
set P20[1]=false
set P20[2]=false
set P20[3]=false
set P20[4]=false
set P20[5]=false
set P20[6]=false
set P20[7]=false
set P20[8]=false
set P20[9]=false
set P20[10]=false
set P20[11]=false
set P20[12]=false
set P20[13]=false
set P20[14]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\WitchDoctor\\WitchDoctorPissed1.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\WitchDoctor\\WitchDoctorPissed2.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\WitchDoctor\\WitchDoctorPissed3.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\WitchDoctor\\WitchDoctorPissed4.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\WitchDoctor\\WitchDoctorPissed5.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\WitchDoctor\\WitchDoctorPissed6.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed1.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed2.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed3.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed4.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed5.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed6.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Undead\\HeroDreadLord\\HeroDreadlordPissed7.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Creeps\\HEROGoblinALCHEMIST\\HeroAlchemistPissed1.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Creeps\\HEROGoblinALCHEMIST\\HeroAlchemistPissed2.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Creeps\\HEROGoblinALCHEMIST\\HeroAlchemistPissed3.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Creeps\\HEROGoblinALCHEMIST\\HeroAlchemistPissed4.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Creeps\\HEROGoblinALCHEMIST\\HeroAlchemistPissed5.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Creeps\\HEROGoblinALCHEMIST\\HeroAlchemistPissed6.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\BloodElfSpellThief\\SpellbreakerPissed1.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\BloodElfSpellThief\\SpellbreakerPissed2.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\BloodElfSpellThief\\SpellbreakerPissed3.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\BloodElfSpellThief\\SpellbreakerPissed4.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\BloodElfSpellThief\\SpellbreakerPissed5.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed1.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed2.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed3.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed4.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed5.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed6.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed7.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Human\\Rifleman\\RiflemanPissed8.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed1.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed2.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed3.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed4.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed5.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed6.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed7.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed8.wav"
set P70[P80]=false
set P80=P80+1
set P60[P80]="Units\\Orc\\HeroShadowHunter\\ShadowHunterPissed9.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\Ogre\\OgrePissed1.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\Ogre\\OgrePissed2.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\Ogre\\OgrePissed3.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\Ogre\\OgrePissed4.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\Ogre\\OgrePissed5.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed1.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed2.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed3.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed4.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed5.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed6.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\GoblinSapper\\GoblinSapperPissed7.wav"
set P70[P80]=false
set P60[P80]="Units\\Orc\\HeroBladeMaster\\HeroBladeMasterPissed1.wav"
set P70[P80]=false
set P60[P80]="Units\\Orc\\HeroBladeMaster\\HeroBladeMasterPissed2.wav"
set P70[P80]=false
set P60[P80]="Units\\Orc\\HeroBladeMaster\\HeroBladeMasterPissed3.wav"
set P70[P80]=false
set P60[P80]="Units\\Orc\\HeroBladeMaster\\HeroBladeMasterPissed4.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed1.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed2.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed3.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed4.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed5.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed6.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed7.wav"
set P70[P80]=false
set P60[P80]="Units\\Creeps\\PandarenBrewmaster\\PandarenBrewmasterPissed8.wav"
set P70[P80]=false
set PB0[0]=false
set PB0[1]=false
set PB0[2]=false
set PB0[3]=false
set PB0[4]=false
set PB0[5]=false
set PB0[6]=false
set PB0[7]=false
set PB0[8]=false
set PB0[9]=false
set PB0[10]=false
set PB0[11]=false
set PB0[12]=false
set PB0[13]=false
set t=CreateTrigger()
set handle_id=GetHandleId(t)
call TriggerRegisterTimerEvent(t,0.02,true)
call TriggerAddCondition(t,Condition(function VP2))
call SaveReal(LY,(handle_id),(149),((0)*1.0))
call SaveReal(LY,(handle_id),(150),((0)*1.0))
call SaveReal(LY,(handle_id),(151),((160)*1.0))
set LL[0]=false
set LL[1]=false
set LL[2]=false
set LL[3]=false
set LL[4]=false
set LL[5]=false
set LL[6]=false
set LL[7]=false
set LL[8]=false
set LL[9]=false
set LL[10]=false
set LL[11]=false
set LL[12]=false
set t=null
set t=CreateTrigger()
call TriggerAddAction(t,function XX2)
call TriggerAddCondition(t,Condition(function WI2))
set PF0=t
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,0.01,false)
call TriggerAddCondition(t,Condition(function XY2))
set t=null
if C2 then
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,1,true)
call TriggerAddCondition(t,Condition(function S62))
endif
set t=null
set VH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(VH,E0[1])
call TriggerAddAction(VH,function TD2)
set WH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(WH,E0[2])
call TriggerAddAction(WH,function TF2)
set XH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(XH,E0[3])
call TriggerAddAction(XH,function TH2)
set YH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(YH,E0[4])
call TriggerAddAction(YH,function TV2)
set JH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(JH,E0[5])
call TriggerAddAction(JH,function TX2)
set KH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(KH,E0[7])
call TriggerAddAction(KH,function TJ2)
set LH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(LH,E0[8])
call TriggerAddAction(LH,function TL2)
set MH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(MH,E0[9])
call TriggerAddAction(MH,function TN2)
set NH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(NH,E0[10])
call TriggerAddAction(NH,function TT2)
set TH=CreateTrigger()
call TriggerRegisterTimerExpireEvent(TH,E0[11])
call TriggerAddAction(TH,function TP2)
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,14,false)
call TriggerAddCondition(t,Condition(function RI2))
set t=CreateTrigger()
call TriggerRegisterTimerEvent(t,15,false)
call TriggerAddCondition(t,Condition(function R02))
set RH=CreateTrigger()
call TriggerRegisterTimerEventSingle(RH,65.00)
call TriggerAddAction(RH,function RO2)
set PH=CreateTrigger()
call TriggerRegisterTimerEventSingle(PH,90.00)
call TriggerAddAction(PH,function R32)
set QH=CreateTrigger()
call TriggerRegisterTimerEventSingle(QH,120.00)
call TriggerAddAction(QH,function R52)
set t=CreateTrigger()
set S5O=CreateRegion()
call RegionAddRect(S5O,GetWorldBounds())
call TriggerRegisterEnterRegion(t,S5O,Condition(function N1I))
call TriggerAddCondition(t,Condition(function K14))
set HLI[1]='A0VS'
set HLI[2]='A0VK'
set HLI[3]='A0VQ'
set HLI[4]='A0XL'
set HLI[5]='A0VM'
set HLI[6]='A0VN'
set HLI[7]='A0VO'
set HLI[8]='A0VP'
set HLI[9]='A0VG'
set HLI[10]='A0VZ'
set t=null
set S5O=null
set t=CreateTrigger()
call UMI(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
call TriggerAddCondition(t,Condition(function E44))
call TriggerAddAction(t,function E54)
endfunction
function config takes nothing returns nothing
call SetMapName("TRIGSTR_50000")
call SetMapDescription("TRIGSTR_50001")
call SetPlayers(10)
call SetTeams(10)
call SetGamePlacement(MAP_PLACEMENT_TEAMS_TOGETHER)
call DefineStartLocation(0,-6990.0,6840.0)
call DefineStartLocation(1,-6990.0,6840.0)
call DefineStartLocation(2,-6990.0,6840.0)
call DefineStartLocation(3,-6990.0,6840.0)
call DefineStartLocation(4,-6990.0,6840.0)
call DefineStartLocation(5,-6990.0,6840.0)
call DefineStartLocation(6,-6990.0,6840.0)
call DefineStartLocation(7,-6990.0,6840.0)
call DefineStartLocation(8,-6990.0,6840.0)
call DefineStartLocation(9,-6990.0,6840.0)
call SetPlayerStartLocation(Player(1),0)
call ForcePlayerStartLocation(Player(1),0)
call SetPlayerColor(Player(1),ConvertPlayerColor(1))
call SetPlayerRacePreference(Player(1),RACE_PREF_NIGHTELF)
call SetPlayerRaceSelectable(Player(1),false)
call SetPlayerController(Player(1),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(2),1)
call ForcePlayerStartLocation(Player(2),1)
call SetPlayerColor(Player(2),ConvertPlayerColor(2))
call SetPlayerRacePreference(Player(2),RACE_PREF_NIGHTELF)
call SetPlayerRaceSelectable(Player(2),false)
call SetPlayerController(Player(2),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(3),2)
call ForcePlayerStartLocation(Player(3),2)
call SetPlayerColor(Player(3),ConvertPlayerColor(3))
call SetPlayerRacePreference(Player(3),RACE_PREF_NIGHTELF)
call SetPlayerRaceSelectable(Player(3),false)
call SetPlayerController(Player(3),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(4),3)
call ForcePlayerStartLocation(Player(4),3)
call SetPlayerColor(Player(4),ConvertPlayerColor(4))
call SetPlayerRacePreference(Player(4),RACE_PREF_NIGHTELF)
call SetPlayerRaceSelectable(Player(4),false)
call SetPlayerController(Player(4),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(5),4)
call ForcePlayerStartLocation(Player(5),4)
call SetPlayerColor(Player(5),ConvertPlayerColor(5))
call SetPlayerRacePreference(Player(5),RACE_PREF_NIGHTELF)
call SetPlayerRaceSelectable(Player(5),false)
call SetPlayerController(Player(5),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(7),5)
call ForcePlayerStartLocation(Player(7),5)
call SetPlayerColor(Player(7),ConvertPlayerColor(7))
call SetPlayerRacePreference(Player(7),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(7),false)
call SetPlayerController(Player(7),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(8),6)
call ForcePlayerStartLocation(Player(8),6)
call SetPlayerColor(Player(8),ConvertPlayerColor(8))
call SetPlayerRacePreference(Player(8),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(8),false)
call SetPlayerController(Player(8),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(9),7)
call ForcePlayerStartLocation(Player(9),7)
call SetPlayerColor(Player(9),ConvertPlayerColor(9))
call SetPlayerRacePreference(Player(9),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(9),false)
call SetPlayerController(Player(9),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(10),8)
call ForcePlayerStartLocation(Player(10),8)
call SetPlayerColor(Player(10),ConvertPlayerColor(10))
call SetPlayerRacePreference(Player(10),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(10),false)
call SetPlayerController(Player(10),MAP_CONTROL_USER)
call SetPlayerStartLocation(Player(11),9)
call ForcePlayerStartLocation(Player(11),9)
call SetPlayerColor(Player(11),ConvertPlayerColor(11))
call SetPlayerRacePreference(Player(11),RACE_PREF_UNDEAD)
call SetPlayerRaceSelectable(Player(11),false)
call SetPlayerController(Player(11),MAP_CONTROL_USER)
call InitCustomTeams()
call SetPlayerAlliance(Player(15),Player(1),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(2),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(3),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(4),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(5),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(7),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(8),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(9),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(10),ConvertAllianceType(6),true)
call SetPlayerAlliance(Player(15),Player(11),ConvertAllianceType(6),true)
call SetStartLocPrioCount(0,9)
call SetStartLocPrio(0,0,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,1,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,2,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(0,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(1,9)
call SetStartLocPrio(1,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,1,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,2,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(1,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(2,9)
call SetStartLocPrio(2,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,2,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(2,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(3,9)
call SetStartLocPrio(3,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,3,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(3,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(4,9)
call SetStartLocPrio(4,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,4,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(4,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(5,9)
call SetStartLocPrio(5,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,5,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(5,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(6,9)
call SetStartLocPrio(6,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,6,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(6,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(7,9)
call SetStartLocPrio(7,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,7,8,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(7,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(8,9)
call SetStartLocPrio(8,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,7,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(8,8,9,MAP_LOC_PRIO_HIGH)
call SetStartLocPrioCount(9,9)
call SetStartLocPrio(9,0,0,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,1,1,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,2,2,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,3,3,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,4,4,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,5,5,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,6,6,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,7,7,MAP_LOC_PRIO_HIGH)
call SetStartLocPrio(9,8,8,MAP_LOC_PRIO_HIGH)
endfunction
